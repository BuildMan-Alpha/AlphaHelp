<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Example of generating an Excel S</title>


	<style>
<!--
p, ul, li            { font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top:0px; margin-bottom:5px }
.xbasic      { font-family: Courier New; font-size: 10pt; color: #0000FF; margin-left: 1.1in;
               margin-top: 0; margin-bottom: 0 }
td           { font-family: Tahoma; font-size: 8pt; VERTICAL-ALIGN: top}
h1           { font-family: Tahoma; font-size: 11pt; color: #ff0000 }
h2           { font-family: Tahoma; font-size: 10pt ; color: #ff0000}
h4 			  {font-family: Tahoma; font-size: 9pt; font-weight: bold; color: #ff0000}
h3           { font-family: Tahoma; font-size: 10pt ; color: #ff0000; margin-left: .5in;}

BODY {font-family="Arial"}
.tableText {font-family: tahoma; font-size: 8pt;}
.rowEven {background-color:white;}
.searchHighlight {color: red;}

 margin-top:0in}
-->
</style>


</head>

<body>

<p >
<b>Example of generating an Excel Spreadsheet with Formulas</b></p>
<p >
Build a layout table report on invoice_items, grouped on invoice number. Select 
columns product_id, price , quantity, extension, and add a subtotal in the group 
footer on the extension field.</p>
<p >
Select the price field, and on the properties editor task pane, click on the 
excel button and give a 'reference' name of price to the cell.</p>
<img src="example_1_excel_field1.png" ><p >
Select the quantity field, click on the excel button and give a 'reference' name 
of qty to the cell.</p>
<img src="example_2_excel_field1.png" ><p >
Select the extension field, click on the excel button and give a 'reference' 
name of extn to the cell. Then select 'insert-cell' 'price' from the insert menu 
hyperlink menu,</p>
<img src="example_3_excel_field1.png" ><p >
Enter '*' symbol to multiply the content of the cell, then select insert cell 
qty.</p>
<img src="example_4_excel_field1.png" ><p >
Your expression for the excel extension price cell should now read 
{@cell:price}*{@cell:qty} - this will expand to a formula that references these 
two cells when the report is printed, making the spreadsheet calculation live.</p>
<img src="example_5_excel_field1.png" ><p >
Select the summary expression field in the group footer, click on the excel 
button and give a 'reference' name of subtot to the cell. Select the 'Insert 
summary' option, and with current column selected, pick detail as the summarize 
all option.</p>
<img src="exceldocumentation/example_6_excel_field1.png" ><p >
This should create an excel SUM() expression template that will summarize a 
range of values in the report detail.</p>
<img src="example_7_excel_field1.png" ><p >
When you save and run the report, you will see that all the extension fields 
reference the cells holding the Price and Quantity to calculate the extension 
price.</p>
<img src="example_8_excel_field1.png" ><p >
When you examine the group footer subtotal, you will notice that it created an 
expression that summarizes all the cells in the detail section for the given 
invoice.</p>
<img src="example_9_excel_field1.png" ><p >
Now we are going to create a grand total of all the summary expression. To do 
this first select 'Convert summary calculation to a named calculate field' 
hyperlink in the cell containing the subtotal.</p>
<img src="example_10_excel_field1.png" ><p >
Next, turn on the report footer, and add a summary of the newly converted 
subtotal calc field.</p>
<img src="example_11_excel_field1.png" ><p >
Now you will need to hand code the template for the grand total - if you used 
the normal summarization, you would end up with a total of all the detail 
records added to the subtotals (which gives you more records than you want). 
Excel ranges ca be a list of individual cells, but to get this list you must use 
the @collect placeholder which collects cell references from the report - wrap 
the template in the SUM() function.</p>
<img src="example_12_excel_field1.png" ><p >
Now when you save the report, and generate an excel file from it, you will see, 
when you examine the grand total field, that the formula references all the 
subtotal cells added together.</p>
<img src="example_13_excel_field1.png" ></body></html>