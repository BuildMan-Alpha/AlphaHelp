	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<h1>New Form, browse, report, and editing layouts V9</h1>
<h2>Supercontrols</h2>
<p>Supercontrols are a new type of high level control that can be placed on Form 
layouts. Some supercontrols can also be placed on Report layouts. Supercontrols 
are discussed in detail in the 'Supercontrols' section.</p>
<h2>Static HTML Object</h2>

<p>Alpha Five now supports a new object type that can be 
placed on Forms, Reports, Labels and Letters. The static 
HTML object is similar to the static RTF object, but it 
contains HTML text and it gives you much more 
flexibility in laying out the contents of the object 
than the static RTF object offers. Just like the static 
RTF object, the static HTML object can contain 
placeholders for the fields, calculated fields, and 
variables in your layout. The static HTML object can also contain clickable 
hyperlinks that invoke Xbasic scripts.</p>
<h3>Placing a Static HTML Object on a Layout</h3>

<p>To place a static HTML object on a Layout, you use 
the new 'Static HTML' tool in the toolbox:</p>
<table border="0" id="table52">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/What's30.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Toolbox showing the Static HTML Object</td>
</tr>
</table>
<p>&nbsp;</p>
<p>Draw the object onto the layout. The object shows a button with a pencil in 
the top right corner. Click on this button to open the Static HTML editor.</p>
<p>Notice that the toolbar in the editor contains a 'Fields...' button. When you 
click this button, a list of fields and variables in the current layout is 
displayed. You can place these fields in your static HTML. When the form is run, 
these fields show data from the current record. Notice also, that the toolbar 
contains a button labeled 'Xbasic...'. This allows you to put a hyperlink in 
your HTML that will execute Xbasic code.</p>
<p>&nbsp;</p>
<table border="0" id="table62">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA45.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">HTML Editor for Static HTML Objects</td>
</tr>
</table>
<p>&nbsp;</p>



































<h3>Placing Fields and Expressions in the Static HTML Object</h3>


















<p>To place a field (including calculated fields that were previously defined by 
clicking the XY button on the toolbar) into the static HTML object, click the 
'Fields...' icon on the toolbar. A pop-up field Drag&Drop list appears. </p>
<p>&nbsp;</p>
<table border="0" id="table63">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/What's32.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Fields DragDrop List in the Static HTML Editor.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Drag fields from the list and drop them into the editor. The field 
placeholders are shown in the HTML enclosed in curly braces. For example:</p>
<p class="xbasic">Customer Lastname: {lastname}</p>
<p>You can actually enter any valid Xbasic expression in the curly braces. This 
allows you to define calculated fields on-the-fly. For example.</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; We will be visiting your location at {alltrim(city) 
+ ", " + alltrim(state) + " " + zip} next week.</p>
<p>&nbsp;</p>
<p>The image below shows a static HTML object on a form at run-time and at 
design-time.&nbsp; Notice that the HTML contains both static text and field 
place holders. At run-time, the field placeholders are replaced by values from 
the current record. The HTML also contains a hyperlink that will open another 
form to edit this customer information.</p>
<table border="0" id="table64">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA46.jpg"></td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA47.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Form with a Static HTML Object at Run-time.</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Form with a Static HTML Object at Design-time.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>The HTML in the static HTML object is rendered using Alpha's built-in HTML 
rendering engine (and not Internet Explorer). As a result, features such as 
transparent backgrounds for the HTML object are supported. This is important if 
your form background has a gradient background. The gradient background will 
'shine through' your HTML object, as shown below.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table border="0" id="table65">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA4.gif"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">HTML Object can have a transparent background.</td>
</tr>
</table>
<p class="ImageCaption">&nbsp;</p>
<h3>Suppressing Blank Lines in HTML Text</h3>
<p>Like the static RTF object, it is often desirable to suppress blank lines in 
the HTML text (resulting from fields that have no data in them, such as an 
'Address2' field). No special action is necessary to cause blank lines to be 
suppressed (unlike the RTF object, where it is necessary to use Shift+Enter to 
terminate a suppressible line). If you simply press Enter at the end of a line 
that has a suppressible field in it, the line will be wrapped in <p> </p> tags, 
and will be suppressed if empty. </p>
<p>Note however, that if you press Shift+Enter at the end of the line, the line 
will have not get wrapped in <p> and </p> tags, and instead will have a trailing 
<br> tag and in this case, it will <b>not</b> be suppressed.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<table border="0" id="table76">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<img border="0" src="images/NewInA6.gif"></td>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">
		<img border="0" src="images/NewInA7.gif"></td>
		
	</tr>
	<tr>
		
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<img border="0" src="images/NewInA8.gif" width="75%" height="75%"></td>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<img border="0" src="images/NewInA9.gif" width="75%" height="75%"></td>
	</tr>
	<tr>
				<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" class="ImageCaption">
		Static HTML with suppressible blank lines. Notice that each line is 
		wrapped in <p> </p> tags<p>because user pressed Enter at end of each 
		line</td>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" class="ImageCaption">
		Static HTML with non-suppressible blank lines. Notice that each line is 
		terminated with <br> because<p>user pressed Shift+Enter at end of each 
		line.</td>
	</tr>
</table>
						<p>&nbsp;</p>
<p><a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/staticHTMLObject.swf">Watch a demonstration of static HTML objects</a></p>




































<p class="ImageCaption">&nbsp;</p>



































<h2>Date Picker, Date/Time Picker and Time Picker Smart Fields</h2>


















<p>The date picker control has a fresh new look, and two new smart fields have 
been defined. The date/time picker can be used for Time fields and the Time 
picker can be used for shorttime fields.</p>
<p><a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/formsSmartFields.swf">Watch a demonstration of the new 
date/time picker and the new time picker smart fields</a></p>




































<h2>Inserting GUIDs into Fields</h2>
<p>It is now easier to insert GUIDs into fields. A GUID (Globally Unique ID) is 
a special unique value. You can insert a GUID into a field when you are editing 
a record by using the new Edit, Insert, GUID command. You can also use the 
Shift+Ctrl+G shortcut.</p>
<h2>HTML Bubble Help</h2>


















<p>Most of the controls on an Alpha Five form allow 
you to define bubble help that is displayed when the 
mouse hovers over the control. You can now use HTML 
to define the bubble help. This gives you enormous 
control over how the bubble help will look. HTML Bubble Help can display data 
from the current record (including images) and it can contain hyperlinks that 
execute Xbasic code. This allows you to create dynamic bubble help and expand 
the ways in which bubble help can be used.</p>
<p>For example, bubble help can now be used to display more detail for a 
particular object on a form. Say for example, your form contains an image field. 
To conserve space on the form, you might have defined the image object to be 
quite small. You can define bubble help for this image object to display a 
larger view of the image when the mouse is over the image. Or you might have 
bubble help that displays additional detail about the record you are viewing. </p>
<p>Note: You can now also specify the delay before the bubble help is displayed 
for each control. This is useful because bubble help now can have several 
different purposes. In some cases, it is intended to give help to a user who 
might not be sure what a particular control's purpose is. In this case a small 
delay before showing the help is appropriate. In other cases, bubble help might 
be to show a larger image for a thumbnail image, or more details about a 
particular record. In these cases, you might not want any delay before showing 
the bubble help.</p>
<p>The Bubble Help Editor has been redesigned for Version 9. When you define 
Bubble Help for a control, click the 'Edit...' button to bring up the Bubble 
Help Editor. You can choose the bubble help style. With each selection, the 
editor changes to present the appropriate options to the user.</p>
<p>&nbsp;</p>
<table border="0" id="table67">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA53.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Editor for unformatted bubble help.</td>
</tr>
</table>



































<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table border="0" id="table68">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA54.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Editor for bubble help with simple formatting.</td>
</tr>
</table>



































<p>&nbsp;</p>
<p><a name="FormsBubbleHelpEditor"></a> </p>
<table border="0" id="table41">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA52.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Editor for HTML format bubble help.</td>
</tr>
</table>



































<p class="ImageCaption">&nbsp;</p>
<p>To place fields in the bubble help, click the 'Field DragDrop List' button. 
This opens a window showing all of the fields in the table(s) on which the 
current form is based. Drag fields from the list and drop them into the editor. 
Fields are placed into the text enclosed in curly brackets. For example: </p>
<p class="xbasic">{firstname} {lastname} </p>
<p class="xbasic">&nbsp;</p>
<p>would display the firstname and lastname from the current record. </p>
<p>You can enter any valid expression, not just simple fieldnames. For example, 
you might enter this into the bubble help:</p>
<p class="xbasic">{alltrim( upper(lastname) ) + ", " + alltrim( upper(firstname) )}</p>
<p>&nbsp;</p>
<p>to display names in this format: SMITH, JOHN.</p>
<p>&nbsp;</p>
<p>When you please an image field in the HTML, Alpha Five will automatically 
wrap the fieldname in an special function. This function generates the special 
HTML syntax for displaying images.</p>
<p>For example, when you drag a field called MyImage (assume that this is a 
Jpeg, Bitmap, or Linked Image field) from the DragDrop list to the Bubble Help 
editor, you will notice that Alpha Five will actually insert the following 
expressions:</p>
<p class="xbasic">a5_HTML_extended_image_field_format("MyImage","")</p>
<p>&nbsp;</p>
<p>The second argument to this function is optional, but can be used to insert 
any additional markup that you want in the <img> tag that this function will 
generate at runtime. For example, if you want the image to be 3 inches wide by 5 
inches high, with a title of 'My image', you would modify the expression as 
follows:</p>
<p class="xbasic">a5_HTML_extended_image_field_format("MyImage","style=\"width: 
3in; height: 5in;\" title=\"My image\"")</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Hyperlinks in Bubble Help</h3>
<p>You can place hyperlinks in your bubble help that open other web pages in 
another small window or that execute Xbasic code. To place a hyperlink that 
executes Xbasic code, click the 'Hyperlink for Xbasic Action' button. This will 
open the dialog shown below where you can define your Xbasic script:</p>
<table border="0" id="table69">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA55.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Defining a Hyperlink to execute Xbasic code.</td>
</tr>
</table>



































<p>&nbsp;</p>
<p>
<a target="A5video" href="http://www.alphasoftware.com/VideoNewV9/DefiningHTMLBubbleHelp.swf">
Watch a video demonstration of defining HTML bubble help</a>.</p>



































<h2>Static Bitmap Objects - Bubble Help</h2>
<p>You can now define bubble help for static bitmap objects on forms. This is 
useful if you have a bitmap that represents a target for the user to hold the 
mouse over and then display HTML bubble help with more details about the current 
record.</p>
<h2>User Defined Smart Fields</h2>
<p>You can turn any field in a Form into a smart field. When the field has 
focus, an icon is displayed next to the field and when the user clicks the icon 
an event is fired.</p>
<p>In the image below, the 'Filename' column has focus, and the smart field 
button is shown in the row that has focus.</p>
<p>&nbsp;</p>
<table border="0" id="table61">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/NewInA42.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">User Defined Smart-Fields.</td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>
<p>To define a smart-field, right click on the field and select Properties. On 
the 'Setup' tab, check the 'User Defined Smart Field' checkbox.</p>
<p>You can also define a smart field through Xbasic by setting the field's 'Focus_button' property to 
the name of the icon to use. You can set this property in the Form's OnInit event.</p>
<p>Note that the control does not normally instantiate a 'focus_button' 
property, so the .Property_Add() method must be used to set the property value 
for the first time.</p>
<p>For example, here is the OnInit event for the above form ('filename' is the 
name of the object that is bound to the 'filename' field) :</p>
<p class="xbasic">filename.Property_Add("focus_button","$a5_open")<br>
&nbsp;</p>



















<p>If you wanted to set a column in an embedded browse to be a smart field, you 
would use syntax like this in the form's OnInit event (where 'browse1' is the 
name of the embedded browse object):</p>
<p class="xbasic">browse1:filename.focus_button = "$a5_open"</p>
<p>&nbsp;</p>
<p>To define the event handler for the smart field button, you place code in the 
control's OnPush event.</p>
<p>For example:</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; dim fn as c </p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; fn = ui_get_file("Filename","")</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; if fn <> "" then </p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename.text = fn
</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; end if </p>
<p>&nbsp;</p>
<p>Note: User defined smart-fields can also be defined for Browses.</p>
<p> <a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/UserDefinedSmartFields.swf">Watch 
a video demonstration of this feature</a>.</p>
<h2>Capsule Border Style</h2>
<p>Objects on forms now support a new 'capsule' border style. </p>

<table border="0" id="table70">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/WorkIn4.gif"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">Capsule button style </td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>
<p>By turning off one of the object edges, as shown below, you can get great 
looking buttons.</p>

<table border="0" id="table71">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/WorkIn6.gif"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">Capsule button style with left and <br>
		right edges turned off on respective buttons.</td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>

<table border="0" id="table73">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/WorkIn40.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">Multi-state button with capsule style border.</td>
	</tr>
</table>
						<h2>Improved Anchor Toolbar</h2>
<p>The Anchor toolbar has been improved. It now supports special 'quick select' 
buttons on each corner that turn on the necessary anchors. For example, if you 
click the top right button, the 'anchor to top' and 'anchor to right' buttons 
are automatically selected.</p>

<table border="0" id="table72">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/WorkIn41.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">New 'Anchor' toolbar</td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>
<h2>Remembering Last Run Query</h2>
<p>In versions of Alpha Five prior to V9, if you did not explicitly define a 
filter and order for a Form or Browse layout, then when you opened the layout, 
Alpha Five would use the last run query for the table on which the Form or 
Browse was based. This would sometimes confuse users because if a script had run 
a query that found no records (and had not set the 'Do not remember query' 
flag), then when the user opened a Form or Browse that was based on that table, 
the Layout would be in Enter New Record mode because the remembered query had no 
records.</p>
<p>In V9, the Form and Browse Properties dialog has a new flag on the 
Filter/Order tab. Unless you explicitly check the 'Use last run query' box, when 
you open a Form or Browse layout now, if you have not defined a filter 
expression, the Layout opens showing an unfiltered view.</p>
<p>&nbsp;</p>

<table border="0" id="table74">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/NewInA58.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">Filter/Order Property Pane</td>
	</tr>
</table>
						<p>&nbsp;</p>
<h2>User Defined Formatting</h2>
<p>When you place a field object on a layout, you can define the formatting for 
the object by right clicking on the object and brining up the Properties Dialog, 
navigating to the 'Format' tab and then selecting a style from the 'Format 
Style' dropdown box. While Alpha Five already offers a large number of 
formatting styles, there is always the possibility that you have some special 
requirement. Now, you can define your own format styles and they will 
automatically appear in the list.</p>
<p>To define a format style you must create a UDF (User Defined Function) with a 
name that follows a special naming convention. The drop down list of available 
format styles will display the text in the function description. </p>
<p>The table below summarizes the naming convention and function prototype that 
you must create for each data type.</p>
<p>&nbsp;</p>


















<table id="table75" style="BORDER-COLLAPSE: collapse" cellSpacing="1" cellPadding="3" border="1">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
<b>Data Type</b></td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<b>Sample Function Prototype</b></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Numeric</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<p class="xbasic">function entry_format.num.<i>formatName</i> as c (<i>value</i> 
as n, <i>width</i> as n, <i>decimals</i> as n)<br>
'DESCRIPTION:Description of format goes here<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.num.<i>formatName 
= return_formatted_value</i></p>
<p class="xbasic">end function </td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Character</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<p class="xbasic">function entry_format.char.<i>formatName</i> as c (<i>value</i> 
as c, <i>width</i> as n)<br>
'DESCRIPTION:Description of format goes here<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.char.<i>formatName 
= return_formatted_value</i></p>
<p class="xbasic">end function </td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Logical</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<p class="xbasic">function entry_format.log.<i>formatName</i> as c (<i>value</i> 
as l, <i>width</i> as n)<br>
'DESCRIPTION:Description of format goes here<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.log.<i>formatName 
= return_formatted_value</i></p>
<p class="xbasic">end function </td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Date</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<p class="xbasic">function entry_format.date.<i>formatName</i> as c (<i>value</i> 
as d, <i>width</i> as n)<br>
'DESCRIPTION:Description of format goes here<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.date.<i>formatName 
= return_formatted_value</i></p>
<p class="xbasic">end function </td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Time</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" width="929" >
<p class="xbasic">function entry_format.time.<i>formatName</i> as c (<i>value</i> 
as t, <i>width</i> as n)<br>
'DESCRIPTION:Description of format goes here<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.time.<i>formatName 
= return_formatted_value</i></p>
<p class="xbasic">end function </td>
</tr>
</table>
<p>&nbsp;</p>
<p><b>Important:</b> <i>formatName</i> is limited to 6 characters.</p>
<p><b>Note:</b> The function prototype for numeric types passes in decimal 
places, whereas all other types do not.</p>
<p><i>return_formatted_value</i> is the formatted value that your function 
computes.</p>
<p>&nbsp;</p>
<p>Normally, if your formatted value has trailing spaces, Alpha Five will 
suppress trailing spaces when displaying the formatted data. If you want to 
preserve trailing spaces, use the special character, chr(27), rather that a 
space.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Example:</p>
<p>The following user defined format for a numeric field will display '<Zero>' 
is the value is 0, else it will display the number.</p>
<p class="xbasic">function entry_format.num.fmt1 as c (value as n, with as n, 
dec as n)<br>
'DESCRIPTION:Accounting format</p>
<p class="xbasic">if value = 0 then <br>
&nbsp;&nbsp;&nbsp; entry_format.num.fmt1 = "<Zero>"</p>
<p class="xbasic">else</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; entry_format.num.fmt1 = "" + value</p>
<p class="xbasic">end function <br>
&nbsp;</p>
<p>Tip: You can use user defined formats in the str() function. The format code 
would be "U" followed by the function's <i>formatname</i>. In the example above, 
the <i>formatname</i> is 'fmt1', so you can use 'UFMT1' as the format code in 
the str() function.</p>
<p class="xbasic">&nbsp;</p>
<h2>New Format Options</h2>
<p>Two new format options have been added for formatting numeric fields on 
Layouts. These formats are suitable for financial reporting. The formats are:</p>
<p>&nbsp;</p>
<p>'Accounting $ (123,456.34)' which prints positive numbers, negative numbers 
and zeros as follows:</p>
<p class="xbasic">$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (123,456.23)</p>
<p class="xbasic">$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
56,345.21</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
-</p>
<p>&nbsp;</p>
<p>'Accounting&nbsp; (123,456.34)' which prints positive numbers, negative 
numbers and zeros as follows:</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (123,456.23)</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
56,345.21</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
-</p>
<p>Note: The above two formats are actually implemented using the new User 
Defined Formatting option described in the previous section. The function that 
defines the first of the new formatting options is shown below. If you want to 
make modifications to this formatting functions, just create a function based on 
this functions, changing the last part of the function name ('act1')&nbsp; to a 
name of your choice, and update the 'DESCRIPTION' comment.</p>
<p>&nbsp;</p>
<p class="xbasic">function entry_format.num.act1 as c (value as n, width as n, 
dec as n)<br>
'DESCRIPTION:Accounting '$ 234,123.23 ', '$ (234,123.23)', ' - '<br>
'LIMITATIONS:X<br>
if value = 0 then <br>
&nbsp;&nbsp;&nbsp; 'chr(27) adds a non-suppressible blank character at end<br>
&nbsp;&nbsp;&nbsp; entry_format.num.act1 = "-" + chr(27)<br>
else <br>
&nbsp;&nbsp;&nbsp; dim txt as c <br>
&nbsp;&nbsp;&nbsp; dim len as n <br>
&nbsp;&nbsp;&nbsp; dim txt as c <br>
&nbsp;&nbsp;&nbsp; dim padLength as n <br>
&nbsp;&nbsp;&nbsp; txt = str(value,width,dec,",(")<br>
&nbsp;&nbsp;&nbsp; txt = alltrim(txt)<br>
&nbsp;&nbsp;&nbsp; if value < 0 then <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; len = len(txt)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; padLength = width - (len + 1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; txt = "$" + replicate(" ",padlength) 
+ txt <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.num.act1 = txt <br>
&nbsp;&nbsp;&nbsp; else if value > 0 then <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; txt = txt + chr(27)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; len = len(txt)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; padLength = width - (len + 1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; txt = "$" + replicate(" ",padlength) 
+ txt <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; entry_format.num.act1 = txt <br>
&nbsp;&nbsp;&nbsp; end if <br>
end if <br>
end function </p>
<h2>Default Forms</h2>
<p>Previously, when a default form (or a genie generated form) was displayed, 
Alpha Five generated the form showing a colon character at the end of each field 
label. Now, Alpha Five no longer puts in the colon after each field label. </p>
<p>If you prefer to have the colon in the field label, go to View, Settings, 
Preferences, Forms and select colon as the field label terminator.</p>
<h1>Browse Layouts</h1>





















































<h2>Browse - Smart Fields</h2>


















<p>Smart fields are now supported in browse. This means, for example, that you 
can configure a date field in the browse to have a button that opens the date 
picker, or a numeric field with a button that opens the calculator. The 
following smart field controls are supported</p>
<ul>
<li>Date picker</li>
<li>Date/time picker</li>
<li>Time picker</li>
<li>Email - opens either the Alpha Five e-mail client, or your default 
e-mail client with the e-mail address in the current field already filled 
into the e-mail address.</li>
</ul>
<p>To define a smart field, edit the browse layout, right click on a column and 
select Properties, and then choose the Control Type on the Setup pane of the 
Properties dialog box.</p>
<p>You can also use Xbasic automation to set the column's smart field type. For 
example, the following Xbasic command set's the 'orderdate' column smart field 
to a date/time picker.</p>
<p class="xbasic">MyBrowseName:Orderdate.Field.Style = "popup.time"</p>
<p>&nbsp;</p>
<table border="0" id="table42">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/What's29.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Time field in a browse showing the Date/Time 
picker.</td>
</tr>
</table>
<p>&nbsp;</p>



































<h2>Browse - Image Fields</h2>


















<p>Image fields in browse now support the standard image scaling options for 
image fields on Forms. You can now specify Absolute, Best Fit, Tile and Stretch. 
This screenshot shows the Best Fit option.</p>
<p><img border="0" src="images/What's26.jpg"></p>
<p>&nbsp;</p>
<h2>Browse - Bubble Help</h2>
<p>You can now define bubble help for columns in browses. Like bubble help in 
forms, you can use three different syntaxes to define the bubble help - simple, 
Xdialog and HTML. HTML bubble help is extremely powerful because you can create 
dynamic bubble help that references values from the current record.</p>
<p>The image show below illustrates these new features.</p>
<p>When the mouse is over the thumbnail image, the bubble help shows the full 
size image. Underneath the full size image, the person's name is show. This 
illustrates that HTML bubble help is being dynamically constructed using data 
from the current record. </p>
<p>To reference values from the current record in HTML bubble help, you enclose 
an expression in curly braces. For example: </p>
<p class="xbasic">{alltrim(firstname) + " " + alltrim(lastname)}</p>
<p>&nbsp;</p>
<table border="0" id="table54">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/NewInA30.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Browse showing bubble help for the Image column. Bubble 
help shows full size image and name from the current record.</td>
</tr>
</table>
<p class="ImageCaption">&nbsp;</p>
<p><a target="A5video" href="http://www.alphasoftware.com/VideoNewV9/browsesHTMLBubbleHelp.swf">Watch a video demonstration of 
this feature.</a></p>
<p>&nbsp;</p>
<p>Watch a video demonstration of how the bubble help was defined.</p>
<p>&nbsp;</p>
<p>To define bubble help for a browse column, right click on the column (when 
the Browse layout is in design mode), and select Properties. The properties 
dialog now has a new 'Help Entry' tab.</p>
<p>To define advanced bubble help (i.e. bubble help that uses HTML syntax), 
click the 'Edit...' button. This brings up the Bubble Help Editor. See
<a href="#FormsBubbleHelpEditor">Bubble Help Editor</a> for more details.</p>
<p>&nbsp;</p>
<p><img border="0" src="images/NewInA48.jpg"></p>

<h2>Browse Vertical Scrollbar</h2>


<p>The behavior of the vertical scrollbar in both stand-alone and embedded 
browses has been substantially improved. The slider can now be used to set the 
current record, regardless of the current sort order. Previously, the slider 
could only be used if the table was in record number order (which, in the case 
of an embedded browse is never the case). This makes using the vertical 
scrollbar much more natural.</p>
<p>In addition, you can now define bubble help that shows when you are dragging 
on the vertical scrollbar. By default, Alpha Five shows the key value for the 
current record based on the current sort order of the table.</p>
<p>So, if the table was in record number order, as you dragged on the slider, it 
would show the record numbers of the current record in the browse. But, if the 
table was ordered by 'city', then as you dragged on the vertical scrollbar, the 
bubble help would show the different cities in the table.</p>
<p>The text shown in the bubble help is user customizable.</p>
<p>The browse has a new property called 'scrollbar_tooltip' which defines the 
expression for the scrollbar bubble help. </p>
<p>&nbsp;</p>
<table border="0" id="table55">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/NewInA35.jpg" width="75%" height="75%"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Vertical scroll bar on Browse has bubble help showing 
key value of record what would get focus if you stopped dragging on the vertical 
slider.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>To turn off bubble help, set this property to "<none>".</p>
<p>If you leave this property blank, then the bubble help will be set to the 
system default.</p>
<p>The following keywords can be used in the bubble help expression:</p>
<table id="table43" style="BORDER-COLLAPSE: collapse" cellSpacing="1" cellPadding="3" border="1">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
<b>Keyword</b></td>
<td width="1062" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<b>Meaning</b></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
position</td>
<td width="1062" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
The logical record number of the current record in the current 
query. This differs from the physical record number. For 
example, if the table was sorted by 'City' and 'Atlanta' was the 
first city in the table, the logical record number for this 
record is 1 even though its physical record number might be 
12356.</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
extent</td>
<td width="1062" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Total number of records in the current query.</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
key</td>
<td width="1062" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Index key value of the current record. If table is in record 
number order, then record number.</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
order</td>
<td width="1062" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Order expression for the current query. If current query is 
record number then this field returns 'Record Number'.</td>
</tr>
</table>

&nbsp;<p>Example bubble help expressions:</p>
<table id="table44" style="BORDER-COLLAPSE: collapse" cellSpacing="1" cellPadding="3" border="1">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
<b>Expression</b></td>
<td width="848" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<b>Description</b></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
key + " " + int((position/extent)*100) + "%"</td>
<td width="848" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Shows the key value, and the percentage into the current view. 
E.g.&nbsp;&nbsp; "St. Louis 53%"</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
" " + position + " of " + extent</td>
<td width="848" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Shows logical record number of total records in query E.g.:&nbsp;&nbsp; 
"3 of 20"</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
"Record " + position + " of " + extent</td>
<td width="848" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Same as previous example, but adds the constant text 'Record'. 
E.g. "Record 3 of 20"</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top" >
Order + ": " + key</td>
<td width="848" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Shows the order expression and the key value. E.g. "State: MA"</td>
</tr>
</table>



















<p>&nbsp;</p>
<p>To set the bubble help using the Browse Properties dialog, select the Browse 
tab and then click the 'Vertical Slider Properties' button. </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table border="0" id="table57">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/NewInA36.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Editing the slider bubble help property.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>This will open a builder, as shown below:</p>
<p>&nbsp;</p>
<table border="0" id="table58">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/NewInA37.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Genie to define the 'scrollbar_tooltip' property for the 
Browse's Vertical Slider</td>
</tr>
</table>
<p>&nbsp;</p>
<p><a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/browsesVerticalScrollbar.swf">Watch a video demonstration of 
this feature</a></p>
<p>&nbsp;</p>
<h2>Column Ellipses</h2>
<p>You can now set a new property on a browse column to display ellipses in a 
cell when the browse column is too narrow to display all of the text in the 
cell. In the screen shot below, the 'Company' column is too narrow to show the 
full company name for certain of the rows.</p>
<p>To set this property, right click on the Browse column in design mode, and 
select Properties. On the Properties dialog, select the Format tab and set the 
option in the 'Ellipsis' dropdown box. This property can have these values:</p>
<ul>
	<li>None</li>
	<li>End ellipsis - ellipses shown at the end of the text</li>
	<li>Path ellipsis - data is assumed to contain a path name and so the path, 
	but not the filename, is shown with ellipses</li>
	<li>Word ellipsis</li>
</ul>
<p>&nbsp;</p>
<table border="0" id="table56">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/WorkIn38.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">The Company column is formatted to show ellipses 
		for cells that have more text than can be displayed in the given column 
		width.</td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>
<h2>User Defined Smart Fields</h2>
<p>You can turn any column in a Browse into a smart field. When the column has 
focus, an icon is displayed next to the column and when the user clicks the icon 
an event is fired.</p>
<p>In the image below, the 'Filename' column has focus, and the smart field 
button is shown in the row that has focus.</p>
<p>&nbsp;</p>
<table border="0" id="table60">
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption"><img border="0" src="images/NewInA41.jpg"></td>
	</tr>
	<tr>
		<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
		<p class="ImageCaption">User Defined Smart-Fields.</td>
	</tr>
</table>
						<p class="ImageCaption">&nbsp;</p>
<p>To define a smart-field, right click on the column and select Properties. On 
the 'Setup' tab, check the 'User Defined Smart Field' checkbox.</p>
<p>You can also define a smart-field through Xbasic by setting the column's 'Focus_button' property to 
the name of the icon to use.</p>
<p>You can set this property in the Browse's OnInit event (for an embedded 
Browse, you would use the Form's OnInit event).</p>
<p>For example:</p>
<p>&nbsp;</p>
<p class="xbasic">Filename.focus_button = "$a5_open"</p>



















<p>&nbsp;</p>
<p>To define the event handler for the smart field button, you create a function 
in the Browse 'Events' scripts.&nbsp; The function is of the form:</p>
<p>function <i>objectName_FocusButton<x>click</i>()</p>
<p>&nbsp;</p>
<p>For example, in the above case, the object name (i.e. the name of the column 
in the browse that is bound to the 'filename' field) is 'filename'.</p>
<p>When the user clicks the smart field button, Alpha Five will prompt for a 
filename and fill in the data in the browse cell with the user's selection.</p>
<p class="xbasic">function filename_FocusButton<x>click as v ()</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; dim fn as c </p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; fn = ui_get_file("Filename","")</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; if fn <> "" then </p>
<p class="xbasic">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename.text = fn
</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; end if </p>
<p class="xbasic">end function </p>
<p>Note: User defined smart-fields can also be defined for Forms. In the case of 
forms, however, the event handler is defined for the field's OnPush event.</p>
<h1>Report Layouts</h1>


















<p>This section applies to all report types - reports, labels and letters.</p>




































<h2>Interactive Reporting</h2>


















<p>Alpha Five now has new 'interactive reporting' 
features. These features are also sometimes referred to 
a 'drill down' or 'drill through' reporting.</p>
<p>To support interactive reporting, you can now put 
buttons and hot-spots on reports, and you can define 
events that should occur when these buttons or hot-spots 
are clicked. You can also define events for field 
objects on reports (which is essentially equivalent to 
putting a hot-spot object over a field object). You can 
define the code for these events using either Action 
Scripting, or hand-coded Xbasic.</p>
<p>When you preview a report (or label or letter), the 
buttons, hot-spots and fields for which OnPush events 
were defined become 'hot' and clicking on them will 
invoke the event code that you have defined for the 
object.</p>
<p>Typical events that you might define for buttons, 
hot-spots and field objects include:</p>
<ul>
<li>Previewing another report to show more detail 
for the current row in a report - i.e. in a report 
showing a customer list and a balance outstanding 
for each customer, you could click on the 'amount 
due' field to open a report showing all of the 
unpaid invoices included in the amount due.</li>
<li>Opening a form to show more detail for the 
current row - i.e. in a report showing a customer 
list, you could click on a button that was placed 
next to the customer id. This would open a form to 
edit information about the current customers.</li>
<li>Running an Operation - e.g. you might have a 
button on an invoice report that exported all of the 
line items for the current invoice to an Excel file.</li>
</ul>



































<h3>Report Event Context</h3>


















<p>When you invoke an event on an object in a report, 
the 'context' for the event is the current record. For 
example, say that you had a simple report that listed 
customers. In design mode the report will looks like 
this:</p>
<p>&nbsp;</p>
<p><img border="0" src="images/What's3.gif"></p>
<p>&nbsp;</p>
<p>This report shows a 'customer id' field object which 
has been styled to use a blue font with underline and a 
hot-spot object on top of the field.</p>
<p>&nbsp;</p>
<p>At print preview time, the report looks like this:</p>
<p>&nbsp;<img border="0" src="images/What's15.jpg"></p>
<p>&nbsp;</p>
<p>Say that you have the following code in the 
hot-spot's OnPush event:</p>
<p class="xbasic">t = table.current()<br>
dim msg as c <br>
msg = "You clicked on record number: " + t.recno() + " 
which has data for: " + t.eval("alltrim(firstname)+' ' + 
lastname")<br>
msg = msg + crlf(2) + "You can also read data from the 
controls on the report. Here we read the .text property 
of the 'lastname' object: " + lastname.text<br>
msg = msg + crlf(2) + "Here we read the 'lastname' 
object's .value property: " + lastname.value<br>
ui_msg_box("Notice",msg)</p>
<p>&nbsp;</p>
<p>When the report is previewed, and you click one of the 
hot-spots, the context is the 'current record'. This 
means that if you click on the hot-spot in the first 
record shown in the report, the message box will display 
this message:</p>
<p class="xbasic">You clicked on record number: 1 which 
has data for: Michael Graham</p>
<p class="xbasic">You can also read data from the 
controls on the report. Here we read the .text property 
of the 'lastname' object: Graham</p>
<p class="xbasic">Here we read the 'lastname' object's 
.value property: Graham</p>
<p>&nbsp;</p>
<p>The event script evaluates the following expressions, 
shown below with their evaluated value:</p>
<p class="xbasic">t.eval("alltrim(firstname) + ' ' + 
lastname) ---> Michael Graham</p>
<p class="xbasic">lastname.text ---> Graham</p>
<p class="xbasic">lastname.value --> Graham </p>
<p>&nbsp;</p>
<p>Note that in the last two expressions ('lastname.text', 
and 'lastname.value'),&nbsp; 'lastname' is the name of 
the object that is bound to the 'lastname' field in the 
underlying table. It is only coincidence that the object 
name is the same as the field name.</p>
<p>&nbsp;</p>



































<h3>Useful Information for Interactive Report Event Handlers</h3>


















<table style="BORDER-COLLAPSE: collapse" cellSpacing="1" cellPadding="3" border="1" id="table53">
<tr>
<td width="133" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<b>Xbasic Code</b></td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<b>Comment</b></td>
</tr>
<tr>
<td width="133" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Topparent.close()</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Close the report preview window. This would be 
most useful in a page header or page footer 
section, since these sections appear on all 
pages, and only one instance of these sections 
are drawn for each page.</td>
</tr>
<tr>
<td width="133" style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Topparent.preview_get()</td>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
Returns a pointer to the report object that 
contains the report. Gives you access to all of 
the report object methods, such as:<p>&nbsp;</p>
<p>.Next()</p>
<p>.Prev()</p>
<p>.First()</p>
<p>.Last()</p>
<p>.Zoom()</p>
<p>&nbsp;</p>
<p>For example, in the report page header you 
might have a button that was used to navigate to 
the next page in the report. The Xbasic event 
handler would be:</p>
<p>topparent.preview_get().Next()</p>
<p>&nbsp;</p>
</td>
</tr>
</table>
<p>&nbsp;</p>
<p>
<a target="A5Video" href="http://www.alphasoftware.com/VideoNewV9/DrillThroughReportingDemo.swf">
Watch a video demonstration of Interactive Reporting</a></p>
<p> <a target="A5Video" href="http://www.alphasoftware.com/VideoNewV9/DrillThroughReportingHowTo.swf">
Watch a video demonstration of how an Interactive Report is defined</a></p>



































<h2>Reports - Detecting Runtime Calculated Field</h2>

















</h3>


















<p>&nbsp;</p>
<p>Previously, if an error occurred in a calculated 
field when a report, label or letter was printed, Alpha 
Five simply omitted the calculated field from the 
report. Now, a new command is available on the Print 
Preview menu. The View, Show errors... menu option will 
display a dialog showing the name of the calculated 
field, and the error description.</p>
<table border="0" id="table45">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/What's21.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">The 'Show errors..' command shows a dialog with 
calculated fields that have errors.</td>
</tr>
</table>
<p>&nbsp;</p>



































<h2>Arguments in Layout Filters</h2>
<a name="Arguments_in_Layout_Filters"></a>

<p>When you define a Report, Label or Letter, you can store a filter expression 
as part of the layout definition. If you want to use parameters in this filter 
that are prompted for at run-time, you previously used Ask variables. While Ask 
variables are still supported, a new technique, using arguments, is now 
available. Arguments are easier to use than ask variables, and they provide the 
following benefits over ask variables.</p>
<ul>
<li>You can define default values and pick lists for arguments.</li>
<li>You can provide values for argument values using Xbasic - Alpha Five 
will only prompt for argument values that are not supplied.</li>
<li>You can customize some aspects of the dialog that prompt for the 
argument values.</li>
</ul>
<p>When you open the filter/order builder from the layout editor, you will 
notice two new hyperlinks under the Filter textbox. The 'Define filter argument' 
hyperlink will open the 'Define/edit Arguments' dialog (show below) where you 
can define any arguments that you want to use in your filter expression.</p>
<p>&nbsp;</p>
<p>Here are some examples of filter expressions that include arguments:</p>
<p class="xbasic">InvoiceDate >= :startDate .and. InvoiceDate <= :endDate</p>
<p class="xbasic">Balance > :whatBalance .and. AccountType&nbsp; = :whatAccountType</p>
<p class="xbasic">FlagOverdue = :Overdue</p>
<p>&nbsp;</p>
<table border="0" id="table46">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top"><img border="0" src="images/What's9.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Select Records dialog now allows you to define 
arguments and use them in your filter expression.</td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top"><img border="0" src="images/What's10.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Dialog allows you to define arguments and 
customize the dialog box that prompts for the argument values.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>When the layout is printed using Xbasic (by calling the report.print(), 
report, preview(), letter.print(), letter.preview(), label.print() or 
label.preview() method), you can optionally provide argument values. </p>
<p>The following example show how one might use the report.preview() method to 
preview a report for which arguments have been defined:</p>
<p>&nbsp;</p>
<p>Examples:</p>
<p class="xbasic">'In this example, arguments are not supplied, so a dialog box 
will be displayed, asking for the value for the ':whatstate' argument.</p>
<p class="xbasic">report.preview("CustomerList")</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">'In this example, arguments are passed in, and so no dialog 
box will be displayed asking for argument values.</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("whatState","MA")</p>
<p class="xbasic">report.preview("CustomerList","","",.f.,.f.,args)</p>
<p>&nbsp;</p>



































<h2>Using Arguments in Run-time Filters</h2>


















<p>When you print a layout using Xbasic, Alpha Five has always allowed you to 
supply a run-time filter (which is in addition to any filter that might have 
been defined as part of the layout definition). You can now use arguments in 
run-time filters. </p>
<p>All of the <layout>.print() and <layout>.preview() methods now accept an 
optional arguments parameter. </p>
<p>The following example shows how a run-time filter can be defined using 
arguments:</p>
<p>&nbsp;</p>
<p class="xbasic">dim args as sql::arguments<br>
args.set("whatstate","ma")<br>
report.preview("customer List","bill_state_region = :whatstate","",.f.,.f.,args)<br>
<br>
&nbsp;</p>
<p>Note that in the above example, since the argument's value was passed in, 
there was no need to prompt for the its value. </p>
<p>It is not required that you pass in argument values - you can have Alpha Five 
prompt for the values. However, if you want to have Alpha Five prompt for 
argument values you must pass in the argument definitions to the method. To pass 
in argument definitions, you set the .argumentdefinitions property in the 
optional 'options' argument.</p>
<p>To define arguments, you can use the a5_definearguments() function.</p>
<p>In the following example, the 'whatState' argument is defined and stored in a 
string, then the definition is passed in when the report.preview() method is 
called. A value for 'whatState' is NOT passed in, so Alpha Five will prompt for 
the value.</p>
<p>&nbsp;</p>
<p>Example: </p>
<p class="xbasic">'Define the 'whatstate' argument</p>
<p class="xbasic">txt = a5_definearguments()</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">'Now that we have the argument definition stored in a string, 
we can pass it into report.preview()</p>
<p class="xbasic">dim options as p </p>
<p class="xbasic">options.argumentdefinitions = txt </p>
<p class="xbasic">'Notice that we are not passing in any argument values, so 
null_value() must be specified for the optional</p>
<p class="xbasic">'arguments parameter.</p>
<p class="xbasic">report.preview("customer List","bill_state_region = :whatstate","",.f.,.f.,null_value(),options)</p>
<p class="xbasic">&nbsp;</p>
<h2>Printing Argument Values in Layouts&nbsp;&nbsp; </h2>
<p>When you use an argument in a report filter, or you pass in arguments to the 
<layout>.print(), <layout>.preview(), <layout>.saveAs() etc. methods, you may 
want to print out the value of the argument on the layout.</p>
<p>To do this, you define a calculated field that uses the a5_getArgumentValue() 
function.</p>
<p>For example, say you have defined a report with a filter of:</p>
<p class="xbasic">&nbsp;&nbsp;&nbsp; orderdate >= :startdate .and. orderdate <= 
:enddate</p>
<p>&nbsp;</p>
<p>You also <a href="#Arguments_in_Layout_Filters">define these arguments</a> in 
the report. </p>
<p>When the report is printed, you want to print out the value that the user 
entered for 'startdate' and 'enddate'.</p>
<p>To do this, you define two calculated fields:</p>
<p class="xbasic">startdatevalue = a5_getArgumentValue("startdate")</p>
<p class="xbasic">enddatevalue = a5_getArgumentValue("enddate")</p>
<p>&nbsp;</p>
<p>You can then place these calculated fields on your layout.</p>
<p>Note that a5_getArgumentValue() always returns a character value, regardless 
of the data type of the argument. If you need to convert the value returned by 
a5_getArgumentValue() to a specific type, you can use the convert_type() 
function. For example:</p>
<p>&nbsp;</p>
<p class="xbasic">startdatevalue = 
time("dd-MON-yyy",convert_type( a5_getArgumentValue("startdate"),"t") )</p>
<p>&nbsp;&nbsp;&nbsp; </p>
<p>This will report the date in this format: 13-DEC-2009</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Save Reports as Excel Files</h2>
<p>You can now save Reports, Labels and Letters as Excel files. </p>
<p>&nbsp;</p>
<table border="0" id="table59">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption"><img border="0" src="images/NewInA39.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">The Report 'Save-As' dialog showing the new Excel 
option.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>The Report.SaveAs(), Letter.SaveAs(), Label.SaveAs(), Form.SaveAs() and 
Browse.SaveAs() methods now all accept "Excel" as an argument value for the <i>
save_as_format</i> argument.</p>
<p>&nbsp;</p>
<h1>Editing Layouts</h1>



































<h2>Dynamic Guidelines</h2>


















<p>When you are designing a Form, Report, Label or Letter layout the new 
'dynamic guidelines' feature makes it much easier to line up objects on your 
layout. When dynamic guidelines are turned on and you are moving or resizing an 
object, as soon as the object is aligned (within a user specified tolerance) to 
another object, dynamic guidelines are drawn on the screen.</p>
<p>&nbsp;</p>
<table border="0" id="table49">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/What's25.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">Dynamic Guidelines at work. Button2 is being 
moved. The blue rectangle shows where Button2 has been dragged <br>
(but not yet dropped) on the form. The dynamic guideline shows that the 
top of Button2 would be aligned with <br>
the top of Button1 if it were dropped now.</td>
</tr>
</table>
<p>&nbsp;</p>
<p>To turn on dynamic guidelines, select the Form, Dynamic Guidelines... 
command. In the case of Reports, this command is under the top-level Reports 
command. In the case of Letters, it is under the top-level Letters command, and 
in the case of labels, it is under the top-level Labels. command.</p>
<p>The dialog allows you to specify if the dynamic guidelines feature should be 
turned on, what the snap tolerance should be. For example, if the snap tolerance 
is set to 10 pixels, then when you are moving an object, if the top of that 
object is within 10 pixels of the top of another object and you drop the object, 
its top will be aligned with the top of the other object.</p>
<p>&nbsp;</p>
<table border="0" id="table50">
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<img border="0" src="images/What's24.jpg"></td>
</tr>
<tr>
<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top">
<p class="ImageCaption">The 'Dynamic Guidelines' dialog box.</td>
</tr>
</table>
<p class="ImageCaption">&nbsp;</p>
<p>TIP:&nbsp; When dynamic guidelines are turned on, you may find it easier to 
work with the layout if you turn off 'snap to grid' and the display of grid 
lines. See the Grid... command.</p>
<p>&nbsp;</p>
<p><a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/DynamicGuideLinesMovingButton.swf">Watch a video demonstration of 
this feature.</a></p>
<p><a target="a5video" href="http://www.alphasoftware.com/VideoNewV9/DynamicGuideLinesEditReport.swf">Watch a video demonstration of 
this feature in the Report Editor.</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:New+Form%2C+browse%2C+report%2C+and+editing+layouts+V9">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop,review","status":"pending","notes":"delete or incorporate? extended list of features but for version 9","keywords":"index,rtf"}--->
</body></html>