	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2 class="showhide_heading" id="Forms_-_Slow_Forms_Because_of_Many_Calculated_Fields">Forms - Slow Forms Because of Many Calculated Fields</h2>
Some users have created forms with a huge number of calculated fields, some of which use table summary functions, such as Total(). Table summary functions can be relatively slow, especially if the table being summarized has a large number of records.<br />
<br />
Forms with a large number of calculated fields can be very slow because of the amount of time it takes to recalculate all of the calculated field. Since Alpha Five recalculates calculated fields when data on the form changes, the form appears to be sluggish because Alpha Five is constantly recalculating the calculated fields.<br />
<br />
Now, you can control when a calculated field is recalculated, allowing even the most complex forms to perform well. A new function, *when() allows you to control when a particular calculated field is recalculated. You can define a watch expression to control when the calculated field is recalculated. When the watch expression changes, the calculated field is recalculated. For example, say that you have the following calculated field:<br />
<br />
<span style="color:blue; background:">totalDue = total(calc-&gt;extendedTotal,grp-&gt;invoice_items)</span><br />
<br />
<br />
This calculated field sums up the extendedTotal field for every record in the invoice_items table. Obviously, the more records there are in invoice_items, the slower the calculation will be.<br />
<br />
Say we only wanted to recalculate the total when we move to a new record in the form. In this case we define the watch expression as recno(). The calculated field then becomes:<br />
<br />
<span style="color:blue; background:">totalDue = *when( recno(),total(calc-&gt;extendedTotal,grp-&gt;invoice_items)  )</span><br />
<br />
<br />
When you move to a new record in the form, recno() changes value. So the expression gets recalculated.<br />
<br />
The watch expression can be as complex as you want. For example, say that you want to recalculate an expression whenever:<br />
<ul><li>the user navigates to a new record
</li><li>the user saves changes to the current record
</li></ul><br />
Here is how you could do this:<br />
<ul><li>Define a new Shared variable (called say 'saveCount', with an initial value of 0) in the Form (by clicking on the V button on the toolbar). Be sure to make the variable a Shared variable.
</li><li>In the onSave event, add this code:
</li></ul><span style="color:blue; background:">saveCount = saveCount + 1 </span><br />
<br />
<ul><li>Define a new calculated field as follows:
</li></ul><span style="color:blue; background:">recalcCounter = recno() + saveCount</span><br />
<br />
<ul><li>Define the calculated field as follows:
</li></ul><span style="color:blue; background:">totalDue = *when(calc-&gt;recalcCounter,total(calc-&gt;extendedTotal,grp-&gt;invoice_items))</span><br />
<br />
<br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Forms+Slow+Forms+Because+of+Many+Calculated+Fields+V10.5">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: "{}" --->
</body></html>