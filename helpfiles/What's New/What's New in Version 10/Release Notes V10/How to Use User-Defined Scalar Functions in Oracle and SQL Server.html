	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			 <h1>How to Use User-Defined Scalar Functions in Oracle and SQL  Server</h1>
<p>You can either use the function in a SELECT statement, or  execute the call in a PL/SQL script. The complete XBasic scripts are shown below  for both Oracle and SQL Server. In summary:<br />
<br />
The correct syntax to select  the result of a scalar function in Oracle is:</p>
<p class="xbasic"><br />
?c.Execute("select COUNT_EMP(:lower, :upper) as l_Count from  dual")<br />
?c.resultset.data("l_count")<br />
&nbsp;</p>
<p><br />
To retrieve output parameters from a stored procedure or function you can  add an argument to the SQL::Arguments object for each output parameter as  follows:<br />
&nbsp;</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("l_count", 0, SQL::ArgumentUsage::OutputArgument)</p>
<p class="xbasic">?c.execute("begin :l_count := COUNT_EMP(:lower, :upper); end;",  args)</p>
<p class="xbasic">?args[3].Data<br />
<br />
&nbsp;</p>
<p>Notes: <br />
<br />
The value SQL::ArgumentUsage::OutputArgument indicates  that the parameter is output only. There is an enumerated value for each of  (input, output and input/output).<br />
<br />
The SQL is wrapped in a BEGIN/END pair.  This seems to be required by OCI for the script to execute  properly.<br />
&nbsp;</p>
<h2><b>Calling a user defined scalar function using  Oracle<br />
</b></h2>
<p>1. Getting the result of the function using a SELECT  statement<br />
&nbsp;</p>
<p class="xbasic">dim c as sql::connection</p>
<p class="xbasic">?c.open( ("::Name::Oracle") )?c.open( ("::Name::Oracle") )</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("lower", 1)</p>
<p class="xbasic">args.add("upper", 100)</p>
<p class="xbasic">?c.execute("select COUNT_EMP(:lower, :upper) as l_Count from  dual", args)</p>
<p class="xbasic">?c.resultset.data("l_count")<br />
&nbsp;</p>
<p>2. Getting the result of the function using SQL::Arguments</p>
<p class="xbasic"><br />
dim c as sql::connection</p>
<p class="xbasic">?c.open( ("::Name::Oracle") )</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("lower", 1)</p>
<p class="xbasic">args.add("upper", 100)</p>
<p class="xbasic">args.add("l_count", 0, SQL::ArgumentUsage::OutputArgument)</p>
<p class="xbasic">?c.execute("begin :l_count := COUNT_EMP(:lower, :upper); end;",  args)</p>
<p class="xbasic">?args[3].Data<br />
&nbsp;</p>
<h2><b>Calling a user defined scalar function using SQL Server</b></h2>
<p>1. Getting the result of the function using a SELECT statement  &nbsp;</p>
<p class="xbasic"><br />
dim c as sql::connection</p>
<p class="xbasic">?c.open( ("::Name::SQLServer") )</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("lower", 1)</p>
<p class="xbasic">args.add("upper", 100)</p>
<p class="xbasic">?c.execute("select dbo.COUNT_EMP(:lower, :upper) as l_Count",  args)</p>
<p class="xbasic">?c.resultset.data("l_count")<br />
&nbsp;</p>
<p>2. Getting the result of the function using SQL::Arguments.</p>
<p class="xbasic">dim c as sql::connection</p>
<p class="xbasic">?c.open( ("::Name::SQLServer") )</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.add("lower", 1)</p>
<p class="xbasic">args.add("upper", 100)</p>
<p class="xbasic">args.add("l_count", 0, SQL::ArgumentUsage::OutputArgument)</p>
<p class="xbasic">?c.execute("select :l_count = dbo.COUNT_EMP(:lower, :upper)",  args)</p>
<p class="xbasic">?args[3].Data</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+Use+User-Defined+Scalar+Functions+in+Oracle+and+SQL+Server">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: "{}" --->
</body></html>