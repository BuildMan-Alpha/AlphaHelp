	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1>Alpha Five Javascript Libraries - The AjaxFormLibrary.JS Library</h1>
<p>These Javascript functions are useful for users who want to hand code Ajax  forms. The function allow you to submit values, create callbacks, populate  specific controls, and reset forms.</p>
<p>The functions are designed to use the ID value of forms and controls.&nbsp;  Therefore, every control, form, or other element should have an ID value.&nbsp; The  exceptions are checkboxes, and radio buttons, where the control name can be  used.</p>
<h2>A5.form.prepare(form_ID)</h2>
<p>An html form element must be �prepared� before the other functions can gather  information.&nbsp; When the page is initialized, this function should be the first  run.&nbsp; The function adds and populates a couple new attributes to every control  such as �a5isdirty� and �a5originalvalue�.&nbsp; These are required to allow the form  to submit properly.&nbsp; When the form is initialized, the original value in the  control is placed in �a5originalvalue� and �a5isdirty� is set to �false�.&nbsp; The  function also adds some event handlers to each control to set the value if  �a5isdirty� to �true� if the value in the control changes.</p>
<p>Example:</p>
<p class="xbasic">< script type="text/Javascript"  language="Javascript"><br />
< !--<br />
function  onPageInitialize()<br />
{A5.form.prepare('my_FORM')}<br />
//--><br />
< /script><br />
< title>Title</title><br />
< /head><br />
< body  on<x>load="onPageInitialize()"><br />
< form id="my_FORM" name="my_FORM"  method="POST" action=""> <br />
&nbsp;</p>
<h3>A5.form.submitReset(form_ID [,keepOldValues] )</h3>
<p>This is similar to A5.form.prepare(), however, it does not create the events  or attributes.&nbsp; If the form was prepared previously, this function will reset  all �a5isdirty� attributes to �false� and set all �a5originalvalue� attributes  to the current value in the control.&nbsp; This is a useful function to run after a  form is �cleared�</p>
<p>If <i>keepOldValues</i> is true, then the controls in the form are reset to  the original values when the form was originally prepared.</p>
<h3>A5.form.submit(action,formID,url)</h3>
<p>This is the primary function to invoke to submit data from the page back to  the server.&nbsp; This action is similar to pressing a submit button on a traditional  form, but has additional functionality.&nbsp;</p>
<p>There are three required parameters</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>action' - name of  the action to invoke in the .a5w page that handles the callback</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'formID' - the ID  of the form</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�url' - the URL of  the .a5w page that will handle the callback</p>
<p><b>Action parameter</b></p>
<p>The action has a number of predefined values. All of the actions submit all  of the input</p>
<p>values in controls inside of the specified form element as a POST.&nbsp; The  action also submits additional values on every submit.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>__FormAction � This  is a variable submitted to define the action taken.&nbsp; Any submit action with  place �submit� in this value.&nbsp; Any other action will place the action name, such  as �initialize� in the value.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>__FormID � This is  the ID of the firm submitted and matched the �formID� input parameter.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>a5DirtyRegions �  This is the ID of any forms submitted that have �dirty� values.&nbsp; This will  almost always be the same as �__FormID�</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">4.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>a5RegionsDirtyValues � This is a list of controls that were found to be  �dirty�.&nbsp; This is useful for updates to create update actions to only update  field values that have changed.</p>
<p><b>Submit actions</b></p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>submit:all � This  action submits all of the original values in every field prefaced with the  pointer �old.� as well as the current values in every control.&nbsp; The �old� values  can be used in UPDATE statements and other actions if desired.&nbsp;</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>submit:dirty � This  action is very similar to �submit:all, except only �dirty� controls are listed  and submitted.&nbsp; Values from �submit:all� can be evaluated on the callback page  to get the same data if required.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>submit:new � This  action just submits all current values in the controls.&nbsp; It does not submit the  �old� values.&nbsp;</p>
<p><b>formID parameter</b></p>
<p>The formID input specifies the ID of the form element that is being  submitted.&nbsp; A single page may have multiple form elements, and it is necessary  to indicate which form is being submitted.&nbsp; This value will be in the submitted  data as __FormID.</p>
<p><b>url Parameter</b></p>
<p>This is the URL of the page to call on submit.&nbsp; This is equivalent to the  �action� attribute of a form element which directs the submit action to open a  particular page.&nbsp; This page or �callback� page contains xbasic code to evaluate  and manipulate the data submitted.&nbsp; If the data is sent to the page with&nbsp;  A5.form.submit(), the page code must test the value in __FormAction to determine  what action was invoked.&nbsp; This would be a typical code snippet on the callback  page to evaluate what code actions to take after submit.</p>
<p class="xbasic">dim __formAction as c = default ""<br />
dim action as c<br />
&nbsp;<br />
if  __formAction = "Submit" then <br />
&nbsp;&nbsp;&nbsp; if  onFormValidate(local_variables())<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  afterFormValidate(local_variables())<br />
&nbsp;&nbsp;&nbsp; end if<br />
else if __formAction =  "Initialize" then <br />
&nbsp;&nbsp;&nbsp; onFormInitialize(local_variables())<br />
end if<br />
&nbsp;</p>
<p>Note that a second possible input variable (�action�) to define an action was  specified.&nbsp; This will be examined in A5.ajax.callback()</p>
<p><b>Optional Fourth Parameter</b></p>
<p>In some cases, it is desirable to submit values that are not in controls  within the specified form.&nbsp; These could be controls in another form element, a  fixed value based on some condition, or any other value available to the page.&nbsp;  These are the values that would be seen after the �?� in a URL, commonly  referred to as the GET or query string. This parameter should have the same  syntax as any GET.</p>
<p>For example, if the submit action is submitting to �calculatesale.a5w� and  you want to send additional parameters of �user=Joe� and �date=20081010� a  normal form element&nbsp; could be:</p>
<p class="xbasic"><form  action="calculatesale.a5w.a5w?user=Joe&date=20081010" method="post"  name="form1" id="form1"></p>
<p>When using the function A5.form.submit() to submit all values from the form  element �form1�, the function syntax would be:</p>
<p class="xbasic">A5.form.submit('submit:new','form1','calculatesale.a5w','user=Joe&date=20081010')</p>
<p><b>NOTE:</b> As of Version 10.5 Build 3616-3623, if you fail to call the A5.form.prepare function first, A5.form.submit will still submit the data in the form. It won't, however, submit the original values in each control on the form in this case.
</p>
<!-- startAnchor --><a name="A5.form.setCtrlDirty(ele)"></a><!-- endAnchor -->
<h3>A5.form.setCtrlDirty(ele)</h3>
<p>If a control is changed by user action, the event handlers created by  A5.form.prepare() will set the control �dirty� when the user leaves the control  However, often a control value is changed by some other action, such as a  Javascript action on the page, an action such as a lookup or date picker.&nbsp; If  the list of �dirty� controls is important for some action, every changed control  must be set �dirty� or it won�t be listed. If the user didn�t directly change  the value, the �dirty� attribute won�t be set.&nbsp; This function allows setting a  control �dirty�.&nbsp; If a control has an ID value of �newdate�, this Javascript  function call will set the �a5isdirty� attribute to �True�.</p>
<p class="xbasic">A5.form.setCtrlDirty('newdate')</p>
<!-- startAnchor --><a name="A5.form.populateSelect(eleId,curValue,data,clearExistingEntries)"></a><!-- endAnchor -->
<h3>A5.form.populateSelect(eleId,curValue,data,clearExistingEntries)<font class="Apple-style-span" face="'Courier New'" size="3"><span class="Apple-style-span" style="font-size: 13px; line-height: 21px;"><br />
</span></font></h3>
<p>Select boxes or dropdowns are common controls on a page.&nbsp; This function  allows populating a dropdown with values from a callback page.</p>
<p>There are four required input parameters</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�eleId� � This is  the ID attribute of the select control</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�curValue� � this  is the value to show as selected when the control is populated.&nbsp; If it is  specified, the control will not show any �blank� or empty option.&nbsp; If it is not  specified (value = ��), a blank option will be shown at the bottom of the list  of options.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�data� � this is  the list of values used to create the option list. It is Javascript array  object.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">4.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>�clearExistingEntries� � this is a True/false input. If true, it clears  any values in the select control on the page before creating the new list.&nbsp; If  false, it does not clear the list.&nbsp; Normally, this should be �true�</p>
<p>�data� can be an array of single values such as:</p>
<p class="xbasic">['AL','MA','TX','VA']&nbsp;</p>
<p>When the list is created the display value and the saved value will be the  same.&nbsp; This would be equivalent to:</p>
<p class="xbasic"><font face="Courier New">< select name="states"><br />
&nbsp;&nbsp;&nbsp;  < option value="AL">AL</option><br />
&nbsp;&nbsp;&nbsp; < option  value="MA">MA</option><br />
&nbsp;&nbsp;&nbsp; < option  value="TX">TX</option><br />
&nbsp;&nbsp;&nbsp; < option  value="VA">VA</option><br />
</select><br />
</font></p>
<p>However, it is often desired to show one value, but select another.&nbsp; The  saved value may be a state code, but the display may be the full state name.&nbsp; If  the an entry in nthe array is itself an array, then the first value in the array  will be the displayed text, and the second will be the returned value. The  following array would create the equivalent select options listed below:</p>
<p class="xbasic">[['Alabama','AL'],['Massachusetts','MA'],['Texas','TX'],['Virginia','VA']]<br />
<br />
< select  name="states"><br />
&nbsp;&nbsp;&nbsp; < option value="AL">Alabama< /option><br />
&nbsp;&nbsp;&nbsp;  < option value="MA">Massachusetts< /option><br />
&nbsp;&nbsp;&nbsp; < option  value="TX">Texas< /option><br />
&nbsp;&nbsp;&nbsp; < option  value="VA">Virginia< /option><br />
< /select><br />
&nbsp;</p>
<p>The full code to set a SELECT with an ID of "Bill_State" to a VALUE of "MA"  using the list of states above, and removing any old entries from the SELECT  would be:</p>
<p class="xbasic">A5.form.populateSelect('Bill_State','MA',[['Alabama','AL'],['Massachusetts','MA'],</br>
['Texas','TX'],['Virginia','VA']],true);</p>
<!-- startAnchor --><a name="A5.ajax.callback(ur<x>l,data)"></a><!-- endAnchor -->
<h3>A5.ajax.callback(ur<x>l,data)</x></h3>
<p>It is often desirable to make a call back to a server side page to return  some value or action, and there is no need to actually submit a form element.&nbsp;  The A5.ajax.callback() function allows sending values back to a page for  processing.</p>
<p>There are two required parameters.</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�url' - the URL of  the .a5w page that will handle the callback</p>
<p style="TEXT-INDENT: -0.5in; MARGIN-LEFT: 0.75in">2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>�data� � The value  pairs to send back to the page.&nbsp; These are the values that would be seen after  the �?� in a URL, commonly referred to as the GET or query string. This  parameter should have the same syntax as any GET.</p>
<p>For example, a common need is to send a couple values back to the page to  tell the page that some action must be taken and there are some values available  for that action.&nbsp; The URL is the callback page, and the data includes any values  to meet that need.&nbsp; In the section on A5.form.submit(), the code snippet for the  callback page included a variable �action�.&nbsp; While this could be any name, it  was used in the �if..else� to determine what code action to take.&nbsp; That code  action may or may not need any additional values for the xbasic on the page.</p>
<p>Example:</p>
<p>A code page named �calculatesale.a5w� contains some Xbasic code to populate a  control named �salestax�.&nbsp; To do this, it needs to be told to run that code  section, and send along a value for state to determine what tax table to use.  The call back function call could be:</p>
<p class="xbasic">A5.ajax.callback('calculatesale.a5w','action=gettaxtable&state='+$gvs('state_ID'))</p>
<p>In this example, the state value was in a control with an ID attribute of  �state_ID�.&nbsp; The function $gvs() is a function the core.js Javascript library to  harvest the value in the control.&nbsp; It is similar to document.getElementById(),  but will harvest a value from any control by ID or name.</p>
<p>The page �calculatesale.a5w� may have some code similar to:</p>
<p class="xbasic">dim __formAction as c = default ""<br />
dim action as c<br />
&nbsp;<br />
if  __formAction = "Submit" then <br />
&nbsp;&nbsp;&nbsp; if  onFormValidate(local_variables())<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  afterFormValidate(local_variables())<br />
&nbsp;&nbsp;&nbsp; end if<br />
else if __formAction =  "Initialize" then <br />
&nbsp;&nbsp;&nbsp; onFormInitialize(local_variables())<br />
else if action  = �gettaxtable�<br />
&nbsp;&nbsp;&nbsp; gettax_table(local_variables())<br />
end  if<br />
&nbsp;<br />
function gettax_table as l(vars as p)<br />
with vars<br />
if  eval_valid(�state�) = .f. then ' the state value was not sent<br />
&nbsp;&nbsp;&nbsp; 'can�t  evaluate, quit<br />
&nbsp;&nbsp;&nbsp; exit function <br />
else if state = ��<br />
&nbsp;&nbsp;&nbsp; 'state has no  value, can�t evaluate, quit<br />
&nbsp;&nbsp;&nbsp; exit function<br />
end if<br />
' ok, all values  known - do something<br />
end with<br />
end function<br />
&nbsp;<br />
</p>
<!-- startAnchor --><a name="A5.ajax.urlEncode(text)"></a><!-- endAnchor -->
<h3>A5.ajax.urlEncode(text)</h3>
<p>This is a Javascript version of the standard Alpha Five function urlEncode()  and is used to encode text so that it can be safely used as part of a URL.</p>
<!-- startAnchor --><a name="A5.ajax.buildURLParam(parameter,value)"></a><!-- endAnchor -->
<h3>A5.ajax.buildURLParam(parameter,value)</h3>
<p>This function can be used when creating a string of data to be passed back to  the server by A5.ajax.callback(). It makes sure that both the value name, and  value have been URL encoded. The 'value' can either be a single value, or an  array of values, allowing you to send back an array to the server.</p>
<p>Example</p>
<p class="xbasic">A5.ajax.buildURLParam('value','my&text');</p>
<p class="xbasic">/* returns: 'value=my%26text'*/</p>
<p>&nbsp;</p>
<p class="xbasic">A5.ajax.buildURLParam('value[]',['my&text','another value in  the array']);</p>
<p class="xbasic">/* returns: 'value[]=my%26text&value[]=another value in the  array'*/</p>
<p>&nbsp;</p>
<!-- startAnchor --><a name="A5.msgBox.show(title,html,type,onClose)"></a><!-- endAnchor -->
<h3>A5.msgBox.show(title,html,type,onClose)</h3>
<p>This function can be used to display a message box in the HTML that is done  entirely in Javascript and HTML meaning that you can present the user with a  customized HTML message. The 'title' contains the title HTML text to display on  the message box. 'html' contains the HTML to display in the body of the message  box. The 'type' is a flag to tell the message box what buttons to display. The  values for this flag are:</p>
<ul>
    <li>"o" - "OK" button.</li>
    <li>"oc" - "OK" and "Cancel" buttons.</li>
    <li>"yn" - "Yes" and "No" buttons.</li>
    <li>"ync" - "Yes", "No" and "Cancel" buttons.</li>
    <li>"none" - no buttons.</li>
</ul>
<p>The 'onClose' argument is a Javascript function that will be called when the  user closes the message box. This function will be passed a string containing  the value of the button the user pressed ("ok", "yes", "no", or "cancel"). ed  ("ok", "yes", "no", or "cancel").</p>
<p>Example</p>
<p class="xbasic">A5.msgBox.show('Save','Do you wish to  save.','ync',function(button){<br />
&nbsp;&nbsp;&nbsp;&nbsp;if(button == 'yes'){<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// code to  save...<br />
&nbsp;&nbsp;&nbsp;&nbsp;} else if(button == 'no'){<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// code to close without  saving...<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
});</p>
<p>As of version 10.5, you can set properties to control the text and class of the OK and Cancel buttons. Example:
</p>
<p class="xbasic">A5.msgBox.buttons.ok = {html: 'My OK HTML', className: 'MyOKButtonClassName'}<br />
A5.msgBox.buttons.cancel = {html: 'My Cancel HTML', className: 'MyCancelButtonClassName'}
</p>

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Alpha+Five+Javascript+Libraries+The+AjaxFormLibrary.JS+Library">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: "{}" --->
</body></html>