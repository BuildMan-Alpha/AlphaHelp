	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2>Stritran_multi_expressions() Function</h2>
<p>The strtran_multi_expressions() (case-sensitive version) and  stritran_multi_expressions() allow you to perform complex 'search and replace'  operations in strings. These functions are extremely versatile because the  replacement strings can be expressions that Alpha Five will evaluate when it  does the replacement.</p>
<p><strong>Syntax:</strong> <br >
C <i>textOut</i> = stritran_multi(C <i>textIn</i>, C  <i>searchReplaceString</i>)&nbsp;</p>
<p style="MARGIN-TOP: 0px; FONT-FAMILY: Tahoma; MARGIN-BOTTOM: 5px; FONT-SIZE: 10pt">Where</p>
<table style="BORDER-COLLAPSE: collapse" id="table60" border="1" cellspacing="1" cellpadding="3">
    <tbody>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="133"><i>textIn</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top">String in  which you want to perform a search and replace operation.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="133"><i>searchReplaceString</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top">A CR-LF  delimited list of search and replace values. Each row in the list has this  format:
            <p>searchString=replacementExpression</p>
            <p>If a&nbsp; replacementExpression contains any search strings, you can force the  replacement to occur recursively by using a double = sign. e.g.</p>
            <p>searchString==replacementExpression</p>
            <p>Each = sign causes an additional recursion. For example:</p>
            <p>searchString===replacementExpression</p>
            <p>will recurse over the data 3  times.</p>
            </td>
        </tr>
    </tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;<strong>Example</strong></p>
<p class="xbasic">dim string as c</p>
<p class="xbasic">string = "Hello {name}. Today is {date}."</p>
<p class="xbasic">dim sr as c</p>
<p class="xbasic">sr = <<%txt%</p>
<p class="xbasic">{name}="Peter"</p>
<p class="xbasic">{date}=date()</p>
<p class="xbasic">%txt%</p>
<p class="xbasic">?stritran_multi_expressions(string,sr)</p>
<p class="xbasic">= Hello Peter. Today is 8/26/2009</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">'Now try recursive replacement</p>
<p class="xbasic">dim string as c</p>
<p class="xbasic">string = "Hello {name}. Today is {date}."</p>
<p class="xbasic">dim sr as c</p>
<p class="xbasic">sr = <<%txt%</p>
<p class="xbasic">{lastname}=="Smith"</p>
<p class="xbasic">{name}="Peter {lastname}"</p>
<p class="xbasic">{date}=date()</p>
<p class="xbasic">%txt%</p>
<p class="xbasic">?stritran_multi_expressions(string,sr)</p>
<p class="xbasic">= Hello Peter Smith. Today is 8/26/2009</p>
<p class="xbasic">&nbsp;</p>
<p>Note that&nbsp; this function looks for the token <em>anywhere</em> in the string - when you have tokens where 
	ONE token is a substring of another token you need to put the longer token 
	first. This can easily be accomplished using the 
<a href="../../../References/Functions/a5_stritran_multi_expression_Prepare Function.html" title="a5_stritran_multi_expression_Prepare Function" class="wiki">a5_stritran_multi_expression_Prepare Function</a>.</p>
<p>For example:</p>
<p class="xbasic">
string = "this is parameter1 and this is parameter10 "<br><br>var1 = "alpha"<br>
var2 = "beta"<br><br><br>sr = <<%txt%<br>#parameter1=var1<br>#parameter10=var2<br>
#%txt%<br><br><br>?stritran_multi_expressions(<wbr>string,sr)<br>= "this is 
alpha and this is alpha0 "&nbsp; ''<<<---- not what we wanted<br><br><br>sr2 = 
a5_stritran_multi_expression_<wbr>Prepare(sr)<br><br>?sr2<span class="Apple-converted-space">&nbsp;</span><br>
= parameter10=var2<br>parameter1=var1<br><br>'sr2 is now sorted by the length of 
the search string (the part before the = sign on each line of the string)<br>
<br><br>?stritran_multi_expressions(<wbr>string,sr2)<br>= "this is alpha and 
this is beta "&nbsp;&nbsp; '<<<<---- this IS what we wanted</p>
<p><b>See also</b></p>
<a href="../../../References/Functions/a5_stritran_multi_expression_Prepare Function.html" title="a5_stritran_multi_expression_Prepare Function" class="wiki">a5_stritran_multi_expression_Prepare Function</a>

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Stritran_multi_expressions+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/References/Functions/Character Functions/Replacement Functions","status":"accept","pagename":""} --->
</body></html>