	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2>Miscellaneous Xbasic Array Improvements</h2>
<!-- startAnchor --><a name="Implicit Array Declaration"></a><!-- endAnchor -->
<h3>Implicit Array Declaration</h3>
<p>When you use the [] syntax to set a property array, you do not need to have  dimmed an array in advance. For example, as shown in this Interactive window  session:</p>
<p class="xbasic">b[] = "alpha"<br />
b[] = "beta"<br />
?b.size()<br />
= 2</p>
<p>This example uses a property array.</p>
<p class="xbasic">a.array[].name = "Alpha"</p>
<p class="xbasic">a.array[..].city = "Burlington"</p>
<p class="xbasic">a.array[].name = "Microsoft"</p>
<p class="xbasic">a.array[..].city = "Seattle"</p>
<p class="xbasic">?a.array.size()</p>
<p class="xbasic">= 2</p>
<p class="xbasic">?a.array.dump_properties("Name|city")</p>
<p class="xbasic">= Alpha|Burlington<br />
Microsoft|Seattle<br />
&nbsp;&nbsp;</p>
<!-- startAnchor --><a name="Dynamic Array Sizing"></a><!-- endAnchor -->
<h3>Dynamic Array Sizing</h3>
<p>When you delete entries from an array, the array size does not change. With  dynamic array sizing turned on, deleting an entry from an array will resize the  array. The following Interactive window session demonstrates:</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">dim array[3] as c</p>
<p class="xbasic">array[1] = "alpha"</p>
<p class="xbasic">array[2] = "beta"</p>
<p class="xbasic">array[3] = "gamma"</p>
<p class="xbasic">?array.size()</p>
<p class="xbasic">=3</p>
<p class="xbasic">array.delete(2,1)</p>
<p class="xbasic">?array.dump()</p>
<p class="xbasic">= alpha<br />
gamma<br />
?array.size()</p>
<p class="xbasic">=3<br />
&nbsp;</p>
<p>Now, repeating this exercise, but turning on the array's 'dynamic'  property:</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">dim array[3] as c</p>
<p class="xbasic">array.set_dynamic(.t.)</p>
<p class="xbasic">array[1] = "alpha"</p>
<p class="xbasic">array[2] = "beta"</p>
<p class="xbasic">array[3] = "gamma"</p>
<p class="xbasic">?array.size()</p>
<p class="xbasic">=3</p>
<p class="xbasic">array.delete(2,1)</p>
<p class="xbasic">?array.dump()</p>
<p class="xbasic">= alpha<br />
gamma<br />
?array.size()</p>
<p class="xbasic">=2</p>
<p class="xbasic">&nbsp;</p>
<p>The &lt<i>array</i>>.set_dynamic(<i>flag</i>) method can be used to turn  on/off the dynamic sizing property of an array. The  &lt<i>array</i>>.get_dynamic() method can be used to determine the state of  an array's dynamic sizing property.</p>
<p>If you dim an array with a size of 0 (and then populate the array using the  [] syntax), the dynamic sizing property is automatically assumed to be set to  True. For example:</p>
<p class="xbasic">dim array[0] as p<br />
array[] = "alpha"<br />
array[] =  "beta"<br />
?array.size()<br />
=2<br />
array.delete(2,1)<br />
?array.size()<br />
=1<br />
<br />
<br />
'This  shows that an array dimmed with an initial size of 0 defaults to dynamic  properties on, whereas<br />
'an array dimmed with non-zero size defaults to  dynamic properties off.<br />
dim arr1[0] as p<br />
dim arr2[1] as p<br />
?  arr1.get_dynamic()<br />
= .T.<br />
? arr2.get_dynamic()<br />
= .F.<br />
&nbsp;</p>
<!-- startAnchor --><a name="Appending Entries to An Array"></a><!-- endAnchor -->
<h3>Appending Entries to An Array</h3>
<p>The new &ltarray>.append() method makes it easier to add new entries to  an array. &ltarray>.append() adds a new entry to the array and returns the  index of the new array slot. For example:</p>
<p class="xbasic"><br />
dim pArrray[0] as p<br />
?pArray.size() = <br />
0<br />
dim index  as n<br />
index = pArray.append()<br />
?index<br />
=1<br />
pArray<a class="wiki"  href="index" rel="">index</a>.name =  "Sam"<br />
pArray<a class="wiki"  href="index" rel="">index</a>.city = "Boston"<br />
<br />
&nbsp;</p>
<!-- startAnchor --><a name="Initialize Array From Table"></a><!-- endAnchor -->
<h3>Initialize Array From Table</h3>
<p>The &lt<i>array</i>>.initialize_from_table() method now has two new  parameters that allow you to optionally append to an existing array (instead of  always initializing it), and to specify a list of fieldnames (rather than  populating the array with every field in the source table).</p>
<p>Also, it is no longer necessary to dim the array with the correct size before  you execute the .initialize_from_table() method - you can dim it as a 0 size  array and the array will be resized correctly based on the number of records  that satisfy your filter criteria.</p>
<p>For example, here is an Interactive window session (in the sample Alphasports  database):</p>
<p class="xbasic">'Start with empty array (automatically dynamic)<br />
dim arr<a class="wiki"  href="0" rel="">0</a> as  p<br />
'Pull in NY records from Customer  table...<br />
arr.initialize_from_table("customer","bill_state_region='NY'","",.f.)<br />
?arr.size()<br />
=  8<br />
<br />
<br />
'Now, pull in MA records from the Customer table. Notice that the  append flag is set to TRUE so that records are added to the end of the  array.<br />
arr.initialize_from_table("customer","bill_state_region='MA'","",.t.)<br />
?  arr.size()<br />
= 29<br />
&nbsp;</p>
<p>In this example, only selected columns are loaded into the array.</p>
<p class="xbasic"><br />
dim fieldList as c <br />
fieldList =  &lt&lt%txt%<br />
CUSTOMER_ID<br />
COMPANY<br />
FIRSTNAME<br />
LASTNAME<br />
%txt<br />
<br />
dim  arrlim[0] as  p<br />
arrlim.initialize_from_table("customer","bill_state_region='NY'","",.f.,fieldlist)<br />
?  arrlim<a class="wiki"  href="2" rel="">2</a><br />
= COMPANY = "Alpha Software New York"<br />
CUSTOMER_ID =  "00000010"<br />
FIRSTNAME = "Bryan"<br />
LASTNAME = "Bloomberg"<br />
&nbsp;</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Miscellaneous+Xbasic+Array+Improvements+V10">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Guide/Server/Xbasic/","status":"pending","keywords":"guide,xbasic"} --->
</body></html>