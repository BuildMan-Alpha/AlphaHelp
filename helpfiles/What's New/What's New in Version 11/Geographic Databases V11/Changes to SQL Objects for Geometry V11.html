	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Changes_to_SQL_Objects_for_Geometry">Changes to SQL Objects for Geometry</h1>
<h2 class="showhide_heading" id="SQL::Connection::GeographySupported">SQL::Connection::GeographySupported</h2>
There is a new connection object method, <strong>SQL::Connection::GeographySupported()</strong><br />
<br />
L <strong>GeographySupported</strong>(<span style="color:#090; background:">Syntax </span>as C = "")<br />
<br />
Returns true if the syntax name passed is supported for geography features.<br />
<br />
If you do not provide a syntax name, the current syntax is used.<br />
If no syntax is assigned yet, the function will return false.<br />
<h2 class="showhide_heading" id="SQL::Connection::ListPortableSQLFunctions">SQL::Connection::ListPortableSQLFunctions</h2>
ListPortableSQLFunctions now has an additional (optional) parameter for the connection object function SQL::Connection::ListPortableSQLFunctions()<br />
<br />
       C <strong>ListPortableSQLFunctions</strong>(<span style="color:#090; background:">Syntax </span>as C = "")<br />
<br />
Creates a crlf() delimited list of portable SQL functions.<br />
<br />
	If you provide a syntax name, only functions supported by that syntax will be included.<br />
<br />
	If you do not provide a syntax name, all functions will be included.<br />
<br />
	Note: Geography functions are only supported for some databases.<br />
<h2 class="showhide_heading" id="SQL::IntermediateType">SQL::IntermediateType</h2>
The SQL::IntermediateType enumeration now includes <strong>Geography </strong>as a valid type.<br />
<br />
The new value is used in mapping geography types from database schemas and result sets.<br />
<h2 class="showhide_heading" id="SQL::Connection::GenerateCreateTableSyntax">SQL::Connection::GenerateCreateTableSyntax</h2>
<strong>SQL::Connection::GenerateCreateTableSyntax</strong> and <strong>SQL::Connection::CreateTable</strong> (which calls <strong>GenerateCreateTableSyntax</strong>) now recognize and map geography types.  This can be a fairly complicated process as described in <a href="Database-specific Geography Tasks V11.html" title="Database-specific Geography Tasks V11" class="wiki">Database-specific Geography Tasks V11</a>.  Oracle, for example, requires that a spatial index be created to use comparison functions.  Some databases require separate code to add geography/geometry columns.<br />
<h2 class="showhide_heading" id="SQL::ResultSet::DataAsGeography">SQL::ResultSet::DataAsGeography</h2>
Result sets now have a method called <strong>SQL::ResultSet::DataAsGeography()</strong>, which will return a .NET  Geography object (<strong>Microsoft.SQLTypes.SQLGeography</strong>) instantiated from the data retrieved from your database.  The object is instantiated regardless of the database from which the data was retrieved.<br />
<br />
Note:  This function works with <strong>GeogAsText()</strong> and <strong>GeogAsBinary()</strong>.  For PostgreSQL, MySQL and SQL Server you can select the column directly without using the portable SQL function.  In some cases, the database does not return enough information to instantiate the object properly unless you wrap the column with either <strong>GeogAsText()</strong> or <strong>GeogAsBinary()</strong>.<br />
<h2 class="showhide_heading" id="SQL::ResultSet::Data">SQL::ResultSet::Data</h2>
The result set function <strong>SQL::ResultSet::Data</strong> will return the .NET Geography object for SQL Server.  For MySQL, it will return the .NET Geometry object.  While this new return value is not as portable as it could be, we expect to be supporting more database objects in the future, so we believe it is the right choice.<br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="../Geographic Databases V11.html" title="Geographic Databases V11" class="wiki">Geographic Databases V11</a><br />
<a href="Changes to SQL Objects for Geometry V11.html" title="Changes to SQL Objects for Geometry V11" class="wiki">Changes to SQL Objects for Geometry V11</a><br />
<a href="Portable SQL Functions for Geographies V11.html" title="Portable SQL Functions for Geographies V11" class="wiki">Portable SQL Functions for Geographies V11</a><br />
<a href="Common Geography Database Tasks V11.html" title="Common Geography Database Tasks V11" class="wiki">Common Geography Database Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11.html" title="Database-specific Geography Tasks V11" class="wiki">Database-specific Geography Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11/DB2-specific Geography Tasks V11.html" title="DB2-specific Geography Tasks V11" class="wiki">DB2-specific Geography Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11/MySQL-specific Geography Tasks V11.html" title="MySQL-specific Geography Tasks V11" class="wiki">MySQL-specific Geography Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11/Oracle-specific Geography Tasks V11.html" title="Oracle-specific Geography Tasks V11" class="wiki">Oracle-specific Geography Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11/PostgreSQL-specific Geography Tasks V11.html" title="PostgreSQL-specific Geography Tasks V11" class="wiki">PostgreSQL-specific Geography Tasks V11</a><br />
<a href="Database-specific Geography Tasks V11/SQL Server-specific Geography Tasks V11.html" title="SQL Server-specific Geography Tasks V11" class="wiki">SQL Server-specific Geography Tasks V11</a><br />
<a href="SQL Geography Examples V11.html" title="SQL Geography Examples V11" class="wiki">SQL Geography Examples V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Changes+to+SQL+Objects+for+Geometry+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Reference/Server/Api/SQL","status":"pending","keywords":"api,ref,sql","pagename":"Changes to SQL Objects for Geometry"} --->
</body></html>