	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2 class="showhide_heading" id="DotNet_Example:_Using_System.Text.StringBuilder">DotNet Example: Using System.Text.StringBuilder</h2>
The script below shows an interactive window session in which the .NET type System.Text.StringBuilder is mapped into the XBasic type system.<br />
<br />
<div class="clearfix rbox note"><img src="images/close.png" alt="Close" width="16" height="16" class="rbox-close" onclick="$(this).parent().fadeOut();" title="Close" /><div class="rbox-title"><img src="images/information.png" alt="note" width="16" height="16" title="note" class="icon" /><span>Note</span></div><div class="rbox-data">This example is more demonstrative than useful.  Although StringBuilder is an efficient way to build large strings in .NET applications, calling into .NET from XBasic is a fairly expensive operation and using StringBuilder this way would come at a cost.</div></div><br />
<br />
We do <em>not </em>have to specify an assembly for System.Text.StringBuilder when we register the class because it is part of an assembly that has already been loaded into memory. In fact, we do not really have to go to the trouble of registering the StringBuilder class at all, as it is pre-loaded along with most of the core .NET System namespace when Alpha Five V11 starts up.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #008080; font-style: italic;">' Register StringBuilder as MyNS::MyS</span>
<span style="color: #008080; font-style: italic;">' (for demonstration purposes)</span>
<span style="color: #0600FF;">dim</span> sv <span style="color: #FF8000;">as</span> DotNet::Services
?sv.<span style="color: #0000FF;">registerclass</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;MyNS&quot;</span>, <span style="color: #808080;">&quot;MyS&quot;</span>, <span style="color: #808080;">&quot;System.Text.StringBuilder&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
&nbsp;
<span style="color: #0600FF;">dim</span> s <span style="color: #FF8000;">as</span> MyNS::MyS
&nbsp;
<span style="color: #008080; font-style: italic;">'NOTE: All of the above could actually be replaced by:</span>
<span style="color: #008080; font-style: italic;">'dim s as System::Text::StringBuilder</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Read the Capacity property</span>
<span style="color: #008080; font-style: italic;">'</span>
?s.<span style="color: #0000FF;">Capacity</span>
<span style="color: #008000;">=</span> <span style="color: #FF0000;">16</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Set the Capacity property and read it back to be sure</span>
<span style="color: #008080; font-style: italic;">' (not required in practice except in tight memory situations)</span>
s.<span style="color: #0000FF;">capacity</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">44</span>
?s.<span style="color: #0000FF;">Capacity</span>
<span style="color: #008000;">=</span> <span style="color: #FF0000;">44</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Add a string value</span>
<span style="color: #008080; font-style: italic;">'</span>
s.<span style="color: #0000FF;">append</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Hello&quot;</span><span style="color: #000000;">&#41;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Ensure capacity compares the value you send with the current capacity.</span>
<span style="color: #008080; font-style: italic;">' If you need more space, the capacity will be changed.</span>
<span style="color: #008080; font-style: italic;">' The resulting capacity is returned.</span>
<span style="color: #008080; font-style: italic;">' (not required in practice except in tight memory situations)</span>
?s.<span style="color: #0000FF;">ensurecapacity</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">66</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> <span style="color: #FF0000;">66</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Remove two characters starting with the second one.</span>
<span style="color: #008080; font-style: italic;">' .NET functions are zero based.</span>
<span style="color: #008080; font-style: italic;">'</span>
s.<span style="color: #0000FF;">remove</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">2</span><span style="color: #000000;">&#41;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Note: StringBuilder is an object.  </span>
<span style="color: #008080; font-style: italic;">' To get the string value, call the function ToString()</span>
<span style="color: #008080; font-style: italic;">'</span>
?s.<span style="color: #0000FF;">tostring</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hlo&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Insert the value back into the string and check the new value</span>
<span style="color: #008080; font-style: italic;">'</span>
s.<span style="color: #0000FF;">insert</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span>, <span style="color: #808080;">&quot;el&quot;</span><span style="color: #000000;">&#41;</span>
?s.<span style="color: #0000FF;">tostring</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Add the string ' Bob' to the string</span>
<span style="color: #008080; font-style: italic;">' Replace 'Bob' with 'Fred'</span>
<span style="color: #008080; font-style: italic;">' Check the value</span>
<span style="color: #008080; font-style: italic;">'</span>
s.<span style="color: #0000FF;">append</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot; Bob&quot;</span><span style="color: #000000;">&#41;</span>
s.<span style="color: #0600FF;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Bob&quot;</span>, <span style="color: #808080;">&quot;Fred&quot;</span><span style="color: #000000;">&#41;</span>
?s.<span style="color: #0000FF;">tostring</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello Fred&quot;</span></pre></div><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="../../.NET Framework Support in Alpha Five V11.html" title=".NET Framework Support in Alpha Five V11" class="wiki">.NET Framework Support in Alpha Five V11</a><br />
<a href="../DotNet__NAMESPACE__AssemblyReference.html" title="DotNet::AssemblyReference" class="wiki">DotNet::AssemblyReference</a><br />
<a href="../DotNet__NAMESPACE__Services.html" title="DotNet::Services" class="wiki">DotNet::Services</a><br />
<a href="../DotNet__NAMESPACE__Services/CreateObject Method.html" title="CreateObject Method" class="wiki">CreateObject Method</a><br />
<a href="../DotNet__NAMESPACE__Services/CallStaticFunction Method.html" title="CallStaticFunction Method" class="wiki">CallStaticFunction Method</a><br />
<a href="../DotNet__NAMESPACE__Services/ConstructGenericTypeName Method.html" title="ConstructGenericTypeName Method" class="wiki">ConstructGenericTypeName Method</a><br />
<a href="../DotNet__NAMESPACE__Services/GetStaticProperty Method.html" title="GetStaticProperty Method" class="wiki">GetStaticProperty Method</a><br />
<a href="../DotNet__NAMESPACE__Services/SetStaticProperty Method.html" title="SetStaticProperty Method" class="wiki">SetStaticProperty Method</a><br />
<a href="../DotNet__NAMESPACE__Services/RegisterClass Method.html" title="RegisterClass Method" class="wiki">RegisterClass Method</a><br />
<a href="../DotNet__NAMESPACE__Services/RegisterAssembly Method.html" title="RegisterAssembly Method" class="wiki">RegisterAssembly Method</a><br />
<a href="../DotNet__NAMESPACE__Services/RegisterNamespace Method.html" title="RegisterNamespace Method" class="wiki">RegisterNamespace Method</a><br />
<a href="../DotNet__NAMESPACE__Services/GenerateWebServiceClientFromURL Method.html" title="GenerateWebServiceClientFromURL Method" class="wiki">GenerateWebServiceClientFromURL Method</a><br />
<a href="../DotNet__NAMESPACE__Services/GenerateWebServiceClientFromWSDL Method.html" title="GenerateWebServiceClientFromWSDL Method" class="wiki">GenerateWebServiceClientFromWSDL Method</a><br />
<a href="../Preloaded .NET Classes V11.html" title="Preloaded .NET Classes V11" class="wiki">Preloaded .NET Classes V11</a><br />
<a href="../Writing Xbasic wrapper classes for .NET classes V11.html" title="Writing Xbasic wrapper classes for .NET classes V11" class="wiki">Writing Xbasic wrapper classes for .NET classes V11</a><br />
<a href="../DotNetPath Function.html" title="DotNetPath Function" class="wiki">DotNetPath Function</a><br />
<a href="../DotNet Examples V11.html" title="DotNet Examples V11" class="wiki">DotNet Examples V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DotNet+Example%3A+Using+System.Text.StringBuilder">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Guides"} --->
</body></html>