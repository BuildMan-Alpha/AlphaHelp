	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Xbasic_Class_Syntax">Xbasic Class Syntax</h1>
The syntax in this article describes Xbasic V11 classes in Backus-Naur Form (BNF).<br />
<br />
<strong>Notes on Syntax</strong><br />
1.       Keywords are in uppercase and bolded.<br />
2.       Substitutable values (rules) are in angle brackets "&lt;&gt;".  The rule for replacement is listed below.<br />
3.       Rules are expressed as &lt;<em>rule</em>&gt; : option | option | option; where the vertical bar "|" means "OR".<br />
4.       Values in square brackets "[]" are optional.<br />
5.       Underlined elements are the default for optional items.<br />
6.       The symbol "*" means that the element that precedes it can occur zero or more times.  For simplicity sake, we have omitted commas in argument lists.<br />
<h2 class="showhide_heading" id="Syntax_Diagram">Syntax Diagram</h2>
<strong>DEFINE CLASS</strong> [ <b><u>GLOBAL</u></b>| <strong>SHARED</strong> | <strong>LOCAL</strong> | <strong>SYSTEM</strong> ] &lt;name&gt; [ <strong>INHERITS</strong> &lt;classname&gt; ]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;classelement&gt;*<br />
<strong>END CLASS</strong><br />
<br />
&lt;<em>classelement</em>&gt; :           &lt;constructor&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;dimStatement&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;functionStatement&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;constantStatement&gt;<br />
<br />
&lt;<em>constructor</em>&gt; :              <strong>FUNCTION</strong> [&lt;simpleaccess&gt;] &lt;classname&gt; (&lt;functionargument&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<strong>Notes:</strong><br />
<ul><li>A class name may include a namespace prefix separated from the name by two colons (<strong>::</strong>).
</li><li>A namespace may have multiple parts separated by periods.
</li><li>A constructor function has the same name as the class.
</li><li>There can be multiple constructors per class.  The constructor that executes depends on the arguments provided when the class is created. The <strong>new</strong> keyword is used to invoke a specific constructor.
</li><li>A constructor may have limited access to control how a class is created from outside.
</li></ul>&lt;<em>destructor</em>&gt;:   <strong>FUNCTION</strong> ~&lt;classname&gt; ( )<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<strong>Notes:</strong><br />
<ul><li>A destructor has the same name as the class with the tilde "~" character preceding it.
</li><li>There can be only one destructor per class.
</li><li>All destructors are public and virtual.
</li></ul><br />
&lt;<em>dimStatement</em>&gt; :          <strong>DIM</strong> [&lt;<span style="text-decoration:underline;">simpleaccess</span>&gt; | &lt;mixedaccess&gt; ] [ <strong>STATIC</strong> |<strong> <span style="text-decoration:underline;">VIRTUAL</span> </strong>] &lt;name&gt; [&lt;arraydefinition&gt;] <strong>AS</strong> &lt;typename&gt; [= &lt;expression&gt;]<br />
<br />
&lt;<em>functionStatement</em>&gt; :    <strong>FUNCTION</strong> [&lt;simpleaccess&gt;] [ <strong>STATIC</strong> |<strong> <span style="text-decoration:underline;">VIRTUAL</span> </strong>] &lt;name&gt; [AS &lt;typename&gt; ](&lt;functionargument&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<br />
&lt;<em>constantStatement</em>&gt; :   <strong>CONSTANT</strong> [&lt;simpleaccess&gt;] &lt;name&gt; = &lt;literal value&gt;<br />
<strong>Note:</strong> A constant is static by definition.<br />
<br />
&lt;<em>simpleaccess</em>&gt; :          <strong> <span style="text-decoration:underline;">PUBLIC</span> </strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <strong>PROTECTED</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <strong>PRIVATE</strong><br />
<br />
<br />
&lt;<em>mixedaccess</em>&gt; :  &lt;simpleaccess&gt; <strong>READ</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;simpleaccess&gt; <strong>WRITE</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;simpleaccess&gt; <strong>READ</strong> &lt;simpleaccess&gt; <strong>WRITE</strong><br />
<br />
<br />
&lt;<em>functionargument</em>&gt; : [<strong>BYREF</strong> | <span style="text-decoration:underline;"> <strong>BYVAL</strong> </span> ] [<strong>OPTIONAL</strong> | <strong>PARAMS</strong> ] <strong>AS</strong> &lt;typename&gt; [ = &lt;expression&gt;]<br />
<strong>Notes:</strong><br />
<ul><li>OPTIONAL indicates that the parameter may be omitted.
</li><li>The effect is the same as overloading the function.
</li><li>At run time, the initialization expression is executed if the argument is missing.
</li></ul>PARAMS can be used at most once in an argument list.<br />
<ul><li>It must be used on the last argument in the overload.
</li><li>At run time, all parameters in this position and those that follow must either match or be inherited from the type specified.
</li><li>The interpreter converts the arguments into an array of the same type as the declared type of the arguments collection
</li></ul><strong>Substitutable Value Definitions</strong><br />
&lt;<em>classname</em>&gt;:  the name of the class being defined<br />
&lt;<em>arraydefinition</em>&gt;: the valid XBasic syntax for defining an array<br />
&lt;<em>typename</em>&gt;: a valid single letter type or class name<br />
&lt;<em>name</em>&gt;: a valid XBasic identifier<br />
&lt;<em>literal value</em>&gt;: a valid XBasic literal value (the type is implied)<br />
&lt;<em>expression</em>&gt;: a valid XBasic expression (constant, new operator, and so on)<br />
<h2 class="showhide_heading" id="Class_Example">Class Example</h2>
In the example below, note that the member variable <strong>InstanceCount </strong>is <strong>static</strong>. That means there is only one <strong>InstanceCount</strong>, no matter how many copies of <strong>TestClass </strong>have been DIMmed. On the other hand, each instance of <strong>TestClass </strong>has its own copy of the member variable <strong>Data</strong>.<br />
<br />
Also note that the member method <strong>TestClass()</strong> is the constructor for class <strong>TestClass</strong>. Therefore it is called immediately after an instance of <strong>TestClass </strong>is DIMmed. Similarly, the member method <strong>~TestClass()</strong> is the destructor for class <strong>TestClass</strong>. Therefore it is called immediately before an instance of <strong>TestClass </strong>is destroyed.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >DEFINE <span style="color: #0600FF;">CLASS</span> TestClass
&nbsp;
            <span style="color: #0600FF;">dim</span> <span style="color: #FF8000;">public</span> read protected <span style="color: #0600FF;">write</span> Name <span style="color: #FF8000;">as</span> C
            <span style="color: #0600FF;">dim</span> <span style="color: #FF8000;">public</span> Data <span style="color: #FF8000;">as</span> A
            <span style="color: #0600FF;">dim</span> <span style="color: #FF8000;">public</span> read protected <span style="color: #0600FF;">write</span> <span style="color: #FF8000;">static</span> InstanceCount <span style="color: #FF8000;">as</span> N
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> <span style="color: #FF8000;">PUBLIC</span> TestClass<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                        <span style="color: #0600FF;">Initialize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> ~TestClass<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                        InstanceCount <span style="color: #008000;">=</span> InstanceCount <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> protected <span style="color: #0600FF;">Initialize</span> <span style="color: #FF8000;">as</span> V<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                        Data <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;&quot;</span>
                        InstanceCount <span style="color: #008000;">=</span> InstanceCount <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> <span style="color: #FF8000;">public</span> <span style="color: #FF8000;">static</span> DefaultDataType <span style="color: #FF8000;">as</span> C <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                        DefaultDataType <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;C&quot;</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> <span style="color: #FF8000;">public</span> AddToData <span style="color: #FF8000;">as</span> V <span style="color: #000000;">&#40;</span> PARAMS NewValue <span style="color: #FF8000;">as</span> C<span style="color: #000000;">&#41;</span>
                        <span style="color: #FF8000;">for</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span> <span style="color: #FF8000;">to</span> NewValue.<span style="color: #0000FF;">Size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                                    <span style="color: #008000;">*</span>concat<span style="color: #000000;">&#40;</span>Data, NewValue<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>
                        <span style="color: #FF8000;">next</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> <span style="color: #FF8000;">public</span> AddToData <span style="color: #FF8000;">as</span> V <span style="color: #000000;">&#40;</span> PARAMS NewValue <span style="color: #FF8000;">as</span> N<span style="color: #000000;">&#41;</span>
                        <span style="color: #FF8000;">for</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span> <span style="color: #FF8000;">to</span> NewValue.<span style="color: #0000FF;">Size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                                    Data <span style="color: #008000;">=</span> Data <span style="color: #008000;">+</span> NewValue<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span>
                        <span style="color: #FF8000;">next</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
            <span style="color: #0600FF;">FUNCTION</span> <span style="color: #FF8000;">public</span> Clear <span style="color: #FF8000;">as</span> V <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
                        <span style="color: #0600FF;">Initialize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
            <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">CLASS</span></pre></div><br />
<h3 class="showhide_heading" id="Exercises">Exercises</h3>
<ol><li>How does this class keep track of its instance count?
</li><li>How do the two <strong>AddToData </strong>overloads work?
</li><li>There are at least two potential bugs in the class above. Can you find them?
</li></ol><h2 class="showhide_heading" id="See_also">See also</h2>
<a href="../Xbasic with Classes V11.html" title="Xbasic with Classes V11" class="wiki">Xbasic with Classes V11</a><br />
<a href="Xbasic Class Syntax V11.html" title="Xbasic Class Syntax V11" class="wiki">Xbasic Class Syntax V11</a><br />
<a href="Designing an Xbasic Class V11.html" title="Designing an Xbasic Class V11" class="wiki">Designing an Xbasic Class V11</a><br />
<a href="Implementing an Xbasic Class V11.html" title="Implementing an Xbasic Class V11" class="wiki">Implementing an Xbasic Class V11</a><br />
<a href="Testing and Using an Xbasic Class V11.html" title="Testing and Using an Xbasic Class V11" class="wiki">Testing and Using an Xbasic Class V11</a><br />
<a href="Subclasses and Inheritance V11.html" title="Subclasses and Inheritance V11" class="wiki">Subclasses and Inheritance V11</a><br />
<a href="Classes in Namespaces V11.html" title="Classes in Namespaces V11" class="wiki">Classes in Namespaces V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Xbasic+Class+Syntax+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common,review","group":"/Guide/Server/Design/Platform/Xbasic/","status":"pending","notes":"v11","keywords":"server,design,guide,xbasic"} --->
</body></html>