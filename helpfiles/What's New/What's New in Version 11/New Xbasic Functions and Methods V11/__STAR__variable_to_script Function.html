	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="variable_to_script_">*variable_to_script()</h1>
<h3 class="showhide_heading" id="Syntax">Syntax</h3>
C <span style="color:#090; background:"><em>Result </em></span>=  *VARIABLE_TO_SCRIPT(P <span style="color:#090; background:"><em>varFrame</em></span>&#91;,C <span style="color:#090; background:"><em>options</em></span>&#91;,C <span style="color:#090; background:"><em>stringTagMap</em></span>]])<br />
<br />
<table class="normal" id="fancytable_1">
	
		<tr>
			<td class="odd"><strong>Argument</strong> </td>
			<td class="odd"> <strong>Description</strong></td>
		</tr>
		<tr>
			<td class="even">C<span style="color:#060; background:"><em> Result</em></span> </td>
			<td class="even"> Xbasic script to re-create variables that were inside the passed frame/pointer</td>
		</tr>
		<tr>
			<td class="odd">P<span style="color:#060; background:"><em> varFrame</em></span> </td>
			<td class="odd"> pointer variable</td>
		</tr>
		<tr>
			<td class="even">C<span style="color:#060; background:"><em> options</em></span> </td>
			<td class="even"> (optional) w : Generate <em>with</em> statements</td>
		</tr>
		<tr>
			<td class="odd">C<span style="color:#060; background:"><em> stringTagMap</em></span> </td>
			<td class="odd"> (optional) Control string tag names</td>
		</tr>
</table><br />
<h3 class="showhide_heading" id="Description">Description</h3>
Create an Xbasic script to re-create the variables in the passed variable frame (pointer variable).<br />

<h3 class="showhide_heading" id="Limitations">Limitations</h3>
<h3 class="showhide_heading" id="Examples">Examples</h3>
The function takes a dot variable and serializes it as an xbasic script. The dot variable can be reconstituted by executing the generated script.<br />
<br />
Contrast this with property_to_string() and property_to_blob(), which also serialize a dot variable.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox" >dim p as p
p.name = "alpha"
p.city = "boston"

?*variable_to_script(p)
= DIM name as C = "alpha"
DIM city as C = "boston"

dim p2 as p
p2.name = "alpha"
dim p2.array[2] as p
p2.array[1].prop1 = "prop1"
p2.array[1].prop2 = "prop2"
p2.array[2].prop1 = "prop3"
p2.array[2].prop2 = "prop4"

?*variable_to_script(p2)
= DIM name as C = "alpha"
DIM array[2] as P
DIM array[1].prop1 as C = "prop1"
DIM array[1].prop2 as C = "prop2"
DIM array[2].prop1 as C = "prop3"
DIM array[2].prop2 as C = "prop4"


'using the 'w' flag you get cleaner, easier to read code
?*variable_to_script(p2,"w")
= DIM name as C = "alpha"
DIM array[2] as P
with  array[1]
	.prop1 = "prop1"
	.prop2 = "prop2"
end with
with  array[2]
	.prop1 = "prop3"
	.prop2 = "prop4"
end with



p3.colors = comma_to_crlf("alpha,beta,gamma")
p3.html = "this is some html" + crlf() + "second line"
?*variable_to_script(p3)
= DIM colors as C = &lt;&lt;%str%
alpha
beta
gamma%str%
DIM html as C = &lt;&lt;%str%
this is some html
second line%str%

'in the above example, a5 chose to use 'str' as the long string delimiter.


'By passing in a map (of property name to string delimiter), 
' you can specify what delimiter to use for various property names
' Notice that the .html property is now delimited using %html%, 
' not %str% as in the above example

?*variable_to_script(p3,"",comma_to_crlf("*html*|%html%,*xbasic*|%code%,*serverside*|%code%"))
= DIM colors as C = &lt;&lt;%str%
alpha
beta
gamma%str%
DIM html as C = &lt;&lt;%html%
this is some html
second line%html%</pre></div><br />
<h3 class="showhide_heading" id="See_Also">See Also</h3>
<a href="../../../References/Functions/PROPERTY_TO_STRING Function.html" title="PROPERTY_TO_STRING Function" class="wiki">property_to_string Function</a>, <a href="../../../References/Functions/PROPERTY_TO_BLOB Function.html" title="PROPERTY_TO_BLOB Function" class="wiki">property_to_blob Function</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:%2Avariable_to_script+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>