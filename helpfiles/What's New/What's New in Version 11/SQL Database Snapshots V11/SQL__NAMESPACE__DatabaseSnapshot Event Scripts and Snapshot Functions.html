	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="SQL::DatabaseSnapshot_Event_Scripts_and_Snapshot_Functions">SQL::DatabaseSnapshot Event Scripts and Snapshot Functions</h1>
The load and store functions for snapshot objects have a string argument named <span style="color:#090; background:">EventScript</span>.  This argument can contain an event script so that you can respond to milestones in the process of loading and storing data; usually for the purpose of displaying a progress dialog or creating a log of the process.<br />
<br />
The event script is something you create using one or more of the following functions.  You implement the function.  The function is called when the event associated with the function is triggered by one of the snapshot objects.<br />
<br />
For example:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #0600FF;">FUNCTION</span> DatabaseBegin<span style="color: #000000;">&#40;</span>Context <span style="color: #FF8000;">as</span> P, Action <span style="color: #FF8000;">as</span> C, TablesExpected <span style="color: #FF8000;">as</span> N<span style="color: #000000;">&#41;</span>
	Statusbar.<span style="color: #0000FF;">Set_Text</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Database &quot;</span> <span style="color: #008000;">+</span> Action <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; beginning. &quot;</span> <span style="color: #008000;">\</span>
		<span style="color: #008000;">+</span> TablesExpected <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; tables expected.&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> DatabaseEnd<span style="color: #000000;">&#40;</span>Context <span style="color: #FF8000;">as</span> P, Action <span style="color: #FF8000;">as</span> C, TablesExpected <span style="color: #FF8000;">as</span> N<span style="color: #000000;">&#41;</span>
	Statusbar.<span style="color: #0000FF;">Set_Text</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Database &quot;</span> <span style="color: #008000;">+</span> Action <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; complete.&quot;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> TableBegin<span style="color: #000000;">&#40;</span>Context <span style="color: #FF8000;">as</span> P, Action <span style="color: #FF8000;">as</span> C, TableName <span style="color: #FF8000;">as</span> C<span style="color: #000000;">&#41;</span>
	Statusbar.<span style="color: #0000FF;">Set_Text</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Table &quot;</span> <span style="color: #008000;">+</span> Action <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; beginning for table &quot;</span> <span style="color: #008000;">+</span> TableName<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> TableEnd<span style="color: #000000;">&#40;</span>Context <span style="color: #FF8000;">as</span> P, Action <span style="color: #FF8000;">as</span> C, TableName <span style="color: #FF8000;">as</span> C<span style="color: #000000;">&#41;</span>
	Statusbar.<span style="color: #0000FF;">Set_Text</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Table &quot;</span> <span style="color: #008000;">+</span> Action <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; complete for table &quot;</span> <span style="color: #008000;">+</span> TableName<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span></pre></div><br />
<h2 class="showhide_heading" id="DatabaseBegin">DatabaseBegin</h2>
Called when a batch of updates is about to be processed for a database.<br />
<br />
This event is useful for displaying a progress/cancel dialog.<br />
DatabaseBegin(	<span style="color:#090; background:">Context 		</span>as P, <span style="color:#090; background:">Action			</span>as C, <span style="color:#090; background:">TablesExpected 		</span>as N)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context </span>is the object on which the function is called (generally a database snapshot object).<br />
 	<span style="color:#090; background:">Action </span>may be one of the following: Load, Store, LoadDBF, StoreDBF<br />
 	<span style="color:#090; background:">TablesExpected</span> is the number of tables to be updated.<br />
<h2 class="showhide_heading" id="DatabaseEnd">DatabaseEnd</h2>
Called at the end of processing for a database level update.<br />
<br />
DatabaseEnd(	<span style="color:#090; background:">Context</span> 		as P, 	<span style="color:#090; background:">Action			</span>as C)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context</span> is the object on which the function is called (generally a DatabaseSnapshot).<br />
 	<span style="color:#090; background:">Action </span>may be one of the following: Load, Store, LoadDBF, StoreDBF<br />
<h2 class="showhide_heading" id="TableBegin">TableBegin</h2>
Called when a batch of updates is about to be processed for a table.  This event is useful for displaying a progress/cancel dialog.<br />
<br />
TableBegin(	<span style="color:#090; background:">Context 		</span>as P, 		<span style="color:#090; background:">Action			</span>as C, <span style="color:#090; background:">TableName 		</span>as C)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context </span>is the object on which the function is called (generally a database snapshot object).<br />
 	<span style="color:#090; background:">Action</span> may be one of the following: Load, Store, LoadDBF, StoreDBF<br />
 	<span style="color:#090; background:">TableName</span> is the name of the table being updated.<br />
<h2 class="showhide_heading" id="TableEnd">TableEnd</h2>
Called at the end of processing for a table level update.<br />
<br />
TableEnd(	<span style="color:#090; background:">Context 		</span>as P, 		<span style="color:#090; background:">Action			</span>as C, <span style="color:#090; background:">TableName 		</span>as C)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context </span>is the object on which the function is called (generally a database snapshot object).<br />
 	<span style="color:#090; background:">Action</span> may be one of the following: Load, Store, LoadDBF, StoreDBF<br />
 	<span style="color:#090; background:">TableName</span> is the name of the table being updated.<br />
<h2 class="showhide_heading" id="UpdateBegin">UpdateBegin</h2>
Called when a batch of updates is about to be processed.  This event is useful for displaying a progress/cancel dialog.<br />
<br />
UpdateBegin(	<span style="color:#090; background:">Context</span> 		as P, <span style="color:#090; background:">RowsExpected </span>as 	as N, BYREF	<span style="color:#090; background:">ProgressInterval 	</span>as N, BYREF	<span style="color:#090; background:">Cancel			</span>as L)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context </span>is the object on which the function is called (generally the connection or a result set).<br />
 	<span style="color:#090; background:">RowsExpected</span> is the number of rows to be updated.  <strong>Note</strong>: The number of rows in an applied result set is not always known.  In this case, <span style="color:#090; background:">RowsExpected </span>will be 1.<br />
 	<span style="color:#090; background:">ProgressInterval</span>: This parameter indicates how many rows will be processed before the UpdateProgress event will be invoked.  You can change the value.<br />
 	<span style="color:#090; background:">Cancel</span>: This variable is initially set to ".f.".  To cancel the execution of the event, set Cancel = .t.<br />
<h2 class="showhide_heading" id="UpdateEnd">UpdateEnd</h2>
Called at the end of processing.<br />
<br />
UpdateEnd(	<span style="color:#090; background:">Context 		</span>as P, 		<span style="color:#090; background:">TotalRowsUpdated</span> 	as N)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context</span> is the object on which the function is called (generally the connection or a result set).<br />
 	<span style="color:#090; background:">TotalRowsUpdated</span> is the number of rows successfully updated.<br />
<br />
<strong>Note</strong>:  If you set Cancel = .t. in the UpdateBegin event, UpdateEnd will not be called.<br />
<h2 class="showhide_heading" id="UpdateProgress">UpdateProgress</h2>
Called repeatedly as rows are processed.<br />
<br />
UpdateProgress(<span style="color:#090; background:">Context</span> 		as P, 	<span style="color:#090; background:">RowsUpdated		</span>as N, <span style="color:#090; background:">RowsExpected 	 	</span>as N, BYREF	<span style="color:#090; background:">Cancel			</span>as L)<br />
<br />
Where:<br />
 	<span style="color:#090; background:">Context </span>is the object on which the function is called (generally the connection or a result set).<br />
 	<span style="color:#090; background:">RowsUpdated</span> is the number of rows successfully updated.<br />
 	<span style="color:#090; background:">RowsExpected </span>is the number of rows to be updated. <strong>Note</strong>: The number of rows in an applied result set is not always known.  In this case, <span style="color:#090; background:">RowsExpected </span>will be 1.<br />
 	<span style="color:#090; background:">Cancel</span>: This variable is initially set to ".f.".  To cancel the execution of the event, set Cancel = .t.<br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL%3A%3ADatabaseSnapshot+Event+Scripts+and+Snapshot+Functions">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: "{}" --->
</body></html>