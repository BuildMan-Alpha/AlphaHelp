	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="SQL::TableSnapshot_Example:_Scripting_the_Load">SQL::TableSnapshot Example: Scripting the Load</h1>
SQL database snapshot objects load and store data and definitions with the help of other objects available to the XBasic programmer.  You can create a snapshot yourself, programmatically; as in this example.  Here, the TableInfo for the table named Contacts is retrieved so that the TableSnapshot has a table definition (we could have scripted the creation of the TableInfo, but that is outside of the scope of this article).  Two instances of RowSnapshot are created and populated with data and then added to the TableSnapshot.<br />
<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #0600FF;">dim</span> cn <span style="color: #FF8000;">as</span> SQL::Connection
<span style="color: #0600FF;">dim</span> ti <span style="color: #FF8000;">as</span> SQL::TableInfo
&nbsp;
<span style="color: #0600FF;">dim</span> ts <span style="color: #FF8000;">as</span> SQL::TableSnapshot
<span style="color: #0600FF;">dim</span> Row <span style="color: #FF8000;">as</span> SQL::RowSnapshot
<span style="color: #0600FF;">dim</span> Col <span style="color: #FF8000;">as</span> SQL::ColumnValue
&nbsp;
cn.<span style="color: #0600FF;">open</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;::Named::MyDatabase&quot;</span><span style="color: #000000;">&#41;</span>		<span style="color: #008080; font-style: italic;">' Open the source database</span>
cn.<span style="color: #0000FF;">GetTableInfo</span><span style="color: #000000;">&#40;</span>ti, <span style="color: #808080;">&quot;Contact&quot;</span><span style="color: #000000;">&#41;</span>		<span style="color: #008080; font-style: italic;">' Load the schema from the source database</span>
&nbsp;
ts.<span style="color: #0000FF;">TableInfo</span> <span style="color: #008000;">=</span> ti
&nbsp;
<span style="color: #008080; font-style: italic;">' Add two rows</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Row 1 - Fred Smith</span>
Row <span style="color: #008000;">=</span> Row.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new row</span>
&nbsp;
Col <span style="color: #008000;">=</span> col.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new column </span>
Col.<span style="color: #0000FF;">Name</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;LName&quot;</span>
Col.<span style="color: #0000FF;">Value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Smith&quot;</span>
Row.<span style="color: #0000FF;">AddData</span><span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Add the column to the row</span>
&nbsp;
Col <span style="color: #008000;">=</span> Col.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new Column</span>
Col.<span style="color: #0000FF;">Name</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;FName&quot;</span>
Col.<span style="color: #0000FF;">Value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Fred&quot;</span>
Row.<span style="color: #0000FF;">AddData</span><span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Add the column to the row</span>
&nbsp;
Ts.<span style="color: #0000FF;">AddRow</span><span style="color: #000000;">&#40;</span>Row<span style="color: #000000;">&#41;</span>				<span style="color: #008080; font-style: italic;">' Add the row to the table snapshot</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Row 2 - Bob Jones</span>
Row <span style="color: #008000;">=</span> Row.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new row</span>
&nbsp;
Col <span style="color: #008000;">=</span> col.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new column </span>
Col.<span style="color: #0000FF;">Name</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;LName&quot;</span>
Col.<span style="color: #0000FF;">Value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Jones&quot;</span>
Row.<span style="color: #0000FF;">AddData</span><span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Add the column to the row</span>
&nbsp;
Col <span style="color: #008000;">=</span> Col.<span style="color: #0000FF;">NewInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Create a new Column</span>
Col.<span style="color: #0000FF;">Name</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;FName&quot;</span>
Col.<span style="color: #0000FF;">Value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Bob&quot;</span>
Row.<span style="color: #0000FF;">AddData</span><span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#41;</span>			<span style="color: #008080; font-style: italic;">' Add the column to the row</span>
&nbsp;
Ts.<span style="color: #0000FF;">AddRow</span><span style="color: #000000;">&#40;</span>Row<span style="color: #000000;">&#41;</span>				<span style="color: #008080; font-style: italic;">' Add the row to the table snapshot</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Persist the snapshot to a file.</span>
<a target="_blank" href="http://www.google.com/search?q=FILE+site:msdn.microsoft.com"><span style="color: #008000;">file</span></a>.<span style="color: #0000FF;">from_string</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;&amp;lt;MyFile&amp;gt;&quot;</span>, ts.<span style="color: #0000FF;">XML</span><span style="color: #000000;">&#41;</span> 	<span style="color: #008080; font-style: italic;">'Save the snapshot as XML</span></pre></div><br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL%3A%3ATableSnapshot+Example%3A+Scripting+the+Load">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Guides"} --->
</body></html>