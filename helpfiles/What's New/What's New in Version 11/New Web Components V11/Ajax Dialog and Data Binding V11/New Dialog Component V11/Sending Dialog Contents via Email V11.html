	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Sending_Dialog_Contents_via_Email">Sending Dialog Contents via Email</h1>
There are times when the output of a dialog should not go directly to a database. You may want to email the entry, for example. Here is how you would do that, assuming that once again you are starting with our Simple Dialog example.<br />
<br />
In the Xbasic functions section of your dialog, insert this function:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #0600FF;">FUNCTION</span> sendEmail <span style="color: #FF8000;">AS</span> L <span style="color: #000000;">&#40;</span>address <span style="color: #FF8000;">AS</span> C, subject <span style="color: #FF8000;">as</span> C, body <span style="color: #FF8000;">AS</span> C <span style="color: #000000;">&#41;</span>
  <a target="_blank" href="http://www.google.com/search?q=DEBUG+site:msdn.microsoft.com"><span style="color: #008000;">debug</span></a><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">dim</span> pm <span style="color: #FF8000;">as</span> P
  <span style="color: #0600FF;">dim</span> ps <span style="color: #FF8000;">as</span> P
  sendEmail<span style="color: #008000;">=</span> .<span style="color: #0000FF;">F</span>.
  <span style="color: #0600FF;">IF</span> <span style="color: #000000;">&#40;</span>email_smtp_open<span style="color: #000000;">&#40;</span>ps, <span style="color: #808080;">&quot;smtp.myserver.com&quot;</span>, <span style="color: #FF0000;">25</span>, <span style="color: #808080;">&quot;username@myserver.com&quot;</span>,<span style="color: #808080;">&quot;password&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
		pm.<span style="color: #FF8000;">to</span> <span style="color: #008000;">=</span> address
		pm.<span style="color: #0000FF;">from</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;myserver.com&quot;</span>
		pm.<span style="color: #0000FF;">from_alias</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;My Email Alias&quot;</span>
		pm.<span style="color: #0000FF;">subject</span> <span style="color: #008000;">=</span> subject
		pm.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> body
		sendEmail <span style="color: #008000;">=</span> email_smtp_send<span style="color: #000000;">&#40;</span>pm, ps<span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">END</span> <span style="color: #0600FF;">IF</span>
  email_smtp_close<span style="color: #000000;">&#40;</span>ps<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span></pre></div><br />
<br />
You will need to edit the function for your server, which is why we have inserted the debug statement for you.<br />
<br />
In the <strong>afterDialogValidate</strong> event, insert the following code:<br />
<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" ><span style="color: #0600FF;">function</span> afterDialogValidate <span style="color: #FF8000;">as</span> v <span style="color: #000000;">&#40;</span>e <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
<span style="color: #008080; font-style: italic;">'... comments omitted here ...</span>
<span style="color: #008080; font-style: italic;">'debug(1)</span>
&nbsp;
<span style="color: #0600FF;">dim</span> address <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;destinationUsername@destinationCompany.com&quot;</span>
<span style="color: #0600FF;">dim</span> subject <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Captured Combatant&quot;</span>
<span style="color: #0600FF;">dim</span> body <span style="color: #FF8000;">as</span> C
body <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;NAME: &quot;</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">NAME</span> <span style="color: #008000;">+</span> <span style="color: #0600FF;">crlf</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
body <span style="color: #008000;">=</span> body <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;RANK: &quot;</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">RANK</span> <span style="color: #008000;">+</span> <span style="color: #0600FF;">crlf</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
body <span style="color: #008000;">=</span> body <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;SERIALNR &quot;</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">SERIALNR</span> <span style="color: #008000;">+</span> <span style="color: #0600FF;">crlf</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">if</span> sendEmail<span style="color: #000000;">&#40;</span>address,subject,body<span style="color: #000000;">&#41;</span>
	e.<span style="color: #0000FF;">javascript</span><span style="color: #008000;">=</span><span style="color: #808080;">&quot;alert('Submitted: &quot;</span><span style="color: #008000;">+</span>e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">NAME</span> <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;, &quot;</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">RANK</span>
	e.<span style="color: #0000FF;">javascript</span><span style="color: #008000;">=</span>e.<span style="color: #0000FF;">javascript</span> <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;, &quot;</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">dataSubmitted</span>.<span style="color: #0000FF;">SERIALNR</span> <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;');&quot;</span>
<span style="color: #FF8000;">else</span>
	e.<span style="color: #0000FF;">javascript</span><span style="color: #008000;">=</span><span style="color: #808080;">&quot;alert('Email not sent');&quot;</span>
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">if</span>
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">function</span></pre></div><br />
<br />
You will obviously have to edit the address to be the intended, valid email.<br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Sending+Dialog+Contents+via+Email+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"/Guides"} --->
</body></html>