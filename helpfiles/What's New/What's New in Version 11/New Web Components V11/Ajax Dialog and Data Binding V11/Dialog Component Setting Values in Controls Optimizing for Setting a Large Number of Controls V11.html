	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Dialog_Component_-_Setting_Values_in_Controls_-_Optimizing_for_Setting_a_Large_Number_of_Controls">Dialog Component - Setting Values in Controls - Optimizing for Setting a Large Number of Controls</h1>
When a Dialog component is opened, you can write code in the <strong>onDialogInitialize </strong>event to set the values in the controls in Dialog. The onDialogInitialize event is a server-side event, and so the code in this event handler is Xbasic.<br />
<br />
Control values are set by setting properties in the<strong> e.control</strong> object that is passed into the event handler. For example:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >e.<span style="color: #0000FF;">control</span>.<span style="color: #0000FF;">firstname</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;John&quot;</span></pre></div><br />
In addition, your Dialog component can also make Ajax callbacks, and the Xbasic function that handles the callback can set the value of controls in the Dialog. This is typically done by setting properties in the e._set object that is passed into the event handler. For example:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" >e._set.<span style="color: #0000FF;">firstname</span>.<span style="color: #0000FF;">value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;John&quot;</span></pre></div><br />
What goes on behind the scenes when you set a property in the <strong>e.control</strong> or <strong>e._set</strong> object is that Alpha Five has to convert the properties that you set into Javascript, which is then emitted to the browser.<br />
<br />
If you are setting a large number of controls, it is more efficient to generate the Javascript directly in your event handler.<br />
<br />
In your Javascript code, you will create a Javascript object and then pass this object to the Dialog's <strong>.populate()</strong> method. Using this approach is very efficient, and will allow you to populate a large number of controls very quickly.<br />
<br />
For example, here is some Xbasic code that you might put in the <strong>onDialogInitialize </strong>event. This Xbasic code creates a string (which happens to be Javascript code) and then it sets the<strong> e.javascript</strong> property so that the Javascript code in the string is emitted to the browser.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox2" >'Generate the Javascript to emit

dim jsToSetControlValues as c 
jsToSetControlValues = &lt;&lt;%jstxt%
var _d = {};
_d['FIRSTNAME'] = 'John';
_d['LASTNAME'] = 'Smith';
_d['FAVORITECOLORS'] = ['Red','Green'];
{dialog.object}.populate(_d);
{dialog.object}.prepare();
%jstxt%
 
e.javascript = jsToSetControlValues</pre></div><br />
(In the case of an Xbasic function that is handling an Ajax callback, you simply return the generated Javascript - you don't need to set the <strong>e.javascript</strong> property)<br />
<br />
To set the value of a control in a Repeating section, you follow the control name with <strong>:rowNumber</strong> or <strong>_a5InstancerowNumber</strong>. For example, the following two commands are functionally identical:<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox3" >_d['QUANTITY:3'] = '4';
_d['QUANTITY_A5INSTANCE3'] = '4';</pre></div><br />
To assist you in generating the Xbasic string that contains the Javascript code, you can use the Xbasic <strong>varToJSON()</strong> function. This function is very helpful for generating JSON objects from Xbasic. The following Xbasic code is functionally equivalent to the code shown above:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox4" ><span style="color: #0600FF;">dim</span> j <span style="color: #FF8000;">as</span> p
j.<span style="color: #0000FF;">firstname</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;John&quot;</span>
j.<span style="color: #0000FF;">lastname</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Smith&quot;</span>
j.<span style="color: #0000FF;">quantity_a5instance3</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;4&quot;</span>
<span style="color: #0600FF;">dim</span> j.<span style="color: #0000FF;">favoriteColors</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">3</span><span style="color: #000000;">&#93;</span> <span style="color: #FF8000;">as</span> c 
j.<span style="color: #0000FF;">favoriteColors</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Red&quot;</span>
j.<span style="color: #0000FF;">favoriteColors</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Blue&quot;</span>
<span style="color: #0600FF;">dim</span> js <span style="color: #FF8000;">as</span> c 
js <span style="color: #008000;">=</span> varToJSON<span style="color: #000000;">&#40;</span>j<span style="color: #000000;">&#41;</span>
&nbsp;
<span style="color: #0600FF;">dim</span> jsToSetControlValues <span style="color: #FF8000;">as</span> c
jsToSetControlValues <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;{dialog.object}.populate(&quot;</span> <span style="color: #008000;">+</span> js <span style="color: #008000;">+</span><span style="color: #808080;">&quot;);&quot;</span> <span style="color: #008000;">+</span> <span style="color: #0600FF;">crlf</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">+\</span>
<span style="color: #808080;">&quot;{dialog.object}.prepare();&quot;</span></pre></div><br />
The Javascript that you generate can also set the number of rows to show in a Repeating Section.<br />
<br />
In this next example, we generate Javascript to set the number of rows in a Repeating Section to 7. The <strong>._setRepeatingSectionRowCount()</strong> method takes two optional arguments:<br />
<br />
<table class="normal" id="fancytable_1">			<tr>			<td class="odd"><strong>focustFirst</strong></td>			<td class="odd">If true, focus will be set to the first Repeating Section Row, and if false, focus will be set to the last Repeating Section row.</td>		</tr>		<tr>			<td class="even"><strong>nullExisting</strong></td>			<td class="even">If true, existing data in the Repeating Section will be nulled out.</td>		</tr></table><br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox5" >dim jsToControlValues as c 
jsToControlValues = &lt;&lt;%jstxt%
var rows = 7;
var focusFirst = true;
var nullExisting = false;
var rSId = 'CONTAINER_1';
{dialog.object}._setRepeatingSectionRowCount(rSId,rows,focusFirst,nullExisting);
var _d = {};
_d['B'] = 'alpha'; //set the value of a control called 'B'
_d['E:2'] = 'beta'; //set the value of a 'E' in the 2nd Repeating Section row
_d['G:6'] = ['Red','Green']; //set checkbox 'G' in the 6th row to 'Red' and 'Green'
{dialog.object}.populate(_d);
{dialog.object}.prepare();
%jstxt%</pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Dialog+Component+Setting+Values+in+Controls+Optimizing+for+Setting+a+Large+Number+of+Controls+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: "{}" --->
</body></html>