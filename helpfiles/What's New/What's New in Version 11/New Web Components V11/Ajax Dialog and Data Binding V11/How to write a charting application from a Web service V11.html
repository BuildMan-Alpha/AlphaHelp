	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_write_a_charting_application_from_a_Web_service">How to write a charting application from a Web service</h1>
<em>Requires feature pack</em> Chart Controls for the Dialog Component <em>or subscription</em><br />
<br />
Alpha Software used to position its products as database application development tools. The way our Ajax Grid and Report engine are designed, that was largely true: you couldn't get much built unless you had a database, be it SQL or DBF.<br />
<br />
That's no longer the case, however. In the two videos we're going to discuss, Selwyn Rabins shows you how to build a stock charting application that uses a REST Web service call to Yahoo! Stocks to populate a high-low-close chart, without sending the data by way of a local database. Now, it's not that there's any dearth of Stock Charting applications in the world, but think about it: a high-low-close chart (or any other form of time-series chart) is also useful for other data that varies with time, be it daily factory production yield ranges or minute-by-minute patient blood pressure range readings in a hospital setting.<br />
<br />
Selwyn starts this video by demonstrating the application, and then lifts the covers to show you how it was done. It is best viewed full-screen.<br />
<br />
<div id="wp-flash-2bed4998b18f0813124b4dff918d1940">Flash player not available.</div><br />
<a class="wiki external" target="_blank" href="http://www.ajaxvideotutorials.com/V11Videos/chart_stockPrice_1.swf" rel="external nofollow">Alternate video link</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<br />
The key code discussed above is:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox" ><span style="color: #0600FF;">dim</span> url <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;http://ichart.finance.yahoo.com/table.csv?a=&quot;</span><span style="color: #008000;">+</span><span style="color: #0600FF;">month</span><span style="color: #008000;">+</span><span style="color: #808080;">&quot;&amp;b=&quot;</span><span style="color: #008000;">+</span>dayNumber<span style="color: #008000;">+</span><span style="color: #808080;">&quot;&amp;c=&quot;</span><span style="color: #008000;">+</span><span style="color: #0600FF;">year</span><span style="color: #008000;">+</span><span style="color: #808080;">&quot;&amp;s=&quot;</span><span style="color: #008000;">+</span>ticker
<span style="color: #0600FF;">dim</span> data <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> http_get_page2<span style="color: #000000;">&#40;</span>url<span style="color: #000000;">&#41;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'data returned by yahoo is chr(10) delimited, not crlf delimited!</span>
<span style="color: #008080; font-style: italic;">'data is returned with newest data on top. we want oldest data on top, so sort the data.</span>
data <span style="color: #008000;">=</span> word<span style="color: #000000;">&#40;</span>data,<span style="color: #FF0000;">2</span>,<span style="color: #0600FF;">chr</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">10</span><span style="color: #000000;">&#41;</span>,<span style="color: #FF0000;">999999</span><span style="color: #000000;">&#41;</span>
data <span style="color: #008000;">=</span> strtran<span style="color: #000000;">&#40;</span>data,<span style="color: #808080;">&quot;,&quot;</span>,<span style="color: #808080;">&quot;|&quot;</span><span style="color: #000000;">&#41;</span>
data <span style="color: #008000;">=</span> sortsubstr<span style="color: #000000;">&#40;</span>data,<span style="color: #0600FF;">chr</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">10</span><span style="color: #000000;">&#41;</span>,<span style="color: #808080;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span></pre></div><br />
Basically, all we have to do is to construct the correct URI for the stock we want, get the page associated with that URI, and massage the data a little so that it is in the correct format for the chart.<br />
<br />
In the second half of the video, Selwyn debugs through the call and lets you see the data, then shows you how the ticker name is retrieved from the drop-down and put into the chart to implement the dynamic title.<br />
<br />
<div id="wp-flash-c562f9045b541f28f1a0e7645bcf7180">Flash player not available.</div><br />
<a class="wiki external" target="_blank" href="http://www.ajaxvideotutorials.com/V11Videos/chart_stockPrice_2.swf" rel="external nofollow">Alternate video link</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<br />
How cool is that?<br />
<br />
	<img src="images/gm_stock_chart.png" alt="Image" /><br />
<br />
You can <a class="wiki external" target="_blank" href="http://www.ajaxvideotutorials.com/V11Videos/StockPrice.a5wcmp" rel="external nofollow">download the component used for this application from here</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />. Once you have it, copy it into an Alpha Five v11 web project and modify it to your heart's content.<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+write+a+charting+application+from+a+Web+service+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"/Guides"} --->
</body></html>