	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Creating_a_Property_Grid_for_a_User-defined_Component">Creating a Property Grid for a User-defined Component</h1>
One way to create a Property Grid for a User-defined Component is to use the Property Grid builder in Action Scripting to generate the markup. This is invoked by creating a New Script (using Action Scripting), adding a new action, and selecting Xdialog Windows|Display an Xdialog Box. In the Xdialog builder, assign a variable name, use a style of Property-grid style Dialog, and press Define Property-Grid Dialog. Add Categories and Items to define the grid you want, then view the resulting code and extract the markup. This builder is documented in the article <a href="../../../../Unclassified/Property-Grid Style Dialog.html" title="Property-Grid Style Dialog" class="wiki">Property-Grid Style Dialog</a>. Additional field types are documented in the article <a href="../../../What's New in Version 10/Release Notes V10/Property Grids V10.html" title="Property Grids V10" class="wiki">Property Grids V10</a>.<br />
<br />
A faster way to create a Property Grid, at least once you know the syntax, is to edit the markup directly. The <a href="../../../../Unclassified/Property Grid comprehensive sample.html" title="Property Grid comprehensive sample" class="wiki">Property Grid comprehensive sample</a> will show you all the essential elements if you're not already familiar with them. Copy that code to a new script using Xbasic and run it to see how it works and read the help in context; compare that to the code to understand what you need to do to get the desired effect.<br />
<h2 class="showhide_heading" id="Properties_and_property_grid_for_the_Demo_component">Properties and property grid for the Demo component</h2>
If you open <strong>componentBuilderPropertyGridDefinition.txt</strong> in your programming editor you will discover that the sample property grid, <em>mirabile dictu</em>, is for a light-weight grid. All we need to do is uncomment it and wire up the functions it needs.<br />
<br />
After you uncomment the property grid, the file should look like this:<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox" >^^Light Weight Grid Properties
  state=opened

  ++Data source type
    var=wp.dataSourceType
    help=Specify if the Grid gets its data from a SQL database, or .dbf tables.
    type=combo
    data=SQL,DBF
    event=setDirty
    
  ++Table or View
    var=wp.dbfType
    help=Specify if the Grid gets its data from a single table of a view that joins multiple .dbf tables
    show=wp.dataSourceType="dbf"
    type=combo
    data=@choices.dbfTableOrView
    event=setDirty
    
  ++Table name
    var=wp.dbfTableName
    type=smart
    data=wp.dbfTablename=bf.tablePicker(wp.dbfTablename)
    show=wp.dataSourceType="dbf" .and. wp.dbfType = "Table"
    help=Specify the table name.
    event=setDirty</pre></div><br />
<br />
Save the file and try to create a new Demo component. Try the property tab. You'll see the three light-weight grid properties. The Data source type combo box will work correctly, as the choices were defined inline. The other combo box and the smart field will not work properly.<br />
<br />
Fixing the second combo box is easy: edit <strong>componentBuilderChoiceListsForPropertyGrid.txt</strong>, uncomment the sample, and save the file. When you're done it should look like this:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" ><span style="color: #0600FF;">dim</span> choices.<span style="color: #0000FF;">dbfTableOrView</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> comma_to_crlf<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Table,View&quot;</span><span style="color: #000000;">&#41;</span></pre></div><br />
<br />
Try to create a new Demo component, and now both combo boxes should work.<br />
<br />
Now for the smart field. Start by editing <strong>componentProperties.txt</strong>, and once again uncomment the code. The file should then look like this:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox2" ><span style="color: #0600FF;">dim</span> wp.<span style="color: #0000FF;">dataSourceType</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;DBF&quot;</span>
<span style="color: #0600FF;">dim</span> wp.<span style="color: #0000FF;">dbfType</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;Table&quot;</span>
<span style="color: #0600FF;">dim</span> wp.<span style="color: #0000FF;">dbfTableName</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> wp.<span style="color: #0000FF;">sqlConnectionString</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> wp.<span style="color: #0000FF;">sqlQuery</span> <span style="color: #FF8000;">as</span> c  <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span></pre></div><br />
<br />
Now go back to <strong>builderFunctionDefinitions.txt</strong>. We'll have to fill in the bodies of the two functions at the end of the file. The code you need is:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox3" ><span style="color: #0600FF;">function</span> getDataSourceType <span style="color: #FF8000;">as</span> c <span style="color: #000000;">&#40;</span>type <span style="color: #FF8000;">as</span> c <span style="color: #000000;">&#41;</span>
&nbsp;
  getDataSourceType <span style="color: #008000;">=</span> ui_get_text<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Builder Type&quot;</span>,<span style="color: #808080;">&quot;Specify the builder type: &quot;</span>, wp.<span style="color: #0000FF;">dataSourceType</span><span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">if</span> getDataSourceType <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;&quot;</span> <span style="color: #FF8000;">then</span> 
    getDataSourceType <span style="color: #008000;">=</span> type 
  <span style="color: #0600FF;">end</span> <span style="color: #0600FF;">if</span> 
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">function</span>
&nbsp;
<span style="color: #0600FF;">function</span> tablePicker <span style="color: #FF8000;">as</span> c <span style="color: #000000;">&#40;</span>tablename <span style="color: #FF8000;">as</span> c <span style="color: #000000;">&#41;</span>
  tablePicker <span style="color: #008000;">=</span> a5wcb_tablePicker<span style="color: #000000;">&#40;</span>tablename<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">function</span></pre></div><br />
<br />
There's one more thing we need to do: make the component actually <em>use</em> the table we select. In <strong>builderFunctionDefinitions.txt</strong>, find the line<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox4" >t <span style="color: #008000;">=</span> table.<span style="color: #0600FF;">open</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;customer&quot;</span><span style="color: #000000;">&#41;</span></pre></div><br />
<br />
and change it to<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox5" >t <span style="color: #008000;">=</span> table.<span style="color: #0600FF;">open</span><span style="color: #000000;">&#40;</span>e.<span style="color: #0000FF;">tmpl</span>.<span style="color: #0000FF;">dbfTableName</span><span style="color: #000000;">&#41;</span></pre></div><br />
<br />
Now a new Demo component should be able to select and display a DBF table.<br />
<br />
Supporting SQL connections and DBF expressions are left as exercises for the student.<br />
<h2 class="showhide_heading" id="What_if_I_have_good_defaults_">What if I have good defaults?</h2>
If you create a new Demo component and try to preview it immediately, you'll get an error message that you have not specified any properties, and quite rightly so. But suppose you have good defaults, so that your component can run "right out of the box?"<br />
<br />
In that case, set<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox6" >wp.<span style="color: #0000FF;">flagOKToPreviewBeforeUserEdits</span> <span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.</pre></div><br />
<br />
in <strong>componentProperties.txt</strong>. Now you can create a new component and immediately preview it.<br />
<h2 class="showhide_heading" id="See_also">See also</h2>
<a href="../User-defined Components V11.html" title="User-defined Components V11" class="wiki">User-defined Components V11</a><br />
<a href="When to turn a Custom Component into a User-defined Component V11.html" title="When to turn a Custom Component into a User-defined Component V11" class="wiki">When to turn a Custom Component into a User-defined Component V11</a><br />
<a href="Creating a User-defined Component V11.html" title="Creating a User-defined Component V11" class="wiki">Creating a User-defined Component V11</a><br />
<a href="Creating a Property Grid for a User-defined Component V11.html" title="Creating a Property Grid for a User-defined Component V11" class="wiki">Creating a Property Grid for a User-defined Component V11</a><br />
<a href="Sharing and Using a User-defined Component V11.html" title="Sharing and Using a User-defined Component V11" class="wiki">Sharing and Using a User-defined Component V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+a+Property+Grid+for+a+User-defined+Component+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"/Guides"} --->
</body></html>