	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Google_Map_Component">Google Map Component</h1>
<em><strong>Optional feature pack, included in subscription</strong></em><br />
<div id='toc'><div id='toctitle'><h3>Table of contents</h3></div><ul class="toc"><li><a href="#Google_Map_Component" class='link'>Google Map Component</a>
<ul><li><a href="#Introduction" class='link'>Introduction</a>
</li><li><a href="#Creating_a_Google_Map_Component" class='link'>Creating a Google Map Component</a>
</li><li><a href="#Setting_Google_Map_Component_Properties_in_the_UI" class='link'>Setting Google Map Component Properties in the UI</a>
<ul><li><a href="#Google_Map_Properties" class='link'>Google Map Properties</a>
</li><li><a href="#HTML_Properties" class='link'>HTML Properties</a>
</li></ul></li><li><a href="#JavaScript_Functions" class='link'>JavaScript Functions</a>
</li><li><a href="#Xbasic_Functions" class='link'>Xbasic Functions</a>
</li><li><a href="#Server-side_events" class='link'>Server-side events</a>
</li><li><a href="#Client-side_events" class='link'>Client-side events</a>
</li><li><a href="#Linking_a_Map_to_a_Grid" class='link'>Linking a Map to a Grid</a>
</li><li><a href="#Using_a_Map_as_an_Alternate_Grid_View" class='link'>Using a Map as an Alternate Grid View</a>
<ul><li><a href="#Locations_versus_Addresses_for_marker_placement" class='link'>Locations versus Addresses for marker placement</a>
</li><li><a href="#Using_dynamic_markers_and_labeled_marker_sequences" class='link'>Using dynamic markers and labeled marker sequences</a>
</li><li><a href="#See_also" class='link'>See also</a>
</li></ul></li><li><a href="#Using_the_Google_Map_as_a_Grid_search_control" class='link'>Using the Google Map as a Grid search control</a>
<ul><li><a href="#See_also_2" class='link'>See also</a>
</li></ul></li><li><a href="#Customizing_your_Google_Map_Component" class='link'>Customizing your Google Map Component</a>
</li><li><a href="#Google_Map_Component_Action_JavaScript_actions" class='link'>Google Map Component Action JavaScript actions</a>
</li><li><a href="#Google_Map_Component_Xbasic_Arguments_and_Properties" class='link'>Google Map Component Xbasic Arguments and Properties</a>
</li><li><a href="#Google_Map_Component_JavaScript_Properties_and_Methods" class='link'>Google Map Component JavaScript Properties and Methods</a>
</li><li><a href="#Videos" class='link'>Videos</a>
</li><li><a href="#See_Also" class='link'>See Also</a>
</li></ul></li></ul><!--toc--></div><br />
<h2 class="showhide_heading" id="Introduction">Introduction</h2>
When you want to present information about location, the best user interface is often a map. In Alpha Five V11, you can use map components in your Web pages as easily as you use grids or dialogs.<br />
<br />
Our map component depends on the <a class="wiki external" target="_blank" href="http://code.google.com/apis/maps/documentation/javascript/" rel="external nofollow">Google Maps JavaScript API</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />. The JavaScript Maps API V3 is a free service, <em>available for any web site that is free to consumers</em>. <strong>Please see the <a class="wiki external" target="_blank" href="http://code.google.com/apis/maps/terms.html" rel="external nofollow">terms of use</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /> for more information.</strong> If you don't qualify for the terms of use, you can use the <a class="wiki external" target="_blank" href="http://code.google.com/apis/maps/documentation/premier/guide.html" rel="external nofollow">Google Maps API Premier</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /> service with the Alpha Five Google Map Component, as explained in the Google Map Properties below, once you license a Client ID from Google.<br />
<br />
Maps are based on locations, specified by latitude and longitude. In a geographic database, a location is a searchable data type: see <a href="../Geographic Databases V11.html" title="Geographic Databases V11" class="wiki">Geographic Databases V11</a>.<br />
<br />
Determining a latitude and longitude from an address is called <em>geocoding</em>. Determining the user's current position is called <em>geolocation</em>. Our map component uses the free <a class="wiki external" target="_blank" href="http://wiki.openstreetmap.org/wiki/Nominatim" rel="external nofollow">Nominatim</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /> service for geocoding by default, or <a class="wiki external" target="_blank" href="http://code.google.com/apis/maps/documentation/premier/guide.html" rel="external nofollow">Google Maps API Premier</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /> if you have a license. Our map component can optionally use HTML 5 geolocation on supported browsers; this works best on mobile devices.<br />
<br />
In addition to using the Google Map Component by itself, you can link it to a Grid, place it in a Tabbed UI, place it in a Page Layout component, and call it from Action JavaScript. The Google Map Component works in desktop applications as well as Web applications. The image below is a Google Map Component with default options running in Working Preview mode &mdash; i.e., on the desktop.<br />
<br />
	<img src="images/google_map_1.png" alt="Image" /><br />
<h2 class="showhide_heading" id="Creating_a_Google_Map_Component">Creating a Google Map Component</h2>
From the Alpha Five Web Projects Control Panel, create a new Web Component, select More Components, select Google Map, and press OK. Switch to the Properties Panel.<br />
<h2 class="showhide_heading" id="Setting_Google_Map_Component_Properties_in_the_UI">Setting Google Map Component Properties in the UI</h2>
<h3 class="showhide_heading" id="Google_Map_Properties">Google Map Properties</h3>
<table class="normal" id="fancytable_1">			<tr>			<td class="odd">Initial Map Type</td>			<td class="odd">The type of Google Map to display. This can be changed by the user using the displayed controls.</td>		</tr>		<tr>			<td class="even">Use Google Maps Premier</td>			<td class="even">Check this if you have a Google Maps Premier client ID and want to use it</td>		</tr>		<tr>			<td class="odd">Google&nbsp;Maps&nbsp;Premier&nbsp;Client&nbsp;ID</td>			<td class="odd">Enter your Google Maps Premier client ID</td>		</tr>		<tr>			<td class="even">Use SSL for Google Maps Premier</td>			<td class="even">Check this if you want to call Google Maps Premier using SSL (HTTPS:) <strong>Note</strong>: Google does not allow you to call the Maps API using SSL unless you have a Premier license.</td>		</tr>		<tr>			<td class="odd">Use Sensor</td>			<td class="odd">Check this if you want to use a GPS or other geolocation method for any reason.</td>		</tr>		<tr>			<td class="even">Set Initial Position from Sensor</td>			<td class="even">Check this if you want to use a GPS or other geolocation method (IP geolocation) to set the initial map center.  <strong>NOTE:</strong> We use HTML 5 geolocation, and fall back to any other specified initial position if HTML 5 geolocation is unavailable or the user does not allow the use of her location. On a mobile device, HTML 5 geolocation can have an accuracy of a few meters in the best case, using assisted GPS. On a desktop computer, HTML 5 geolocation tends <em>not</em> to be very accurate.</td>		</tr>		<tr>			<td class="odd">Initial zoom factor</td>			<td class="odd">The initial zoom factor on the map. This can be changed by the user using the displayed controls. 0 shows the whole world; 20 shows a few square yards. Displaying a circle will override this setting.</td>		</tr>		<tr>			<td class="even">Create marker at initial center</td>			<td class="even">Check this if you want a push pin and/or polygon vertex created at the initial map center</td>		</tr>		<tr>			<td class="odd">Initial marker is draggable</td>			<td class="odd">Check this if you want the initial push pin to be draggable by the user</td>		</tr>		<tr>			<td class="even">Show markers</td>			<td class="even">Check this if you want push pins displayed</td>		</tr>		<tr>			<td class="odd">Added markers are draggable</td>			<td class="odd">Check this if you want any user-added push pins to be draggable by the user</td>		</tr>		<tr>			<td class="even">Show polygon</td>			<td class="even">Check this if you want a polygonal area displayed</td>		</tr>		<tr>			<td class="odd">Polygon color</td>			<td class="odd">The color used for displaying the Polygon, as hex RGB, e.g. #FF0000</td>		</tr>		<tr>			<td class="even">Maximum number of points</td>			<td class="even">The maximum number of markers or vertices to display</td>		</tr>		<tr>			<td class="odd">Show circle</td>			<td class="odd">Check this if you want a circle displayed</td>		</tr>		<tr>			<td class="even">Circle color</td>			<td class="even">The color used for displaying the circle, as hex RGB, e.g. #00FF00</td>		</tr>		<tr>			<td class="odd">Circle radius</td>			<td class="odd">The radius of the circle to display, in meters. 1 mile is roughly 1609 m. Note that displaying a circle resets the map size.</td>		</tr>		<tr>			<td class="even">Geocoding source</td>			<td class="even">The service to use for geocoding addresses.</td>		</tr>		<tr>			<td class="odd">Reinitialize on Geocode</td>			<td class="odd">Check this if you want to reinitialize the map if the user geocodes an address. Otherwise, the geocoded point will be added to the map.</td>		</tr></table><br />
<h3 class="showhide_heading" id="HTML_Properties">HTML Properties</h3>
<table class="normal" id="fancytable_2">			<tr>			<td class="odd">Map Width</td>			<td class="odd">The width of the map, e.g. "400px" or "3in"</td>		</tr>		<tr>			<td class="even">Map Height</td>			<td class="even">The height of the map, e.g. "500px" or "4in"</td>		</tr>		<tr>			<td class="odd">Toolbar HTML</td>			<td class="odd">HTML that defines the controls for the toolbar. A default set of controls is provided that you may edit to suit your needs.</td>		</tr></table><br />
For discussion of the other properties, which the Google Map Component has in common with all custom and user-defined components, see <a href="Custom Components V11/Custom Component Sections and Events V11.html" title="Custom Component Sections and Events V11" class="wiki">Custom Component Sections and Events V11</a>.<br />
<h2 class="showhide_heading" id="JavaScript_Functions">JavaScript Functions</h2>
No user-modifiable JavaScript functions have been defined by default in the Google Map Component. This area is a good place to put new JavaScript functions that you want to call from HTML events. Functions created here can use the component's JavaScript methods and properties, and the methods and properties of Google Maps API objects that are stored in the component's JavaScript properties.<br />
<h2 class="showhide_heading" id="Xbasic_Functions">Xbasic Functions</h2>
One user-modifiable Xbasic function has been defined by default.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #008080; font-style: italic;">'Sample Callback function -- edit the action to your own purposes</span>
<span style="color: #0600FF;">function</span> TakeLatLng <span style="color: #FF8000;">as</span> C <span style="color: #000000;">&#40;</span>e <span style="color: #FF8000;">as</span> P<span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">dim</span> npts <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">val</span><span style="color: #000000;">&#40;</span>Request.<span style="color: #0000FF;">Variables</span>._npts<span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">dim</span> radius <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> Request.<span style="color: #0000FF;">Variables</span>._radius <span style="color: #008080; font-style: italic;">'in meters</span>
  <span style="color: #0600FF;">dim</span> LatLngArray<span style="color: #000000;">&#91;</span>npts<span style="color: #000000;">&#93;</span> <span style="color: #FF8000;">as</span> C <span style="color: #008080; font-style: italic;">'e.g. [&quot;(42.478606, -71.201289)&quot;,...]</span>
  <span style="color: #FF8000;">for</span> i<span style="color: #008000;">=</span><span style="color: #FF0000;">1</span> <span style="color: #FF8000;">to</span> npts
    LatLngArray<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> eval<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Request.Variables._LatLng&quot;</span><span style="color: #008000;">+</span><span style="color: #000000;">&#40;</span>i<span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
  <span style="color: #FF8000;">next</span>
  <span style="color: #0600FF;">dim</span> showCircle <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;true&quot;</span> <span style="color: #008000;">=</span> Request.<span style="color: #0000FF;">Variables</span>._showCircle<span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">dim</span> showMarkers <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;true&quot;</span> <span style="color: #008000;">=</span> Request.<span style="color: #0000FF;">Variables</span>._showMarkers<span style="color: #000000;">&#41;</span>
  <span style="color: #0600FF;">dim</span> showPolygon <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;true&quot;</span> <span style="color: #008000;">=</span> Request.<span style="color: #0000FF;">Variables</span>._showPolygon<span style="color: #000000;">&#41;</span>
  <span style="color: #008080; font-style: italic;">'debug(1)</span>
  <span style="color: #008080; font-style: italic;">'do something with the values </span>
  <span style="color: #008080; font-style: italic;">'for example: pop up a message</span>
  TakeLatLng <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;alert('radius is &quot;</span> <span style="color: #008000;">+</span> radius <span style="color: #008000;">+</span> <span style="color: #808080;">&quot; m around &quot;</span><span style="color: #008000;">+</span>LatLngArray<span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #008000;">+</span><span style="color: #808080;">&quot;');&quot;</span>
  <span style="color: #008080; font-style: italic;">'for example: do a point-radius search if we're showing the circle, and display results</span>
  <span style="color: #008080; font-style: italic;">'for example: do a Polygon search if we're showing the Polygons, and display results</span>
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">function</span></pre></div><br />
<br />
Callback functions can return JavaScript to be executed by the component.<br />
<br />
You may also add other Xbasic functions here, both callback functions and functions called from server-side events.<br />
<h2 class="showhide_heading" id="Server-side_events">Server-side events</h2>
Like user-defined components, the Google Map Component exposes 3 user-modifiable server-side events: <strong>onComponentInitialize</strong>, <strong>onComponentExecute</strong>, and <strong>onInitialRender</strong>, called in that order when the component is first run. When an ajax callback is made, the <strong>onComponentExecute</strong> event is called.<br />
<br />
The Google Map Component does all of its server-side initialization in the <strong>systemOnInitialRender </strong> event, which is called just prior to <strong>onInitialRender</strong>. You can usefully populate the <strong>markerPropertyArray </strong> or <strong>markerPropertyArrayString</strong> inside the <strong>onComponentInitialize</strong> event, perhaps obtaining your data from a database or a web service. If <strong>markerPropertyArrayString</strong> has been defined when <strong>systemOnInitialRender </strong> is run, it is used to populate the JavaScript <strong>bulkMarkersArray</strong>; if not, then if <strong>markerPropertyArray </strong>has been defined, <em>it</em> is used to populate the JavaScript <strong>bulkMarkersArray</strong>.<br />
<div class="clearfix rbox warning"><img src="images/close.png" alt="Close" width="16" height="16" class="rbox-close" onclick="$(this).parent().fadeOut();" title="Close" /><div class="rbox-title"><img src="images/exclamation.png" alt="warning" width="16" height="16" title="warning" class="icon" /><span>Warning</span></div><div class="rbox-data">Do not overwrite <strong>e.javascript</strong> in the <strong>onInitialRender </strong>event, or no map will be displayed. You may append your own JavaScript if you wish, e.g. <strong>e.javascript = e.javascript + myJS</strong>. Similarly, do not overwrite <strong>e.html</strong>, or the DIV that holds the map will not be created. If you wish to modify the DIV or toolbar HTML, edit the exposed HTML properties.</div></div><br />
<h2 class="showhide_heading" id="Client-side_events">Client-side events</h2>
Like custom and user-defined components, the Google Map Component exposes 3 user-modifiable client-side events:<br />
<ul><li>canAjaxCallback
</li><li>afterAjaxCallbackComplete
</li><li>onInitializeComplete
</li></ul><h2 class="showhide_heading" id="Linking_a_Map_to_a_Grid">Linking a Map to a Grid</h2>
Follow this recipe to make a Map pop up to display a location from a Grid row.<br />
<ol><li>Create a new Google Map Component
</li><li>Edit the Toolbar HTML and delete everything defined, since we don't want a toolbar
</li><li>Change the maximum number of points to 1
</li><li>Save the map
</li><li>Open your grid
</li><li>Add an Action Button
</li><li>In the Button Action, Add a new action using Action JavaScript to open a Google Map Component
</li><li>Pick the map you just saved
</li><li>If your grid has latitude and longitude fields, bind them to the CenterLat and CenterLng arguments
</li><li>If your grid doesn't have latitude and longitude fields, but has an address field, bind that to the CenterAddress argument. The address field needs to be complete enough for geocoding.
</li><li>Optionally bind the Titles and InfoText arguments to fields you want to appear in the marker's mouseOver and onClick displays
</li><li>Set the pop-up window width and height to be a few pixels larger than your map.
</li><li>Save the Action Button
</li><li>Create a Toolbar Action Button bound to the Action Button you just saved
</li><li>Run your grid and adjust your settings to be pleasing
</li></ol>Here's what we were able to do following this recipe exactly with an Airport database Grid. Click on the thumbnail to see it full size, and press the Backspace key to return to this discussion.<br />
<br />
<a href="img/wiki_up/pop-up_map_for_airport_row.png" class="internal">	<img src="images/pop-up_map_for_airport_row.png" height="340" width="525" alt="Image" /></a><br />
<br />
Note that to get latitude and longitude fields in this grid we used the following Alpha Five Portable SQL expressions:<br />
<br />
<div class="plugincode" parse="sql"><pre class="codelisting" data-syntax="sql" dir="ltr" style="overflow:auto;" id="codebox1" >GeogLatitude<span style="color: #66cc66;">&#40;</span>Location<span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">AS</span> Lat<span style="color: #66cc66;">,</span>  GeogLongitude<span style="color: #66cc66;">&#40;</span>Location<span style="color: #66cc66;">&#41;</span>  <span style="color: #993333; font-weight: bold;">AS</span> Lon</pre></div><br />
<br />
If you had separate city, state, and address fields in your database, you could concatenate them in a SQL expression. In general, however, it is best to geocode addresses once and store the location in the database, rather than geocoding them on the fly every time they are viewed.<br />
<h2 class="showhide_heading" id="Using_a_Map_as_an_Alternate_Grid_View">Using a Map as an Alternate Grid View</h2>
In a grid that has latitude and longitude fields:<br />
<ol><li>Check the property "Has Alternate Views"
</li><li>Open the builder for the Alternate Views definition.
</li><li>Add an Alternate View of type Google Map
</li><li>Select the Location type
</li><li>Create expressions for Latitude and Longitude
</li><li>Optionally create expressions for Title and Info box
</li><li>Optionally create a list of expressions for dynamic markers, or select a built-in image sequence for numbered or lettered markers
</li><li>In the Main View tab configure how you want the alternate view displayed
</li><li>Run the grid and adjust the settings to be pleasing
</li></ol>We achieved the alternate view below following the above recipe. Click on the thumbnail to view the image full size, and press the Backspace key to return to this discussion.<br />
<br />
<a href="img/wiki_up/airports_alternate_view.png" class="internal">	<img src="images/airports_alternate_view.png" height="340" width="525" alt="Image" /></a><br />
<h3 class="showhide_heading" id="Locations_versus_Addresses_for_marker_placement">Locations versus Addresses for marker placement</h3>
If you have a table with addresses rather than locations, using it <em>as is</em> will lead to degraded runtime performance for your grid, as each call to geocode an address takes a fraction of a second. This is noticeable but not severe on a web page, since the geocoding happens in asynchronous Ajax callbacks, and all of your addresses can be geocoded in a couple of seconds. It is <em>annoyingly</em> slow when you run a Google Map Component with bulk markers (e.g. for an Alternate View) that are defined by addresses on the desktop or in Working Preview, since the Ajax callbacks for geocoding are serialized: a map with 10 bulk markers defined by addresses can take as long as 10 seconds to initialize, long enough for a user to think it has crashed.<br />
<br />
We can geocode addresses with the free <a class="wiki external" target="_blank" href="http://wiki.openstreetmap.org/wiki/Nominatim" rel="external nofollow">Nominatim</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /> service as well as with Google. Nominatim imposes no rate limit, but takes a <em>large</em> fraction of a second to return a geocoded location. Nominatim seems to work fairly well for U.S. and U.K. addresses, but your mileage may vary. We have had reports of Nominatim not working well for specific languages and locations, such as Flemish place names in Belgium.<br />
<br />
<strong>Google</strong> is the geocoding default. Be aware, however, that the <em>free</em> Google Maps API is rate-limited to about 6 geocoding attempts per second, after which it will stop giving answers. In practice, this imposes a limit on the number of rows per page in a grid that uses a map that is based on addresses rather than locations in an alternate view .<br />
<br />
If you are a Google Premier Maps customer, check "Use Google Maps Premier," and supply a Google Premier Maps Client ID, then we geocode addresses with Google Maps Premier, which typically returns a geocoded location in 100 ms, <em>even if you selected Nominatum</em>, since Google Premier Maps is so much better and faster than Nominatum. (For $10K a year, it certainly <em>should</em> be better.) If you have a case where this presents a problem, let us know and we'll change the behavior.<br />
<br />
<div class="clearfix rbox note"><img src="images/close.png" alt="Close" width="16" height="16" class="rbox-close" onclick="$(this).parent().fadeOut();" title="Close" /><div class="rbox-title"><img src="images/information.png" alt="note" width="16" height="16" title="note" class="icon" /><span>Note</span></div><div class="rbox-data">If you create a map that takes its initial position from an address using Nominatim for geocoding and use IE 9, don't be surprised if you see a message about the page "accessing information that is not under its control" in Live Preview. You can eliminate the message by loosening IE's permissions for the intranet zone. Specifically, change the security settings for <strong>Local Intranet|Custom|Miscellaneous|Access data across domains</strong> to <strong>Enable </strong>from <strong>Prompt</strong>. Using Google for geocoding does not cause this message to display.<br />
<br />
If you plan to deploy a site that uses Nominatim for geocoding and your users plan to use IE 9, you may want to advise them to add your site to the Trusted Sites list.</div></div><br />
<br />
If you have a database with addresses that you'd like to be the basis of a Google Map alternate view, consider adding locations to the table as a one-time process using a bulk geocoding operation. If you need to add locations as people enter addresses in your grid, you can use Action JavaScript to geocode the latitude and longitude from the address.<br />
<br />
If you need to store Geography location objects in a geography-enabled SQL database for searching purposes, you can use the <strong>GeogCreateLocation </strong> Portable SQL function to construct the location object from the latitude and longitude, typically in the <strong>onBeforeSQLCommandExecute </strong> event for INSERT and UPDATE queries.<br />
<br />
If you're having trouble getting geocoding to work, test the individual addresses at <a target="_blank" class="wiki external"  href="http://nominatim.openstreetmap.org">http://nominatim.openstreetmap.org<img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /></a> or <a target="_blank" class="wiki external"  href="http://maps.google.com">http://maps.google.com<img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /></a> until you get the format right. The more complete the address, the more likely it is to code properly. Also, delimiting the address fields with commas helps the parser. Try Alpha's address, "70 Blanchard Rd, Burlington, MA", as a known good case.<br />
<h3 class="showhide_heading" id="Using_dynamic_markers_and_labeled_marker_sequences">Using dynamic markers and labeled marker sequences</h3>
If you want a map to communicate some attribute at each location, you can use dynamic markers, meaning that the marker glyph used at any point depends on some expression, such as "sales &gt; 100000" or "population&gt;1000000" or "elevation &lt; 500". This map feature is similar to the conditional image feature of grids. Hover over each picture to see it full size.<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=690','HEIGHT=584','BACKGROUND=img/wiki_up/dynamic_markers.png']);">	<img src="images/dynamic_markers.png" height="292" width="345" alt="Image" /></a><br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=493','HEIGHT=524','BACKGROUND=img/wiki_up/elevation_markers.png']);">	<img src="images/elevation_markers.png" height="262" width="246" alt="Image" /></a><br />
<br />
If you want to be able to visually connect grid rows with their corresponding markers, you can use labeled marker sequences, and also use marker sequences for the grid images. This behavior is similar to what a business search on Google Maps will show you.<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=510','HEIGHT=467','BACKGROUND=img/wiki_up/image_sequence.png']);">	<img src="images/image_sequence.png" height="233" width="255" alt="Image" /></a><br />
<br />
If the number of images in the sequence is smaller than the number of markers to be displayed, any additional markers use the default marker glyph.<br />
<h3 class="showhide_heading" id="See_also">See also</h3>
<a href="../Web Grid Enhancements V11/Web Grid Alternate Views V11.html" title="Web Grid Alternate Views V11" class="wiki">Web Grid Alternate Views V11</a><br />
<h2 class="showhide_heading" id="Using_the_Google_Map_as_a_Grid_search_control">Using the Google Map as a Grid search control</h2>
In a grid that is based on a SQL database that has a Geography field, add the Geography field to the search part of the grid and set it to a Map control type. (Hover over each picture to see it full size.)<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=429','HEIGHT=127','BACKGROUND=img/wiki_up/map_control_type_in_search.png']);">	<img src="images/map_control_type_in_search.png" height="63" width="214" alt="Image" /></a><br />
<br />
Open the map properties.<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=514','HEIGHT=676','BACKGROUND=img/wiki_up/map_search_part_properties.png']);">	<img src="images/map_search_part_properties.png" height="338" width="257" alt="Image" /></a><br />
<br />
Set the properties and test the control. You can display the results in the grid, in a map that is an alternate view to the grid, and/or in the search grid itself.<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=628','HEIGHT=456','BACKGROUND=img/wiki_up/search_for_25_miles_around_Boston.png']);">	<img src="images/search_for_25_miles_around_Boston.png" height="228" width="314" alt="Image" /></a><br />
<br />
<h3 class="showhide_heading" id="See_also_2">See also</h3>
<a href="../Web Grid Enhancements V11/Web Grid Geographical Search V11.html" title="Web Grid Geographical Search V11" class="wiki">Web Grid Geographical Search V11</a><br />
<h2 class="showhide_heading" id="Customizing_your_Google_Map_Component">Customizing your Google Map Component</h2>
The Google Map Component was designed for several different use cases:<br />
<ul><li>A map around a fixed geographic point specified either by Latitude and Longitude or by Address
</li><li>A map displaying a number of fixed geographic points
</li><li>A map that allows the user to specify and display the center and radius for a search
</li><li>A map that allows the user to specify and display the points defining a polygon for a search
</li><li>A map that allows the user to specify and display a search and then see the results of the search
</li></ul>Each of these use cases requires slightly different controls, which is why the Toobar HTML is exposed as a property. The different controls require slightly different processing, which is why the sample Xbasic Ajax callback handler function <strong>TakeLatLng </strong>has been supplied in user-modifiable form, and the JavaScript helper function <strong>computePostValues </strong>has been supplied to return all the user-supplied markers, the radius, and the states of the circle, marker, and polygon display for the Ajax callback.<br />
<br />
As you have seen, we have already supplied the customization of the Google Map Component for most of these use cases, in conjunction with a Grid. You are, however, free to create your own customizations by using the exposed events, methods and properties, both on the client side and the server side.<br />
<h2 class="showhide_heading" id="Google_Map_Component_Action_JavaScript_actions">Google Map Component Action JavaScript actions</h2>
<ul><li>Clear all markers
</li><li>Add marker(s) to the map
</li><li>Close all infoboxes
</li><li>Open an infobox
</li><li>Center map on an address
</li><li>Set map zoom level
</li><li>Show a marker layer
</li><li>Hide a marker layer
</li><li>Bounce markers on a layer
</li><li>Bounce a marker
</li></ul><h2 class="showhide_heading" id="Google_Map_Component_Xbasic_Arguments_and_Properties">Google Map Component Xbasic Arguments and Properties</h2>
<ul><li>Arguments
</li></ul><table class="normal" id="fancytable_3">			<tr>			<td class="odd"><strong>Name</strong> </td>			<td class="odd"><strong>DataType</strong> </td>			<td class="odd"><strong>Default Value</strong></td>		</tr>		<tr>			<td class="even">CenterLat</td>			<td class="even">Numeric</td>			<td class="even">0.0</td>		</tr>		<tr>			<td class="odd">CenterLng</td>			<td class="odd">Numeric</td>			<td class="odd">0.0</td>		</tr>		<tr>			<td class="even">CenterAddress</td>			<td class="even">Character</td>			<td class="even">""</td>		</tr>		<tr>			<td class="odd">Titles</td>			<td class="odd">Character</td>			<td class="odd">""</td>		</tr>		<tr>			<td class="even">InfoText</td>			<td class="even">Character</td>			<td class="even">""</td>		</tr>		<tr>			<td class="odd">DivName</td>			<td class="odd">Character</td>			<td class="odd">"map_canvas"</td>		</tr></table><br />
<ul><li>Properties
</li></ul><div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox2" ><span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">DivName</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;map_canvas&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">CenterLat</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">CenterLng</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">markInitialPosition</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">showMarkers</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">showPolygon</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">DivWidth</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;400px&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">DivHeight</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;500px&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">radius</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">1609</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">maxMarkers</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">4</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">reinitOnGeocode</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">zoom</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">13</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">Titles</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0600FF;">InfoText</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">showCircle</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">F</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">isDraggable</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">isInitialDraggable</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">F</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">CenterAddress</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">MapTypeId</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;ROADMAP&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">usePremier</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">F</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">clientID</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">useSSL</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">F</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">useSensor</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .<span style="color: #0000FF;">F</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">markerPropertyArray</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #FF8000;">as</span> P <span style="color: #008080; font-style: italic;">'see below for properties</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">markerPropertyArrayString</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span> 
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">autoScaleToBulkMarkers</span> <span style="color: #FF8000;">as</span> L <span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">bulkMarkerClickAction</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;null&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">CircleColor</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;#00FF00&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">PolygonColor</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;#FF0000&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">GeocodeDelay</span> <span style="color: #FF8000;">as</span> N <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">GeocodeMethod</span> <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;nominatum&quot;</span> <span style="color: #008080; font-style: italic;">'could also be &quot;Google&quot;</span>
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">GoogleMapsSrc</span> <span style="color: #FF8000;">as</span> C
<span style="color: #0600FF;">dim</span> tmpl.<span style="color: #0000FF;">HtmlToolbar</span> <span style="color: #FF8000;">as</span> C
&nbsp;
<span style="color: #008080; font-style: italic;">'tmpl.markerPropertyArray Properties:</span>
    <span style="color: #0600FF;">dim</span> title <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> <span style="color: #0600FF;">infotext</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> type <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> icon <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> layer <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> animation <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span>
    <span style="color: #0600FF;">dim</span> duration <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span>
    <span style="color: #0600FF;">dim</span> callback <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;&quot;</span>
    <span style="color: #0600FF;">dim</span> circleObj <span style="color: #FF8000;">as</span> p 
&nbsp;
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">radius</span> <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">0</span> 
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">strokeColor</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;#00FF00&quot;</span>
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">strokeOpacity</span> <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .8
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">strokeWeight</span> <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #FF0000;">2</span>
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">fillColor</span> <span style="color: #FF8000;">as</span> c <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> <span style="color: #808080;">&quot;#00FF00&quot;</span>
    <span style="color: #0600FF;">dim</span> circleObj.<span style="color: #0000FF;">fillOpacity</span> <span style="color: #FF8000;">as</span> n <span style="color: #008000;">=</span> <span style="color: #0600FF;">default</span> .35</pre></div><br />
<h2 class="showhide_heading" id="Google_Map_Component_JavaScript_Properties_and_Methods">Google Map Component JavaScript Properties and Methods</h2>
<ul><li>Properties (all belong to componentName)
</li></ul><div class="plugincode" parse="javascript"><pre class="codelisting" data-syntax="javascript" dir="ltr" style="overflow:auto;" id="codebox3" >.<span style="color: #660066;">markersArray</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">markersArray2</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">infoWindowsArray</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">layersArray</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">circlesArray</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">geocoder</span><span style="color: #339933;">;</span> <span style="color: #006600; font-style: italic;">//only used for google geocoder</span>
.<span style="color: #660066;">map</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">marker</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">myPoly</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">showMarkers</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>showMarkers<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">showPolygon</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>showPolygon<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">markInitialPosition</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>markInitialPosition<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">myRadius</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;{radius}&quot;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">maxMarkers</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>maxMarkers<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">reinitOnGeocode</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>reinitOnGeocode<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">titles</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #3366CC;">&quot;{Titles}&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">InfoText</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #3366CC;">&quot;{InfoText}&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">myCircle</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">showCircle</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>showCircle<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">isDraggable</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>isDraggable<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">isInitialDraggable</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>isInitialDraggable<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">bulkMarkersArray</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#91;</span><span style="color: #009900;">&#123;</span>bulkMarkersArray<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">autoScaleToBulkMarkers</span> <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>autoScaleToBulkMarkers<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">minLat</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">maxLat</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">minLng</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">maxLng</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">bulkMarkerClickAction</span><span style="color: #339933;">=</span><span style="color: #009900;">&#123;</span>bulkMarkerClickAction<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">GeocodeDelay</span><span style="color: #339933;">=</span><span style="color: #009900;">&#123;</span>GeocodeDelay<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">GeocodeMethod</span><span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;{GeocodeMethod}&quot;</span><span style="color: #339933;">;</span>
.<span style="color: #660066;">GoogleMapsSrc</span><span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;{GoogleMapsSrc}&quot;</span><span style="color: #339933;">;</span></pre></div><br />
<ul><li>Methods (all belong to componentName)
</li></ul><div class="plugincode" parse="javascript"><pre class="codelisting" data-syntax="javascript" dir="ltr" style="overflow:auto;" id="codebox4" ><span style="color: #006600; font-style: italic;">//This function is called from the OnInitializeComplete client-side event</span>
<span style="color: #006600; font-style: italic;">//Dynamically load Google Maps API JavaScript, put it at the end of the page</span>
<span style="color: #006600; font-style: italic;">//It will run when the rest of the page has been processed, and</span>
<span style="color: #006600; font-style: italic;">// call back to .initializeGoogleMap()</span>
.<span style="color: #660066;">loadScript</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//callback from Google Maps startup</span>
<span style="color: #006600; font-style: italic;">//Geocode or otherwise set the initial map center, </span>
<span style="color: #006600; font-style: italic;">// then chain to initialize2</span>
.<span style="color: #660066;">initializeGoogleMap</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Try to Geocode the supplied address, then chain to initialize2</span>
.<span style="color: #660066;">encodeAddress</span><span style="color: #009900;">&#40;</span>address<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//This function is chained from initialize or encodeAddress</span>
<span style="color: #006600; font-style: italic;">//Set map options, create map object, add map click listener,</span>
<span style="color: #006600; font-style: italic;">// mark initial position if wanted, and create bulk loaded markers</span>
.<span style="color: #660066;">initialize2</span><span style="color: #009900;">&#40;</span>myLatLng<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//addBulkMarkersCallback: add contents of markerArray argument to bulk markers</span>
<span style="color: #006600; font-style: italic;">//  API exposed for use by Ajax callbacks; called by initialize2</span>
.<span style="color: #660066;">addBulkMarkersCallback</span><span style="color: #009900;">&#40;</span>markerArray<span style="color: #339933;">,</span> fClearAllMarkers<span style="color: #339933;">,</span> fClearBulkMarkers<span style="color: #339933;">,</span>
    fRecenterMapNew<span style="color: #339933;">,</span> fRecenterMapAll<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//doGeocode: address into LatLng, if we can</span>
<span style="color: #006600; font-style: italic;">// Note that geocoding is asynchronous</span>
.<span style="color: #660066;">doGeocode</span><span style="color: #009900;">&#40;</span>address<span style="color: #339933;">,</span> title<span style="color: #339933;">,</span> infotext<span style="color: #339933;">,</span> icon<span style="color: #339933;">,</span> rowNumber<span style="color: #339933;">,</span> layer<span style="color: #339933;">,</span> animation<span style="color: #339933;">,</span>
    duration<span style="color: #339933;">,</span> callback<span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>opt<span style="color: #009900;">&#41;</span>circleObj<span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">doGeocode2</span><span style="color: #009900;">&#40;</span>address<span style="color: #339933;">,</span> canDrag<span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">openInfoWindow</span><span style="color: #009900;">&#40;</span>index<span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">//index is Xbasic 1-based row number</span>
&nbsp;
.<span style="color: #660066;">addBulkMarker2</span><span style="color: #009900;">&#40;</span>lat<span style="color: #339933;">,</span> lng<span style="color: #339933;">,</span> title<span style="color: #339933;">,</span> infotext<span style="color: #339933;">,</span> icon<span style="color: #339933;">,</span> rowNumber<span style="color: #339933;">,</span> layer<span style="color: #339933;">,</span> animation<span style="color: #339933;">,</span>
    duration<span style="color: #339933;">,</span> callback<span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>opt<span style="color: #009900;">&#41;</span>circleObj<span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #006600; font-style: italic;">//addBulkMarker: Add the LatLng marker, with infotext, title, icon, layer,</span>
<span style="color: #006600; font-style: italic;">// animation, duration, callback, and optionally a circle</span>
<span style="color: #006600; font-style: italic;">// Also update bounds</span>
<span style="color: #006600; font-style: italic;">//rowNumber can be used by a defined bulkMarkerClickAction</span>
.<span style="color: #660066;">addBulkMarker</span><span style="color: #009900;">&#40;</span>latlng<span style="color: #339933;">,</span> title<span style="color: #339933;">,</span> infotext<span style="color: #339933;">,</span> icon<span style="color: #339933;">,</span> rowNumber<span style="color: #339933;">,</span> layer<span style="color: #339933;">,</span> animation<span style="color: #339933;">,</span>
  duration<span style="color: #339933;">,</span> callback<span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>opt<span style="color: #009900;">&#41;</span>circleObj<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//reset map bounds to fit all markers if wanted</span>
.<span style="color: #660066;">autoScaleMap</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">addMarker2</span><span style="color: #009900;">&#40;</span>lat<span style="color: #339933;">,</span> lng<span style="color: #339933;">,</span> canDrag<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Add a marker to the map with a title and InfoText box</span>
<span style="color: #006600; font-style: italic;">//Add a listener for marker drag events</span>
<span style="color: #006600; font-style: italic;">//Show updated polygon if wanted</span>
<span style="color: #006600; font-style: italic;">//Show circle for the first marker if wanted</span>
.<span style="color: #660066;">addMarker</span><span style="color: #009900;">&#40;</span>location<span style="color: #339933;">,</span> canDrag<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Attach an InfoText ballon to a specified marker</span>
<span style="color: #006600; font-style: italic;">//Add a listener to the marker to show the InfoText</span>
.<span style="color: #660066;">attachInfoText</span><span style="color: #009900;">&#40;</span>marker<span style="color: #339933;">,</span> num<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Geocode the address in the address input box or optional address argument</span>
<span style="color: #006600; font-style: italic;">//If successful, make this the new map center, reinitialize</span>
<span style="color: #006600; font-style: italic;">// the markers, and add this as a new first marker</span>
.<span style="color: #660066;">encodeAddressField</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>opt<span style="color: #009900;">&#41;</span>address<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Hide bulk markers in a given layer</span>
.<span style="color: #660066;">hideLayer</span><span style="color: #009900;">&#40;</span>layer<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Show bulk markers in a given layer</span>
.<span style="color: #660066;">showLayer</span><span style="color: #009900;">&#40;</span>layer<span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">bounceLayer</span><span style="color: #009900;">&#40;</span>layer<span style="color: #339933;">,</span> seconds<span style="color: #339933;">,</span> action<span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">bounceBulkMarker</span><span style="color: #009900;">&#40;</span>index<span style="color: #339933;">,</span> seconds<span style="color: #339933;">,</span> action<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Remove the markers from the map, but keep them in the array</span>
.<span style="color: #660066;">clearOverlays</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Show any markers currently in the array</span>
.<span style="color: #660066;">showOverlays</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Turn marker displays on or off</span>
.<span style="color: #660066;">toggleMarkers</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
.<span style="color: #660066;">deleteBulkMarkers</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Delete all markers in the arrays</span>
<span style="color: #006600; font-style: italic;">//also calls .deleteBulkMarkers()</span>
.<span style="color: #660066;">deleteOverlays</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
&nbsp;
<span style="color: #006600; font-style: italic;">//Create and show the polygon defined by the markers</span>
.<span style="color: #660066;">showPoly</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Hide the polygon</span>
.<span style="color: #660066;">clearPoly</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Turn the polygon display on or off</span>
.<span style="color: #660066;">togglePoly</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Show a circle on the map around the center point if wanted</span>
<span style="color: #006600; font-style: italic;">//Fit the map to the bounding box of the circle</span>
.<span style="color: #660066;">setRadius</span><span style="color: #009900;">&#40;</span>value<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Create a URL-encoded string containing the values to post back to the server</span>
.<span style="color: #660066;">computePostValues</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Perform an Ajax callback to the Xbasic function 'TakeLatLng'</span>
<span style="color: #006600; font-style: italic;">// using computePostValues() to do the heavy lifting</span>
.<span style="color: #660066;">SubmitLatLng</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">//Ajax callback to do Geocoding</span>
.<span style="color: #660066;">geoCodeCallback</span><span style="color: #009900;">&#40;</span>arg<span style="color: #339933;">,</span> callback<span style="color: #009900;">&#41;</span></pre></div><br />
<h2 class="showhide_heading" id="Videos">Videos</h2>
<ul><li>Map Alternate View Videos
</li></ul>See <a href="../Web Grid Enhancements V11/Web Grid Alternate Views V11/Google Map Alternate View V11.html" title="Google Map Alternate View V11" class="wiki">Google Map Alternate View V11</a><br />
<ul><li>Geography Search Videos
</li></ul><a class="wiki external" target="_blank" href="http://www.ajaxvideotutorials.com/V11Videos/GeographySearches_Part1.swf" rel="external nofollow">Watch Video - Part 1</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<a class="wiki external" target="_blank" href="http://www.ajaxvideotutorials.com/V11Videos/GeographySearches_Part2.swf" rel="external nofollow">Watch Video - Part 2</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="../Geographic Databases V11/How to bulk geocode addresses in a database V11.html" title="How to bulk geocode addresses in a database V11" class="wiki">How to bulk geocode addresses in a database V11</a><br />
<a href="../Geographic Databases V11.html" title="Geographic Databases V11" class="wiki">Geographic Databases V11</a><br />
<a href="../Web Grid Enhancements V11/Web Grid Alternate Views V11.html" title="Web Grid Alternate Views V11" class="wiki">Web Grid Alternate Views V11</a><br />
<a href="../Web Grid Enhancements V11/Web Grid Geographical Search V11.html" title="Web Grid Geographical Search V11" class="wiki">Web Grid Geographical Search V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Google+Map+Component+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"/Guides"} --->
</body></html>