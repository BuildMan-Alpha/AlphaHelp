	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Office_Example:_Spreadsheet_from_DBF_tables">Office Example: Spreadsheet from DBF tables</h1>
This example creates a workbook with three sheets from DBF tables using AlphaSports. After the spreadsheet is populated, it is opened in Microsoft Excel.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #0600FF;">dim</span> DocumentFile <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;C:\temp\A5OfficeSample4.xlsx&quot;</span>
<span style="color: #0600FF;">dim</span> Doc  <span style="color: #FF8000;">as</span> Office::ExcelDocument <span style="color: #008080; font-style: italic;">' Declare the document variable</span>
&nbsp;
CreateWorkbook<span style="color: #000000;">&#40;</span>Doc<span style="color: #000000;">&#41;</span> <span style="color: #008080; font-style: italic;">'load all tables into sheets</span>
&nbsp;
Path <span style="color: #008000;">=</span> <a target="_blank" href="http://www.google.com/search?q=FILE+site:msdn.microsoft.com"><span style="color: #008000;">file</span></a>.<span style="color: #0000FF;">filename_parse</span><span style="color: #000000;">&#40;</span>DocumentFile, <span style="color: #808080;">&quot;P&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #FF8000;">on</span> <span style="color: #FF8000;">error</span> <span style="color: #FF8000;">resume</span> <span style="color: #FF8000;">next</span>
<a target="_blank" href="http://www.google.com/search?q=FILE+site:msdn.microsoft.com"><span style="color: #008000;">File</span></a>.<span style="color: #0000FF;">Dir_Create</span><span style="color: #000000;">&#40;</span>Path<span style="color: #000000;">&#41;</span>
<span style="color: #FF8000;">on</span> <span style="color: #FF8000;">error</span> goto <span style="color: #FF0000;">0</span>
<span style="color: #0600FF;">if</span> Doc.<span style="color: #0000FF;">Save</span><span style="color: #000000;">&#40;</span>DocumentFile<span style="color: #000000;">&#41;</span>
<span style="color: #008080; font-style: italic;">'Release all references to the document because we are about to open it in Excel</span>
  delete Doc
  sys_open<span style="color: #000000;">&#40;</span>DocumentFile<span style="color: #000000;">&#41;</span>
<span style="color: #FF8000;">else</span>  
  ui_msg_box<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Error Saving Document&quot;</span>, <span style="color: #808080;">&quot;Unable to save document to &quot;</span> <span style="color: #008000;">\</span>
                  <span style="color: #008000;">+</span> DocumentFile <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;:&quot;</span> <span style="color: #008000;">+</span> <span style="color: #0600FF;">crlf</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> Doc.<span style="color: #0000FF;">ErrorMessage</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">end</span> <span style="color: #0600FF;">if</span>  
&nbsp;
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> CreateWorkbook <span style="color: #FF8000;">as</span> V<span style="color: #000000;">&#40;</span>Doc <span style="color: #FF8000;">as</span> Office::ExcelDocument<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">dim</span> Sheet <span style="color: #FF8000;">as</span> Office::Spreadsheet <span style="color: #008080; font-style: italic;">' Pointer to the spreadsheet</span>
<span style="color: #0600FF;">dim</span> Path <span style="color: #FF8000;">as</span> C <span style="color: #008000;">=</span> A5.<span style="color: #0000FF;">Get_Exe_Path</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;\Samples\AlphaSports\\&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">' Load the tables</span>
LoadTable<span style="color: #000000;">&#40;</span>Doc, Sheet, Path, <span style="color: #808080;">&quot;SalesPeople&quot;</span><span style="color: #000000;">&#41;</span>
LoadTable<span style="color: #000000;">&#40;</span>Doc, Sheet, Path, <span style="color: #808080;">&quot;Product&quot;</span><span style="color: #000000;">&#41;</span>
LoadTable<span style="color: #000000;">&#40;</span>Doc, Sheet, Path, <span style="color: #808080;">&quot;Customer&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>        
&nbsp;
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> LoadTable <span style="color: #FF8000;">as</span> L <span style="color: #000000;">&#40;</span>Doc <span style="color: #FF8000;">as</span> Office::ExcelDocument, <span style="color: #008000;">\</span>
                        <span style="color: #FF8000;">BYREF</span> Sheet <span style="color: #FF8000;">as</span> Office::Spreadsheet,<span style="color: #008000;">\</span>
                        Path <span style="color: #FF8000;">as</span> C, TableName <span style="color: #FF8000;">as</span> C<span style="color: #000000;">&#41;</span>
<span style="color: #FF8000;">on</span> <span style="color: #FF8000;">error</span> goto noload  
&nbsp;
t <span style="color: #008000;">=</span> table.<span style="color: #0600FF;">open</span><span style="color: #000000;">&#40;</span>Path <span style="color: #008000;">+</span> TableName <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;.DBF&quot;</span><span style="color: #000000;">&#41;</span>
Sheet <span style="color: #008000;">=</span> Doc.<span style="color: #0000FF;">AddSheetFromDBF</span><span style="color: #000000;">&#40;</span>t, TableName<span style="color: #000000;">&#41;</span>
&nbsp;
noload:
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span></pre></div><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="../Generate Excel Spreadsheets Programmatically V11.html" title="Generate Excel Spreadsheets Programmatically V11" class="wiki">Generate Excel Spreadsheets Programmatically V11</a><br />
<a href="Office__NAMESPACE__ExcelDocument.html" title="Office::ExcelDocument" class="wiki">Office::ExcelDocument</a><br />
<a href="Office__NAMESPACE__Excel2003Document.html" title="Office::Excel2003Document" class="wiki">Office::Excel2003Document</a><br />
<a href="Office__NAMESPACE__Spreadsheet.html" title="Office::Spreadsheet" class="wiki">Office::SpreadSheet</a><br />
<a href="Office__NAMESPACE__Format.html" title="Office::Format" class="wiki">Office::Format</a><br />
<a href="Office__NAMESPACE__Font.html" title="Office::Font" class="wiki">Office::Font</a><br />
<a href="Office Enumerations.html" title="Office Enumerations" class="wiki">Office Enumerations</a><br />
<a href="How to perform common spreadsheet operations.html" title="How to perform common spreadsheet operations" class="wiki">How to perform common spreadsheet operations</a><br />
<a href="Office Example__COLON__ Hello, World spreadsheet.html" title="Office Example: Hello, World spreadsheet" class="wiki">Office Example: Hello, World Spreadsheet</a><br />
<a href="Office Example__COLON__ Simple Weekly sales spreadsheet.html" title="Office Example: Simple Weekly sales spreadsheet" class="wiki">Office Example: Simple Weekly sales spreadsheet</a><br />
<a href="Office Example__COLON__ Multiple spreadsheets.html" title="Office Example: Multiple spreadsheets" class="wiki">Office Example: Multiple Spreadsheets</a><br />
<a href="Office Example__COLON__ Spreadsheet from SQL query.html" title="Office Example: Spreadsheet from SQL query" class="wiki">Office Example: Spreadsheet from SQL query</a><br />
<a href="Office Example__COLON__ Spreadsheet with picture.html" title="Office Example: Spreadsheet with picture" class="wiki">Office Example: Spreadsheet with picture</a><br />
<a href="Office Example__COLON__ Update a spreadsheet.html" title="Office Example: Update a spreadsheet" class="wiki">Office Example: Update a spreadsheet</a><br />
<a href="../../../Unclassified/SQL Example__COLON__ Spreadsheets from SQL schema.html" title="SQL Example: Spreadsheets from SQL schema" class="wiki">SQL Example: Spreadsheets from SQL schema</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Office+Example%3A+Spreadsheet+from+DBF+tables">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop, dbf"} --->
</body></html>