	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="SQL::Arguments_Object_-_Array">SQL::Arguments Object - Array</h1>
The SQL::Arguments object now supports arrays. This is a very powerful addition because it makes support for parameterized SQL queries that contain the IN keyword possible. See example below.<br />
<br />
To set a SQL::Argument value to an array, you simply create an Xbasic array and then set the argument value to the array, as shown in the following interactive window session.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox" >'create an Xbasic array with 3 elements
dim a[3] as c
a[1] = "Boston"
a[2] = "London"
a[3] = "Berlin"

dim args as sql::arguments 
args.add("whatcity",a)
 
'View the XML property of the SQL::arguments object
?args.xml 
= &lt;SQLArguments&gt;
    &lt;SQLArgument&gt;
        &lt;Name&gt;whatcity&lt;/Name&gt;
        &lt;Data Type="C[]"&gt;
            &lt;Item Type="C"&gt;Boston&lt;/Item&gt;
            &lt;Item Type="C"&gt;London&lt;/Item&gt;
            &lt;Item Type="C"&gt;Berlin&lt;/Item&gt;
        &lt;/Data&gt;
        &lt;IsNull Type="L"&gt;0&lt;/IsNull&gt;
        &lt;Usage&gt;Input&lt;/Usage&gt;
    &lt;/SQLArgument&gt;
&lt;/SQLArguments&gt;

 
'read the first argument into an Xbasic array
dim aa as p
aa = args[1].data
?aa[1]
= "Boston"
 
'find the data type of the first argument. a type of 'P' indicates that the argument is an array
?typeof(args[1].data)
= "P"
 
 
'find the data type of the array
?typeof(args[1].data[1])
= "C"
 
 
'add a new element to the array.
dim myarr as p
myarr = args[1].data
myarr[] = "Santiago"
args[1].data = myarr</pre></div><br />
<br />
In this next example, we show how you can use array arguments in a SQL statement that uses the IN keyword.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox1" >dim cities[0] as c
cities[] = "London"
cities[] = "Madrid"
cities[] = "Paris"
 
dim cn as sql::connection
cn.open("::Name::Northwind")
dim sql as c
sql = "select customerId,city from customers where city in (:cities)"
 
dim args as sql::arguments
args.add("cities",cities)
 
?cn.execute(sql,args)
= .t.
?cn.resultset.toString()
= AROUT London
BSBEV London
CONSH London
EASTC London
NORTS London
SEVES London
BOLID Madrid
FISSA Madrid
ROMEY Madrid
PARIS Paris
SPECD Paris</pre></div><br />
<h2 class="showhide_heading" id="See_also">See also</h2>
<a href="../../../References/Objects/SQL Arguments Object.html" title="SQL Arguments Object" class="wiki">SQL Arguments Object</a><br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL%3A%3AArguments+Object+Array+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Guides","status":"pending"} --->
</body></html>