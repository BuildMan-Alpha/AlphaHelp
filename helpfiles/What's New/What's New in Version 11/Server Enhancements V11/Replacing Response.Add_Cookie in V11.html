	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Replacing_Response.Add_Cookie_in_V11">Replacing Response.Add_Cookie() in V11</h1>
<br />
Response.Add_Cookie() was marked as deprecated in the V10 release and has been removed in V11. Any code which attempts to use this method will generate an error and must be updated.<br />
<br />
Sending cookies at part of the Response from V11 forward is done using the Response.Cookies property. Response.Cookies is a .Net <a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/system.web.httpcookiecollection.aspx" rel="external nofollow">System::Web::CookieCollection</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />, and it is functionally equivalent to <a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/system.web.httpresponse.cookies.aspx" rel="external nofollow">ASP.Net's Response.Cookies property</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />.<br />
<br />
Adding a cookie to the Response.Cookies HttpCookieCollection object is done using either the Add or Set method, both of which take a .Net System::Web::HttpCookie as their only argument.<br />
<ul><li>The Add method adds a cookie without checking to see if it already exists in the collection. The Add allows duplicate cookies in the cookie collection.
</li><li>The Set method first checks to see if a cookie already exists in the collection and if so updates it. The Set method does not allow duplicate cookies in the cookie collection.
</li></ul><br />
Because these methods take an actual object and add it to the Response.Cookies collection, the Xbasic programmer must create the object and then add it.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" ><span style="color: #008080; font-style: italic;">'first create a new cookie</span>
<span style="color: #0600FF;">dim</span> NewCookie <span style="color: #FF8000;">as</span> System::Web::HttpCookie <span style="color: #008000;">=</span> <span style="color: #FF8000;">new</span> System::Web::HttpCookie<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Cookie1&quot;</span>, <span style="color: #808080;">&quot;Cookie1's data&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008080; font-style: italic;">'now add/set the cookie</span>
Response.<span style="color: #0000FF;">Cookies</span>.<span style="color: #FF8000;">Set</span><span style="color: #000000;">&#40;</span>NewCookie<span style="color: #000000;">&#41;</span></pre></div><br />
<br />
When adding a simple cookie such as this, the code can be consolidated into a single line of code.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" ><span style="color: #008080; font-style: italic;">'add/set a simple cookie</span>
Response.<span style="color: #0000FF;">Cookies</span>.<span style="color: #FF8000;">Set</span><span style="color: #000000;">&#40;</span><span style="color: #FF8000;">new</span> System::Web::HttpCookie<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Cookie1&quot;</span>, <span style="color: #808080;">&quot;This is the data in Cookie1&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span></pre></div><br />
<br />
However, it is not possible to set any other properties of the cookie with this abbreviated syntax. If there is a need to set the path, lifetime, Secure flag, HttpOnly flag or any other property, the longer syntax is required.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox2" ><span style="color: #008080; font-style: italic;">'create the new cookie</span>
<span style="color: #0600FF;">dim</span> NewCookie <span style="color: #FF8000;">as</span> System::Web::HttpCookie <span style="color: #008000;">=</span> <span style="color: #FF8000;">new</span> System::Web::HttpCookie<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Cookie2&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008080; font-style: italic;">'set the value (data to be stored in the cookie</span>
NewCookie.<span style="color: #0000FF;">Value</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;This is the data in my Cookie2&quot;</span>
. <span style="color: #0000FF;">make</span> this an <span style="color: #808080;">&quot;HTTP-Only&quot;</span> cookie
NewCookie.<span style="color: #0000FF;">HttpOnly</span> <span style="color: #008000;">=</span> .<span style="color: #0000FF;">t</span>.
<span style="color: #008080; font-style: italic;">'restrict the cookie to the &quot;/MyApplication&quot; path</span>
NewCookie.<span style="color: #0000FF;">Path</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;/MyApplication&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'finally, add/set the cookie</span>
Response.<span style="color: #0000FF;">Cookies</span>.<span style="color: #0000FF;">Add</span><span style="color: #000000;">&#40;</span>NewCookie<span style="color: #000000;">&#41;</span></pre></div><br />
<br />
<div class="clearfix rbox tip"><img src="images/close.png" alt="Close" width="16" height="16" class="rbox-close" onclick="$(this).parent().fadeOut();" title="Close" /><div class="rbox-title"><img src="images/book_open.png" alt="tip" width="16" height="16" title="tip" class="icon" /><span>Additional Documentation</span></div><div class="rbox-data">Complete documentation of the ASP.Net HttpResponse.Cookies property is at <a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/system.web.httpresponse.cookies.aspx" rel="external nofollow">http://msdn.microsoft.com/en-us/library/system.web.httpresponse.cookies.aspx</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br /><br />Complete documentation of System::Web::HttpCookieCollection is at <a target="_blank" class="wiki external"  href="http://msdn.microsoft.com/en-us/library/system.web.httpcookiecollection.aspx">http://msdn.microsoft.com/en-us/library/system.web.httpcookiecollection.aspx<img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /></a><br /><br />Complete documentation of System::Web::HttpCookie is at <a target="_blank" class="wiki external"  href="http://msdn.microsoft.com/en-us/library/system.web.httpcookie.aspx">http://msdn.microsoft.com/en-us/library/system.web.httpcookie.aspx<img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /></a><br />
</div></div><br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Replacing+Response.Add_Cookie+in+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>