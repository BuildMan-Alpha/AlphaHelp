	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Building Connection Strings</p>

<p class=A5>Example</p>

<p>Load a default value for the connection string.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim lv&nbsp;as&nbsp;P</p>

<p class=Code>dim mode&nbsp;as&nbsp;C</p>

<p class=Code>dim indx&nbsp;as&nbsp;N</p>

<p class=Code>dim con_name&nbsp;as&nbsp;C</p>

<p class=Code>dim con_string&nbsp;as&nbsp;C</p>

<p class=Code>dim current_con_name&nbsp;as&nbsp;C</p>

<p class=Code>dim current_con_string&nbsp;as&nbsp;C</p>

<p class=Code>dim flagEdit&nbsp;as&nbsp;L</p>

<p class=Code>dim con_filename&nbsp;as&nbsp;C</p>

<p class=Code>dim txt&nbsp;as&nbsp;C</p>

<p class=Code>dim a&nbsp;as&nbsp;P</p>

<p class=Code>lv = local_variables()</p>

<p class=Code>indx = 1</p>

<p class=Code>if (a5_is_path_valid(a5.Get_Exe_Path()+ chr(92) + "Learning Xdialog") = .f.) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dir_create_recurse(a5.Get_Exe_Path() + chr(92) + "Learning Xdialog")</p>

<p class=Code>end if</p>

<p class=Code>con_filename = a5.Get_Exe_Path()+ chr(92) + "Learning Xdialog\connections.txt"</p>

<p class=Code>if file.exists(con_filename) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;txt = get_from_file(con_filename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;property_from_string(a, txt)</p>

<p class=Code>else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim a.a_con[1]&nbsp;as&nbsp;P</p>

<p class=Code>end if</td> </tr> </table><p>Display the Define Connections dialog box.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_dlg_box("Define Connections",&lt&lt%dlg%</p>

<p class=Code>{startup=init}</p>

<p class=Code>{font=tahoma,8}</p>

<p class=Code>{'%O={F=Tahoma,12,B}{C=Blue Gray}Connections:%};</p>

<p class=Code>{region0}</p>

<p class=Code>{region}</p>

<p class=Code>{lf};</p>

<p class=Code>[.40,15indx^#a.a_con[[\].description!indx_changed];</p>

<p class=Code>{endregion}|{sp}|</p>

<p class=Code>{frame=1,1:Connection String}</p>

<p class=Code>{region}</p>

<p class=Code>{text=50,15:current_con_string};</p>

<p class=Code>{endregion};</p>

<p class=Code>;</p>

<p class=Code>{endregion0};</p>

<p class=Code>&ltClose> &ltNew> &ltEdit?flagEdit> &ltDelete?flagEdit>{sp=34}&ltCopy>;</p>

<p class=Code>%dlg%,&lt&lt%code%</td> </tr> </table><p>Add the event handlers for the various buttons on the dialog box.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if a_dlg_button = "copy" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ClipBoard.Set_Data(current_con_string)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "delete" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a.a_con.delete(indx,1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (indx > a.a_con.first_empty() - 1) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indx = indx - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_info(lv)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;save(lv)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "init" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_info(lv)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "new" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;mode = "New"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new_connection(lv)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "edit" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;mode = "Edit"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new_connection(lv)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "indx_changed" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_info(lv)</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>Add the function that retrieves the name and connection string for the selected profile.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function get_info&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("a.a_con[" + indx + "].name") = .f. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_con_name = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_con_string = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flagEdit = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit function</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flagEdit = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;current_con_name = a.a_con[indx].name</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;current_con_string = a.a_con[indx].connection_string</p>

<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table><p>Add the function that displays the New Connection dialog box.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function new_connection&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>

<p class=Code>dim flag_ok&nbsp;as&nbsp;L</p>

<p class=Code>dim dlg_title&nbsp;as&nbsp;C</p>

<p class=Code>with vars</p>

<p class=Code>flag_ok = .f.</p>

<p class=Code>if mode = "New" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dlg_title = "New Connection"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;conn_name = "Connection"+ a.a_con.first_empty()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;conn_string = ""</p>

<p class=Code>else if mode = "edit" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dlg_title = "Edit Connection"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;conn_name = current_con_name</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;conn_string = current_con_string</p>

<p class=Code>end if</p>

<p class=Code>ui_dlg_box(dlg_title,&lt&lt%dlg%</p>

<p class=Code>{font=tahoma,8}</p>

<p class=Code>{on_key=enter}</p>

<p class=Code>Connection Name: ;</p>

<p class=Code>[.80conn_name];</p>

<p class=Code>{lf};</p>

<p class=Code>Connection String:;</p>

<p class=Code>[.80conn_string] &ltBuild>;</p>

<p class=Code>{lf};</p>

<p class=Code>{line=1,0};</p>

<p class=Code>&lt10&OK!ok?.not.(conn_string="".or.conn_name="")> &lt10&Cancel>;</p>

<p class=Code>%dlg%,&lt&lt%code%</td> </tr> </table><p>Add the event handlers for the buttons.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if (a_dlg_button = "build") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim new_conn_string&nbsp;as&nbsp;C</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new_conn_string = a5_connectionString(conn_string)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if new_conn_string &lt> "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn_string = new_conn_string</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "enter") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (conn_string="".or.conn_name="") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error","You have not defined the name, or the connection string.")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "ok") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>end if</p>

<p class=Code>%code%)</p>

<p class=Code>if (flag_ok = .t.) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim next_slot&nbsp;as&nbsp;N</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if mode = "new" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_slot = a.a_con.first_empty()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if next_slot > a.a_con.size()then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.a_con.insert(next_slot,1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next_slot = indx</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a.a_con[next_slot].name = conn_name</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a.a_con[next_slot].connection_string = conn_string</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a.a_con[next_slot].description = conn_name</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;indx = next_slot</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;save(lv)</p>

<p class=Code>end if</p>

<p class=Code>get_info(lv)</p>

<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table><p>Add the function that saves a connection string.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function save&nbsp;as&nbsp;C (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim txt&nbsp;as&nbsp;C</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;txt = property_to_string(a)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;save_to_file(txt,con_filename)</p>

<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table><p class=A5>Next</p>

<p> <a href="../ActiveX Examples/XY Graph.html" title="XY Graph" class="wiki">XY Graph</a></p>

<p class=A5>See Also</p>

<p> <a href="../ADO Examples.html" title="ADO Examples" class="wiki">ADO Examples</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 6 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Building+Connection+Strings">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>