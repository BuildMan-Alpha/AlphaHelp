	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Conditionally Displaying Panes on a Tab Control</p>

<p>The panes in a tab control can be turned on and off, depending on whether a condition is true.</p>

<p>To conditionally show a pane in a tab control, use the following syntax for the tab control:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{tab=variable_name!event_name}</p>

<p class=Code>{pane=Pane1 Description?condition1}</td> </tr> </table><p>Xdialog code for first page of tab control</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{pane=Pane2 Description?condition2}</td> </tr> </table><p>Xdialog code for second page of tab control</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{pane=Pane'n' Description?condition'n'}</td> </tr> </table><p>Xdialog code for 'N'th page of tab control</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{endtab}</td> </tr> </table><p>For example, the following script displays a dialog with a tab control. If the user checks the 'Different shipping address?' check box, then a new tab, called 'Shipping' is displayed. When the user clicks on a different tab, a ui_msg_box()pops up, demonstrating how the tab change event can be trapped.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim a_card_type[100]&nbsp;as&nbsp;C</p>

<p class=Code>dim a_expire_month[12]&nbsp;as&nbsp;C</p>

<p class=Code>x = "American Express,Visa,Master Card,Discover"</p>

<p class=Code>a_card_type.initialize( stritran(x,",",crlf() ) )</p>

<p class=Code>x = "01,02,03,04,05,06,07,08,09,10,11,12"</p>

<p class=Code>a_expire_month.initialize( stritran(x,",",crlf() ) )</p>

<p class=Code>dim a_expire_year[10]&nbsp;as&nbsp;C</p>

<p class=Code>x = "2000,2001,2002,2003,2004,2005,2006,2007,2008,2009"</p>

<p class=Code>a_expire_year.initialize( stritran(x,",",crlf() ) )</p>

<p class=Code>shipping_flag = .f.</p>

<p class=Code>page = "Billing"</p>

<p class=Code>old_tab = page</p>

<p class=Code>result = ui_dlg_box("Title",<<%dlg%</p>

<p class=Code>{tab=page!page_change}</p>

<p class=Code>{pane=Billing}</p>

<p class=Code>{region1}</p>

<p class=Code>Billing Address:;</p>

<p class=Code>{line=2,0};</p>

<p class=Code>First name:| [.32firstname] ;</p>

<p class=Code>Last name:| [.32lastname] ;</p>

<p class=Code>Address 1:| [.32address1] ;</p>

<p class=Code>Address 2:| [.32address2] ;</p>

<p class=Code>City:| [.32City] ;</p>

<p class=Code>State:| [State] ;</p>

<p class=Code>Zip:| [Zip];</p>

<p class=Code>{lf};</p>

<p class=Code>(shipping_flag) Different shipping address?;</p>

<p class=Code>{endregion1};</p>

<p class=Code>{pane=Shipping?shipping_flag}</p>

<p class=Code>{region}</p>

<p class=Code>Shipping Address:;</p>

<p class=Code>{line=2,0};</p>

<p class=Code>First name:| [.32firstname] ;</p>

<p class=Code>Last name:| [.32lastname] ;</p>

<p class=Code>Address 1:| [.32address1] ;</p>

<p class=Code>Address 2:| [.32address2] ;</p>

<p class=Code>City:| [.32City] ;</p>

<p class=Code>State:| [State] ;</p>

<p class=Code>Zip:| [Zip]</p>

<p class=Code>{endregion};</p>

<p class=Code>{pane=Credit Card}</p>

<p class=Code>{region}</p>

<p class=Code>Card Type:| [.32card_type^=a_card_type] ;</p>

<p class=Code>Card Number:| [.32card_number] ;</p>

<p class=Code>Expiration:| [.4expiry_month^=a_expire_month] [.5expiry_year^=a_expire_year] ;</p>

<p class=Code>{endregion};</p>

<p class=Code>{endtab}|</p>

<p class=Code>{Region3}</p>

<p class=Code>&nbsp;<10&OK>;</p>

<p class=Code>&nbsp;<10&Cancel>;</p>

<p class=Code>{Endregion3}</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if a_dlg_button = "page_change" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;question = ui_msg_box("Notice","User wants to change the tab page. Allow?", ui_yes_no + ui_question_symbol)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if question = ui_no_selected then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page = old_tab</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_tab = page</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>The above script creates this dialog: </p>

<p class=Pix> <img src="images/XD_TABBED_CONTROL_3.GIF" x-maintain-ratio=TRUE style="border: none; width: 445px; height: 292px; float: none; border-style: none; border-style: none;" width=445 height=292 border=0></p>

<p class=PixCaption>Lesson 8: Tab Control - Conditional Panes and Tab Events</p>

<p>When the user clicks the check box, the 'Shipping' tab appears: </p>

<p class=Pix> <img src="images/XD_TABBED_CONTROL_4.GIF" x-maintain-ratio=TRUE style="border: none; width: 445px; height: 292px; float: none; border-style: none; border-style: none;" width=445 height=292 border=0></p>

<p class=PixCaption>Lesson 8: Tab Control - Conditional Panes and Tab Events</p>

<p>When the user tries to navigate to a new tab, the following UI_MSG_BOX() appears: </p>

<p class=Pix> <img src="images/XD_Notice.gif" x-maintain-ratio=TRUE style="border: none; width: 282px; height: 126px; float: none; border-style: none; border-style: none;" width=282 height=126 border=0></p>

<p>In the above script notice that the command to define the Shipping pane is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{pane=Shipping?shipping_flag}</td> </tr> </table><p>When the dialog is opened, the <span class=Code1>shipping_flag</span> is initially set to .F., so the Shipping pane is not shown. When the user clicks the check box on the Billing pane, the <span class=Code1>shipping_flag</span> is set to .T., and so the pane is displayed.</p>

<p>The tab control is defined using the command:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>{tab=page!page_change}</td> </tr> </table><p>Whenever the user changes panes on the tab control, and event called <span class=Code1>page_change</span> is generated. The following event handling code handles this event:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>1. if a_dlg_button = "page_change" then</p>

<p class=Code>2. a_dlg_button = ""</p>

<p class=Code>3. question = ui_msg_box("Notice","User wants to change the tab page. Allow?",ui_yes_no+ui_question_symbol)</p>

<p class=Code>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if question = ui_no_selected then</p>

<p class=Code>5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page = old_tab</p>

<p class=Code>6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>7.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_tab = page</p>

<p class=Code>8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>9. end if</td> </tr> </table><p>In line 3, a message box is opened when the user tries to change tabs. If the user click 'No' on the message box, then question is equal to <span class=Code1>ui_no_selected</span> and page is set to <span class=Code1>old_tab</span>. <span class=Code1>old_tab</span> is a variable that contains the name of pane that had focus before the user tried to change panes. So, the user stays on the current pane.</p>

<p>If, on the other hand, the user selects 'Yes', then <span class=Code1>old_tab</span> is set to the tab pane to which the user is switching.</p>

<p>Note that <span class=Code1>old_tab</span> is initialized to 'Billing' before the dialog is opened. (i.e. before the <a href="../../../References/Functions/UI_DLG_BOX Function.html" title="UI_DLG_BOX Function" class="wiki">UI_DLG_BOX(</a>)command).</p>

<p class=A5>Next</p>

<p> <a href="../Lesson 9 Adding Help To a Dialog Box/The Help Command.html" title="The Help Command" class="wiki">The Help Command</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 5 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Conditionally+Displaying+Panes+on+a+Tab+Control">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>