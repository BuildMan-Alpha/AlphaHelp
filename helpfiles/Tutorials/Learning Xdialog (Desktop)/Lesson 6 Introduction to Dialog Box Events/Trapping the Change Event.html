	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Trapping the Change Event</p>

<p>As we have shown in the previous examples, Alpha Anywhere automatically generates an event when a button on a dialog is pushed. In addition to the button push event, it is often necessary to generate an event when the value in a control on a dialog box changes.</p>

<p>To do this, you specify the name of the event in the syntax for the control. The syntax for generating a change event for a control is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[control_definition!event_name]</td> </tr> </table><p>If you also want to make the control conditional, then the syntax is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[control_definition!event_name?conditional_flag]</td> </tr> </table><p>where <span class=Code1>control_definition</span> is the syntax that defines the control, and <span class=Code1>event_name</span> is the name of the event that is generated when the variable in the control changes. If <span class=Code1>conditional_flag</span> is .F., the control is disabled.</p>

<p>For example, the following syntax places a text box on a dialog. When the value in the text box changes (i.e. when the value in variable1 changes) an event called <span class=Code1>value_changed</span> is generated:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[.30variable1!value_changed]</td> </tr> </table><p>The following script prompts for a user's name and address and then displays a text box showing the address in a mailing label format.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>result = ui_dlg_box("Enter Name and Address",<<%dlg%</p>

<p class=Code>{ysize=2}</p>

<p class=Code>{region}</p>

<p class=Code>Firstname: |[.20fname!change] Lastname: [.20lname!change];</p>

<p class=Code>Addresss: |[.40address1!change];</p>

<p class=Code>{sp}|[.40address2!change];</p>

<p class=Code>City: |[.20city!change] State: [.5state!change] Zip: [.10zip!change];</p>

<p class=Code>{endregion};</p>

<p class=Code>{lf};</p>

<p class=Code>{frame=1,1:Address:}</p>

<p class=Code>{region}</p>

<p class=Code>{text=40,4address_txt}</p>

<p class=Code>{endregion};</p>

<p class=Code>{region}</p>

<p class=Code><15&Close></p>

<p class=Code>{endregion}</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if a_dlg_button = "change" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;address_txt = alltrim(fname)+" "+alltrim(lname)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;address_txt = address_txt+crlf()+address1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if address2 <> "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_txt = address_txt+crlf()+address2</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if city+state+zip <> ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;citystzip = alltrim(city)+", "+alltrim(state)+ " "+zip</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_txt = address_txt+crlf()+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;citystzip</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "&Close" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if address_txt <> "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = address_txt</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>%code%)</p>

<p class=Code>if result <> "&Close" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Address",result)</p>

<p class=Code>end if</td> </tr> </table><p>The script creates this dialog: </p>

<p class=Pix> <img src="images/XD_Enter_Name_and_Address.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 346px; height: 292px; border-style: none; border-style: none;" width=346 height=292 border=0></p>

<p class=PixCaption>Lesson 6: Trapping the Change Event</p>

<p>By including the directive '!change' in the definition of each text box in the above script, we have specified that Alpha Anywhere will generate an event (called 'change' ) whenever the value in any of the text boxes is changed by the user.</p>

<p>The code starting with the line&nbsp; <span class=Code1>if a_dlg_button = "change" then</span> is where the 'change' event is handled. Every time the user changes a value in any of the text boxes on the dialog, the script computes the <span class=Code1>address_txt</span> variable and displays it on the dialog (using the {text} command).</p>

<p>When the user presses the Close button, the <span class=Code1>address_txt</span> variable is assigned to the <span class=Code1>a_dlg_button</span> variable (as long&nbsp;as&nbsp; <span class=Code1>address_txt</span> is not NULL).&nbsp;as&nbsp;we saw previously, if <span class=Code1>a_dlg_button</span> is set to a non-null value when the event processing script ends, the dialog closes and the <a href="../../../References/Functions/UI_DLG_BOX Function.html" title="UI_DLG_BOX Function" class="wiki">UI_DLG_BOX(</a>)function returns the value of <span class=Code1>a_dlg_button</span>. Since the event handler for the '&Close' event sets <span class=Code1>a_dlg_button</span> to <span class=Code1>address_txt</span>, the dialog closes, and sets 'result' to <span class=Code1>address_txt</span>.</p>

<p class=A5>Next</p>

<p> <a href="Trapping Other Events.html" title="Trapping Other Events" class="wiki">Trapping Other Events</a></p>


<p class=A5>Limitations</p>

<p>Desktop applications only</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Trapping+the+Change+Event">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,xbasic","group":"/Guide/Desktop/Design/Platform/Xbasic/"} --->
</body></html>