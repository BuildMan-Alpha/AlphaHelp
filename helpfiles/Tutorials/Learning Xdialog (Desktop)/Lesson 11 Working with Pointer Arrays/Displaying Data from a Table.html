	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Displaying Data from a Table</p>

<p>As you can see in the above example, initializing the customer array is quite tedious. Alpha Five offers two array methods that are particularly useful for initializing arrays of pointers. These are <a href="../../../References/Methods/ARRAY.INITIALIZE_PROPERTIES Method.html" title="ARRAY.INITIALIZE_PROPERTIES Method" class="wiki">&lt;ARRAY&gt;.INITIALIZE_PROPERTIES(</a>)and <a href="../../../References/Methods/ARRAY.INITIALIZE_FROM_TABLE Method.html" title="ARRAY.INITIALIZE_FROM_TABLE Method" class="wiki">&lt;ARRAY&gt;.INITIALIZE_FROM_TABLE(</a>).</p>

<p>In the above example, the company array could be initialized more concisely&nbsp;as&nbsp;follows:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>DIM customer[3]&nbsp;as&nbsp;P</p>

<p class=Code>Customers = <<%dlg%</p>

<p class=Code>Alpha,1 Main St.,Boston,MA,02116,6175551212</p>

<p class=Code>Beta,2 Center St.,New York,NY,01001,2125551212</p>

<p class=Code>Gamma,3 Maple Ln.,Cambridge,MA,02139,6178641212</p>

<p class=Code>%dlg%</p>

<p class=Code>template = "Name,Address,City,State,Zip,Phone"</p>

<p class=Code>customer.initialize_properties(template,customers)</td> </tr> </table><p>The <ARRAY>.INITIALIZE_FROM_TABLE() method allows you to read an entire table of data (subject to a filter expression) into an array.</p>

<p>The following script displays data from the Clients table:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>table_name = a5.Get_Path()+chr(92)+"clients.dbf"</p>

<p class=Code>dim rec[1000]&nbsp;as&nbsp;P</p>

<p class=Code>rec.initialize_from_table(table_name,".t.","lastname")</p>

<p class=Code>dim i&nbsp;as&nbsp;N</p>

<p class=Code>i = 1</p>

<p class=Code>ui_dlg_box("Clients",<<%dlg%</p>

<p class=Code>{region}</p>

<p class=Code>[.30,15i^#rec[\].lastname];</p>

<p class=Code><%I=$a5_record_first%12First Record!first></p>

<p class=Code><%I=$a5_record_previous%12Previous Record!previous></p>

<p class=Code>[.5i!i_changed]</p>

<p class=Code><%I=$a5_record_next%12Next Record!next></p>

<p class=Code><%I=$a5_record_last%12Last Record!last>;</p>

<p class=Code>{endregion}|{sp}|</p>

<p class=Code>{region}</p>

<p class=Code>Lastname: | {text=30:rec[i].lastname};</p>

<p class=Code>Firstname: | {text=30:rec[i].firstname};</p>

<p class=Code>Phone: | {text=30:rec[i].phone};</p>

<p class=Code>Address 1: | {text=30:rec[i].address1 };</p>

<p class=Code>Address 2: | {text=30:rec[i].address2 };</p>

<p class=Code>City:&nbsp;&nbsp;| {text=30:rec[i].city };</p>

<p class=Code>State:&nbsp;&nbsp;| {text=30:rec[i].state };</p>

<p class=Code>Zip:&nbsp;&nbsp;| {text=30:rec[i][.zip };</p>

<p class=Code>{endregion}</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if&nbsp;inlist(a_dlg_button,"first","previous","next","last") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;select</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "first"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = 1</p>

<p class=Code></p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "previous"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i > 1 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = i - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "next"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i < rec.first_empty("lastname") - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = i + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "last"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = rec.first_empty("lastname") - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end select</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "i_changed " then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'prevent the user from navigating past the end</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i > rec.first_empty("lastname") - 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = rec.first_empty("lastname") - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "lastname_changed" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rec[i].lastname = rec[i].lastname</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>This script displays this dialog box: </p>

<p class=Pix> <img src="images/XD_image119.jpg" style="width: 363px; height: 243px; float: none; border-style: none; border-style: none;" width=363 height=243 border=0></p>

<p class=PixCaption>Lesson 11: Displaying Data from a Table</p>

<p class=A5><a name=Displaying_Data_from_a_Table___One_Record_at_a_Time>Displaying Data from a Table - One Record at a Time</a></p>

<p>The above script reads the entire table into an array, and so would be impractical for a large table. The following script creates a dialog box that reads one record at a time, and so it could be used on a table of any size.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>table_name = a5.Get_Path()+chr(92)+"clients.dbf"</p>

<p class=Code>dim tbl&nbsp;as&nbsp;P</p>

<p class=Code>tbl = table.open(table_name)</p>

<p class=Code>last_record = tbl.records_get()</p>

<p class=Code>tbl.close()</p>

<p class=Code>dim rec[1]&nbsp;as&nbsp;P</p>

<p class=Code>rec.initialize_from_table(table_name,"recno()=1","lastname")</p>

<p class=Code>dim i&nbsp;as&nbsp;N</p>

<p class=Code>i = 1</p>

<p class=Code>dim i2&nbsp;as&nbsp;N</p>

<p class=Code>i2 = 1</p>

<p class=Code>flag_changed = .f.</p>

<p class=Code>ui_dlg_box("Clients",<<%dlg%</p>

<p class=Code>{region}</p>

<p class=Code>Lastname: | {text=30:rec[i].lastname};</p>

<p class=Code>Firstname: | {text=30:rec[i].firstname};</p>

<p class=Code>Phone: | {text=30:rec[i].phone};</p>

<p class=Code>Address 1: | {text=30:rec[i].address1 };</p>

<p class=Code>Address 2: | {text=30:rec[i].address2 };</p>

<p class=Code>City:&nbsp;| {text=30:rec[i].city };</p>

<p class=Code>State:&nbsp;| {text=30:rec[i].state };</p>

<p class=Code>Zip:&nbsp;| {text=30:rec[i].zip };</p>

<p class=Code>{endregion};</p>

<p class=Code>{line=1,0};</p>

<p class=Code>{region}</p>

<p class=Code><%I=$a5_record_first%12First Record!first></p>

<p class=Code><%I=$a5_record_previous%12Previous Record!previous></p>

<p class=Code>[.5i2!i2_changed]</p>

<p class=Code><%I=$a5_record_next%12Next Record!next></p>

<p class=Code><%I=$a5_record_last%12Last Record!last></p>

<p class=Code>{endregion}</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if&nbsp;inlist(a_dlg_button, "first","previous", "next", "last") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;select</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "first"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i2 = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "previous"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i2 > 1 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i2 = i2 - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "next"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i2 < last_record</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i2 = i2 + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "last"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i2 = last_record</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end select</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Rec.clear()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rec.initialize_from_table(table_name,"recno()=" +i2,"lastname")</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "i2_changed " then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'prevent the user from navigating past the end</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i2 > last_record then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i2 = last_record</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Rec.clear()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rec.initialize_from_table(table_name,"recno()=" +i2,"lastname")</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>The above script displays this dialog box: </p>

<p class=Pix> <img src="images/XD_Lesson_11.gif" x-maintain-ratio=TRUE style="width: 303px; height: 204px; float: none; border-style: none; border-style: none;" width=303 height=204 border=0></p>

<p class=PixCaption>Lesson 11: Displaying Data from a Table - One Record at a Time</p>

<p>The above script initializes an array with only one record, and then when ever the user navigates using the VCR buttons, or by typing a record number directly into the text box, a different record is fetched and loaded into the array with the commands:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>rec.clear()</p>

<p class=Code>rec.initialize_from_table(table_name,"recno()=" +i2,"lastname")</td> </tr> </table><p>which clears out the array, and then loads the selected record from the table into the array.</p>

<p class=A5>Next</p>

<p> <a href="../Lesson 12 Tree Controls/A Simple Tree Control.html" title="A Simple Tree Control" class="wiki">A Simple Tree Control</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 5 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Displaying+Data+from+a+Table">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>