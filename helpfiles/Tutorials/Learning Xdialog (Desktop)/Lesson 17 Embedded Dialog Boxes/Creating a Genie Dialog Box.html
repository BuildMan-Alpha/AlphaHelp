	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Creating a Genie Dialog Box</p>

<p>This next example shows how a "genie" dialog can be created.&nbsp;  </p>

<p class=Pix> <img src="images/XD_Genie_3.gif" style="border: none; width: 443px; height: 305px; float: none; border-style: none; border-style: none;" width=443 height=305 border=0></p>

<p class=PixCaption>Lesson 17: Creating a Genie dialog box - Page 1</p>

<p class=Pix> <img src="images/XD_Genie_1.gif" x-maintain-ratio=TRUE style="width: 443px; height: 305px; float: none; border-style: none; border-style: none;" width=443 height=305 border=0></p>

<p class=PixCaption>Lesson 17: Creating a Genie dialog box - Page 2</p>

<p class=Pix> <img src="images/XD_Genie_2.gif" style="width: 443px; height: 305px; float: none; border-style: none; border-style: none;" width=443 height=305 border=0></p>

<p class=PixCaption>Lesson 17: Creating a Genie dialog box - Page 3</p>

<p>Below is the script to produce this genie. The script is quite long, but do not let its length intimidate you. It is actually quite simple. One key aspect of the script is the use of functions defined within the script to help make the code more readable.</p>

<p>Notice that near the top of the script we execute the command:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>vl = local_variables()</td> </tr> </table><p>This command creates a pointer to all of the local variables in the script. We pass this pointer in to all of the functions that we call in the script. By doing this, the function can see and set local variables in the script.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>page = 1</p>

<p class=Code>max_pages = 3</p>

<p class=Code>'flag controls if you can move off the current genie page.</p>

<p class=Code>dim genie_stay&nbsp;as&nbsp;L</p>

<p class=Code>genie_stay = .f.</p>

<p class=Code>dim error_message&nbsp;as&nbsp;C</p>

<p class=Code>'error message if you try to move off the current page when all</p>

<p class=Code>'conditions have not been met.</p>

<p class=Code>error_message = ""</p>

<p class=Code>vl = local_variables()</p>

<p class=Code>define_pages(vl)</p>

<p class=Code>set_flags(vl)</p>

<p class=Code>ui_dlg_box("Genie",<<%dlg%</p>

<p class=Code>{startup=init}</p>

<p class=Code>{region0}</p>

<p class=Code>{region1}</p>

<p class=Code>{wrap=20};</p>

<p class=Code>This script demonstrates an approach to designing a Genie with Xdialog, using Embedded Dialog boxes.;</p>

<p class=Code>{lf};</p>

<p class=Code>The text in this region will appear on all Genie pages.;</p>

<p class=Code>{lf};</p>

<p class=Code>{image=group}</p>

<p class=Code>{endregion1}|{sp}|</p>

<p class=Code>{frame=1,1}</p>

<p class=Code>{region3}</p>

<p class=Code>{embedded=60,15genie}</p>

<p class=Code>{endregion3};</p>

<p class=Code>{region}</p>

<p class=Code>{endregion};</p>

<p class=Code>{endregion0};</p>

<p class=Code>{region}</p>

<p class=Code>{justify=right}<15&Cancel> <15<&Previous!previous?flag_previous> <15&Next\>!next?flag_next> <15&Finish?flag_finish></p>

<p class=Code>{endregion}</p>

<p class=Code>%dlg%, <<%code%</p>

<p class=Code>if a_dlg_button = "finish" then</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "init" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;show_page(vl,1)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "next" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;page = page + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;if page > max_pages then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page = max_pages</p>

<p class=Code>&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;show_page(vl,page)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "previous" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;page = page - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;if page < 1 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;show_page(vl,page)</p>

<p class=Code>end if</p>

<p class=Code>%code%)</p>

<p class=Code>function show_page&nbsp;as&nbsp;C (vars&nbsp;as&nbsp;P, page&nbsp;as&nbsp;N )</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;if genie_stay = .f. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_code = eval("page_"+page)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(temp_code)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_flags(vl)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error",error_message,UI_STOP_SYMBOL)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end with</p>

<p class=Code>end function</p>

<p class=Code>function define_pages&nbsp;as&nbsp;C (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>page_1 = <<%dlg2%</p>

<p class=Code>ui_modeless_dlg_box("genie",<<%dlg%</p>

<p class=Code>{cellspillover=on}</p>

<p class=Code>{lf};</p>

<p class=Code>Welcome to the Xdialog genie.;</p>

<p class=Code>{lf};</p>

<p class=Code>Press the Next button below to get started.;</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>1=1</p>

<p class=Code>%code%)</p>

<p class=Code>%dlg2%</p>

<p class=Code>page_2 = <<%dlg2%</p>

<p class=Code>ui_modeless_dlg_box("genie",<<%dlg%</p>

<p class=Code>{cellspillover=on}</p>

<p class=Code>Enter your name:;</p>

<p class=Code>{lf};</p>

<p class=Code>{lf};</p>

<p class=Code>Firstname: | <a class="wiki"  href=".30fname" rel="">.30fname</a>;</p>

<p class=Code>{lf};</p>

<p class=Code>Lastname: | <a class="wiki"  href=".30lname" rel="">.30lname</a>;</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>1=1</p>

<p class=Code>%code%)</p>

<p class=Code>%dlg2%</p>

<p class=Code>page_3 = <<%dlg2%</p>

<p class=Code>ui_modeless_dlg_box("genie",<<%dlg%</p>

<p class=Code>{cellspillover=on}</p>

<p class=Code>Enter your age:;</p>

<p class=Code>{lf};</p>

<p class=Code>{lf};</p>

<p class=Code>Age: | <a class="wiki"  href=".30age" rel="">.30age</a>;</p>

<p class=Code>{lf};</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>1=1</p>

<p class=Code>%code%)</p>

<p class=Code>%dlg2%</p>

<p class=Code>end with</p>

<p class=Code>end function</p>

<p class=Code>function set_flags&nbsp;as&nbsp;C (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;if page = max_pages</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_finish = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_next = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_finish = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_previous = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;else if page = 1 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_next = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_previous = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_finish = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_next = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_previous = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_finish = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table><p class=A5>Next</p>

<p> <a href="../Miscellaneous Examples/A Genie Style Dialog with Tabs.html" title="A Genie Style Dialog with Tabs" class="wiki">A Genie Style Dialog with Tabs</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 5 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+a+Genie+Dialog+Box">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>