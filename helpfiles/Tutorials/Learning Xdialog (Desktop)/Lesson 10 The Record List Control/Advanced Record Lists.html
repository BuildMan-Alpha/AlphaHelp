	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Advanced Record Lists</p>

<p>Advanced record lists give you more control over the data that is displayed in the record list and the formatting of the record list. In addition, you are not restricted to showing data from the primary table of the session. You can display data from any table.</p>

<p>The syntax for an advanced record list-combo box control is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[%K=Table,{keylist_expression}{filter_expression}%.Size VariableName]</td> </tr> </table><p>The syntax for an advanced record list-edit combo box control is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[%KE=Table,{keylist_expression}{filter_expression}%.Size VariableName]</td> </tr> </table><p>The syntax for an advanced list box-record list control is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[%KL=Table,{keylist_expression}{filter_expression}%.Size VariableName]</td> </tr> </table><p>Where <span class=Code1>keylist_expression</span> defines the order of the data in the record list and the columns in the record list. The <span class=Code1>keylist_expression</span> uses a special function called <a href="../../../References/Functions/KEYLIST_BUILD Function.html" title="KEYLIST_BUILD Function" class="wiki">KEYLIST_BUILD(</a>). The syntax of KEYLIST_BUILD()is defined below.</p>

<p class=Note> <span class=Note> <img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0>Note</span> : The parameter is called <span class=Code1>keylist_expression</span> because technically, the record list actually shows the "key" in an index or query.</p>

<p> <span class=Code1>Filter_expression</span> is optional. If specified, it filters the data that is shown in the <span class=Code1>keylist_expression</span>.</p>

<p class=A5><a name=_Toc31098294>Syntax of the Keylist_Build() function</a></p>

<p>The KEYLIST_BUILD() function defines:</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>Order of data in the record list</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>How many columns are displayed in the record list</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The contents of each column</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The width of each column</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The value returned when the user makes a selection from the record list.</p>

</li> </ul><p>The syntax of KEYLIST_BUILD()is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>Keylist_build(column_format_string, return_expression, column_definition)</td> </tr> </table><p>where:</p>

<p> <span class=Code1>Column_format_string</span> is a comma delimited character string of format: <span class=Code1>col#:width</span>. For example: "1:30,2:20,3:15". In this example there are 3 columns of width 30, 20 and 15 respectively.</p>

<p> <span class=Code1>Return_expression</span> is a standard Alpha Five expression that defines the value returned when the user makes a selection from the record list.</p>

<p> <span class=Code1>Column_definition</span> is a string that defines the order of the data in the record list and the contents of each column. The format is:&nbsp;&nbsp;Column1expression,column2_expression, ... columnN_expression. The record list is sorted by the concatenated column expressions. E.g.: <span class=Code1>column1expression + column2_expression + ... columnN_expression</span>.</p>

<p>For example, consider the following <span class=Code1>column_definition</span> string:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>Alltrim(firstname) + ' ' + lastname,phone</td> </tr> </table><p>This defines two columns. The first column is: <span class=Code1>Alltrim(firstname) + ' ' + lastname</span>. The second column is: <span class=Code1>phone</span>.</p>

<p>The corresponding <span class=Code1>column_format_string</span> for this might be: "1:30,2:20", which indicates that the first column is 30 characters wide and the second is 20 characters wide.</p>

<p>Let's analyze a complete Advanced Record List command:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[%k=clients,{keylist_build('1:30,2:20,3:15',customer_id, alltrim(firstname)+ ' ' + lastname , company,phone)}{state = 'MA'}%.30key_value];</td> </tr> </table><p>This command creates a record list with 3 columns of width 30, 20 and 15 characters.</p>

<p>When the user selects a value from the record list, the value in the selected record's <span class=Code1>customer_id</span> field is returned.</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The first column in the keylist is: <span class=Code1>alltrim(firstname)+ ' ' + lastname</span>.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The second column in the record list is: company.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The third column in the record list is: phone.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The record list is filtered with the expression: state = 'MA'.</p>

</li> </ul><p class=Note> <span class=Note>IMPORTANT NOTE</span> : If you return a value that is not equal to the record list column definition (as in the above example), then there must be an existing index on the return value field/expression. If not, when you open a drop-down record list that has an existing value selected, Alpha Five will not be able to synchronize the record list to the pre-existing selection. <br> <br> For example, in the above case, the return value is <span class=Code1>customer_id</span>, so the 'clients' table must have an index on <span class=Code1>customer_id</span>. When the user makes a selection from the drop-down record list, the <span class=Code1>customer_id</span> corresponding to the selected customer is shown in the type-in area of the drop-down record list control. If you then go and open the record list again, Alpha Five will highlight the row in the record list corresponding to the current <span class=Code1>customer_id</span> value in the type-in area of the record list control. If there is no index on <span class=Code1>customer_id</span>, Alpha Five will not be able to highlight the correct row of data.</p>

<p>The following script shows an advanced drop-down record list control: </p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_dlg_box("Print Mail Label",<<%dlg%</p>

<p class=Code>Preview mail labels for which customer?;</p>

<p class=Code>[%k=clients,{keylist_build('1:25,2:25,3:25',</p>

<p class=Code>customer_id,alltrim(firstname)+' '+lastname, phone, city)}%.30key];</p>

<p class=Code>{lf};</p>

<p class=Code><Preview!ok> <Cancel></p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if a_dlg_button = "ok" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter_expression = "customer_id = '"+key+"'"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;label.Preview("mail_labels",filter_expression)</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p class=Pix> <img src="images/XD_Print Mail Label.gif" x-maintain-ratio=TRUE style="border: none; width: 201px; height: 116px; float: none; border-style: none; border-style: none;" width=201 height=116 border=0></p>

<p class=PixCaption>Lesson 10: An Advanced Record List-Combo Box Control</p>

<p>When the drop-down list is open, Alpha Five displays three columns of data. </p>

<p class=Pix> <img src="images/XD_Formatting Record Lists.gif" x-maintain-ratio=TRUE style="border: none; width: 318px; height: 168px; float: none; border-style: none; border-style: none;" width=318 height=168 border=0></p>

<p class=A5>Next</p>

<p> <a href="Advanced List Box-Record List Control.html" title="Advanced List Box-Record List Control" class="wiki">Advanced List Box-Record List Control</a></p>



<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Advanced+Record+Lists">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>