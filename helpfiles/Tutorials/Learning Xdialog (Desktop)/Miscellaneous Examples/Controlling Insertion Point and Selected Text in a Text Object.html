	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Controlling Insertion Point and Selected Text in a Text Object</p>

<p>This example shows how you can control the insertion point and selected text in a text control on an Xdialog box. Normally, when you place a text control on an Xdialog box, you bind the control to a character variable. For example:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>'text = "some text"</p>

<p class=Code>'ui_dlg_box("title","[.20text]")</td> </tr> </table><p>However, if you want to be able to control the Insertion Point and Selected text, then you must bind the control to a 'pointer' variable that has a <span class=Code1>.text</span> and a <span class=Code1>.object</span> property,&nbsp;as&nbsp;shown in the example below. The <span class=Code1>.text</span> property contains the text in the variable. The <span class=Code1>.object</span> property gives you access to the properties and methods of this text object.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim ptext&nbsp;as&nbsp;P</p>

<p class=Code>dim ptext.text&nbsp;as&nbsp;C</p>

<p class=Code>dim ptext.object&nbsp;as&nbsp;P</p>

<p class=Code>ptext.text = "This is an example showing how Xdialog can control the insertion point and selected text in an character variable on an Xdialog dialog box." + crlf(2)+\</p>

<p class=Code>"This is some more text following a carriage return."</p>

<p class=Code>dim dlg_title&nbsp;as&nbsp;C</p>

<p class=Code>dlg_title = "Controlling Insertion Point and Selection in a Text Object on an Xdialog Box"</p>

<p class=Code>dim flagCutCopy&nbsp;as&nbsp;L</p>

<p class=Code>flagCutCopy = .f.</td> </tr> </table><p>The <span class=Code1>{watch}</span> command sets up a watch event. the result of the expression <span class=Code1>ptext.object.get_select()</span>is monitored. Every time the value in this expression changes, the 'change' event fires. the 'change' event sets the flag <span class=Code1>flagCutCopy</span> to <span class=Code1>.T.</span> if there is some text selected, and to <span class=Code1>.F.</span> if there is no text selected.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_dlg_box(dlg_title,<<%dlg%</p>

<p class=Code>{watch=ptext.object.get_select()!change}</p>

<p class=Code>{startup=init}</p>

<p class=Code>{font=courier new,10}</td> </tr> </table> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>M flag is for multi-line text box</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>W flag is for word wrap</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>A flag is to allow the text control to accept Tabs (i.e. do not tab out of the control when the user types a tab)</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>K flag means keep selection visible even when the control does not have focus.</p>

</li> </ul>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>[%MAW;K%.150,10ptext];</p>

<p class=Code>{font=}</p>

<p class=Code><Cut?flagCutCopy> <Copy?flagCutCopy> <Paste?.not.(clipboard.get_data()="")>{sp=5}<Set Insertion Point!set_ip> <Select Text!select_text> <Highlight String!highlight> <Insert Text!insert> <Show Selection!show></p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if a_dlg_button ="change" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if ptext.object.get_select()= "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flagCutCopy = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flagCutCopy = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "insert" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;string = "text to insert"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_box("Highlight String","String |[.25string];{lf};|<OK> <Cancel>",<<%txt%</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if a_dlg_button = "ok" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;%txt%)</td> </tr> </table><p class=Note> <span class=Note> <img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0>Note</span> : The .replace_text() method which is also supported by the text object is the same&nbsp;as&nbsp;the .insert_text() method.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if flag_ok = .t. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_ip = ip + len(string)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.insert_text(string)</td> </tr> </table><p>After clicking the 'insert text' button focus is on the button. we want to return focus to the edit control.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(new_ip)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'this causes the text box to scroll if the insertion point is not currently visible</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "show" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;current_selection = ptext.object.get_select()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Current Selection","Selected text: " + current_selection + crlf(2) + "Insertion point: " + ip +crlf()+"Length of selection: " + len(current_selection) )</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "cut" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.cut()</td> </tr> </table><p>After clicking the 'cut' button focus is on the button. we want to return focus to the edit control.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'set the insertion point. make sure that the insertion point is not past the end of the text</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if ip <=len(ptext.text) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(ip)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor( len(ptext.text) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</td> </tr> </table><p>This causes the text box to scroll if the insertion point is not currently visible.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "copy" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'get the current insertion point and selected text</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;selected_text = ptext.object.get_select()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.copy()</td> </tr> </table><p>After clicking the 'copy' button focus is on the button. we want to return focus to the edit control.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'restore the current selected text and insertion point</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.select(ip, len(selected_text) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'this causes the text box to scroll if the insertion point is not currently visible</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "paste" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'get the current insertion point</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</td> </tr> </table><p>Compute the new insertion point, which is the current insertion point plus the length of the inserted text.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new_ip = ip + len( ClipBoard.Get_Data() )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.paste()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'after clicking the 'paste' button focus is on the button. we want to return focus to the edit control</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(new_ip)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'this causes the text box to scroll if the insertion point is not currently visible</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "delete" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ip = ptext.object.get_cursor()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.delete()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'after clicking the 'cut' button focus is on the button. we want to return focus to the edit control</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</td> </tr> </table><p>Set the insertion point. Make sure that the insertion point is not past the end of the text.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if ip <=len(ptext.text) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(ip)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor( len(ptext.text) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'this causes the text box to scroll if the insertion point is not currently visible</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "select_text" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;start_pos = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;len = 10</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_box("Select Text","Start Position |[.5start_pos];Length |[.5len];{lf};|<OK> <Cancel>",<<%txt%</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if a_dlg_button = "ok" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;%txt%)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if flag_ok = .t. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.select(start_pos,len)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "highlight" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;string = "carriage"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_box("Highlight String","String |[.15string];{lf};|<OK> <Cancel>",<<%txt%</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if a_dlg_button = "ok" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;%txt%)</td> </tr> </table><p>Convert the text in the control from CR-LF ( <span class=Code1>crlf()</span>) delimited to LF ( <span class=Code1>chr(10)</span> ) delimited. This is because this is how Alpha Five stores the text internally, and so the position of the highlighted text needs to be computed based on an LF delimited string.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;textlf = stritran( ptext.text,crlf(),chr(10) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;start_pos = at(string,textlf)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if start_pos = 0 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error","Not found.")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.select(start_pos, len(string) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'this causes the text box to scroll if the insertion point is not currently visible</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "set_ip" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;pos = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_box("Set Insertion Point","Insert point position |[.5pos];{lf};|<OK> <Cancel>",<<%txt%</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if a_dlg_button = "ok" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ok = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;%txt%)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if flag_ok = .t. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(pos)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.show_caret()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "init" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'give focus to the text control and set the insertion point to the beginning of the text</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_ctl_goto(dlg_title,"ptext")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ptext.object.set_cursor(1)</td> </tr> </table><p class=Note> <span class=Note> <img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0>Note</span> : If you wanted to set the insertion point to the end of the text you would write: <span class=Code1> <br> <br> ptext.object.set_cursor( len(ptext.text) ) <br> 'this causes the text box to scroll if the insertion point is not currently visible <br> ptext.object.show_caret()</span></p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p class=A5>Next</p>

<p> <a href="Defining Which Controls Have Tab Stops.html" title="Defining Which Controls Have Tab Stops" class="wiki">Defining Which Controls Have Tab Stops</a></p>

<p class=A5>See Also</p>

<p> <a href="../Miscellaneous Examples.html" title="Miscellaneous Examples" class="wiki">Miscellaneous Examples</a>, <a href="../../../References/Xdialog/Xdialog Reference/Xdialog Text Pointer.html" title="Xdialog Text Pointer" class="wiki">Xdialog Text Pointer</a>, <a href="../../../Unclassified/Xdialog Text Control Methods.html" title="Xdialog Text Control Methods" class="wiki">Xdialog Text Control Methods</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 5 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Controlling+Insertion+Point+and+Selected+Text+in+a+Text+Object">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>