	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>MDI Xdialog Framework</p>

<p>
	IMPORTANT: If you are using Version 8 or above, you can take advantage of an 
	improved technique for creating MDI Xdialogs. Refer to the sample 'Learning 
	Xdialog' database that ships with Alpha Five and refer to the 
	'mdi_xdialog_frameworkV8' script. The main difference between the new 
	technique, and the technique described here is that in the new technique, a 
	'context' is established and the menu and toolbar are instantiated in that 
	'context'. This is done in the Xdialog's OnInit event. It is no longer 
	necessary to instantiate the menus and toolbars in the on<x>activate event and 
	then destroy them in the on<x>deactivate event.</p>


	<p>This Xdialog box script displays a MDI (Multiple Document Interface) child window. It assumes that you have created a toolbar called <span class=Code1>MDI_test</span>, and a menu called <span class=Code1>MDI_test</span>. The toolbar should have at least two buttons called <span class=Code1>set_title</span> and <span class=Code1>close</span>.</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The event for the <span class=Code1>set_title</span> button should be <span class=Code1>Internal Action</span> and the event name should be <span class=Code1>set_title</span>.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The event for the <span class=Code1>close</span> button should be <span class=Code1>close</span>.</p>

</li> </ul><p>The menu has two commands, <span class=Button>File > Set window title</span>, and <span class=Button>File > Close</span>.</p>

<p>The xdialog menu string for this menu is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>File|{DATA=command:set_title}Set window title</p>

<p class=Code>File|{DATA=command:close}Close window</td> </tr> </table><p>Note that the menu action for each of these menu items is the same&nbsp;as&nbsp;for their corresponding action in the toolbar. This script shows that it is possible to launch multiple instances of the MDI child window. Each instance operates independently of the other. The key to the way in which the toolbar and menu events get executed is the function <span class=Code1>command()</span>defined at the end of this script.</p>

<p class=A5>Examples</p>

<p>This function sends the events to the Xdialog box.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim event_string&nbsp;as&nbsp;C</p>

<p class=Code>dim menu_string&nbsp;as&nbsp;C</p>

<p class=Code>dim toolbar_string&nbsp;as&nbsp;P</p>

<p class=Code>dim message&nbsp;as&nbsp;C</p>

<p class=Code>dim pDummy&nbsp;as&nbsp;P</p>

<p class=Code>title_var_name = "title_var"+stritran(time(),":","_")</p>

<p class=Code>eval(title_var_name) = "Dialog Title"</p>

<p class=Code>dlg_title = "@=" + title_var_name</td> </tr> </table><p>This is how we register a new MDI window class so that it appears in the Window menu and the Window menubar. This function takes three arguments: the class name, the class description, and the class icon.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>
	a5_mdi_windowclass_add("mymdiclass","My Special MDI Window Type","A5_ball_green")</p>

<p class=Code>'This is the event handler string for the Top Menu</p>

<p class=Code>event_string = <<%code%</p>

<p class=Code>if left(a_command,3) = "A5." then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a5.command(substr(a_command,4) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_command = ""</p>

<p class=Code>else if left(a_command,1) = "!" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(substr(a_command,2) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_command = ""</p>

<p class=Code>else if left(a_command,6) = "addin:" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(substr(a_command,7) )</p>

<p class=Code>else if left(a_command,8) = "command:" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_event(dlg_title,substr(a_command,9) )</p>

<p class=Code>else if .not. ("|" $ a_command) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;this.command(a_command)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_command = ""</p>

<p class=Code>end if</p>

<p class=Code>%code%</p>

<p class=Code>menu_string = a5_menu_def_load("MDI_test")</p>

<p class=Code>toolbar_string = a5_toolbar_def_load("mdi_test")</p>

<p class=Code>message = "This is a standard MDI child window. It can be maximized, minimized, resized, or restored."</p>

<p class=Code>ui_modeless_dlg_box(dlg_title,<<%dlg%</p>

<p class=Code>{icon=A5_ball_green}</p>

<p class=Code>{mdichild=mymdiclass}</p>

<p class=Code>{on_activate=activate}</p>

<p class=Code>{on_deactivate=deactivate}</p>

<p class=Code>{text=50,4:Message};</p>

<p class=Code>dlg title <a class="wiki"  href=".30title!title_change" rel="">.30title!title_change</a>;</p>

<p class=Code>%dlg%,<<%code%</p>

<p class=Code>if a_dlg_button = "set_title" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;title = ui_get_text("Title","Enter the text for the Window Title")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if title <> "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval(title_var_name) = title</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "activate" then 'show the toolbar</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;pDummy.dummy = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;toolbar_name = a5_system_toolbar_show(pDummy,toolbar_string)</td> </tr> </table><p>Show the menu. The UI_EXPAND_BRANCHES() function is used to expand certain menu 'macros' (such&nbsp;as&nbsp;recent file list, or window list) at runtime.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_top_menu(ui_expand_branches(menu_string), event_string)</p>

<p class=Code>end if</td> </tr> </table><p>Before closing the toolbar we check to see if it still exists -- the user could have undocked the toolbar and closed it before closing the dialog box.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if a_dlg_button = "deactivate" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if ui_modeless_dlg_exist(toolbar_name) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(toolbar_name)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "title_change" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;eval(title_var_name) = title</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "close" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(dlg_title)</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>This is the event handler for the toolbar. </p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function command&nbsp;as&nbsp;v ( vars&nbsp;as&nbsp;P,command&nbsp;as&nbsp;C )</p>


	<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if left(command,6) = "event:" then</p>

<p class=Code></p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command = substr(command,7)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_event(dlg_title,command)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;command = ""</p>


	<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table><p class=Pix> <img src="images/XD_MDI_Child_Window.gif" x-maintain-ratio=TRUE style="border: none; width: 289px; height: 219px; float: none; border-style: none; border-style: none;" width=289 height=219 border=0></p>

<p class=A5>Next</p>

<p> <a href="Menu Style Buttons.html" title="Menu Style Buttons" class="wiki">Menu Style Buttons</a></p>

<p class=A5>See Also</p>

<p> <a href="../../../References/Xdialog/Command/MDICHILD Xdialog Command.html" title="MDICHILD Xdialog Command" class="wiki">{MDICHILD}</a>, <a href="../../../References/Xdialog/Command/ON_ACTIVATE Xdialog Command.html" title="ON_ACTIVATE Xdialog Command" class="wiki">{ON_ACTIVATE}</a>, <a href="../../../References/Xdialog/Command/ON_DEACTIVATE Xdialog Command.html" title="ON_DEACTIVATE Xdialog Command" class="wiki">{ON_DEACTIVATE}</a>, <a href="../Miscellaneous Examples.html" title="Miscellaneous Examples" class="wiki">Miscellaneous Examples</a></p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 6 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:MDI+Xdialog+Framework">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>