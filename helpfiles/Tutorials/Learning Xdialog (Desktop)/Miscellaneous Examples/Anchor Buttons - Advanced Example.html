	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Anchor Buttons - Advanced Example</p>

<p>This script demonstrates several features of buttons. First, buttons can have "anchor" spots in them which allow you to break a single physical button into multiple "logical" buttons. </p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim shared cl_id&nbsp;as&nbsp;C</p>

<p class=Code>dim shared varC_result&nbsp;as&nbsp;C</p>

<p class=Code>dim descending_icon&nbsp;as&nbsp;C</p>

<p class=Code>dim ascending_icon&nbsp;as&nbsp;C</p>

<p class=Code>dim image&nbsp;as&nbsp;C</p>

<p class=Code>dim a_buttons[3]&nbsp;as&nbsp;P</p>

<p class=Code>dim sort_by&nbsp;as&nbsp;C</p>

<p class=Code>dim sort_direction&nbsp;as&nbsp;C</p>

<p class=Code>delete a_cl_id</p>

<p class=Code>dim a_cl_id[1]&nbsp;as&nbsp;C</p>

<p class=Code>dim buttons&nbsp;as&nbsp;C</p>

<p class=Code>descending_icon = "{I:'a5_sort_12_ascending'}"</p>

<p class=Code>ascending_icon = "{I:'a5_sort_12_descending'}"</p>

<p class=Code>dim lv&nbsp;as&nbsp;P</p>

<p class=Code>lv = local_variables()</p>

<p class=Code>sort_by = "lastname"</p>

<p class=Code>sort_direction = "D"</p>

<p class=Code>get_data(lv)</p>

<p class=Code>a_buttons[1].anchor = "Customer_id"</p>

<p class=Code>a_buttons[1].underline_flag = .f.</p>

<p class=Code>a_buttons[1].bold_flag = .f.</p>

<p class=Code>a_buttons[1].label = "Customer Id"</p>

<p class=Code>a_buttons[1].tabstop = ""</p>

<p class=Code>a_buttons[1].direction = ""</p>

<p class=Code>a_buttons[2].anchor = "firstname"</p>

<p class=Code>a_buttons[2].underline_flag = .f.</p>

<p class=Code>a_buttons[2].bold_flag = .f.</p>

<p class=Code>a_buttons[2].label = "First Name"</p>

<p class=Code>a_buttons[2].tabstop = "1"</p>

<p class=Code>a_buttons[2].direction = ""</p>

<p class=Code>a_buttons[3].anchor = "lastname"</p>

<p class=Code>a_buttons[3].underline_flag = .f.</p>

<p class=Code>a_buttons[3].bold_flag = .t.</p>

<p class=Code>a_buttons[3].label = "Last Name"</p>

<p class=Code>a_buttons[3].tabstop = "2"</p>

<p class=Code>a_buttons[3].direction = "D"</p>

<p class=Code>'this function generates a string called 'buttons' of this form:</p>

<p class=Code>'buttons = "{C=Dark Blue}{B=Win3D}{A=customer_id}{F=arial,8}Customer_Id{T=1}{A=Firstname}{F=arial,8}First Name{T=2}{F=arial,8,b}{A=Lastname}Last Name"</p>

<p class=Code>generate_buttons(lv)</p>

<p class=Code>dim current_anchor&nbsp;as&nbsp;C</p>

<p class=Code>dim tempIndx&nbsp;as&nbsp;N</p>

<p class=Code>ok_button_label = "&OK"</p>

<p class=Code>cancel_button_label = "&Cancel"</p>

<p class=Code>varC_result = ui_dlg_box("Alpha Five",<<%dlg%</p>

<p class=Code>{watch=ui_dlg_control_anchor_from_pos("Alpha Five")!mouse_move}</p>

<p class=Code>{region}</p>

<p class=Code>{font=Tahoma,8}</p>

<p class=Code>{wrap=60}</p>

<p class=Code>Click on the column heading to sort the data in the list box.;</p>

<p class=Code>When the mouse is over the button, the button text is underlined.;</p>

<p class=Code>The column that is currently sorted is shown in bold. Click on a column a second time to toggle the sort direction.;</p>

<p class=Code>{line=1,0};</p>

<p class=Code><%O={@@};B=M%30=buttons!click>;</p>

<p class=Code>[%d;O={@@}%.60,20cl_id^#a_cl_id];</p>

<p class=Code>{endregion};</p>

<p class=Code>{line=1,0};</p>

<p class=Code>{region}</p>

<p class=Code><*15=ok_button_label!OK> <15=cancel_button_label!CANCEL></p>

<p class=Code>{endregion};</p>

<p class=Code>%dlg%,<<%code%</td> </tr> </table><p>Event handling code.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if a_dlg_button = "mouse_move" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;current_anchor = ui_dlg_control_anchor_from_pos("Alpha Five")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'find the array index for the anchor that currently has focus -- i.e. anchor 1, 2 or 3</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tempIndx = a_buttons.find(ut(current_anchor), "ut(anchor)")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'reset the underline_flag for each array entry to .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 to a_buttons.size()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[i].underline_flag = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next i</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if tempIndx > 0 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'now turn on the underline_flag for the anchor that currenty has focus.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[tempIndx].underline_flag = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'and now, regenerate the owner draw button string.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;generate_buttons(lv)</p>

<p class=Code>end if</p>

<p class=Code>if a_dlg_button = "click" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'find out which anchor in the button the user clicked on</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;sort_by = ui_dlg_control_anchor_from_pos("Alpha Five")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tempIndx = a_buttons.find(ut(sort_by),"ut(anchor)")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if tempIndx = 0 then 'do nothing</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto do_nothing</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'is data currently sorted on this column?</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if a_buttons[tempIndx].direction <> "" then 'yes, it is currently sorted by this column</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if a_buttons[tempIndx].direction = "D" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort_direction = "A"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort_direction = "D"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort_direction = "D"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(lv)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 to a_buttons.size()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[i].bold_flag = .f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[i].direction = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next i</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[tempIndx].bold_flag = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_buttons[tempIndx].direction = sort_direction</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;generate_buttons(lv)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;do_nothing:</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function get_data&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if sort_direction = "D" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto_list_cl_id = table.external_record_content_get("clients","alltrim(Customer_Id)+\"|\"+alltrim(Firstname)+\"|\"+alltrim(Lastname)",sort_by,"")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto_list_cl_id = table.external_record_content_get("clients","alltrim(Customer_Id)+\"|\"+alltrim(Firstname)+\"|\"+alltrim(Lastname)","invert("+sort_by+")","")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'ui_msg_box("",auto_list_cl_id)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Dim format&nbsp;as&nbsp;P</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.tab_stops=""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.odd_row_color="White"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.even_row_color="Blue White"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.odd_selected_color="Dark Blue"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.even_selected_color="Dark Blue"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.font="Arial,8"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.font_color_unselected="Black"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.font_color_selected="White"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.lastbutton="OK"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.group_size=2</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.number_rows=.f.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Format.alternating_bands=.t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Apply 'owner draw' formatting information to the list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;auto_list_cl_id = a5_owner_draw_list_fmt(auto_list_cl_id,Format)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;temp_count = w_count(auto_list_cl_id,crlf())</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_cl_id.resize(temp_count)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_cl_id.initialize(auto_list_cl_id)</p>

<p class=Code>end with</p>

<p class=Code>end function</td> </tr> </table>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function generate_buttons&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>

<p class=Code>with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;buttons = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 to a_buttons.size()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font_spec = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if a_buttons[i].underline_flag = .t. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font_spec = font_spec + "U"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if a_buttons[i].bold_flag = .t.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font_spec = font_spec + "B"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if font_spec = "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font_spec = "}"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font_spec = "," + font_spec + "}"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if a_buttons[i].direction = "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if a_buttons[i].direction = "D" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = ascending_icon</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if a_buttons[i].direction = "A" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = descending_icon</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buttons = buttons + "{T=" + a_buttons[i].tabstop + "}" + "{A="+a_buttons[i].anchor+"}" + "{F=arial,8" + font_spec + a_buttons[i].label + image</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next i</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;buttons = "{C=Dark Blue}{B=Win3D}" + buttons</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end with</p>

<p class=Code>end function</td> </tr> </table><p class=Pix> <img src="images/XD_Anchor_Buttons_Advanced.gif" x-maintain-ratio=TRUE style="border: none; width: 322px; height: 450px; float: none; border-style: none; border-style: none;" width=322 height=450 border=0></p>

<p class=A5>Next</p>

<p> <a href="Auto-Advance to Next Control When Current Control is Full.html" title="Auto-Advance to Next Control When Current Control is Full" class="wiki">Auto-Advance to Next Control When Current Control is Full</a></p>


<p class=A5>Limitations</p>

<p>Desktop applications only</p>

<p class=A5>See Also</p>

<p> <a href="../Miscellaneous Examples.html" title="Miscellaneous Examples" class="wiki">Miscellaneous Examples</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Anchor+Buttons+-+Advanced+Example">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>