	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Responding to JavaScript Events on an HTML Page</p>

<p>This script demonstrates how you can use Xbasic to respond to events on an HTML page that is hosted in an Xdialog window. The techniques used here are useful if you want to design dialog boxes that take advantage of HTML's layout features, but still have the power of Xbasic to respond to events on the HTML page. 
	Note: A working version of this script can be found in the sample 'Learning 
	Xdialog' database. (See ActiveX,Html).</p>

<p>The non-essential parts of the script are in <span class=Screen>green</span>. Take these out and you have a simple dialog that responds to the <span class=Code1>event1</span> and <span class=Code1>close</span> events.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim dlg_title&nbsp;as&nbsp;C</p>

<p class=Code>dim htmlObj&nbsp;as&nbsp;P</p>

<p class=Code>dim htmlObj.object&nbsp;as&nbsp;P</p>

<p class=Code>dim htmlObj.class&nbsp;as&nbsp;C</p>

<p class=Code>dim htmlObj.events&nbsp;as&nbsp;C</p>

<p class=Code>dim htmlObj_html&nbsp;as&nbsp;C</p>

<p class=Code>dim html_text&nbsp;as&nbsp;C</p>

<p class=Code>dlg_title = "Xbasic Event Handler for JavaScript Events"</td> </tr> </table><p>Define the HTML to be shown in the Xdialog window. First, the style definitions.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>html_text = &lt&lt%html%</p>

<p class=Code>&lthtml></p>

<p class=Code>&ltstyle type="text/css"></p>

<p class=Code> <span class=Screen>&lt!--</span></p>

<p class=Code> <span class=Screen>body{font: 10pt tahoma;}</span></p>

<p class=Code> <span class=Screen>a.a_menu_off, a.a_menu_off:active, a.a_menu_off:visited{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>a.a_menu_off:hover{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>a.a_menu_on, a.a_menu_on:active, a.a_menu_on:visited{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>a.a_menu_on:hover{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>a, a:active, a:visited{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>a:hover{font: 10pt tahoma;text-decoration: underline;}</span></p>

<p class=Code> <span class=Screen>--></span></p>

<p class=Code>&lt/style></td> </tr> </table><p>JavaScript variables and functions that provide services to connect the JavaScript and Xbasic environments. This is the code appropriate to <span class=Bolded>Version 6</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&ltscript type="text/javascript" language="javascript"></p>

<p class=Code>&lt!--</p>

<p class=Code>var oj = new ActiveXObject(" <span class=Control>a5contexteval.contexteval</span> ");</p>

<p class=Code>function CallXbasic(expr) {return oj.eval(<strong>ContextID_Placeholder</strong>,expr);}</p>

<p class=Code>function click1(ur<x>l) {argument = 'Evaluate_Button("' +ur<x>l + '",local_variables())';CallXbasic(argument); }</td> </tr> </table><p>This is the code appropriate to <span class=Bolded>Version 7</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&ltscript type="text/javascript" language="javascript"></p>

<p class=Code>&lt!--</p>

<p class=Code>var oj = new ActiveXObject(" <span class=Control>a5contexteval.contexteval.7</span> ");</p>

<p class=Code>function CallXbasic(expr) {return oj.eval(<strong>ContextID_Placeholder</strong>,expr);}</p>

<p class=Code>function click1(ur<x>l) {argument = 'Evaluate_Button("' +ur<x>l + '",local_variables())';CallXbasic(argument); }</td> </tr> </table><p class=Note> <span class=Note> <img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>Note</span> : Future versions of Alpha Anywhere will require the version number to be appended to "a5contexteval.contexteval"&nbsp;as&nbsp;illustrated above.</p>

<p>Then a JavaScript function to hide and display text on the page.</p>

<table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;">
<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%">
<p class=Code> <span class=Screen> function hide_show_by_id(tar_id){</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.all){</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.all.item(tar_id).style.display == 'none'){</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all.item(tar_id).style.display = 'block';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all.item(tar_id+'_atag').className = 'a_menu_on';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all.item(tar_id).style.display = 'none';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.all.item(tar_id+'_atag').className = 'a_menu_off';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(document.getElementById){</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.getElementById(tar_id).style.display == 'none'){</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(tar_id).style.display = 'block';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(tar_id+'_atag').className = 'a_menu_on';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(tar_id).style.display = 'none';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(tar_id+'_atag').className = 'a_menu_off';</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span> </p>
<p class=Code> <span class=Screen> }</span> </p>
<p class=Code> <span class=Screen> //--></span> </p>
<p class=Code> <span class=Screen> &lt/script>
</td>
</tr>
</table>
<p>Next, the HTML page content.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&ltbody></p>

<p class=Code> <span class=Screen>&lth5>This application demonstrates how you can respond to events on an HTML page with Xbasic event handlers. It also demonstrates how to show and hide sections of the HTML page.&lt/h5></span></p>

<p class=Code> <span class=Screen>&ltbr></span></p>

<p class=Code> <span class=Screen>&lth6>Click the link or button - an Xbasic event handler will run.&lt/h6></span></td> </tr> </table><p>Note the simple syntax to fire an event.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lta href="" on<x>click='click1("event1"); return false;'>Click Me - This will fire 'Event1'&lt/a>&ltbr></td> </tr> </table><p>Note, the simple syntax to fire an event.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code> <span class=Screen>&ltinput type="button" value="Event 2" on<x>click='click1("event2"); return false;'>&ltbr></span></p>

<p class=Code> <span class=Screen>&ltbr></span></p>

<p class=Code> <span class=Screen>&lth6>Click the headings. The page will expand to reveal additional text.&lt/h6></span></p>

<p class=Code> <span class=Screen>&lta href="#" id="div1_atag" on<x>click="hide_show_by_id('div1'); return false" class="a_menu_off">Click here to show/hide Conditional Text - Paragraph 1.&lt/a>&ltbr/></span></p>

<p class=Code> <span class=Screen>&ltdiv id="div1" class="data_div" style="display: none"></span></p>

<p class=Code> <span class=Screen>This is the conditional text for Paragraph 1. It is only revealed when the user clicks on the link.&ltbr></span></p>

<p class=Code> <span class=Screen>&lt/div></span></p>

<p class=Code> <span class=Screen>&lta href="#" id="div2_atag" on<x>click="hide_show_by_id('div2'); return false" class="a_menu_off">Click here to show/hide Conditional Text - Paragraph 2.&lt/a>&ltbr/></span></p>

<p class=Code> <span class=Screen>&ltdiv id="div2" class="data_div" style="display: none"></span></p>

<p class=Code> <span class=Screen>This is the conditional text for Paragraph 2. It is only revealed when the user clicks on the link.&ltbr></span></p>

<p class=Code> <span class=Screen>&lt/div></span></p>

<p class=Code> <span class=Screen>&ltbr></span></p>

<p class=Code> <span class=Screen>&ltbr></span></p>

<p class=Code>&lta href="" on<x>click='click1("close")'>CLOSE WINDOW&lt/a>&ltbr></p>

<p class=Code>&lt/BODY></p>

<p class=Code>&lt/HTML></p>

<p class=Code>%html%</td> </tr> </table><p>The Xbasic section starts with code to connect the JavaScript events to the Alpha Five environment.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim contextId&nbsp;as&nbsp;C</p>

<p class=Code>'Generate a unique ContextId for this script. The actual value of the contextId is meaningless.</p>

<p class=Code>'However, if multiple Xdialog windows are open simultaneously, then each must have a unique contextID</p>

<p class=Code>contextId = "ContextID" + remspecial("" + date()+ time()+ rand()* 1000)</p>

<p class=Code>xbasic_eval_context_add(contextId)</p>

<p class=Code>'replace the <strong>ContextId_Placeholder</strong> in the HTML with a real contextID</p>

<p class=Code>html_text = stritran(html_text,"<strong>ContextID_Placeholder</strong>",quote(contextId))</p>

<p class=Code>htmlObj.class="dhtmledit.dhtmledit"</p>

<p class=Code>'This creates an object that references the A5ContextEval COM component. This allows JavaScript to invoke Xbasic</p>

<p class=Code>dim o&nbsp;as&nbsp;ole::a5contexteval.contexteval</p>

<p class=Code>ole.class="dhtmledit.dhtmledit"</p>

<p class=Code>o.Attach(*xbasic_eval_context_attach())</td> </tr> </table><p>Next comes the Xdialog code that displays the HTML page.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_modeless_dlg_box(dlg_title, &lt&lt%dlg%</p>

<p class=Code>{can_exit=close}</p>

<p class=Code>{startup=init}</p>

<p class=Code>{activex=150,25htmlObj};</p>

<p class=Code>%dlg%, &lt&lt%code%</td> </tr> </table><p>These are the event handlers.</p>

<table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;">
<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;if a_dlg_button = "init"</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.ActivateActiveXControls = .T.</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.browsemode = .t.</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.appearance = 0</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.ScrollBars = .t.</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.documenthtml = html_text</p>
<p class=Code>&nbsp;end if</p>
<p class=Code>&nbsp;if a_dlg_button = "event1" then</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'this is the event handler for the JavaScript event when the user clicks on the link in the HTML</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Notice","User clicked link for event 1. This is an Xbasic script that has responded to the click on the HTML page.")</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.Refresh()</p>
<p class=Code>&nbsp;end if</p>
<p class=Code> <span class=Screen>&nbsp;if a_dlg_button = "event2" then</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'this is the event handler for the JavaScript event when the user clicks on the button in the HTML</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Notice","User clicked button for event 2. This is an Xbasic script that has responded to the click on the HTML page.")</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlObj.object.Refresh()</span></p>
<p class=Code> <span class=Screen>&nbsp;end if</span></p>
<p class=Code> <span class=Screen>&nbsp;if a_dlg_button = "close" then</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'this is the event handler for the JavaScript event when the user clicks on the 'Close Window' link in the HTML</span></p>
<p class=Code> <span class=Screen>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p class=Code> <span class=Screen>&nbsp;ui_modeless_dlg_close(dlg_title)</span></p>
<p class=Code> <span class=Screen>&nbsp;end if</span></p>
<p class=Code> <span class=Screen>&nbsp;%code%)</span></td>
</tr>
</table>

<p>This function is not strictly necessary, but it proves that <span class=Code1>event1</span> has fired.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION Evaluate_Button&nbsp;as&nbsp;V ( arg&nbsp;as&nbsp;C, vars&nbsp;as&nbsp;P )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'DESCRIPTION: Javascript/Xbasic event handler</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;WITH vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_event(dlg_title, arg, .T.)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END WITH</p>

<p class=Code>END FUNCTION</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="../../../References/ActiveX/ActiveX Examples.html" title="ActiveX Examples" class="wiki">ActiveX Examples</a></p>


<p class=A5>Limitations</p>

<p>Desktop applications only</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Responding+to+JavaScript+Events+on+an+HTML+Page">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending"} --->
</body></html>