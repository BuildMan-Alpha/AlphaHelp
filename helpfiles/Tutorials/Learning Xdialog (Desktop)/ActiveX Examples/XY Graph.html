	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>XY Graph</p>



<p>This example shows how to use the <span class=Screen>Microsoft Office</span> 
 Chart ActiveX Control.&nbsp; </p>



<p class=Pix><img src="images/XY_Graph.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 653px;
							height: 390px;
							float: none;
							border-style: none;
							border-style: none;"
					width=653
					height=390
					border=0></p>



<p class=A5>Example</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : To run this 
 sample Xdialog script, you must have <span class=Screen>Microsoft Office</span> 
 installed on your machine.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim vl&nbsp;as&nbsp;P</p>


<p class=Code>dim shared Chart&nbsp;as&nbsp;P</p>


<p class=Code>dim Graph&nbsp;as&nbsp;P</p>


<p class=Code>dim Graph.object&nbsp;as&nbsp;P</p>


<p class=Code>dim Graph.class&nbsp;as&nbsp;C</p>


<p class=Code>vl = local_variables()</p>


<p class=Code>'Define the Microsoft Office Chart ActiveX Control</p>


<p class=Code>Graph.class="owc.chart"</p>


<p class=Code>dlg_title = "X/Y Line Chart"</p>


<p class=Code>dlg_source = <<%dlg%</p>


<p class=Code>{can_exit=close}</p>


<p class=Code>{startup=init}</p>


<p class=Code>{lf};</p>


<p class=Code>{region001}</p>


<p class=Code>{stretch=height,width}</p>


<p class=Code>{sp}{activex=100,25Graph};</p>


<p class=Code>{stretch=}</p>


<p class=Code>{stickto=right,top}</p>


<p class=Code>{endregion001}</p>


<p class=Code>{region002}</p>


<p class=Code>{sp}<%i=$a5_window_close;O={J=C} {I=1} Close; %18,1.5&Close!close>{sp};</p>


<p class=Code>{endregion002}</p>


<p class=Code>%dlg%</td></tr>
</table>

<p>Add the event handlers for the buttons.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dlg_event = <<%code%</p>


<p class=Code>if (a_dlg_button = "close") .or. (a_dlg_button 
 = "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(dlg_title)</p>


<p class=Code>end if</p>


<p class=Code>if (a_dlg_button = "init") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</td></tr>
</table>

<p>Build the chart on the <span class=Code1>init</span> event. <span class=Code1>Series<a class="wiki"  href="2" rel="">2</a></span> 
 is an array of pointers. each element in the array contains information 
 about a data series that is plotted on the graph.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim Series<a class="wiki"  href="2" rel="">2</a>&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim Rows&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Rows = 25</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim XValue<a class="wiki"  href="Rows" rel="">Rows</a>&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim YValue1<a class="wiki"  href="Rows" rel="">Rows</a>&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim YValue2<a class="wiki"  href="Rows" rel="">Rows</a>&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' Add a chart to the graph object</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Chart = Graph.object.Charts.Add()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Chart.HasTitle = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Chart.Title.Caption = "X/Y Graph"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Chart.Type = 25 ' Scatter Line - 
 See the <a href="XY Graph.html#Complete_List_of_Supported_Chart_Types" title="XY Graph" class="wiki">Complete   List of Supported Chart Types</a>.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Chart.HasLegend = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' Create some random data for the 
 graph</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 to Rows</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XValue<a class="wiki"  href="i" rel="">i</a> 
 = i &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 Just a sequence 1..25</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YValue1<a class="wiki"  href="i" rel="">i</a> 
 = rand()* i + i ' A random number greater than i &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YValue2<a class="wiki"  href="i" rel="">i</a> 
 = rand()* i / 2 ' A random number smaller than i</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next i</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' Add the two series to the chart</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="1" rel="">1</a> = Chart.SeriesCollection.Add()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="1" rel="">1</a>.Caption = "Greater 
 Values"</td></tr>
</table>

<p><span class=Code1>SetData()</span> is a method call of the chart object. 
 The arguments passed in the first call to <span class=Code1>.SetData()</span> 
 are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>4, indicating that we are 
 setting an X value (see <a href="XY Graph.html#Complete_List_of_Supported_Data_Types" title="XY Graph" class="wiki">Complete   List of Supported Data Types</a> )</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>-1, indicating that the 
 data is being supplied directly, rather than from a data source</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>XValue, containing the 
 name of the array that contains the actual values.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="1" rel="">1</a>.SetData(4, -1, XValue) 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 X Values for Series 1</td></tr>
</table>

<p>The arguments passed in the second call to <span class=Code1>.SetData()</span> 
 are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>3, indicating that we are 
 setting an Y value (see <a href="XY Graph.html#Complete_List_of_Supported_Data_Types" title="XY Graph" class="wiki">Complete   List of Supported Data Types</a> )</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>-1, indicating that the 
 data is being supplied directly, rather than from a data source</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>YValue, containing the 
 name of the array that contains the actual values.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="1" rel="">1</a>.SetData(4, -1, XValue) 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 X Values for Series 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="2" rel="">2</a> = Chart.SeriesCollection.Add()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="2" rel="">2</a>.Caption = "Lesser 
 Values"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="2" rel="">2</a>.SetData(4, -1, XValue) 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 X Values</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Series<a class="wiki"  href="2" rel="">2</a>.SetData(3, -1, YValue2) 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 Y Values</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Graph.object.Refresh()</p>


<p class=Code>end if</p>


<p class=Code>%code%</p>


<p class=Code>ui_modeless_dlg_box(dlg_title, dlg_source, dlg_event)</td></tr>
</table>

<p class=A5><a name=Complete_List_of_Supported_Chart_Types>Complete List 
 of Supported Chart Types</a></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>'chChartTypeColumnClustered = 0,</p>


<p class=Code>'chChartTypeColumnStacked = 1,</p>


<p class=Code>'chChartTypeColumnStacked100 = 2,</p>


<p class=Code>'chChartTypeBarClustered = 3,</p>


<p class=Code>'chChartTypeBarStacked = 4,</p>


<p class=Code>'chChartTypeBarStacked100 = 5,</p>


<p class=Code>'chChartTypeLine = 6,</p>


<p class=Code>'chChartTypeLineStacked = 8,</p>


<p class=Code>'chChartTypeLineStacked100 = 10,</p>


<p class=Code>'chChartTypeLineMarkers = 7,</p>


<p class=Code>'chChartTypeLineStackedMarkers = 9,</p>


<p class=Code>'chChartTypeLineStacked100Markers = 11,</p>


<p class=Code>'chChartTypeSmoothLine = 12,</p>


<p class=Code>'chChartTypeSmoothLineStacked = 14,</p>


<p class=Code>'chChartTypeSmoothLineStacked100 = 16,</p>


<p class=Code>'chChartTypeSmoothLineMarkers = 13,</p>


<p class=Code>'chChartTypeSmoothLineStackedMarkers = 15,</p>


<p class=Code>'chChartTypeSmoothLineStacked100Markers = 17,</p>


<p class=Code>'chChartTypePie = 18,</p>


<p class=Code>'chChartTypePieExploded = 19,</p>


<p class=Code>'chChartTypePieStacked = 20,</p>


<p class=Code>'chChartTypeScatterMarkers = 21,</p>


<p class=Code>'chChartTypeScatterLine = 25,</p>


<p class=Code>'chChartTypeScatterLineMarkers = 24,</p>


<p class=Code>'chChartTypeScatterLineFilled = 26,</p>


<p class=Code>'chChartTypeScatterSmoothLine = 23,</p>


<p class=Code>'chChartTypeScatterSmoothLineMarkers = 22,</p>


<p class=Code>'chChartTypeBubble = 27,</p>


<p class=Code>'chChartTypeBubbleLine = 28,</p>


<p class=Code>'chChartTypeArea = 29,</p>


<p class=Code>'chChartTypeAreaStacked = 30,</p>


<p class=Code>'chChartTypeAreaStacked100 = 31,</p>


<p class=Code>'chChartTypeDoughnut = 32,</p>


<p class=Code>'chChartTypeDoughnutExploded = 33,</p>


<p class=Code>'chChartTypeRadarLine = 34,</p>


<p class=Code>'chChartTypeRadarLineMarkers = 35,</p>


<p class=Code>'chChartTypeRadarLineFilled = 36,</p>


<p class=Code>'chChartTypeRadarSmoothLine = 37,</p>


<p class=Code>'chChartTypeRadarSmoothLineMarkers = 38,</p>


<p class=Code>'chChartTypeStockHLC = 39,</p>


<p class=Code>'chChartTypeStockOHLC = 40,</p>


<p class=Code>'chChartTypePolarMarkers = 41,</p>


<p class=Code>'chChartTypePolarLine = 42,</p>


<p class=Code>'chChartTypePolarLineMarkers = 43,</p>


<p class=Code>'chChartTypePolarSmoothLine = 44,</p>


<p class=Code>'chChartTypePolarSmoothLineMarkers = 45</td></tr>
</table>

<p class=A5><a name=Complete_List_of_Supported_Data_Types>Complete List 
 of Supported Data Types</a></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>SetData(type, datasourceindex, array)</p>


<p class=Code>' Values for type of data being set</p>


<p class=Code>'chDimSeriesNames = 0,</p>


<p class=Code>'chDimCategories = 1,</p>


<p class=Code>'chDimValues = 2,</p>


<p class=Code>'chDimYValues = 3,</p>


<p class=Code>'chDimXValues = 4,</p>


<p class=Code>'chDimOpenValues = 5,</p>


<p class=Code>'chDimCloseValues = 6,</p>


<p class=Code>'chDimHighValues = 7,</p>


<p class=Code>'chDimLowValues = 8,</p>


<p class=Code>'chDimBubbleValues = 9,</p>


<p class=Code>'chDimRValues = 10,</p>


<p class=Code>'chDimThetaValues = 11</td></tr>
</table>

<p class=A5>Next</p>



<p><a href="Pie Chart.html" title="Pie Chart" class="wiki">Pie Chart</a></p>



<p class=A5>See Also</p>



<p><a href="../../../References/ActiveX/ActiveX Examples.html" title="ActiveX Examples" class="wiki">ActiveX Examples</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:XY+Graph">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,xdialog,chart","group":"/Guide/Desktop/Design/View/Chart/"} --->
</body></html>