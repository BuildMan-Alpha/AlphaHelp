	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Creating and Using a Multi-state Button</p>

<p>The <span class=Control>MULSTBTN1</span> multi-state button presents 
 a simple way to limit the <span class=Control>Browse1</span> list to those 
 records where the <span class=Control>SearchBy</span> field begins with 
 the selected letter. </p>

<p class=Pix><img src="images/AL_form_customer_information_mulstbtn1.gif"
					style="width: 523px;
							height: 29px;
							border-style: none;
							border-style: none;"
					width=523
					height=29
					border=0></p>



<p class=A5>Multi-State Button Options</p>



<p>Multi-state buttons are similar in purpose to list boxes.</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The user can select one 
 of several pre-defined values.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The control always displays 
 the selected value.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The display value and the 
 stored value can be different.</p>

</li>
</ul>

<p>The primary differences from a list box are that the multi-state button:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Displays a button for each 
 of the pre-defined values.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Can have vertical or horizontal 
 orientations.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Can substitute bitmap images 
 for text.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Can change the bitmap when 
 the button is clicked.</p>

</li>
</ul>

<p class=A5>Procedure: Configuring the MULSTBTN1 Multi-State Button <a 
 NAME=Procedure__Configuring_the_MULSTBTN1_Multi-State_Button></a></p>



<p>The following procedure assumes that the developer has opened the form 
 in the <span class=Screen>Form Editor.</span> Follow these instructions 
 to create a multi-state button similar to <span class=Control>MULSTBTN1</span> 
 :</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Draw a multi-state 
 button on the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the control 
 and select <span class=Button>Properties...</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Field</span> 
 list select the appropriate field in your table or variable on your form. 
 In this case the user selection is stored into the variable vcLetter. 
 </p>

</li>
</ol>

<p class=Pix><img src="images/AL_form_customer_information_mulstbtn1_setup.gif"
					style="border-style: none;
							border-style: none;
							width: 436px;
							height: 185px;"
					width=436
					height=185
					border=0></p>



<ol START=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Choices</span> 
 tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Text 
 only" in the <span class=Control>Display</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter your choices 
 in the large type-In box, one line per entry. You only need to enter the 
 first character of each line. Alpha Anywhere will add the rest. The pipe "|" 
 character separates the display value (the character on the left) from 
 the stored value (the character on the right). In this case, both the 
 display and stored values are the same, but they may be different. <a HREF="http://support.alphasoftware.com/imagesV8/AL_form_customer_information_mulstbtn1_choices.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>

</li>
</ol>

<p class=Pix><img src="images/AL_Form_customer_information_mulstbtn1_choices.gif"
					style="border-style: none;
							border-style: none;
							width: 436px;
							height: 510px;"
					width=436
					height=510
					border=0></p>



<ol START=8>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>OK</span> 
 button to return to the <span class=Screen>Form Editor</span>.</p>

</li>
</ol>

<p class=A5>Xbasic Code Run by the MULSTBTN1 on<x>change Event</p>



<p>The <span class=Control>MULSTBTN1</span> <span class=Code1>on<x>change</span> 
 event redefines the filter and order expressions for the customer table, 
 queries the table, and, if no records were found, displays the entire 
 table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>topparent:tables:customer.filter_expression = "left("+searchby.text+", 
 1) = '" + mulstbtn1.text + "'"</p>


<p class=Code>topparent:tables:customer.order_expression = searchby.text</p>


<p class=Code>topparent:tables:customer.query()</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>i = tbl.index_primary_get()</p>


<p class=Code>count = i.records_get()</p>


<p class=Code>if count = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Warning", "No 
 records found. Showing all records")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.order(searchby.text,searchby.text 
 + " <> \"\"")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;browse1.refresh()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;mulstbtn1.text = "1"</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>An Explanation of the Code</p>



<p>The first line creates a pointer variable named <span class=Code1>tbl</span> 
 to refer to table (and the data) that the <span class=Screen>Customer 
 Information</span> form displays.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</td></tr>
</table>

<p>The next line sets the <span class=Code1>filter_expression</span> property 
 of the form: <span class=Code1>topparent:tables:customer</span>. This 
 works when you know the name of the table. The code sets the <span class=Code1>filter_expression</span> 
 to be the first character selected field ( <span class=Code1>searchby.text</span> 
 ).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>topparent:tables:customer.filter_expression = "left("+searchby.text+", 
 1) = '" + mulstbtn1.text + "'"</td></tr>
</table>

<p>This line sets the <span class=Code1>order_expression</span> property 
 of the form. It says to order the query results on the field defined by 
 <span class=Code1>searchby.text</span>. The default sort order is ascending.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>topparent:tables:customer.order_expression = searchby.text</td></tr>
</table>

<p>The next line executes a new query against the customer table. The <span 
 class=Code1>query()</span> method knows to use the <span class=Code1>filter_expression</span> 
 and <span class=Code1>order_expression</span> properties of the form.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>topparent:tables:customer.query()</td></tr>
</table>

<p>This line sets the <span class=Code1>tbl</span> pointer equal to the 
 customer table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</td></tr>
</table>

<p>Next, we get a pointer to the table's primary index. The variable <span 
 class=Code1>i</span> is implicitly dimmed&nbsp;as&nbsp; <span class=Code1>P</span> 
 (a pointer).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>i = tbl.index_primary_get()</td></tr>
</table>

<p>The <span class=Code1>records_get()</span> method returns a count of 
 records for the table. The variable <span class=Code1>count</span> is 
 implicitly dimmed&nbsp;as&nbsp; <span class=Code1>N</span> (numeric).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>count = i.records_get()</td></tr>
</table>

<p>If the count variable is equal to 0, then display a message box that 
 the query is empty.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (count = 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Warning", "No 
 records found. Showing all records")</td></tr>
</table>

<p>The <span class=Code1>order()</span> method sorts the table (parameter 
 one) on <span class=Code1>searchby.text</span>, which is the name of a 
 field, and restricts the results (parameter two) to records not equal 
 to NULL. The backslash <span class=Code1>\</span> escape character precedes 
 the quote <span class=Code1>"</span> character to show that the quote 
 is to be interpreted&nbsp;as&nbsp;a character and not&nbsp;as&nbsp;Part 
 of the syntax.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.order(searchby.text,searchby.text 
 + " <> \"\"")</td></tr>
</table>

<p>Force <span class=Control>browse1</span> to display the new results.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;browse1.refresh()</td></tr>
</table>

<p>Reset the <span class=Control>MULSTBTN1</span> multi-state button. Chose 
 '1' because it is not in the set A-Z and thereby de-selects any previously 
 selected letter.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;mulstbtn1.text = "1"</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="Creating a Button that Calls an Action Script.html" title="Creating a Button that Calls an Action Script" class="wiki">Creating   a Button that Calls an Action Script</a>, <a href="Creating a Button that Calls an Xbasic Script.html" title="Creating a Button that Calls an Xbasic Script" class="wiki">Creating   a Button that Calls an Xbasic Script</a>, <a href="Creating a Button with a Bitmap.html" title="Creating a Button with a Bitmap" class="wiki">Creating   a Button with a Bitmap</a>, <a href="../../../Unclassified/Using Action Script to Select a Record and Display a Form.html" title="Using Action Script to Select a Record and Display a Form" class="wiki">Using   Action Script to Select a Record and Display a Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+and+Using+a+Multi-state+Button">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,xbasic,xdcontrol","group":"/Guide/Desktop/Design/View/Xdialog/Controls/Buttons"} --->
</body></html>