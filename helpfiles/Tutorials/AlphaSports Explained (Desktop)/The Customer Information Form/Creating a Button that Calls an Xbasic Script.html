	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Creating a Button that Calls an Xbasic Script</p>



<p>The <span class=Control>Button4</span> button provides a quick way to 
 reset the form's record selection so that it includes all the records 
 of the Customer table. </p>



<p class=Pix><img src="images/AL_form_customer_information_button2.gif"
					style="width: 62px;
							height: 24px;
							margin-top: 0px;
							margin-bottom: 0px;
							margin-left: 0px;
							margin-right: 0px;
							border-style: none;
							vertical-align: baseline;"
					width=62
					height=24
					align=bottom
					border=0></p>



<p class=A5>Procedure: Configuring the Button4 Button <a NAME=Procedure__Configuring_the_Button4_Button></a></p>



<p>The following procedure assumes that the developer has opened the form 
 in the <span class=Screen>Form Editor</span>. Follow these instructions 
 to create a button similar to <span class=Control>Button4</span> :</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Place a button on 
 the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>On the resulting 
 <span class=Screen>Define Button</span> dialog box enter "All" 
 in the <span class=Control>Label</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Use 
 Xbasic Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Next&nbsp;></span> 
 button. </p>

</li>
	
	<p class=Pix><img src="images/AL_form_customer_information_button4_create0.gif"
						style="width: 481px;
								height: 449px;
								border-style: none;
								border-style: none;"
						width=481
						height=449
						border=0></p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Launch 
 Script Editor</span> button to display the <span class=Screen>Code Editor</span> 
 and to start writing Xbasic code.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Code 
 Editor</span> and save your code (refer to ((|#Procedure__Configuring_the_Button4_Button|Button4   OnPushEvent)) ).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Finish</span> 
 button.</p>

</li>
</ol>

<p class=A5>Xbasic Code Run by the Button4 OnPush Event <a NAME=Button4_OnPush_Event_Xbasic_Code></a></p>



<p>The <span class=Control>Button4</span> <span class=Code1>OnPush</span> 
 event button resets the <span class=Control>MULSTBTN1</span> multi-state 
 button so that no letters are selected, refreshes <span class=Control>Browse1</span> 
 to display an unfiltered list, and refreshes the fields bound to the Customer 
 table to display the first record listed in <span class=Control>Browse1.</span></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx as P</p>


<p class=Code>dim count as N</p>


<p class=Code>&nbsp;</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>tbl.order(searchby.text, searchby.text + " <> 
 ''")</p>


<p class=Code>mulstbtn1.text = "1"</p>


<p class=Code>&nbsp;</p>


<p class=Code>indx = tbl.index_primary_get()</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>if (count > 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent.allow_change(.T.)</p>


<p class=Code>end if</p>


<p class=Code>&nbsp;</p>


<p class=Code>browse1.refresh()</td></tr>
</table>

<p class=A5>An Explanation of the Code</p>



<p>The first line creates a pointer variable named <span class=Code1>tbl</span> 
 to refer to table (and the data) that the <span class=Screen>Customer 
 Information</span> form displays. The second line creates a pointer named 
 <span class=Code1>indx</span> to refer to the index selected by <span 
 class=Code1>tbl.index_primary_get()</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx as P</td></tr>
</table>

<p>Each form is based upon a table (or set). The <span class=Screen>Customer 
 Information</span> form is based on the Customer table. This line points 
 <span class=Code1>tbl</span> at the Customer table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</td></tr>
</table>

<p>The next line sorts the table using the field that was selected by the 
 <span class=Control>searchby</span> combo box. <span class=Code1>searchby.text</span> 
 is the field that will be retrieved. <span class=Code1>searchby.text + 
 " <> ''"</span> is a character expression restricts (filters) 
 the records that will be returned. It evaluates to: <span class=Code1>searchby.text 
 <> ''.</span></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.order(searchby.text,&nbsp;searchby.text + " <> 
 ''")</td></tr>
</table>

<p>The <span class=Control>MULSTBTN1</span> multi-state button allows the 
 user to further filter the contents of <span class=Control>Browse1</span> 
 to be only those records beginning with the selected record. This line 
 de-selects the current selection, if any, so that all records selected 
 by the above filter expression will appear. It does this by choosing "1", 
 which is not a valid member of the A to Z set.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>mulstbtn1.text = "1"</td></tr>
</table>

<p>Get a pointer to the table's primary index. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>indx = t.index_primary_get()</td></tr>
</table>

<p>Get the current record count. The variable "i" is implicitly 
 dimmed&nbsp;as&nbsp;Numeric.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>count = indx.records_get()</td></tr>
</table>

<p>If we found some records then we can re-enable change/enter mode.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (count > 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent.allow_change(.T.)</p>


<p class=Code>end if</td></tr>
</table>

<p>Force <span class=Control>Browse1</span> to display its new contents.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>browse1.refresh()</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="Creating a Button that Calls an Action Script.html" title="Creating a Button that Calls an Action Script" class="wiki">Creating   a Button that Calls an Action Script</a>, <a href="Creating a Button with a Bitmap.html" title="Creating a Button with a Bitmap" class="wiki">Creating   a Button with a Bitmap</a>, <a href="Creating and Using a Multi-state Button.html" title="Creating and Using a Multi-state Button" class="wiki">Creating   and Using a Multi-state Button</a>, U <a href="../../../Unclassified/Using Action Script to Select a Record and Display a Form.html" title="Using Action Script to Select a Record and Display a Form" class="wiki">sing   Action Script to Select a Record and Display a Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+a+Button+that+Calls+an+Xbasic+Script">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,form,xdcontrol","group":"/Guide/Desktop/Design/View/Form/"} --->
</body></html>