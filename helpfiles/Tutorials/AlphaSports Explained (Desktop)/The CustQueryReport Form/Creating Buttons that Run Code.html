	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Creating Buttons that Run Code</p>



<p><span class=Control>Button1</span> , <span class=Control>Button2</span> 
 and <span class=Control>Button3</span> demonstrate how to move an Alpha 
 Five function onto a button on a form by attaching an Action Script or 
 a developer created script:</p>




<div align=left>
<table style="float: alignleft;
				margin-top: 14pt;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Button</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Action Script</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Xbasic Equivalent</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>Button1</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft><span class=Code1>script_play_local("cust_rep_queried")</span></td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>Button2</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>Query By Form</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft><span class=Code1>topparent.Query_By_Form()</span></td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>Button3</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft>Show All Records</td>
<td class="TableCell" style="x-cell-content-align: CENTER;" valign="middle">
<p class=TableLeft><span class=Code1>topparent.show_all()</span></td></tr>
</table>
</div>
<p class=A5>Procedure: Creating a Button with an Action Script <a NAME=Procedure__Creating_a_Button_with_an_Action_Script></a></p>



<p>The following procedure assumes that the developer has opened the form 
 in the <span class=Screen>Form Editor.</span> Follow these instructions 
 to create a button similar to <span class=Control>Button3</span> :</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the Button 
 tool on the toolbar and sketch the new button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the label of 
 the button in the <span class=Control>Label</span> type-in box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the resulting 
 <span class=Screen>Define Button</span> dialog box accept the default 
 values for <span class=Control>Define script for this button now?</span> 
 and <span class=Control>Use Action Scripting</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Next&nbsp;></span> 
 button. </p>

</li>
</ol>

<p class=Pix><img src="images/AL_form_custqueryreport_button3_create0.gif"
					style="border-style: none;
							width: 481px;
							height: 449px;
							border-style: none;"
					width=481
					height=449
					border=0></p>



<ol START=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the resulting 
 <span class=Screen>Select Action</span> dialog box select "Query" 
 from the <span class=Control>Category</span> list and "Query by Form" 
 from the <span class=Control>Action</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>OK</span> 
 button. </p>

</li>
</ol>

<p class=Pix><img src="images/AL_form_custqueryreport_button3_create1.gif"
					style="border-style: none;
							width: 623px;
							height: 486px;
							border-style: none;"
					width=623
					height=486
					border=0></p>



<ol START=7>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Finish</span> 
 button in the <span class=Screen>Script Genie</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Finish</span> 
 button in the <span class=Screen>Define Button</span> dialog box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The Action Script 
 is automatically attached to the button's <span class=Code1>OnPush</span> 
 event.</p>

</li>
</ol>

<p class=A5>Procedure: Creating and Attaching a Script to a Button <a NAME=Procedure__Creating_and_Attaching_a_Script_to_a_Button></a></p>



<p>The following procedure assumes that the developer has opened the form 
 in the <span class=Screen>Form Editor.</span> Follow these instructions 
 to create a button similar to <span class=Control>Button1</span> :</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the Button 
 tool on the toolbar and sketch the new button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the label of 
 the button in the <span class=Control>Label</span> type-in box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the resulting 
 <span class=Screen>Define Button</span> dialog box accept the default 
 value for <span class=Control>Define script for this button now?</span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Launch 
 Script Editor</span> button. </p>

</li>
</ol>

<p class=Pix><img src="images/AL_form_custqueryreport_button1_create0.gif"
					style="border-style: none;
							width: 481px;
							height: 449px;
							border-style: none;"
					width=481
					height=449
					border=0></p>



<ol START=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 Xbasic code.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>current_filter = current_filter_expn()</p>


<p class=Code>current_order = current_order_expn()</p>


<p class=Code>query.filter = current_filter</p>


<p class=Code>query.order = current_order</p>


<p class=Code>if (vcLayoutType = "reports") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.preview(vcReports, query.filter, 
 query.order)</p>


<p class=Code>else if (vcLayoutType = "letters") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;letter.preview(vcLetters, query.filter, 
 query.order)</p>


<p class=Code>else if (vcLayoutType = "labels") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;label.preview(vclabels, query.filter, 
 query.order)</p>


<p class=Code>end if</td></tr>
</table>

<ol START=6>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Save</span> 
 button and the <span class=Button>Close (X)</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The script is automatically 
 attached to the button's <span class=Code1>OnPush</span> event.</p>

</li>
</ol>

<p>You can further edit the script after opening it up from the <span class=Screen>Code</span> 
 tab of the <span class=Screen>Control Panel</span>.</p>



<p class=A5>An Explanation of the Code</p>



<p>The <span class=Control>Preview</span> button on <span class=Screen>CustQueryReport</span> 
 form calls this Xbasic code. The purpose of this routine is to preview 
 the appropriate type of layout, using the primary table's current filter 
 and order expressions. The first step is to return the filter expression 
 of the primary table. The variable <span class=Code1>current_filter</span> 
 is implicitly dimmed&nbsp;as&nbsp;C (character).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>current_filter = current_filter_expn()</td></tr>
</table>

<p>Next the routine gets the order expression of the primary table. The 
 variable <span class=Code1>current_order</span> is implicitly dimmed&nbsp;as&nbsp;C 
 (character).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>current_order = current_order_expn()</td></tr>
</table>

<p>This statement sets the value of the <span class=Code1>query.filter</span> 
 variable, the second argument of the <span class=Code1>preview()</span> 
 method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>query.filter = current_filter</td></tr>
</table>

<p>This statement sets the value of the <span class=Code1>query.order</span> 
 variable, the third argument of the <span class=Code1>preview()</span> 
 method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>query.order = current_order</td></tr>
</table>

<p>The value of <span class=Code1>vcLayoutType</span> variable,&nbsp;as&nbsp;set 
 by the <span class=Control>DROPDOWN1</span> list box, defines the first 
 argument of the <span class=Code1>preview()</span> method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (vcLayoutType = "reports") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.preview(vcReports, query.filter, 
 query.order)</p>


<p class=Code>else if (vcLayoutType = "letters") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;letter.preview(vcLetters, query.filter, 
 query.order)</p>


<p class=Code>else if (vcLayoutType = "labels") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;label.preview(vclabels, query.filter, 
 query.order)</p>


<p class=Code>end if</td></tr>
</table>

<p>A more compact version of the same Xbasic routine would be:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (vcLayoutType = "reports") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.preview(vcReports, current_filter_expn(), 
 current_order_expn())</p>


<p class=Code>else if (vcLayoutType = "letters") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;letter.preview(vcLetters, current_filter_expn(), 
 current_order_expn())</p>


<p class=Code>else if (vcLayoutType = "labels") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;label.preview(vclabels, current_filter_expn(), 
 current_order_expn())</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../The CustQueryReport Form.html" title="The CustQueryReport Form" class="wiki">The CustQueryReport Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+Buttons+that+Run+Code">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,xdcontrol,asports","group":"/Guide/Desktop/Design/View/Xdialog/Controls/Buttons"} --->
</body></html>