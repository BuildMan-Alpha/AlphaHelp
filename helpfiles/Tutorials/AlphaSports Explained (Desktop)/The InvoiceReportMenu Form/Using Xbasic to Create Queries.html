	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using Xbasic to Create Queries</p>



<p>The <span class=Control>RADIO2</span> option button asks the user whether 
 to preview or print, and stores the result into a form variable named 
 <span class=Code1>print_option</span>. <span class=Control>BUTTON1</span> 
 executes an Xbasic routine that examines all these variables and calls 
 the appropriate preview or print functions.</p>



<p class=A5>Xbasic Code Run by the Button1 OnPush Event <a NAME=Dynamically_Create_a_Filter_with_Xbasic></a></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (option = 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "date = [varD->today]"</p>


<p class=Code>else if (option = 2) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "between(date, [varD->begindate], 
 [varD->enddate])"</p>


<p class=Code>else if (option = 3) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list_invno = stritran(invoice_numbers,",",crlf())</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list_invo = alltrim(list_invno)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;filter = *for_each(x, "invoice_number 
 = " + quote(x) ,list_invo)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = alltrim(filter)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = stritran(filter, crlf(), 
 " .or. ")</p>


<p class=Code>else if (option = 4) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "between(invoice_number, 
 [varC->begin_inv], [varC->end_inv])"</p>


<p class=Code>end if</p>


<p class=Code>filter = replace_parameters(filter, local_variables())</p>


<p class=Code>if (print_option = "preview") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.preview("Invoice", 
 filter)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.print("invoice", 
 filter)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>An Explanation of the Xbasic Code</p>



<p>The <span class=Control>RADIO1</span> option buttons set the value of 
 a form variable named <span class=Code1>option</span>. The value 1 corresponds 
 to the "Today's Invoices" selection. If <span class=Code1>option</span> 
 is equal to 1, we set the <span class=Code1>filter</span> variable equal 
 to the expression <span class=Code1>"date = [varD->today]"</span>, 
 where <span class=Code1>today</span> is a field initialized to the current 
 date.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (option = 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "date = [varD->today]"</td></tr>
</table>

<p>The "Range of Dates" selection corresponds to <span class=Code1>option</span> 
 equal to 2. In this case we set filter equal to the expression <span class=Code1>"between(date, 
 [varD->begindate], [varD->enddate])"</span>. The <span class=Code1>between()</span> 
 function returns <span class=Code1>true</span> if the first argument, 
 <span class=Code1>date</span>, is between the values of the second and 
 third arguments, the <span class=Code1>begindate</span> and <span class=Code1>enddate</span> 
 fields.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>else if (option = 2) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "between(date, [varD->begindate], 
 [varD->enddate])"</td></tr>
</table>

<p>The "Specific Invoice Number(s)" selection corresponds to 
 <span class=Code1>option</span> equal to 3. The <span class=Code1>stritran()</span> 
 function replaces each comma in the <span class=Code1>invoice_numbers</span> 
 field with the carriage return and line feed characters. The result is 
 saved into the <span class=Code1>list_invno</span> character variable.</p>




<div align=center>
<table style="margin-top: 14pt;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				x-cell-content-align: Top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Before</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>After</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A001, A002, A003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A001 <img src="images/return_arrow.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 10px;
									height: 10px;
									float: none;
									border-style: none;
									border-style: none;"
							width=10
							height=10
							border=0></p>


<p class=TableLeft>A002 <img src="images/return_arrow.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 10px;
									height: 10px;
									float: none;
									border-style: none;
									border-style: none;"
							width=10
							height=10
							border=0></p>


<p class=TableLeft>A003</td></tr>
</table>
</div>
<p class=BlankLine>&nbsp;</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>else if (option = 3) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list_invno = stritran(invoice_numbers,",",crlf())</td></tr>
</table>

<p>The <span class=Code1>alltrim()</span> function removes any leading 
 or trailing spaces.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list_invo = alltrim(list_invno)</td></tr>
</table>

<p>The <span class=Code1>*for_each()</span> function adds <span class=Code1>"invoice_number 
 = "</span> to each line, places quotes around the invoice number, 
 and saves the results into the <span class=Code1>filter</span> variable.</p>




<div align=center>
<table style="margin-top: 14pt;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Before</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>After</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A001 <img src="images/return_arrow.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 10px;
									height: 10px;
									float: none;
									border-style: none;
									border-style: none;"
							width=10
							height=10
							border=0></p>


<p class=TableLeft>A002 <img src="images/return_arrow.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 10px;
									height: 10px;
									float: none;
									border-style: none;
									border-style: none;"
							width=10
							height=10
							border=0></p>


<p class=TableLeft>A003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>invoice_number&nbsp;=&nbsp;"A001"</p>


<p class=TableLeft>invoice_number&nbsp;=&nbsp;"A002"</p>


<p class=TableLeft>invoice_number&nbsp;=&nbsp;"A003"</td></tr>
</table>
</div>
<p class=BlankLine>&nbsp;</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;filter = *for_each(x, "invoice_number 
 = " + quote(x) ,list_invo)</td></tr>
</table>

<p>The <span class=Code1>alltrim()</span> function again removes any leading 
 or trailing spaces.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;filter = alltrim(filter)</td></tr>
</table>

<p>The <span class=Code1>stritran()</span>function again reformats the 
 data to substitute <span class=Code1>".or."</span> for each 
 pair of carriage return and line feed characters.</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col style="width: 182px;">
<col style="width: 491px;">

<tr>
<td class="tableHeader" style="x-cell-content-align: top; width: 182px;" valign="top" width="182px">
<p class=TableHead>Before</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 491px;" valign="top" width="491px">
<p class=TableHead>After</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; width: 182px;" valign="top" width="182px">
<p class=TableLeft>invoice_number&nbsp;=&nbsp;"A001"&nbsp;<img 
 src="images/return_arrow.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 10px;
			height: 10px;
			float: none;
			border-style: none;
			border-style: none;"
	width=10
	height=10
	border=0></p>


<p class=TableLeft>invoice_number = "A002" <img src="images/return_arrow.gif"
															x-maintain-ratio=TRUE
															style="border: none;
	width: 10px;
	height: 10px;
	float: none;
	border-style: none;
	border-style: none;"
															width=10
															height=10
															border=0>invoice_number 
 = "A003"</td>
<td class="TableCell" style="width: 491px; x-cell-content-align: top;" valign="top" width="491px">
<p class=TableLeft>invoice_number = "A001" .or. invoice_number 
 = "A002" .or. invoice_number = "A003"</td></tr>
</table>
</div>
<p class=BlankLine>&nbsp;</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;filter = stritran(filter, crlf(), " 
 .or. ")</td></tr>
</table>

<p>The "Range of Invoice Numbers" selection corresponds to <span 
 class=Code1>option</span> equal to 4. The <span class=Code1>between()</span> 
 function returns true if an invoice number is between the <span class=Code1>begin_inv</span> 
 and <span class=Code1>end_inv</span> field values.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>else if (option = 4) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = "between(invoice_number, 
 [varC->begin_inv], [varC->end_inv])"</p>


<p class=Code>end if</td></tr>
</table>

<p>The <span class=Code1>replace_parameters()</span> function inserts the 
 actual values of the referenced variables into the filter expression. 
 The reason that this function is necessary is that the variables only 
 have local session scope and cannot be resolved by the <span class=Code1>preview()</span> 
 and <span class=Code1>print()</span> functions. An alternative solution 
 that would not require the use of <span class=Code1>replace_parameters</span> 
 would be to first declare the variables&nbsp;as&nbsp;shared.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>filter = replace_parameters(filter, local_variables())</td></tr>
</table>

<p>Finally, we call the appropriate function depending on the value of 
 the <span class=Code1>print_option</span> variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (print_option = "preview") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.preview("Invoice", 
 filter)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report.print("invoice", 
 filter)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="Creating and Programming a Hotspot with Action Scripting.html" title="Creating and Programming a Hotspot with Action Scripting" class="wiki">Creating   and Programming a Hotspot with Action Scripting</a>, <a href="Creating and Programming Hotspots with Xbasic.html" title="Creating and Programming Hotspots with Xbasic" class="wiki">Creating   and Programming Hotspots with Xbasic</a>, <a href="../The InvoiceReportMenu Form.html" title="The InvoiceReportMenu Form" class="wiki">The   InvoiceReportMenu Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Xbasic+to+Create+Queries">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide,xbasic","group":"/Guide/Desktop/Design/Platform/Xbasic/"} --->
</body></html>