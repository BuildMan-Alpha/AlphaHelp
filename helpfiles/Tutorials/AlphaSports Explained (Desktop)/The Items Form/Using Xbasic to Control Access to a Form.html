	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using Xbasic to Control Access to a Form</p>



<p>The <span class=Screen>Invoice</span> form contains the <span class=Control>btnEditItems0</span> 
 ( <span class=Button>Zoom ...</span> ) button. The Xbasic code run by 
 the button's <span class=Code1>OnPush</span> event creates and sets the 
 value of the global variable <span class=Code1>varInvoice_Number</span>, 
 then displays the <span class=Screen>Items</span> form (from the AlphaSports 
 sample database). The result is that the global variable <span class=Code1>varInvoice_Number</span> 
 only exists when the <span class=Screen>Items</span> form is called by 
 the <span class=Screen>Invoice</span> form.</p>



<p class=A5>Xbasic Code Run by the btnEnter OnPush Event</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (eval_valid("varInvoice_Number") = .t.) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:invoice_number.enable()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent.New_Record()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Invoice_Number.text = varInvoice_Number</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Invoice_Number.disable()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Product_Id.activate()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;btnEnter.hide()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;btnSave.show()</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = "You can only use this 
 form to enter a new line item if you open it from a button on the Invoice 
 form."</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error",msg,UI_STOP_SYMBOL)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>Xbasic Code Run by the btnEnter OnPush Event</p>



<p>The first line of code uses the <span class=Code1>eval_valid()</span> 
 function to see if the <span class=Code1>varInvoice_Number</span> variable 
 can be evaluated, which is the same&nbsp;as&nbsp;saying that the variable 
 exists. The variable only exists if the <span class=Screen>Invoice</span> 
 form created it before opening the <span class=Screen>Items</span> form.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (eval_valid("varInvoice_Number") = .t.) then</td></tr>
</table>

<p>If the above expression evaluates to true, enable the <span class=Code1>invoice_number</span> 
 field so it can receive focus and be edited.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:invoice_number.enable()</td></tr>
</table>

<p>Create a new record.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent.New_Record()</td></tr>
</table>

<p>Set the value of the <span class=Code1>invoice_number</span> field to 
 <span class=Code1>varInvoice_Number</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Invoice_Number.text = varInvoice_Number</td></tr>
</table>

<p>Disable the <span class=Code1>invoice_number</span> field so it cannot 
 be edited.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Invoice_Number.disable()</td></tr>
</table>

<p>Set focus to the <span class=Code1>product_id</span> field so it can 
 accept data.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;topparent:Product_Id.activate()</td></tr>
</table>

<p>Hide this button, which is named <span class=Code1>btnEnter</span> (Enter 
 New Item).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;btnEnter.hide()</td></tr>
</table>

<p>Show the other button in the stack.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;btnSave.show()</td></tr>
</table>

<p>If we couldn't evaluate the <span class=Code1>varInvoice_Number</span> 
 variable, display an error message.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = "You can only use this 
 form to enter a new line item if you open it from a button on the Invoice 
 form."</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error",msg,UI_STOP_SYMBOL)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>Xbasic Code Run by the btnSave OnPush Event</p>



<p>The <span class=Code1>btnSave</span> <span class=Code1>OnPush</span> 
 event is the same&nbsp;as&nbsp;the <span class=Control>btnEnter</span> 
 <span class=Code1>OnPush</span> event, except the it hides <span class=Control>btnSave</span> 
 and shows <span class=Control>bntEnter</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>.</p>


<p class=Code>' Show btnEnter (Enter New Item)</p>


<p class=Code>btnEnter.show()</p>


<p class=Code>' Hide btnSave (Save Record)</p>


<p class=Code>btnSave.hide()</p>


<p class=Code>.</p>


<p class=Code>.</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../The InvoiceReportMenu Form/Using Xbasic to Create Queries.html" title="Using Xbasic to Create Queries" class="wiki">Using Xbasic to Create   Queries</a>, <a href="../Using Xbasic to Select a Record and Display a Form.html" title="Using Xbasic to Select a Record and Display a Form" class="wiki">Using   Xbasic to Select a Record and Display a Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Xbasic+to+Control+Access+to+a+Form">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>