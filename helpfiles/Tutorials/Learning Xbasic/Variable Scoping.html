	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Variable Scoping</p>



<p>In Exercise 11, you saw how variables were used to hold values that 
 determined the course of the application.&nbsp;For example, when you log 
 in with a user name for an administrative user, the <span class=Code1>is_admin</span> 
 variable is set to True and this variable is used to determine which radio 
 control on the <span class=Code1>Sign_In</span> form you see next. (The 
 <span class=Code1>is_admin</span> variable is set in the event script 
 of Button1 named Please sign in).&nbsp;Other variables set in <span class=Code1>Button1</span> 
 s <span class=Code1>OnPush</span> event script are <span class=Code1>user_id</span> 
 and <span class=Code1>user_name</span>.</p>



<p>All three of these variables are set in Button1s <span class=Code1>OnPush</span> 
 event, but they are used later in the application by other scripts. You 
 just saw <span class=Code1>Button2</span> s <span class=Code1>OnPush</span> 
 event script check the value of <span class=Code1>is_admin</span> in Exercise 
 11.&nbsp;So a variable defined in one place in Alpha Five can be accessed 
 (i.e., you can set or get its current value) in another place.&nbsp;However, 
 variables are not automatically visible (i.e., accessible) in every other 
 part of Alpha Five once they have been defined.&nbsp;Where a variable 
 is accessible is called the variables scope.&nbsp;There are five different 
 types of scope in Alpha Five.&nbsp;A variables scope level is how Alpha 
 Five determines if a variable is available for use if it is defined in 
 script A in script B.</p>



<p>Variables can be defined in four places in Alpha Five.&nbsp;You can 
 create variables associated with:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>a database</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>a table</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>a layout</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>any Xbasic script</p>

</li>
</ul>

<p>Variables defined in the <span class=Screen>Code Editor</span> using 
 the <span class=Button>Define Global Variables</span> <img src="images/Variables_button.gif"
															x-maintain-ratio=TRUE
															style="border: none;
	width: 22px;
	height: 22px;
	float: none;
	border-style: none;
	border-style: none;"
															width=22
															height=22
															border=0> button 
 are available whenever the database they are created in is opened and 
 are global variables available to all layouts and scripts until that database 
 is closed (or the variable itself is destroyed in a script).</p>



<p>Variables defined in the table editor are also global variables and 
 are instantiated when that table is opened.</p>



<p>Variables instantiated in a layout can be session, layout or global 
 variables and are created when that layout is opened.</p>



<p>Finally, variables created in an Xbasic script can be global, shared 
 or local.&nbsp;Global variables, once instantiated, are available to any 
 component of Alpha Five while the same database is open.&nbsp;Shared variables 
 are instantiated in one script and available to any scripts run from that 
 original script.&nbsp;Local variables (which is the default when a script 
 variable is created with just the DIM command and no qualifier) are only 
 available in the script in which they are instantiated and are not visible 
 in child scripts.</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-left: 7px;
			padding-top: 7px;
			padding-right: 7px;
			padding-bottom: 7px;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>The six levels of <span class=Bolded>variable scope</span> 
 are: </p>


<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>GLOBAL</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>SESSION</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>LAYOUT</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>SHARED</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>LOCAL</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>ADMIN</p>

</li>
</ul>
<p><span class=Bolded>GLOBAL</span> variables exist throughout an Alpha 
 Five application session from the time they are created (or instantiated). 
 A global variable defined in Fourth Form will not be available until the 
 form Fourth Form is loaded in a particular Alpha Five session, but it 
 will stay in existence and be available to all other scripts and layouts 
 from that point on until you close Alpha Five.</p>


<p><span class=Bolded>SESSION</span> and <span class=Bolded>LAYOUT</span> 
 variables are defined in layouts.&nbsp; <span class=Bolded>SESSION</span> 
 variables exist from the time the layout they are defined in is loaded 
 and are available to any scripts or object events run from that layout.</p>


<p>( <span class=Bolded>LAYOUT</span> variables are a special case beyond 
 the scope of this book.)</p>


<p>In a script, when you define a variable with a DIM statement you can 
 add GLOBAL or SHARED after the DIM command.&nbsp;GLOBAL makes it a GLOBAL 
 variable.&nbsp;SHARED makes the variable available to any scripts that 
 are called (run) from the current script (and subsequent scripts).&nbsp;If 
 you do not use either of these two options, the variable is a local variable 
 and only visible in the current script.</td></tr>
</table>

<p class=A5><a name=Exercise_12___How_a_variables_scope_affects_its_visibility>Exercise 
 12&nbsp;- How a variables scope affects its visibility</a></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Code 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Interactive</span> 
 window.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>View 
 > Global Variables.</span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on the tab 
 <span class=Button>Initialized at Startup</span>. You will see the following 
 window. In this figure, you can see that the Phone Messages database has 
 three global variables defined.&nbsp;&nbsp;One of them, <span class=Code1>varC_global_test</span> 
 has an initial value of "I am a global variable". </p>

</li>
</ol>

<p class=Pix><img src="images/LB_Figure_57.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 610px;
							height: 219px;
							float: none;
							border-style: none;
							border-style: none;"
					width=610
					height=219
					border=0></p>



<p class=PixCaption>Figure 57</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-left: 7px;
			padding-top: 7px;
			padding-right: 7px;
			padding-bottom: 7px;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>You should define any Global variables you wish to use 
 in the <span class=Screen>Code Editor</span> using the <span class=Button>View 
 > Global Variables</span> menu selection.&nbsp;( <span class=Note>Note</span> 
 :&nbsp; This menu selection is available when you are editing a script 
 or using the <span class=Screen>Interactive Window</span>.) </p>


<p>The <span class=Screen>Global Variables</span> window has two tabs, 
 <span class=Screen>Variable List</span> and <span class=Screen>Initialized 
 at Startup</span>.&nbsp;You can add global variables on either tab, but 
 if you want a global variable to persist (i.e., be stored and available 
 the next time you open the current database) then define it using the 
 <span class=Screen>Initialized at Startup</span> tab.&nbsp;Global variables 
 that you add through the <span class=Screen>Variable List</span> tab will 
 be discarded when the database is closed.</p>


<p class=A5>Why Do Variables Need to be Scoped?</p>


<p>This question could be rephrased&nbsp;as&nbsp;why isn't every variable 
 a global variable?</p>


<p>The simplest answer is that every time you create a variable, Alpha 
 Five uses up computer memory to store the variable name and value. Especially, 
 if you are using variable arrays, too many global variables can have an 
 adverse impact on your applications performance (this would depend on 
 the amount of memory and capacity of the computer in use).</p>


<p>In advanced programming, it makes sense to limit the scope of variables 
 to only the objects (I.e., scripts, layouts) that need to make use of 
 them.&nbsp;This is good programming style and also helps others reading 
 your code later to understand how a variable is being used.&nbsp;(It also 
 lets you use the same variable name in different scripts to track different 
 values.&nbsp;This can be a useful tool in advanced programming.)</td></tr>
</table>

<ol start=5
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Global 
 Variables</span> window.</p>

</li>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>Global variables can be defined in other parts of 
 your application besides the <span class=Screen>Initialized at Startup</span> 
 tab of the <span class=Screen>Global Variables</span> window.&nbsp;&nbsp;As 
 they are instantiated you can monitor all global variables from the <span 
 class=Screen>Variables List</span> tab of the <span class=Screen>Global 
 Variables</span> window.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span 
 class=Screen>Control Panel</span> and choose design mode for the <span 
 class=Screen>VariablesScope</span> form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Form 
 > Variables</span> and the <span class=Screen>Variable Definition</span> 
 window appears. In this window you can see two variables have been defined. 
 <span class=Code1>varC_layout</span> is a layout variable with a value 
 of "I'm a layout variable".&nbsp; <span class=Code1>varC_session</span> 
 is a session variable with a value of "I'm a session variable".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Variable 
 Definition</span> window.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to View mode 
 for the <span class=Screen>VariablesScope</span> form.&nbsp;The form appears 
 below: </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 443px;
								height: 299px;
								float: none;
								border-style: none;
								border-style: none;"
						width=443
						height=299
						border=0></p>


	
	<p class=PixCaption>Figure 58</p>


	
	<p>All three of the variables whose definitions you observed in Steps 
 1 to 7 of this lesson are displayed on this form. So <span class=Code1>varC_global_test</span> 
 is available to this form (as you would expect) since it was instantiated&nbsp;as&nbsp;a 
 global variable when the Phone Messages database was opened. Likewise, 
 <span class=Code1>varC_layout</span> and <span class=Code1>varC_session</span> 
 display with the values they are instantiated with when this form opens.</p>


	
	<p>The two buttons on this form both have <span class=Code1>OnPush</span> 
 events defined that both do basically the same thing.&nbsp;Pushing either 
 button will display a message box showing the three variables and their 
 variables.&nbsp;The difference in the events is crucial for understanding 
 a variables scope.</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The Xbasic command <span class=Code1>ui_msg_box()</span> 
 displays a message box with a title and the contents of a character string 
 and an <span class=Button>OK</span> button to continue. The character 
 strings displayed in the <span class=Code1>ui_msg_box()</span> commands 
 in this exercise are: </p>


	<p>line 1</p>


	<p><span class=Code1>varC_global: +&nbsp;varC_global_test</span></p>


	<p>line 2</p>


	<p><span class=Code1>varC_session: +&nbsp;varC_session</span></p>


	<p>line 3</p>


	<p><span class=Code1>varC_layout: + varC_layout</span></td></tr>
	</table>
	
	<p><span class=Code1>Button1'</span> s <span class=Code1>OnPush</span> 
 event code is this:</p>


	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>ui_msg_box("BUTTON1 <span class=Code1>OnPush</span> 
 Event - popup 1","varC_global: "+varC_global_test)</p>


	<p class=Code>ui_msg_box("BUTTON2 <span class=Code1>OnPush</span> 
 Event - popup 2","varC_session: "+varC_session)</p>


	<p class=Code>ui_msg_box("BUTTON3 <span class=Code1>OnPush</span> 
 Event - popup 3","varC_layout: "+varC_layout)&nbsp;</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Code1>button1</span> 
 and you will see the following: </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58a.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 194px;
								height: 107px;
								float: none;
								border-style: none;
								border-style: none;"
						width=194
						height=107
						border=0></p>


	
	<p>The <span class=Code1>varC_global</span> variable is displayed by 
 the first command line in the <span class=Code1>OnPush</span> event.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span>. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58b.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 201px;
								height: 107px;
								float: none;
								border-style: none;
								border-style: none;"
						width=201
						height=107
						border=0></p>


	
	<p>The <span class=Code1>varC_session</span> variable in displayed 
 from the <span class=Code1>OnPush</span> event.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span>. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58c.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 191px;
								height: 107px;
								float: none;
								border-style: none;
								border-style: none;"
						width=191
						height=107
						border=0></p>


	
	<p>The <span class=Code1>varC_layout</span> variable in displayed from 
 the <span class=Code1>OnPush</span> event.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span>. 
 The code for the <span class=Code1>OnPush</span> event script of <span 
 class=Code1>Button2</span> is different from that of <span class=Code1>Button1.</span>&nbsp; 
 Instead of executing the <span class=Code1>ui_msg_box</span> command you 
 saw above, this script plays a saved Xbasic script.&nbsp;The code is:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>script_play("FormScopeTest")&nbsp;</td></tr>
	</table>
	
	<p class=BlankLine>&nbsp;</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The Xbasic command <span class=Code1>script_play()</span> 
 loads and runs the script named&nbsp;as&nbsp;the command's parameter.</td></tr>
	</table>
	
	<p>The content of the Xbasic script, <span class=Code1>FormScopeTest</span>, 
 is:</p>


	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>ui_msg_box("FormScopeTest script - popup 1","varC_global: 
 "+varC_global_test)</p>


	<p class=Code>ui_msg_box("FormScopeTest script - popup 2","varC_session: 
 "+varC_session)</p>


	<p class=Code>ui_msg_box("FormScopeTest script - popup 3","varC_layout: 
 "+varC_layout)&nbsp;</td></tr>
	</table>
	
	<p>This is the same exact code (except for the message box's title 
 parameters)&nbsp;as&nbsp;you saw in Step 8 for the <span class=Code1>:Button1.OnPush</span> 
 event.&nbsp;But now, there is another layer involved.&nbsp;The <span class=Code1>:Button2.OnPush</span> 
 event plays a script and that script code runs separately from the layout 
 of the <span class=Screen>VariablesScope</span> form.&nbsp;You can think 
 of the <span class=Code1>:Button1.OnPush</span> event script&nbsp;as&nbsp;running 
 within the layout and the <span class=Code1>FormScopeTest</span> script 
 running outside the layout (though still within the layout session. So 
 what do you think will happen to the layout variable and the session variable 
 when the Xbasic commands of the <span class=Code1>FormScopeTest</span> 
 script tries to access each of them?</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>Whenever a layout is opened (viewed), Alpha Five 
 begins a new "session". Layout objects and their event scripts 
 can access "layout" variables. Scripts launched through an object 
 that is part of a particular layout are part of that script's session 
 and have access to the layout's session variables.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>Button2</span>. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58d.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 194px;
								height: 107px;
								float: none;
								border-style: none;
								border-style: none;"
						width=194
						height=107
						border=0></p>


	
	<p>The <span class=Code1>varC_global</span> variable is displayed from 
 the <span class=Code1>OnPush</span> event.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span>. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58e.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 201px;
								height: 107px;
								float: none;
								border-style: none;
								border-style: none;"
						width=201
						height=107
						border=0></p>


	
	<p>The <span class=Code1>varC_session</span> variable is displayed 
 from the <span class=Code1>OnPush</span> event.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span>. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_58f.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 485px;
								height: 357px;
								float: none;
								border-style: none;
								border-style: none;"
						width=485
						height=357
						border=0></p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>This time an error 
 message is displayed.&nbsp;The <span class=Code1>varC_layout</span> variable 
 was not found. Click the <span class=Button>Break</span> button until 
 you can click the <span class=Button>X</span> button on the <span class=Screen>Debugger</span> 
 menu, then close the <span class=Screen>Debugger</span>.</p>

</li>
	
	<p>In Step 12, the variable defined&nbsp;as&nbsp;a session variable 
 was found and displayed.&nbsp;But the <span class=Code1>FormScopeTest</span> 
 script that is running does not have access to the layout variables of 
 the <span class=Screen>VariablesScope</span> form.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to design 
 mode for the <span class=Screen>VariablesScope</span> form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right-click on <span 
 class=Code1>BUTTON2</span> and select <span class=Screen>Events > Pop-up 
 Editor</span>. In the script edit window change the command to:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>script_play_local("FormScopeTest")&nbsp;</td></tr>
	</table>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The <span class=Code1>script_play_local()</span> 
 command gives the "called" script (i.e., the script being played 
 by this command) access to any variables available in the "calling" 
 script (i.e., the script that has this command in it). In this exercise, 
 the calling script is the <span class=Code1>:Button2.OnPush</span> event 
 script and the called script is <span class=Code1>FormScopeTest</span>.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Save</span>, 
 then <span class=Button>Close</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch back to view 
 mode for the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on <span class=Code1>BUTTON2</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click through the 
 three message boxes. When you change the command in Step 16 from <span 
 class=Code1>script_play()</span> to <span class=Code1>script_play_local()</span> 
 you tell Alpha Five to give the script access to the layout variables 
 of the layout this script was launched from.&nbsp;Since the script was 
 played from the <span class=Code1>OnPush</span> event of a child object 
 of the <span class=Screen>VariablesScope</span> form layout, this script 
 now has access to the <span class=Screen>VariablesScope</span> layout 
 variables.&nbsp;The third message box command now has access to the layout 
 variable and displays without an error.</p>

</li>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>A <span class=Code1>SHARED</span> variable that 
 is DIMmed in a calling script is available in a called script that is 
 run with the <span class=Code1>script_play()</span> command. <span class=Code1>GLOBAL</span> 
 variables are, of course, available to any subsequently run scripts once 
 they are instantiated in a script. Variables intantiated with a regular 
 <span class=Code1>DIM</span> command (without the <span class=Code1>SESSION</span> 
 or <span class=Code1>GLOBAL</span> qualifier are "local" variables 
 only visible in the script they are created. However, if you play a subsequent 
 script with the <span class=Code1>script_play_local()</span> command, 
 then local variables are visible in the called script also.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>VariablesScope</span> 
 form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Interactive</span> 
 window.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Type:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>? not_a_variable&nbsp;</td></tr>
	</table>
	
	<p>Alpha Five responds with "ERROR: not_a_variable not found".</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Type:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>? is_admin&nbsp;</td></tr>
	</table>
	
	<p>Alpha Five returns .T. or .F. (depending on whether you previously 
 logged in&nbsp;as&nbsp;an administrative user of the <span class=Screen>Its 
 For You</span> application during this Alpha Five session).</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File 
 > New > Script using Xbasic editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 lines in this new script:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>DIM varN_smallnumber&nbsp;as&nbsp;N</p>


	<p class=Code>DIM SHARED varN_bignumber&nbsp;as&nbsp;N</p>


	<p class=Code>varN_smallnumber = 2</p>


	<p class=Code>varN_bignumber = 8888</p>


	<p class=Code>&nbsp;ui_msg_box("Momma script", STR(varN_smallnumber,4,0))</p>


	<p class=Code>&nbsp;ui_msg_box("Momma script", STR(varN_bignumber,4,0))&nbsp;</td></tr>
	</table>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>While you are typing in the Xbasic commands in Step 
 28, be sure to take advantage of Alpha Five's bubble help and command 
 auto-completion.&nbsp;as&nbsp;you type a command,&nbsp;as&nbsp;soon&nbsp;as&nbsp;the 
 next command that you want appears at the top of the bubble list, just 
 press <span class=Button>Enter</span> and the rest of that command word 
 will be filled in for you. </p>


	<p>For example,&nbsp;as&nbsp;you type: "DIM S"&nbsp;as&nbsp;shown 
 here, Alpha Five's bubble help shows the word "SHARED". </p>


	<p class=Pix><img src="images/LB_Figure_59b.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 269px;
								height: 80px;
								float: none;
								border-style: none;
								border-style: none;"
						width=269
						height=80
						border=0></p>


	<p>Press <span class=Button>Enter</span> and the full word will be 
 filled in automatically for you. Alpha Five will also show object and 
 variable names that have been instantiated (in addition to commands) in 
 bubble help and will auto-complete typing in their names&nbsp;as&nbsp;well.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>Save</span> 
 and give the script the name "momma".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Code 
 > Run</span>. The script displays two message boxes in turn and the 
 two variables you&nbsp; created are displayed.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File 
 > New > Script using Xbasic editor.</span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 lines in this new script:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>DIM varN_diff&nbsp;as&nbsp;N</p>


	<p class=Code>varN_diff = varN_bignumber - varN_smallnumber</p>


	<p class=Code>ui_msg_box("child of momma", STR(varN_diff,4,0))&nbsp;</td></tr>
	</table>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The type conversion function <span class=Code1>STR()</span> 
 is necessary in the <span class=Code1>ui_msg_box()</span> command in Step 
 28 because the second parameter of the <span class=Code1>ui_msg_box()</span> 
 command must be a string and the variable used here is of type numeric.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>Save</span> 
 and give the script the name "child of momma". Your screen should 
 look like this: </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_59.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 646px;
								height: 284px;
								float: none;
								border-style: none;
								border-style: none;"
						width=646
						height=284
						border=0></p>


	
	<p class=PixCaption>Figure 59</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Code1>child 
 of momma</span> script tab is still the active tab.&nbsp;&nbsp;Press the 
 <span class=Button>Run</span> <img src="images/Run_button.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 22px;
											height: 22px;
											float: none;
											border-style: none;
											border-style: none;"
									width=22
									height=22
									border=0> button. The following error 
 message box appears: </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_59a.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 402px;
								height: 378px;
								float: none;
								border-style: none;
								border-style: none;"
						width=402
						height=378
						border=0></p>


	
	<p>Alpha Five reports that <span class=Code1>varN_smallnumber</span> 
 cannot be found.&nbsp;If you look back at the <span class=Code1>momma</span> 
 script shown in step 26, you can see that <span class=Code1>varN_bignumber</span> 
 was DIMmed&nbsp;as&nbsp; <span class=Code1>SHARED</span>.&nbsp;And since 
 you ran the <span class=Code1>momma</span> script, this variable is available 
 to any other scripts youre running <span class=Bolded>while in the Code 
 Editor</span>.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Break</span> 
 button until you can click the <span class=Button>X</span> button on the 
 <span class=Screen>Debugger</span> menu, then close the <span class=Screen>Debugger</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on the <span 
 class=Code1>momma</span> script tab.&nbsp;Change the first line to:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>DIM SHARED varN_smallnumber&nbsp;as&nbsp;N&nbsp;</td></tr>
	</table>
	
	<p>Add this line at the end:</p>


	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>script_play("child of momma")&nbsp;</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save the script.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Choose <span class=Button>File 
 > Close Code Editor</span>. You are at the <span class=Screen>Control 
 Panel</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on the <span 
 class=Button>Code</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Double-click on the 
 <span class=Code1>momma</span> script to run it. The two message box commands 
 in the <span class=Code1>momma</span> script appear followed by the message 
 box in the <span class=Code1>child of momma</span> script.&nbsp;Since 
 the two variables <span class=Code1>varN_smallnumber</span> and <span 
 class=Code1>varN_bignumber</span> are both DIMmed&nbsp;as&nbsp; <span 
 class=Code1>SHARED</span> in the <span class=Code1>momma</span> script, 
 they are both available to the <span class=Code1>child of momma</span> 
 script.</p>

</li>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-left: 7px;
				padding-top: 7px;
				padding-right: 7px;
				padding-bottom: 7px;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The type conversion function <span class=Code1>STR()</span> 
 is necessary in the <span class=Code1>ui_msg_box()</span> command in Step 
 28 because the second parameter of the <span class=Code1>ui_msg_box()</span> 
 command must be a string and the variable used here is of type numeric.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Code1>momma</span> 
 script to edit it. Add the following line at the end:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>ui_msg_box("Momma script", STR(varN_diff,4,0))&nbsp;</td></tr>
	</table>
	
	<p>Run the script.&nbsp;What happened?&nbsp; Save the script.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now edit the <span 
 class=Code1>child of momma</span> script and make the variable <span class=Code1>varN_diff 
 SHARED</span>. Save your changes.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Rerun the <span class=Code1>momma</span> 
 script. tHe error has been fixed by sharing the variable between the two 
 scripts.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close all windows.</p>

</li>
</ol>

<p class=A5>Next</p>



<p><a href="../../References/Functions.html" title="Functions" class="wiki">Functions</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Variable+Scoping">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>