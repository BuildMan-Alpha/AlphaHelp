	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Fetching in a Set</p>



<p>When the current table is the primary table of a set, Alpha Fives fetching 
 mechanism automatically updates the record pointers in each of the sets 
 component tables. The record pointers are synchronized according to the 
 way in which tables are linked in the set definition.</p>



<p>The current record for a set is a combination of all the records referenced 
 by each of the sets record pointers. This record, called a composite record, 
 contains all the fields from the primary table and all the fields from 
 each child table.</p>



<p>When fetching through a set, there is one composite record for each 
 possible arrangement of record pointers. A one-to-one link produces one 
 composite record; each parent record is related to one child record. In 
 the case of a one-to-many link, one or more child records can be related 
 to each parent record and thus one composite record exists for each parent 
 and child combination.</p>



<p class=A5>The One-to-One Link</p>



<p>For example, suppose the following <span class=Code1>Inv_head</span> 
 table is linked one-to-one to the Customer table:</p>




<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td colspan="3" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Inv_head</td>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_DATE</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>CUST_ID</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/23/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/26/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C003</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/02/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C002</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/18/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C005</td></tr>
</table>
</div>
<p>When fetching on the primary table ( <span class=Code1>Inv_head</span> 
 ), the composite records are&nbsp;as&nbsp;follows:</p>




<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td colspan="3" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Inv_head</td>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead><span class=Note>Function</span></td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_DATE</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/23/95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/26/95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/02/95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/18/95</td></tr>
</table>
</div>
<p>The diagram for this set is:</p>



<p class=Pix><img src="images/Set_Relationship_1.gif"
					x-maintain-ratio=TRUE
					style="height: 81px;
							border: none;
							width: 212px;
							float: none;
							border-style: none;
							border-style: none;"
					height=81
					width=212
					border=0></p>




<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>
<col>

<tr>
<td colspan="5" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Customer</td>
<td_null>
<td_null>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>CUST_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>CUST_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>FIRST_NAME</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>LAST_NAME</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>STATE</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Evelyn</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Roberts</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Julie</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Lemmons</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leonard</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Acron</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NY</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C005</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C005</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jonathan</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Schwartz</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>
</table>
</div>
<p class=A5>The One-to-Many Link</p>



<p>When a set includes a one-to-many link, the fetching of composite records 
 is a little different. Suppose the <span class=Code1>Inv_head</span> table 
 is linked one-to-many to <span class=Code1>Inv_item</span>, a table which 
 stores the line items for each invoice, using the <span class=Code1>Inv_ID</span> 
 field.</p>




<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td colspan="3" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Inv_item</td>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>PROD_NAME</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>PRICE</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Glove</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>16.95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Baseball</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>4.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Hat</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>12.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Golf Bag</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>25.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Soccer Ball</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>18.95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Water Bottle</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>4.50</td></tr>
</table>
</div>
<p>When fetching through the one-to-many link, the <a href="../../../References/Methods/TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">&lt;TBL&gt;.FETCH_FIRST(</a>) 
 and <a href="../../../References/Methods/TBL.FETCH_NEXT Method.html" title="TBL.FETCH_NEXT Method" class="wiki">&lt;TBL&gt;.FETCH_NEXT(</a>) 
 methods produce the following composite records:</p>




<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr>
<td colspan="4" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Inv_head</td>
<td_null>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Function</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_DATE</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>CUST_ID</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/23/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/23/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/23/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/26/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C003</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>05/26/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C003</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/02/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C002</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>06/18/95</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>C005</td></tr>
</table>
</div>

<table>

<p>&nbsp; <br>
<br>
 </p>



<tr>
<td>

<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td colspan="3" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Inv_item</td>
<td_null>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>INV_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>PROD_NAME</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>PRICE</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Glove</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>16.95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Baseball</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>4.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Hat</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>12.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Golf Bag</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>25.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Soccer Ball</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>18.95</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>I004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Water Bottle</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>4.50</td></tr>
</table>
</div>

<p class=A5>Multiple One-to-Many Links at the Same Level</p>


<p>When a parent table is related to two child tables using two one-to-many 
 links, the fetching and formation of composite records becomes more involved.</p>


<p>Suppose a set that tracks customer charges and payments on a credit 
 card has the following structure: </p>


<p class=Pix><img src="images/Set_Relationship_2.gif"
					x-maintain-ratio=TRUE
					style="height: 120px;
							border: none;
							width: 212px;
							float: none;
							border-style: none;
							border-style: none;"
					height=120
					width=212
					border=0></p>


<p>For each customer, there are one or more charges and one or more corresponding 
 payments. The composite records formed by fetching through this set are&nbsp;as&nbsp;follows:</p>



<div align=center>
<table style="float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>
<col>
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Customer</td>
<td_null>
<td colspan="3" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Charges</td>
<td_null>
<td_null>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Payments</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Function</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>CUST_ID</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>LAST_NAME</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead><span class=Note>CHG_ID</span></td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>AMOUNT</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>PAY_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>AMOUNT</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leibman</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>43.50</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leibman</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>6.50</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leibman</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>16.25</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leibman</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>16.25</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Leibman</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN01</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>50.00</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jordan</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>12.50</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jordan</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>14.50</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jordan</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>20.50</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jordan</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>&nbsp;</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CN02</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>6.50</td></tr>
</table>
</div>

<p>Notice how the child records in each one-to-many link are fetched separately 
 to form different composite records. While fetching the records from one 
 link, the field values from the other link are blanked out. Once the child 
 records from the first link are exhausted, the fetching will continue 
 with the child records from the second link, blanking out the fields from 
 the first. This process continues until all one-to-many links at the same 
 level have been fetched through.</p>


<p>In the diagram above, the composite records related to each parent record 
 are divided into two groups (one for each link). The first group of composite 
 records includes the child records from the Charges table, which is the 
 first link. The second composite record group includes records from Payments.</p>


<p>To determine which one-to-many link is currently being fetched, you 
 can use the <a href="../../../References/Functions/SCANNING Function.html" title="SCANNING Function" class="wiki">SCANNING(</a>) function. 
 For example, running the following script on the credit card set:</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;p = iif(scanning("PAYMENTS"),"XXX","---")</p>


<p class=Code>&nbsp;&nbsp;c = iif(scanning("CHARGES"),"XXX","---")</p>


<p class=Code>&nbsp;&nbsp;trace.writeln(c + p)</p>


<p class=Code>&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>
<p>produces the following output in the <span class=Screen>Trace</span> 
 window:</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>XXX---</p>


<p class=Code>XXX---</p>


<p class=Code>XXX---</p>


<p class=Code>---XXX</p>


<p class=Code>---XXX</p>


<p class=Code>XXX---</p>


<p class=Code>XXX---</p>


<p class=Code>---XXX</p>


<p class=Code>---XXX</td></tr>
</table>
<p class=A5><a name=Sample_Script>Reading Through a Set</a></p>


<p>When you fetch through a set, you need one pointer for the set and one 
 pointer for each table in the set that you wish to read from or write 
 to. This example reads through the AlphaSports <span class=Code1>invoice.set</span>.</p>


<p>First, create one pointer for the set, and three pointers for tables 
 containing data to be read.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim sptr as P</p>


<p class=Code>dim itbl as P</p>


<p class=Code>dim ctbl as P</p>


<p class=Code>dim ptbl as P</td></tr>
</table>
<p>Create variables to hold field values.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim invoice as C</p>


<p class=Code>dim lastname as C</p>


<p class=Code>dim description as C</p>


<p class=Code>dim list as C</td></tr>
</table>
<p>Open the set with <a href="../../../References/Methods/SET.OPEN_SESSION Method.html" title="SET.OPEN_SESSION Method" class="wiki">SET.OPEN_SESSION(</a>) 
 (necessary when running a script from a layout) and set the values of 
 the table pointers.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sptr = set.open_session("invoice")</p>


<p class=Code>itbl = sptr.invoice_header</p>


<p class=Code>ctbl = sptr.customer</p>


<p class=Code>ptbl = sptr.product</td></tr>
</table>
<p>Retrieve the first record with <a href="../../../References/Methods/SET.FETCH_FIRST Method.html" title="SET.FETCH_FIRST Method" class="wiki">&lt;SET&gt;.FETCH_FIRST(</a>) 
 and loop with <a href="../../../References/Methods/SET.FETCH_NEXT Method.html" title="SET.FETCH_NEXT Method" class="wiki">&lt;SET&gt;.FETCH_NEXT(</a>) 
 until you reach the last record. The <a href="../../../References/Methods/SET.FETCH_EOF Method.html" title="SET.FETCH_EOF Method" class="wiki">&lt;SET&gt;.FETCH_EOF(</a>) 
 method returns FALSE and exits from the <a href="../../../Unclassified/WHILE __ELLIPSES__ END WHILE.html" title="WHILE ... END WHILE" class="wiki">WHILE   ... END WHILE</a> loop after the script reads the last record. Note how 
 you must use the <span class=Code1>itbl</span>, <span class=Code1>ctbl</span>, 
 and <span class=Code1>ptbl</span> table pointers to read (and write) the 
 individual fields. The set pointer is only for navigation. <a href="../../../References/Functions/CHR Function.html" title="CHR Function" class="wiki">CHR(9</a>) 
 produces a tab character. <a href="../../../References/Functions/CRLF Function.html" title="CRLF Function" class="wiki">CRLF(</a>) 
 produces a carriage return and line feed.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sptr.fetch_first()</p>


<p class=Code>while .not. sptr.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;invoice 
 = itbl.invoice_number</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;description 
 = ptbl.description</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lastname 
 = ctbl.lastname</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list 
 = list + invoice + chr(9) + lastname + chr(9) + description + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;sptr.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>
<p>Close the set and display the results.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sptr.close()</p>


<p class=Code>ui_msg_box("Invoices", list)</td></tr>
</table>
<p class=A5>Reading Through a Filtered and Ordered Set</p>


<p>When you fetch through a filtered set, you need to take additional steps 
 to apply the filter. This example reads through the AlphaSports <span 
 class=Code1>invoice.set</span>.</p>


<p>First create the necessary variables.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim sptr as P</p>


<p class=Code>dim itbl as P</p>


<p class=Code>dim ctbl as P</p>


<p class=Code>dim ptbl as P</p>


<p class=Code>dim invoice as C</p>


<p class=Code>dim product as C</p>


<p class=Code>dim lastname as C</p>


<p class=Code>dim description as C</p>


<p class=Code>dim list as C</p>


<p class=Code>dim filter as C</p>


<p class=Code>dim qry as P</td></tr>
</table>
<p>Define the set and table pointers.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sptr = set.open_session("invoice")</p>


<p class=Code>itbl = sptr.invoice_header</p>


<p class=Code>ctbl = sptr.customer</p>


<p class=Code>ptbl = sptr.product</td></tr>
</table>
<p>Define the filter and order expressions. Note that the order expression 
 processes only <span class=Bolded>one</span> field.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>filter = "customer->lastname > 'm'"</p>


<p class=Code>query.filter = "flattenquery(" + filter + ")"</p>


<p class=Code>query.order = "product->description"</td></tr>
</table>
<p>There are two ways to apply the filter and order expressions. This method 
 (commented out) works when you do not know the identity of the primary 
 table in the set.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' the general solution when you do not know the name of the 
 primary table</p>


<p class=Code>' -----------------------------------------------------------------------</p>


<p class=Code>'dim primary_table as C</p>


<p class=Code>'dim primary_ptr as P</p>


<p class=Code>'primary_table = file.filename_parse(word(set.structure_get("invoice", 
 "N" + crlf()), 1, crlf()), "n")</p>


<p class=Code>'primary_ptr = eval("sptr." + primary_table)</p>


<p class=Code>'qry = primary_table.query_create()</td></tr>
</table>
<p>This code is simpler because we know that <span class=Code1>itbl</span> 
 is the primary table of the set.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>qry = itbl.query_create()</td></tr>
</table>
<p>Fetch through the set.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sptr.fetch_first()</p>


<p class=Code>while .not. sptr.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;invoice 
 = itbl.invoice_number</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;description 
 = ptbl.description</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lastname 
 = ctbl.lastname</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;list 
 = list + invoice + chr(9) + lastname + chr(9) + description + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;sptr.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>
<p>Clean up and display the results.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>itbl.query_detach()</p>


<p class=Code>sptr.close()</p>


<p class=Code>ui_msg_box("Invoices", list)</td></tr>
</table>
<p class=A5>See Also</p>


<p><a href="../../../References/Functions/Set Functions and Methods.html" title="Set Functions and Methods" class="wiki">Set Functions and Methods</a>, 
 <a href="Fetching Records.html" title="Fetching Records" class="wiki">Fetching Records</a>, <a href="../../../Orphans/Fetching at a Particular Level in a Set.html" title="Fetching at a Particular Level in a Set" class="wiki">Fetching   at a Particular Level in a Set</a>, <a href="../../../What's New/What's New in Version 10/Desktop Features V10/Navigation V10.html" title="Navigation V10" class="wiki">Navigation V10</a></p>


<p class=A5></td></tr>
</table>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Fetching+in+a+Set">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>