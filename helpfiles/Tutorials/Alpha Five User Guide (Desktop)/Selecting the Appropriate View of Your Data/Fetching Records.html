	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Fetching Records</p>
<p class=A5><a name=Current_Record_Pointer>Current Record Pointer</a></p>
<p>When a table is open, there is always one record that can be called 
 the current record. This record is the record upon which the next set 
 of field operations will be applied. A temporary record buffer holds the 
 data from the current record. When a record is entered or changed, the 
 new data values are entered through this buffer.</p>

<p>Internally, the physical location of the current record is referenced 
 through the current record pointer. Every instance of an open table has 
 its own record pointer. If the same table is opened twice (with two different 
 object pointers), there will be two independently controlled record pointers.</p>



<p>As Alpha Anywhere processes a table, it moves from one record to the next, 
 advancing the current record pointer. Each time the current record is 
 changed, the field values for the new current record are retrieved, or 
 fetched, from the table file. This process of moving the record pointer 
 and retrieving the current record is known&nbsp;as&nbsp;fetching through 
 the table.</p>



<p>Alpha Anywhere fetches through table records all the time. For example, 
 suppose a browse displays the first 20 records from a table in record 
 number order. To display these records, Alpha Anywhere has fetched to the 
 first record and then fetched through 19 subsequent records.</p>



<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : You can try 
 these scripts with the AlphaSports <span class=Code1>Customer</span> table.</p>



<p>To fetch through table records in an Xbasic script, you use the fetching 
 methods such&nbsp;as&nbsp; <a href="../../../References/Methods/TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">&lt;TBL&gt;.FETCH_FIRST(</a>), 
 <a href="../../../References/Methods/TBL.FETCH_NEXT Method.html" title="TBL.FETCH_NEXT Method" class="wiki">&lt;TBL&gt;.FETCH_NEXT(</a>), 
 <a href="../../../References/Methods/TBL.FETCH_PREV Method.html" title="TBL.FETCH_PREV Method" class="wiki">&lt;TBL&gt;.FETCH_PREV(</a>), 
 and <a href="../../../References/Methods/TBL.FETCH_LAST Method.html" title="TBL.FETCH_LAST Method" class="wiki">&lt;TBL&gt;.FETCH_LAST(</a>). 
 The following diagram illustrates how &ltTBL>.FETCH_FIRST()and &ltTBL>.FETCH_NEXT()are 
 used to fetch successive records in the <span class=Code1>Customer</span> 
 table.</p>

<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Method</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Customer_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>FirstName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>LastName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Bill_State_Region</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Michael</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Graham</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Sally</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Peabody</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000003</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Janet</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Rebo</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NH</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000004</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>David</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Mesner</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>ME</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000005</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Evan</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Feld</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NY</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000006</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jason</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Rigan</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>DC</td></tr>
</table>
</div>
<p class=A5><a name=Fetching_Through_a_Table_in_Record_Order>Fetching Through 
 a Table in Record Order</a></p>

<p>Fetching is automated by calling fetching functions from within <span   class=Code1><a href="../../../Unclassified/WHILE __ELLIPSES__ END WHILE.html" title="WHILE ... END WHILE" class="wiki">WHILE ... END WHILE</a></span> and <span   class=Code1><a href="../../../References/Xbasic/FOR __ELLIPSES__ NEXT.html" title="FOR ... NEXT" class="wiki">FOR ... NEXT</a></span> loops. For instance, to fetch through 
 all the records in the current primary index and range, the following 
 script might be used. There are several things to note:</p>

<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Record order is the natural 
 order of the table with no applied order expression. It is the order in 
 which the records were added to the table.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Screen>Trace</span> 
 window display is not something that you would put in a program. It part 
 of these examples to show which records the script reads.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You set the value of the 
 <span class=Code1>tbl</span> <a href="../../../Unclassified/Variable Data Types.html" title="Variable Data Types" class="wiki">pointer</a> 
 variable using the <span class=Code1><a href="../../../References/Methods/TABLE.OPEN Method.html" title="TABLE.OPEN Method" class="wiki">table.open(  </a>)</span>  function. This is a <span class=Bolded>necessary first step</span> 
 that allows you to manipulate data in the table.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You fetch the first record 
 with <span class=Code1><a href="../../../References/Methods/TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">tbl.fetch_first(</a>)</span>. 
 This statement is <span class=Bolded>outside</span> of the loop.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/TBL.FETCH_NEXT Method.html" title="TBL.FETCH_NEXT Method" class="wiki">tbl.fetch_next(</a>)</span> function is <span class=Bolded>inside</span> 
 the loop. It is the <span class=Bolded>last</span> statement before the 
 <span class=Code1>end while</span> statement. This statement keeps advancing 
 you to the next record.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../Unclassified/WHILE __ELLIPSES__ END WHILE.html" title="WHILE ... END WHILE" class="wiki">while</a> <a href="../../../References/Xbasic/Logical .NOT..html" title="Logical .NOT." class="wiki">.NOT.</a> 
 <a href="../../../References/Methods/TBL.FETCH_EOF Method.html" title="TBL.FETCH_EOF Method" class="wiki">tbl.fetch_eof(</a>)</span> 
 statement breaks out of the loop after you have read the last record in 
 the table. Code execution resumes with the first statement after the <span 
 class=Code1>end while</span> statement.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You can read the value 
 of a table field with the syntax illustrated below, which is <span class=Argument>value 
 = table-pointer.field-name</span>.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>a5.command("VIEW_TRACE")' opens the Trace window</p>


<p class=Code>tbl = table.open("customer.dbf")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln(tbl.lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Fetching_Through_a_Table_with_Ordered_Records>Fetching 
 Through a Table with Ordered Records</a></p>


<p>The current primary index, range, or query selects the records that 
 a script will retrieve. The current primary index, range, or query also 
 sets the order of the selected records. For example, if the definition 
 of the primary index for the <span class=Code1>Customer</span> table is 
 " <span class=Code1>LASTNAME</span> ", the result of the fetching 
 would be the following:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Method</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Customer_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>FirstName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>LastName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Bill_State_Region</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000032</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Winston</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Abrams</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NE</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000056</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Randi</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Adams</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>HI</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000055</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>John</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Baker</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NY</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000052</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Tom</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Barber</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NY</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000054</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jeffrey</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Bernstein</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NY</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000018</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>George</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Boschetti</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>SC</td></tr>
</table>
</div>
<p>Things to note:</p>

<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>This example sets the current 
 index to an existing index named <span class=Code1>Lastname2</span> created 
 for the <span class=Code1>Customer</span> table. It returns all the records 
 in the table, because the index's filter is expression is empty (which 
 is equivalent to .T.).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The index sorts the records 
 based on the value of the <span class=Code1>Lastname</span> field. This 
 index <a href="../../../References/Desktop/Index Builder.html#Creating_an_Index" title="Index Builder" class="wiki">order   expression</a> is simply " <span class=Code1>Lastname</span> ".</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>This script uses the <span 
 class=Code1>indx = <a href="../../../References/Methods/TBL.INDEX_PRIMARY_PUT Method.html" title="TBL.INDEX_PRIMARY_PUT Method" class="wiki">tbl.index_primary_put(&quot;Lastname2&quot;</a>)</span> 
 expression to apply the <span class=Code1>Lastname2</span> index.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/INDEX.CLOSE Method.html" title="INDEX.CLOSE Method" class="wiki">indx.close(</a>)</span> and <span   class=Code1><a href="../../../References/Methods/TBL.CLOSE Method.html" title="TBL.CLOSE Method" class="wiki">tbl.close(</a>)</span> methods release system resources when 
 you are finished using them.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx&nbsp;as&nbsp;P</p>


<p class=Code>dim count&nbsp;as&nbsp;N</p>


<p class=Code>a5.command("VIEW_TRACE")</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>indx = tbl.index_primary_put("Lastname2")</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln(tbl.last_name)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>indx.close()</p>


<p class=Code>tbl.close()</p>


<p class=Code>ui_msg_box("Record Count", "" + count)</td></tr>
</table>

<p class=A5><a name=Fetching_Through_Filtered_Records>Fetching Through 
 Filtered Records</a></p>



<p>If the table records are filtered by the primary index, query, or range, 
 the fetching methods will fetch only records that pass through the filter.</p>



<p>For example, if the range filter applied to the <span class=Code1>Customer</span> 
 table is <span class=Code1>STATE = "MA"</span>, the sequence 
 of records would be:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Method</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Customer_ID</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>FirstName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>LastName</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Bill_State_Region</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_first()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000001</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Michael</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Graham</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000002</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Sally</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Peabody</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000007</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Lee Ann</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Mederos</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>tbl.fetch_next()</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>00000008</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Jennifer</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Cario</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>MA</td></tr>
</table>
</div>
<p>This example sets the current filter ( <span class=Code1>query.filter</span> 
 ) to the expression <span class=Code1>Lastname > "M"</span>. 
 It returns only those records where the value of the <span class=Code1>Lastname</span> 
 field is greater than "M". The records are not sorted.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx&nbsp;as&nbsp;P</p>


<p class=Code>dim count&nbsp;as&nbsp;N</p>


<p class=Code>a5.command("VIEW_TRACE")</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>query.filter = "Lastname > " + s_quote("M")</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln(tbl.lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>indx.close()</p>


<p class=Code>tbl.close()</p>


<p class=Code>ui_msg_box("Record Count", "" + count)</td></tr>
</table>

<p>This example adds to the one above by setting <span class=Code1>query.order</span> 
 to <span class=Code1>Lastname</span>. It returns only those records where 
 the value of the <span class=Code1>Lastname</span> field is greater than 
 "M". The records are now sorted in descending order.</p>



<p>Things to note:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/TBL.QUERY_CREATE Method.html" title="TBL.QUERY_CREATE Method" class="wiki">query</a></span> system variable contains the values used 
 when creating a query.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/TBL.QUERY_CREATE Method.html" title="TBL.QUERY_CREATE Method" class="wiki">tbl.query_create(</a>)</span> method sets the value of the 
 <span class=Code1>indx</span> pointer variable.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/INDEX.RECORDS_GET Method.html" title="INDEX.RECORDS_GET Method" class="wiki">indx.records_get(</a>)</span> method returns the number of 
 records that pass the current filter.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You can write the value 
 of a table field with the syntax illustrated by <span class=Code1>tbl.lastname</span>, 
 which is <span class=Argument>table-pointer.field-name</span>.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx&nbsp;as&nbsp;P</p>


<p class=Code>dim count&nbsp;as&nbsp;N</p>


<p class=Code>a5.command("VIEW_TRACE")</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>query.filter = "Lastname > " + s_quote("M")</p>


<p class=Code>query.order = "Lastname"</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln(tbl.lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>indx.close()</p>


<p class=Code>tbl.close()</p>


<p class=Code>ui_msg_box("Record Count", "" + count)</td></tr>
</table>

<p class=A5><a name=Changing_Field_Values>Changing Field Values</a></p>



<p>Thus far the example scripts have been reading record values. This example 
 writes values to the <span class=Code1>Lastname</span> field.</p>



<p>Things to note:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/TBL.QUERY_CREATE Method.html" title="TBL.QUERY_CREATE Method" class="wiki">tbl.query_create(</a>)</span> method sets the value of the 
 <span class=Code1>indx</span> pointer variable.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span   class=Code1><a href="../../../References/Methods/INDEX.RECORDS_GET Method.html" title="INDEX.RECORDS_GET Method" class="wiki">indx.records_get(</a>)</span> method returns the number of 
 records that pass the current filter.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>query.options 
 = "t"</span> statement allows Alpha Anywhere to discard the query 
 when it needs to make room for a new one.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Before you change an existing 
 value, you must be in change mode. You set change mode with the <span   class=Code1><a href="../../../References/Methods/TBL.CHANGE_BEGIN Method.html" title="TBL.CHANGE_BEGIN Method" class="wiki">tbl.change_begin(.t.</a>)</span> statement. The <span 
 class=Code1>.t.</span> says that you want to honor any field rules for 
 the field.</span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You can 
 write the value of a table field with the syntax illustrated below, which 
 is <span class=Argument>table-pointer.field-name = value</span>.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>After 
 changing one or more field values, you must use the <span   class=Code1><a href="../../../References/Methods/TBL.CHANGE_END Method.html" title="TBL.CHANGE_END Method" class="wiki">tbl.change_end(.t.</a>)</span> statement. The <span class=Code1>.t.</span> 
 says that you want to save the changes.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Since 
 the <span class=Code1>lastname</span> value returned by <span class=Code1>tbl.lastname</span> 
 is padded with blanks to the fill the field, it is impossible to append 
 another character. The <span class=Code1><a href="../../../References/Functions/ALLTRIM Function.html" title="ALLTRIM Function" class="wiki">alltrim(</a>)</span> 
 function removes those blanks, making it possible to add the letter "M".</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim indx&nbsp;as&nbsp;P</p>


<p class=Code>dim count&nbsp;as&nbsp;N</p>


<p class=Code>a5.command("VIEW_TRACE")</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>query.filter = "Lastname > " + s_quote("M")</p>


<p class=Code>query.order = "Lastname"</p>


<p class=Code>query.options = "t"</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.lastname = alltrim(tbl.lastname) 
 + "M"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln(tbl.lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>indx.close()</p>


<p class=Code>tbl.close()</p>


<p class=Code>ui_msg_box("Record Count", "" + count)</td></tr>
</table>

<p class=A5><a name=Writing_Field_Values_in_a_New_Record>Writing 
 Field Values in a New Record</a></p>



<p>Thus far the example scripts have been reading and 
 writing to existing records. This example adds a new record.</p>



<p>Things to note:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Whether 
 or not a filter or order expression is in effect when you add a new record 
 to a table is irrelevant, except if you are displaying the data (perhaps 
 in an embedded browse). A new record that does not satisfy the current 
 filter will not appear.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Before 
 you add a new record, you must be in enter mode. The <span class=Code1><a href="../../../References/Methods/TBL.ENTER_BEGIN Method.html" title="TBL.ENTER_BEGIN Method" class="wiki">tbl.enter_begin(.t.</a>)</span> 
 statement changes to enter mode. The <span class=Code1>.t.</span> says 
 that you want to honor any field rules for the field.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You can 
 write the value of a table field with the syntax illustrated below, which 
 is <span class=Argument>table-pointer.field-name = value</span>.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>After 
 adding a new record, you must use the <span class=Code1><a href="../../../References/Methods/TBL.ENTER_END Method.html" title="TBL.ENTER_END Method" class="wiki">tbl.enter_end(.t.</a>)</span> 
 statement. The <span class=Code1>.t.</span> says that you want to save 
 the changes.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You do 
 not have to worry about positioning the table pointer. Alpha Anywhere automatically 
 adds new records to the end of a table.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>You do 
 not have to set the value of a auto-increment field.</p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>tbl.enter_begin(.t.)</p>


<p class=Code>tbl.lastname = "Jones"</p>


<p class=Code>tbl.firstname = "Joe"</p>


<p class=Code>...</p>


<p class=Code>tbl.enter_end(.t.)</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../../../References/Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table   Functions and Methods</a>, <a href="Fetching in a Set.html" title="Fetching in a Set" class="wiki">Fetching in   a Set</a>, <a href="../../../Orphans/Fetching at a Particular Level in a Set.html" title="Fetching at a Particular Level in a Set" class="wiki">Fetching   at a Particular Level in a Set</a>, <a href="About_Indexes%2c_Queries%2c_and_Ranges.htm">About 
 Indexes, Queries, and Ranges</a>, <a href="../../../References/Functions/S_QUOTE Function.html" title="S_QUOTE Function" class="wiki">S_QUOTE(</a>)</p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Fetching+Records">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf"} --->
</body></html>