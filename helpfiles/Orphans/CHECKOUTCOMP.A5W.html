	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>CHECKOUTCOMP.A5W</p>



<p class=A5>Purpose</p>



<p>The CHECKOUTCOMP.A5W is the 3rd page in the checkout process. The customer 
 provides credit card payment information on this page.</p>



<p class=A5>Description</p>



<p>We built the CHECKOUTCOMP.A5W page using an HTML editing program. The 
 page illustrates what you can do without using a component to display 
 data. The values in various fields are populated with session variables. 
 The page includes an optional section to require a password if the customer 
 information indicates this is a new customer. The page has client side 
 validation using JavaScript, using the standard Alpha Five <span class=Code1>a5_html_csv.js</span> 
 JavaScript file.</p>



<p>CHECKOUTCOMP.A5W contains the <a href="NAV_MAIN Navigation Component.html" title="NAV_MAIN Navigation Component" class="wiki">NAV_MAIN</a> 
navigation component.</p>



<p class=A5>Links</p>



<p>The <a href="CHECKOUTUSER.A5W.html" title="CHECKOUTUSER.A5W" class="wiki">CHECKOUTUSER.A5W</a> page displays 
 the CHECKOUTCOMP.A5W page.</p>



<p class=Pix><img src="images/ASW_CHECKOUTCOMP_A5W.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							float: none;
							width: 608px;
							height: 667px;"
					width=608
					height=667
					border=1></p>



<p class=PixCaption>CHECKOUTCOMP.A5W in the WYSIWYG tab of the HTML Editor 
 </p>



<p class=Pix><img src="images/ASW_CHECKOUTCOMP_A5W_2.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							float: none;
							width: 608px;
							height: 452px;"
					width=608
					height=452
					border=1></p>



<p class=PixCaption>CHECKOUTCOMP.A5W in the Browser </p>



<p class=A5>Page Source</p>



<p>The page script begins by checking the status of several protected variables. 
 If <span class=Code1>session.<strong>protected</strong>chkoutprogress</span> does not 
 exist, it means that the first checkout page was not completed. If <span 
 class=Code1>session.<strong>protected</strong>chkoutprogress</span> is less than 2, 
 it means that the second checkout page was not completed. In both cases, 
 the user is redirected to <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.<strong>protected</strong>chkoutprogress") 
 = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>elseif session.<strong>protected</strong>chkoutprogress < 2</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>If <span class=Code1>session.<strong>protected</strong>chkout</span> is FALSE (.F.), 
 it means there were no values passed from page 2. If <span class=Code1>session.<strong>protected</strong>chkout.first_name</span> 
 is NULL, the required first_name field was not entered. In both cases, 
 the user is redirected to <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.<strong>protected</strong>chkout") = 
 .F. 'no values passed from page 2</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>elseif session.<strong>protected</strong>chkout.first_name = "" 
 'no values passed from page 2 (first_name was required)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>The <span class=Code1>a5w_include("loggedinvalues.a5w")</span> statement runs the code on the <a href="LOGGEDINVALUES.A5W.html" title="LOGGEDINVALUES.A5W" class="wiki">LOGGEDINVALUES.A5W</a> 
 page. This page creates and sets the values of <span class="Code1">session.<strong>protected</strong>pUser.userid, session.<strong>protected</strong>pUser.type</span>,  and <span class="Code1">session.<strong>protected</strong>pUser.name</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5w_include("<span class="Code1">loggedinvalues</span>.a5w")</td></tr>
</table>

<p>After the user clicks the submit button ("Complete and Ship Order"), 
 the following code checks to see if each variable that should be returned 
 from the page exists. The names of the variables are listed in <span class=Code1>page_vars</span>. 
 The <a href="../References/Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> 
 loop goes through this list and appends the variables that exist to the 
 <span class=Code1>session.<strong>protected</strong>chkout</span> dot variable.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>page_vars = <<%text%</p>


<p class=Code>password</p>


<p class=Code>total</p>


<p class=Code>delivery_by</p>


<p class=Code>pay_method</p>


<p class=Code>cc_number</p>


<p class=Code>cc_name</p>


<p class=Code>cc_expmth</p>


<p class=Code>cc_expyr</p>


<p class=Code>confirm_email</p>


<p class=Code>print_inv</p>


<p class=Code>%text%</p>


<p class=Code>for each var in page_vars</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 eval_valid(var) = .T. &nbsp;&nbsp;'variable 
 value was returned to page on submit</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("session.<strong>protected</strong>chkout." 
 + var) = eval(var)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("session.<strong>protected</strong>chkout." 
 + var) = "" ' no value passed to page, set blank</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>next</td></tr>
</table>

<p>If the confirm variable does not exist, this code creates it and assigns 
 it a NULL value.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("confirm") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;confirm 
 = ""</p>


<p class=Code>end if</td></tr>
</table>

<p>The following code creates a blank error message in <span class=Code1>error_msg</span>, 
 then evaluates the values placed into <span class=Code1>session.<strong>protected</strong>chkout</span>. The script checks the value of <span class=Code1>session.<strong>protected</strong>chkout.cc_number</span> 
 with <a href="../References/Functions/CCVALID Function.html" title="CCVALID Function" class="wiki">CCVALID(</a>) and checks that 
 the expiration month ( <span class=Code1>session.<strong>protected</strong>chkout.cc_expmth</span> 
 ) and year <span class=Code1>session.<strong>protected</strong>chkout.cc_expyr</span> 
 are not in the past. If there are no errors, the code sets the value of 
 <span class=Code1>session.<strong>protected</strong>chkout.cc_expire</span> and <span 
 class=Code1>session.<strong>protected</strong>chkoutprogress</span>., and redirects 
 the user to <a href="../Unclassified/PROCESSING.HTM.html" title="PROCESSING.HTM" class="wiki">PROCESSING.HTM</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>error_msg = "&nbsp;"</p>


<p class=Code>if eval_valid("submit")</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 ccvalid(session.<strong>protected</strong>chkout.cc_number) = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 error_msg = "&nbsp;"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_msg 
 = "Invalid Credit Card Number"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkout.cc_number 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 session.<strong>protected</strong>chkout.cc_expyr + session.<strong>protected</strong>chkout.cc_expmth 
 < left( cdate(date() ), 6)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 error_msg = "&nbsp;" 'only show first error</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_msg 
 = "Invalid Credit Card Expiration date"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 error_msg = "&nbsp;"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkout.cc_expire 
 = session.<strong>protected</strong>chkout.cc_expmth + "-" + session.<strong>protected</strong>chkout.cc_expyr</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkoutprogress 
 = 3</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("processing.htm")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</td></tr>
</table>


<p>The current "cart" (or order) is identified by the session 
 cookie that contains <span class=Code1>cart_id</span>. This code prepares 
 the shopping cart data for display on the page. It retrieves order items 
 from the <span class=Code1>shop_cart_values</span> set, which links the 
 <span class=Code1>product</span> and <span class=Code1>specials</span> 
 tables to the <span class=Code1>shop_cart</span> table with the <span 
 class=Code1>product_id</span> linking key. Each invoice line item total 
 requires a selling price. This selling price can come from either the 
 <span class=Code1>product</span> or <span class=Code1>specials</span> 
 table. If the item is on "special", the price come from the 
 linked record in the <span class=Code1>specials</span> table. Otherwise, 
 it comes from the <span class=Code1>product</span> table.</p>



<p>First, get the records for this order. If there are no items, return 
 to <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>query.filter = "Cart_Id = \"" + cart_id + 
 "\" .and. Quantity > 0"</p>


<p class=Code>query.order = ""</p>


<p class=Code>tbl = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\shop_cart_values.set")</p>


<p class=Code>qdx = tbl.query_create()</p>


<p class=Code>if qdx.records_get()= 0 ' no items in cart, go back to page 
 1 of check out</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>If the query found records, the following code computes totals. The 
 script steps through the records, placing a count of records into <span 
 class=Code1>cart_kount</span>. The script determines where to get the 
 price by examining the values of the <span class=Code1>Sale_Price</span> 
 and <span class=Code1>Sale_Until</span> fields in the <span class=Code1>specials</span> 
 table. If <span class=Code1>Sale_Price</span> is not zero and <span class=Code1>Sale_Until</span> 
 contains a NULL value or a date in the future, the item is on special. 
 Otherwise, the price will come from the <span class=Code1>product</span> 
 table.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>tbl1 = table.get("shop_cart") ' get pointer to 
 parent</p>


<p class=Code>tbl2 = table.get("product") ' get pointer to child</p>


<p class=Code>tbl3 = table.get("specials") ' get pointer to child</p>


<p class=Code>cart_kount = 0 ' counter for number of records</p>


<p class=Code>cart_total = 0 ' total value in cart</p>


<p class=Code>while .not. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cart_kount 
 = cart_kount + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 (tbl3.Sale_Price > 0) .and. (tbl3.Sale_Until >= date().or. cdate(tbl3.Sale_Until) 
 = "") ' product is on special</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cart_total 
 = cart_total + (tbl3.Sale_Price * tbl1.Quantity)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cart_total 
 = cart_total + (tbl2.Retail * tbl1.Quantity)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p>The code computes the text ( <span class=Code1>item_kount</span> ) that 
 says how many items are in the order.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if cart_kount = 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;item_kount 
 = "1 Item"</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;item_kount 
 = alltrim( str(cart_kount) )+" Items"</p>


<p class=Code>end if</td></tr>
</table>

<p>Next, the script determines the customer's choice of shipping method. 
 The <span class=Code1>ship_list</span> variable will contain the list 
 of shipping alternatives. Each entry is composed of two strings: <span 
 class=Code1>ship_code</span> and <span class=Code1>delivery_by</span> 
 separated by a pipe (|) character.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ship_list = table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\shipping_types", 
 "alltrim(ship_code) + \"|\" + alltrim(delivery_by)", 
 "sort_ord")</p>


<p class=Code>if session.<strong>protected</strong>chkout.delivery_by = "" 
 ' no value set / passed from page</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkout.delivery_by 
 = "0008" ' current default is 'UPS Ground'</p>


<p class=Code>end if</td></tr>
</table>

<p>The <a href="../References/Functions/A5_HTML_LIST_POPULATE Function.html" title="A5_HTML_LIST_POPULATE Function" class="wiki">A5_HTML_LIST_POPULATE(</a>) 
 converts <span class=Code1>ship_list</span> into the format required for 
 a drop-down list on the page and stores the result in <span class=Code1>ship_drop</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ship_drop = a5_html_list_populate(ship_list, session.<strong>protected</strong>chkout.delivery_by, 
 3)</td></tr>
</table>

<p>This code calculates the shipping cost with a lookup into the <span 
 class=Code1>shipping_types</span> table. It composes a filter using <span 
 class=Code1>ship_code</span> and <span class=Code1>session.<strong>protected</strong>chkout.delivery_by</span> 
 and returns the <span class=Code1>base_price</span> field.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ship_cost = val(table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\shipping_types", 
 "base_price", "", "ship_code = \"" 
 + session.<strong>protected</strong>chkout.delivery_by + "\"") )</td></tr>
</table>

<p>There is no tax table available, therefore the tax is set to 0. A developer 
 could use a technique comparable to the shipping cost lookup to return 
 a tax value.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>sales_tax = 0</td></tr>
</table>

<p>The script computes the <span class=Code1>total_sale</span> value.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>total_sale = cart_total + ship_cost + sales_tax</td></tr>
</table>

<p>This code prepares some values for display using the current values 
 in the session variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>bill_address = alltrim(session.<strong>protected</strong>chkout.addr1) 
 + if(session.<strong>protected</strong>chkout.addr2 = "", "", "<br>" 
 + alltrim(session.<strong>protected</strong>chkout.addr2) )</p>


<p class=Code>ship_address = alltrim(session.<strong>protected</strong>chkout.ship_to_address) 
 + if(session.<strong>protected</strong>chkout.saddr2 = "", "", 
 "<br>" + alltrim(session.<strong>protected</strong>chkout.saddr2) )</p>


<p class=Code>bill_city_state = alltrim(session.<strong>protected</strong>chkout.city) 
 + "&nbsp;" + alltrim(session.<strong>protected</strong>chkout.state) 
 + "&nbsp;"+alltrim(session.<strong>protected</strong>chkout.zip)</p>


<p class=Code>ship_city_state = alltrim(session.<strong>protected</strong>chkout.ship_to_city) 
 + "&nbsp;" + alltrim(session.<strong>protected</strong>chkout.ship_to_state) 
 + "&nbsp;" + alltrim(session.<strong>protected</strong>chkout.ship_to_zip)</p>


<p class=Code>confirm_email_chked = if(session.<strong>protected</strong>chkout.confirm_email 
 = "true", "checked=\"checked\"", "")</p>


<p class=Code>print_inv_chked = if(session.<strong>protected</strong>chkout.print_inv="true", 
 "checked=\"checked\"", "")</td></tr>
</table>

<p>Next, the script prepares and formats the values for the credit card 
 year list box and stores the HTML code in <span class=Code1>ccyear_drop</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ccyears = cyear( date() ) ' current year</p>


<p class=Code>chkyear = year( date() )</p>


<p class=Code>for i = 1 to 10</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ccyears 
 = ccyears + crlf()+ alltrim( str(chkyear + i) )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>ccyear_drop = a5_html_list_populate(ccyears,session.<strong>protected</strong>chkout.cc_expyr, 
 3)</td></tr>
</table>

<p>This code creates and formats the month list for the credit card month 
 list box and stores them in <span class=Code1>ccmth_drop</span>. The credit 
 card year list starts with the current year and month </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>cc_mths = <<%text%</p>


<p class=Code>01|January</p>


<p class=Code>02|February</p>


<p class=Code>03|March</p>


<p class=Code>04|April</p>


<p class=Code>05|May</p>


<p class=Code>06|June</p>


<p class=Code>07|July</p>


<p class=Code>08|August</p>


<p class=Code>09|September</p>


<p class=Code>10|October</p>


<p class=Code>11|November</p>


<p class=Code>12|December</p>


<p class=Code>%text%</p>


<p class=Code>if eval_valid("session.<strong>protected</strong>chkout.cc_expmth") =.F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkout.cc_expmth = padl(alltrim(str(month(date() ) ) ),2,"0")</p>


<p class=Code>elseif session.<strong>protected</strong>chkout.cc_expmth = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;session.<strong>protected</strong>chkout.cc_expmth = padl(alltrim(str(month(date() ) ) ),2,"0")</p>


<p class=Code>end if </p>


<p class=Code>session.<strong>protected</strong>chkout.cc_expmth = padl(alltrim(str(month(date() ) ) ),2,"0")</p>


<p class=Code>ccmth_drop = a5_html_list_populate(cc_mths, session.<strong>protected</strong>chkout.cc_expmth, 
 3)</td></tr>
</table>

<p>This code creates and formats the contents of the credit type list box 
 and stores the HTML code in <span class=Code1>cctype_drop</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>cc_types = <<%text%</p>


<p class=Code>MCard</p>


<p class=Code>Visa</p>


<p class=Code>Amex</p>


<p class=Code>%text%</p>


<p class=Code>cctype_drop = a5_html_list_populate(cc_types,session.<strong>protected</strong>chkout.pay_method,3)</td></tr>
</table>

<p>The <span class=Code1>location = ""</span> statement clears 
 any highlighted selection on the menu. The <span class=Code1>style_name 
 = "shopcart"</span> statement sets the style of the navigation 
 component. The <span class=Code1>pgstyle = tmpl_NAV_MAIN.style_name</span> 
 statement saves the style of the navigation component in <span class=Code1>pgstyle</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>with tmpl_NAV_MAIN</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;location 
 = "" 'could set current tab HERE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;style_name 
 = "shopcart" 'could override style HERE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName 
 = "NAV_MAIN"</p>


<p class=Code>end with</p>


<p class=Code>pgstyle = tmpl_NAV_MAIN.style_name</td></tr>
</table>

<p>This part of the page creates a Javascript function.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1></span></td></tr>
</table>

<p>The remainder of the page displays the page you see above. </p>



<p class=A5>Page Security Information</p>



<p>Always Allowed</p>



<p class=A5>See Also</p>



<p><a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/AlphaSportsWeb Web Pages.html" title="AlphaSportsWeb Web Pages" class="wiki">Web Pages</a></p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 8 Professional Edition and Above</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:CHECKOUTCOMP.A5W">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>