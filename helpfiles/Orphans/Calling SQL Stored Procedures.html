	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Calling SQL Stored Procedures</p>



<p>Stored Procedures are compiled SQL code stored in the database. Calling 
 stored procedures&nbsp;as&nbsp;opposed to sending over query strings improves 
 the performance of a web application. Not only is there less network traffic 
 since only short commands are sent instead of long query stings, but the 
 execution of the actual code itself also improves. The reason is because 
 a stored procedure is already compiled ahead of time. Stored procedures 
 are also cached by SQL Server when they are run to speed things up for 
 subsequent calls.</p>



<p>Other than improving performance, stored procedures are also helpful 
 because they provide another layer of abstraction for your web application. 
 For instance, you can change a query in a stored procedure and get different 
 results without having to recompile your objects. Using stored procedures 
 also makes your objects cleaner, and SQL Server's convenient backup tool 
 makes it easy to back them up.</p>



<p class=A5>Examples</p>



<p>The following script was stored in an A5W page named "sql_connect.a5w". 
 The values for the variables <span class=Code1>password</span>, <span 
 class=Code1>username</span>, and <span class=Code1>Database_name</span> 
 were provided.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&lt%a5</p>


<p class=Code>Dim Conn&nbsp;as&nbsp;P</p>


<p class=Code>Dim rs&nbsp;as&nbsp;P</p>


<p class=Code>Dim sql&nbsp;as&nbsp;C</p>


<p class=Code>dim connection_string&nbsp;as&nbsp;C</p>


<p class=Code>conn = ole.create("ADODB.Connection")</p>


<p class=Code>rs = ole.create("adodb.recordset")</p>


<p class=Code>connection_string = "Provider=MSDASQL.1;Password= " 
 + password + ";User ID= " + username + " ;Persist Security 
 Info=True;Initial Catalog=" + Database_name + ";Data Source=" 
 + Database_name</p>


<p class=Code>conn.ConnectionString = connection_string</p>


<p class=Code>%></td></tr>
</table>

<p>The page that needed to make a connection included "sql_connect.a5w".</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&lt%a5</p>


<p class=Code>a5w_include("sql_connect.a5w")</p>


<p class=Code>dim rs&nbsp;as&nbsp;P</p>


<p class=Code>rs = ole.create("adodb.recordset")</p>


<p class=Code>rs.CursorType = 3</p>


<p class=Code>conn.Open()</p>


<p class=Code>sql = "sp_user_names " + "'" + user_id 
 +"'"</p>


<p class=Code>rs.Open(sql,conn)</p>


<p class=Code>Name = rs.fields.item(0).value</p>


<p class=Code>%></td></tr>
</table>

<p class=A5>Thanks To</p>



<p>David Brown</p>






<p class=A5>Limitations</p>



<p>Web publishing applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Calling+SQL+Stored+Procedures">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/References/SQL"} --->
</body></html>