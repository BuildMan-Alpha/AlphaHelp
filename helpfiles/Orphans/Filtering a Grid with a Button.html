	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Filtering a Grid with a Button</p>

<p>The following example shows how to filter a grid on a page with button click. The button has a pre-defined filter value associated with it. The page before using the filter button looks like this. The example is based on the <span class=Code1>customer</span> table of the AlphaSports database.</p>

<p class=A5>Method One: Using JavaScript to Set the Filter Variable</p>

<p>The virtue of this method is that it separates the value of the button (its label) from the value submitted to the filter expression. It requires some JavaScript coding but less Xbasic coding.&nbsp;as&nbsp;the picture suggests, when the user clicks the <span class=Button>NY Only</span> button, the grid will show only those records where the State column ( <span class=Code1>bill_state_region</span> field) value is "NY". </p>

<p class=Pix><img src="images/WPT_Unfiltered_Grid.gif" x-maintain-ratio=TRUE style="border: none; width: 360px; height: 363px; float: none; border-style: none; border-style: none;" width=360 height=363 border=0></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a grid and place it on an A5W page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>While in the <span class=Screen>HTML Editor</span>, click <img src="images/Button_tool_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to place a push button on the page. Label the button "NY Only".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span class=Screen>Source</span> tab and modify the button code&nbsp;as&nbsp;follows.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>The <span class=HTML1>&ltinput type=hidden name=btnClicked></span> code creates a variable named <span class=HTML1>btnClicked</span> that holds the filter value.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>The <span class=HTML1>on<x>click="btnClick('NY')"</span> phrase causes the button click to run the btnClick()JavaScript function, which assigns the value "NY" to <span class=HTML1>btnClicked</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>The script attached to the <span class=HTML1>action</span> property of the <span class=HTML1>&ltform></span> tag causes the page to reload after it is submitted.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform name="form1" action="</span> &lt%a5 ? request.script_name %> <span class=HTML1>"></span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput type=button value="NY Only" on<x>click="btnClick('NY')"></span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput type=hidden name=btnClicked></span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form></span></span> </span></span></span></td></tr> </table> <ol start=4 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>At the top of the page after the <span class=HTML1>&lthead></span> tag add the following code. This function receives the value "NY" and sets <span class=HTML1>btnClicked</span> equal to this value.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltscript></span></p>

<p class=Code><span class=HTML1>function btnClick(btnVal) {</span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>form1.btnClicked.value = btnVal;</span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>form1.submit();</span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>}</span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/script></span></span> </span></span></span></td></tr> </table><p>Near the top of the page you will see the following code. In this case the alias of the component is "Customers". Your grid component's alias may be different.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>end with</td></tr> </table> <ol start=5> <li class=kadov-p-CListNumber><p class=ListNumber>Change this code so it reads&nbsp;as&nbsp;follows. This code does the following:</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>It checks whether the <span class=HTML1>btnClicked</span> variable exists using the <a href="../References/Functions/EVAL_VALID Function.html" title="EVAL_VALID Function" class="wiki">EVAL_VALID(</a>) function.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>If the variable exists, it resets the <span class=Code1>tmpl.dbf.filter</span> property of the grid to require that the <span class=Code1>bill_state_region</span> field equal the value of <span class=HTML1>btnClicked</span>.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("btnClicked") then</p>

<p class=Code>&nbsp;&nbsp;</p>

<p class=Code>.dbf.filter = "bill_state_region =" + quote(btnClicked)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end with</td></tr> </table><p>The result of clicking the button should look like the following. </p>

<p class=Pix><img src="images/WPT_Filtered_Grid.gif" x-maintain-ratio=TRUE style="border: none; width: 360px; height: 304px; float: none; border-style: none; border-style: none;" width=360 height=304 border=0></p>

<p class=A5>Method Two: Using the Button Label to Set the Filter Variable</p>

<p>This method requires simpler button coding, but may require more Xbasic coding.&nbsp;as&nbsp;the picture suggests, when the user clicks the <span class=Button>NY Only</span> button, the grid will show only those records where the State column ( <span class=Code1>bill_state_region</span> field) value is "NY". </p>

<p class=Pix><img src="images/WPT_Unfiltered_Grid.gif" x-maintain-ratio=TRUE style="border: none; width: 360px; height: 363px; float: none; border-style: none; border-style: none;" width=360 height=363 border=0></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a grid and place it on an A5W page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>While in the <span class=Screen>HTML Editor</span>, click <img src="images/Insert_Submit_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to place a submit button on the page. Label the button "NY Only".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span class=Screen>Source</span> tab and modify the button code&nbsp;as&nbsp;follows.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>The <span class=HTML1>&ltinput type=submit value="NY Only" name=btnClicked></span> code creates a variable named <span class=HTML1>btnClicked</span> that holds the filter value. Simultaneously, it sets <span class=HTML1>btnClicked</span> to "NY Only".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>The script attached to the <span class=HTML1>action</span> property of the <span class=HTML1>&ltform></span> tag causes the page to reload after it is submitted.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform name="form1" action="</span> &lt%a5 ? request.script_name %> <span class=HTML1>"></span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput type=submit value="NY Only" name=btnClicked></span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form></span></span> </span></td></tr> </table> <ol start=4 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Near the top of the page you will see the following code. In this case the alias of the component is "Customers". Your grid component's alias may be different.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>end with</td></tr> </table> <ol start=5> <li class=kadov-p-CListNumber><p class=ListNumber>Change this code so it reads&nbsp;as&nbsp;follows. This code does the following:</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>It checks whether the <span class=HTML1>btnClicked</span> variable exists using the <a href="../References/Functions/EVAL_VALID Function.html" title="EVAL_VALID Function" class="wiki">EVAL_VALID(</a>) function.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>If the variable exists, it trims off the first word of the button label and places it into the variable <span class=Code1>var</span>. Of course, this step would not be necessary if the button label was simply "NY" instead of "NY Only".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>It resets the <span class=Code1>tmpl.dbf.filter</span> property of the grid to require that the <span class=Code1>bill_state_region</span> field equal the value of <span class=Code1>var</span>.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("btnClicked") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var = word(btnClicked,1," ")</p>

<p class=Code>&nbsp;&nbsp;</p>

<p class=Code>.dbf.filter = "bill_state_region =" + quote(var)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end with</td></tr> </table><p>The result of clicking the button should look like the following. </p>

<p class=Pix><img src="images/WPT_Filtered_Grid.gif" x-maintain-ratio=TRUE style="border: none; width: 360px; height: 304px; float: none; border-style: none; border-style: none;" width=360 height=304 border=0></p>

<p class=A5>Method Three: Using Text Input to Set the Filter Variable</p>

<p>Method three allows the user, instead of the developer, to set the filter value.&nbsp;as&nbsp;the picture suggests, when the user enters a value and clicks <span class=Button>Select First Name</span>, the grid will show only those records where the First Name column ( <span class=Code1>firstname</span> field) value matches the user's input. </p>

<p class=Pix><img src="images/WPT_Unfiltered_Grid_2.gif" x-maintain-ratio=TRUE style="border: none; width: 362px; height: 370px; float: none; border-style: none; border-style: none;" width=362 height=370 border=0></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a grid and place it on an A5W page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>While in the <span class=Screen>HTML Editor</span>, click <img src="images/Insert_Submit_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to place a submit button on the page. Label the button "Select First Name".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span class=Screen>Source</span> tab and modify the button code&nbsp;as&nbsp;follows.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>The first <span class=HTML1>&ltinput></span> tag assigns the user's input to the Xbasic variable <span class=Code1>var1</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>The second <span class=HTML1>&ltinput></span> submits the page to the server.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>The script attached to the <span class=HTML1>action</span> property of the <span class=HTML1>&ltform></span> tag causes the page to reload after it is submitted.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform method="post" action="</span> &lt%a5 ?request.script_name%> <span class=HTML1>" ></span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput name="var1" value="</span> &lt%a5 ? var1 %> <span class=HTML1>"></span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput id=submit1 type=submit value="Select First Name" name="submit1"></span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form></span></span> </span></span></span></td></tr> </table> <ol start=4 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Near the top of the page you will see the first <span class=Code1>&lt%a5</span> tag. Change it so it appears&nbsp;as&nbsp;follows. This defines the <span class=Code1>var1</span> variable.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>dim var1&nbsp;as&nbsp;c = default ""</td></tr> </table> <ol start=5 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Below this section you will see the following code. In this case the alias of the component is "Customers". Your grid component's alias may be different.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>end with</td></tr> </table> <ol start=6> <li class=kadov-p-CListNumber><p class=ListNumber>Change this code so it reads&nbsp;as&nbsp;follows. This code does the following:</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>It checks whether the <span class=Code1>var1</span> variable is NULL. If not, it allows the filter to be applied.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>If the variable exists, it resets the <span class=Code1>tmpl.dbf.filter</span> property of the grid to require that the <span class=Code1>firstname</span> field equal the value of <span class=Code1>var1</span>.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customers</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "Customers"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if alltrim(var1) &lt> "" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.dbf.filter = "firstname = " + quote( alltrim(var1) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end with</td></tr> </table><p>The result of entering "michael" into the tex tbox and clicking the button should look like the following. </p>

<p class=Pix><img src="images/WPT_Filtered_Grid_2.gif" x-maintain-ratio=TRUE style="border: none; width: 316px; height: 184px; float: none; border-style: none; border-style: none;" width=316 height=184 border=0></p>

<p class=A5>See Also</p>

<p><a href="Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Filtering+a+Grid+with+a+Button">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>