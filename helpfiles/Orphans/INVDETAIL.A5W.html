	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>INVDETAIL.A5W</p>

<p class=A5>Purpose</p>

<p>The INVDETAIL.A5W page displays a printable version of an invoice.</p>

<p class=A5>Description</p>

<p>The INVDETAIL.A5W page shows the process of using Xbasic to populate 
 a HTML page. INVDETAIL.A5W uses conventional HTML, page styles, and an 
 Alpha Five style sheet. We originally created the page in another HTML 
 editing program. The page uses Xbasic to populate a series of dot variables, 
 then uses embedded <span class=Code1>&lt%a5 ... %></span> strings 
 to display the variables on the page.</p>



<p>INVDETAIL.A5W is display only. It has no <span class=HTML1>&ltinput></span> 
 objects and no code to capture values. INVDETAIL.A5W is an example of 
 a page that could be printed using the print option of the browser.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Do not open 
 this page in the <span class=Screen>WYSIWYG</span> tab of the <span class=Screen>HTML 
 Editor</span> and then save it. This will result in the loss of Xbasic 
 code, which the underlying <span class=Screen>Microsoft ActiveX</span> 
 control does not properly support.</p>




<p class=A5>The following links display the INVDETAIL.A5W page.</p>


<ul>
	<li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Button>Your Account > Order History</span> entry of the NAV_MAIN navigation component displays the <a href="../Unclassified/SALESHIST.A5W.html" title="SALESHIST.A5W" class="wiki">SALESHIST.A5W</a> page. Clicking a Detail button on this page displays the INVDETAIL.A5W page.</p>

</li>
	<li class=kadov-p-CBullet1><p class=Bullet1>The <a href="GRD_INVHCP Grid Component.html" title="GRD_INVHCP Grid Component" class="wiki">GRD_INVHCP</a> grid component calls the INVDETAIL.A5W page.</p>

</li>
	<li class=kadov-p-CBullet1><p class=Bullet1>the <span class=Button>Sales > Invoices</span> entry of the <a href="NAV_INT Navigation Component.html" title="NAV_INT Navigation Component" class="wiki">NAV_INT</a> navigation component displays the <a href="ASWINVOICES.A5W.html" title="ASWINVOICES.A5W" class="wiki">ASWINVOICES.A5W</a> page. Clicking a <span class=Control>Detail</span> button displays the INVDETAIL.A5W page.</p>

</li>
	<li class=kadov-p-CBullet1><p class=Bullet1>the <span class=Button>Sales > Sales History</span> entry of the NAV_INT navigation component displays the <a href="ASWSALESHIST.A5W.html" title="ASWSALESHIST.A5W" class="wiki">ASWSALESHIST.A5W</a> page. The <span class=Control>Last Sale</span> link displays the INVDETAIL.A5W page.</p>

</li>
</ul>


<p class=Pix><img src="images/ASW_INVDETAIL_A5W.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							width: 496px;
							height: 524px;
							float: none;"
					width=496
					height=524
					border=1></p>



<p class=PixCaption>INVDETAIL.A5W in the WYSIWYG tab of the HTML Editor 
 </p>



<p class=Pix><img src="images/ASW_INVDETAIL_A5W_2.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							width: 608px;
							height: 431px;
							float: none;"
					width=608
					height=431
					border=1></p>



<p class=PixCaption>INVDETAIL.A5W in the Browser </p>



<p class=A5>Page Source</p>



<p>The URL that loads INVDETAIL.A5W is supposed to pass the value of <span 
 class=Code1>inv</span>&nbsp;as&nbsp;an argument. If <span class=Code1>inv</span> 
 is missing or is NULL, this code displays <a href="ERRORPAGE.HTM.html" title="ERRORPAGE.HTM" class="wiki">ERRORPAGE.HTM</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("inv") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("errorpage.htm")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>if inv = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("errorpage.htm")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>This code retrieves all the records from the <span class=Code1>invoice_header</span> 
 table where the <span class=Code1>invoice_number</span> equals <span class=Code1>inv</span>. 
 It then copies the records field values into the <span class=Code1>flds[]</span> 
 array.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim flds<a class="wiki"  href="1" rel="">1</a>&nbsp;as&nbsp;P</p>


<p class=Code>flds.initialize_from_table("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\invoice_header.dbf", 
 "alltrim(Invoice_Number)=\"" + inv + "\"")</p>


<p class=Code>if eval_valid("flds<a class="wiki"  href="1" rel="">1</a>.invoice_number") = .F. ' 
 no data returned, show error</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("errorpage.htm")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>This code retrieves all the records from the <span class=Code1>customer</span> 
 table where the <span class=Code1>customer_id</span> equals <span class=Code1>flds<a class="wiki"  href="1" rel="">1</a>.customer_id)</span>. 
 It then copies the records field values into the <span class=Code1>fldsc[]</span> 
 array.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim fldsc<a class="wiki"  href="1" rel="">1</a>&nbsp;as&nbsp;p</p>


<p class=Code>fldsc.initialize_from_table("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.dbf", 
 "alltrim(Customer_Id)=\"" + alltrim(flds<a class="wiki"  href="1" rel="">1</a>.customer_id) 
 + "\"")</p>


<p class=Code>if eval_valid("fldsc<a class="wiki"  href="1" rel="">1</a>.customer_id") = .F. ' no 
 data returned, show error</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("errorpage.htm")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>Next, the page script sets the values of the <span class=Code1>cust_name</span> 
 and <span class=Code1>cust_citystate</span> variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim cust_name&nbsp;as&nbsp;C</p>


<p class=Code>dim cust_citystate&nbsp;as&nbsp;C</p>


<p class=Code>cust_name = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.firstname) + "&nbsp;" 
 + alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.lastname)</p>


<p class=Code>cust_citystate = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_city) + "&nbsp;" 
 + alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_state_region) + "&nbsp;" + alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_postal_code)</td></tr>
</table>

<p>This part of the script conditionally sets the values of the shipping 
 variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if fldsc<a class="wiki"  href="1" rel="">1</a>.ship_same = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_name 
 = "Same&nbsp;as&nbsp;Billing"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_address1 
 = "&nbsp;"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_address2 
 = "&nbsp;"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_citystate 
 = "&nbsp;"</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_name 
 = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_to_name)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_address1 
 = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_address2 
 = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ship_citystate 
 = alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_city) + "&nbsp;" + alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_state_region) 
 + "&nbsp;" + alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.ship_postal_code)</p>


<p class=Code>end if</td></tr>
</table>

<p>The part of the code retrieves a list of items in the order from the 
 invoice_items table and places it into <span class=Code1>item_str</span>. 
 If <span class=Code1>item_str</span> is empty, it sets the values of the 
 display variables to NULL, then skips to <span class=Code1>show_page</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>item_str = set.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\invoice.set", 
 "invoice_items->product_id + \"|\" + product->description 
 + \"|\" + invoice_items->price + \"|\" + invoice_items->quantity", 
 "invoice_number", "alltrim(invoice_number)=\"" 
 + inv + "\"")</p>


<p class=Code>numitems = line_count(item_str)</p>


<p class=Code>if numitems = 0 ' no data returned, show empty</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 fldsi<a class="wiki"  href="1" rel="">1</a>&nbsp;as&nbsp;p</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fldsi.initialize_properties("product_id|desc|price|quan|extension","||||")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ext_total_disp 
 = "" 'extended total for line items</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;disc_disp 
 = ""'Discount to display</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tax_disp 
 = "" 'tax to display</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;inv_disp 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;numitems 
 = 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;goto 
 show_page</p>


<p class=Code>end if</td></tr>
</table>

<p>If there were one or more items found in the order, this code copies 
 them into the <span class=Code1>fldsi[]</span> array.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim fldsi<a class="wiki"  href="numitems" rel="">numitems</a>&nbsp;as&nbsp;p</p>


<p class=Code>fldsi.initialize_properties("product_id|desc|price|quan|extension",item_str)</td></tr>
</table>

<p>These lines recalculate invoice totals from items found.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ext_total = 0 ' extended total for line items</p>


<p class=Code>for i = 1 to numitems</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fld_ext 
 = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fld_ext 
 = val(fldsi<a class="wiki"  href="i" rel="">i</a>.quan) * val(fldsi<a class="wiki"  href="i" rel="">i</a>.price)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ext_total 
 = ext_total + fld_ext</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fldsi<a class="wiki"  href="i" rel="">i</a>.price 
 = alltrim( str(val(fldsi<a class="wiki"  href="i" rel="">i</a>.price),12,2,"$(") ) ' convert to numeric, 
 reconvert and format to character</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fldsi<a class="wiki"  href="i" rel="">i</a>.extension 
 = alltrim( str(fld_ext,12,2,"$(B") )</p>


<p class=Code>next</td></tr>
</table>

<p>Next, the script formats numeric variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if str(flds<a class="wiki"  href="1" rel="">1</a>.discount, 12, 2) = "" 'use convert 
 to eliminate odd values from NULL numeric</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;disc_total 
 = 0</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;disc_total 
 = round((flds<a class="wiki"  href="1" rel="">1</a>.discount * ext_total)*-.01, 2) ' discount to apply</p>


<p class=Code>end if</p>


<p class=Code>taxable_total = ext_total + disc_total ' remove discount from taxable amt (discount is negative)</p>


<p class=Code></p>


<p class=Code>if str(flds<a class="wiki"  href="1" rel="">1</a>.shipping,12,2) <> "" ' add shipping BEFORE adding tax - NOTE: If shipping is NOT taxable, add this after tax calculation</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;taxable_total = taxable_total + flds<a class="wiki"  href="1" rel="">1</a>.shipping</p>


<p class=Code>end if</p>


<p class=Code></p>


<p class=Code>if str(flds<a class="wiki"  href="1" rel="">1</a>.sales_tax, 12, 2) = "" 'use convert 
 to eliminate odd values from NULL numeric</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tax_total 
 = 0</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;
  tax_total 
 = round((flds<a class="wiki"  href="1" rel="">1</a>.sales_tax *taxable_total) *.01, 2) ' sales tax to apply</p>


<p class=Code>end if</p>


<p class=Code>inv_total = taxable_total + tax_total</td></tr>
</table>

<p>Then it converts them to character variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>ext_total_disp = alltrim( str(ext_total,12,2,"$(") ) 
 'extended total for line items</p>


<p class=Code>if disc_total = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;disc_disp 
 = "&nbsp;"</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;disc_disp 
 = alltrim( str(disc_total,12,2,"$(-B") )'Discount to display</p>


<p class=Code>end if</p>


<p class=Code>if tax_total = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tax_disp 
 = "&nbsp;"</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tax_disp 
 = alltrim( str(tax_total,12,2,"$(B") ) 'tax to display</p>


<p class=Code>end if</p>


<p class=Code>inv_disp = alltrim( str(inv_total,12,2,"$(") ) 'invoice 
 total to display</p>


<p class=Code>show_page:</td></tr>
</table>

<p>This part of the page conditionally displays the second billing address, 
 if it is not NULL.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1>&ltdl></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(cust_name) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_address_1) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt%a5 
 if alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_address_2) &lt> "" %></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(fldsc<a class="wiki"  href="1" rel="">1</a>.bill_address_2) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt%a5 
 end if %></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(cust_citystate) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&lt/dl></span></td></tr>
</table>

<p>This part of the page conditionally displays the second shipping address, 
 if it is not NULL.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1>&ltdl></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(ship_name) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(ship_address1) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt%a5 
 if ship_address2 &lt> "&nbsp;" %></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(ship_address2) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&lt%a5 
 end if %></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&ltdt></span> 
 &lt%a5 ?alltrim(ship_citystate) %> <span class=HTML1>&lt/dt></span></p>


<p class=Code><span class=HTML1>&lt/dl></span></td></tr>
</table>

<p>Finally, the page generates a row of data for each line item returned 
 from the <span class=Code1>invoice_items</span> table.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&lt%a5 for i = 1 to numitems %></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span 
 class=HTML1>&lttr></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lttd 
 class="shopcartAltDataTD bordlb" align="right"></span> 
 &lt%a5 ?alltrim(fldsi<a class="wiki"  href="i" rel="">i</a>.product_id) %> <span class=HTML1>&nbsp;&lt/td></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lttd 
 class="shopcartAltDataTD bordlb" align="left"></span> 
 &lt%a5 ?alltrim(fldsi<a class="wiki"  href="i" rel="">i</a>.desc) %> <span class=HTML1>&nbsp;&lt/td></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lttd 
 class="shopcartAltDataTD bordlb" align="right"></span> 
 &lt%a5 ?alltrim(fldsi<a class="wiki"  href="i" rel="">i</a>.price) %> <span class=HTML1>&nbsp;&lt/td></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lttd 
 class="shopcartAltDataTD bordlb" align="right"></span> 
 &lt%a5 ?alltrim(fldsi<a class="wiki"  href="i" rel="">i</a>.quan) %> <span class=HTML1>&nbsp;&lt/td></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lttd 
 class="shopcartAltDataTD bordrb" align="right"></span> 
 &lt%a5 ?alltrim(fldsi<a class="wiki"  href="i" rel="">i</a>.extension) %> <span class=HTML1>&nbsp;&lt/td></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt/tr></span></span></p>


<p class=Code><span class=HTML1>&lt%a5 next %> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>
</table>

<p class=A5>Page Security Information</p>



<p>Login Required<br>
<span class="Control">Groups Allowed > Accounting, Administrators, Clerical, Customers, Marketing</span></p>



<p class=A5>See Also</p>



<p><a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/AlphaSportsWeb Web Pages.html" title="AlphaSportsWeb Web Pages" class="wiki">Web Pages</a></p>


	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:INVDETAIL.A5W">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>