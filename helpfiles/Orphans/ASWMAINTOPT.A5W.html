	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>ASWMAINTOPT.A5W</p>



<p class=A5>Purpose</p>



<p>The ASWMAINTOPT.A5W page runs the Clear Empty Carts operation selected in 
 the <a href="ASWMAINT.A5W.html" title="ASWMAINT.A5W" class="wiki">ASWMAINT.A5W</a> page.</p>



<p class=A5>Description</p>



<p>The ASWMAINTOPT.A5W page runs in the main body section of the <a href="ASWPROCESSING.A5W.html" title="ASWPROCESSING.A5W" class="wiki">ASWPROCESSING.A5W</a> 
 frame set. ASWMAINTOPT.A5W includes the table delete 
 empty records script.</p>



<p>A <span class=Button>Continue</span> button uses inline JavaScript to 
 open the frame 'break out' page.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Since this page 
 opens within a frame set, any normal <a href="../References/Methods/RESPONSE.REDIRECT Method.html" title="RESPONSE.REDIRECT Method" class="wiki">RESPONSE.REDIRECT(</a>) 
 will just open the page defined in the body section of the frame set. 
 Any redirect must be sent to a special page <a href="FRAMEEXIT.A5W.html" title="FRAMEEXIT.A5W" class="wiki">FRAMEEXIT.A5W</a> 
 that will 'break out' of the frame set. The name of the page to open after 
 the 'break out' must be in the pg parameter.</p>



<p>ASWMAINTOPT.A5W is an internal page and must 
 have a login test for internal users. The normal login test code has a redirect. However, since this page is within a frameset, a redirect would open the page within the frameset.  So this	page is always allowed, but the test here returns the current user values.  The code after the login test will redirect to the 'break out' page if an internal user is not logged in.</span></p>



<p class=A5>Links</p>



<p>The <a href="ASWPROCESSING.A5W.html" title="ASWPROCESSING.A5W" class="wiki">ASWPROCESSING.A5W</a> 
 page calls the ASWMAINTOPT.A5W page.</p>



<p class=Pix><img src="images/ASWMAINTOPT_A5W.gif"
											x-maintain-ratio=TRUE
											style="border-left-style: Solid;
													border-left-width: 1px;
													border-right-style: Solid;
													border-right-width: 1px;
													border-top-style: Solid;
													border-top-width: 1px;
													border-bottom-style: Solid;
													border-bottom-width: 1px;
													float: none;
													width: 678px;
													height: 85px;"
											width=678
											height=85
											border=1></p>



<p class=PixCaption>ASWPRINTRPT.A5W in the WYSIWYG 
 tab of the HTML Editor </p>



<p class=A5>Edits to the Page Source</p>



<p>If ASWMAINTOPT.A5W was opened without an internal user logged in, the script 
 loads the <a href="FRAMEEXIT.A5W.html" title="FRAMEEXIT.A5W" class="wiki">FRAMEEXIT.A5W</a> page, which then 
opens the <a href="ASWINDEX.A5W.html" title="ASWINDEX.A5W" class="wiki">ASWINDEX.A5W</a> page. The page uses the function <span class="Code"><a href="../References/Functions/A5WS_Logged_In_User_Values Function.html" title="Returns field values from the user table for the current user" class="wiki">a5ws_logged_in_user_values</a></span><a href="../References/Functions/A5WS_Logged_In_User_Values Function.html" title="Returns field values from the user table for the current user" class="wiki">(</a>) to determine if a user is logged in.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim pUser as p</p>


<p class=Code>a5ws_logged_in_user_values(pUser,request,session)</p>


<p class=Code>if pUser.userid = "" ' no one logged in</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;
  response.redirect("frameexit.a5w?pg=aswindex.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>elseif left(pUser.ulink,1) <> "I" ' not internal user</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;
  response.redirect("frameexit.a5w?pg=aswindex.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if </p>


<p class=Code>sleep(.5) ' give top frame time to display</td></tr>
</table>

<p>The script deletes the records in SHOP_CART.DBF that 
 have NULL Session_ID values.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">

<p class=Code>a_tbl = table.open( "<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\ shop_cart.dbf ")</p>


<p class=Code>a_tbl.delete_range( "Session_Id = \"\"")</p>


<p class=Code>a_tbl.close()</p>


</td></tr>
</table>

<p>If the page does not exit beforehand, 
 it eventually displays "Processing Complete" and a button with 
 the label "Click Here to Continue". Clicking this button loads 
 the <a href="FRAMEEXIT.A5W.html" title="FRAMEEXIT.A5W" class="wiki">FRAMEEXIT.A5W</a> page, which then opens 
 the <a href="ASWINDEX.A5W.html" title="ASWINDEX.A5W" class="wiki">ASWINDEX.A5W</a> page.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><body></p>


<p class=Code><table width="800"></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 align= "middle" class= "style1">Processing Complete</td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td>& 
 nbsp ;</td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 align="middle"></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input 
 name="continue" type="button" id="continue" 
 value="Click Here to Continue" onclick="window.location='frameexit.a5w?pg=aswindex.a5w'"></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;</tr></p>


<p class=Code></table></p>


<p class=Code
<!---HELPMETADATA: {"group":"/References/Server/Pages"} --->
</body></html>