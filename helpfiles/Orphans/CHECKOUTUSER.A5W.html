	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>CHECKOUTUSER.A5W</p>



<p class=A5>Purpose</p>



<p>The CHECKOUTUSER.A5W page is the second step in the checkout process. 
 It allows the customer to enter shipping and billing information.</p>



<p class=A5>Description</p>



<p>The CHECKOUTUSER.A5W page contains the <a href="NAV_MAIN Navigation Component.html" title="NAV_MAIN Navigation Component" class="wiki">NAV_MAIN</a> 
 navigation and <a href="DLG_UCHKOUT Dialog Component.html" title="DLG_UCHKOUT Dialog Component" class="wiki">DLG_UCHKOUT</a> 
 dialog component. The page has two extra buttons on the left side of the 
 page. The top button causes code in the dialog's <span class=Code1>Validate</span> 
 event to read the user's billing and shipping information from the customer 
 table and fill in the form's fields. The dialog's <span class=Code1>AfterValidate</span> 
 code saves the dialog values to protected session variables. It also saves 
 any edits made to an existing customer record.</p>



<p class=A5>Links</p>



<p>The <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a> page displays 
 the CHECKOUTUSER.A5W page. Errors can cause the <a href="CHECKOUTCOMP.A5W.html" title="CHECKOUTCOMP.A5W" class="wiki">CHECKOUTCOMP.A5W</a> 
 page to redirect back to the CHECKOUTUSER.A5W page.</p>



<p class=Pix><img src="images/ASW_CHECKOUTUSER_A5W.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							float: none;
							width: 608px;
							height: 450px;"
					width=608
					height=450
					border=1></p>



<p class=PixCaption>CHECKOUTUSER.A5W in the WYSIWYG tab of the HTML Editor 
 </p>



<p class=Pix><img src="images/ASW_CHECKOUTUSER_A5W_2.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							width: 608px;
							height: 417px;
							float: none;"
					width=608
					height=417
					border=1></p>



<p class=PixCaption>CHECKOUTUSER.A5W in the Browser </p>



<p class=A5>Page Source</p>



<p>The first part of the page script checks the value of <span class=Code1>session.<strong>protected</strong>chkoutprogress</span>. 
 If FALSE (.F.), the user is redirected to <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a>. 
 If the value of <span class=Code1>session.<strong>protected</strong>chkoutprogress</span> 
 is less than 1, the user has not finished the first checkout page, and 
 is redirected to CHECKOUTCART.A5W.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.<strong>protected</strong>chkoutprogress") 
 = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>elseif session.<strong>protected</strong>chkoutprogress < 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>The <span class=Code1>a5w_include("loggedinvalues.a5w")</span> statement runs the code on the <a href="LOGGEDINVALUES.A5W.html" title="LOGGEDINVALUES.A5W" class="wiki">LOGGEDINVALUES.A5W</a> 
 page. This page creates and sets the values of <span class="Code1">session.<strong>protected</strong>pUser.userid, session.<strong>protected</strong>pUser.type</span>,  and <span class="Code1">session.<strong>protected</strong>pUser.name</span>. If the user type is internal, they are redirected back to the  <a href="CHECKOUTCART.A5W.html" title="CHECKOUTCART.A5W" class="wiki">CHECKOUTCART.A5W</a> page as internal users can not check out a shopping cart. Various messages that are shown on the left side of the page are created based on information about the logged user. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5w_include("<span class="Code1">loggedinvalues</span>.a5w")</p>





<p class=Code>if session.<strong>protected</strong>pUser.type = "I" ' internal user, no access</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("checkoutcart.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if session.<strong>protected</strong>pUser.ulink = "" ' no user link, can't get user record</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg1 = "Already a Registered User?"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg2 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button1 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg3 = "You can log in now"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg4 = "Login Now"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if session.<strong>protected</strong>pUser.name = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg1 = "Welcome !"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg3 = "You can log in now if you are not the current user"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg1 = "Welcome <strong>"+alltrim(session.<strong>protected</strong>pUser.name)+"!</strong>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg3 = "Log out now if you are not <strong>"+alltrim(session.<strong>protected</strong>pUser.name)+"</strong>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg2 = "<span align=\&quot;justify\&quot;>You can add your information by selecting the option below.</span>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button1 = "<input name=\&quot;adduser\&quot; type=\&quot;submit\&quot; class=\&quot;hiddenbutton\&quot; id=\&quot;adduser\&quot; value=\&quot;Add My Information\&quot;>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg4 = "Logout Now"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>end if 

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<p class=Code></td></tr>
</table>

<p>This code initializes several session variables.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>session.enteruserdata = "" ' used by dialog to 
 populate dialog</p>


<p class=Code>session.targetURL = "" ' reset to no value</p>


<p class=Code>session.dataclear = .F. ' do not clear data</td></tr>
</table>

<p>This code checks if the user clicked the <span class="Control">Clear Entries</span> button. If so, the login 
 cookie is cleared and the login values are reset. If the user clears the 
 current user information, it indicates they are going to enter different 
 user information. Therefore the current user is automatically logged out 
 to force the current shopping cart and sale to be credited to the correct 
 user.</p>



<p>Execution skips forward to <span class=Code1>runpage</span> and the 
 page appears.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("clearbutton")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a5ws_logoutuser(session,request,response) ' logout user</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a5w_include("loggedinvalues.a5w") 'reload user values</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;session.dataclear = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;goto runpage</p>


<p class=Code>end if</td></tr>
</table>

<p>If the user clicks the "Add My Information" button under "You can add your information by ...", the code checks for the existence of <span class=Code1>adduser.</span> If no one is logged in, this button action is invalid and a login must be forced. The code does this by checking if <span class="Code1">session.<strong>protected</strong>pUser.ulink</span> has a value. If not, it knows no one is logged on and sets a value for <span class=Code1>logon</span> to force the next code to evaluate and force a logon</p>



<p>Otherwise, the script stores<span class="Code1">session.<strong>protected</strong>pUser.ulink</span> in <span class=Code1>session.enteruserdata</span>. If the user clicks the "Login Now " button under "Already a Registered User?", the code redirects the user to <a href="LOGIN.A5W.html" title="LOGIN.A5W" class="wiki">LOGIN.A5W</a> and adds the current page URL in a variable named "np". The login code will redirect back to the page in "np" after login. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("adduser") ' adduser button pushed</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if  session.<strong>protected</strong>pUser.ulink = "" ' no user logged on, force logon</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logon = "Here"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else  ' ok to add user data</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.enteruserdata = alltrim(session.<strong>protected</strong>pUser.ulink)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto runpage ' ok to skip next code 'if' section</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</p>


<p class=Code>if eval_valid("logon") ' either selected or forced logon</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("login.a5w?np="+substr(request.script_name,at("/",request.script_name,-1)+1)) 'go to logon page</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>runpage:</td></tr>
</table>

<p>The <span class=Code1>location = ""</span> statement clears any highlighted selection on the menu. The <span class=Code1>style_name = "shopcart"</span> statement sets the style of the navigation  component. The <span class=Code1>pgstyle = tmpl_NAV_MAIN.style_name</span> statement saves the style of the navigation component in <span class=Code1>pgstyle</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>with tmpl_NAV_MAIN</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;location = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;style_name = "shopcart"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;componentName = "NAV_MAIN"</p>


<p class=Code>end with</p>


<p class=Code>pgstyle = tmpl_NAV_MAIN.style_name</td></tr>
</table>

<p>The  <a href="DLG_UCHKOUT Dialog Component.html" title="DLG_UCHKOUT Dialog Component" class="wiki">DLG_UCHKOUT</a> dialog component has client side validation applied. The validation checks for required values in certain fields before the user can exit the page. If the user clicks the <span class="Control">Clear Entries </span>button to clear the entered values, the validation is applied as the button is actually a submit button. A JavaScript action is added to the <span class="Control">Clear Entries</span> button to call a JavaScript function named <span class="Code1">setdummy()</span> that enters blank spaces in the required fields. The validation will see the fields as having a value and allow the button action to continue. </p>


<p>The <span class="Code1">ship_same</span> checkbox  control on the  <a href="DLG_UCHKOUT Dialog Component.html" title="DLG_UCHKOUT Dialog Component" class="wiki">DLG_UCHKOUT</a> dialog component also has a JavaScript function If the user checks the box, the billing information will be added to the shipping information controls. If they uncheck the checkbox, the shipping values are cleared. This JavaScript is added to the page <span class="HTML1"><head></span> section rather than attached in a file. </p>



<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
	
<p class=Code><span class=HTML1></span></p>



</td></tr>
</table>

<p class=A5>Page Security Information</p>



<p>Always Allowed</p>



<p class=A5>See Also</p>



<p><a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/AlphaSportsWeb Web Pages.html" title="AlphaSportsWeb Web Pages" class="wiki">Web Pages</a></p>



	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:CHECKOUTUSER.A5W">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"/Reference/Server/Design/View/A5W/","status":"pending","keywords":"server,ref,a5w"} --->
</body></html>