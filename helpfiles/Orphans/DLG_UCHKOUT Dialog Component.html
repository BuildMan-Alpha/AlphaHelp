	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>DLG_UCHKOUT Dialog Component</p>



<p class=A5>Purpose</p>



<p>The DLG_UCHKOUT dialog component is part of the checkout process. It 
 captures or displays the customer information required by the billing 
 and shipping processes.</p>



<p class=Pix><img src="images/ASW_DLG_UCHKOUT.gif"
					x-maintain-ratio=TRUE
					style="width: 370px;
							height: 409px;
							border-left-style: Solid;
							border-top-style: Solid;
							border-right-style: Solid;
							border-bottom-style: Solid;
							border-left-width: 1px;
							border-right-width: 1px;
							border-top-width: 1px;
							border-bottom-width: 1px;
							border-left-color: #000000;
							border-right-color: #000000;
							border-top-color: #000000;
							border-bottom-color: #000000;
							float: none;"
					width=370
					height=409
					border=1> </p>



<p class=A5>Description</p>



<p>The DLG_UCHKOUT dialog component contains the text controls necessary 
 to enter a new <span class=Code1>customer</span> table record or display 
 an existing record. The DLG_UCHKOUT dialog illustrates the use of merge controls and headings. The component uses client side expressions to show and hide a heading used to show an error. The controls have the same names as the fields in the <span class="Code1">customer</span> table. </p>



<p class=A5>Containers</p>



<p><a href="CHECKOUTUSER.A5W.html" title="CHECKOUTUSER.A5W" class="wiki">CHECKOUTUSER.A5W</a></p>



<p class=A5>Notable Grid Control Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader" colspan="1" rowspan="1">
<p class=TableHead>Control</td>
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>ShowError</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Hidden".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>HeadingError</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Heading".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Show/Hide Expression</span> </td>
<td class="TableCell">
<p class=TableLeft><span class="Button">Expression</span> ShowError !="" </p>

</td></tr>
 
<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Heading Properties</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Text</span> set to "Your information can not be found.  Please re-enter".</p>

</td></tr>


<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Heading1</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Heading".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Heading Properties</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Text</span> set to "<span class="HTML1"><table width="100%" cellpadding="0" cellspacing="0" style="font-family:  Arial; font-size:  14px; color:  #00007f; border-top-style:  ridge; border-top-width:  1px; border-top-color:  #CCCCCC; border-bottom-style:  ridge; border-bottom-width:  1px; border-bottom-color:  #CCCCCC; "><br>
<tr><br>
<td><img src="css/BlueWhite/RowMarkerOn.png" > Personal Information</td><br>
</tr><br>
</table></span>
".</p>

</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>customer_id</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Hidden".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells Begin" rel="">Merge Cells Begin</a>.3</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Merge Cells  Properties > Row headings </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Name (First, Last) ".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Firstname</td>
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> set to TRUE.
<p class=TableLeft><span class=Button>General > Require value</span> set to TRUE.
<p class=TableLeft><span class=Button>General > Custom error message</span> set to "First Name Required" </td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Client side validation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Lastname</td>
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> set to TRUE.
<p class=TableLeft><span class=Button>General > Require value</span> set to TRUE.
<p class=TableLeft><span class=Button>General > Custom error message</span> set to "Last Name Required" </td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Client side validation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr>


<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells End" rel="">Merge Cells End</a>.3</td>
<td class="TableCell">
  <p class=TableLeft></td>
<td class="TableCell">
  <p class=TableLeft></td></tr>
  
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells Begin" rel="">Merge Cells Begin</a>.1</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Merge Cells  Properties > Row headings </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "City, St, Zip  ". 
<p class=TableLeft><span class="Code1">Bill_city, Bill_state_region, and Bill_postal_code</span> controls in merged section</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Bill_state_region</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Dropdown".</p>

</td></tr>
 
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">DropDownBox Properties  > Choices </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Define Choices > List type</span> 
 is set to "Dynamic".</p>


<p class=TableLeft><span class=Button>Data Source > Data source type</span> 
 is set to "Variable".</p>


<p class=TableLeft><span class=Button>Data Source > Variable name</span> 
 is set to "states".</p>

</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells End" rel="">Merge Cells End</a>.1</td>
<td class="TableCell">
  <p class=TableLeft></td>
<td class="TableCell">
  <p class=TableLeft></td></tr>
  
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Heading2</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Heading".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Heading Properties</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Text</span> set to "<span class="HTML1"><table width="100%" cellpadding="0" cellspacing="0" style="font-family:  Arial; font-size:  14px; color:  #00007f; border-top-style:  ridge; border-top-width:  1px; border-top-color:  #CCCCCC; border-bottom-style:  ridge; border-bottom-width:  1px; border-bottom-color:  #CCCCCC; "><br>
<tr><br>
<td><img src="css/BlueWhite/RowMarkerOn.png" > Shipping Information</td><br>
</tr><br>
</table></span>
".</p>

</td></tr>  




<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>Ship_same</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Row Properties  </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Freeform layout</span> set to TRUE.
<p class=TableLeft><span class=Button>Freeform template</span> set to "<span class=HTML1>{ship_same}</span>". The template will be replaced in the <span class="Code1">Activate</span> event code. </td></tr>


<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft>Ship_to_Name</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</td></tr>


<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Ship_to_Address_1</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Client side validation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr> 

 
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells Begin" rel="">Merge Cells Begin</a>.2</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Merge Cells  Properties > Row headings </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "City, St, Zip  ". 
<p class=TableLeft></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Ship_City</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Client side validation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>Ship_state_region</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Dropdown".</p>

</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> set to TRUE.</td></tr> 
 
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">DropDownBox Properties  > Choices </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Define Choices > List type</span> 
 is set to "Dynamic".</p>


<p class=TableLeft><span class=Button>Data Source > Data source type</span> 
 is set to "Variable".</p>


<p class=TableLeft><span class=Button>Data Source > Variable name</span> 
 is set to "states".</p>

</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Ship_postal_code</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Client side validation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells End" rel="">Merge Cells End</a>.2</td>
<td class="TableCell">
  <p class=TableLeft></td>
<td class="TableCell">
  <p class=TableLeft></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Heading3</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings  > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Heading".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Heading Properties</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Text</span> set to "<span class="HTML1"><table width="100%" cellpadding="0" cellspacing="0" style="font-family:  Arial; font-size:  14px; color:  #00007f; border-top-style:  ridge; border-top-width:  1px; border-top-color:  #CCCCCC; border-bottom-style:  ridge; border-bottom-width:  1px; border-bottom-color:  #CCCCCC; "><br>
<tr><br>
<td><img src="css/BlueWhite/RowMarkerOn.png" > Contact Information</td><br>
</tr><br>
</table></span>
".</p>

</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft>Email</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>Text Format > Regular Expression</span> 
 set to "\b<a class="wiki"  href="A-Z0-9a-z._%-" rel="">A-Z0-9a-z._%-</a>+@<a class="wiki"  href="A-Z0-9a-z._%-" rel="">A-Z0-9a-z._%-</a>+\.<a class="wiki"  href="A-Za-z" rel="">A-Za-z</a>{2,4}\b".</td></tr>
</table>

<p class=A5>Notable Component Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Dialog Footer Layout > Freeform 
 layout</span></td>
<td class="TableCell">
<p class=TableLeft>Changed to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Dialog Footer Layout > Dialog 
 footer template</span></td>
<td class="TableCell">
<p class=TableLeft>Changed to " <span class=HTML1><div align="center">{SubmitButton}&nbsp;<input 
 class="BlueWhiteButton" type="submit" value="&nbsp;&nbsp;Clear 
 Entries&nbsp;&nbsp;" name="clearbutton"></div></span> 
 ".</td></tr>
</table>

<p class=A5>Event Code</p>



<p>The <span class=Code1>Validate</span> event code checks if the entered email already exists in the customer file. If one is found, it compares the <span class="Code1">customer_id</span> from that record with the <span class="Code1">customer_id</span> for the current user. The values should match if  the record found is for the current customer. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>chkcust = table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.dbf","customer_id","email","email=\""+alltrim(CurrentForm.Controls.Email.value)+"\"")</p>


<p class=Code>if chkcust <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if chkcust <> alltrim(CurrentForm.Controls.customer_id) ' email already exists for another customer</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Has_Error = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Error_Message = "A Registered User with this email already exists.  Please correct or Log In"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</td></tr>
</table>


<p>&nbsp;</p>


<p>The <span class=Code1>AfterValidate</span> event code starts by checking 
  the <span class=Code1>session.dataclear</span> variable. If it is TRUE, 
  there is no data to validate and the script exits.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.dataclear")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if session.dataclear = .T. ' skip validate if clearing data</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if </p>

</td></tr>
</table>

<p>Next, the script sets <span class=Code1>session.<strong>protected</strong>chkoutprogress</span> 
 to 2, indicating that this page is complete.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>session.<strong>protected</strong>chkoutprogress = 2</td></tr>
</table>

<p>The following statements copy the values in the various controls on 
 the dialog component into the <span class=Code1>session.<strong>protected</strong>chkout</span> 
 dot variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim session.<strong>protected</strong>chkout as p</p>


<p class=Code>session.<strong>protected</strong>chkout.Firstname =  alltrim(CurrentForm.Controls.Firstname)</p>


<p class=Code>session.<strong>protected</strong>chkout.Lastname =  alltrim(CurrentForm.Controls.Lastname)</p>


<p class=Code>session.<strong>protected</strong>chkout.Company =  alltrim(CurrentForm.Controls.company)</p>


<p class=Code>session.<strong>protected</strong>chkout.Email =  alltrim(CurrentForm.Controls.Email)</p>


<p class=Code>session.<strong>protected</strong>chkout.Phone =  transform(remspecial(CurrentForm.Controls.phone),"@R (999) 999-9999") ' convert to standard mask template</p>


<p class=Code>session.<strong>protected</strong>chkout.Bill_address_1 =  alltrim(CurrentForm.Controls.Bill_address_1)</p>


<p class=Code>session.<strong>protected</strong>chkout.Bill_address_2 =  alltrim(CurrentForm.Controls.Bill_address_2)</p>


<p class=Code>session.<strong>protected</strong>chkout.Bill_city =  alltrim(CurrentForm.Controls.Bill_city)</p>


<p class=Code>session.<strong>protected</strong>chkout.Bill_state_region =  alltrim(CurrentForm.Controls.Bill_state_region)</p>


<p class=Code>session.<strong>protected</strong>chkout.Bill_postal_code =  alltrim(CurrentForm.Controls.Bill_postal_code)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_to_name =  alltrim(CurrentForm.Controls.Ship_to_Name)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_address_1 =  alltrim(CurrentForm.Controls.Ship_address_1)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_address_2 =  alltrim(CurrentForm.Controls.Ship_address_2)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_city =  alltrim(CurrentForm.Controls.Ship_City)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_same =  alltrim(CurrentForm.Controls.Ship_same)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_state_region =  alltrim(CurrentForm.Controls.Ship_state_region)</p>


<p class=Code>session.<strong>protected</strong>chkout.Ship_postal_code =  alltrim(CurrentForm.Controls.Ship_postal_code)</p>


<p class=Code>session.<strong>protected</strong>chkout.Customer_id = alltrim(CurrentForm.Controls.customer_id)</p>


</td></tr>
</table>

<p>If the <span class=Code1>customerid</span> control has a non-null value, 
 the script uses this value to retrieve the corresponding record from the 
 <span class=Code1>customer</span> table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if CurrentForm.Controls.customerid <> "" 
 ' values came from a table record</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.filter 
 = "customer_id = " + quote(CurrentForm.Controls.customerid) 
 ' find the record</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.order 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl 
 = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;qdx 
 = tbl.query_create()</td></tr>
</table>

<p>If the query finds a single record, then the script writes the values 
 in the dialog's controls into the fields of the customer record.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 qdx.records_get()= 1 then 'record found - update</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Firstname 
 = alltrim(CurrentForm.Controls.Firstname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Lastname 
 = alltrim(CurrentForm.Controls.Lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Company 
 = alltrim(CurrentForm.Controls.company)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Email 
 = alltrim(CurrentForm.Controls.Email)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Phone 
 = transform(remspecial(CurrentForm.Controls.phone),"@R (999) 999-9999") 
 ' convert to standard mask template</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Bill_address_1 
 = alltrim(CurrentForm.Controls.bill_address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Bill_address_2 
 = alltrim(CurrentForm.Controls.bill-address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Bill_city 
 = alltrim(CurrentForm.Controls.bill_city)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Bill_state_region 
 = alltrim(CurrentForm.Controls.bill_state_region)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Bill_postal_code 
 = alltrim(CurrentForm.Controls.Bill_postal_code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_to_name 
 = alltrim(CurrentForm.Controls.Ship_to_Name)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_address_1 
 = alltrim(CurrentForm.Controls.Ship_to_Address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_address_2 
 = alltrim(CurrentForm.Controls.Ship_to_Address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_city 
 = alltrim(CurrentForm.Controls.Ship_City)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_state_region 
 = alltrim(CurrentForm.Controls.Ship_state_region)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_postal_code 
 = alltrim(CurrentForm.Controls.Ship_to_Zip)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if alltrim(CurrentForm.Controls.ship_same) = "True"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_same = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Ship_same = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


<p class=Code>end if</td></tr>
</table>

<p>Finally the script sets <span class=Code1>CurrentForm.RedirectTarget</span> 
 to next desired page. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>'NOTE: to use PayPal pages, uncomment out first line and comment out second line</p>


<p class=Code>'CurrentForm.RedirectTarget = "checkoutcompPayPal.a5w"</p>


<p class=Code>CurrentForm.RedirectTarget = "checkoutcomp.a5w"</p>

</td></tr>
</table>

<p>&nbsp;</p>


<p>The <span class=Code1>Activate</span> event code first sets the <span class="Code1">ShowError</span> value to blank to hide the heading. It then populates a list for the state dropdown controls, and gets a list of editable controls on the dialog. Some controls are not editable and are removed from the list of controls. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>CurrentForm.Controls.ShowError.value = ""</p>


<p class=Code>dim states as c ' populate state list for dropdowns</p>


<p class=Code>states = ""+crlf()+cstates("A"+crlf()) ' add blank first entry</p>


<p class=Code>dim Control_list as c</p>


<p class=Code>Control_list = properties_enum(CurrentForm.Controls)</p>


<p class=Code>dim remove as c ' controls to ignore</p>


<p class=Code>remove = <<%text%</p>


<p class=Code>ShowError</p>


<p class=Code>HeadingError</p>


<p class=Code>Heading1</p>


<p class=Code>Heading2</p>


<p class=Code>Heading3</p>


<p class=Code>%text%</p>


<p class=Code>Control_list = filter_string_multi(Control_list,remove,crlf(),.T.)</p>


<p class=Code>Control_list = remove_blank_lines(control_list)</p>

</td></tr>
</table>

<p>The event code next tests to see if the 
  <span class=Code1>session.dataclear</span> variable exists and is TRUE. 
 If so, it loops through the editable control list to erase the values of the dialog's controls and the <span class=Code1>session.<strong>protected</strong>chkout</span> 
 variable, then exits. Finally, it sets <span class=Code1>session.dataclear</span> 
 to FALSE.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.dataclear") = .T. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if session.dataclear = .t. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for each foo in Control_list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("CurrentForm.Controls."+ foo +".value") = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("session.<strong>protected</strong>chkout."+foo) = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.dataclear  = .F. 'clear once unless reset on page</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end  if</p>


<p class=Code>end if
</td></tr>
</table>

<p>The next step is to test if the <span class=Code1>session.enteruserdata</span> 
 variable (a customer ID) exists and is NULL. If this is the case, the 
 script copies the data from <span class=Code1>session.<strong>protected</strong>chkout</span> 
 into the dialog's controls. This variable contains data saved info from 
 a previous visit to this page. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.enteruserdata") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if  session.enteruserdata = "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if  eval_valid("session.<strong>protected</strong>chkout")</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for each foo in Control_list</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("session.<strong>protected</strong>chkout."+foo)</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("CurrentForm.Controls."+foo+".value") = eval("session.<strong>protected</strong>chkout."+foo)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end  if</td></tr>
</table>

<p>If the <span class=Code1>session.enteruserdata</span> variable contains 
 data, the script uses it to find the appropriate customer record. If it 
 finds a record, the script copies the record data into the dialog's controls. If a single record can not be found for the current <span class="Code1">customer_id</span>, the <span class="Code1">ShowError</span> control will have a value and the error heading will display. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query.filter 
 = "alltrim(customer_id) = " + quote(session.enteruserdata)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query.order 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl 
 = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qdx 
 = tbl.query_create()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 qdx.records_get()= 1 then 'record found</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.customer_id 
 = alltrim(tbl.Customer_id)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Firstname 
 = alltrim(tbl.Firstname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Lastname 
 = alltrim(tbl.Lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.company 
 = alltrim(tbl.Company)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Email 
 = alltrim(tbl.Email)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.phone 
 = alltrim(tbl.Phone)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Bill_address_1 
 = alltrim(tbl.Bill_address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Bill_address_2 
 = alltrim(tbl.Bill_address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Bill_city 
 = alltrim(tbl.Bill_city)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Bill_state_region 
 = alltrim(tbl.Bill_state_region)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Bill_postal_code 
 = alltrim(tbl.Bill_postal_code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 tbl.Ship_same = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Name 
 = alltrim(tbl.Firstname) + " "+alltrim(tbl.Lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Address 
 = alltrim(tbl.Bill_address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.saddr2 
 = alltrim(tbl.Bill_address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_City 
 = alltrim(tbl.Bill_city)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_State 
 = alltrim(tbl.Bill_state_region)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Zip 
 = alltrim(tbl.Bill_postal_code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_same 
 = "True" </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Name 
 = alltrim(tbl.Ship_to_name)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Address 
 = alltrim(tbl.Ship_address_1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.saddr2 
 = alltrim(tbl.Ship_address_2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_City 
 = alltrim(tbl.Ship_city)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_State 
 = alltrim(tbl.Ship_state_region)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_to_Zip 
 = alltrim(tbl.Ship_postal_code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.Ship_same 
 = "False" </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end  if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.ShowError = "yes"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end  if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</td></tr>
</table>

<p>Next, the script sets <span class=Code1>session.enteruserdata</span> 
 to NULL.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;session.enteruserdata 
 = ""</td></tr>
</table>

<p>If <span class=Code1>session.enteruserdata</span> does not exist, but 
 <span class=Code1>session.<strong>protected</strong>chkout</span> does exist, the script 
 copies the contents of <span class=Code1>session.<strong>protected</strong>chkout</span> 
 into the dialog's controls.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>elseif eval_valid("session.<strong>protected</strong>chkout")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for each foo in Control_list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("session.<strong>protected</strong>chkout."+foo)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval("CurrentForm.Controls."+foo + ".value") = eval("session.<strong>protected</strong>chkout."+foo)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>end if
</td></tr>
</table>

<p>Finally, the freeform template for <span class="Code1">ship_same</span> is modified based on the current value in the <span class="Code1">ship_same</span> control. The control includes on <span class="HTML1">onclick</span> event that calls a JavaScript function on the <a href="CHECKOUTUSER.A5W.html" title="CHECKOUTUSER.A5W" class="wiki">CHECKOUTUSER.A5W</a> page. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if CurrentForm.Controls.ship_same = "True"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.ship_same.column.FreeFormTemplate = <<%html%</p>


<p class=Code><input id="dlg_uchkout_SHIP_SAME" type="checkbox" value="True" name="SHIP_SAME" onclick="shipsame(this.form)" checked="checked" /></p>


<p class=Code>%html%</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.ship_same.column.FreeFormTemplate = <<%html%</p>


<p class=Code><input id="dlg_uchkout_SHIP_SAME" type="checkbox" value="False" name="SHIP_SAME" onclick="shipsame(this.form)"  /></p>


<p class=Code>%html%</p>


<p class=Code>end if




	




</td></tr>
</table>


<p class=A5>See Also</p>



<p><a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/Web Publishing Components.html" title="Web Publishing Components" class="wiki">Web Publishing Components</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DLG_UCHKOUT+Dialog+Component">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>