	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>FLATTENQUERY()and CROSSLEVEL()Compared</p>



<p>In a form or a browse, Alpha Five does not allow you to include fields 
 from a one-to-many child table in a query. (This restriction does not apply to report, 
 letters and labels). However, if you use the FLATTENQUERY() or the CROSSLEVEL() functions, 
 you can include one-to-many child fields in your query.</p>



<p>The FLATTENQUERY() function, has the effect of flattening the set, and 
 making it appear&nbsp;as&nbsp;a single table. In is generally used in 
 the context of a Browse layout.</p>



<p>The CROSSLEVEL() function, on the other hand allows you to find a list 
 of parent records in a set, using fields from one-many child tables in 
 the filter expression. Is generally used in the context of a form layout.</p>



<p>An example will help clarify the difference. Assume that you have two 
 tables, Patrons and Donations, linked in a one-many relationship.</p>



<p class=A5>Patron</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Id</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Name</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Jones</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>King</td></tr>
</table>
</div>
<p class=A5>Donation</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Id</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/20/2001</td></tr>
</table>
</div>
<p>The "composite" table for the set looks like this:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Id</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Name</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Jones</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Jones</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>King</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>King</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>King</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/20/2001</td></tr>
</table>
</div>
<p>If you are viewing this set in a Browse layout, then you will see the 
 "composite" table for the set,&nbsp;as&nbsp;shown above.&nbsp;as&nbsp;you 
 can see, the set just appears&nbsp;as&nbsp;a "flat" table. Using 
 the FLATTENQUERY() function in a query, you can select all donations greater 
 or equal to $3,000. The result would appear in the Browse layout&nbsp;as&nbsp;follows:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Id</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Name</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Smith</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>Jones</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/10/2001</td></tr>
</table>
</div>
<p>The filter expression for the above query would be:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Flattenquery(donations->amount >= 3000)</td></tr>
</table>

<p>Now let's consider how this set looks in the context of a form:</p>



<p>Here is how the first record for Smith looks:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Donations</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/10/2001</td></tr>
</table>
</div>
<p>Here is how the second record for Jones looks:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Donations</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/01/2001</td></tr>
</table>
</div>
<p>And, here is how the third record for King looks:</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Donations</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/20/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/20/2001</td></tr>
</table>
</div>
<p>Assuming you wanted to find all donors who had donated $3,000 or more. 
 The filter expression would be:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Crosslevel("donations->amount> = 3000")</td></tr>
</table>

<p>After you had run this query, Alpha Five would report that two records 
 had been found (i.e. the record for Smith, and the record for Jones). 
 When you viewed the result of the query in your form you would see these 
 two records.</p>



<p class=A5>Name: Smith</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Donations</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/01/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>1,500</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>4/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>4,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/10/2001</td></tr>
</table>
</div>
<p class=A5>Name: Jones</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Donations</td>
<td_null></tr>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Amount</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Date</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>3/10/2001</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>2,000</td>
<td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">
<p class=TableLeft>5/01/2001</td></tr>
</table>
</div>
<p>Note that Alpha Five continues to display all of the child records for 
 each parent record. I.e. the forms for Smith and Jones show all of the 
 donations, not just those of $3,000 or more.</p>



<p>In effect, the CROSSLEVEL()query can be used to get a list of parent 
 records that meet your criteria, even if the criteria include fields from 
 a one-many child table.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : There is an 
 important difference in the syntax between FLATTENQUERY()and CROSSLEVEL(). 
 In the case of FLATTENQUERY() the argument (i.e. the filter expression) 
 is not quoted, whereas in the case of CROSSLEVEL()the argument is quoted.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : If you are in 
 a form or a browse layout and you select the <a href="../Unclassified/Query by Expression.html" title="Query by Expression" class="wiki">&lt;span   class=Screen&gt;Query by Expression&lt;/span&gt;</a> , or <a href="../Unclassified/Query Genie.html" title="Query Genie" class="wiki">&lt;span   class=Screen&gt;Query Genie&lt;/span&gt;</a> commands, these command will automatically 
 insert the appropriate FLATTENQUERY() or CROSSLEVEL() function into the 
 query filter. In addition, if you use the <FORM>.QUERYRUN(), or 
 the <BROWSE>.QUERYRUN() methods, Alpha Five automatically inserts 
 FLATTENQUERY() or CROSSLEVEL()into the filter expression. You only need 
 to be aware of these functions if you are using low level Xbasic to create 
 a query.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : If you want 
 to use Xbasic to do a query on the records shown by a form or browse, 
 the <a href="../References/Methods/OBJECT.QUERYRUN Method.html" title="OBJECT.QUERYRUN Method" class="wiki">&lt;FORM&gt;.QUERYRUN(</a>), 
 or the <a href="../References/Methods/OBJECT.QUERYRUN Method.html" title="OBJECT.QUERYRUN Method" class="wiki">&lt;BROWSE&gt;.QUERYRUN(</a>) 
 methods provide an alternative approach. Internally, these methods use 
 the <TBL>.QUERY_CREATE() method, but they just encapsulate several 
 Xbasic commands into a single Xbasic command. See example below.</p>



<p>Flags is an optional parameter. If flags is set to "N", then 
 Alpha Five will not add the query to the list of most recent queries remembered. 
 Normally, Alpha Five remembers the last four queries executed for a table 
 or a set.</p>



<p class=A5>Example</p>



<p>Build a query list for customers from Massachusetts, in last name order. 
 Then display a message box with the number of selected records.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Customers in MA"</p>


<p class=Code>query.order = "LAST_NAME"</p>


<p class=Code>query.filter = "STATE_PROV = 'MA' "</p>


<p class=Code>query.options = ""</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>rec_count = indx.records_get()</p>


<p class=Code>ui_msg_box("", "Number of records selected: 
 " + ltrim (str(rec_count,5,0) ) )</p>


<p class=Code>parent.resynch()<p class=Code>&nbsp;<p class=Code>&nbsp;</td></tr>
</table>

<p>Same as above, but references a variable that contains the state name. Note 
that this example uses the s_quote() function for creating the filter 
expression. S_quote() is an extremely useful function when creating filter 
expressions that reference variables because s_quote() can generate the correct 
filter expression regardless of the data type of the referenced variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table1">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>dim vStateName as c </p>


<p class=Code>vStateName = "MA"</p>


<p class=Code>query.description = "Customers in " + vStateName</p>


<p class=Code>query.order = "LAST_NAME"</p>


<p class=Code>query.filter = "STATE_PROV = " + s_quote(vStateName)</p>


<p class=Code>query.options = ""</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>rec_count = indx.records_get()</p>


<p class=Code>ui_msg_box("", "Number of records selected: 
 " + ltrim( str(rec_count,5,0) ) )</p>


<p class=Code>parent.resynch()<p class=Code>&nbsp;<p class=Code>&nbsp;</td></tr>
</table>

<p>Runs a query then displays a message box saying whether a query list 
 was built, or an existing index was selected. (If a query can be satisfied by 
using an existing Index, Alpha Five's Lightening Query Optimization feature will 
select the index. This will result in getting the query result instantaneously, 
rather than the more time consuming process of actually building a query list. 
You can control whether Alpha Five returns an index or not by specifying the 
appropriate flags in 'query.options').</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Lastname order"</p>


<p class=Code>query.filter = ".T."</p>


<p class=Code>query.order = "LAST_NAME"</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>type = indx.type_get()</p>


<p class=Code>select</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CASE type = 2</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;type_desc = "An index was selected"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CASE type = 6</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;type_desc = "A query list was 
 built"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CASE else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;type_desc = "Unknown query type"</p>


<p class=Code>end select</p>


<p class=Code>ui_msg_box("Query type:",type_desc)</td></tr>
</table>

<p>A form has a variable on it that allows the user to enter a date The 
 form has a button that does a query for records with an invoice date that 
 matches the value in the variable. The variable is a date variable and is called <span class=Code1>whatDate</span>. 
 It is a global variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Invoices for certain date"</p>


<p class=Code>query.filter = "invoice_date = var->whatDate"</p>


<p class=Code>indx = tbl.query_create()</td></tr>
</table>

<p>NOTE: The above technique of placing a variable name directly inside a quoted 
filter string will only work for <b>global</b> and <b>session</b> variables. It 
is therefore recommended that you do <b>not</b> use this technique because it 
will not work for local variables. The next example shows the recommended 
technique (using the s_quote() function).</p>


<p>Here is another way to do the same query</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table2">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Invoices for certain date"</p>


<p class=Code>query.filter = "invoice_date = " + s_quote(whatDate)</p>


<p class=Code>indx = tbl.query_create()</td></tr>
</table>

<p>In the above example, the filter expression evaluates to: <span class=Code1>"invoice_date 
 = {11/09/1999}"</span>.&nbsp;Here is yet another way to do the same 
 query.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Invoices for certain date"</p>


<p class=Code>query.filter = "invoice_date = {" + dtoc(whatDate) 
 + "}"</p>


<p class=Code>indx = tbl.query_create()</td></tr>
</table>

<p>As in the previous example, the filter expression evaluates to: <span class=Code1>"invoice_date 
 = {11/09/1999}"</span>.&nbsp;As you can see however, the s_quote() syntax 
is easier to use.</p>


<p>Here is yet another way to do the same 
 query. The between_date() function is a special function intended to help 
create string filter expressions. It is shown here for backward compatibility 
reasons. This technique is no longer a recommended technique - the technique 
using s_quote() is easier to understand.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Invoices for certain date"</p>


<p class=Code>query.filter = between_date("invoice_date", whatDate, 
 whatDate)</p>


<p class=Code>indx = tbl.query_create()</td></tr>
</table>

<p>Assume you have a button on a form for the <span class=Code1>Invoice.set</span> 
 which ships with Alpha Five. The button performs a query, searching for 
 all customers in Boston who have ordered 7 or more units of any item.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Customers in Boston"</p>


<p class=Code>query.order = "customer->lastname"</p>


<p class=Code>filter = "customer->bill_city = 'boston' .and. invoice_items->quantity 
 > = 7"</p>


<p class=Code>query.filter = "crosslevel(" + quote(filter) + 
 ")"</p>


<p class=Code>query.options = ""</p>


<p class=Code>tbl.query_create()</p>


<p class=Code>topparent.resynch()&nbsp;'resynch the form to the current 
 selection</td></tr>
</table>

<p>This is the same as the previous example, except the name of the city is 
contained in a variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table3">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>dim vWhatCity as c </p>


<p class=Code>vWhatCity = "Boston"</p>


<p class=Code>query.description = "Customers in " + vWhatCity</p>


<p class=Code>query.order = "customer->lastname"</p>


<p class=Code>filter = "customer->bill_city = "+s_quote(vWhatCity)+" .and. invoice_items->quantity 
 > = 7"</p>


<p class=Code>query.filter = "crosslevel(" + quote(filter) + 
 ")"</p>


<p class=Code>query.options = ""</p>


<p class=Code>tbl.query_create()</p>


<p class=Code>topparent.resynch()&nbsp;'resynch the form to the current 
 selection</td></tr>
</table>

<p>&nbsp;</p>


<p>&nbsp;</p>


<p>In the above example, the several lines of Xbasic code can be shortened 
 by calling the <FORM>.QUERYRUN() method:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>filter = "customer->bill_city = 'boston' .and. invoice_items->quantity 
 > = 7"</p>


<p class=Code>topparent.QueryRun(filter)</td></tr>
</table>

<p>or</p>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table4">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim vWhatCity as c </p>


<p class=Code>vWhatCity = "Boston"</p>


<p class=Code>filter = "customer->bill_city = "+s_quote(vWhatCity)+" .and. invoice_items->quantity 
 > = 7"</p>


<p class=Code>topparent.QueryRun(filter)</td></tr>
</table>

<p>&nbsp;</p>


<p>Assume you have defined the following Global Script which you run from 
 the <span class=Button>Scripts > Favorites</span> menu in a browse 
 layout defined for the <span class=Code1>Invoice.set</span> that ships 
 with Alpha Five. The script finds all orders for more than 5 units.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Orders with more than 5 units"</p>


<p class=Code>query.order = "customer->lastname"</p>


<p class=Code>filter = "invoice_items->quantity > 5"</p>


<p class=Code>query.filter = "flattenquery(" + filter + ")"</p>


<p class=Code>query.options = ""</p>


<p class=Code>tbl.query_create()</p>


<p class=Code>topparent.fetch_first()&nbsp;'display the first record in 
 the query</td></tr>
</table>

<p>Same as above, but the quantity is assumed to be in a variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table5">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>dim vWhatQty as n </p>


<p class=Code>vWhatQty = 5</p>


<p class=Code>query.description = "Orders with more than "+ vWhatQty +"&nbsp; units"</p>


<p class=Code>query.order = "customer->lastname"</p>


<p class=Code>filter = "invoice_items->quantity > " + 
s_quote(vWhatQty)</p>


<p class=Code>query.filter = "flattenquery(" + filter + ")"</p>


<p class=Code>query.options = ""</p>


<p class=Code>tbl.query_create()</p>


<p class=Code>topparent.fetch_first()&nbsp;'display the first record in 
 the query</td></tr>
</table>

<p class=A5>&nbsp;</p>


<p class=A5>See Also</p>



<p><a href="../References/Functions/Query Functions and Methods.html" title="Query Functions and Methods" class="wiki">Query Functions and   Methods</a>, <a href="../References/Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table   Functions and Methods</a>, <a href="../References/Functions/A5_COMBINE_FILTERS Function.html" title="A5_COMBINE_FILTERS Function" class="wiki">A5_COMBINE_FILTERS(</a>), 
 <a href="../References/Functions/CROSSLEVEL Function.html" title="CROSSLEVEL Function" class="wiki">CROSSLEVEL(</a>), <a href="../References/Functions/FLATTENQUERY Function.html" title="FLATTENQUERY Function" class="wiki">FLATTENQUERY(</a>)</p>



	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:FLATTENQUERY+AND+CROSSLEVEL+Compared">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>