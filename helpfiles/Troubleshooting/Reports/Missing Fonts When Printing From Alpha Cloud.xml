<page>
        <shortlink>Missing Fonts When Printing from the Cloud</shortlink>
        <topic>Missing Fonts When Printing from the Cloud</topic>
        <description>This Section Describes how to install temporary fonts during a report generation when trying to render a report with a font that is not pre-installed on Alpha Cloud.                </description>
        <sections>
                <section>
                        <steps>
                                <step>
                                        <cases>
                                                <case>
                                                        <description>Create a fonts folder under the web project.</description>
                                                </case>
                                                <case>
                                                        <description>From the Web Control Panel, click All Files and then select File/New Folder from the window menu.</description>
                                                </case>
                                                <case>
                                                        <description>Enter "Fonts" as the name of the folder and add the folder.</description>
                                                </case>
                                                <case>
                                                        <description>It should show up as a folder on the Web Control Panel.</description>
                                                </case>
                                        </cases>
                                </step>
                                <step>
                                        <cases>
                                                <case>
                                                        <description>Unzip the attached fonts file into a temporary folder.</description>
                                                </case>
                                                <case>
                                                        <description>Note: The file has a .txt extension which you will want to remove after saving it, so the file is now "Fonts.zip".</description>
                                                </case>
                                                <case>
                                                        <description>Select All Files on the left and then select the "Fonts" folder on the right and double click on it.</description>
                                                </case>
                                                <case>
                                                        <description>Manually add each of the five files starting with "ARIAL" to the "Fonts" folder.</description>
                                                </case>
                                                <case>
                                                        <description>To reset the current folder back to the top level, click the arrow to the left of the label "Current Folder" on the tool bar to go up a level.</description>
                                                </case>
                                        </cases>
                                </step>
                                <step>
                                        <description>
                                                <p>Add the scripts below to your XBasic web project code as described above.</p>
                                        </description>
                                </step>
                                <step>
                                        <description>
                                                <p>Republish and deploy your web project to Alpha Cloud and verify that it addresses the issue.</p>
                                        </description>
                                </step>
                        </steps>
                </section>
                <section>
                        <steps>
                                <step>
                                        <description>Add this snippet of code to a test A5W Page to Show the font is added.</description>
                                        <example>
                                                <![CDATA[
<%a5
? "<p>Server Product: " + Context.ApplicationConfiguration.ServerProduct + "</p><br/>"
if Context.ApplicationConfiguration.ServerProduct = "AlphaCloud"
        dim sv as dotnet::Services
        dim ay as dotnet::assemblyreference
        ay.Name = "System.Drawing"
        ay.Version = "4.0.0.0"
        ay.Culture = "neutral"
        ay.PublicKeyToken = "b03f5f7f11d50a3a"
        if sv.registerassembly("::", ay)
                        dim pfc as System::Drawing::Text::PrivateFontCollection
                        ? "<p>Application Root:" + context.request.applicationroot + "</p><br/>"
                        on error goto oops
                        pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialn.ttf")
                        pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialnb.ttf")
                        pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialnbi.ttf")
                        pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialni.ttf")
                        pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialuni.ttf")
                        ? "<p>Fonts were added.</p><br/>"
        else
                        ? "<p>Fonts could not be added: " + sv.callresult.text + "</p><br/>"
        end if
        goto added
        oops:
        ? "<p>Fonts were NOT added due to an error: " + error_text_get() + ".</p><br/>"
        added:
else
        ? "<p>Fonts were NOT added because the platform is not Alpha Cloud.</p><br/>"
end if
dim fonts as c
fonts = a5_font_list()
fonts = *for_each(x,word(x,2,"{T=.25}"),fonts)
fonts = "<pre>" + fonts + "</pre>>"
?fonts
%>
]]>
                                        </example>
                                </step>
                                <step>
                                        <description>Add this snippet of code to XBasic sometime before your report is printed
</description>
                                        <note>You must run this on each request as it may not be saved between requests.</note>
                                        <example>
                                                <![CDATA[
if Context.ApplicationConfiguration.ServerProduct = "AlphaCloud"
                dim sv as dotnet::Services
                dim ay as dotnet::assemblyreference
                ay.Name = "System.Drawing"
                ay.Version = "4.0.0.0"
                ay.Culture = "neutral"
                ay.PublicKeyToken = "b03f5f7f11d50a3a"
                if sv.registerassembly("::", ay)

                                dim pfc as System::Drawing::Text::PrivateFontCollection 

                                on error goto added
                                pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialn.ttf")
                                pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialnb.ttf")
                                pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialnbi.ttf")
                                pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialni.ttf")
                                pfc.AddFontFile(Context.Request.ApplicationRoot + "\fonts\arialuni.ttf")
                end if
added:
end if
]]>
                                        </example>
                                </step>
                        </steps>
                </section>
        </sections>
</page>
