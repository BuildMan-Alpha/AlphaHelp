<html>

<head>
    <meta http-equiv="Content-Language" content="en-us">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <meta name="description" content="Learn how to work with Salesforce and integrate it into your applications." />
    <meta name="shortlink" content="alphaanywhere salesforce" />
    <title>Working with Salesforce</title>

</head>

<body>
    <h1>Working with Salesforce</h1>
    <p>&nbsp;</p>
    <p>Alpha Anywhere makes working with data in Salesforce very easy. There are two ways in which you can work with Salesforce</p>
    <ul>
        <li>create a connection string for Salesforce so that you can use AlphaDAO to work with data in Salesforce tables. This
            will allow you to build Grid components, List controls, etc. that use Salesforce data in much the same way that
            you use data from a SQL database</li>
        <li>make API calls against the Salesforce REST API.</li>
    </ul>
    <p>Regardless of which method you choose, you will first need to do some setup work.
    </p>
    <p>The first task that you must complete is define a new &quot;connected application&quot; in your Salesforce account. You
        will then need to define a Named Resource in your Alpha Anywhere project.</p>

    <a name="videos"><h2>Videos</h2></a>

    <table border="1" cellspacing="0" cellpadding="3">



        <tr>
            <td width="83" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Salesforce</td>
            <td width="163" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Creating a Salesforce Connected Application</td>
            <td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Before you can work with Salesforce data in an Alpha Anywhere application, you must first define a new Connected Application
                in your Salesforce account and a Named Resource in your Alpha Anywhere Web Project.
                <br>
                <br> This video walks through the process of creating a Salesforce Connected Application
                <br>
                <br>
                <a href="https://share.vidyard.com/watch/4xSDwK4uB9PcteXG4bqimz">Watch Video</a>
                <br>
                <br> Date added: 2018-04-06</td>
        </tr>



        <tr>
            <td width="83" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Salesforce</td>
            <td width="163" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Creating a Named Resource Provider</td>
            <td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Before you can work with Salesforce data in an Alpha Anywhere application, you must first define a new Connected Application
                in your Salesforce account and a Named Resource in your Alpha Anywhere Web Project.
                <br>
                <br> This video walks through the process of creating a new Named Resource Provider in your Alpha Anywhere web
                project.
                <br>
                <br>
                <a href="https://share.vidyard.com/watch/r5MidxUszEyC9gB7r5fEEY">Watch Video - Part 1</a>
                <br>
                <a href="https://share.vidyard.com/watch/eMALUvhGRUaVNQthUtqJDY">Watch Video - Part 2
                </a>
                <br>
                <br>
                <br> Date added: 2018-04-06</td>
        </tr>



        <tr>
            <td width="83" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Salesforce</td>
            <td width="163" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Making REST API Calls</td>
            <td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Then SalesforceAPIRequest() function makes it easy to make REST API requests to the Salesforce API. You can either make a
                request directly against an endpoint documented in the Salesforce API documentation, or you can use the Salesforce
                SQL like query language, SOQL, to execute queries.
                <br>
                <br> In this video we show both uses of the SaleforceAPIRequest() function.
                <br>
                <br>
                <a href="https://share.vidyard.com/watch/PXurahLgZbFr5rpjCWTL5g">Watch Video - Part 1</a>
                <br>
                <a href="https://share.vidyard.com/watch/1Suhj4V3B8v9siMeCdEQME">Watch Video - Part 2
                </a>
                <br>
                <a href="https://share.vidyard.com/watch/61Ug2i1xHPF94hwmxj2Y3G">Watch Video - Part 3
                </a>
                <br>
                <br> Date added: 2018-04-06</td>
        </tr>



        <tr>
            <td width="83" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Salesforce</td>
            <td width="163" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Creating a Connection String</td>
            <td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                You can create a Salesforce connection string (just as you create connection strings to point to SQL databases) that then
                allows you to treat Salesforce as a data source for a component, or a control.
                <br>
                <br> In this video we show how a Salesforce connection string can be defined and then used to create a Grid component.
                <br>
                <a href="https://share.vidyard.com/watch/SxFfw62VjZQZToYtQXRXmy">Watch Video - Part 1</a>
                <br>
                <a href="https://share.vidyard.com/watch/2eMvXf3HnHHuP2zQThs3XT">Watch Video - Part 2
                </a>
                <br>
                <br> Date added: 2018-04-06</td>
        </tr>



        <tr>
            <td width="83" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Salesforce</td>
            <td width="163" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                Building a UX Component That Uses the Salesforce API
            </td>
            <td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
                In this video we show how a UX component can be built to display Salesforce data. The UX component does a query to retrieve
                the a list of accounts from Salesforce and it displays the result in a List control. When the user clicks
                on a row in the List, details for the selected account are shown by making another API request to Salesforce.
                <br>
                <br>
                <br>
                <a href="https://share.vidyard.com/watch/dpCQcnBVSgT2rPxnL4VD84">Watch Video</a>
                <br>
                <br>
                <a href="https://www.ajaxvideotutorials.com/V12Videos/getSalesforceDataByAccount.zip">
                    Download component</a>
                <br>
                <br> Date added: 2018-04-06</td>
        </tr>



    </table>


    <a  name="defining"><h2>Defining a Salesforce Connected Application</h2></a>
    <p>In order to create a new Salesforce Connected Application, log into your Salesforce account. From the navigation menu,
        select Apps, App Manager</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf7.jpg">
    </p>

    <p>At the App Manager screen, click on the New Connected App button.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf8.jpg">
    </p>


    <p>This will allow you to define a new Connected App and define the properties of this App.</p>
    <p>The essential properties that you must set include:</p>

    <ul>
        <li>
            <font color="#0000FF" face="Courier New">Enable OAuth Settings </font>-- this property must be checked</li>
        <li>
            <font color="#0000FF" face="Courier New">Callback URL</font> - see discussion below</li>
        <li>
            <font color="#0000FF" face="Courier New">Selected OAuth Scopes</font> - select the scopes that your Connected application should have. </li>
    </ul>

    <p>
        <img class="imgCenter" border="0" src="images/salesf9.jpg">
    </p>
    <a name="callbackURL"><h3>Callback URL</h3></a>
    <p>The callback URL is used by Salesforce after the user has logged into Salesforce to authorize the Connected Application
        to get back to your Alpha Anywhere application. You can define multiple callback URLs as shown in the above image.
        The reason you would want to define multiple callback URLs is so that you can use the same Connected Application
        while you are developing and testing your application and then after you deploy your application.</p>
    <p>The callback URL is the special system page
        <font color="#0000FF" face="Courier New">__A5ExternalAuthentication.a5w</font>
        at the address where your application is deployed. So, for example, if your application has been published to
        <font color="#0000FF" face="Courier New">
            https://www.myApp.com</font>, the callback URL will be:</p>
    <p>
        <font color="#0000FF" face="Courier New">https://www.myApp.com/__a5ExternalAuthentication.a5w</font>
    </p>

    <p>For callback URLs that use localhost (or 127.0.0.1 - which is the same as localhost), it is not necessary to use the
        <font color="#0000FF" face="Courier New">https</font> scheme. However, for other callback URLs, it is necessary to use the
        <font color="#0000FF" face="Courier New">https</font> scheme.</p>

    <a name="secretKey"><h3>Consumer Key and Secret</h3></a>
    <p>Once you have set up your Connected Application, you will need to get the Consumer Key and Consumer Secret for your Connected
        Application.&nbsp; You will need these values when you define
        <font color="#0000FF" face="Courier New">Named Providers
        </font> (see below) in Alpha Anywhere</p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf10.jpg">
    </p>



    <a name="namedProvider"><h2>Defining Named Providers in Alpha Anywhere</h2></a>
    <p>Once you have created a Connected Application in your Salesforce account, and obtained the Consumer Key and Secret for
        your Connected Application, the next step is to define a
        <font color="#0000FF" face="Courier New">Named Provider</font>
        for Salesforce in Alpha Anywhere. A
        <font color="#0000FF" face="Courier New">
            Named Provider</font> is simply a way of assigning a name to a set of properties (which include the Consumer
        Key and Secret, the Callback URL, and Scopes you are requesting from the provider).</p>
    <p>You can define
        <font color="#0000FF" face="Courier New">Named Providers</font>
        by selecting the Tools menu when the Web Control Panel has focus.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf12.jpg">
    </p>

    <p>The
        <font color="#0000FF" face="Courier New">Named Providers</font> that you define here are available to all Web Projects in the current Workspace.</p>
    <p>You can also define Named Providers that are specific to the current Web Project by going to the Project Properties dialog
        (click the Project Properties button on the Web Projects Control Panel)</p>
    <p>&nbsp;
        <img class="imgCenter" border="0" src="images/salesf13.gif">
    </p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf14.jpg">
    </p>

    <p>After you select the command to define
        <font color="#0000FF" face="Courier New">Named Providers</font> you will see the dialog shown below where you can define your
        <font color="#0000FF" face="Courier New">Named Providers</font>.</p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf15.jpg">
    </p>

    <p class="note">
        <b>NOTE</b>: The definition of a particular
        <font color="#0000FF" face="Courier New">Named Provider</font> can be overwritten at publish time by specifying new properties for the
        <font color="#0000FF" face="Courier New">Named Provider</font> in your
        <font color="#0000FF" face="Courier New">Publishing Profil</font>e. This is similar to the way in which a
        <font color="#0000FF" face="Courier New">Named Connection String</font> can be re-defined at publish time.</p>

    <p>In the above image, two
        <font color="#0000FF" face="Courier New">Named Resources
        </font> have been defined. Both have a red icon next to their name. This indicates that the user has not yet authenticated
        the
        <font color="#0000FF" face="Courier New">Named Resource</font>. If you click on the a particular
        <font color="#0000FF" face="Courier New">Named Resource</font>
        and then click the
        <font color="#0000FF" face="Courier New">Log in</font>
        button, the OAuth flow for that
        <font color="#0000FF" face="Courier New">Named Resource </font>will be started and you will be able to authenticate against the Provider. After you successfully
        log in, the red icon will change to green. At that point you will be able to perform API requests against the Provider
        while you are in development mode (i.e. running your application in Working Preview or Live Preview mode). </p>

    <p>To create a new Named Resource click the New button.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf16.jpg">
    </p>
    <p>When you open the
        <font color="#0000FF" face="Courier New">Configure Named Resource Providers</font> dialog, you might see a message at the bottom of the screen as shown below.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf17.jpg">
    </p>

    <p>This is a notification that you have not defined an
        <font color="#0000FF" face="Courier New">Authentication Keys Table</font> for this Web Project (see below for more details).</p>
    <a name="keyTable"><h3>Authentication Keys Table</h3></a>
    <p>When you authenticate a
        <font color="#0000FF" face="Courier New">Named Provider
        </font> using OAuth, the
        <font color="#0000FF" face="Courier New">
            Provider</font> will supply an
        <font color="#0000FF" face="Courier New">access token
        </font> and possibly a
        <font color="#0000FF" face="Courier New">refresh token
        </font>. The
        <font color="#0000FF" face="Courier New">access token</font>
        is used when making API requests to authorize the request. Typically the
        <font color="#0000FF" face="Courier New">access token</font> will expire after a certain period of time. If a
        <font color="#0000FF" face="Courier New">refresh token
        </font> is available, a new
        <font color="#0000FF" face="Courier New">access token
        </font> can be obtained without requiring the user to authenticate again. These tokens are stored in session variables,
        but can also be stored in a database table so that they outlive the session.</p>
    <p>The table in which the
        <font color="#0000FF" face="Courier New">access token</font>
        and
        <font color="#0000FF" face="Courier New">refresh token </font>are stored is called the
        <font color="#0000FF" face="Courier New">Authentication Keys Table</font>. It is
        <b>not</b> a requirement that your application define an Authentication Keys Table, but it is recommended. If you do
        not define an Authentication Keys Table, then users of your application will need to re-authenticate the next time
        they use your application.</p>
    <p>To create an&nbsp;
        <font color="#0000FF" face="Courier New">Authentication Keys Table</font> for your Web Project, click the Project Properties button on the Web Control Panel,
        then scroll to the Authentication Keys Table Settings section.
    </p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf18.jpg">
    </p>

    <p>To create the table, click the smart field for any of the properties. </p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf19.jpg">
    </p>
    <p>You can either create a new table, or map an existing table (as long as the existing table has all of the required fields).&nbsp;
        To create a new table, fill in the connection string, type in a table name and then click the
        <font color="#0000FF" face="Courier New">Create Authentication Keys Table</font>
        link at the bottom left of the screen.</p>
    <a name="requests"><h2>Making Requests to the Salesforce REST API</h2></a>
    <p class="note">
        <b>NOTE: </b>Before you can make requests to the Salesforce API you must first have created a Salesforce
        <font color="#0000FF" face="Courier New">Connected Application</font> and defined a
        <font color="#0000FF" face="Courier New">Named Provider</font> in your Alpha Anywhere project. Both of these topics are discussed above.</p>

    <p>You can get more information about the Salesforce REST API at this address:</p>
    <p>
        <a href="https://developer.salesforce.com/docs/api-explorer.com/docs/api-explorer/sobject">
            https://developer.salesforce.com/docs/api-explorer.com/docs/api-explorer/sobject</a>
    </p>

    <p>Alpha Anywhere has a special Xbasic helper function (
        <font color="#0000FF" face="Courier New">SalesforceAPIRequest()</font>
        )&nbsp; to make it easy to call various endpoints in the Salesforce REST API.</p>
    <p>See below for more information on the
        <font color="#0000FF" face="Courier New">SalesforceAPIRequest</font>
        <font color="#0000FF" face="Courier New">()
        </font>function.</p>
    <a name="connectionString"><h2>Creating a Salesforce Connection String</h2></a>
    <p>When you create a Salesforce connection string you are then able to interact with data in your Salesforce table using
        AlphaDAO (the Xbasic class that allows you to work with SQL databases). This means that you can define a named connection
        string (just as you would for connecting to a SQL database) and then you can build components and controls that use
        Salesforce as their data source.</p>
    <p>When you create a new connection string, the
        <font color="#0000FF" face="Courier New">Create SQL Connection String</font>
        dialog is shown</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf20.jpg">
    </p>

    <p>Click on the smart field for the
        <font color="#0000FF" face="Courier New">
            Connection Type</font> and then select Salesforce the list of available types.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf21.jpg">
    </p>


    <p>This will then bring up the
        <font color="#0000FF" face="Courier New">Create SQL Connection String</font> dialog for the Salesforce connection type.</p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf22.jpg">
    </p>
    <p>There are two different ways in which you can define your Salesforce connection string. You can specify a
        <font color="#0000FF" face="Courier New">
            Named Resource</font>, or you can explicitly define your connection properties.</p>
    <p>For instructions on how to create a Named Resource see the section '
        <i>Defining Named Providers in Alpha Anywhere</i>'. </p>
    <p>If you supply your Salesforce credentials here then users will not have to go through an OAuth flow to authenticate against
        their Salesforce account.</p>
    <p>Please note that the Base Url. Client Id (call the Consumer Key by Salesforce), Client Secret (called by Consumer Secret
        by Salesforce), and Client Token will all have to be obtained by logging into your Salesforce account and retrieving
        the information for the Connected Application you have defined.</p>
    <p class="note">
        <b>NOTE: </b>If you have not already defined a
        <font color="#0000FF" face="Courier New">Connected Application</font> in your Salesforce account, you will need to first do so before you can create your
        Salesforce connection string.</p>
    <p>The Base Url is the URL you see in the browser after you log into your Salesforce account. For example, while you might
        go to
        <a href="http://www.salesforce.com">www.salesforce.com</a> to login to your account, after you have logged in the base URL shown in the browser address
        bar might be something like:
        <a href="https://na78.lightning.force.com">
            https://na78.lightning.force.com</a>
    </p>
    <p>The
        <font color="#0000FF" face="Courier New">Client Token</font> is obtained from Salesforce by going to the Settings page, and then selecting
        <font color="#0000FF" face="Courier New">Reset My Security Token</font> from the
        <font color="#0000FF" face="Courier New">My Personal Information</font> section, as shown in the image below.</p>


    <p>
        <img class="imgCenter" border="0" src="images/salesf24.jpg">
    </p>

    <a name="usingConnStr"><h2>Using a Salesforce Connection String</h2></a>
    <p>Once you have created a Salesforce connection string you can use the connection string to query or update data in your
        Salesforce tables. You can use Xbasic (using the AlphaDAO object), or you can build components (e.g. Grid or UX)
        or controls (e.g. List control in the UX), that use Salesforce data as their data source.</p>
    <p>For example, the following Xbasic Interactive Window session shows how you can query data in a Salesforce table. Assume
        that you have built a connection string for Salesforce and named the connection string
        <font color="#0000FF" face="Courier New">mySalesforceData</font>.</p>
    <p>Here is the Interactive Window session (note how it is identical to the code you would have used to query a SQL database):</p>
    <p class="xbasicSmall">dim cn as sql::connection</p>
    <p class="xbasicSmall">cn.open(&quot;::Name::mysalesforcedata&quot;)</p>
    <p class="xbasicSmall">?cn.listTables() 'list all of the tables</p>
    <p class="xbasicSmall">dim sql as c </p>
    <p class="xbasicSmall">sql = &quot;select * from Account&quot;</p>
    <p class="xbasicSmall">?cn.execute(sql)</p>
    <p class="xbasicSmall">dim json as c </p>
    <p class="xbasicSmall">json = cn.resultset.toJSON()</p>
    <p class="xbasicSmall">?json </p>
    <p class="xbasicSmall">= [
        <br> {&quot;Id&quot; : &quot;0011N00001EBYRDQA5&quot;, &quot;IsDeleted&quot; : &quot;&quot;, &quot;MasterRecordId&quot;
        : &quot;&quot;, &quot;Name&quot; : &quot;Genepoint4&quot;, &quot;Type&quot; : &quot;Customer - Channel&quot;, &quot;ParentId&quot;
        : &quot;&quot;, &quot;BillingStreet&quot; : &quot;345 Shoreline Park\u000AMountain View, CA 94043\u000AUSA&quot;,
        &quot;BillingCity&quot; : &quot;Mountain View&quot;, &quot;BillingState&quot; : &quot;CA&quot;, &quot;BillingPostalCode&quot;
        : &quot;&quot;, &quot;BillingCountry&quot; : &quot;&quot;, &quot;ShippingStreet&quot; : &quot;345 Shoreline Park\u000AMountain
        View, CA 94043\u000AUSA&quot;, &quot;ShippingCity&quot; : &quot;&quot;, &quot;ShippingState&quot; : &quot;&quot;,
        &quot;ShippingPostalCode&quot; : &quot;&quot;, &quot;ShippingCountry&quot; : &quot;&quot;, &quot;Phone&quot; : &quot;(650)
        867-3450&quot;, &quot;Fax&quot; : &quot;(650) 867-9895&quot;, &quot;AccountNumber&quot; : &quot;CC978213&quot;, &quot;Website&quot;
        : &quot;www.genepoint.com&quot;, &quot;Sic&quot; : &quot;3712&quot;, &quot;Industry&quot; : &quot;Biotechnology&quot;,
        &quot;AnnualRevenue&quot; : &quot;&quot;, &quot;NumberOfEmployees&quot; : &quot;&quot;, &quot;Ownership&quot; : &quot;Private&quot;,
        &quot;TickerSymbol&quot; : &quot;&quot;, &quot;Description&quot; : &quot;Genomics company engaged in mapping and
        sequencing of the human genome and developing gene-based drugs&quot;, &quot;Rating&quot; : &quot;Cold&quot;, &quot;Site&quot;
        : &quot;&quot;, &quot;OwnerId&quot; : &quot;0051N000005j4eOQAQ&quot;, &quot;CreatedDate&quot; : &quot;2018-01-25T17:04:59.000+0000&quot;,
        &quot;CreatedById&quot; : &quot;0051N000005j4eOQAQ&quot;, &quot;LastModifiedDate&quot; : &quot;2018-02-19T21:53:38.000+0000&quot;,
        &quot;LastModifiedById&quot; : &quot;0051N000005j4eOQAQ&quot;, &quot;SystemModstamp&quot; : &quot;2018-02-19T21:53:38.000+0000&quot;,
        &quot;LastActivityDate&quot; : &quot;&quot;, ..................</p>

    <a name="login"><h2>Action Javascript Actions to Login to Salesforce</h2></a>
    <p>When you are developing and testing your application in Working Preview or Live Preview you can test your Salesforce
        application by logging in on the screen where you define your
        <font color="#0000FF" face="Courier New">Named Providers
        </font>. For example, in the screen shown below we see that there are two
        <font color="#0000FF" face="Courier New">Named Resources </font>defined for Salesforce:
    </p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf26.jpg">
    </p>

    <p>After selecting one of the
        <font color="#0000FF" face="Courier New">Named Resources
        </font>, clicking the Log in button and then completing the OAuth flow, the selected
        <font color="#0000FF" face="Courier New">Named Resource</font> now has a green icon, indicating that the user has successfully authenticated their Salesforce
        account and that an access token has now been saved in the Alpha Anywhere Development environment for this
        <font color="#0000FF" face="Courier New">Named Resource</font>.</p>
    <p>
        <img class="imgCenter" border="0" src="images/salesf27.jpg">
    </p>

    <p>At runtime, however, the tokens that are saved when you authenticate from the
        <font color="#0000FF" face="Courier New">Named Resource</font> screen are not used. Instead, you will need to add a button to your user interface to initiate
        the OAuth flow to login to Salesforce.</p>
    <p>You can use Action Javascript to define the action for your login button. Alpha Anywhere provides two actions in Action
        Javavascript:
    </p>
    <ul>
        <li>
            <font color="#0000FF" face="Courier New">Get OAuth Access Token From Resource Provider</font>
        </li>
        <li>
            <font color="#0000FF" face="Courier New">Get Application Level OAuth Access Token From Resource Provider</font>
        </li>
    </ul>

    <p>
        <img class="imgCenter" border="0" src="images/salesf25.jpg">
    </p>

    <p>Both actions are similar. The only difference is that the first action is user-specific. Each logged in user has their
        own access token (that presumably gives access to that specific user's Salesforce account). The second action is
        for use with a
        <font color="#0000FF" face="Courier New">Named Resource</font>
        that was defined with the
        <font color="#0000FF" face="Courier New">Application Level Token </font>property checked.</p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf28.jpg">
    </p>

    <p>At run-time, after the user has logged in, the tokens are stored in session variables (and optionally in the
        <font color="#0000FF" face="Courier New">
            Authentication Keys Table</font> if one has been defined). </p>
    <a name="oauthEvents"><h2>Client-side OAuth Events</h2></a>
    <p>Alpha Anywhere exposes two client side events that can be defined in a UX component that are related to OAuth authentication
        flows.
    </p>
    <ul>
        <li>
            <font color="#0000FF" face="Courier New">onOAuthCompleted</font> - (PhongGap applications only) - Fires when the OAuth flow has completed and the user
            returns the UX component from which the OAuth flow was initiated</li>
        <li>
            <font color="#0000FF" face="Courier New">onOAuthAuthorize</font> - fires when a user has successfully authenticated and has obtained an access token.
        </li>
    </ul>
    <p>You can use these events to perform some action that should only be done once the user has the necessary access token
        to access Salesforce data.</p>

    <a name="phoneGap"><h2>PhoneGap Applications</h2></a>
    <p>If you are building a PhoneGap application that will require the user to login to Salesforce, you will need to ensure
        that your application includes the
        <font color="#0000FF" face="Courier New">InAppBrowser</font> plugin. This is because when the OAuth authentication flow in initiated, the
        <font color="#0000FF" face="Courier New">InAppBrowser</font> is opened and the Salesforce login page is shown in the
        <font color="#0000FF" face="Courier New">
            InAppBrowser</font> window. Once the OAuth flow is completed, the
        <font color="#0000FF" face="Courier New">InAppBrowser</font> window will automatically be closed. The client-side
        <font color="#0000FF" face="Courier New">onOAuthCompleted</font> event will then fire.
    </p>

    <p>
        <img class="imgCenter" border="0" src="images/salesf30.jpg">
    </p>



    <a name="salesforceFunction1"><h2>SalesforceAPIRequest() Function</h2></a>
    <p>The
        <font color="#0000FF" face="Courier New">SaleforceAPIRequest()</font>
        function can be used to make requests against the Salesforce REST API in two different ways</p>
    <ul>
        <li>make requests to any Salesforce API endpoint (this is the most generic usage of the function)</li>
        <li>make queries against Salesforce objects using SOQL (the Salesforce SQL query syntax)</li>
    </ul>
    <p>For more information on SOQL, click this
        <a href="https://developer.salesforce.com/docs/atlas.en-us.soql_sosl.meta/soql_sosl/sforce_api_calls_soql_select.htm">
            link</a>.</p>
    <p>For more information on the Salesforce API (with specific examples of the endpoints for different API actions), click
        this
        <a href="https://developer.salesforce.com/docs/api-explorer/sobject">link</a>.</p>

    <p>Syntax</p>
    <p class="xbasicSmallWide">P
        <i>result</i> = SalesforceAPIRequest(C
        <i>namedResource</i> [,C
        <i>endpoint</i> [,C
        <i>query</i> [,C
        <i>apiversion</i> [,C
        <i>verb</i> [,C
        <i>body</i> ]]]]])
        <br> &nbsp;
    </p>
    <p>Where</p>
    <ul>
        <li>
            <i>result</i> - the result of the function call. An object with these properties:
            <font color="#0000FF" face="Courier New">error</font> - .t. or .f. depending on whether or not there was an error,
            <font color="#0000FF" face="Courier New">errorText</font> - error description if there was an error,
            <font color="#0000FF" face="Courier New">
                result</font> - the data returned by the function call.</li>
        <li>
            <i>endpoint</i> - The endpoint for the request (e.g.
            <font color="#0000FF" face="Courier New">&nbsp;/services/data/v39.0/sobjects/Account/0011N00001EBYRDQA5</font>) or the string
            <font color="#0000FF" face="Courier New">query</font> (if you are doing a query using SOQL)</li>
        <li>
            <i>query</i> - The SOQL query (if
            <i>endpoint</i> has been set to
            <font color="#0000FF" face="Courier New">query</font>). For example:
            <font color="#0000FF" face="Courier New">
                SELECT+name,accountNumber,ownerId,site+from+Account</font>
        </li>
        <li>
            <i>apiversion</i> - (only used if
            <i>endpoint</i> has been set to
            <font color="#0000FF" face="Courier New">query</font>) - defaults to &quot;20.0&quot; -- allows you to set the API version number for the request (for
            example, &quot;39.0&quot;)
        </li>
        <li>
            <i>verb</i> - (only used when
            <i>endpoint</i> has
            <b>NOT</b> been set to
            <font color="#0000FF" face="Courier New">query</font>). The verb for the request (e.g. GET, POST, UPDATE, PUT, etc.). The Salesforce API documentation
            will indicate what verb is required for a particular request. Defaults to GET.</li>
        <li>body - (only used when
            <i>endpoint</i> has
            <b>NOT</b> been set to
            <font color="#0000FF" face="Courier New">query</font>)The body for the request (for example, when the verb is POST).</li>
    </ul>

    <p>If you call this function and the user is not yet logged, the return value will be:</p>
    <p class="xbasicSmall">result.error = .t.</p>
    <p class="xbasicSmall">result.errorText = &quot;Not logged in&quot;</p>

</body>

</html>