<page>
    <topic>Alpha Anywhere Federatated Authentication - Authentication Using a SAML Identity Provider
    </topic>
    <description>The Alpha Anywhere web security system now supports login using a SAML identity provider such as Active Directory, Okta, and Ping Identity. 
	This allows an Alpha Anywhere application to use an organization's existing security infrastructure resulting the user only needing to log in once
	to the organization's security infrastructure and being authenticated with all the applications used by the organization (single sign on).</description>
    <sections>
        <section>
            <title>Overview</title>
            <description>Federated authentication is a way to delegate authentication to another application called an "identity provider" (commonly abbreviated IdP).
            A trust relationship is configured between applications in an organization and the identity provider. An application is configured to use an identity provider
            and the identity provider is configured to allow that application to ask it to authenticate users. This allows a user to login once to the identity 
            provider and automatically be authenticated for all the applications used by the organization that are configured to use that identity provider
            (single sign on). This is done in the same way as a typical application by redirecting to a login page. However, instead of the application
            redirecting to one of its own pages, the application redirects to the identity provider's login page. If the user not already authenticated, the identity 
            provider will authenitcate the user by prompting for username and password, Windows integrated authentication, or any other way the identity provider
            is configured to authenticate a user. Once the user is autheticated, the identity provider redirects back to the application with an encrypted
            token containing the user's identity. Note tht if the user had authenticated with identity provider from some other application, the identity 
            provider does not need to reauthenticate and the encrypted token will be returned without any other prompting.
            
            One important aspect of federated authentication is that the identity provider does not need to be directly accessible to the 
            server running the application. That means an organization's identity provider can be behind a company firewall and an Alpha Anywhere 
            application can be running in Alpha Cloud. I, as a user, am logged into the company VPN giving me access to the identity provider. When the Alpha Anywhere 
            application running in Alpha Cloud needs to authentication the user, the application will redirect to the identity provider, which I/my browser has
            access too, the identity provider does the authentication, and the the identity provider redirects with an encrypted token back to the Alpha Anywhere
            application running in Alpha Cloud. The Alpha Anywhere application validates the encrypted token and then I am logged in to the application.
            </description>
            <note>Federated authentication needs to be enabled in the application's Web Security Settings.</note>
        </section>
        <section>
            <note>
            	<description>
                <p>Federated authentication requires that the application's [cookie_samesite] setting be set to "None" since cookies are used as part of the
                 authentication workflow between the Alpha Anywhere application and the identity provider. This will be automatically set if the application
                 runs under Application Server for IIS, but the Classic application server has to be have its cookie samesite setting manually changed to 
                 "None".
                </p>
                </description>
            </note>
        </section>
        <section>
            <description>
                <p>When using the "federated authentication" feature, the Alpha Anywhere web security system is still used. If the identity provider returns user roles 
                (a.k.a "groups") along with the user name in the encrypted token, those roles can be used by the Alpha Anywhere security system. Otherwise, the 
                authenticated user must be in the Alpha Anywhere security system with the roles the user is a member of. The federated authentication configuration can 
                be set to automatically add a user that is not in the Alpha Anywhere security system in which case the default role(s) defined in the security system will
                be assigned to the user. If roles are not included in the encrypted token and the application is not configured to automatically add new users, the 
                user must be manually added to the application as they normally would be without federated authentication being enabled.</p>
            </description>
        </section>
        <section>
            <title>Configuring the System to Use Federated Authentication</title>
        </section>
        <section>
            <title>Step 1 - Enable federated authentication in the web application's security settings</title>
            <description>
                <p>The security settings dialog has a new option for Federated Authentication settings. 
                Click on the "..." button to enable federated authentication and set other federated authentication options.</p>
            </description>
            <figure>
                <link>images/SecuritySettingsEnableFederatedAuthentication.webp</link>
            </figure>
            <figure>
                <link>images/FederatedAuthenticationSettings.webp</link>
            </figure>
        </section>
        <section>
            <title nested="2">Federated authentication pages</title>
            <description>
                <p>Federated authentication settings has a number of pages that are used in the authentication workflow. </p>
            </description>
                <note>Create these default pages. The text and styling can be customized, but any code should not be modified unless 
                requested by support.</note>
            <steps>
                <step>
                    <description>Federated Logout Page
                    </description>
                </step>
                <step>
                    <description>Federated Login Error Page
                    </description>
                </step>
            </steps>
        </section>
        <section>
            <title>Step 2 - Set up federated authentication </title>
            <description>TBD
            </description>
        </section>
        <section>
            <title>Step 3 - Configure the identity provider for your Alpha Anywhere application</title>
            <description>TBD
            </description>
        </section>
    </sections>
    <links>
    	<link href="https://documentation.alphasoftware.com/documentation/pages/Guides/Workspaces/Web%20Project%20Profile%20Properties/WebProjectSettings.xml#section2_Cookie%20SameSite%20value">cookie samesite</link>
    </links>
</page>