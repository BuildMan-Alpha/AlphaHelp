<!DOCTYPE html>
<html>
	<meta http-equiv="last-modified" content="3/18/2016@12:53 EDT" />
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
		<link rel="stylesheet" type="text/css" href="theme.css" />
		<title>IIS Migration Guide</title>
	</head>
	<style>
	h1 {
		color: red;
		font-weight: bold;
		font-size: 10pt;
	}

	h2 {
		font-weight: bold;
		font-size: 10pt;
	}

	.title {
		font-size: 11pt;
		color: red;
		font-weight: bold;
		text-align: center;
	}

	body {
		background: lightgray;
		margin: 3em auto;
		max-width: 50em;font-family: Tahoma;
		font-size: 9pt;
	}

	body div.wrapper {
		background: white;
		box-shadow: 1px 1px 1px 1px #888888;
		padding: 25px;
	}

	p {
		margin-bottom: 10px;
		margin-top: 0px;
		line-height: 1.3;
	}

	img {
		text-align:center;
		max-width: 45em;
		max-height: 35em;
	}

	li img {
		max-width: 40em;
	}

	ol li {
		margin-bottom: 1em;
	}

	ol li img {
		margin-top: 1em;
	}
	
	.note {
		padding: 0.5em;
		background-color: #f0f0f0;
		border-radius: 3px;
	}

	table {
		font-size:inherit;
		padding: 5px;
	}

	table.command-line-options > tbody > tr > td:nth-child(1) {
		width: 3em;
	}

	.note img {
		max-width: 40em;
	}

	.fixedfont {
		font-family: monospace;
	}

	.italic {
		font-style: italic;
	}

	a:not([href]) {
		color: inherit;
	}
	
	.copyright {
		border-top-color: #b7b7b7;
		border-top-style: solid; 
		border-top-width: 0.1em; 
		color: #b7b7b7; 
		margin-top: 2em; 
		padding-top: 0.5em;
		text-align: center; 
	}
	</style>
	<body>
		<div class="wrapper">
			<meta charset="utf-8">
			<h1>Alpha Anywhere Application Server for IIS Migration Guide</h1>
			<h2>Contents</h2>
			<ul>
				<li><a href="#overview">Overview</a></li>
				<li><a href="#differences-under-iis">Differences between IIS and the stand-alone server</a></li>
				<li><a href="#platform-agnostic">Make Your Application Platform Agnostic</a></li>
				<li><a href="#troubleshooting">Troubleshooting</a></li>
				<li><a href="#migrate-security-data">Migrate Security Data</a></li>
			</ul>
			
			<a name="overview"><h2>Overview</h2></a>
			<div class="sectionNote">This document is a work in progress.</div>
			<p>
			</p>

			<a name="differences-under-iis"><h2>Differences between IIS and the stand-alone server</h2></a>
			<p>
				This section contains information about features an application running on the stand-alone server may use
				that could behave differently under IIS and what you can do to get those features working under IIS. Not all 
				applications use these features so these may not apply to your application.
			</p>
			<ol>
				<li>
					<h4>Security data is stored differently under IIS</h4>
					<p>
						This feature will affect most applications. Alpha Anywhere Application Server for IIS uses ASP.NET's 
						membership and role providers for authentication and authorization. Membership and role providers are 
						abstract interfaces. These abstract interfaces are a consistent API across implementations. The same interface
						is used with a membership provider implemented for SqlServer as is used for a membership provider
						implemented for MySQL. Each implementation is free to store security data in any way it sees fit. 
						This implementation detail (the persistence of security data) is hidden from the application using the
						membership and/or role provider. An Alpha Anywhere application running under IIS uses providers supplied by
						the choosen database vendor. These providers do not use the Alpha Anywhere Application Server's schema for 
						security data. This means security data must be migrated to the schema used by the database vendor's 
						provider. See more details in the <a href="#migrate-security-data">Migrate Security Data</a> section.
					</p>
				</li>
			</ol>

			<a name="platform-agnostic"><h2>Make Your Application Platform Agnostic</h2></a>
			<p>
			</p>

			<a name="troubleshooting"><h2>Troubleshooting</h2></a>
			<p>
			</p>
			
			<a name="migrate-security-data"><h2>Migrate Security Data</h2></a>
			<h3>Introduction</h3>
				<p>Security data (users, groups, and membership) are stored differently under IIS than under Alpha Anywhere Application Server. This means
				an application running under IIS cannot use the same security data as the application running under the Alpha Anywhere Application Server.
				When an application running in production under Alpha Anywhere Application Server is moved to IIS, the security data must be migrated
				to an IIS provider schema. The specific schema that is used by an IIS provider is defined by the provider. Alpha Anywhere Application Server 
				has a Genie in the server settings dialog to export security data and the Alpha Anywhere Application Server for IIS has a utility named
				<span class="fixedfont">A5IISMigrateSecurityData.exe</span> to import security data in to an IIS provider.
				</p>
				<p>
				The following security data are migrated with steps that follow:
					<ul>
						<li>Users
						<ul>
							<li>Name</li>
							<li>Password</li>
							<li>Email Address</li>
							<li>Security Question</li>
							<li>Security Question Answer</li>
							<li>Locked Out
							<p class="sectionNote">A user may be locked out because of too 
							many failed log in attempts or because an application adminstrator has manually disabled the user. A user that is 
							locked out because of too many failed log in attempts is typically automatically reenabled after a period 
							of time. When a user in this state is migrated, the user is treated as if an application adminstrator has manually 
							disabled the user so the user must be manually reenabled by an application adminstrator.
							</p>
							</li>
						</ul>
						</li>
						<li>Groups (roles)
						</li>
						<li>Membership &ndash; The list of groups to which each user belongs.
						</li>
					</ul>
				</p>
			<h3>Security Data Migration Steps</h3>
				<ol>
					<li>
						Create a publish profile to publish to an IIS server. Part of the publish profile includes configuring the 
						memberhip provider (for users) and role provider (for groups) to be used by the application. See the 
						<a href="http://downloads.alphasoftware.com/A5V12Download/ReleaseNotes/ProviderConfiguration/ProviderConfiguration.html">Provider Configuration</a>
						documentation for more information on choosing providers.
					</li>
					<li>
						Publish using the newly created publish profile. The publish dialog has an option to publish security data. This option
						will publish security data as defined in Alpha Anywhere Developer Edition. This data will not contain an accurate lock out status of 
						users since the lock out status data is kept on the production web server. Since you will be exporting data from the production
						server instead, choose the "Ignore - Do not publish users and roles." option. This option will define the membership and role 
						providers in the published application. This is needed in order to import users, groups, and membership under IIS.
					</li>
					<li>
						Go to the application server settings dialog in Alpha Anywhere Application Server. This dialog is opened from the context menu 
						of the Alpha Anywhere Application Server tray icon.
						<p>
							<a href="images/tray.png"><img src="images/tray.png" alt="Alpha Anywhere Application Server tray icon context menu."></img></a>
						</p>
					</li>
					<li>
						Select the tab labeled &ldquo;<strong>Other</strong>&rdquo; and click on the &ldquo;<strong>Open the Users and Groups Migration Genie</strong>&rdquo; link.
						<p>
							<a href="images/other.png"><img src="images/other.png" alt="Alpha Anywhere Application Server users and groups migration genie link."></img></a>
						</p>
					</li>
					<li>
						The <strong>User and Groups Migration Genie</strong> has an information section to explain its purpose. The information section contains a 
						checkbox labeled &ldquo;<strong>Migrate a web application's security data</strong>&rdquo;. This check box will need to be selected
						in order to continue with the rest of the genie.
						<p>
							<a href="images/genie.png"><img src="images/genie.png" alt="Alpha Anywhere Application Server users and groups migration genie."></img></a>
						</p>
					</li>
					<li>
						After selecting the &ldquo;<strong>Migrate a web application's security data</strong>&rdquo; checkbox, the genie will scan the 
						application server for applications that have security data. Select an application and then choose a location for the exported
						data. The export process will also generate a key for securing sensitive data like passwords, and security questions and answers.
						This key will be stored in a file with a .key extension. If needed, this .key file can be kept apart from the data file making 
						it easier to move the data file securely to the IIS server. You will only need the .key file once the data file is on the IIS server 
						and you are ready to import the security data. You may also select to encrypt the entire security data file rather than just the 
						sensitive data in it.
						<p>
							<a href="images/ready-for-export.png"><img src="images/ready-for-export.png" alt="Alpha Anywhere Application Server users and groups ready for export."></img></a>
						</p>
					</li>
					<li>
						Click the &ldquo;<strong>Export Data</strong>&rdquo; button to begin the export. The export may take some time depending on the amount of users, 
						groups, and number of users assigned to groups. When the export is finished a Windows file explorer window will
						open to the folder with the .data and .key file and the .data file will be selected. Now the files can be moved to 
						the IIS server.
						<p>
							<a href="images/export-complete.png"><img src="images/export-complete.png" alt="Alpha Anywhere Application Server export complete."></img></a>
						</p>
					</li>
					<li>
						Use any means to move the .data file to the IIS server. If you do not want to move the .key file over a network you
						can copy it to a thumb drive and carry it to the IIS server. When you are ready to do the import copy the .key file 
						from the thumb drive into the same folder as the .data file.
					</li>
					<li>
						Now that the .data and .key files are on the IIS server the <strong><span class="fixedfont">A5IISMigrateSecurityData.exe</span></strong> utility can be used to import
						the security data. This utility is located in the installation folder which defaults to <span class="fixedfont">C:\Program Files (x86)\A5V12 Application Server for IIS</span>.
						This utility must be &ldquo;<strong>Run as adminstrator</strong>&rdquo; to ensure that it has access IIS application configurations.
						<p>
							<a href="images/run-as-administrator.png"><img src="images/run-as-administrator.png" alt="Alpha Anywhere A5IISMigrateSecurityData.exe."></img></a>
						</p>
					</li>
					<li>
						Enter or select the .data file name. If the entire file is encrypted the &ldquo;<strong>Inspect Security Data</strong>&rdquo;
						button can be used to review the security data before importing. Sensitive data (passwords, security questions and answers) 
						will still be encrypted.
						<p>
							<a href="images/select-security-file.png"><img src="images/select-security-file.png" alt="Alpha Anywhere Migrate Security Data select security file."></img></a>
						</p>
					</li>
					<li>
						Select the web application that you published in step 1. The web application has the connection string to the
						database for the security data. Depending on how the application is allowed to access the database alternate
						credentials may be needed to import the security. For instance, your application may not add new users so the
						database credential may only allow read access. In order to do the import write access is needed so alternate 
						credential will need to be supplied.
						<p>
							<a href="images/web-app.png"><img src="images/web-app.png" alt="Alpha Anywhere Migrate Security Data select web application."></img></a>
						</p>
					</li>
					<li>
						Select the import mode. &ldquo;<strong>Merge</strong>&rdquo; is non-destructive. All existing users and roles will remain unchanged. 
						There is a &ldquo;<strong>Replace</strong>&rdquo; option. This option is destructive. All existing users and roles will be deleted before adding new users and 
						roles so use caution choosing this option.
					</li>
					<li>
						Click on the Import button to begin the import. Progress will be shown as the import is being done. Progress is also
						logged and this log can be reviewed after the import is completed.
						<p>
							<a href="images/show-log.png"><img src="images/show-log.png" alt="Alpha Anywhere Migrate Security Data show import log."></img></a>
						</p>
					</li>
					<li>
						Run your application and test login and page access.
					</li>
				</ol>
		</div>
	</body>
</html>
