<page>
    <topic>Migration Guide</topic>
    <description>Guide to migrating to Alpha Anywhere Application Server for IIS.</description>
    <groups>
        <group>
            <title>Alpha Anywhere Application Server for IIS Migration Guide</title>
            <sections>
                <section>
                    <title>Overview</title>
                    <note>This document is a work in progress.</note>
                </section>
            </sections>
        </group>
        <group>
            <title>Differences between IIS and the stand-alone server</title>
            <sections>
                <section>
                    <description>
                        This section contains information about features an application running on the stand-alone server may use
                        that could behave differently under IIS and what you can do to get those features working under IIS. Not all 
                        applications use these features so these may not apply to your application.
                    </description>
                    <steps>
                        <step>
                            <title>Security data is stored differently under IIS</title>
                            <description>
                                This feature will affect most applications. Alpha Anywhere Application Server for IIS uses ASP.NET's 
                                membership and role providers for authentication and authorization. Membership and role providers are 
                                abstract interfaces. These abstract interfaces are consistent across implementations. The same interface
                                is used with a membership provider implemented for SqlServer as is used for a membership provider
                                implemented for MySQL. Each implementation is free to store security data in any way it sees fit. 
                                This implementation detail (the persistence of security data) is hidden from the membership provider
                                user. 
                            </description>
                        </step>
                    </steps>
                </section>
            </sections>
        </group>
        <group>
            <title>Make Your Application Platform Agnostic</title>
        </group>
        <group>
            <title>Troubleshooting</title>
        </group>
        <group>
            <title>Migrate Security Data</title>
            <sections>
                <section>
                    <title>Introduction</title>
                    <description>
                        <p>Security data (users, groups, and membership) are stored differently under IIS than under Alpha Anywhere Application Server. This means an application running under IIS cannot use the same security data as the application running under the Alpha Anywhere Application Server. When an application running in production under Alpha Anywhere Application Server is moved to IIS, the security data must be migrated to an IIS provider schema. The specific schema that is used by an IIS provider is defined by the provider. Alpha Anywhere Application Server has a Genie in the server settings dialog to export security data and the Alpha Anywhere Application Server for IIS has a utility named A5IISMigrateSecurityData.exe to import security data in to an IIS provider.</p>
                        <p>The following security data are migrated with steps that follow:</p>
                    </description>
					<cases>
						<case>
                            <description>Users</description>
                            <cases>
                                <case>
                                    <description>Name</description>
                                </case>
                                <case>
                                    <description>Password</description>
                                </case>
                                <case>
                                    <description>Email Address</description>
                                </case>
                                <case>
                                    <description>Security Question</description>
                                </case>
                                <case>
                                    <description>Security Question Answer</description>
                                </case>
                                <case>
                                    <description>Locked Out</description>
                                    <note>
                                        A user may be locked out because of too many failed log in attempts or because an application adminstrator has manually disabled the user. A user that is locked out because of too many failed log in attempts is typically automatically reenabled after a period of time. When a user in this state is migrated, the user is treated as if an application adminstrator has manually disabled the user so the user must be manually reenabled by an application adminstrator.
                                    </note>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <description>Groups (roles)</description>
                        </case>
                        <case>
                            <description>Membership -- The list of groups to which each user belongs.</description>
                        </case>
					</cases>
                </section>
                <section>
                    <title>Security Data Migration Steps</title>
                    <steps>
                        <step><description>Create a publish profile to publish to an IIS server. Part of the publish profile includes configuring the memberhip provider (for users) and role provider (for groups) to be used by the application. See the [Provider Configuration] documentation for more information on choosing providers.</description>
                        </step>
                        <step>
                            <description>Publish using the newly created publish profile. The publish dialog has an option to publish security data. This option will publish security data as defined in Alpha Anywhere Developer Edition. This data will not contain an accurate lock out status of users since the lock out status data is kept on the production web server. Since you will be exporting data from the production server instead, choose the "Ignore - Do not publish users and roles." option. This option will define the membership and role providers in the published application. This is needed in order to import users, groups, and membership under IIS.
                            </description>
                        </step>
                        <step>
                            <description>Go to the application server settings dialog in Alpha Anywhere Application Server. This dialog is opened from the context menu of the Alpha Anywhere Application Server tray icon.</description>
                            <figure>
                                <link>images/tray.png</link>
                                <title>Alpha Anywhere Application Server tray icon context menu.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Select the tab labeled "Other" and click on the "Open the Users and Groups Migration Genie" link.</description>
                            <figure>
                                <link>images/other.png</link>
                                <title>Alpha Anywhere Application Server users and groups migration genie link.</title>
                            </figure>
                        </step>
                        <step>
                            <description>The User and Groups Migration Genie has an information section to explain its purpose. The information section contains a checkbox labeled "Migrate a web application's security data". This check box will need to be selected in order to continue with the rest of the genie.</description>
                            <figure>
                                <link>images/genie.png</link>
                                <title>Alpha Anywhere Application Server users and groups migration genie.</title>
                            </figure>
                        </step>
                        <step>
                            <description>After selecting the "Migrate a web application's security data" checkbox, the genie will scan the application server for applications that have security data. Select an application and then choose a location for the exported data. The export process will also generate a key for securing sensitive data like passwords, and security questions and answers. This key will be stored in a file with a .key extension. If needed, this .key file can be kept apart from the data file making it easier to move the data file securely to the IIS server. You will only need the .key file once the data file is on the IIS server and you are ready to import the security data. You may also select to encrypt the entire security data file rather than just the sensitive data in it.</description>
                            <figure>
                                <link>images/ready-for-export.png</link>
                                <title>Alpha Anywhere Application Server users and groups ready for export.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Click the "Export Data" button to begin the export. The export may take some time depending on the amount of users, groups, and number of users assigned to groups. When the export is finished a Windows file explorer window will open to the folder with the .data and .key file and the .data file will be selected. Now the files can be moved to the IIS server.</description>
                            <figure>
                                <link>images/export-complete.png</link>
                                <title>Alpha Anywhere Application Server export complete.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Use any means to move the .data file to the IIS server. If you do not want to move the .key file over a network you can copy it to a thumb drive and carry it to the IIS server. When you are ready to do the import copy the .key file from the thumb drive into the same folder as the .data file.</description>
                        </step>
                        <step>
                            <description>Now that the .data and .key files are on the IIS server the A5IISMigrateSecurityData.exe utility can be used to import the security data. This utility is located in the installation folder which defaults to C:\Program Files (x86)\A5V12 Application Server for IIS. This utility must be "Run as adminstrator" to ensure that it has access IIS application configurations.</description>
                            <figure>
                                <link>images/run-as-administrator.png</link>
                                <title>Alpha Anywhere A5IISMigrateSecurityData.exe.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Enter or select the .data file name. If the entire file is encrypted the "Inspect Security Data" button can be used to review the security data before importing. Sensitive data (passwords, security questions and answers) will still be encrypted.</description>
                            <figure>
                                <link>images/select-security-file.png</link>
                                <title>Alpha Anywhere Migrate Security Data select security file.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Select the web application that you published in step 1. The web application has the connection string to the database for the security data. Depending on how the application is allowed to access the database alternate credentials may be needed to import the security. For instance, your application may not add new users so the database credential may only allow read access. In order to do the import write access is needed so alternate credential will need to be supplied.</description>
                            <figure>
                                <link>images/web-app.png</link>
                                <title>Alpha Anywhere Migrate Security Data select web application.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Select the import mode. "Merge" is non-destructive. All existing users and roles will remain unchanged. There is a "Replace" option. This option is destructive. All existing users and roles will be deleted before adding new users and roles so use caution choosing this option.</description>
                        </step>
                        <step>
                            <description>Click on the Import button to begin the import. Progress will be shown as the import is being done. Progress is also logged and this log can be reviewed after the import is completed.</description>
                            <figure>
                                <link>images/show-log.png</link>
                                <title>Alpha Anywhere Migrate Security Data show import log.</title>
                            </figure>
                        </step>
                        <step>
                            <description>Run your application and test login and page access.</description>
                        </step>
                    </steps>
                </section>
            </sections>
        </group>
    </groups>
    <links>
        <link href="../ConfigureProviders/ProviderConfiguration.html">Provider Configuration</link>
    </links>
</page>
				
