<page build="3922">
    <topic>Using Watch Events to Update ControlBar Data</topic>
    <description>The ControlBar data can be updated automatically in response to certain events in the UX (such as the UX going dirty, a List going dirty, etc.) or by a change in the value of one or more controls. Watch Events can be defined in the ControlBar Builder inside the Data pane by first clicking the 'Add Data Item' button and then checking the 'Update value automatically based on a 'watch' events' checkbox. If a html item is placed in the ControlBar then the Watch Event can be added as a placeholder in the HTML text property.</description>
    <sections>
        <section>
            <figure>
                <title>Information from an active row's 'City' field is displayed in a ControlBar using a watch event.</title>
                <link>images/we32.png</link>
            </figure>
        </section>
        <section>
            <description>To see how you can configure watch events to automatically update ControlBar data follow the guide below or watch this video:</description>
        </section>
        <section>
            <title>Using Watch Events to Update ControlBar Data</title>
            <description>
                <p>The ControlBar data can be updated automatically in response to certain events in the UX (such as the UX going dirty, a List going dirty, etc.) or by a change in the value of one or more controls.</p>
                <p>In this video we show how you can configure watch events to automatically update ControlBar data.</p>
            </description>
            <videos>
                <video>
                    <name>Watch Video</name>
                    <link>https://www.viddler.com/v/ea6325f3</link>
                </video>
                <date>2016-09-14</date>
            </videos>
        </section>
        <section>
            <title>Create a Component with a List and ControlBar</title>
            <steps>
                <step>
                    <description>In the UX Builder on the UX Controls page check the 'Mobile' checkbox.</description>
                    <figure>
                        <link>images/we.png</link>
                    </figure>
                </step>
                <step>
                    <description>Open the Panels menu and select [Panel Card] to add a Panel Card to the component.</description>
                    <figure>
                        <link>images/we2.png</link>
                    </figure>
                </step>
                <step>
                    <description>Highlight the Panel Card and open the Containers menu. Click on [Container]</description>
                    <figure>
                        <link>images/we3.png</link>
                    </figure>
                </step>
                <step>
                    <description>From the Container Type list select the PanelHeader option and click 'Insert After'.</description>
                    <figure>
                        <link>images/we4.png</link>
                    </figure>
                </step>
                <step>
                    <description>Highlight the Panel Header. Open the 'Other Controls' menu a click on [ControlBar] to add a control bar to the panel header.</description>
                    <figure>
                        <link>images/we5.png</link>
                    </figure>
                </step>
                <step>
                    <description>Highlight [PanelHeader End:PANELHEADER_1] and open the 'Data Controls' menu. Click on [List] to add a list control to the component.</description>
                    <figure>
                        <link>images/we6.png</link>
                    </figure>
                </step>

                <step>
                    <description>Highlight the list control. In the properties list on the right click on the 'List properties' property, in the  List Properties section. to open the List Builder.</description>
                    <figure>
                        <link>images/we7.png</link>
                    </figure>
                </step>

                <step>
                    <description>On the List Builder's Data Source pane set the Data Source Type to SQL. The video example uses a 'Static' data source, which also works.</description>
                    <figure>
                        <link>images/we8.png</link>
                    </figure>
                </step>

                <step>
                    <description>In the SQL Data Source section of the Data Source pane click the [...] button next to the Connection string property. Set the 'Connection string' to be the 'Northwind' database.</description>
                    <figure>
                        <link>images/we9.png</link>
                    </figure>
                </step>

                <step>
                    <description>Set the 'Table name' property to be the 'Customers' table.</description>
                    <figure>
                        <link>images/we10.png</link>
                    </figure>
                </step>

                <step>
                    <description>For the Field list property select the ContactName and City fields from the list of choices.</description>
                    <figure>
                        <link>images/we11.png</link>
                    </figure>
                </step>

                <step>
                    <description>Having set the data source scroll down to the Data Source pane to the 'Return Value' section. From the dropdown set the 'Return value type' to be Expression.</description>
                    <figure>
                        <link>images/we12.png</link>
                    </figure>
                </step>

                <step>
                    <description>Click the [...] button next to the 'Return expression' property.</description>
                    <figure>
                        <link>images/we13.png</link>
                    </figure>
                </step>

                <step>
                    <description>In the Return Value Expression dialog double click on one of the fields in the 'Available Fields' list. The field should show up in the expression box on the right of the dialog. This example uses the 'data.City' field. Click OK.</description>
                    <figure>
                        <link>images/we14.png</link>
                    </figure>
                    <note>This Field's information will be displayed in the ControlBar when any given row is highlighted.</note>
                </step>

                <step>
                    <description>Open the 'List Layout' pane. Use the blue > arrow to move the ContactName and City fields from the Available Fields list to the Columns in List area. Click OK to close the List Builder.</description>
                    <figure>
                        <link>images/we15.png</link>
                    </figure>
                </step>
                <step>
                    <description>The component tree should look like this:</description>
                    <figure>
                        <link>images/we16.png</link>
                    </figure>
                </step>
            </steps>
        </section>
        <section>
            <title>Add a Watch Event</title>
            <steps>
                <step>
                    <description>Highlight the ControlBar. Click on the [...] button next to the ControlBar properties property to open the ControlBar Builder.</description>
                    <figure>
                        <link>images/we17.png</link>
                    </figure>
                </step>
                <step>
                    <description>In the ControlBar Builder open the 'Data' pane. Click the 'Add Data Item' button.</description>
                    <figure>
                        <link>images/we18.png</link>
                    </figure>
                </step>
                <step>
                    <description>In the Setting dialog give the new data item the name 'newValue'.</description>
                    <figure>
                        <link>images/we19.png</link>
                    </figure>
                </step>
                <step>
                    <description>Check the 'Update value automatically based on a 'watch' event.</description>
                    <figure>
                        <link>images/we20.png</link>
                    </figure>
                </step>
                <step>
                    <description>Click the 'Select' button next to the 'Controls to watch:' control box. Select the list you defined, list1.</description>
                    <figure>
                        <link>images/we21.png</link>
                    </figure>
                </step>
                <step>
                    <description>Add the following Javascript to the newValue setting definition and click OK:</description>
                    <example>
                        <![CDATA[var listValue = {dialog.object}.getValue('list1');
return listValue;]]>
                    </example>
                    <figure>
                        <link>images/we22.png</link>
                    </figure>
                    <note>This code gets the return value that was set for list1 in the Data Source pane of the List Control.</note>
                </step>
                <step>
                    <description>Open the Items pane and click the 'Add ControlBar Item'</description>
                    <figure>
                        <link>images/we23.png</link>
                    </figure>
                </step>
                <step>
                    <description>From the 'Item Type' choices select 'html' and click OK.</description>
                    <figure>
                        <link>images/we24.png</link>
                    </figure>
                </step>
                <step>
                    <description>Highlight the html item. Click the [...] button next to the 'HTML text' property under HTML Settings section.</description>
                    <figure>
                        <link>images/we25.png</link>
                    </figure>
                </step>
                <step>
                    <description>Double click on the {newValue} placeholder in the Available Placeholders list. The placeholder should appear in the HTML work area on the right. Click OK.</description>
                    <figure>
                        <link>images/we26.png</link>
                    </figure>
                </step>
                <step>
                    <description>Open the 'ControlBar Layout' pane. Click the 'Add Layout' button. Give the new layout a name like 'Layout1'.</description>
                    <figure>
                        <link>images/we27.png</link>
                    </figure>
                </step>
                <step>
                    <description>Click the 'Add Line' button.</description>
                    <figure>
                        <link>images/we28.png</link>
                    </figure>
                </step>
                <step>
                    <description>In the 'Edit Layout Line' dialog click the 'Add' button underneath the 'Middle' section.</description>
                    <figure>
                        <link>images/we29.png</link>
                    </figure>
                </step>
                <step>
                    <description>Select the HTML item that was defined, Html1. Click OK and OK again to close the ControlBar Builder.</description>
                    <figure>
                        <link>images/we30.png</link>
                    </figure>
                </step>
                <step>
                    <description>Run the component in Live Preview.</description>
                    <figure>
                        <link>images/we31.png</link>
                    </figure>
                </step>
                <step>
                    <description>Use the arrow keys on the keyboard to scroll through the list control. The Watch Event should update the ControlBar data.</description>
                    <figure>
                        <link>images/we32.png</link>
                    </figure>
                </step>
            </steps>
        </section>
    </sections>
    <links>
        <link href="images/open.png">...</link>
    </links>
</page>
