<page api="xb" build="7796">
    <shortlink>xbasic_execute_python function</shortlink>
    <topic>xbasic_execute_python Function</topic>
    <description>
        <p>Executes a Python script.</p>
    </description>
    <prototypes>
        <prototype>dim result as P =  xbasic_execute_python(pythonScript as C)</prototype>
    </prototypes>
    <arguments>
        <argument>
            <name>pythonCod</name>
            <type>C</type>
            <description>
                <p>The Python script to execute.</p>
            </description>
        </argument>
    </arguments>
    <returns>
        <return>
            <name>result</name>
            <type>P</type>
            <description>
                <p>Returns an object with the following properties:</p>
            </description>
            <properties>
                <property>
                    <name>error</name>
                    <type>L</type>
                    <description>*[xb:.t.]* if an error occurs. Otherwise *[xb:.f.]*.</description>
                </property>
                <property>
                    <name>result</name>
                    <type>c</type>
                    <description>If no error occurs, the output from the Python script</description>
                </property>
                <property>
                    <name>errorText</name>
                    <type>C</type>
                    <description>If an error occurs, additional information about the error.</description>
                </property>
            </properties>
        </return>
    </returns>
    <discussion>
        <p>The *[xb:]* function runs a Python script. The Python code can execute Print() statements and the output generated by these Print() statements is returned in the result property.</p>
        <p>
            <example code="xb"><![CDATA[dim pythonCode as c

pythonCode = <<%str%
def my_function():
    print("value1")
    print("value2")
my_function()
%str%

dim result as p

result = xbasic_execute_python(pythonCode)

if result.error = .f. then
    showvar(result.result)
end if]]></example>
        </p>
        <p>The Python code that you execute can use Python modules that you have installed.</p>
    </discussion>
    <see>
        <ref link="python guide">Calling Python From Xbasic</ref>
    </see>
</page>