<page>
    <shortlink>server DotNet Example Using a Private Assembly</shortlink>
    <topic>DotNet Example: Using a Private Assembly</topic>
    <description>Download and unzip the attached assembly, which corresponds to the C# source code in the first snippet. Paste the Xbasic code in the second snippet into an Alpha Anywhere script, edit the path to the location of the downloaded DLL, and run the script.</description>
    <discussion>The C# source code for the .NET class being used:</discussion>
    <sections>
        <section>
            <example><![CDATA[using System;
using System.Text;
 
namespace MyCSLib
{
    public class MyCSClass
    {
        public String MyProperty
        {
            get
            {
                return "Hello from MyCSClass";
            }
            set
            {
            }
        }
 
        public String DoSomething()
        {
            return "MyCSClass did something";
        }
    }
}]]></example>
        </section>
        <section>
            <description>The Xbasic code to use it:</description>
            <example><![CDATA[dim Sv as DotNet::Services
dim assy as DotNet::AssemblyReference
'edit the path in the next statement for your location
assy.FileName="<path>\MyCSLib.dll"
if .not. file.exists(assy.FileName)
    ui_msg_box("can't find file",assy.FileName)
    end 
end if
rc = sv.RegisterClass("My","Class","MyCSLib.MyCSClass",assy)
if rc then
    dim cl as My::Class
    dim result as c
    result=cl.DoSomething()
    result= result + crlf() + cl.MyProperty
    showvar(result)
else
    ui_msg_box("MyCSLib Demo","MyCSClass class not registered")
    'Note: if you get here, try closing and restarting Alpha Five
    'It usually means a previous registration failed
    'It can also mean that you put a downloaded file in a protected spot, such as C:\
    'You can right-click on the DLL file from Windows Explorer and unblock it.
end if]]></example>

        </section>
        <section>
            <description>The result in the ShowVar dialog will show:</description>
            <example><![CDATA[MyCSClass did something
Hello from MyCSClass]]></example>
        </section>
    </sections>
    <see>
        <ref link="api namespace dotnet namespace">Xbasic DotNet Namespace</ref>
    </see>


</page>