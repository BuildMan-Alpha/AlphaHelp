	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Working with Tables from another Session and with Child 
 Tables on a Form</p>



<p>Assume that you have two forms open, FormA and FormB. It is possible 
 for a script that is attached to a button or event in FormB to manipulate 
 (i.e., enter, edit, delete records etc.) the table or tables that FormA 
 is based on.</p>



<p>Generally when a script needs to manipulate a table in the current session, 
 you obtain a reference to the table in the current session using the <a href="../References/Methods/TABLE.CURRENT Method.html" title="TABLE.CURRENT Method" class="wiki">TABLE.CURRENT(</a>) method. For 
 example, the following script, which is attached to a button on a form, 
 enters a record into the table on which the form is based:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>tbl.enter_begin()</p>


<p class=Code>tbl.first_name = "Fred"</p>


<p class=Code>tbl.last_name = "Jones"</p>


<p class=Code>tbl.enter_end(.T.)</p>


<p class=Code>parent.resynch()&nbsp;&nbsp;'resynch the form to display 
 the new record</td></tr>
</table>

<p>The following code does the exact same thing using a more cumbersome 
 syntax to refer to the table that the form is based on:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>parent:tables:customer.enter_begin()</p>


<p class=Code>parent:tables:customer.first_name = "Fred"</p>


<p class=Code>parent:tables:customer.last_name = "Jones"</p>


<p class=Code>parent:tables:customer.enter_end(.T.)</td></tr>
</table>

<p>As the above examples show, you can refer to a table's methods or properties 
 in a form (or browse) using this syntax:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>:window_name:Tables:table_name.method</p>


<p class=Code>:window_name:Tables:table_name.property</td></tr>
</table>

<p class=A5>All Field Rules vs Validation Field Rules</p>



<p>In the above example, the alias <span class=Code1>Parent</span> is used 
 in place of the actual window name.&nbsp;So, for example, if FormA is 
 based on a table called Customer, then the following Xbasic script could 
 be attached to a button on Form B:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>:FormA:Tables:Customer.enter_begin()</p>


<p class=Code>:FormA:Tables:Customer.first_name = "Fred"</p>


<p class=Code>:FormA:Tables:Customer.last_name = "Jones"</p>


<p class=Code>:FormA:Tables:Customer.enter_end(.T.)</td></tr>
</table>

<p>Contrast the above example, which enters a new record in the Customer 
 table by "working behind the scenes" with the following code 
 which achieves the same thing, but manipulates the form directly.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>:FormA.new_record()</p>


<p class=Code>:FormA:first_name.value = "Fred"</p>


<p class=Code>:FormA:last_name.value = "Jones"</p>


<p class=Code>:FormA.commit()</td></tr>
</table>

<p>Note that while the above two code fragments both add a new record to 
 the Customer table, there are significant differences. Because the second 
 code fragment directly manipulates the form, it works&nbsp;as&nbsp;though 
 the user himself was typing the data into the new record. This means that 
 <span class=Bolded>all field rules</span> are in effect. So, for example, 
 if the <span class=Code1>first_name</span> field had a rule that capitalized 
 text, the <span class=Code1>first_name</span> value would be stored&nbsp;as&nbsp;"FRED".</p>



<p>Since the first code fragment works "behind the scenes", <span 
 class=Bolded>only validation field rules</span> are in effect. Capitalization 
 field rules, for example, would be ignored.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Working+with+Tables+from+another+Session+and+with+Child+++Tables+on+a+Form">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/View/Form/","status":"pending","tags":"desktop","keywords":"desktop,guide,form"} --->
</body></html>