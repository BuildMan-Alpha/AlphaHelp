	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Returning a Different Field Than You Display</p>



<p>Frequently in a database application you will want to display one field 
 value while storing a different field value. For example, you might want 
 to display "Alaska" but store "AK". You might want 
 to display a user's full name, but store his or her employee number. The 
 following two examples show how to use this technique with a drop down 
 list of choices</p>



<p class=A5><a name=Using_a_WHILE_____END_WHILE_Loop>Using a WHILE ... 
 END WHILE Loop</a></p>



<ol>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W 
 page with the following content.</p>

</li>
</ol>


<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>&lthtml></span></p>


<p class=Code><span class=HTML1>&ltbody></span></p>


<p class=Code><span class=HTML1>The drop-down list below is dynamically 
 built from the AlphaSports customer table.&ltbr></span></p>


<p class=Code><span class=HTML1>It displays each customer's name in the 
 drop-down, but when one is selected, it returns the</span></p>


<p class=Code><span class=HTML1>customer id instead of the name.&ltbr></span></p>


<p class=Code><span class=HTML1>&ltbr></span></p>


<p class=Code>&lt%A5</p>


<p class=Code>if eval_valid("cCmd") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if cCmd = "Select" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? "&ltB>The 
 previously selected value was: " + cSelectBox + "&lt/B>&ltBR>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</p>


<p class=Code>%></p>


<p class=Code><span class=HTML1>&ltform ACTION="</span> &lt%A5 ? 
 Request.Script_Name %> <span class=HTML1>" METHOD="post"></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltSELECT 
 NAME="cSelectBox"></span></span> </p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt%A5</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pTbl 
 = table.open("customer.dbf")</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pTbl.fetch_first()</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while 
 .not. pTbl.fetch_eof()</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=HTML1>&ltOPTION VALUE="</span> &lt%A5 ? pTbl.customer_id 
 %> <span class=HTML1>"></span> &lt%A5 ? pTbl.firstname + " 
 " + pTbl.lastname %> <span class=HTML1>&lt/OPTION></span></span> 
 </span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt%A5</span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pTbl.fetch_next()</span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 while</span></span></p>


<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=HTML1>&lt/SELECT></span></span> </span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span 
 class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput TYPE="submit" 
 NAME="cCmd" VALUE="Select"></span></span> </span></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span 
 class=HTML1><span class=HTML1>&lt/form></span></span> </span></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span 
 class=HTML1><span class=HTML1>&lt/body></span></span> </span></span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span 
 class=HTML1><span class=HTML1>&lt/html></span></span> </span></span></span></td></tr>
</table>

<p>Things to note in this page include:</p>



<ol>
  
  <ol start=2>
    
    <li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>pTbl</span> 
 is a pointer variable. It is DIMmed implicitly by the <span class=Code1>pTbl 
 = table.open("customer.dbf")</span> statement. This means that 
 Alpha Five knows out that <span class=Code1>pTbl</span> is a Pointer variable 
 because the <span class=Code1>table.open()</span> function creates a pointer 
 variable.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1><span class=HTML1>cCmd</span> 
 is a character variable created by the <span class=HTML1>&ltinput TYPE="submit" 
 NAME="cCmd" VALUE="Select"></span> statement. This 
 mean that <span class=HTML1>cCmd</span> does not exist until the page 
 has been run at least once. The <span class=Code1>eval_valid("cCmd")</span> 
 expression tests to see if <span class=HTML1>cCmd</span> exists before 
 displaying the selected <span class=Code1>customer_id</span> value.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=HTML1>form 
 ACTION="</span> <span class=Code1>&lt%A5 ? Request.Script_Name %></span> 
 <span class=HTML1>"</span> expression causes the page to be reloaded 
 after you select an entry from the list box and store it in the <span 
 class=HTML1>cSelectBox</span> variable.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Methods/TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">pTbl.fetch   eof(</a>) method returns .T. (TRUE) when you have read the last record 
 in a table. Consequently, the expression <a href="../References/Methods/TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">.not.   pTbl.fetch eof(</a>) returns .F. (FALSE) and ends the WHILE ... END WHILE 
 loop after you read the last record.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=HTML1>VALUE="</span> 
 <span class=Code1>&lt%A5 ? pTbl.customer_id %></span> <span class=HTML1>"</span> 
 statement sets the value that the list box returns when you select one 
 of its entries.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>&lt%A5 
 ? pTbl.firstname + " " + pTbl.lastname %></span> expression 
 between the <span class=HTML1>&ltOPTION ...></span> and <span class=HTML1>&lt/OPTION></span> 
 tags specifies the data to display in the list box. This is different 
 than the data that is saved.</p>

</li>
  </ol>
</ol>

<ol start=2>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File 
 > Save As</span> and name the page "Save_Different_Value_1".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif"
  x-maintain-ratio=TRUE
  style="border: none;
      width: 22px;
      height: 22px;
      float: none;
      border-style: none;
      border-style: none;"
  width=22
  height=22
  border=0> to run the page in Live Preview. </p>

</li>
</ol>

<p class=Pix><img src="images/WPT_Save_Different_Value_1.gif"
          x-maintain-ratio=TRUE
          style="border: none;
              width: 427px;
              height: 343px;
              float: none;
              border-style: none;
              border-style: none;"
          width=427
          height=343
          border=0></p>



<p class=A5><a name=Using_TABLE_EXTERNAL_RECORD_CONTENT_GET__>Using TABLE.EXTERNAL_RECORD_CONTENT_GET()</a></p>



<ol>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W 
 page with the following content.</p>

</li>
</ol>


<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>&lthtml></span></p>


<p class=Code><span class=HTML1>&lttitle>Save_Different_Value_2&lt/title></span></p>


<p class=Code><span class=HTML1>&ltbody></span></p>


<p class=Code><span class=HTML1>Below is a drop-down list similar to above, 
 but it is built using the TABLE.EXTERNAL_RECORD_CONTENT_GET() function.&ltbr></span></p>


<p class=Code><span class=HTML1>This method should run faster than a WHILE 
 ... END WHILE loop.&ltbr></span></p>


<p class=Code><span class=HTML1>&ltbr></span></p>


<p class=Code>&lt%A5</p>


<p class=Code>if eval_valid("cCmd2") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if cCmd2 = "Select" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? "&ltB>The 
 previously selected value was: " + cSelectBox + "&lt/B>&ltBR>"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</p>


<p class=Code>%></p>


<p class=Code><span class=HTML1>&ltform ACTION="</span> &lt%A5 ? 
 Request.Script_Name %> <span class=HTML1>" METHOD="post"></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltSELECT 
 NAME="cSelectBox"></span></span> </p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt%A5</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cOptions 
 = table.external_record_content_get("customer.dbf", "'&ltOPTION 
 VALUE=' + customer_id + '>' + firstname + ' ' + lastname", "lastname","")</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? 
 cOptions</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/SELECT></span></span> 
 </p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; 
 <span class=HTML1>&ltinput TYPE="submit" NAME="cCmd2" 
 VALUE="Select"></span></span> </span></span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form></span></span> 
 </span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1>&lt/body></span></span> 
 </span></p>


<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1></html></span></span> 
 </span></td></tr>
</table>

<p>Many of the features of this page are the same&nbsp;as&nbsp;"Save_Different_Value_1.a5w".</p>



<ol style="list-style: disc;"
  type=disc>
  
  <ul style="list-style: disc;"
    type=disc>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>However, the process 
 of loading the <span class=Code1>cOptions</span> into the list box is 
 different. The entries that you see in the list box come from the <span 
 class=Code1>cOptions</span> character variable, which is implicitly DIMmed 
 by the <a href="../References/Methods/TABLE.EXTERNAL_RECORD_CONTENT_GET Method.html" title="TABLE.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">TABLE.EXTERNAL_RECORD_CONTENT_GET(</a>) 
 method, which returns a character value.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>This method creates 
 a CR-LF delimited list of entries of a specified format. In this case 
 each entry contains data from a record in the customer table. Each entry 
 is of the format <span class=Code1>'<OPTION VALUE=' + customer_id + 
 '>' + firstname + ' ' + lastname</span>.</p>

</li>
    
    <li class=kadov-p-CBullet1><p class=Bullet1>Note that the expression 
 above uses single quote marks around its literal values, so the entire 
 expression can be wrapped in double quote marks,&nbsp;as&nbsp;required 
 by the TABLE.EXTERNAL_RECORD_CONTENT_GET() method.</p>

</li>
  </ul>
</ol>

<ol start=2>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File 
 > Save As</span> and name the page "Save_Different_Value_2".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif"
  x-maintain-ratio=TRUE
  style="border: none;
      width: 22px;
      height: 22px;
      float: none;
      border-style: none;
      border-style: none;"
  width=22
  height=22
  border=0> to run the page in Live Preview.</p>

</li>
</ol>

<p class=A5>See Also</p>



<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Returning+a+Different+Field+Than+You+Display">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>