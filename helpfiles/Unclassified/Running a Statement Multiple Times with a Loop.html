	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Running a Statement Multiple Times with a Loop</p>

<p>Many times you will want to execute the same line of code multiple times. Frequently, you will not know in advance how many times this will need to be. Looking at the following code sample, you can see that it uses a <a href="../References/Xbasic/FOR __ELLIPSES__ NEXT.html" title="FOR ... NEXT" class="wiki">FOR ... NEXT</a> loop, which solves this problem for a phrase that could contain any number of words.</p>

<p class=A5>Using a FOR ... NEXT Loop</p>

<p>A <a href="../References/Xbasic/FOR __ELLIPSES__ NEXT.html" title="FOR ... NEXT" class="wiki">FOR ... NEXT</a> loop uses a counter variable (in this case it is "nCounter"). The loop starts by setting <span class=Code1>nCounter</span> equal to 1. It runs until <span class=Code1>nCounter</span> is greater than <span class=Code1>WordCount</span>, then the <span class=Screen>Application Server</span> runs the first line of code after the NEXT statement.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using a FOR ... NEXT Loop&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cPhrase&nbsp;as&nbsp;C</p>

<p class=Code>dim nWordCount&nbsp;as&nbsp;N</p>

<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>

<p class=Code>Phrase = "Four score and seven years ago"</p>

<p class=Code>nWordCount = w_count(Phrase)</p>

<p class=Code>for nCounter = 1 to nWordCount</p>

<p class=Code>? "Word " + nCounter + " is " + word(cPhrase, nCounter, " ") + "&ltbr>"</p>

<p class=Code>next nCounter</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ul style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p>The <a href="../References/Functions/W_COUNT Function.html" title="W_COUNT Function" class="wiki">W_COUNT(</a>) function returns the number of words in a string. </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p>The <a href="../References/Functions/WORD Function.html" title="WORD Function" class="wiki">WORD(</a>) function will return the Nth word in a string, where you define the word delimiter (in this case a space character). </li> </ul> </ul> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;""Using FOR NEXT.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this:&nbsp; </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_FOR_NEXT.gif" x-maintain-ratio=TRUE style="border: none; width: 472px; height: 300px; float: none; border-style: none; border-style: none;" width=472 height=300 border=0></p>

<p class=A5>Using the STEP Argument in a FOR ... NEXT Loop</p>

<p>The normal FOR ... NEXT loop increments its counter by 1 on each pass. The STEP argument allows you to increment or decrement the counter by any other positive or negative <span class=Bolded>integer</span> value. The following example shows the STEP argument with a negative value. <span class=Note>Note</span> : Using 0&nbsp;as&nbsp;the STEP argument results in a permanent loop.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using FOR ... NEXT ... STEP&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim nBig&nbsp;as&nbsp;N</p>

<p class=Code>for nBig = 10 to 0 step -1</p>

<p class=Code>? chr_multi(asc("O"), nBig) + "&ltbr>"</p>

<p class=Code>next nBig</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/CHR Function.html" title="CHR Function" class="wiki">CHR(</a>) function outputs a letter, indicated by its ASCII value.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/CHR_MULTI Function.html" title="CHR_MULTI Function" class="wiki">CHR_MULTI(</a>) function outputs multiple copies of a letter, indicated by its ASCII value.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The CHR_MULTI() function required the ASCII value of "O". Instead of looking it up, I used the <a href="../References/Functions/ASC Function.html" title="ASC Function" class="wiki">ASC(</a>) function to return its ASCII value.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using FOR NEXT STEP".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_FOR_NEXT_STEO.gif" x-maintain-ratio=TRUE style="border: none; width: 464px; height: 361px; float: none; border-style: none; border-style: none;" width=464 height=361 border=0></p>

<p class=A5>Exiting from a FOR ... NEXT Loop</p>

<p>Xbasic provides a technique for an early exit from a FOR ... NEXT loop. The command to use it EXIT FOR. If you are looking through a list of items and want to quit when you have found what you are looking for, use the EXIT FOR command.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Exiting from a FOR ... NEXT Loop&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cList&nbsp;as&nbsp;C</p>

<p class=Code>dim nMaxLength&nbsp;as&nbsp;N = 7</p>

<p class=Code>cList = cstates()</p>

<p class=Code>nWordCount = w_count(cList)</p>

<p class=Code>for nCounter = 1 to nWordCount</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cThisWord = word( cList, nCounter, crlf() )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if len(cThisWord) > nMaxLength then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? "Word " + nCounter + " is " + cThisWord + "&ltbr>"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit for</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>next nCounter</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/CSTATES Function.html" title="CSTATES Function" class="wiki">CSTATES(</a>) function returns an alphabetical list of states of the United States, United States territories, the District of Columbia, and all of the Canadian Provinces.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/WORD Function.html" title="WORD Function" class="wiki">WORD(</a>) function selects then Nth entry in a CR-LF delimited list by specifying <a href="../References/Functions/CRLF Function.html" title="CRLF Function" class="wiki">CRLF(</a>)&nbsp;as&nbsp;the word delimiter.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/LEN Function.html" title="LEN Function" class="wiki">LEN(</a>) function returns the length of a word.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Exiting from a FOR NEXT Loop".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Exiting_from_a_FOR_NEXT_Loop.gif" x-maintain-ratio=TRUE style="border: none; width: 408px; height: 223px; float: none; border-style: none; border-style: none;" width=408 height=223 border=0></p>

<p class=A5>Creating an Array</p>

<p>You will frequently used FOR ... NEXT loops with arrays. An array is a set of one or more values of the same data type in a single data structure. For example:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim cPrimaryColor[6]&nbsp;as&nbsp;C</p>

<p class=Code>cPrimaryColor[1] = "Purple"</p>

<p class=Code>cPrimaryColor[2] = "Red"</p>

<p class=Code>cPrimaryColor[3] = "Orange"</p>

<p class=Code>cPrimaryColor[4] = "Yellow"</p>

<p class=Code>cPrimaryColor[5] = "Green"</p>

<p class=Code>cPrimaryColor[6] = "Blue"</td></tr> </table><p>You may have arrays of all Xbasic data types. You may have arrays with multiple dimensions. For example:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim nCoordinate[4,4]&nbsp;as&nbsp;N</p>

<p class=Code>nCoordinate[1,1] = 12</p>

<p class=Code>nCoordinate[1,2] = 102</p>

<p class=Code>...</p>

<p class=Code>nCoordinate[4,1] = 56</p>

<p class=Code>...</td></tr> </table><p>For more information about arrays, see <a href="../References/Xbasic/Xbasic Reference/Arrays.html" title="Arrays" class="wiki">Arrays</a>.</p>

<p class=A5>Using FOR ... NEXT with an Array</p>

<p>FOR ... NEXT loops provide an excellent way of working with arrays, since the loop counter can be used&nbsp;as&nbsp;the index into the array.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using an Array with a FOR ... NEXT Loop&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cNames[1..5]&nbsp;as&nbsp;C</p>

<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>

<p class=Code>cNames[1] = "Henry"</p>

<p class=Code>cNames[2] = "Burt"</p>

<p class=Code>cNames[3] = "Ernie"</p>

<p class=Code>cNames[4] = "Linda"</p>

<p class=Code>cNames[5] = "Cheryl"</p>

<p class=Code>for nCounter = 1 to 5</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;? cNames[nCounter] + "&ltbr>"</p>

<p class=Code>next nCounter</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using an Array with a FOR NEXT Loop".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_an_Array_with_a_FOR_NEXT_Loop.gif" x-maintain-ratio=TRUE style="border: none; width: 412px; height: 259px; float: none; border-style: none; border-style: none;" width=412 height=259 border=0></p>

<p class=A5>Using a WHILE Loop with an Equality Test</p>

<p>The <a href="WHILE __ELLIPSES__ END WHILE.html" title="WHILE ... END WHILE" class="wiki">WHILE</a> loop is used for situations where it is not practical to use a counter. The loop starts and runs&nbsp;as&nbsp;long&nbsp;as&nbsp;an expression evaluates to True (.T.).</p>

<p>In the following example the <span class=Code1>OneWord</span> variable is initialized to contain the word "Four".&nbsp;as&nbsp;long&nbsp;as&nbsp;the <span class=Code1>word(Phrase, WordCounter, " ")</span> function is able to retrieve another word, the loop continues. When <span class=Code1>OneWord</span> is NULL, the <span class=Screen>Application Server</span> continues execution with the line after the END WHILE statement.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using WHILE with an Equality Test&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim Phrase&nbsp;as&nbsp;C</p>

<p class=Code>dim OneWord&nbsp;as&nbsp;C</p>

<p class=Code>dim NextPos&nbsp;as&nbsp;N</p>

<p class=Code>dim WordCounter&nbsp;as&nbsp;N</p>

<p class=Code>Phrase = "Four score and seven years ago"</p>

<p class=Code>NextPos = atc(" ", Phrase, 1)</p>

<p class=Code>OneWord = substr(Phrase, 1, NextPos-1)</p>

<p class=Code>WordCounter = 1</p>

<p class=Code>while (OneWord &lt> "")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;? "Word " + WordCounter + " is " + OneWord + "&ltbr>"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Phrase = *word_remove(Phrase, 1, " ")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;NextPos = atc(" ", Phrase, 1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;OneWord = substr(Phrase, 1, NextPos-1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;WordCounter = WordCounter + 1</p>

<p class=Code>end while</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/__STAR__WORD_REMOVE Function.html" title="*WORD_REMOVE Function" class="wiki">*WORD_REMOVE(</a>) function removes the Nth word from a string, where you define the word delimiter (in this case a space character).</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/ATC Function.html" title="ATC Function" class="wiki">ATC(</a>) function returns the position of one string (in this case a space character) in another string.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <a href="../References/Functions/SUBSTR Function.html" title="SUBSTR Function" class="wiki">SUBSTR(</a>) returns a portion of a string, starting at position one and ending at position two.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using While With An Equality Test".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_WHILE_with_Equality_Test.gif" x-maintain-ratio=TRUE style="border: none; width: 367px; height: 288px; float: none; border-style: none; border-style: none;" width=367 height=288 border=0></p>

<p class=A5>About Methods</p>

<p>The following topic introduces a new type of function called a method. A method is a function that is available to operate on certain Xbasic elements called objects. A method is called by appending the method name to the object name. For example, if you have a table object, you can use the <a href="../References/Methods/TABLE.OPEN Method.html" title="TABLE.OPEN Method" class="wiki">TABLE.OPEN(</a>) method. If you have an array object (as in the next example), you can use the methods of the array, including <a href="../References/Methods/ARRAY.INITIALIZE Method.html" title="ARRAY.INITIALIZE Method" class="wiki">&amp;ltARRAY&gt;.INITIALIZE(</a>) and <a href="../References/Methods/ARRAY.DELETE Method.html" title="ARRAY.DELETE Method" class="wiki">&amp;ltARRAY&gt;.DELETE(</a>).&nbsp;as&nbsp;far&nbsp;as&nbsp;arguments and return values are concerned, methods work the same&nbsp;as&nbsp;functions.</p>

<p>You can read more about methods in <a href="../References/Objects/Objects, Properties, and Methods.html" title="Objects, Properties, and Methods" class="wiki">Objects, Properties, and Methods</a>.</p>

<p class=A5>Using a WHILE Loop with a Logical Variable</p>

<p>A WHILE loop runs until its test expression evaluates to FALSE (.F.). This means that instead of an expression you can also use a logical variable. The logical variable must initially be TRUE (.T.) or the while loop will not begin.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using WHILE with a Logical Variable&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cSearchWord&nbsp;as&nbsp;C</p>

<p class=Code>dim nListSize&nbsp;as&nbsp;N</p>

<p class=Code>dim lStillLooking&nbsp;as&nbsp;L = .T.</p>

<p class=Code>dim cList&nbsp;as&nbsp;C</p>

<p class=Code>cList = cstates()</p>

<p class=Code>nListSize = line_count(cList)</p>

<p class=Code>dim arr[nListSize]&nbsp;as&nbsp;C</p>

<p class=Code>arr.initialize(cList)</p>

<p class=Code>cSearchWord = "New York"</p>

<p class=Code>while (lStillLooking)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if arr[1] = cSearchWord then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? "Found " + cSearchWord</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lStillLooking = .F.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr.delete(1,1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end while</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>dim arr[nListSize]&nbsp;as&nbsp;C</span> occurs only <span class=Bolded>after</span> the size of the array has been determined by using <a href="../References/Functions/LINE_COUNT Function.html" title="LINE_COUNT Function" class="wiki">LINE_COUNT(</a>) to count the entries in the CSTATES()list.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>arr.initialize(cList)</span> statement uses the <a href="../References/Methods/ARRAY.INITIALIZE Method.html" title="ARRAY.INITIALIZE Method" class="wiki">&amp;ltARRAY&gt;.INITIALIZE(</a>) method, which populates an array with the contents of a CR-LF delimited string. The important constraint on the use of this function is that the array has to be dimensioned <span class=Bolded>before</span> you use the &ltARRAY>.INITIALIZE() method.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>arr.delete(1,1)</span> statement uses the <a href="../References/Methods/ARRAY.DELETE Method.html" title="ARRAY.DELETE Method" class="wiki">&amp;ltARRAY&gt;.DELETE(</a>) method, which conveniently closes up the array, so the second element becomes the first element.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using WHILE with a Logical Variable".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_WHILE_with_a_Logical_Variable.gif" x-maintain-ratio=TRUE style="border: none; width: 458px; height: 259px; float: none; border-style: none; border-style: none;" width=458 height=259 border=0></p>

<p class=A5>Using Nested FOR ... NEXT Loops</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using Nested FOR ... NEXT Loops&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim nBig&nbsp;as&nbsp;N</p>

<p class=Code>dim nSmall&nbsp;as&nbsp;N</p>

<p class=Code>for nBig = 1 to 128 step 16</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for nSmall = 1 to 16</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? chr( nSmall + (nBig -1) ) + " "</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next nSmall</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;? "&ltbr>"</p>

<p class=Code>next nBig</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol start=2> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>nBig</span> loop steps by 16, while the <span class=Code1>nSmall</span> loop steps by the default value of 1.</p>

</li> </ul> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using Nested FOR ... NEXT Loops".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_Nested_FOR_NEXT_Loops.gif" x-maintain-ratio=TRUE style="border: none; width: 464px; height: 321px; float: none; border-style: none; border-style: none;" width=464 height=321 border=0></p>

<p class=A5>Using Nested WHILE Loops</p>

<p>When you have nested WHILE loops you have reset the controlling expression for the inner loops to TRUE (.T.) on each pass. Note the <span class=Code1>lStillCounting = .T.</span> statement below.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lthtml></p>

<p class=Code>&lthead></p>

<p class=Code>&ltmeta name="generator" content="Alpha Five HTML Editor"></p>

<p class=Code>&lttitle>Using Nested WHILE Loops&lt/title></p>

<p class=Code>&lt/head></p>

<p class=Code>&ltbody></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim nACount&nbsp;as&nbsp;N = 0</p>

<p class=Code>dim nListSize&nbsp;as&nbsp;N</p>

<p class=Code>dim lStillLooking&nbsp;as&nbsp;L = .T.</p>

<p class=Code>dim lStillCounting&nbsp;as&nbsp;L</p>

<p class=Code>dim cList&nbsp;as&nbsp;C</p>

<p class=Code>dim cThisChar&nbsp;as&nbsp;C</p>

<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>

<p class=Code>cList = cstates()</p>

<p class=Code>nListSize = line_count(cList)</p>

<p class=Code>dim arr[nListSize]&nbsp;as&nbsp;C</p>

<p class=Code>arr.initialize(cList)</p>

<p class=Code>while (lStillLooking)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;nCounter = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lStillCounting = .T.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;while (lStillCounting)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cThisChar = lower( substr(arr[1], nCounter, 1) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nACount = nACount + occursi("a", cThisChar)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nCounter = nCounter + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if nCounter > len(arr[1]) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lStillCounting = .F.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end while</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;arr.delete(1,1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;arr.resize(arr.size()-1)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if arr.size(1) = 0 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lStillLooking = .F.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end while</p>

<p class=Code>? "A count is " + nACount</p>

<p class=Code>%></p>

<p class=Code>&lt/body></p>

<p class=Code>&lt/html></td></tr> </table><p>Note in this example.</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p>The <a href="../References/Functions/SUBSTR Function.html" title="SUBSTR Function" class="wiki">SUBSTR(</a>) extracts one character a time from the current array element. The <span class=Code1>nCounter</span> variable steps across the word(s) in this text. The <span class=Code1>nCounter > len(arr[1])</span> test makes sure that we set <span class=Code1>lStillCounting = .F.</span> and quit the inner WHILE loop when we reach the end of the text. </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p>The <a href="../References/Functions/LOWER Function.html" title="LOWER Function" class="wiki">LOWER(</a>) function makes sure that the output of the SUBSTR() function can be compared to lower case "a". </li> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>After we delete the first element and shift all the elements down with <span class=Code1>arr.delete(1,1)</span>, the <span class=Code1>arr.resize(arr.size()-1)</span> statement reduces the physical array in size. This allows us the <span class=Code1>arr.size(1) = 0</span> test to identify when to set <span class=Code1>lStillLooking = .F.</span> and exit from the outer WHILE loop.</p>

</li> </ul> </ul> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using Nested WHILE Loops".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_Nested_WHILE_Loops.gif" x-maintain-ratio=TRUE style="border: none; width: 474px; height: 241px; float: none; border-style: none; border-style: none;" width=474 height=241 border=0></p>

<p class=A5><How to use FOR EACH ... NEXT</p>

<p>The <a href="../References/Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> statement provides a simplified way of processing the elements of a list or array of unknown length. Compare the following example to the previous one.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Using FOR EACH ... NEXT&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim nACount&nbsp;as&nbsp;N = 0</p>

<p class=Code>dim nListSize&nbsp;as&nbsp;N</p>

<p class=Code>dim cList&nbsp;as&nbsp;C</p>

<p class=Code>dim cThisChar&nbsp;as&nbsp;C</p>

<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>

<p class=Code>cList = cstates()</p>

<p class=Code>nListSize = line_count(cList)</p>

<p class=Code>dim arr[nListSize]&nbsp;as&nbsp;C</p>

<p class=Code>arr.initialize(cList)</p>

<p class=Code>for each x in arr</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;nCounter = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;while ( nCounter &lt= len(x) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cThisChar = lower( substr(x, nCounter, 1) )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nACount = nACount + occursi("a", cThisChar)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nCounter = nCounter + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end while</p>

<p class=Code>next</p>

<p class=Code>? "A count is " + nACount</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>x</span> used in <span class=Code1>for each x in arr</span> is an arbitrary expression.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The x is used to reference the list element that is being processed.&nbsp;as&nbsp;a result, we used the expressions <span class=Code1>while ( nCounter &lt= len(x) )</span> and <span class=Code1>lower( substr(x, nCounter, 1) )</span>.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using FOR EACH NEXT".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_FOR_EACH_NEXT.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 464px; height: 283px; border-style: none; border-style: none;" width=464 height=283 border=0></p>

<p class=A5>How to use *FOR_EACH()</a></p>

<p><a href="../References/Functions/__STAR__FOR_EACH Function.html" title="*FOR_EACH Function" class="wiki">*FOR_EACH(</a>) is a useful function for quickly processing the entries in a CR-LF delimited list and returning a new CR-LF delimited list. Since HTML does not display CR-LF characters, the following script substitutes HTML <span class=HTML1>&ltBR></span> tags.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lthtml></p>

<p class=Code>&lthead></p>

<p class=Code>&ltmeta name="generator" content="Alpha Five HTML Editor"></p>

<p class=Code>&lttitle>Using *FOR_EACH()&lt/title></p>

<p class=Code>&lt/head></p>

<p class=Code>&ltbody></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cList&nbsp;as&nbsp;C</p>

<p class=Code>dim cNewList&nbsp;as&nbsp;C</p>

<p class=Code>cList = cstates()</p>

<p class=Code>cNewList = *for_each( x, upper(left(x,2) ) + "&ltBR>", clist)</p>

<p class=Code>? cNewList</p>

<p class=Code>%></p>

<p class=Code>&lt/body></p>

<p class=Code>&lt/html></td></tr> </table><p>Note in this example.</p>

<ol style="list-style: disc;" type=disc> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>x</span> used in the <span class=Code1>*for_each()</span> function is an arbitrary expression.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>The x is used to reference the list element that is being processed.&nbsp;as&nbsp;a result, we used the expression <span class=Code1>upper( left(x,2) )</span> to extract and capitalize the first two characters of each US state and Canadian province name.</p>

</li> </ul> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> to save your page&nbsp;as&nbsp;"Using FOR EACH NEXT".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Run_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to run the page in Live Preview. The results should look like this: </p>

</li> </ol><p class=Pix><img src="images/WPT_Using_FOR_EACH().gif" x-maintain-ratio=TRUE style="border: none; width: 252px; height: 461px; float: none; border-style: none; border-style: none;" width=252 height=461 border=0></p>

<p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Running+a+Statement+Multiple+Times+with+a+Loop">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/Design/View/A5W/","status":"pending","tags":"web, review","notes":"page contains fair amount of info","keywords":"server,guide,a5w"} --->
</body></html>