	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Radio Button Table Lookup </p>



<p>The <span class=Screen>Radio Button</span> tab of the <span class=Screen>Table 
 Lookups</span> form contains two radio buttons. There are no field rules 
 or choices defined in object properties. The implementation is based on 
 Xbasic code&nbsp;as&nbsp;follows.</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="1" colspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Item</td>
<td rowspan="1" colspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Tabbed2 <span class=Code1>OnTabChange</span></td>
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event refreshes the list of Vendors when the user 
 arrives at the Event Driven tab. The code retrieves a list of Vendors, 
 counts the number of records, and limits the list to a maximum of 7 items 
 (because of the size of the area allocated to radio buttons).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Table_Lookups&nbsp; <span class=Code1>OnFetch</span></td>
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event refreshes the list of Products when the user 
 reads a new record. The script calls a function named <span class=Code1>Refresh_Products()</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Vendor <span class=Code1>OnChange</span></td>
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event refreshes the list of Products when the user 
 selects a different vendor. The script calls a function named <span class=Code1>Refresh_Products()</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>Refresh_Products()</span></td>
<td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This function receives pointers to the Vendor and Product 
 radio button objects. It uses this information to retrieve the appropriate 
 list of <span class=Code1>Product_Name</span> fields. It limits the list 
 to a maximum of 7 items.</td></tr>
</table>

<p class=Pix></p>



<p class=Pix><img src="images/event_driven_option_button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 456px;
							height: 280px;
							float: none;
							border-style: none;
							border-style: none;"
					width=456
					height=280
					border=0></p>



<p class=A5>Tabbed2 OnTabChange Event</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim cFieldList&nbsp;as&nbsp;C</p>


<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>


<p class=Code>dim nRecordCount&nbsp;as&nbsp;N</p>


<p class=Code>dim cWord&nbsp;as&nbsp;C</p>


<p class=Code>' Get the CR-LF delimited list</p>


<p class=Code>cFieldList = table.external_record_content_get("Vendor", 
 \</p>


<p class=Code>"Vendor_Name + '|' + Vendor_No", "Vendor_Name", 
 "")</p>


<p class=Code>' Parameter 1: "Vendor": From the Vendor table</p>


<p class=Code>' Parameter 2: "Vendor_Name + '|' + Vendor_No": 
 Two fields</p>


<p class=Code>' separated by a pipe character</p>


<p class=Code>' Parameter 3: "Vendor_Name": sorted on the Vendor_Name</p>


<p class=Code>' field</p>


<p class=Code>' Parameter 4: "": no filter required</p>


<p class=Code>' Get the number of records returned</p>


<p class=Code>nRecordCount = w_count(cFieldList, crlf())</p>


<p class=Code>' Limit the number of records to 7 because of the limited 
 amount of space on the form</p>


<p class=Code>nRecordCount = min(7, nRecordCount)</p>


<p class=Code>' Exit if no records</p>


<p class=Code>if (nRecordCount = 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>' redimension the vendor lookup list to nRecordCount items</p>


<p class=Code>vendor.choice.list.redim(nRecordCount)</p>


<p class=Code>' for each of the records</p>


<p class=Code>for nCounter = 1 to nRecordCount</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' retrieve a line of data delimited 
 by a CR-LF</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cWord = word(cFieldList, nCounter, 
 crlf())</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' retrieve the value that we save, 
 which is the second word on the line</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;vendor.choice.list<a class="wiki"  href="nCounter" rel="">nCounter</a>.value 
 = word(cWord, 2, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' retrieve the text that we display&nbsp;as&nbsp;the 
 radio button label</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;vendor.choice.list<a class="wiki"  href="nCounter" rel="">nCounter</a>.text 
 = word(cWord, 1, "|")</p>


<p class=Code>next nCounter</td></tr>
</table>

<p class=A5>Vendor OnChange Event</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim vendor_ptr&nbsp;as&nbsp;P</p>


<p class=Code>dim product_ptr&nbsp;as&nbsp;P</p>


<p class=Code>dim nRecordCount&nbsp;as&nbsp;N</p>


<p class=Code>' create pointers to the two radio buttons</p>


<p class=Code>vendor_ptr = Vendor.this</p>


<p class=Code>product_ptr = Product.this</p>


<p class=Code>' call the function that refreshes the product radio button</p>


<p class=Code>nRecordCount = refresh_products(vendor_ptr, product_ptr)</td></tr>
</table>

<p class=A5>Table Lookups OnFetch Event</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim vendor_ptr&nbsp;as&nbsp;P</p>


<p class=Code>dim product_ptr&nbsp;as&nbsp;P</p>


<p class=Code>dim nRecordCount&nbsp;as&nbsp;N</p>


<p class=Code>' create pointers to the two radio buttons</p>


<p class=Code>vendor_ptr = Vendor.this</p>


<p class=Code>product_ptr = Product.this</p>


<p class=Code>' call the function that refreshes the product radio button</p>


<p class=Code>nRecordCount = refresh_products(vendor_ptr, product_ptr)</td></tr>
</table>

<p class=A5>Refresh_Products() function</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' The function receives pointers to Vendor and Product</p>


<p class=Code>FUNCTION Refresh_Products&nbsp;as&nbsp;C (Vendor&nbsp;as&nbsp;P, 
 Product&nbsp;as&nbsp;P)</p>


<p class=Code>dim cFieldList&nbsp;as&nbsp;C</p>


<p class=Code>dim nCounter&nbsp;as&nbsp;N</p>


<p class=Code>dim nRecordCount&nbsp;as&nbsp;N</p>


<p class=Code>dim cWord&nbsp;as&nbsp;C</p>


<p class=Code>dim cVendor&nbsp;as&nbsp;C</p>


<p class=Code>' Get the current value of the vendor radio button</p>


<p class=Code>cVendor = Vendor.value</p>


<p class=Code>' Get the CR-LF delimited list</p>


<p class=Code>cFieldList = table.external_record_content_get("Product",\</p>


<p class=Code>"Product_Name + '|' + Product_No","Product_Name",\</p>


<p class=Code>"Product_Vendor_No = " + quote(cVendor))</p>


<p class=Code>' Parameter 1: "Product": From the Product table</p>


<p class=Code>' Parameter 2: "Product_Name + '|' + Product_No": 
 Two</p>


<p class=Code>' fields separated by a pipe character</p>


<p class=Code>' Parameter 3: "Product_Name": sorted on the Product_Name</p>


<p class=Code>' field</p>


<p class=Code>' Parameter 4: "Product_Vendor_No = " + quote(cVendor):</p>


<p class=Code>' vendor must match</p>


<p class=Code>' Get the number of records returned</p>


<p class=Code>nRecordCount = w_count(cFieldList,crlf())</p>


<p class=Code>' Exit if there are no records</p>


<p class=Code>if (nRecordCount = 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>' Limit the number of records to 7 because of the limited 
 amount of space on the form</p>


<p class=Code>nRecordCount = min(7, nRecordCount)</p>


<p class=Code>' redimension the vendor lookup list to nRecordCount items</p>


<p class=Code>Product.choice.list.redim(nRecordCount)</p>


<p class=Code>' for each of the records</p>


<p class=Code>for nCounter = 1 to nRecordCount</p>


<p class=Code>' retrieve a line of data delimited by a CR-LF</p>


<p class=Code>cWord = word(cFieldList, nCounter, crlf())</p>


<p class=Code>' retrieve the value that we save, which is the</p>


<p class=Code>' second word on the line</p>


<p class=Code>Product.choice.list<a class="wiki"  href="nCounter" rel="">nCounter</a>.value = word(cWord, 2, "|")</p>


<p class=Code>' retrieve the text that we display&nbsp;as&nbsp;the radio</p>


<p class=Code>' button label</p>


<p class=Code>Product.choice.list<a class="wiki"  href="nCounter" rel="">nCounter</a>.text = word(cWord, 1, "|")</p>


<p class=Code>next nCounter</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../References/Objects/Objects That Do Table Lookups.html" title="Objects That Do Table Lookups" class="wiki">Overview of Development   Approaches</a>, <a href="Using Field Rules for Table Lookups.html" title="Using Field Rules for Table Lookups" class="wiki">Using   Field Rules for Table Lookups</a>, <a href="Using Object Properties for Table Lookups.html" title="Using Object Properties for Table Lookups" class="wiki">Using   Object Properties for Table Lookups</a>, <a href="../References/Desktop/List Box Table Lookup.html" title="List Box Table Lookup" class="wiki">List   Box Table Lookup</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Radio+Button+Table+Lookup">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>