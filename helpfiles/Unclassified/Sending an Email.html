	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Sending an Email</p>

<p class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0> <span class=Note>Note</span> : The <span class=Bolded>Sending an Email</span> topic describes a technique available to <span class=Screen>Alpha Five</span> database users.</p>

<p>This tutorial shows how to build an email client into your application. There are two pages. The first allows you to compose and send an email. The second page confirms a successfully sent message and allows you to return to the previous page to send another message.</p>

<p class=Note><span class=Note><img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0>Note</span> : This example presumes that you have configured the internal <a href="../References/Email/Email Profiles.html" title="Email Profiles" class="wiki">Alpha Five Email Client</a>.</p>

<p class=A5>Creating the Email Send Page</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new dialog component.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Controls</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Place two Textbox controls on the dialog. Name them "to" and "subject".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Selected Controls</span> list choose "To".</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Control Settings > Validation rules</span> field to display the <span class=Screen>Field Validation</span> dialog box.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Check the following fields:</p>

</li> <ul style="list-style: disc;" type=disc> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p><span class=Button>General > Require value</span> </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p><span class=Button>Text Format > Allow letters</span> </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p><span class=Button>Text Format > Allow white space</span> </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p><span class=Button>Text Format > Allow digits</span> </li> <li class=kadov-p style="list-style: disc;" type=disc class=kadov-p><span class=Button>Text Format > Allow special characters</span> </li> </ul> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <span class=Button>OK</span> to return to the <span class=Screen>Dialog Builder</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Check <span class=Button>Control Settings > Client side validation</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change <span class=Button>TextBox Properties > Size</span> to 80.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change <span class=Button>TextBox Properties > MaxLength</span> to 200.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Make comparable changes for the <span class=Code1>Subject</span> field.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Place a TextArea control on the dialog and name it "message".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Selected Controls</span> list choose "message".</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Control Settings > Validation rules</span> field to display the <span class=Screen>Field Validation</span> dialog box.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Check the following fields:</p>

</li> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1><span class=Button>General > Require value</span></p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1><span class=Button>Text Format > Allow letters</span></p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1><span class=Button>Text Format > Allow white space</span></p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1><span class=Button>Text Format > Allow digits</span></p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1><span class=Button>Text Format > Allow special characters</span></p>

</li> </ul> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <span class=Button>OK</span> to return to the <span class=Screen>Dialog Builder</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Check <span class=Button>Control Settings > Client side validation</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change <span class=Button>TextArea Properties > Rows</span> to 12.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change <span class=Button>TextArea Properties > Columns</span> to 79.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Properties</span> page.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change the <span class=Button>Submit/Reset Buttons > Submit button label</span> to "Send Email".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Freeform Edit Regions > Above Dialog</span> field to display the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Enter "Send an Email Message". Set the style to "Heading 3", the font to "Comic Sans MS", and the size to "4 (14pt)".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Check <span class=Button>Client Events > Validate before submit</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Server Events > Validate</span> field to display the <span class=Screen>Form Events</span> dialog. Add the following code.</p>

</li> </ol> </ol><p>This script uses the <a href="../References/Functions/EMAIL_SEND Function.html" title="EMAIL_SEND Function" class="wiki">EMAIL_SEND(</a>) function to send the message.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim result&nbsp;as&nbsp;N</p>

<p class=Code>result = email_send(to,subject,message)</p>

<p class=Code>if (result &lt> 1) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Has_Error = .T.</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Error_Message = "Email was not sent."</p>

<p class=Code>end if</td></tr> </table> <ol> <ol start=7> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Server Events > AfterValidate</span> field to display the <span class=Screen>Form Events</span> dialog. Add the following code.</p>

</li> </ol> </ol><p>The <span class=Code1>AfterValidate</span> event only fires if there is no error in the <span class=Code1>Validate</span> event.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>Currentform.RedirectTarget = "email_confirmation.a5w"</td></tr> </table> <ol start=9> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Save</span>, enter "Send_Email" into the <span class=Control>File name</span> field, and <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Close</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>New > Alpha Five Web Page > OK</span> to display the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, name the page "Send_Email" and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Insert Component > Select</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Pick the "Send_Email" component and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Save</span> and <span class=Button>Close</span>.</p>

</li> </ol><p class=A5>Creating the Email Confirmation Page</p>

<ol start=16> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Web Projects Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>New > Alpha Five Web Page > OK</span> to display the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Source</span> tab. Enter the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code><span class=HTML1>&ltp>&ltfont face=Tahoma>Your email message has been sent.&lt/p></span></p>

<p class=Code><span class=HTML1>&ltp>&lta href="Send_Email.a5w">Send another email message&lt/a>&lt/font></span></p>

<p class=Code><span class=HTML1>&lt/p></span></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table> <ol start=19> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span> and name the page "Email_Confirmation".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>HTML Editor</span>.</p>

</li> </ol><p class=A5>Testing the Pages</p>

<ol start=21> <li class=kadov-p-CListNumber><p class=ListNumber>Right click the "Email_Confirmation" component and select <span class=Button>Publish (Local Webroot)</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right click the "Send_Email.a5w" page and select <span class=Button>Publish (Local Webroot) and open</span>. The results should look like this. </p>

</li> </ol><p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Sending+an+Email">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/Email","status":"pending","tags":"desktop,review","notes":"Alpha Five, more like a guide even though it says tut in text","keywords":"desktop,guide,form"} --->
</body></html>