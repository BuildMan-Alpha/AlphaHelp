	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using HTML in an Xdialog</p>



<p>Xdialog is a very good way to display data to a user, and to collect 
 data from a user. Xdialog's display options, however, do not give you 
 the full richness of HTML. This topic shows you how you can combine the 
 best of Xdialog and HTML to create beautiful, dynamic dialog boxes.</p>



<p class=A5>A Little Background</p>



<p>When a browser displays HTML, the HTML is actually parsed by the browser 
 into a collection of objects called the Document Object Model, or DOM. 
 It is possible to interact with the DOM programmatically, and dynamically 
 change what's displayed in the browser. Most commonly, JavaScript is used 
 to program against the DOM. However, Xbasic can also be used to program 
 against the DOM, and this topic describes the process.</p>



<p class=A5>Getting Started - Putting the DHTMLEDIT ActiveX Control on 
 an Xdialog</p>



<p>To display HTML content in an Xdialog, you can use a <span class=Screen>Microsoft 
 ActiveX</span> control that is available on your computers. This control 
 is called the <span class=Screen>DHTMLEdit</span> control.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a new Action 
 Script.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Add 
 New Action > Xdialog Windows > Display an XDialog Box</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter <span class=Code1>xx</span> 
 into the Variable Name field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>and set the variable 
 style to "HTML Text". </p>

</li>
</ol>

<p class=Pix><img src="images/XD_HTML_in_Xdialog_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 491px;
							height: 468px;
							float: none;
							border-style: none;
							border-style: none;"
					width=491
					height=468
					border=0></p>



<ol start=5
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;> 
 Next&nbsp;> Next&nbsp;> Finish</span> until the <span class=Screen>Script 
 Genie</span> closes.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Code 
 Editor</span> right select the new action script and click <span class=Button>Convert 
 to Inline Xbasic > OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right select the 
 new action script and click <span class=Button>View Xbasic</span>. You 
 will see the following code.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>'Create an XDialog dialog box to prompt for parameters.</p>


<p class=Code>DIM xx&nbsp;as&nbsp;P</p>


<p class=Code>dim xx.object&nbsp;as&nbsp;p</p>


<p class=Code>dim xx.class&nbsp;as&nbsp;c</p>


<p class=Code>xx.class = "dhtmledit.dhtmledit"</p>


<p class=Code>DIM SHARED varC_result&nbsp;as&nbsp;C</p>


<p class=Code>DIM xx_html&nbsp;as&nbsp;c</p>


<p class=Code>xx_html = <<%html%</p>


<p class=Code>%html%</p>


<p class=Code>'Force the background color of the html text to be Win3D 
 so that it blends in with the Xdialog box.</p>


<p class=Code>dim win3dcolor&nbsp;as&nbsp;c</p>


<p class=Code>win3dcolor = ui_color_format("win3d","#rhghbh")</p>


<p class=Code>xx_html = a5_html_background(xx_html,win3dcolor)</p>


<p class=Code>ok_button_label = "&OK"</p>


<p class=Code>cancel_button_label = "&Cancel"</p>


<p class=Code>varC_result = ui_dlg_box("Alpha Five",<<%dlg%</p>


<p class=Code>{startup=init}</p>


<p class=Code>{region}</p>


<p class=Code>| {activex=40,5xx?.f.};</p>


<p class=Code>{endregion};</p>


<p class=Code>{line=1,0};</p>


<p class=Code>{region}</p>


<p class=Code><*15=ok_button_label!OK> <15=cancel_button_label!CANCEL></p>


<p class=Code>{endregion};</p>


<p class=Code>%dlg%,<<%code%</p>


<p class=Code>if a_dlg_button = "init" then</p>


<p class=Code>xx.object.browsemode = .t.</p>


<p class=Code>xx.object.appearance = 0</p>


<p class=Code>xx.object.ScrollBars = .f.</p>


<p class=Code>on error goto xx_error</p>


<p class=Code>xx.object.documenthtml = xx_html</p>


<p class=Code>on error goto 0</p>


<p class=Code>xx.object.Refresh()</p>


<p class=Code>a_dlg_button = ""</p>


<p class=Code>end if</p>


<p class=Code>end</p>


<p class=Code>xx_error:</p>


<p class=Code>ui_msg_box("Error","Invalid URL or HTML content.",UI_STOP_SYMBOL)</p>


<p class=Code>end</p>


<p class=Code>%code%)</td></tr>
</table>

<p>The next steps are to make the following changes:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Change the Xdialog 
 from a modal to a modeless Xdialog.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Change the variable 
 that references the ActiveX control into a global variable. We do this 
 so that we can experiment with the DOM properties from the <span class=Screen>Interactive</span> 
 window. Experimenting with the DOM properties from the Interactive window 
 is a great way to learn about programming the DOM.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Define some HTML 
 to display.</p>

</li>
</ol>

<p>Edit the Xbasic code so that it looks like this. The changes are shown 
 in blue. Quite a few lines of the generated Xbasic have been deleted.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>DIM</span> global <span class=HTML1>xx&nbsp;as&nbsp;P</span></p>


<p class=Code><span class=HTML1>dim</span> global <span class=HTML1>xx.object&nbsp;as&nbsp;p</span></p>


<p class=Code><span class=HTML1>dim</span> global <span class=HTML1>xx.class&nbsp;as&nbsp;c</span></p>


<p class=Code><span class=HTML1>xx.class = "dhtmledit.dhtmledit"</span></p>


<p class=Code><span class=HTML1>DIM html_html&nbsp;as&nbsp;C</span></p>


<p class=Code><span class=HTML1>html_html = <<%html%</span></p>


<p class=Code><html></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<head></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;</head></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;<body></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<table></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 id="firstnameLbl">Firstname</td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 id="firstnameData"></td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 id="lastnameLbl">Lastname</td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<td 
 id="lastnameData"></td></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tr></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</table></p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>