	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Printing a Dialog&nbsp;as&nbsp;PDF</p>

<p class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0> <span class=Note>Note</span> : The <span class=Bolded>Printing a Dialog&nbsp;as&nbsp;PDF</span> topic describes a technique available to <span class=Screen>Alpha Five</span> database users.</p>

<p>This example shows how to accept user input into a dialog component and then print a PDF version of the resulting document.</p>

<p class=A5>Creating the Dialog</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new dialog web component based on the AlphaSports database.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Controls</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Add the "Firstname", "Lastname", "Company", and "Bill_City" fields to the dialog&nbsp;as&nbsp;textboxes.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Add the "Bill_State_Region" field to the dialog&nbsp;as&nbsp;a drop down listbox.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Bill_State_Region" control and click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; width: 17px; height: 18px; float: none; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>DropDownBox Properties > Choices</span> field to display the <span class=Screen>Define Choices</span> dialog.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "Dynamic" in the <span class=Button>Define Choices > List Type</span> list.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "Variable" in the <span class=Button>Data Source > Data source type</span> list.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Enter "session.states" in the <span class=Button>Data Source > Variable name</span> field.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <span class=Button>OK</span>.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>Row Properties > Hide row</span> selection to "True" for the "Firstname", "Lastname", "Bill_City", and "Bill_State_Region" controls.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>Textbox Properties > Size</span> selection to 10 for the "Firstname" control, 10 for the "Lastname" control, and 15 for the "Bill_City" control.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Company" control.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Set the <span class=Button>Row Properties > Freeform layout</span> selection to "True" for the "Company".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; width: 17px; height: 18px; float: none; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Row Properties > Freeform template</span> field to display the <span class=Screen>Freeform Column Layout</span> dialog.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Enter the following HTML code and click <span class=Button>OK</span>.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>This is to certify that {Firstname} {Lastname} (First Name, Last Name) of {Company} (Company) located in {City} (City), {State} (State) is a customer in good standing with AlphaSports on {Today}.</td></tr> </table> <ol style="list-style: decimal;" type=1> <ol start=4> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change the <span class=Button>Row Properties > Row label</span> field to <span class=HTML1>AlphaSports<br>Customer<br>Certificate</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change the <span class=Button>Row Properties > Cell in line style</span> field to <span class=HTML1>vertical-align: top;</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change the <span class=Button>Row Properties > Row label in line style</span> field to <span class=HTML1>font-family: Verdana; font-size: 12pt;</span>.</p>

</li> </ol> </ol> <ol start=9 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Properties</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; width: 17px; height: 18px; float: none; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Server Events > Declarations</span> field to display the <span class=Screen>Form Events</span> dialog.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following Xbasic code to create the <span class=Code1>session.states</span> variable that populates the "bill_state_region" drop down list:</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=Code1>dim session.states&nbsp;as&nbsp;C</span></td> </tr> </table> <ol start=12 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Initialize" event from the <span class=Control>Event</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following Xbasic code to assign data to the <span class=Code1>session.states</span> variable and set a default value for the "Today" control.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>session.states = crlf()+ cstates("a" + crlf())</p>

<p class=Code>CurrentForm.Controls.Today = date()</td></tr> </table> <ol start=14 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "AfterValidate" event from the <span class=Control>Event</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following Xbasic script. This script saves the values in the dialog controls to the <span class=Code1>customer</span> table. It then reads the <span class=Code1>customer_id</span> value of this new record and uses that value to filter the <a href="../References/Methods/OBJECT.SAVEAS Method.html" title="OBJECT.SAVEAS Method" class="wiki">LAYOUT.SAVEAS(</a>) function. This function uses the <span class=Code1>Certificate</span> report of the <span class=Code1>customer</span> table to create a PDF version of the dialog. This script runs when you click the <span class=Button>Submit</span> button.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim tbl&nbsp;as&nbsp;P</p>

<p class=Code>dim id&nbsp;as&nbsp;C</p>

<p class=Code>tbl = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer")</p>

<p class=Code>tbl.enter_begin(.t.)</p>

<p class=Code>tbl.company = company</p>

<p class=Code>tbl.firstname = firstname</p>

<p class=Code>tbl.lastname = lastname</p>

<p class=Code>tbl.bill_city = city</p>

<p class=Code>tbl.bill_state_region = state</p>

<p class=Code>tbl.enter_end(.t.)</p>

<p class=Code>tbl.fetch_last()</p>

<p class=Code>id = tbl.customer_id</p>

<p class=Code>tbl.close()</p>

<p class=Code>Report.saveas("certificate@<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.ddd", "pdf", "Customer_ID = " + s_quote(id), "", session.session_folder + "\certificate.pdf", .f.)</p>

<p class=Code>response.redirect(session.session_url + "certificate.pdf?" + time("hms03"))</td></tr> </table> <ol start=16 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Save the dialog&nbsp;as&nbsp; "AlphaSports_Customer". The dialog component should look something like the following. </p>

</li> </ol><p class=Pix><img src="images/WPT_Dialog_to_PDF.gif" x-maintain-ratio=TRUE style="border: none; width: 621px; height: 98px; float: none; border-style: none; border-style: none;" width=621 height=98 border=0></p>

<ol start=17 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Dialog Builder</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Place the dialog component on a A5W page named "AlphaSports_Customer".</p>

</li> </ol><p class=A5>Creating the Certificate Report</p>

<ol start=1> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Reports</span> tab of the <span class=Screen>Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New</span>, select "customer" in the <span class=Control>Data Source</span> list, select <span class=Button>Start from a blank report</span>, and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Draw a RTF object on the Detail section of the new report. Create content that looks like the following. For more information about working with RTF objects on reports, see <a href="Working with Rich Text Fields.html" title="Working with Rich Text Fields" class="wiki">Working with Rich Text Fields</a> and <a href="../Tutorials/AlphaSports Explained (Desktop)/The Invoice Form/Working with Conditional Rich Text Fields.html" title="Working with Conditional Rich Text Fields" class="wiki">Working with Conditional Rich Text Fields</a>. </p>

</li> </ol><p class=Pix><img src="images/WPT_Dialog_to_PDF_3.gif" x-maintain-ratio=TRUE style="border: none; width: 757px; height: 340px; float: none; border-style: none; border-style: none;" width=757 height=340 border=0></p>

<ol start=4 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Save the new report&nbsp;as&nbsp;"Certificate".</p>

</li> </ol><p>After publishing the page, entering data, and clicking submit. You should see something like the following in Adobe Acrobat. </p>

<p class=Pix><img src="images/WPT_Dialog_to_PDF_2.gif" x-maintain-ratio=TRUE style="border: none; width: 818px; height: 364px; float: none; border-style: none; border-style: none;" width=818 height=364 border=0></p>

<p class=Note><span class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>Note</span> : If you have a problem viewing the PDF file, make sure that you have installed <span class=Screen>Adobe Acrobat</span> and have associated it with the PDF file type.</p>

<p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Printing+a+DialogasPDF">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Print","status":"pending","keywords":"desktop,guide,xbasic,form,component,rtf","tags":"desktop,review","notes":"A5"} --->
</body></html>