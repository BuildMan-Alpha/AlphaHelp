	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Placing SimpleCharts on a Web Page</p>

<p class=Note><span class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>Note</span> : The <span class=Bolded>Placing SimpleCharts on a Web Page</span> topic describes techniques appropriate for <span class=Screen>Alpha Five</span> database users.</p>

<p class=A5>Bar Chart Example</p>

<p>The following example is based on the <span class=Code1>invoice_items</span> table of the AlphaSports database. To create a bar chart:</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page in the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span class=Screen>Source</span> tab.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following code and save the page&nbsp;as&nbsp;"invoice_items.a5w".</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lthtml></p>

<p class=Code>&lthead></p>

<p class=Code>&ltmeta name="generator" content="Alpha Five HTML Editor"></p>

<p class=Code>&lttitle>&lt/title></p>

<p class=Code>&lt/head></p>

<p class=Code>&ltbody></p>

<p class=Code>&ltp>Test Page&lt/p></p>

<p class=Code>&ltp>&ltimg src="chartgen.a5w">&nbsp;&lt/p></p>

<p class=Code>&lt/body></p>

<p class=Code>&lt/html></td></tr> </table><p>The invoice_items.a5w page displays the text "Test Page" and the chart image created by the chartgen.a5w page.</p>

<ol start=4> <li class=kadov-p-CListNumber><p class=ListNumber>Use <span class=Screen>Notepad</span>, <span class=Screen>Textpad</span>, or another text editor to create a new page named "chartgen.a5w". You must <span class=Bolded>not</span> use the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following script into the page save it.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>Dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.AxisChartGenerator")</p>

<p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</p>

<p class=Code>chartX.DataSeries.AddBarSeries("Items", scFillModeAutoSolid)</p>

<p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.DataSeries(1).SeriesData.Add(desc, num)</p>

<p class=Code>next</p>

<p class=Code>chartX.height = 400</p>

<p class=Code>chartX.width = 300</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(2)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p class=A5>Understanding the Script</p>

<p>First, the script creates the chartX object that will refer to the chart.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>Dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.AxisChartGenerator")</td></tr> </table><p>Next, the script retrieves the data that the chart will display from the <span class=Code1>items-product</span> set using the <a href="../References/Methods/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL_RECORD_CONTENT_GET(</a>) method. The filter is fixed to retrieve records where <span class=Code1>invoice_number</span> is equal to "000001".</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</td></tr> </table><p>The following command adds a data series to the chart. The legend for the data series is "Items".</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>chartX.DataSeries.AddBarSeries("Items", scFillModeAutoSolid)</td></tr> </table><p class=Note><img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0> <span class=Note>Note</span> : The first argument of the <span class=Code1>.DataSeries.AddBarSeries()</span> method cannot be NULL.</p>

<p>Each data point in a chart is a pair of values: a character description and a numeric value. The <a href="../References/Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> loop retrieves and parses each line in the list and adds data points to the data series.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.DataSeries(1).SeriesData.Add(desc, num)</p>

<p class=Code>next</td></tr> </table><p class=Note><img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0> <span class=Note>Note</span> : The subscript ("N") of the . <span class=Code1>DataSeries(N).SeriesData.Add()</span> method must be greater than zero.</p>

<p>Finally, the script sets the size of the chart, publishes it&nbsp;as&nbsp;an image, and deletes the chart object.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>chartX.height = 400</p>

<p class=Code>chartX.width = 300</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(2)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p>The result should look something like this. </p>

<p class=Pix><img src="images/XB_SimpleChart_Web_Bar.gif" x-maintain-ratio=TRUE style="border: none; width: 312px; height: 445px; float: none; border-style: none; border-style: none;" width=312 height=445 border=0></p>

<p>The following script enhances the chart by:</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>Placing the data points into different data series.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>Setting the caption to "Items in Order".</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>Setting the unit axis label to "Dollars".</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>Placing the legend at the bottom of the chart.</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>Hiding the data labels.</p>

</li> </ul> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The next step is to change the way the data is added to the chart a new data series (or "row") for each product. The script does this by modifying and moving the <span class=Code1>chart.DataSeries.AddBarSeries("Items", 0)</span> statement inside the loop. It changes the <span class=Code1>desc</span> argument in the <span class=Code1>chart.DataSeries(k).SeriesData.Add(" ", num)</span> statement to " " and the <span class=Code1>1</span> to the counter <span class=Code1>k</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Finally, a series of statements set the caption, the legend position, the unit label, and change the size of the chart.</p>

</li> </ol><p class=Note><img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0> <span class=Note>Note</span> : If the chart dimensions are too small, you will get distorted or partial data.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>Dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>dim k&nbsp;as&nbsp;N = 1</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.AxisChartGenerator")</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.DataSeries.AddBarSeries(desc, scFillModeAutoSolid)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.DataSeries(k).SeriesData.Add(" ", num)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;k = k + 1</p>

<p class=Code>next</p>

<p class=Code>chartX.caption = "Items in Order"</p>

<p class=Code>chartX.LegendPos = 3 ' bottom</p>

<p class=Code>chartX.UnitAxisLabel = "Dollars"</p>

<p class=Code>chartX.width=400</p>

<p class=Code>chartX.height=500</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(scImageFormatJpeg)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p>The result should look something like this. </p>

<p class=Pix><img src="images/XB_SimpleChart_Web_Bar_2.gif" x-maintain-ratio=TRUE style="border: none; width: 411px; height: 515px; float: none; border-style: none; border-style: none;" width=411 height=515 border=0></p>

<p class=A5>Pie Chart Example</p>

<p>The following example is based on the <span class=Code1>invoice_items</span> table of the AlphaSports database. To create a bar chart:</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page in the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Switch to the <span class=Screen>Source</span> tab.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following code and save the page&nbsp;as&nbsp;"invoice_items2.a5w".</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lthtml></p>

<p class=Code>&lthead></p>

<p class=Code>&ltmeta name="generator" content="Alpha Five HTML Editor"></p>

<p class=Code>&lttitle>&lt/title></p>

<p class=Code>&lt/head></p>

<p class=Code>&ltbody></p>

<p class=Code>&ltp>Test Page&lt/p></p>

<p class=Code>&ltp>&ltimg src="chartgen2.a5w">&nbsp;&lt/p></p>

<p class=Code>&lt/body></p>

<p class=Code>&lt/html></td></tr> </table><p>The invoice_items.a5w page displays the text "Test Page" and the chart image created by the chartgen.a5w page.</p>

<ol start=4> <li class=kadov-p-CListNumber><p class=ListNumber>Use <span class=Screen>Notepad</span>, <span class=Screen>Textpad</span>, or another text editor to create a new page named "chartgen.a5w". You must <span class=Bolded>not</span> use the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following script into the page save it.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.PieChartGenerator")</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.ChartData.Add( desc, num, scFillModeAutoSolid)</p>

<p class=Code>next</p>

<p class=Code>chartX.width=300</p>

<p class=Code>chartX.height=400</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(scImageFormatJpeg)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p class=A5>Understanding the Script</p>

<p>First, the script creates the chartX object that will refer to the chart.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>Dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.PieChartGenerator")</td></tr> </table><p>Next, the script retrieves the data that the chart will display from the <span class=Code1>items-product</span> set using the <a href="../References/Methods/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL_RECORD_CONTENT_GET(</a>) method. The filter is fixed to retrieve records where <span class=Code1>invoice_number</span> is equal to "000001".</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</td></tr> </table><p>Each data point in a chart is a pair of values: a character description and a numeric value. The <a href="../References/Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> loop retrieves and parses each line in the list and adds data points to the data series.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.ChartData.Add(desc, num, scFillModeAutoSolid)</p>

<p class=Code>next</td></tr> </table><p>Finally, the script sets the size of the chart, publishes it&nbsp;as&nbsp;an image, and deletes the chart object.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>chartX.height = 400</p>

<p class=Code>chartX.width = 300</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(2)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p>The result should look something like this. </p>

<p class=Pix><img src="images/XB_SimpleChart_Web_Pie.gif" x-maintain-ratio=TRUE style="border: none; width: 314px; height: 413px; float: none; border-style: none; border-style: none;" width=314 height=413 border=0></p>

<p>The following script enhances the chart by:</p>

<ul start=11 style="list-style: decimal;" type=1> <li class=kadov-p-CBullet1><p class=Bullet1>Setting the caption to "Items in Order".</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>Placing the legend at the bottom of the chart.</p>

</li> </ul><p class=Note><img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0> <span class=Note>Note</span> : If the chart dimensions are too small, you will get distorted or partial data.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>dim chartX&nbsp;as&nbsp;P</p>

<p class=Code>dim list&nbsp;as&nbsp;C</p>

<p class=Code>dim inv&nbsp;as&nbsp;C</p>

<p class=Code>dim desc&nbsp;as&nbsp;C</p>

<p class=Code>dim num&nbsp;as&nbsp;N</p>

<p class=Code>chartX = ole.Create("SimpleChartLite.PieChartGenerator")</p>

<p class=Code>inv = "000001"</p>

<p class=Code>list = set.external_record_content_get("items-product", "product->description + '|' + invoice_items->extension", "invoice_items->extension", "invoice_items->invoice_number = " + quote(inv) )</p>

<p class=Code>for each x in list</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = alltrim( word(x, 1, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chartX.ChartData.Add( desc, num, scFillModeAutoSolid)</p>

<p class=Code>next</p>

<p class=Code>chartX.caption = "Items in Order"</p>

<p class=Code>chartX.LegendPos = 3</p>

<p class=Code>chartX.width=300</p>

<p class=Code>chartX.height=400</p>

<p class=Code>Response.mime_type = "image/jpeg"</p>

<p class=Code>? chartX.SaveToStream(scImageFormatJpeg)</p>

<p class=Code>delete chartX</p>

<p class=Code>%></td></tr> </table><p>The result should look something like this. </p>

<p class=Pix><img src="images/XB_SimpleChart_Web_Pie_2.gif" x-maintain-ratio=TRUE style="border: none; width: 310px; height: 413px; float: none; border-style: none; border-style: none;" width=310 height=413 border=0></p>

<p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Placing+SimpleCharts+on+a+Web+Page">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>