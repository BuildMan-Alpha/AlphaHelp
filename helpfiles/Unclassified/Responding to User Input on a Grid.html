	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Responding to User Input on a Grid</p>

<p class=Note><span class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>Note</span> : This example describes a technique that was necessary before grid components supported <a href="../References/Web/Web Publishing/Setting Web Control Validation Rules.html" title="Setting Web Control Validation Rules" class="wiki">validation of user input</a>.</p>

<p>In this example, the grid:</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>does not access new records</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>has a single editable row</p>

</li> </ul><p class=A5>Creating the Test_Field_Values Grid Component</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new grid component.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Component Type</span> page select <span class=Button>Updateable</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Grid > Data Source</span> menu select <span class=Button>Alpha Five .dbf Tables</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Grid > Query (DBF)</span> menu select "user_names" in the <span class=Control>Table name</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Calculated Fields</span>, enter <span class=Code1>Password2 = Password</span> and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid > Fields</span> menu.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select "User_Name", "Password", "Password2", and "Level" in the <span class=Control>Available Fields</span> list and click <img src="images/Move_Last_Button_2.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Move "Level" to the bottom of the <span class=Control>Selected Fields</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Change the <span class=Button>Column Properties > Column heading</span> value of the Password2 field to <span class=Code1>Repeat&ltbr>Password</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>Column Properties > Heading in-line style</span> values of all four fields to <span class=Code1>text-align: left; vertical-align: bottom;</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid > Properties</span> menu.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>Layout Options > Rows of data</span> value to <span class=Code1>1</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid Update Settings</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select "False" in the <span class=Button>Permissions > Allow insert</span> list (de-select the check box).</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter <span class=Code1>Test_Field_Values</span>, and click <span class=Button>Save</span>.</p>

</li> </ol><p class=A5>Creating the Test_Field_Values Page</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Web Project Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New > Alpha Five Web Page (A5W) > OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter <span class=Code1>Test_Field_Values</span>, and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Insert Component > Select</span>, select the <span class=Code1>Test_Field_Values</span> grid, and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Source</span> tab of the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following code after the <span class=HTML1>&lthead></span> tag.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>if eval_valid("Test_Field_Valu_Button_Submit") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (v.r1.password &lt> v.r1.password2) .or. (val(v.r1.level) &lt 0) .or. (val(v.r1.level) > 20) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("error_page.a5w?password="+v.r1.password+"&password2="+v.r1.password2+"&level="+v.r1.level)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end if</p>

<p class=Code>%></td></tr> </table><p class=Note><span class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>Note</span> : The variable name <span class=Code1>Test_Field_Valu_Button_Submit</span> is a combination of the value defined for the <span class=Code1>componentName</span> variable and <span class=Code1>_Button_Submit</span>.</p>

<p>The values that the script is testing are <span class=Code1>v.r1.password</span>, <span class=Code1>v.r1.password2</span>,and <span class=Code1>v.r1.level</span>. The "v.r1." prefix indicates that the values are coming from the first row of the grid. If the values are not satisfactory, the page uses <a href="../References/Methods/RESPONSE.REDIRECT Method.html" title="RESPONSE.REDIRECT Method" class="wiki">RESPONSE.REDIRECT(</a>)) method to display <span class=Code1>error_page.a5w</span>. The URL passes the value of the variables so the receiving page can display them.</p>

<p>The values that the script is testing are <span class=Code1>v.r1.password</span>, <span class=Code1>v.r1.password2</span>,and <span class=Code1>v.r1.level</span>. The "v.r1." prefix indicates that the values are coming from the first row of the grid. If the values are not satisfactory, the page uses <a href="../References/Methods/RESPONSE.REDIRECT Method.html" title="RESPONSE.REDIRECT Method" class="wiki">RESPONSE.REDIRECT(</a>) method to display <span class=Code1>error_page.a5w</span>. The URL passes the value of the variables so the receiving page can display them.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>response.redirect("error_page.a5w?password="+v.r1.password+"&password2="+v.r1.password2+"&level="+v.r1.level)</td></tr> </table><p class=A5>Creating the Show_Field_Values Dialog Component</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Web Project Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New > Alpha Five Web Component > Dialog > OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Form > Controls</span> menu add 3 Textboxes to the dialog.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter <span class=Code1>Show_Field_Values</span>, and click <span class=Button>Save</span>.</p>

</li> </ol><p class=A5>Creating the Error_Page Page</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Web Project Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New > Alpha Five Web Page (A5W) > OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter <span class=Code1>Error_Page</span>, and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Insert Component > Select</span>, select the <span class=Code1>Show_Field_Values</span> dialog, and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Source</span> tab of the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following code after the <span class=HTML1>&ltbody></span> tag.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&ltp>&ltfont face=Verdana></p>

<p class=Code>&lt%a5</p>

<p class=Code>if (password &lt> password2) then</p>

<p class=Code></p>

<p class=Code>? "Passwords do not match"</p>

<p class=Code>end if</p>

<p class=Code>if (val(level) &lt 0) then</p>

<p class=Code></p>

<p class=Code>? "The Level cannot be negative"</p>

<p class=Code>end if</p>

<p class=Code>if (val(level) > 20) then</p>

<p class=Code></p>

<p class=Code>? "The Level cannot be greater than 20"</p>

<p class=Code>end if</p>

<p class=Code>%></p>

<p class=Code>&lt/p>&lt/font></td></tr> </table><p class=A5>Displaying the Pages</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Web Project Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>A5W Pages</span> tab.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right select the "Error_page" entry and click <span class=Button>Publish (Local Webroot)</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right select the "Test_Field_Values" entry and click <span class=Button>Publish (Local Webroot) and open</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>After entering two passwords that do not match and clicking Submit, the following screens appear. </p>

</li> </ol><p class=Pix><img src="images/WPT_Grid_Validate_1.gif" x-maintain-ratio=TRUE style="border: none; width: 412px; height: 270px; float: none; border-style: none; border-style: none;" width=412 height=270 border=0></p>

<p class=Pix><img src="images/WPT_Grid_Validate_2.gif" x-maintain-ratio=TRUE style="border: none; width: 190px; height: 280px; float: none; border-style: none; border-style: none;" width=190 height=280 border=0></p>

<ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>After entering a value for Level that is greater than 20, the following screens appear. </p>

</li> </ol><p class=Pix><img src="images/WPT_Grid_Validate_3.gif" x-maintain-ratio=TRUE style="border: none; width: 415px; height: 265px; float: none; border-style: none; border-style: none;" width=415 height=265 border=0></p>

<p class=Pix><img src="images/WPT_Grid_Validate_4.gif" x-maintain-ratio=TRUE style="border: none; width: 262px; height: 285px; float: none; border-style: none; border-style: none;" width=262 height=285 border=0></p>

<p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Responding+to+User+Input+on+a+Grid">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>