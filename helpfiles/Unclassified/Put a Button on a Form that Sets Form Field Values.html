	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Put a Button on a Form that Sets Form Field Values</p>



<p>The goal in this lesson is to put a button on a form that sets the "Active" 
 field to False, and sets the date on which the customer was deactivated. 
 </p>



<p class=Pix><img src="images/button_32.GIF"
					x-maintain-ratio=TRUE
					style="width: 562px;
							height: 519px;
							float: none;
							border-style: none;
							border-style: none;"
					width=562
					height=519
					border=0></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right-click on the 
 "customers" table and select the <span class=Button>Open Default 
 Form</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Design 
 Mode</span> button to switch to <span class=Screen>Design Mode</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Button 
 Object</span> tool on the <span class=Screen>Toolbox</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click and drag to 
 draw a button on the form next to the <span class=Code1>Active</span> 
 field. When you release the mouse button, the <span class=Screen>Define 
 Button</span> dialog box appears. </p>

</li>
</ol>

<p class=Pix><img src="images/Define_Button_Default_Settings.gif"
					x-maintain-ratio=TRUE
					style="width: 478px;
							height: 447px;
							float: none;
							border-style: none;
							border-style: none;"
					width=478
					height=447
					border=0></p>



<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "Deactivate"&nbsp;as&nbsp;the 
 <span class=Control>Label</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make sure the <span 
 class=Control>Define script for this button now?</span> check box is checked.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make sure the <span 
 class=Control>Use Action Scripting</span> radio button is selected.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span>. 
 The embedded <span class=Screen>Action Script Editor</span> appears. <a HREF="http://support.alphasoftware.com/imagesV8/Embedded_Action_Script_Editor.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>

</li>
</ol>

<p class=Pix><img src="images/Embedded_Action_Script_Editor.gif"
					x-maintain-ratio=TRUE
					style="width: 478px;
							height: 447px;
							float: none;
							border-style: none;
							border-style: none;"
					width=478
					height=447
					border=0></p>



<ol start=9>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Add 
 New Action</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Fields" 
 category and the "Set Field Values" Action, then click <span 
 class=Button>OK</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Action_Fields_Set_Field_Values.gif"
					x-maintain-ratio=TRUE
					style="width: 627px;
							height: 246px;
							float: none;
							border-style: none;
							border-style: none;"
					width=627
					height=246
					border=0></p>



<p>The <span class=Screen>Set Field Values Genie</span> appears. </p>



<p class=Pix><img src="images/button_13.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 227px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=227
					border=0></p>



<ol start=11>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Add_Button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			float: none;
			width: 22px;
			height: 22px;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> button to select the field you want to update. Alpha Five 
 shows the fields on the current form.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Alpha Five is 
 actually showing the objects on the form that are bound to fields. By 
 default, Alpha Five gives the object the same name&nbsp;as&nbsp;the field 
 itself, but you are free to change any Object name by right clicking on 
 the object and selecting the Properties command.</p>



<ol start=12>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Scroll down the list 
 until you reach "Active". Note that since "Active" 
 is a reserved word in Alpha Five, the control name has been automatically 
 renamed to "Active0." </p>

</li>
</ol>

<p class=Pix><img src="images/button_14.gif"
					x-maintain-ratio=TRUE
					style="width: 268px;
							height: 287px;
							float: none;
							border-style: none;
							border-style: none;"
					width=268
					height=287
					border=0></p>



<ol start=13>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Active0" 
 and click <span class=Button>OK</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/button_15.gif"
					x-maintain-ratio=TRUE
					style="float: none;
							width: 481px;
							height: 209px;
							border-style: none;
							border-style: none;"
					width=481
					height=209
					border=0></p>



<ol start=14>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Add_Button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			float: none;
			width: 22px;
			height: 22px;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> button again to add another field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "date_deactivated" 
 field and click <span class=Button>OK</span>. Your screen should now look 
 like this: </p>

</li>
</ol>

<p class=Pix><img src="images/button_16.gif"
					x-maintain-ratio=TRUE
					style="float: none;
							width: 480px;
							height: 210px;
							border-style: none;
							border-style: none;"
					width=480
					height=210
					border=0></p>



<ol start=16>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Set "date_deactivated" 
 to today's date.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Control>How 
 will you specify the field's value?</span> combo box to "Specify 
 an expression that evaluates to the value".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "date()"&nbsp;as&nbsp;the 
 expression. The <a href="../References/Functions/DATE Function.html" title="DATE Function" class="wiki">DATE(</a>) function 
 returns the current date. </p>

</li>
</ol>

<p class=Pix><img src="images/button_17.gif"
					x-maintain-ratio=TRUE
					style="float: none;
							width: 481px;
							height: 206px;
							border-style: none;
							border-style: none;"
					width=481
					height=206
					border=0></p>



<ol start=19>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Active0" 
 object.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Choose the <span 
 class=Control>Specify the value now</span> option.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "False"&nbsp;as&nbsp;the 
 value. </p>

</li>
</ol>

<p class=Pix><img src="images/button_18.gif"
					x-maintain-ratio=TRUE
					style="float: none;
							width: 481px;
							height: 205px;
							border-style: none;
							border-style: none;"
					width=481
					height=205
					border=0></p>



<ol start=22>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Control>Finish</span> 
 button.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : When you create 
 an Action Script in the embedded <span class=Screen>Action Script Editor</span>, 
 Alpha Five does not prompt for a comment in the last step,&nbsp;as&nbsp;it 
 does when you create the Action Script in the <span class=Screen>Code 
 Editor</span>. (The <span class=Screen>Action Script Editor</span> is 
 said to be "embedded" because it is embedded in the <span class=Screen>Button</span> 
 Genie.) The Action Script looks like this. </p>



<p class=Pix><img src="images/button_19.gif"
					x-maintain-ratio=TRUE
					style="width: 478px;
							height: 121px;
							float: none;
							border-style: none;
							border-style: none;"
					width=478
					height=121
					border=0></p>



<ol start=23>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Finish</span>. 
 The <span class=Screen>Button Genie</span> closes and your form now has 
 a button. </p>

</li>
</ol>

<p class=Pix><img src="images/button_20.gif"
					x-maintain-ratio=TRUE
					style="width: 539px;
							height: 97px;
							float: none;
							border-style: none;
							border-style: none;"
					width=539
					height=97
					border=0></p>



<ol start=24>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save the form, naming 
 it "Deactivate".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Form 
 View</span> button to run the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the new <span 
 class=Button>Deactivate</span> button to test it out. </p>

</li>
</ol>

<p class=Pix><img src="images/button_21.gif"
					x-maintain-ratio=TRUE
					style="width: 562px;
							height: 97px;
							float: none;
							border-style: none;
							border-style: none;"
					width=562
					height=97
					border=0></p>



<p class=A5>Enhancing the Script</p>



<p>It would be nice if, after the button was pressed, a dialog box came 
 up asking the user to confirm that they wanted to deactivate the customer.</p>



<ol start=27>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Design</span> 
 button to put the form back into <span class=Screen>Design Mode</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right-click the <span 
 class=Control>Deactivate</span> button and select <span class=Button>Events 
 > OnPush</span> to edit the button's <span class=Code1>OnPush</span> 
 event. The <span class=Screen>Code Editor</span> opens. Note the name 
 on the tab. ":Deactivate" is the form name, "Button1" 
 is the object name, and "OnPush" is the event name. </p>

</li>
</ol>

<p class=Pix><img src="images/button_22.gif"
					x-maintain-ratio=TRUE
					style="width: 648px;
							height: 217px;
							float: none;
							border-style: none;
							border-style: none;"
					width=648
					height=217
					border=0></p>



<ol start=29>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Add 
 New Action</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Dialog 
 Boxes" category and the "Display a Message Box" Action. 
 Click <span class=Button>OK</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Action_Dialog_Boxes_Display_a_Message_Box.gif"
					x-maintain-ratio=TRUE
					style="width: 627px;
							height: 218px;
							float: none;
							border-style: none;
							border-style: none;"
					width=627
					height=218
					border=0></p>



<ol start=31>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <span 
 class=Button>Yes, No, Cancel</span> option.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Second 
 Button</span>&nbsp;as&nbsp;the button with Initial Focus. </p>

</li>
</ol>

<p class=Pix><img src="images/button_23.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 374px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=374
					border=0></p>



<ol start=33>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Fill in the Genie 
 options&nbsp;as&nbsp;shown below: </p>

</li>
</ol>

<p class=Pix><img src="images/button_24.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 362px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=362
					border=0></p>



<ol start=35>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "deactivate"&nbsp;as&nbsp;the 
 dialog box name. </p>

</li>
</ol>

<p class=Pix><img src="images/button_25.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 359px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=359
					border=0></p>



<ol start=37>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span> 
 and <span class=Button>Finish</span> to close the Genie. Your Action Script 
 should look like this: </p>

</li>
</ol>

<p class=Pix><img src="images/button_27.gif"
					x-maintain-ratio=TRUE
					style="width: 653px;
							height: 108px;
							float: none;
							border-style: none;
							border-style: none;"
					width=653
					height=108
					border=0></p>



<ol start=38>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You want to display 
 the message box BEFORE you set the values in the fields. Move this action 
 to the top of the list. Click the <span class=Button>Move Action Up</span> 
 button <img src="images/Move_Up_Button.gif"
			x-maintain-ratio=TRUE
			style="float: none;
					width: 22px;
					height: 22px;
					border-style: none;
					border-style: none;"
			width=22
			height=22
			border=0>. </p>

</li>
</ol>

<p class=Pix><img src="images/button_26.gif"
					x-maintain-ratio=TRUE
					style="float: none;
							width: 631px;
							height: 113px;
							border-style: none;
							border-style: none;"
					width=631
					height=113
					border=0></p>



<ol start=41>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Set 
 Field Values Action" to give it focus. We need to make this action 
 conditional.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Show/hide 
 Conditions</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Check the <span class=Control>Action 
 is Conditional</span> check box. Accept the default "Flag variable 
 is True" choice.&nbsp;"Flag" variables are special variables 
 set by the message box in the previous step. For example, if the user 
 clicks the "No" button in this dialog, then the <span class=Code1>deactivate_No_button</span> 
 variable will be set to .T.. In this example, you only want to update 
 the field values if the user clicks the "Yes" button on the 
 message box. So the flag variable we care about is the <span class=Code1>deactivate_Yes_button</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "deactivate_YES_Button" 
 in the <span class=Control>Flag</span> combo box. The <span class=Screen>Code 
 Editor</span> should now look like this: </p>

</li>
</ol>

<p class=Pix><img src="images/button_28.gif"
					x-maintain-ratio=TRUE
					style="width: 472px;
							height: 130px;
							float: none;
							border-style: none;
							border-style: none;"
					width=472
					height=130
					border=0></p>



<ol start=43>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If the user selects 
 the "No" or "Cancel" buttons, create a message box 
 saying that the customer was not deactivated. To do this, follow the steps 
 to add a new message box action.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <span 
 class=Button>OK</span> button on the first page of the <span class=Screen>Display 
 a Message Box</span> Genie.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Complete the second 
 page of the Genie&nbsp;as&nbsp;shown below: </p>

</li>
</ol>

<p class=Pix><img src="images/button_29.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 374px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=374
					border=0></p>



<ol start=46>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "notdeactivated"&nbsp;as&nbsp;the 
 name of the dialog box. </p>

</li>
</ol>

<p class=Pix><img src="images/button_30.gif"
					x-maintain-ratio=TRUE
					style="width: 482px;
							height: 356px;
							float: none;
							border-style: none;
							border-style: none;"
					width=482
					height=356
					border=0></p>



<ol start=47>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Check the <span class=Control>Action 
 is Conditional</span> check box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Set <span class=Control>Execute 
 action if</span> to "Flag variable is True".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Set Flag to deactivate_NO_button. 
 Your screen should look like this: </p>

</li>
</ol>

<p class=Pix><img src="images/button_31.gif"
					x-maintain-ratio=TRUE
					style="width: 488px;
							height: 132px;
							float: none;
							border-style: none;
							border-style: none;"
					width=488
					height=132
					border=0></p>



<ol start=50>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your form and 
 test the button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>No</span> 
 on the message box, and you will see the "Customer was not deactivated" 
 message.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you select the 
 <span class=Button>Cancel</span> button, the field value will not be updated 
 (as you would expect), but the "Customer was not deactivated" 
 message will NOT be shown.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>To fix this, edit 
 the button Action and change the <span class=Control>Execute Action if</span> 
 setting to "Condition expression is True". Then enter the expression, 
 "Var->deactivate_NO_Button = .t.".</p>

</li>
</ol>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Put+a+Button+on+a+Form+that+Sets+Form+Field+Values">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>