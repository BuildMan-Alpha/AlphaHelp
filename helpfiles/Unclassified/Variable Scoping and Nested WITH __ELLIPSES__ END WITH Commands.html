	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Variable Scoping and Nested WITH ... END WITH Commands</p>



<p>When you nest <span class=Code1>WITH ... END WITH</span> commands, it 
 is important to understand how Xbasic treats variables DIMmed in different 
 name-spaces.</p>



<p>If a <span class=Code1>WITH ... END WITH</span> command is nested within 
 another <span class=Code1>WITH ... END WITH</span> construct, the inner 
 name-space is called the <span class=Code1>child name-space</span> and 
 the outer name-space is the <span class=Code1>parent name-space</span>.</p>



<p>Any variable that is DIMmed in the parent name-space will be visible 
 in the child name-space. Any variable that is DIMmed in the child name-space 
 will not be visible in the parent name-space (unless the variable name 
 is prefixed with the name-space name,&nbsp;as&nbsp;in: <span class=Code1>name-space.variable</span> 
 ).</p>



<p>The following Xbasic script demonstrates this. In this script, "A" 
 is the parent name-space and "B" is the child name-space. The 
 variable, <span class=Code1>firstname</span> is DIMmed in the parent name-space. 
 It is therefore visible in the child name-space.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>with a</p>


<p class=Code>&nbsp;&nbsp;&nbsp;firstname = "Peter"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space A","Firstname: " + firstname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;with 
 b</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastname 
 = "Pan"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space B","Lastname: " + lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space B","Firstname: " + firstname)</td></tr>
</table>

<p>The second message box displayed the value "Peter" because 
 even though the "B" name-space is active, <span class=Code1>firstname</span> 
 was DIMmed in the parent name-space, and Xbasic "sees" <span 
 class=Code1>firstname</span> in the parent name-space.</p>



<p>Since <span class=Code1>firstname</span> was DIMmed in the "A" 
 name-space, this command sets <span class=Code1>firstname</span> in the 
 "A" name-space.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstname 
 = "Paul"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space B","Firstname: " + firstname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 with</td></tr>
</table>

<p>The next message shows "Paul" (the value set when name-space 
 'B' was active).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space A","Firstname: " + firstname)</td></tr>
</table>

<p>The only way to refer to <span class=Code1>lastname</span> is to use 
 the "b." prefix, since this variable was created in the "B" 
 name-space.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space A","Lastname: " + b.lastname)</td></tr>
</table>

<p>If you do not use the "b." prefix, the variable can't be found. 
 This command generates an error.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("In 
 name-space A","Lastname: " + lastname)</p>


<p class=Code>end with</td></tr>
</table>

<p class=A5><a name=Selecting_the_Local_Variable_Frame>Selecting the Local 
 Variable Frame</a></p>



<p>Xbasic supports a syntax that can be used when setting a variable value. 
 By prefixing the variable name with a period, you tell Xbasic to set the 
 variable in the local variable frame, rather than some higher level variable 
 frame. These examples will help illustrate the point. Astute observers 
 will note that the Xbasic code that is generated for the Web Components 
 now uses this syntax. (See also <a href="../Orphans/WITH __ELLIPSES__ END WITH.html" title="WITH ... END WITH" class="wiki">WITH   ... END WITH</a> ) For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>DIM tmpl.field_info<a class="wiki"  href="tmpl.fields" rel="">tmpl.fields</a>&nbsp;as&nbsp;P</p>


<p class=Code>with tmpl.field_info<a class="wiki"  href="1" rel="">1</a></p>


<p class=Code>.fieldname = "City"</p>


<p class=Code>.Scope = "Local"</p>


<p class=Code>end with</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../References/Xbasic/Xbasic Reference/What is a Variable__QUESTION__.html" title="What is a Variable?" class="wiki">What is a Variable?</a>, <a href="../References/Xbasic/Xbasic Reference/Pointer and Dot Variables.html" title="Pointer and Dot Variables" class="wiki">Dot   Variables</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Variable+Scoping+and+Nested+WITH+...+END+WITH+Commands">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/Design/Platform/Xbasic/","status":"pending","keywords":"server,design,guide,xbasic","tags":"common","pagename":""} --->
</body></html>