	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Working with RTF Data</p>



<p>Using Xbasic, you can manipulate data in variables and in RTF memo fields. 
 In order to manipulate a RTF memo field, you need to create a temporary 
 RTF object, manipulate its contents, and then put the contents of the 
 temporary RTF object back into the RTF memo field.</p>



<p>The <a href="../References/Methods/RTF.CREATE Method.html" title="RTF.CREATE Method" class="wiki">RTF.CREATE(</a>) method is 
 used to create a RTF object.&nbsp;Refer to <a href="../References/Functions/RTF Functions and Methods.html" title="RTF Functions and Methods" class="wiki">RTF   Functions and Methods</a> for more information.</p>



<p>The following example shows how you can add text to a RTF memo field.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.open("customer")</p>


<p class=Code>'Get a pointer to the RTF memo field</p>


<p class=Code>f = t.field_get("notes")</p>


<p class=Code>'Create an RTF object, that is initially a NULL value</p>


<p class=Code>r = rtf.create("")</td></tr>
</table>

<p>Get the binary data that is currently in the Notes field and assign 
 it to the <span class=Code1>binary_text</span> property of the rtf object. 
 The RTF object now contains the same value&nbsp;as&nbsp;the memo field.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>r.Binary_Text = f.value_get()</p>


<p class=Code>'Set the font (name and point size) and color for next</p>


<p class=Code>'insertion into the RTF object</p>


<p class=Code>r.set_font("courier,15","blue")</td></tr>
</table>

<p>Insert a CR-LF, and then the text "Xbasic Example" into the 
 RTF object. The position argument is set to 0 to indicate that the insertion 
 is after the existing text in the RTF object.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>r.insert(crlf()+ "xbasic example",0)</p>


<p class=Code>'Now change the font for the next insertion"</p>


<p class=Code>r.set_font("arial,10","black")</p>


<p class=Code>r.insert(crlf()+ "Alpha Software" + crlf(), 0)</p>


<p class=Code>'Put the table into change mode</p>


<p class=Code>t.change_begin()</p>


<p class=Code>'Put the value in the rtf object's "binary_text" 
 property into the RTF memo field.</p>


<p class=Code>f.value_put(r.Binary_Text)</p>


<p class=Code>'Save the changes</p>


<p class=Code>t.change_end(.T.)</p>


<p class=Code>'Close the table</p>


<p class=Code>t.close()</td></tr>
</table>

<p>The following example shows how you can import text that is saved in 
 a RTF format file into a RTF memo field. Assume that this script is attached 
 to a button on a form and that the RTF memo field is called <span class=Code1>rtfmemo</span>. 
 First, get a pointer to the object on the form that contains the <span 
 class=Code1>rtfmemo</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>obj = obj("rtfmemo")</p>


<p class=Code>'register the rtf clipboard type</p>


<p class=Code>clip_type = ClipBoard.Register_Type("Rich Text Format")</p>


<p class=Code>fn = "c:\mydata\rtfdata.rtf"</p>


<p class=Code>'put the rtf data onto the clipboard</p>


<p class=Code>'the file.to_blob() method reads the file containing</p>


<p class=Code>'the rtf data into a blob variable.</p>


<p class=Code>ClipBoard.Set_Data(file.to_blob(fn),clip_type)</p>


<p class=Code>'obj.rtf is a pointer to the rtf object on the form.</p>


<p class=Code>obj.rtf.paste()</p>


<p class=Code>'now reset the clipboard to NULL</p>


<p class=Code>ClipBoard.Set_Data("",clip_type)</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../References/Functions/RTF Functions and Methods.html" title="RTF Functions and Methods" class="wiki">RTF Functions and Methods</a>, 
 <a href="RTF Properties.html" title="RTF Properties" class="wiki">&lt;RTF&gt; Properties</a>, <a href="RTF Overview.html" title="RTF Overview" class="wiki">Rich   Text Overview</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Working+with+RTF+Data">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/View/Form/","status":"pending","tags":"desktop","keywords":"desktop,guide,form"} --->
</body></html>