	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Setting the Text and Value Properties of Items in a Choice 
 List Array</p>



<p>The <span class=Bolded>user defined</span> choices displayed by a combo 
 box, radio button, list box etc. can be read and set by reading or setting 
 the text and value properties of the choice list array. The text property 
 controls what is displayed on the form. The value property controls what 
 value is written to the field when an item is selected.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : A <a href="Setting Choices for List and Combo Boxes.html#User_Defined_Choices" title="Setting Choices for List and Combo Boxes" class="wiki">user   defined</a> choice list array is <span class=Bolded>not</span> a normal 
 data array,&nbsp;as&nbsp;Documented by the <a href="../References/Functions/Array Functions and Methods.html" title="Array Functions and Methods" class="wiki">&lt;ARRAY&gt;   Methods</a>. A choice list array has its own special methods.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : This technique 
 does not apply if the control's choices were <a href="Setting Choices for List and Combo Boxes.html#Populated_Using_Xbasic" title="Setting Choices for List and Combo Boxes" class="wiki">populated   with Xbasic</a>. In that case you need to manipulate the control's <span 
 class=Code1>.settings.dynamic_list</span> property.</p>



<p>The syntax is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>object_address.choice.list[item number].text = "New 
 value"</p>


<p class=Code>object_address.choice.list[item number].value = "New 
 value"</td></tr>
</table>

<p class=A5>Example</p>



<p>The following script checks the value of the <span class=Code1>which_state</span> 
 control on the form and then runs a query to select customers in that 
 state. It then populates a list box called "combo" with the 
 results of the query.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>'run the query</p>


<p class=Code>'See note at end regarding next two lines</p>


<p class=Code>state_to_query = which_state.value</p>


<p class=Code>query.filter = "state = state_to_query"</p>


<p class=Code>query.order = "last_name"</p>


<p class=Code>indx = tbl.query_create()</p>


<p class=Code>count = indx.records_get()</p>


<p class=Code>'redimension the list box</p>


<p class=Code>combo.choice.list.redim(count)</p>


<p class=Code>'populate the list box</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>for i = 1 to count</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;combo.choice.list[i].text = trim(tbl.customer)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;combo.choice.list[i].value = trim(tbl.customer)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>next i</td></tr>
</table>

<p>The following script inserts 2 new choice into the radio button group 
 called Radio. The group has "MC, Visa, and Amex"&nbsp;as&nbsp;its 
 initial 3 choices. The new choices are inserted after "Visa". 
 The script is on a button on a form.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>radio.choice.list.insert(2,2) 'insert 2 items after item 
 2</p>


<p class=Code>radio.choice.list[3].text = "Diners Club"</p>


<p class=Code>radio.choice.list[3].value = "DC"</p>


<p class=Code>radio.choice.list[4].text = "Discover"</p>


<p class=Code>radio.choice.list[4].value = "D"</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The <span class=Argument>Query.Filter</span> 
 expression cannot directly refer to layout level variables on the form, 
 or to form controls, or the table pointer. Your script must set a local 
 script variable to the value of the layout level variable, or the form 
 control. Alternatively, declare&nbsp;variables on the form&nbsp;as&nbsp;Session 
 level. For example, the following code does <span class=Bolded>not</span> 
 work:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>query.filter = "state = which_state.value"</td></tr>
</table>

<p>Whereas, this code does work:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>state_to_query = which_state.value</p>


<p class=Code>query.filter = "state = state_to_query"</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../References/Functions/Array Functions and Methods.html" title="Array Functions and Methods" class="wiki">&lt;ARRAY&gt; Methods</a>, 
 <a href="Working with List Boxes, Combo Boxes, Radio Buttons Etc..html" title="Working with List Boxes, Combo Boxes, Radio Buttons Etc." class="wiki">Working   with List Boxes, Combo Boxes, Radio Buttons Etc.</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Setting+the+Text+and+Value+Properties+of+Items+in+a+Choice+++List+Array">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>