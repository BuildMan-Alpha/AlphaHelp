	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Placing an HTML Edit Control on a Form</p>



<p>The following procedure describes the process of placing the <span class=Screen>Microsoft</span> 
 DHTML Edit Control for IE5 ( <span class=Code1>Dhtmledit.Dhtmledit</span> 
 ) ActiveX control on a form. This form is bound to the <span class=Code1>HTMLnotes</span> 
 memo field in the underlying table.</p>



<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : Since the 
 ActiveX control saves HTML encoded text into the memo field, it should 
 only be edited and viewed through the ActiveX control.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open a form in the 
 <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <img src="images/ActiveX_tool_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> tool from the <span class=Screen>Toolbox</span> and draw 
 a rectangle on the form. This displays the <span class=Screen>Insert ActiveX 
 Control</span> dialog.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Microsoft 
 Web Browser" control and click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 ActiveX control and select <span class=Button>Properties...</span> .</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Note the <span class=Control>Object 
 name</span> found on the <span class=Screen>Setup</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the ActiveX 
 Properties dialog.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 form's background and select <span class=Button>Events > OnActivate</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Assuming that the 
 control's name is <span class=Code1>activeX1</span> and the memo field's 
 name is <span class=Code1>HTMLNOTES</span>, enter the following Xbasic 
 code. This code causes the <span class=Code1>HTMLNOTES</span> field of 
 the current record to be displayed and turns off editing.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim px&nbsp;as&nbsp;P</p>


<p class=Code>'get a pointer to the activeX object</p>


<p class=Code>px = topparent:activex1.activex</p>


<p class=Code>'set the activeX's documenthtml property</p>


<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>px.documenthtml = tbl.HTMLNOTES</p>


<p class=Code>'set the activeX control to browse mode</p>


<p class=Code>'you cannot edit text in the control when browsemode is .T.</p>


<p class=Code>px.browsemode = .T.</td></tr>
</table>

<ol start=9
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Save_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to save the code and return to the <span class=Screen>Form 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 form's background and select <span class=Button>Events > OnEnter</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 Xbasic code. This code allows you to add a new record. It clears the ActiveX 
 control and turns on editing.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim px&nbsp;as&nbsp;P</p>


<p class=Code>'get a pointer to the activeX object</p>


<p class=Code>px = topparent:activex1.activex</p>


<p class=Code>px.documenthtml = ""</p>


<p class=Code>px.browsemode = .T.</td></tr>
</table>

<ol start=12
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Save_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to save the code and return to the <span class=Screen>Form 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 form's background and select <span class=Button>Events > OnFetch</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 Xbasic code. This code displays the current record when you are in Change 
 or View mode, and gives you a clear window when in Enter mode.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim px&nbsp;as&nbsp;P</p>


<p class=Code>'get a pointer to the activeX object</p>


<p class=Code>px = topparent:activex1.activex</p>


<p class=Code>'set the activeX control to browse mode -</p>


<p class=Code>'you cannot edit text in the control when browsemode is .T.</p>


<p class=Code>px.browsemode = .T.</p>


<p class=Code>'set the activeX's documenthtml property</p>


<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>if (tbl.mode_get()<> 2) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;px.documenthtml 
 = t.HTMLNOTES</p>


<p class=Code>'if you are in enter mode (i.e. you are on the new record),</p>


<p class=Code>'then set the contents of the control to an empty string</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;px.documenthtml 
 = ""</p>


<p class=Code>end if</td></tr>
</table>

<ol start=15
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 ActiveX control and select <span class=Button>Events > ActiveXEvent</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Modify the <span 
 class=Code1>onkeypress()</span> function to include this code.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function onkeypress&nbsp;as&nbsp;v ()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 tbl&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl 
 = table.current()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'if 
 the table is still in view mode</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'then 
 put the form into change mode</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 (tbl.mode_get()= 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topparent.change_mode()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;t.HTMLNOTES 
 = topparent:activex1.activex.documenthtml</p>


<p class=Code>end function</td></tr>
</table>

<ol start=17
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Save_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to save the code and return to the <span class=Screen>Form 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Button_tool_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to place a button on the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Label the button 
 "Toggle In-place Editing", and place this code under its <span 
 class=Code1>OnPush</span> event. This code toggles the ability to edit 
 in the ActiveX control.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim px&nbsp;as&nbsp;P</p>


<p class=Code>'get a pointer to the activeX object</p>


<p class=Code>px = topparent:activex1.activex</p>


<p class=Code>px.browsemode = .not. px.browsemode</td></tr>
</table>

<ol start=18
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Save_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to save the code and return to the <span class=Screen>Form 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Button_tool_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to place a button on the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Label the button 
 "Pop-up Editor", and place this code under its <span class=Code1>OnPush</span> 
 event. This code toggles opens the HTML Editor with the contents of the 
 current record, and then saves its contents when you click <span class=Button>OK</span>.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim px&nbsp;as&nbsp;P</p>


<p class=Code>'get a pointer to the activeX object</p>


<p class=Code>px = topparent:activex1.activex</p>


<p class=Code>dim ptr&nbsp;as&nbsp;P</p>


<p class=Code>ptr = a5_html_modal(px.documenthtml, "Edit", .t.)</p>


<p class=Code>if ptr.lastbutton = "OK" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;px.documenthtml 
 = ptr.text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 tbl&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl 
 = table.current()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 tbl.mode_get()= 0 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'force 
 the form into change mode so</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'that 
 the Save icon on the toolbar is enabled</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topparent.change_mode()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'update 
 the htmlNotes field</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.HTMLNOTES 
 = ptr.text</p>


<p class=Code>end if</td></tr>
</table>

<ol start=21
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your work and 
 switch to form view. The form should look something like this: </p>

</li>
</ol>

<p class=Pix><img src="images/UG_ActiveX_HTML_Editor_on_Form.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 590px;
							height: 396px;
							float: none;
							border-style: none;
							border-style: none;"
					width=590
					height=396
					border=0></p>



<p class=A5>See Also</p>



<p><a href="../References/Desktop/OLE Automation Object Browser.html" title="OLE Automation Object Browser" class="wiki">OLE Automation   Object Browser</a></p>


	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Placing+an+HTML+Edit+Control+on+a+Form">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/View/Xdialog/Controls/","status":"pending","keywords":"desktop,guide,xdcontrol","tags":"desktop"} --->
</body></html>