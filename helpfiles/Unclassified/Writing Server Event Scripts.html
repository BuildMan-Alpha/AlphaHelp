	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Writing Server Event Scripts</p>



<p>Server event scripts provide an opportunity to respond to or process 
 the input from a dialog (form) web component. You can run scripts when 
 the following events occur.</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Bolded>OnClick</span> 
 - Available only for AdvancedButton objects. The <span class=Code1>OnClick</span> 
 script runs every time the button is clicked.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Bolded>Initialize</span> 
 - The <span class=Code1>Initialize</span> event fires once, the first 
 time the Form is run.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Bolded>Validate</span> 
 - The <span class=Code1>Validate</span> event fires when a form is submitted.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Bolded>AfterValidate</span> 
 - The <span class=Code1>AfterValidate</span> event fires after the <span 
 class=Code1>Validate</span> event.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Bolded>Activate</span> 
 - The <span class=Code1>Activate</span> event fires every time the form 
 is run.</p>

</li>
</ul>

<p class=A5><a name=Initialize_Events>Initialize Events</a></p>



<p>The <span class=Code1>Initialize</span> event fires once, the first 
 time the form is run. If the form is submitted back to itself (as is typically 
 the case, so that the values in the Form's controls can be validated), 
 the Initialize event is not fired.</p>



<p>The <span class=Code1>Initialize</span> event is typically used to set 
 initial values for controls on the Form.</p>



<p>If you need to execute code every time the Form is run, use the <span 
 class=Code1>Activate</span> event.</p>



<p class=A5><a name=Validate_Events>Validate Events</a></p>



<p>The <span class=Code1>Validate</span> event fires when a form is submitted. 
 Use this event to check that the value in a control is valid. If your 
 script determines that an error has occurred, then you should set the 
 following object properties:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>CurrentControl.Has_Error = .t.</p>


<p class=Code>CurrentControl.Error_Message = "<Your error message>"</td></tr>
</table>

<p>You can also use this syntax:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>CurrentForm.Controls.<controlName>.Has_Error = .t.</p>


<p class=Code>CurrentForm.Controls.<controlName>.Error_Message = 
 "<Your error message>"</td></tr>
</table>

<p>If the <span class=Code1>CurrentControl.Has_Error</span> property is 
 ".T.", then the form will be redisplayed with the error message 
 shown at the top of the form. The user can then make corrections and resubmit 
 the form.</p>



<p class=A5><a name=AfterValidate_Events>AfterValidate Events</a></p>



<p>The <span class=Code1>AfterValidate</span> event fires after the <span 
 class=Code1>Validate</span> event, but only if no object on the form has 
 had its <span class=Code1>.Has_Error</span> property set to ".T.".</p>



<p>A typical use of the <span class=Code1>AfterValidate</span> event is 
 to redirect control to another page in the application.</p>



<p>For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>If Condition1 = .t. Then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Response.Redirect("Page1.a5w")</p>


<p class=Code>Else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Response.Redirect("Page2.a5w")</p>


<p class=Code>End If</td></tr>
</table>

<p class=A5><a name=Activate_Events>Activate Events</a></p>



<p>The <span class=Code1>Activate</span> event fires every time the form 
 is run. It fires after the <span class=Code1>Validate</span> and <span 
 class=Code1>AfterValidate</span> events.</p>



<p>A typical use of the <span class=Code1>Activate</span> event is used 
 to populate drop down list boxes on the form.</p>



<p class=A5><a name=Declarations>Declarations</a></p>



<p>When you display the <span class=Screen>Form Events</span> dialog and 
 select "Declarations" from the <span class=Control>Event</span> 
 list box, you to define any User Defined Functions that you want to be 
 available to all Xbasic event code.</p>



<p><span class=Note><img src="images/icon_warning.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 37px;
								height: 33px;
								float: none;
								border-style: none;
								border-style: none;"
						width=37
						height=33
						border=0>Note</span> : You can also define functions 
 in the code for each event handler, but these functions are local to the 
 particular event handler.</p>



<p class=A5>See Also</p>



<p><a href="../References/Web/Web Publishing/Creating a Grid Component.html" title="Creating a Grid Component" class="wiki">Creating a Grid Component</a></p>




<p class=A5>Limitations</p>



<p>Web publishing applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Writing+Server+Event+Scripts">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/","status":"pending","tags":"web","keywords":"server,guide"} --->
</body></html>