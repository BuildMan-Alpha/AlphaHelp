	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Using Xbasic to Read and Write to a Table</p>



<p>The new Alpha Five developer eventually comes to the point where he 
 or she would like to write a script that directly reads from and writes 
 to a table. This topic provides a couple of simple examples that you can 
 elaborate upon. The are based on the Customer table in the AlphaSports 
 sample database.</p>



<p class=A5><a name=Script_or_Function_>Script or Function?</a></p>



<p>Perhaps the first question you will ask is: "Should this be a script 
 or a function?". There is little difference in the Xbasic coding 
 between the two alternatives. The determining issue is whether you want 
 to return a value. Functions can return values. Scripts cannot return 
 values, except by setting the value(s) of global variable(s), and this 
 is often considered a sloppy and potentially troublesome programming practice.</p>



<p class=A5><a name=How_Do_I_Call_a_Script_or_Function_>How Do I Call a 
 Script or Function?</a></p>



<p>Calling a function is&nbsp;as&nbsp;easy&nbsp;as&nbsp;naming it and catching 
 the return value, if any. This example returns a value from the <span 
 class=Code1>find_last_name()</span> function:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim return_value&nbsp;as&nbsp;C</p>


<p class=Code>... some code</p>


<p class=Code>return_value = find_last_name()</p>


<p class=Code>... some code</td></tr>
</table>

<p>Or, if the <span class=Code1>find_last_name()</span> function required 
 a parameter, you might write something like this:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim return_value&nbsp;as&nbsp;C</p>


<p class=Code>... some code</p>


<p class=Code>return_value = find_last_name("Michael")</p>


<p class=Code>... some code</td></tr>
</table>

<p>If the <span class=Code1>find_last_name()</span> function did not return 
 a value, the syntax would simply be:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>... some code</p>


<p class=Code>find_last_name()</p>


<p class=Code>... some code</td></tr>
</table>

<p>Calling a script named <span class=Code1>find_first_name</span> is just&nbsp;as&nbsp;easy:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>... some code</p>


<p class=Code>script_play("find_first_name")</p>


<p class=Code>... some code</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Function names 
 always have parentheses in their names. Scripts do not.</p>



<p class=A5><a name=Sequencing_Through_the_Records_of_a_Table>Sequencing 
 Through the Records of a Table</a></p>



<p>The following is the beginning of a <span class=Bolded>script</span> 
 that reads and writes to the <span class=Code1>customer</span> table. 
 This script does not require that the <span class=Code1>customer</span> 
 table be open in a layout. First, create a table object named <span class=Code1>tbl</span> 
 (any <a href="../Orphans/Declaring a Variable.html#Legal_Variable_Names" title="Declaring a Variable" class="wiki">variable   name</a> that is not a <a href="Reserved Words.html" title="Reserved Words" class="wiki">reserved   word</a> will do).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.open("customer")</td></tr>
</table>

<p>Now read the first record.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. table.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' 
 ... do something</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p>Keep reading until you reach the end of the file.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. table.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' 
 ... do something</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>

<p>Now, close the table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Reading_a_Field_Value>Reading a Field Value</a></p>



<p>Reading a field value is&nbsp;as&nbsp;simple&nbsp;as&nbsp;referencing 
 <span class=Argument>table_object.field_name</span>. In the following 
 script the variable <span class=Code1>ln</span> always contains the value 
 of the <span class=Code1>lastname</span> field in the current record:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim ln&nbsp;as&nbsp;C</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. table.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ln 
 = tbl.lastname</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Writing_a_Field_Value>Writing a Field Value</a></p>



<p>Writing a changed field value in a record requires two more statements. 
 Suppose you wanted to make sure that the <span class=Code1>lastname</span> 
 field had an initial capital letter.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim ln&nbsp;as&nbsp;C</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. table.fetch_eof()</td></tr>
</table>

<p>The <span class=Code1>tbl.change_begin(.t.)</span> statement says that 
 you are changing an existing field and that you want to honor any existing 
 field rules.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.lastname 
 = f_upper(tbl.lastname)</td></tr>
</table>

<p>The <span class=Code1>tbl.change_end(.t.)</span> statement says that 
 you are finished changing an existing field and want to save the changes.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Deleting_a_Record>Deleting a Record</a></p>



<p>The process of deleting a record is similar to changing a record. First, 
 you need to use one of many techniques for finding the record you are 
 going to delete.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim ln&nbsp;as&nbsp;C</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. table.fetch_eof()</td></tr>
</table>

<p>This script tests the values of the <span class=Code1>firstname</span> 
 and <span class=Code1>lastname</span> fields, and only deletes specific 
 records.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 (tbl.lastname = "Smith") .and. (tbl.firstname = "John") 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.delete()</td></tr>
</table>

<p>The <span class=Code1>tbl.change_end(.t.)</span> statement says that 
 you are want to delete the record.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Adding_a_Record>Adding a Record</a></p>



<p>Adding a record is simple. You bracket your field updates with the <span 
 class=Code1>tbl.enter_begin()</span> and <span class=Code1>tbl.enter_end()</span> 
 statements.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>tbl.enter_begin()</td></tr>
</table>

<p>The <span class=Code1>tbl.enter_begin(.t.)</span> statement says that 
 you are adding a existing field to the end of the table and that you want 
 to honor any existing field rules.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.firstname = "George"</p>


<p class=Code>tbl.lastname = "Washington"</td></tr>
</table>

<p>The <span class=Code1>tbl.enter_end(.t.)</span> statement says that 
 you are finished adding a record and want to save the changes.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.enter_end(.t.)</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p class=A5><a name=Selecting_a_Subset_of_Records_with_a_Query>Selecting 
 a Subset of Records with a Query</a></p>



<p>In each of the examples above, the code opened the customer table and 
 sequenced through all of its records. Suppose you wanted only to sequence 
 through the records when the <span class=Code1>bill_state_region</span> 
 field contained the value "MA". Instead of writing this code 
 at the beginning of the script:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.open("customer")</td></tr>
</table>

<p>you would write:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim qry&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.open("customer")</p>


<p class=Code>query.filter = "bill_state_region = 'MA'"</p>


<p class=Code>qry = tbl.query_create()</p>


<p class=Code>... add, change, or delete ...</td></tr>
</table>

<p>Finish the script or function by detaching the query and closing the 
 table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl.query_detach()</p>


<p class=Code>tbl.close()</td></tr>
</table>

<p>Now, you will sequence through only those customers in the state of 
 Massachusetts.</p>



<p class=A5>See Also</p>



<p><a href="../References/Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="../References/Xbasic/Xbasic Reference/Overview__COLON__ Functions and Expressions.html" title="Overview: Functions and Expressions" class="wiki">Overview: Functions and Expressions</a></p>



	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Xbasic+to+Read+and+Write+to+a+Table">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/Xbasic/","status":"pending","tags":"common,review","notes":"A5","keywords":"guide,xbasic,rules"} --->
</body></html>