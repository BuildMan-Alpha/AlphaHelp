	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Querying and Sorting Child Tables on a Form</p>



<p>Assume you have a set with a one-many link,&nbsp;as&nbsp;shown below: 
 </p>



<p class=Pix><img src="images/Set_Diagram_3.gif"
					x-maintain-ratio=TRUE
					style="width: 256px;
							height: 144px;
							float: none;
							border-style: none;
							border-style: none;"
					width=256
					height=144
					border=0>.</p>



<p>On a form, you would typically display the data from the <span class=Code1>Donations</span> 
 table in an embedded browse. This section discusses how you can perform 
 dynamic queries and sorts on the data that is displayed in the form's 
 embedded browse.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Contrast the 
 discussion here with setting the <span class=Code1>filter_expression</span> 
 and <span class=Code1>order_expression</span> properties for tables when 
 you design a form (by selecting the <span class=Button>Form > Properties</span> 
 command). If you specify a filter for a table&nbsp;as&nbsp;Part of the 
 form's properties, that filter will be replaced by the filter you define 
 dynamically using the techniques described in this section.</p>



<p>Assume that you would like to put a button on the form to allow the 
 user to filter out donations made before a certain date.</p>



<p>Here is how to do it.</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Place a variable 
 called <span class=Code1>startDate</span> on the form. Make the variable's 
 type "Date" and make its scope "Session" (which is 
 the same&nbsp;as&nbsp;"Shared").</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Put three buttons 
 on the form and label the buttons "Query Donations", "Show 
 all Donations" and "Sort by Amount".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 "Query Donations" button, and assign this Xbasic code to the 
 button's <span class=Code1>OnPush</span> event:</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim shared startDate&nbsp;as&nbsp;D</p>


<p class=Code>'Store the current record number for the parent table.</p>


<p class=Code>'We do this because after Alpha Five queries the child table</p>


<p class=Code>'it resynchronizes itself to the first parent record.</p>


<p class=Code>'Our script will keep the focus on the parent record that 
 was</p>


<p class=Code>'current when you press the Query Donations button.</p>


<p class=Code>rec = parentform:tables:invoice_header.recno()</p>


<p class=Code>'Set the filter expression for the child (Donations) table</p>


<p class=Code>parentform:tables:donations.filter_expression = " Donation_date 
 > = var->startDate"</p>


<p class=Code>'Run the query on the Donations table</p>


<p class=Code>parentform:tables:donations.query()</p>


<p class=Code>'Go back to the parent table (Members) that had focus</p>


<p class=Code>parentform:Tables:members.Fetch_Goto(rec)</p>


<p class=Code>'Resynchronize the form to display this record</p>


<p class=Code>parentform.resynch()</td></tr>
</table>

<ol start=4>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 <span class=Button>Show All Donations</span> button, and assign this Xbasic 
 code to the button's <span class=Code1>OnPush</span> event:</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rec = parentform:tables:invoice_header.recno()</p>


<p class=Code>'Set the filter expression to .T. to show all records.</p>


<p class=Code>parentform:tables:donations.filter_expression = ".T."</p>


<p class=Code>parentform:tables:donations.query()</p>


<p class=Code>parentform:Tables:members.Fetch_Goto(rec)</p>


<p class=Code>parentform.resynch()</td></tr>
</table>

<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 <span class=Button>Sort by Amount</span> button, and assign this Xbasic 
 code to the button's <span class=Code1>OnPush</span> event:</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rec = parentform:tables:invoice_header.recno()</p>


<p class=Code>'Set the order expression to "amount" parentform:tables:donations.order_expression 
 = "amount"</p>


<p class=Code>parentform:tables:donations.query()</p>


<p class=Code>parentform:Tables:members.Fetch_Goto(rec)</p>


<p class=Code>parentform.resynch()</td></tr>
</table>

<p>Here is another way to sort the embedded browse using form methods, 
 rather that low level table methods. This example gives focus to the embedded 
 browse's "Amount" column and then does a <a href="../References/Methods/OBJECT.QUICK_SORT Method.html" title="OBJECT.QUICK_SORT Method" class="wiki">&lt;BROWSE&gt;.QUICK_SORT(</a>). 
 The example assumes that the embedded browse object on the form is called 
 "Browse1".</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>parentform:Browse1:amount.Activate()</p>


<p class=Code>parentform:Browse1.quick_sort()</td></tr>
</table>

<p>The advantage of using a high level form method (i.e. the <a href="../References/Methods/OBJECT.QUICK_SORT Method.html" title="OBJECT.QUICK_SORT Method" class="wiki">&lt;FORM&gt;.QUICK_SORT(</a>) 
 method) to perform the sort, is that you do not need to re-synchronize 
 the form. The focus stays on the current parent record. However, you cannot 
 sort using an arbitrarily complex order expression.</p>



<p class=A5>See Also</p>



<p><a href="../References/Functions/Query Functions and Methods.html" title="Query Functions and Methods" class="wiki">Query Functions and   Methods</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Querying+and+Sorting+Child+Tables+on+a+Form">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending","keywords":"desktop,guide,xbasic,form"} --->
</body></html>