	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Writing Dialog Event Scripts</p>



<p>Form event scripts provide an opportunity to respond to or process the 
 input from a dialog (form) web component. You can run scripts when the 
 following events occur.</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>OnClick - Available only 
 for AdvancedButton objects. The <span class=Code1>OnClick</span> script 
 runs every time the button is clicked.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Initialize - The <span 
 class=Code1>Initialize</span> event fires once, the first time the Form 
 is run.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Validate - The <span class=Code1>Validate</span> 
 event fires when a form is submitted.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>AfterValidate - The <span 
 class=Code1>AfterValidate</span> event fires after the <span class=Code1>Validate</span> 
 event.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Activate - The <span class=Code1>Activate</span> 
 event fires every time the form is run.</p>

</li>
</ul>

<p class=A5><a name=Initialize_Events>Initialize Events</a></p>



<p>The <span class=Code1>Initialize</span> event fires once, the first 
 time the form is run. If the form is submitted back to itself (as is typically 
 the case, so that the values in the Form's controls can be validated), 
 the Initialize event is not fired.</p>



<p>The <span class=Code1>Initialize</span> event is typically used to set 
 initial values for controls on the Form.</p>



<p>If you need to execute code every time the Form is run, use the <span 
 class=Code1>Activate</span> event.</p>



<p class=A5><a name=Validate_Events>Validate Events</a></p>



<p>The <span class=Code1>Validate</span> event fires when a form is submitted. 
 Use this event to check that the value in a control is valid. If your 
 script determines that an error has occurred, then you should set the 
 following object properties:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>CurrentControl.Has_Error = .t.</p>


<p class=Code>CurrentControl.Error_Message = "<Your error message>"</td></tr>
</table>

<p>You can also use this syntax:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>CurrentForm.Controls.<controlName>.Has_Error = .t.</p>


<p class=Code>CurrentForm.Controls.<controlName>.Error_Message = 
 "<Your error message>"</td></tr>
</table>

<p>If the <span class=Code1>CurrentControl.Has_Error</span> property is 
 ".T.", then the form will be redisplayed with the error message 
 shown at the top of the form. The user can then make corrections and resubmit 
 the form.</p>



<p class=A5><a name=AfterValidate_Events>AfterValidate Events</a></p>



<p>The <span class=Code1>AfterValidate</span> event fires after the <span 
 class=Code1>Validate</span> event, but only if no object on the form has 
 had its <span class=Code1>.Has_Error</span> property set to ".T.".</p>



<p>A typical use of the <span class=Code1>AfterValidate</span> event is 
 to redirect control to another page in the application.</p>



<p>For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>If Condition1 = .t. Then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Response.Redirect("Page1.a5w")</p>


<p class=Code>Else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Response.Redirect("Page2.a5w")</p>


<p class=Code>End If</td></tr>
</table>

<p class=A5><a name=Activate_Events>Activate Events</a></p>



<p>The <span class=Code1>Activate</span> event fires every time the form 
 is run. It fires after the <span class=Code1>Validate</span> and <span 
 class=Code1>AfterValidate</span> events.</p>



<p>A typical use of the <span class=Code1>Activate</span> event is to programatically 
 populate drop down list boxes on the Form.</p>



<p class=A5><a name=Declarations>Declarations</a></p>



<p>When you display the <span class=Screen>Form Events</span> dialog and 
 select "Declarations" from the <span class=Control>Event</span> 
 list box, you to define any User Defined Functions that you want to be 
 available to all Xbasic event code.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Use the declarations 
 section to define functions that you want to use in the event handlers.</p>



<p class=A5><a name=Redirecting_to_a_Different_Page>Redirecting to a Different 
 Page</a></p>



<p>In a dialog component, you place the code that will redirect to another 
 page in the <span class=Code1>AfterValidate</span> event. If the user 
 has selected the destination from a DropDownBox, the name you assigned 
 to the DropDownBox control is the name of the variable that contains the 
 value. <br>
<br>
You cannot use SYS_OPEN()in an event because it will hang the <span class=Screen>Application 
 Server</span>. You cannot use any Xbasic in an event that results in user 
 interface being displayed. <br>
<br>
Assume that the control's name was <span class=Code1>menuselect</span> 
 and that the entry that is associated with the URL was " <span class=Code1>assi</span> 
 ". Assume that the URL was " <span class=Code1>http://www.nksoa.org/ftp/assignhelp/assignhelp.html</span> 
 ". In your <span class=Code1>AfterValidate</span> event you would 
 put something like the following:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>IF substr(menuselect,1,4) = "assi" <br>
URL_var = "http://www.nksoa.org/ftp/assignhelp/assignhelp.html" 
 <br>
response.redirect(URL_var) <br>
end if</td></tr>
</table>

<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, select 
 a different event to respond to from the <span class=Control>Event</span> 
 drop-down list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Write your Xbasic 
 script.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, click 
 <span class=Button>Insert</span> and select a menu entry to insert code 
 into your script. The options are:</p>

</li>
</ol>


<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 33.333%;">
<col style="width: 6.875%;">
<col style="width: 49.167%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableHead>Property</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableHeadCenter>Type</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm</td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>An alias for the current web component dialog.</p>


<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Grid components 
 use the <a href="../References/Web/Web Publishing/Using Grid Events.html" title="Using Grid Events" class="wiki">DataSubmitted</a> alias.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Has_Error</td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>L</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>Sets the error status of the current web component dialog.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Error_Message</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>The error message to display.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.RedirectTarget</td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>This property allows you to specify the next page to 
 display.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.InitialExecution</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>L</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>This is a readonly variable. It is .T. if the form is 
 executing for first time. If the form has been submitted back to itself, 
 then it will be .F. .</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Controls . <span class=Argument>ControlName</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>The name of a control.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Controls . <span class=Argument>ControlName.Value</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>The value in a control.</p>


<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Using only <span 
 class=Argument>ControlName</span> also returns the control's value.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Controls . <span class=Argument>ControlName.Property</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>The name of one of the control's properties.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Controls . <span class=Argument>ControlName</span>.Has_Error</td>
<td class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>L</td>
<td class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>Sets the error status of the named control.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 33.333%;" valign="top" width="33.333%">
<p class=TableLeft>CurrentForm.Controls . <span class=Argument>ControlName</span>.Error_Message</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.875%;" valign="top" width="6.875%">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 49.167%;" valign="top" width="49.167%">
<p class=TableLeft>The error message to display for the named control.</td></tr>
</table>

<p class=A5><a name=Print_Report_Genie>Print Report Genie</a></p>



<p>The <span class=Screen>Print Report Genie</span> generates Xbasic code 
 for the <span class=Code1>AfterValidate</span> event of dialog components. 
 However, you can use this genie to generate Xbasic code, which you can 
 copy for use on A5W pages.</p>



<p>To use the <span class=Screen>Print Report Genie</span> :</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>From the <span class=Screen>Web 
 Projects Control Panel</span> open a dialog component in the <span class=Screen>Dialog 
 Component Builder</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Form > Properties</span> page.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Server 
 Events > AfterValidate</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Insert 
 > Genies > Print Report</span> to display the <span class=Screen>Print 
 Report Genie</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/List_Button_Blue_Down.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> in the <span class=Control>Report Name</span> list to select 
 a previously created Alpha Five report from your database.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a <span class=Control>Filter 
 Expression</span>. To select all records enter <span class=Code1>.T.</span> 
 .</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, enter 
 an <span class=Control>Order Expression</span>. Click <img src="images/List_Button_Blue_Down.gif"
															x-maintain-ratio=TRUE
															style="border: none;
	width: 22px;
	height: 22px;
	float: none;
	border-style: none;
	border-style: none;"
															width=22
															height=22
															border=0> to 
 use the <a href="Order Builder.html" title="Order Builder" class="wiki">&lt;span class=Screen&gt;Order   Builder&lt;/span&gt;</a>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a comma delimited 
 list of all variables that you use in the filter expression into the <span 
 class=Control>Variables Referenced</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span>. 
 </p>

</li>
</ol>

<p class=Pix><img src="images/WP_Print_Report_Genie.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 650px;
							height: 417px;
							float: none;
							border-style: none;
							border-style: none;"
					width=650
					height=417
					border=0></p>



<p>The screen shown above inserts the code shown below. Note how the script 
 places the PDF report in the session_folder with a default name of "tempreport.pdf" 
 and then prints it. If you wish, you can modify this code. For more information 
 see <a href="../References/Methods/OBJECT.SAVEAS Method.html" title="OBJECT.SAVEAS Method" class="wiki">REPORT.SAVEAS(</a>).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>IF eval_valid("lastname") = .f. Then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;goto skipreport</p>


<p class=Code>end if</p>


<p class=Code>dim filter&nbsp;as&nbsp;c</p>


<p class=Code>dim order&nbsp;as&nbsp;c</p>


<p class=Code>Filter = lastname > 'M'</p>


<p class=Code>Order = "firstname"</p>


<p class=Code>Dim filename&nbsp;as&nbsp;c</p>


<p class=Code>filename = session.session_folder + chr(92) + "tempreport.pdf"</p>


<p class=Code>filename = report.saveas("Customer List@<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer.ddd","pdf",filter,order,filename,.f.)</p>


<p class=Code>if file.exists(filename)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentform.RedirectTarget = session.session_url 
 + "tempreport.pdf?" +time("hms3")</p>


<p class=Code>end if</p>


<p class=Code>skipreport:</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="Writing Server Event Scripts.html" title="Writing Server Event Scripts" class="wiki">Writing Server Event Scripts</a>, 
 <a href="../References/Web/Web Publishing/Creating Dialog Components.html" title="Creating Dialog Components" class="wiki">Creating Dialog Components</a>, 
 <a href="Setting Dialog Properties.html" title="Setting Dialog Properties" class="wiki">Setting Dialog Properties</a></p>



<p class=A5>Limitations</p>



<p>Web publishing applications only.</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Writing+Dialog+Event+Scripts">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>