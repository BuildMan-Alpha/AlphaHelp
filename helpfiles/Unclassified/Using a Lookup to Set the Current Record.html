	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using a Lookup to Set the Current Record</p>



<p>This topic describes how to use a table lookup to set the current record. 
 The example is based on the <span class=Code1>Customer</span> table of 
 the AlphaSports sample database.</p>



<p>The following form shows the <span class=Code1>Firstname</span>, <span 
 class=Code1>Lastname</span>, <span class=Code1>Company</span>, and <span 
 class=Code1>Phone</span> fields from the <span class=Code1>Customer</span> 
 table. In addition, there is a drop down combo box with the label "Lookup". 
 The <span class=Code1>lookup</span> field displays unique field values 
 from the <span class=Code1>Phone</span> field. When you select a phone 
 number if the <span class=Code1>lookup</span> field, the other controls 
 on the form update automatically to show fields from the same record. 
 </p>



<p class=Pix><img src="images/XB_Sync_Record_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 435px;
							height: 256px;
							float: none;
							border-style: none;
							border-style: none;"
					width=435
					height=256
					border=0></p>



<p>To create a similar capability:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Form 
 Editor</span> click <img src="images/Variables_button.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 22px;
									height: 22px;
									float: none;
									border-style: none;
									border-style: none;"
							width=22
							height=22
							border=0> to display the <span class=Screen>Variable 
 Definition</span> dialog. Create a numeric variable named <span class=Code1>current</span> 
 and click <span class=Button>OK</span> to save your input. </p>

</li>
</ol>

<p class=Pix><img src="images/XB_Sync_Record_3.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 453px;
							height: 210px;
							float: none;
							border-style: none;
							border-style: none;"
					width=453
					height=210
					border=0></p>



<ol start=2
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Drag the <span class=Code1>current</span> 
 variable from the <span class=Screen>Drag Drop List</span> onto the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the new 
 control and select <span class=Button>Properties...</span> .</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Setup</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Change the <span 
 class=Control>Field-Type</span> to "Combo Box". </p>

</li>
</ol>

<p class=Pix><img src="images/XB_Sync_Record_4.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 436px;
							height: 187px;
							float: none;
							border-style: none;
							border-style: none;"
					width=436
					height=187
					border=0></p>



<ol start=6
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Choices</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Change the <span 
 class=Control>Choices for control are</span> to "Computed Automatically".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Values 
 from a table/set" in the <span class=Control>Source</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "<Current 
 Table>" in the <span class=Control>From Table</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter <span class=Code1>phone 
 + "|" + customer_id</span> in the <span class=Control>Field/expression 
 values to display</span> control.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : This expression 
 causes the control to display the <span class=Code1>phone</span> field 
 but return the value in the <span class=Code1>customer_id</span> field.</p>



<ol start=11
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter <span class=Code1>phone</span> 
 in the <span class=Control>Display order</span> control.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Check <span class=Button>Display 
 only unique keys</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 to return to the <span class=Screen>Form Editor</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/XB_Sync_Record_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 436px;
							height: 407px;
							float: none;
							border-style: none;
							border-style: none;"
					width=436
					height=407
					border=0></p>



<ol start=14
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the new 
 control and select <span class=Button>Events > OnChange</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 Xbasic code. This code reads the <span class=Code1>customer_id</span> 
 value in the <span class=Code1>current</span> variable, finds the matching 
 record, reads that record, and then refreshes the form to show the new 
 values.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim id&nbsp;as&nbsp;C</p>


<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>tbl.fetch_goto(current)</p>


<p class=Code>parentform.resynch()</td></tr>
</table>

<ol start=16
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Save_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> and return to the <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Form 
 Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Tables/Sets</span> tab of the <span class=Screen>Control 
 Panel</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <span 
 class=Code1>Customer</span> table and select <span class=Button>Design 
 > Indexes</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create an index for 
 the <span class=Code1>customer_id</span> field. </p>

</li>
</ol>

<p class=Pix><img src="images/XB_Sync_Record_5.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 597px;
							height: 153px;
							float: none;
							border-style: none;
							border-style: none;"
					width=597
					height=153
					border=0></p>



<ol start=21
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Build...</span> 
 and <span class=Button>Close</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>View your form. Now, 
 when you select a phone number in the lookup control, the other fields 
 displayed on the form will be from the same record.</p>

</li>
</ol>

<p class=A5>See Also</p>



<p><a href="../References/Methods/TABLE.CURRENT Method.html" title="TABLE.CURRENT Method" class="wiki">TABLE.CURRENT(</a>), <a href="../References/Methods/TBL.FETCH_GOTO Method.html" title="TBL.FETCH_GOTO Method" class="wiki">&lt;TBL&gt;.FETCH_GOTO(</a>), 
 <a href="../References/Methods/OBJECT.RESYNCH Method.html" title="OBJECT.RESYNCH Method" class="wiki">&lt;OBJECT&gt;.RESYNCH(</a>)</p>


	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+a+Lookup+to+Set+the+Current+Record">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guides","status":"pending"} --->
</body></html>