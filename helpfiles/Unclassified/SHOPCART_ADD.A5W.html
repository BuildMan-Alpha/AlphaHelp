	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>SHOPCART_ADD.A5W</p>
<p class=A5>Purpose</p>
<p>The SHOPCART_ADD.A5W page displays in a popup window to confirm that 
 the customer has added an item to the shopping cart.</p>
<p class=A5>Description</p>
<p>Nearly all of the HTML on this page is returned from a shopping cart 
 function. This function takes various values and parameters and builds 
 the correct HTML to display.</p>

<p>A script may open this page&nbsp;as&nbsp;a popup from a button or link, 
 or embed it on another page. It is not necessary to test for logon. However, 
 the values are retrieved to properly test for an existing shopping cart.</p>

<p class=A5>Links</p>



<p>The <a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/Adding an Item to the Shopping Cart.html#SHOPCART_JS" title="Adding an Item to the Shopping Cart" class="wiki">SHOPCART.JS</a> 
 script calls the SHOPCART_ADD.A5W page.</p>



<p class=A5>Page Source</p>



<p>The <span class=Code1>a5w_include("loggedinvalues.a5w")</span> statement runs the code on the <a href="../Orphans/LOGGEDINVALUES.A5W.html" title="LOGGEDINVALUES.A5W" class="wiki">LOGGEDINVALUES.A5W</a> 
 page. This page creates and sets the values of <span class="Code1">session.<strong>protected</strong>pUser.userid, session.<strong>protected</strong>pUser.type</span>,  and <span class="Code1">session.<strong>protected</strong>pUser.name</span>. These values are used by the functions in on <a href="SHOPCART_UDF.A5W.html" title="SHOPCART_UDF.A5W" class="wiki">SHOPCART_UDF</a><a href="SHOPCART.A5W.html" title="SHOPCART.A5W" class="wiki">SHOPCART.A5W</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5w_include("<span class="Code1">loggedinvalues</span>.a5w")</td></tr>
</table>

<p>The <span class=Code1>cart_id</span> value is unique for each browser 
 session and identifies the current instance of the open browser. This 
 is different from <span class=Code1>session.sessionID</span>, which is 
 same for every browser session from the same computer. If the <span class=Code1>cart_id</span> 
 variable does not exist or its value is NULL, the <a href="../References/Functions/API_UUIDCREATE Function.html" title="API_UUIDCREATE Function" class="wiki">API_UUIDCREATE(</a>) 
 function generates a unique number to identify the cart (or order). The 
 <a href="../References/Methods/RESPONSE.ADD_COOKIE Method.html" title="RESPONSE.ADD_COOKIE Method" class="wiki">RESPONSE.ADD_COOKIE(</a>) 
 saves this value in a cookie.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("cart_id") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cart_id 
 = api_uuidcreate()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.add_cookie("cart_id", 
 cart_id, 0)</p>


<p class=Code>elseif cart_id = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cart_id 
 = api_uuidcreate()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.add_cookie("cart_id", 
 cart_id, 0)</p>


<p class=Code>end if</td></tr>
</table>

<p><span class=Code1>pgstyle</span> is used to apply a consistent style 
 to different elements of the page.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>pgstyle = "shopcart"</td></tr>
</table>

<p>Next, the page script runs <span class=Code1>shopcart_chk()</span> to 
 test if old shopping cart data exists. This function will return <span 
 class=Code1>shopcart_chk.html</span>, which will be NULL if there is no 
 old cart. <span class=Code1>shopcart_chk()</span> is located on <a href="SHOPCART_UDF.A5W.html" title="SHOPCART_UDF.A5W" class="wiki">SHOPCART_UDF</a><a href="SHOPCART.A5W.html" title="SHOPCART.A5W" class="wiki">SHOPCART.A5W</a>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5w_include("shopcart_UDF.a5w")</td></tr>
</table>

<p>The following code defines the variables required for the call to <span 
 class=Code1>shopcart_chk()</span>.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>request.variables.cart_id = cart_id</p>


<p class=Code>dim cartparms&nbsp;as&nbsp;P</p>


<p class=Code>cartparms.style_name = pgstyle</p>


<p class=Code>cartparms.DBF.table_name = "<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\shop_cart.dbf"</p>


<p class=Code>cartparms.product_table = "<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\product.dbf"</p>


<p class=Code>cartparms.product_table_display_fld = "description"</p>


<p class=Code>cartparms.product_table_id_fld = "Product_Id"</p>


<p class=Code>cartparms.owner_Id = loginid</p>


<p class=Code>cartparms.user_type = logintype</p>


<p class=Code>cartparms.session = session</p>


<p class=Code>cartparms.request = request</p>


<p class=Code>cartparms.response = response</p>


<p class=Code>cartparms.popup = 1 ' opened&nbsp;as&nbsp;popup</p>


<p class=Code>cartparms.RedirectURL = "index.a5w"</p>


<p class=Code>cartparms.product_id = ""</p>


<p class=Code>cartparms.quantity = 1</p>


<p class=Code>cartparms.input_value_missing = ""</p>


<p class=Code>cartparms.emptycart_message = .F. ' no message for empty 
 cart</p>


<p class=Code>if eval_valid("pid") = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cartparms.product_id 
 = pid</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 cartparms.product_id = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cartparms.input_value_missing 
 = "Product ID"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cartparms.input_value_missing 
 = "pid" ' value parameter not passed to page</p>


<p class=Code>end if</td></tr>
</table>

<p>If <span class=Code1>tmpl_cart.RedirectURL</span> is not NULL, the page 
 redirects to that URL.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim tmpl_cart&nbsp;as&nbsp;p</p>


<p class=Code>tmpl_cart = shopcart_chk(cartparms)</p>


<p class=Code>if tmpl_cart.RedirectURL &lt> "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect(tmpl_cart.redirectURL)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</td></tr>
</table>

<p>If <span class=Code1>tmpl_cart.html</span> is NULL, the script creates 
 a new cart with <span class=Code1>shopcart_add()</span>. The JavaScript may have passed a <span class="Code1">quantity</span> value. If a value is passed, it is verified to be a number. If no value is present, the default of 1 set previously is used. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if tmpl_cart.html = ""</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if eval_valid("request.variables.quan") = .T. ' check for valid numeric values if passed by JavaScript
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if isnumber(request.variables.quan) = .T.
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cartparms.quantity = val(request.variables.quan)
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if 
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if 

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tmpl_cart 
 = shopcart_add(cartparms)</p>


<p class=Code>end if</td></tr>
</table>

<p>The HTML data is placed into the <span class=Code1>html_body</span> 
 variable.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>html_body = tmpl_cart.html</td></tr>
</table>

<p>Finally, the page appears with the HTML code formatted with the <span 
 class=Code1>pgstyle</span> style.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1>&lthtml></span></p>


<p class=Code><span class=HTML1>&lthead></span></p>


<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha 
 Five HTML Editor"></span></p>


<p class=Code><span class=HTML1>&lttitle>Shopping Cart&nbsp;..........&lt/title></span></p>


<p class=Code><span class=HTML1>&ltlink rel="stylesheet" type="text/css" 
 href="css/&lt%a5 ?pgstyle %>/style.css"></span></p>


<p class=Code><span class=HTML1>&lt/head></span></p>


<p class=Code><span class=HTML1>&ltbody class="</span> &lt%a5 ? 
 pgstyle %> <span class=HTML1>PageBODY" on<x>load="window.resizeTo(document.getElementById('add_cart').offsetWidth+40, 
 document.getElementById('add_cart').offsetHeight+60)" style="margin:0px; 
 overflow: hidden;"></span></p>


<p class=Code>&lt%a5 ? html_body %> <span class=HTML1>&ltbr></span></p>


<p class=Code><span class=HTML1>&lt/body></span></p>


<p class=Code><span class=HTML1>&lt/html></span></td></tr>
</table>

<p class=A5>Page Security Information</p>



<p>Always Allowed</p>



<p class=A5>See Also</p>



<p><a href="../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/AlphaSportsWeb Web Pages.html" title="AlphaSportsWeb Web Pages" class="wiki">Web Pages</a></p>


	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SHOPCART_ADD.A5W">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/References/Server/Pages"} --->
</body></html>