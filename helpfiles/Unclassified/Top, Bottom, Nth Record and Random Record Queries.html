	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Top, Bottom, Nth Record and Random Record Queries </p>



<p>When Alpha Five performs a query, sometimes you are only interested 
 in the top or bottom x records in query. For example you may have a query 
 that selects all donors who have given more than $1,000, sorted by size 
 of donation. Perhaps you only want to see the 10 biggest donors.</p>



<p>Alpha Five has several functions designed to extract the top or bottom 
 records from a query. It also has a function designed to extract every 
 Nth record from a query. This is useful in certain mailing list applications 
 where you want to mail to a subset of your list. Finally, Alpha Five has 
 functions that allow you to select records at random from a table.</p>




<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 26.893%;">
<col style="width: 73.107%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableHead>Function</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/BOTTOM_PERCENT_RECORDS Function.html" title="BOTTOM_PERCENT_RECORDS Function" class="wiki">BOTTOM_PERCENT_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Returns the bottom <span class=Argument>Percent</span> 
 of records in a table for a given sort order.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/BOTTOM_RECORDS Function.html" title="BOTTOM_RECORDS Function" class="wiki">BOTTOM_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects the bottom X% of the records in a table, for 
 a given sort order.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/RANDOM_PERCENT_RECORDS Function.html" title="RANDOM_PERCENT_RECORDS Function" class="wiki">RANDOM_PERCENT_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects X% of the records in a table at random. If the 
 optional filter is supplied, the records are selected only from those 
 that satisfy the filter.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/RANDOM_RECORDS Function.html" title="RANDOM_RECORDS Function" class="wiki">RANDOM_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects count records at random from a table. If the 
 optional filter is supplied, the records are selected only from those 
 that satisfy the filter.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/SAMPLE_RECORDS Function.html" title="SAMPLE_RECORDS Function" class="wiki">SAMPLE_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects every Nth record in a table, for a given sort 
 order.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/TOP_PERCENT_RECORDS Function.html" title="TOP_PERCENT_RECORDS Function" class="wiki">TOP_PERCENT_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects the top X% of the records in a table, for a 
 given sort order. (Percent is expressed&nbsp;as&nbsp;a whole number, e.g. 
 50 for 50%).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 26.893%;" valign="top" width="26.893%">
<p class=TableLeft><a href="../References/Functions/TOP_RECORDS Function.html" title="TOP_RECORDS Function" class="wiki">TOP_RECORDS(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 73.107%;" valign="top" width="73.107%">
<p class=TableLeft>Selects the top count records in a table, for a given 
 sort order. If the optional filter is supplied, only records that satisfy 
 the filter are returned. The table's sort order is determined by the query's 
 Order parameter.</td></tr>
</table>

<p class=A5>Examples</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : All of the following 
 examples are assumed to be scripts that are attached to buttons on a form. 
 The following query returns the 100 biggest donors.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.current()</p>


<p class=Code>query.filter = "top_records(100)"</p>


<p class=Code>query.order = "donation_size"</p>


<p class=Code>i = t.query_create()</p>


<p class=Code>topparent.resynch()'synchronize the form to show the query</td></tr>
</table>

<p>The following query returns the bottom 10 orders placed after May 1, 
 2000.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.current()</p>


<p class=Code>query.filter = "bottom_records(10, \"orderdate 
 > {5/1/2000}\")"</p>


<p class=Code>query.order = "order_total"</p>


<p class=Code>i = t.query_create()</p>


<p class=Code>topparent.resynch()</td></tr>
</table>

<p>The following query returns the top 10% of students in a school</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.current()</p>


<p class=Code>query.filter = "top_precent_records(10)"</p>


<p class=Code>query.order = "grade_point_average"</p>


<p class=Code>i = t.query_create()</p>


<p class=Code>topparent.resynch()</td></tr>
</table>

<p>The following query runs a saved query, but only shows the top 10 records 
 selected by the query. The saved query is called&nbsp;"Overdue_Accounts".</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.current()</p>


<p class=Code>query.filter = "top_records(10," + query_filter_get("overdue_accounts") 
 + ")"</p>


<p class=Code>query.order = ""</p>


<p class=Code>i = t.query_create()</p>


<p class=Code>topparent.resynch()</td></tr>
</table>

<p>The following query selects 10% of the records in table, for state of 
 MA.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>t = table.current()</p>


<p class=Code>query.filter = "random_percent_records(10,\"state 
 = 'ma' \")"</p>


<p class=Code>query.order = "rand()*100000"</p>


<p class=Code>i = t.query_create()</p>


<p class=Code>topparent.resynch()</td></tr>
</table>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Top%2C+Bottom%2C+Nth+Record+and+Random+Record+Queries">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>