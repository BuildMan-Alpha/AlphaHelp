	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Sorting a Grid on Multiple Fields</p>

<p>The default behavior of a grid component allows the user to sort on any column (or row) value by clicking the column (or row) header. What do you do when you want to sort on multiple fields? This example demonstrates a technique.</p>

<p>This page contains two components: a dialog with a drop down list box and a grid displaying fields from the <span class=Screen>AlphaSports</span> sample database. </p>

<p class=Pix><img src="images/WPT_Multi_Field_Sort.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 397px; height: 424px; border-style: none; border-style: none;" width=397 height=424 border=0></p>

<p>The drop down list box (named "Sort") on the dialog component contains a static list of choices ( <span class=Button>Controls > Sort > DropDownBox Properties > Choices</span> ).</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>First Name, Last Name</p>

<p class=Code>Last Name, City</p>

<p class=Code>City, Phone</td></tr> </table><p class=A5><a name=Creating_a_Session_Variable>Creating a Session Variable</a></p>

<p>Creating a session variable is a 2 step process. The <span class=Code1>AfterValidate</span> event ( <span class=Button>Properties > Server Events > After Validate</span> ) of the dialog contains the following code. This section of the code is step 1 of the process. It allows the <span class=Code1>session.multifield_sort</span> variable to be created by assigning it a value. Step 2 occurs <span class=Bolded>after</span> the user clicks the Submit button on the page and the dialog code executes <span class=Bolded>without error</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if eval_valid("CurrentForm.Controls.Sort")</p>

<p class=Code></p>

<p class=Code>if .not. eval_valid("session.multifield_sort") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;</p>

<p class=Code>session.multifield_sort = ""</p>

<p class=Code></p>

<p class=Code>end if</td></tr> </table><p>Next, the script scans through the same values that were stored in the drop down list box and sets <span class=Code1>session.multifield_sort</span> to a valid order expression. Here, you have to use real field names.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code></p>

<p class=Code>if CurrentForm.Controls.Sort = "First Name, Last Name" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;</p>

<p class=Code>session.multifield_sort = "firstname + lastname"</p>

<p class=Code></p>

<p class=Code>end if</p>

<p class=Code></p>

<p class=Code>if CurrentForm.Controls.Sort = "Last Name, City" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;</p>

<p class=Code>session.multifield_sort = "lastname + bill_city"</p>

<p class=Code></p>

<p class=Code>end if</p>

<p class=Code></p>

<p class=Code>if CurrentForm.Controls.Sort = "City, Phone" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;</p>

<p class=Code>session.multifield_sort = "bill_city + phone"</p>

<p class=Code></p>

<p class=Code>end if</p>

<p class=Code>end if</td></tr> </table><p>Place the dialog and grid components on the page. In the <span class=Screen>Source</span> tab of the <span class=Screen>HTML Editor</span> make sure that the dialog component code is before the grid component code in the page <span class=HTML1>&lthead></span>. This is different from the placement of the components&nbsp;as&nbsp;visible in the <span class=Screen>WYSIWYG</span> tab. Here you are looking at code that is in the <span class=HTML1>&ltbody></span> of the page.</p>

<p>The alias of the grid component is "Customer_sort". This is the default condition the grid component's override section in the page <span class=HTML1>&lthead></span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customer_sort</p>

<p class=Code></p>

<p class=Code>componentName = "Customer_sort"</p>

<p class=Code>end with</td></tr> </table><p>This modification checks to see if <span class=Code1>session.multifield_sort</span> exists. If it does exist, the script assigns the variable's value to the grid's <span class=Code1>dbf.order</span> property. When the page returns from the server the grid will display the new sort order.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>with tmpl_Customer_sort</p>

<p class=Code></p>

<p class=Code>componentName = "Customer_sort"</p>

<p class=Code></p>

<p class=Code>if eval_valid("session.multifield_sort") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;</p>

<p class=Code>dbf.order = session.multifield_sort</p>

<p class=Code></p>

<p class=Code>end if</p>

<p class=Code>end with</td></tr> </table><p class=A5>See Also</p>

<p><a href="../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Sorting+a+Grid+on+Multiple+Fields">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/Design/View/Grid/","status":"pending","tags":"web","keywords":"server,guide,grid,component"} --->
</body></html>