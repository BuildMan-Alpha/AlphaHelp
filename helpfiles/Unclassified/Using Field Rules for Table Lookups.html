	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using Field Rules for Table Lookups </p>



<p class=A5>Control Behavior and Appearance</p>



<p>The value of using field rules to populate a list is that the rules 
 are associated with the data, and consequently, the rules automatically 
 influence the way a form or browse displays the data.</p>



<p>The following screen shot shows the <span class=Screen>Table Lookup 
 Form</span> with Type-In controls which display lists based on the Vendor 
 and Product fields. These controls provide two operating modes:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Popup window with list</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Combo box-like drop-down 
 list </p>

</li>
</ul>

<p class=Pix><img src="images/Table_Lookup_form.gif"
					x-maintain-ratio=TRUE
					style="width: 495px;
							height: 299px;
							float: none;
							border-style: none;
							vertical-align: baseline;
							border-style: none;
							vertical-align: baseline;"
					width=495
					height=299
					align=bottom
					border=0></p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The List and 
 Combo box controls are not available for use with field rules.</p>



<p class=A5>Defining the Vendor Lookup</p>



<p>The Lookups tab of the <span class=Screen>Field Rules</span> dialog 
 box shows how you configure the Vendor form field to produce a list of 
 <span class=Code1>Vendor_Name</span> field values, while storing the corresponding 
 <span class=Code1>Vendor_No</span> value into the <span class=Code1>Quote_Vendor_No_FR</span> 
 field. </p>



<p class=Pix><img src="images/field_rules_lookup_tab_1.gif"
					x-maintain-ratio=TRUE
					style="width: 435px;
							height: 216px;
							float: none;
							border-style: none;
							vertical-align: baseline;
							border-style: none;
							vertical-align: baseline;"
					width=435
					height=216
					align=bottom
					border=0></p>



<p>The <span class=Control>Table</span> field defines the source of the 
 list data.</p>



<p class=A5>Procedure</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Return to the <span 
 class=Screen>Control Panel</span> and click the <span class=Button>Table/Sets</span> 
 tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the table 
 icon and right click.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Edit 
 Field Rules ...</span> selection.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Quote_Vendor_No_FR" 
 field in the drop-down list, at the top of the screen.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Lookups</span> 
 tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Lookup 
 styles</span> list select "Table lookup".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Table</span> 
 list, select "vendor.dbf".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Linking 
 Field</span>, select "Vendor_No". This is the value that the 
 Table Lookups table will store.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Display 
 Order</span> field, select "Vendor_Name". This sorts the results 
 alphabetically on the Vendor_name field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Skip the <span class=Control>Filter</span> 
 field. This query will return all of the records in the table. </p>

</li>
</ol>

<p class=Pix><span class=Control><img src="images/field_rules_lookup_tab_2.gif"
										x-maintain-ratio=TRUE
										style="width: 435px;
												height: 206px;
												float: none;
												border-style: none;
												vertical-align: baseline;
												border-style: none;
												vertical-align: baseline;"
										width=435
										height=206
										align=bottom
										border=0>&nbsp;</span></p>



<p>The <span class=Control>Source</span> fields defines the data that is 
 retrieved from the Vendor table. The <span class=Control>Fill</span> field 
 specifies that the <span class=Code1>Vendor_No</span> field is mapped 
 to the <span class=Code1>Quote_Vendor_No_FR</span> field of the Table 
 Lookups table. The <span class=Control>Display</span> fields define whether 
 the vendor fields are displayed on the form.</p>



<ol start=11>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the first line 
 of the <span class=Control>Source</span> column, select "Vendor->Vendor_Name".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the first line 
 of the <span class=Control>Display</span> column, select "Yes".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second line 
 of the <span class=Control>Source</span> column, select "Vendor->Vendor_No".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second line 
 of the <span class=Control>Fill</span> column, select "QUOTE_VENDOR_NO_FR".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you wish a two 
 column display, in the second line of the <span class=Control>Display</span> 
 column, select "Yes". Otherwise, select "No".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Check <span class=Control>Display&nbsp;as&nbsp;Drop-down 
 list box</span> field.</p>

</li>
</ol>

<p>Since the user is selecting from a pre-defined list, the <span class=Control>Allow 
 Exceptions</span> field selection is "Force closes match". This 
 configuration does not use a popup window, so the <span class=Control>Auto 
 popup</span> field is ignored. The <span class=Control>Allow Maximize</span> 
 display field allows popup windows to maximize if the underlying form 
 is maximized. In this context it is ignored. </p>



<p class=Pix><img src="images/field_rules_lookup_tab_3.gif"
					x-maintain-ratio=TRUE
					style="width: 435px;
							height: 213px;
							float: none;
							border-style: none;
							vertical-align: baseline;
							border-style: none;
							vertical-align: baseline;"
					width=435
					height=213
					align=bottom
					border=0></p>



<p class=A5>Defining the Product Lookup</p>



<p>The <span class=Screen>Lookups</span> tab of the <span class=Screen>Field 
 Rules</span> dialog box shows how to configure the Product form field 
 to produce a list of <span class=Code1>Product_Name</span> field values, 
 while storing the corresponding <span class=Code1>Product_No</span> value 
 into the <span class=Code1>Quote_Product_No_FR</span> field.</p>



<p>The <span class=Control>Table</span> field defines the source of the 
 list data. The <span class=Control>Filter</span> field defines the relationship 
 that must be satisfied to select a record from the Product table. The 
 expression " <span class=Code1>product_vendor_no = table_lookups->quote_vendor_no</span> 
 " means that the <span class=Code1>Product_Vendor_No</span> field 
 equals the <span class=Code1>Quote_Vendor_No</span> field in the Table 
 Lookup table.</p>



<p>The expression <span class=Code1>table_lookups->quote_vendor_no</span> 
 means that you are specifying the <span class=Code1>Quote_Vendor_No</span> 
 in the Table Lookups table. It is important to use this fully-qualified 
 field definition. The reason is that the lookup is based on the Product 
 table. The fields of the Table Lookups table are foreign to it. </p>



<p class=Pix><span class=Code1><img src="images/field_rules_product_lookup_tab_1.gif"
									x-maintain-ratio=TRUE
									style="width: 437px;
											height: 215px;
											float: none;
											border-style: none;
											vertical-align: baseline;
											border-style: none;
											vertical-align: baseline;"
									width=437
									height=215
									align=bottom
									border=0>&nbsp;</span></p>



<p class=A5>Procedure</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Return to the <span 
 class=Screen>Control Panel</span> and click the <span class=Screen>Table/Sets</span> 
 tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the table 
 icon and right click.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Edit 
 Field Rules ...</span> selection.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Quote_Product_No_FR" 
 field in the drop-down list at the top of the screen.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Lookups</span> 
 tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Lookup 
 styles</span> list select "Table lookup".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Table</span> 
 list select "product.dbf".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Linking 
 Field</span> list enter "Product_No". This is the value that 
 the Table Lookups table will store.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Filter</span> 
 field enter " <span class=Code1>Product_vendor_no = table_lookups->quote_vendor_no_fr</span> 
 ". This restricts the records returned to those where <span class=Code1>Product_Vendor_No</span> 
 equals <span class=Code1>Quote_Vendor_No_FR</span>.</p>

</li>
</ol>

<p>The <span class=Control>Source</span> fields defines the data that is 
 retrieved from the Product table. The <span class=Control>Fill</span> 
 field specifies that the <span class=Code1>Product_No</span> field is 
 mapped to the <span class=Code1>Quote_Product_No</span> field of the Table 
 Lookup table. The <span class=Control>Display</span> fields define whether 
 the product fields are displayed on the form. </p>



<p class=Pix><img src="images/field_rules_product_lookup_tab_2.gif"
					x-maintain-ratio=TRUE
					style="width: 437px;
							height: 205px;
							float: none;
							border-style: none;
							vertical-align: baseline;
							border-style: none;
							vertical-align: baseline;"
					width=437
					height=205
					align=bottom
					border=0></p>



<ol start=10>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the first line 
 of the <span class=Control>Source</span> column, select "Product->Product_Name".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the first line 
 of the <span class=Control>Display</span> column, select "Yes".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second line 
 of the <span class=Control>Source</span> column, select "Product->Product_No".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second line 
 of the <span class=Control>Fill</span> column, select "Quote_Product_No". 
 This is the data that stored in the Table Lookups table.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second line 
 of the <span class=Control>Display</span> column, select "No".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the third line 
 of the <span class=Control>Source</span> column, select "Product->Product_Symbol".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the third line 
 of the <span class=Control>Display</span> column, select "Yes".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Check the <span class=Control>Display&nbsp;as&nbsp;Drop-down 
 list box</span> check box.&nbsp; </p>

</li>
</ol>

<p class=Pix><img src="images/field_rules_lookup_tab_3.gif"
					x-maintain-ratio=TRUE
					style="width: 435px;
							height: 213px;
							float: none;
							border-style: none;
							vertical-align: baseline;
							border-style: none;
							vertical-align: baseline;"
					width=435
					height=213
					align=bottom
					border=0></p>



<p>Since the user is selecting from a pre-defined list, the <span class=Control>Allow 
 Exceptions</span> field selection is "Force closest match". 
 This configuration does not use a popup window, so the <span class=Control>Auto 
 popup</span> field is ignored. The <span class=Control>Allow Maximize 
 display</span> field allows popup windows to maximize if the underlying 
 form is maximized. In this context it is ignored.</p>



<p>The <a href="http://downloads.alphasoftware.com/samples/Table_Lookups.zip">Table 
 Lookups sample database</a> can be downloaded.</p>



<p class=A5>See Also</p>



<p><a href="../References/Objects/Objects That Do Table Lookups.html" title="Objects That Do Table Lookups" class="wiki">Overview of Development   Approaches</a>, <a href="Using Object Properties for Table Lookups.html" title="Using Object Properties for Table Lookups" class="wiki">Using   Object Properties for Table Lookups</a>, <a href="../Tutorials/AlphaSports Explained (Desktop)/The Invoice Form/Using a Coded Lookup Field.html" title="Using a Coded Lookup Field" class="wiki">Using   a Coded Lookup Field</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Field+Rules+for+Table+Lookups">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>