	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using ADO (ActiveX Data Objects) with Xbasic</p>



<p class=A5>What is ADO</p>



<p>ADO ( <span class=Screen>ActiveX Data Objects</span> ) is a <span class=Screen>Microsoft</span> 
 technology for accessing data from databases.</p>



<p class=A5>Goal of this Document</p>



<p>There are numerous books and Web articles on ADO. This document does 
 not attempt to duplicate the extensive existing documentation on ADO. 
 Rather, it is intended to give a few short examples showing how you can 
 use ADO in your Xbasic scripts. ADO can be hard to learn because there 
 is often more than one way to do things. In the examples that follow we 
 will often show more than one way to achieve the desired goal.</p>



<p class=A5>Following the Examples</p>



<p>All of the examples in this document can be followed from Alpha Five's 
 <span class=Screen>Interactive</span> window, or by creating Xbasic scripts. 
 The examples all use the Alphasports.MDB <span class=Screen>Microsoft 
 Access</span> database. This database ships with Alpha Five V6 and is 
 located in the <span class=Code1>c:\Program Files\A5v6\MDBFiles</span> 
 folder. If you want to work with data in a different database, the concepts 
 learned from the example here will still apply to your database. Keep 
 in mind however that not all ADO data sources work identically. It is 
 not uncommon to find that&nbsp; one set of ADO command works against one 
 database, but not another. This is definitely one of the frustrations 
 of working with ADO. Generally, a work around can usually be found. In 
 this document, the code that you should type in the <span class=Screen>Interactive</span> 
 window, or into your scripts, is shown in <span class=Code1>blue</span> 
 like this:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.close()</td></tr>
</table>

<p class=A5>The ADO Objects</p>



<p>ADO comprises several objects. These objects all have a set of properties 
 and methods. In this document we will be discussing the <span class=Code1>Connection</span>, 
 <span class=Code1>Recordset</span>, and <span class=Code1>Command</span> 
 objects. The are many other ADO objects, but we won't cover them here.</p>



<p class=A5>Connection Object</p>



<p>The first object you will need when using ADO is the connection object. 
 The first method of the connection object hat you will need to use is 
 its <span class=Code1>.Open()</span> method. The connection object allows 
 you to connect to your database. When you connect to a database, you provide 
 a connection string. The connection string tells ADO how to find your 
 database. For example, the following code creates a connection object 
 and then connects to <span class=Code1>alphasports.mdb</span>.</p>



<p>Type this in the <span class=Screen>Interactive</span> window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C</p>


<p class=Code>dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0; Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb; Persist Security 
 Info=False"</p>


<p class=Code>conn.open(connString)</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Tip</span> : To help you construct 
 connection strings, you can use the <a href="../References/Functions/A5_CONNECTIONSTRING Function.html" title="A5_CONNECTIONSTRING Function" class="wiki">A5_CONNECTIONSTRING(</a>) 
 function. For example, type this in the <span class=Screen>Interactive</span> 
 window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? a5_connectionstring()</td></tr>
</table>

<p>It is very important that you close your connections at your end of 
 your scripts, or else, if your script repeatedly opens connections, you 
 will run out of resources. To close an open connection, you use the connection 
 object's <span class=Code1>.</span> Close() method.</p>



<p>Let's close the open connection now. Type this in the <span class=Screen>Interactive</span> 
 window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.close()</td></tr>
</table>

<p class=A5>SQL Commands</p>



<p>The language that you use to talk to an ADO database is SQL. The two 
 most common types of SQL commands that you will want to send to your database 
 are commands that returns a set of records (don't confuse the use of the 
 word "set" here with Alpha Five's <span class=Code1>Set</span> 
 object), or commands that update, delete, or insert records into the database. 
 There are many other types of SQL commands that you could send to the 
 database (such&nbsp;as&nbsp;commands to create new tables and indexes), 
 but we are not going to cover these in this document.</p>



<p>SQL commands that return a set of records start with the <span class=Code1>SELECT</span> 
 keyword. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>SELECT * FROM customer</p>


<p class=Code>SELECT customer_id, firstname, lastname FROM customer WHERE 
 bill_state_region = 'ma' ORDER BY lastname</td></tr>
</table>

<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0><span class=Note>Note: </span>Notice that 
 in SQL statements string values are <span class=Bolded>single quoted</span> 
 (not double quoted).</p>



<p>SQL commands that update records in a database start with the <span 
 class=Code1>UPDATE</span> keyword. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>UPDATE customer SET bill_state_region = 'CA' WHERE customer_id 
 = '0000001'</p>


<p class=Code>UPDATE customer SET bill_state_region = 'CA'</td></tr>
</table>

<p>This second example will set the <span class=Code1>bill_state_region</span> 
 to "CA" in every record in the table because its scope has not 
 been limited by a <span class=Code1>WHERE</span> clause.</p>



<p>SQL commands that insert records into a database start with the INSERT 
 keyword. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>INSERT INTO customer (firstname, lastname) VALUES ('Gregory', 
 'Timmermansky')</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span>: On the surface, 
 SQL is a standardized language, but unfortunately, each database uses 
 slightly different syntax and conventions. For example, in <span class=Screen>Microsoft 
 Access</span> and <span class=Screen>SQL Server</span>, field and table 
 names containing spaces are enclosed in square brackets ( <span class=Code1><a class="wiki"  href="first 
 name" rel="">first 
 name</a></span> ). In <span class=Screen>Oracle</span>, they are double quoted 
 ( <span class=Code1>"first name"</span> ), and in <span class=Screen>MySQL</span> 
 they are quoted using a special character ( <span class=Code1>'first name'</span> 
 ).</p>



<p class=A5>Recordset Object</p>



<p>When you retrieve records from a table, the records are "placed" 
 into a <span class=Code1>Recordset</span> object. The recordset object 
 has methods to navigate within the recordset and to read field values 
 from the recordset.</p>



<p>There are several different kinds of recordsets that you can create. 
 The simplest type of recordset is one that allows you to navigate forwards 
 through the recordset, but not backwards. This is a "forward only" 
 record set. Other types of recordsets allow you to move both backwards 
 and forwards. Generally, a recordset does not reflect changes made to 
 the data by other users after the recordset is created, however, there 
 are some types of recordsets that will immediately reflect changes made 
 to the database by other users. Some databases allow you to create updateable 
 recordsets (i.e. changes made directly to the recordset can be applied 
 to the database).</p>



<p>The type of recordset that you create is governed by the properties 
 of the recordset. The recordset's properties are set <span class=Bolded>after</span> 
 the recordset has been declared, but <span class=Bolded>before</span> 
 it is opened. Once a recordset has been opened (i.e. populated with records), 
 you can't change its properties.</p>



<p>In this next example, we will demonstrate how two recordsets, each created 
 with different properties, have different behaviors. The example also 
 shows two different ways in which a recordset can be populated. In the 
 first case we will execute a connection object's .Execute() method to 
 create a recordset, and in the second case, we will use the connection 
 object's .Open() method.</p>



<p>Enter this code in the <span class=Screen>Interactive</span> window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C</p>


<p class=Code>dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0; Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb; Persist Security 
 Info=False"</p>


<p class=Code>conn.open(connString)</td></tr>
</table>

<p>Using the connection's <span class=Code1>.Execute()</span> method we 
 create the most basic of recordsets.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute("select * from customer")</p>


<p class=Code>rs.MoveNext()</td></tr>
</table>

<p>Note that this recordset is a forward-only recordset; it does not support 
 the <span class=Code1>.MovePrevious()</span> method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs.MovePrevious() <br>
ERROR: OLE Automation Error. Source is ADODB.Recordset." <br>
Operation is not allowed in this context."</td></tr>
</table>

<p>Note also that this recordset does not support the <span class=Code1>.RecordCount</span> 
 property (it returns -1).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? rs.RecordCount <br>
-1 <br>
rs.close() <br>
delete rs</td></tr>
</table>

<p>Now let's create a "static" recordset. First, declare a recordset 
 object.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim rs&nbsp;as&nbsp;ole::adodb.recordset</td></tr>
</table>

<p>Set its <span class=Code1>CursorType</span> property to 3 (which is 
 a "static" recordset).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs.CursorType = 3</td></tr>
</table>

<p>Open the recordset using the recordset's <span class=Code1>.Open()</span> 
 method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs.open("select * from customer",conn) <br>
rs.MoveNext()</td></tr>
</table>

<p>Note that we can move backwards in this recordset.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs.MovePrevious()</td></tr>
</table>

<p>Note that this recordset supports the <span class=Code1>RecordCount</span> 
 property.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? rs.RecordCount <br>
61.000000 <br>
rs.close()</td></tr>
</table>

<p class=A5><a name=Retrieving_Records_from_a_Database>Retrieving Records 
 from a Database</a></p>



<p>In the next examples, we will retrieve records from a table in a database.&nbsp;as&nbsp;we 
 stated earlier, there is generally more than one way to do things when 
 using ADO. For example, you can get a recordset by using the connection 
 object's <span class=Code1>.Execute()</span> method, or you can declare 
 a recordset object and then use its <span class=Code1>.Open()</span> method.</p>



<p>In this example, we will create a list of Massachusetts <span class=Code1>lastname</span> 
 values in the <span class=Code1>customer</span> table. Since this example 
 does not require that we move backwards in the recordset, a simple forward 
 only recordset will do.</p>



<p>Create a new script and enter the following code:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C</p>


<p class=Code>dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb;Persist Security 
 Info=False"</p>


<p class=Code>conn.open(connString)</p>


<p class=Code>dim sqlTxt&nbsp;as&nbsp;C</p>


<p class=Code>sqlTxt = "select Lastname from customer where bill_state_region 
 = 'ma'"</p>


<p class=Code>delete rs</td></tr>
</table>

<p>Use the connection object's <span class=Code1>.Execute()</span> method 
 to execute the SQL Select statement and return a recordset.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute(sqlTxt)</p>


<p class=Code>dim LastnameList&nbsp;as&nbsp;c = ""</p>


<p class=Code>while .not. rs.Eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;LastnameList = LastnameList + rs.fields.item(0).value 
 + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rs.MoveNext()</p>


<p class=Code>end while</p>


<p class=Code>ui_msg_box("Lastnames",LastnameList)</p>


<p class=Code>rs.close()</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>When you run the script, Alpha Five will produce a message box showing 
 the names of all <span class=Code1>lastname</span> values selected. Things 
 of note in this script are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The recordset has a method 
 called <span class=Code1>.Eof()</span> that returns .T. when you have 
 reached the end of the recordset.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The recordset has a method 
 called <span class=Code1>.MoveNext()</span> to move to the next row in 
 the recordset.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>To read a field value from 
 the recordset we reference the recordset's "Fields" collection.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>To read a value from the 
 fields collection, we use the <span class=Code1>.Item()</span> method 
 to get a reference to a field in the fields collection and then we reference 
 the field object's .value property. This method can either take an index 
 number (which is zero based), or a field name. For example <span class=Code1>rs.fields.item("lastname").value</span> 
 is the same&nbsp;as&nbsp; <span class=Code1>rs.fields.item(0).value</span> 
 (because <span class=Code1>lastname</span> is the first field in the recordset).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The .value property does 
 not have to be specified. If you omit it, ADO will understand that you 
 mean to reference the field's .value property. So you could have shortened 
 you code by writing <span class=Code1>rs.fields.item(0).</span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Since this recordset was 
 returned&nbsp;as&nbsp;the result of the connection object's <span class=Code1>.Execute()</span> 
 method, ADO has set the properties of the recordset object. ADO has created 
 the most basic of recordsets, and&nbsp;as&nbsp;a result many of the methods 
 that are theoretically supported by the Recordset object are not available 
 for this recordset. Also many of the property values that a recordset 
 theoretically supports have not been set. For example, this recordset 
 is a "forward only" recordset. You can call its <span class=Code1>.MoveNext()</span> 
 method, but not its <span class=Code1>.MoveFirst()</span> or <span class=Code1>.MovePrev()</span> 
 method. Also, if you were to examine its <span class=Code1>.recordcount</span> 
 property (which should tell you how may rows there are in the recordset), 
 you would see that the value for this property is -1, indicating the property 
 value has not been set.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Notice that the recordset 
 was returned by the connection object's <span class=Code1>.Execute()</span> 
 method. We did not have to <span class=Code1>dim rs&nbsp;as&nbsp;a recordset</span> 
 object before calling the connection object's <span class=Code1>.Execute()</span> 
 method, and in fact, had we done so (with <font style="font-family: 'Courier New';"
												face="Courier New"><span 
 class=Code1>dim rs&nbsp;as&nbsp;ole::adodb.recordset</span> </font>), 
 the script would have generated an error when we called the connection 
 object's <span class=Code1>.Execute()</span> method.</p>

</li>
</ul>

<p class=A5><a name=Updating_Records>Updating Records</a></p>



<p>To update records, you use the SQL Update command. The general syntax 
 of the command is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>UPDATE tablename SET fieldname1 = value1, fieldname2 = value2 
 .... WHERE fieldname3 = value3 ...</td></tr>
</table>

<p>Let's update the <span class=Code1>city</span>, <span class=Code1>state</span>, 
 and <span class=Code1>zip</span> fields in the <span class=Code1>customer</span> 
 table. First, we will check to see what their current values are, then 
 we will update them, then we will check to see if the updates worked. 
 From the <span class=Screen>Interactive</span> window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C</p>


<p class=Code>dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb;Persist Security 
 Info=False"</p>


<p class=Code>conn.open(connString)</p>


<p class=Code>delete rs</p>


<p class=Code>dim sqlSelect&nbsp;as&nbsp;C</p>


<p class=Code>sqlSelect = "SELECT customer_id, bill_city, bill_state_region, 
 bill_postal_code FROM customer"</td></tr>
</table>

<p>Execute the SQL SELECT statement and return a recordset.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.execute(sqlSelect)</td></tr>
</table>

<p>Display the values in the first record of the recordset for the <span 
 class=Code1>customer_id</span>, <span class=Code1>bill_city</span>, <span 
 class=Code1>bill_postal_code</span>, etc. fields.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? rs.fields.item("customer_id")</p>


<p class=Code>1.0000000</p>


<p class=Code>? rs.fields.item("bill_city") <br>
Boston</p>


&nbsp; 
<p class=Code>? rs.fields.item("bill_postal_code") <br>
01760</p>


&nbsp; 
<p class=Code>? rs.fields.item("bill_state_region") <br>
CA</p>


&nbsp; 
<p class=Code>? rs.fields.item("customer_id") <br>
1.000000</td></tr>
</table>

<p>Define the SQL update statement. Note that the fields to update and 
 the corresponding value are specified in a comma delimited list of name/value 
 pairs.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sqlupdate = "update customer set bill_city = 'New York', 
 bill_state_region = 'NY', bill_postal_code = '01000' where customer_id 
 = 1"</td></tr>
</table>

<p>Define a variable that will be updated to show the number of records 
 affected by the SQL statement.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim ra&nbsp;as&nbsp;N = 0</td></tr>
</table>

<p>Call the Connection object's <span class=Code1>.Execute()</span> method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.Execute(sqlupdate, ra)</td></tr>
</table>

<p>Check the <span class=Code1>ra</span> variable. It shows 1, indicating 
 that one record was affected by the UPDATE statement.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? ra <br>
= 1</td></tr>
</table>

<p>Now let's check if the update worked by looking at the values of the 
 fields that we updated.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sqlselect = "select bill_city, bill_state_region, bill_postal_code 
 from customer where customer_id = 1" <br>
rs = conn.Execute(sqlselect)</p>


&nbsp; 
<p class=Code>? rs.fields.item("bill_city") <br>
New York</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>Items of note in this code:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>The UPDATE statement can 
 be executed by calling the Connection object's <span class=Code1>.Execute()</span> 
 method. This is the same method that we called earlier to execute a SQL 
 SELECT statement. When the <span class=Code1>.Execute()</span> method 
 is executing a SELECT statement, then it returns a recordset. But, when 
 it executes an UPDATE statement, it does not return anything. It does, 
 however, update the value in the <span class=Code1>ra</span> variable 
 which was passed in by reference. Note that in this case the <span class=Code1>.Execute()</span> 
 method was invoked by passing in two arguments: the SQL text and the variable 
 to update.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Had the UPDATE statement 
 failed, (for example, because we entered a <span class=Code1>customer_id</span> 
 that did not exist in the WHERE clause), then the <span class=Code1>ra</span> 
 variable would be 0 (because no records were affected by the command).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>If we had executed an UPDATE 
 statement without a WHERE clause, then the update would have been applied 
 to all of the records in the table, and the <span class=Code1>ra</span> 
 variable would have been set to the number of records that were updated 
 (which would equal all of the records in the table).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>If the WHERE clause had 
 matched multiple records, then all matching records would have been UPDATED.</p>

</li>
</ul>

<p class=A5><a name=Inserting_Records>Inserting Records</a></p>



<p>To insert records, you use the SQL Insert statement. The general syntax 
 of the Insert statement is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>INSERT INTO tablename (field1, field2, field3....) VALUES 
 (value1, value2, value3....)</td></tr>
</table>

<p>Let's insert a new record into the <span class=Code1>customer</span> 
 table. First, we will get a count of the number of records in the table. 
 From the <span class=Screen>Interactive</span> window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C <br>
dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


&nbsp; 
<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb;Persist Security 
 Info=False" <br>
conn.open(connString)</td></tr>
</table>

<p>Execute a query to get the number of records in the customer table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute("select count(*) from customer")</td></tr>
</table>

<p>The recordset contains one row with one field, which contains the answer. 
 Remember that the fields collection is 0 based, so the first field is 
 <span class=Code1>item(0)</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? rs.fields.item(0) <br>
61.000000</td></tr>
</table>

<p>In case we do not remember what the field names are in the <span class=Code1>customer</span> 
 table, this code snippet will print out all of the field names. Note that 
 you won't have to type the # character in the sample code below. The <span 
 class=Screen>Interactive</span> window automatically inserts it when it 
 recognizes that you are in the middle of an un-terminated looping construct.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute("select * from customer")</p>


<p class=Code>?rs.fields.count <br>
20.000000 <br>
for i = 1 to 20 <br>
#?rs.fields.item(i-1).name <br>
#next i <br>
CUSTOMER_ID <br>
FIRSTNAME <br>
LASTNAME <br>
COMPANY <br>
PHONE <br>
FAX <br>
BILL_ADDRESS1 <br>
BILL_ADDRESS2 <br>
BILL_CITY <br>
BILL_STATE_REGION <br>
BILL_POSTAL_CODE <br>
BILL_COUNTRY <br>
SHIP_ADDRESS1 <br>
SHIP_ADDRESS2 <br>
SHIP_CITY <br>
SHIP_STATE_REGION <br>
SHIP_POSTAL_CODE <br>
SHIP_COUNTRY <br>
SHIP_SAME <br>
EMAIL</td></tr>
</table>

<p>Construct the SQL INSERT statement.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim sqlinsert&nbsp;as&nbsp;C</p>


&nbsp; 
<p class=Code>sqlinsert = "INSERT INTO customer (firstname, lastname, 
 company, bill_address1, bill_city, bill_state_region, bill_postal_code) 
 VALUES ('Tom', 'Turner' , 'Alpha', '1 Main St', 'Burlington', 'MA', '01803')"</td></tr>
</table>

<p>Execute the INSERT statement.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ra = 0 <br>
conn.Execute(sqlinsert,ra)</td></tr>
</table>

<p>Check on the number of records affected.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? ra <br>
= 1</td></tr>
</table>

<p>1 indicates that the 1 record was added - our Insert was successful.</p>



<p>Things of note about this code are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Note that we did not insert 
 a value into the <span class=Code1>customer_id</span> field. The reason 
 is that this field was defined&nbsp;as&nbsp;an auto-increment field, which 
 means you can't assign it at value. Its value is automatically assigned 
 by the database engine.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>We did not assign values 
 to all of the fields in the table. In this case, this worked because the 
 fields were not defined&nbsp;as&nbsp;required fields. Had any of the omitted 
 fields been required, the insert would have failed.</p>

</li>
</ul>

<p class=A5>Getting the Value of the Auto-Increment Fields</p>



<p>In the previous example where we inserted a new record, we did not assign 
 a value to the <span class=Code1>customer_id</span> field because this 
 field is an auto-increment field. After the record is inserted, in many 
 applications, it will be important to know what value the database engine 
 assigned to the auto-increment field (note that a table can only have 
 a single auto-increment field). The technique used to find the value of 
 the auto-increment field varies depending on the type of database that 
 you are using. In the following example, we use a technique that works 
 with <span class=Screen>SQL Server</span>, <span class=Screen>Access</span>, 
 and <span class=Screen>MySQL</span>. It may also work with some other 
 databases, but certainly will not work will all databases. You will need 
 to refer to the documentation for your database to see what method they 
 use.</p>



<p>To get the value of auto-increment field, we execute a special query:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>select @@identity</td></tr>
</table>

<p>Continuing with the previous example, from the <span class=Screen>Interactive</span> 
 window:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute("select @@identity") <br>
? rs.fields.item(0) <br>
62.000000 <br>
<br>
rs = conn.execute("select count(*) from customer") <br>
? rs.fields.item(0) <br>
62.000000</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>Things of note about this code are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Executing the query <span 
 class=Code1>select @@identity</span> returns a recordset with one row 
 and one column containing the value of the auto-increment field. In this 
 case the value is 62, indicating that the <span class=Code1>customer_id</span> 
 for the new record that we added is 62.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Our count query shows that 
 the table now has 62 records. You will recall that previously it had 61 
 records.</p>

</li>
</ul>

<p class=A5><a name=Using_Parameters>Using Parameters</a></p>



<p>In the previous examples you have seen that the INSERT and UPDATE statements 
 that we have executed have specified the field values in the SQL statement. 
 ADO also allows you to use parameters in the SQL statement, and then provide 
 values for the parameters before the SQL is executed. To do this, we will 
 use another of the ADO objects - the <span class=Code1>Command</span> 
 object.</p>



<p>If we wanted to update the city for customer 2, we could have written 
 the following SQL UPDATE statement:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>UPDATE customer set bill_city = 'London' where customer_id 
 = 2</td></tr>
</table>

<p>Using parameters, this statement could be expressed as:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>UPDATE&nbsp; customer set bill_city = ? where customer_id 
 = ?</td></tr>
</table>

<p>The question marks are place holder for the parameters. The advantage 
 of parameters is ease of use and speed when you are executing multiple 
 SQL statements of the same basic form. Say you need to update 100 records. 
 If you construct 100 different UPDATE statements, and then execute them, 
 the SQL parser in the database engine will have to parse 100 different 
 SQL statements. However, if you use parameters, the parser will only have 
 to parse a single statement.</p>



<p>The following example, which you can run from the <span class=Screen>Interactive</span> 
 window, shows how you can update records in a table using parameters. 
 You will remember that in the past, we have called the connection object's 
 <span class=Code1>.Execute()</span> method to execute the SQL. This time 
 we will call the Command object's <span class=Code1>.Execute()</span> 
 method to execute the SQL.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim connString&nbsp;as&nbsp;C</p>


<p class=Code>dim conn&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data 
 Source=C:\Program Files\A5V6\MDBFiles\Alphasports.mdb;Persist Security 
 Info=False"</p>


<p class=Code>conn.open(connString)</td></tr>
</table>

<p>Define the SQL UPDATE command using ?&nbsp;as&nbsp;the placeholder for 
 the parameters.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>sqlupdate = "update customer set bill_city = ? where 
 customer_id = ?"</td></tr>
</table>

<p>Create a command object.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim cmd&nbsp;as&nbsp;ole::adodb.command</td></tr>
</table>

<p>Set the <span class=Code1>command</span> object's <span class=Code1>.ActiveConnection</span> 
 property to conn. This associates the command object with our open connection 
 to the AlphaSports database.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>cmd.ActiveConnection = conn</td></tr>
</table>

<p>The command object has a "parameters" collection. Check how 
 many parameters there are in the collection now.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? cmd.Parameters.count <br>
0.000000</td></tr>
</table>

<p>Tell the command object what SQL you want to execute by setting its 
 <span class=Code1>.CommandText</span> property.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>cmd.CommandText = sqlupdate</td></tr>
</table>

<p>Now check to see how many parameters there are in the collection. There 
 are now 2 parameters: one for <span class=Code1>bill_city</span> and cone 
 for <span class=Code1>customer_id</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? cmd.Parameters.count</p>


<p class=Code>2.000000</td></tr>
</table>

<p>Set the values for each of the parameters.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>cmd.Parameters<a class="wiki"  href="1" rel="">1</a>.value = "London" <br>
cmd.Parameters<a class="wiki"  href="2" rel="">2</a>.value = 2</td></tr>
</table>

<p>Set the records affected ( <span class=Code1>ra</span> ) variable to 
 0.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ra = 0</td></tr>
</table>

<p>Call the command object's <span class=Code1>.Execute()</span> method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>cmd.Execute(ra)</td></tr>
</table>

<p>Check the records affected variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? ra <br>
= 1</td></tr>
</table>

<p>Now check to see if the field was updated.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rs = conn.Execute("select bill_city from customer where 
 customer_id = 2") <br>
? rs.fields.item(0).value <br>
London</td></tr>
</table>

<p>Now, let's say we want to update customer 3 to "Paris". All 
 that we have to do is this:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>cmd.Parameters<a class="wiki"  href="1" rel="">1</a>.value = "Paris"</p>


<p class=Code>cmd.Parameters<a class="wiki"  href="2" rel="">2</a>.value = 3</p>


<p class=Code>ra = 0</p>


<p class=Code>cmd.Execute(ra)</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>Items of note about the above code:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>When you set the command 
 object's <span class=Code1>.CommandText</span> property to the SQL that 
 you want to update (having already set the <span class=Code1>.ActiveConnection</span> 
 property), ADO automatically parsed the SQL and determined how many parameters 
 were included in the SQL statement. That's why when we checked <span class=Code1>cmd.Parameters.count</span> 
 a second time, it went from 0 to 2. ADO also automatically created two 
 empty parameters of the correct type.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Not all ADO providers automatically 
 parse the <span class=Code1>.CommandText</span> property to determine 
 how many parameters are needed. In this case you will have to manually 
 create the necessary parameters and add them to the parameters collection. 
 You can refer to a book on ADO for more information on how to do this.</p>

</li>
</ul>

<p class=A5><a name=Converting_ASP_and_VB_Code_to_Xbasic>Converting ASP 
 and VB Code to Xbasic</a></p>



<p>When reading about ADO in books and Web articles, you are likely to 
 come across many examples that are written for <span class=Screen>Visual 
 Basic</span> or <span class=Screen>VB Script</span>. While these examples 
 cannot be plugged into Xbasic directly, translating them to work with 
 Xbasic is generally very easy. When translating from VB to Xbasic, here 
 are some things to keep in mind:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Logical values in Xbasic 
 are expressed&nbsp;as&nbsp; <span class=Code1>.T.</span> and <span class=Code1>.F.</span> 
 In VB they are <span class=Code1>TRUE</span> and <span class=Code1>FALSE</span>.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Method calls in VB are 
 not always enclosed in parentheses. In Xbasic they must always be enclosed 
 in parentheses.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>VB sometimes uses syntax 
 shorthand that Xbasic does not support.</p>

</li>
</ul>

<p class=TableLeft>Consider the following short <span class=Screen>VB Script</span> 
 code from an ASP page:</p>




<div align=center>
<table id="table1" style="float: aligncenter;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				x-cell-content-align: Top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col style="width: 50%;">
<col style="width: 50%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>ASP Code</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>Comments</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft><span class=Code1>Conn = Server.CreateObject("ADODB.Connection")</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>The Xbasic equivalent is the <a href="../References/Methods/OLE.CREATE Method.html" title="OLE.CREATE Method" class="wiki">OLE.CREATE(</a>) 
 method, or <span class=Code1>DIM Conn&nbsp;as&nbsp;OLE::Adodb.connection</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft><span class=Code1>Conn.Open "dsn=MyConnectionName"</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>The Xbasic equivalent is <span class=Code1>Conn.Open("dsn=MyConnectionName")</span> 
 because methods must be enclosed in parentheses.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft><span class=Code1>RS = Conn.Execute("SELECT userName, 
 password from AuthUsers")</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>The same command will work in Xbasic.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft><span class=Code1>myvar = RS("Password")</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 50%;" valign="top" width="50%">
<p class=TableLeft>This is a shortcut for <span class=Code1>myvar = RS.fields.item("Password")</span>. 
 Xbasic requires the expanded form of the syntax.</td></tr>
</table>
</div>
<p class=A5>See Also</p>



<p><a href="../References/Methods/OLE.CREATE Method.html" title="OLE.CREATE Method" class="wiki">OLE.CREATE(</a>), <a href="../References/SQL/Browse Through ADO Databases.html" title="Browse Through ADO Databases" class="wiki">Browse   Through ADO Databases</a></p>



	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+ADO+_ActiveX+Data+Objects_+with+Xbasic">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Server/Xbasic/","status":"pending","tags":"web","keywords":"server,guide,xbasic,sql"} --->
</body></html>