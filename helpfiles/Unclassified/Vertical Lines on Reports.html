	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Vertical Lines on Reports</p>



<p class=A5>by Bill Warner</p>



<p>Have you ever wanted to create an invoice or purchase order that has 
 vertical lines separating the columns? This might sound easy at first, 
 but how do you get every invoice to appear the same when the number of 
 records varies from one to another?</p>



<p>Using the old adage, "Necessity is the Mother of Invention," 
 I was forced to come up with something for a customer. Since I would never 
 know how many records might be in the child table (1), I couldn't just 
 put a border on each field (limiting the border to right and left only). 
 This would give me inconsistent results.</p>



<p>Then I hit on the idea of using a temporary table (see Temp Tables elsewhere 
 in this issue). Instead of creating the invoice report directly from my 
 set, I decided to create it on the temp table. This would give me the 
 ability to add dummy records to that table, so the total number of records 
 in the report would be the same, regardless of the number of records in 
 the set. Then, creating invoices with a uniform appearance would be much 
 easier.</p>



<p>Here's the idea: If you put a vertical line in the detail section of 
 the report (so it is the same height&nbsp;as&nbsp;the detail section), 
 that line will be continuous from one record to the next, and it's bottom 
 end will be at the bottom of the last record. If you always have the same 
 number of records, the line will always be the same height.</p>



<p>Here's the script that I attached to a button on the form:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>'********** RETRIEVE THE INVOICE NUMBER FROM THE FORM</p>


<p class=Code>dim global invno&nbsp;as&nbsp;C</p>


<p class=Code>invno = parentform:invno.value</p>


<p class=Code>'********** RUN A QUERY TO FIND THE RECORD, THEN COPY TO 
 A TEMP TABLE (INV_TMP)</p>


<p class=Code>t = table.current()</p>


<p class=Code>query.order = ""</p>


<p class=Code>query.filter = "INVNO=VAR->INVNO"</p>


<p class=Code>query.options = "I"</p>


<p class=Code>t.query_create()</p>


<p class=Code>copy.set = "order_st.set"</p>


<p class=Code>copy.db = "inv_tmp.dbf"</p>


<p class=Code>copy.dd = .F.</p>


<p class=Code>copy.delete_o_dd = .F.</p>


<p class=Code>copy.records = .T.</p>


<p class=Code>copy.fields = 8</p>


<p class=Code>copy.field1 = "Invno"</p>


<p class=Code>copy.field2 = "Custno"</p>


<p class=Code>copy.field3 = "Po_No"</p>


<p class=Code>copy.field4 = "Ordparts->Partno"</p>


<p class=Code>copy.field5 = "Ordparts->Qtyord"</p>


<p class=Code>copy.field6 = "Ordparts->Qtyship"</p>


<p class=Code>copy.field7 = "Ordparts->Userpr"</p>


<p class=Code>copy.field8 = "Ordparts->Extpr"</p>


<p class=Code>t.copy()</p>


<p class=Code>'********** OPEN THE TEMP TABLE, QUERY RECORDS TO GET COUNT</p>


<p class=Code>tt = table.open("inv_tmp")</p>


<p class=Code>query.order = ""</p>


<p class=Code>query.filter = "INVNO=VAR->INVNO"</p>


<p class=Code>query.options = "I"</p>


<p class=Code>i = tt.query_create()</p>


<p class=Code>qt = i.records_get()</p>


<p class=Code>'********** CREATE NEW BLANK RECORDS; QTY IS 20 - COUNT + 
 1</p>


<p class=Code>FOR x = qt to 20</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tt.enter_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tt.Invno = var->invno</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tt.enter_end()</p>


<p class=Code>NEXT x</p>


<p class=Code>report.preview("INVOICE")</td></tr>
</table>

<p>In this script, the current table is actually the set upon which the 
 form is based. <span class=Code1>INVNO</span> is the linking field between 
 the parent and child, and is also set to be a unique value. <span class=Code1>INV_TMP</span> 
 in the temporary table. The copy operation only shows 8 fields, whereas 
 there are more in the actual script. The <span class=Code1>FOR...NEXT</span> 
 function is where I determine how many dummy records to use, based on 
 how many records are in the actual invoice (this will give me a total 
 of 21 lines).</p>



<p>Here's what the report looks like: </p>



<p class=Pix><img src="images/Vertical_lines_on_reports.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 736px;
							height: 600px;
							float: none;
							border-style: none;
							border-style: none;"
					width=736
					height=600
					border=0></p>



<p>(1) This concept is based on using a set, in which the parent record 
 has the sales info (customer, invoice number, etc.) and the one-many child 
 has one record for each item sold.</p>



<p class=A5>See Also</p>



<p><a href="../References/Methods/TBL.COPY Method.html" title="TBL.COPY Method" class="wiki">&lt;TBL&gt;.COPY(</a>)</p>



<p class=A5>Thanks To</p>



<p>Bill Warner</p>

	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Vertical+Lines+on+Reports">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/Data/FieldRules/","status":"pending","keywords":"desktop,guide,rules,form,report","tags":"desktop"} --->
</body></html>