	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Scrolling News Ticker</p>



<p>The following script adds a scrolling news ticker to the Window Bar 
 at the bottom of the Alpha Five screen.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function lf_rss_toolbar&nbsp;as&nbsp;C (rss_url&nbsp;as&nbsp;C)</p>


<p class=Code>'rss_url = "http://syndication.boston.com/news/globe/pageone?mode 
 = rss_10"</p>


<p class=Code>'rss_url = "http://slashdot.org/index.rss"</p>


<p class=Code>'rss_url = "http://syndication.boston.com/news/globe/pageone?mode 
 = rss_10"</p>


<p class=Code>rss_url = "http://www.nytimes.com/services/xml/rss/nyt/HomePage.xml"</p>


<p class=Code>dim rssticker&nbsp;as&nbsp;P</p>


<p class=Code>dim rssticker.object&nbsp;as&nbsp;P</p>


<p class=Code>dim rssticker.class&nbsp;as&nbsp;C</p>


<p class=Code>dim ticker_html_file&nbsp;as&nbsp;C = "c:\\" + 
 remspecial(rss_url) + ".html"</p>


<p class=Code>dim rss_cache_file&nbsp;as&nbsp;C = "c:\\" + remspecial(rss_url) 
 + ".rss"</p>


<p class=Code>dim tbar_code&nbsp;as&nbsp;P</p>


<p class=Code>rssticker.class = "shell.explorer"</p>


<p class=Code>tbar_code.dlg_title = "RSS News Ticker" + time("hms3")</p>


<p class=Code>tbar_code.pre_toolbar_init = <<%code2%</p>


<p class=Code>%code2%</p>


<p class=Code>tbar_code.dlg_horizontal = <<%code2%</p>


<p class=Code>{drag_handle = a5_toolbar_drag_horiz}</p>


<p class=Code>{on_vertical_dock = dock_vertical}</p>


<p class=Code>{on_float_dock = dock_float}</p>


<p class=Code>{grow_to = height}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{auto_external_refresh}</p>


<p class=Code>{Dockable = Bottom}</p>


<p class=Code>{Restrict_docking = top, bottom}</p>


<p class=Code>{Background = White}</p>


<p class=Code>{Position = Remember = rss_toolbar}</p>


<p class=Code>{region99999}</p>


<p class=Code>{region}</p>


<p class=Code>{grow_to = }</p>


<p class=Code>{startup = update_rss}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{timer = update_rss}</p>


<p class=Code>{interval = 1800}{comment = update every 30 minutes}</p>


<p class=Code>{activex = 125, 2rssticker}</p>


<p class=Code>{grow_to = height}</p>


<p class=Code>{endregion}</p>


<p class=Code>|</p>


<p class=Code>{Font = }{tag = 1}<%B = T;T = Refresh news from server;I 
 = a5_refresh_color;%!!script_text:ui_dlg_event(dlg_title, "update_rss")></p>


<p class=Code>{Font = }{tag = 2}<%B = T;T = Set ticker properties;I 
 = a5_properties;%!!script_play_local("")></p>


<p class=Code>{Font = }{tag = 3}<%B = T;T = Close;O = {J = C}Close ;%!!script_text:ui_modeless_dlg_close(dlg_title)></p>


<p class=Code>{endregion99999}</p>


<p class=Code>%code2%</p>


<p class=Code>tbar_code.dlg_vertical = <<%code2%</p>


<p class=Code>{drag_handle = a5_toolbar_drag_vert}</p>


<p class=Code>{on_horizontal_dock = dock_horizontal}</p>


<p class=Code>{on_float_dock = dock_float}</p>


<p class=Code>{grow_to = width}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{auto_external_refresh}</p>


<p class=Code>{Dockable = Bottom}</p>


<p class=Code>{Restrict_docking = top, bottom}</p>


<p class=Code>{Background = White}</p>


<p class=Code>{Position = Remember = rss_toolbar}</p>


<p class=Code>{region99999}</p>


<p class=Code>;;</p>


<p class=Code>{region}</p>


<p class=Code>{grow_to = }</p>


<p class=Code>{startup = update_rss}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{timer = update_rss}</p>


<p class=Code>{interval = 1800}{comment = update every 30 minutes}</p>


<p class=Code>{activex = 125, 2rssticker}</p>


<p class=Code>{grow_to = width}</p>


<p class=Code>{endregion}</p>


<p class=Code>{Font = }{tag = 1}<%B = T;T = Refresh news from server;I 
 = a5_refresh_color;%!!script_text:ui_dlg_event(dlg_title, "update_rss")></p>


<p class=Code>{Font = }{tag = 2}<%B = T;T = Set ticker properties;I 
 = a5_properties;%!!script_play_local("")></p>


<p class=Code>{Font = }{tag = 3}<%B = T;T = Close;O = {J = C}Close ;%!!script_text:ui_modeless_dlg_close(dlg_title)></p>


<p class=Code>{endregion99999}</p>


<p class=Code>%code2%</p>


<p class=Code>tbar_code.dlg_float = <<%code2%</p>


<p class=Code>{on_vertical_dock = dock_vertical}</p>


<p class=Code>{on_horizontal_dock = dock_horizontal}</p>


<p class=Code>{grow_to = height}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{auto_external_refresh}</p>


<p class=Code>{Restrict_docking = top, bottom}</p>


<p class=Code>{Background = White}</p>


<p class=Code>{Position = Remember = rss_toolbar}</p>


<p class=Code>{region99999}</p>


<p class=Code>{region}</p>


<p class=Code>{grow_to = }</p>


<p class=Code>{startup = update_rss}</p>


<p class=Code>{can_exit = close}</p>


<p class=Code>{timer = update_rss}</p>


<p class=Code>{interval = 1800}{comment = update every 30 minutes}</p>


<p class=Code>{activex = 125, 2rssticker}</p>


<p class=Code>{grow_to = height}</p>


<p class=Code>{endregion}</p>


<p class=Code>|</p>


<p class=Code>{Font = }{tag = 1}<%B = T;T = Refresh news from server;I 
 = a5_refresh_color;%!!script_text:ui_dlg_event(dlg_title, "update_rss")></p>


<p class=Code>{Font = }{tag = 2}<%B = T;T = Set ticker properties;I 
 = a5_properties;%!!script_play_local("")></p>


<p class=Code>{Font = }{tag = 3}<%B = T;T = Close;O = {J = C}Close ;%!!script_text:ui_modeless_dlg_close(dlg_title)></p>


<p class=Code>{endregion99999}</p>


<p class=Code>%code2%</p>


<p class=Code>tbar_code.event_code = <<%code2%</p>


<p class=Code>select</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "init"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rssticker.object.silent 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rssticker.object.resizable 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(ticker_html_file)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rssticker.object.navigate2(ticker_html_file)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_event(dlg_title, 
 "update_rss")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;case a_dlg_button = "update_rss"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hourglass_cursor(.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim rss&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(rss_cache_file)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 rss.body&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rss.body 
 = get_from_file(rss_cache_file)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rss 
 = http_get(rss_url)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if .not. 
 eval_valid("rss.body")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'error_generate("The 
 RSS file was not downloaded from the server.")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;save_to_file(rss.body, 
 rss_cache_file)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 rss_title&nbsp;as&nbsp;C = extract_string(rss.body, "<title>", 
 "</title>")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 num_items&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_items 
 = count_textblocks(rss.body, "<item", "</item>")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 item[num_items]&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 i&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 this_item&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 
 i = 1 to num_items</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this_item 
 = extract_string(rss.body, "<item", "</item>", 
 i, .t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[i].title 
 = extract_string(this_item, "<title>", "</title>")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item[i].link 
 = extract_string(this_item, "<link>", "</link>")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next 
 i</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array_from_rss 
 = item</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim news_html&nbsp;as&nbsp;C 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 
 to item.size()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_html 
 = news_html + "header[" + (i-1) + "] = \"" + 
 rss_title + "\";" + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_html 
 = news_html + "text[" + (i-1) + "] = \"" + strtran(item[i].title, 
 "\"", "'") + "\";" + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_html 
 = news_html + "linka[" + (i-1) + "] = \"" + item[i].link 
 + "\";" + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_html 
 = news_html + "targa[" + (i-1) + "] = \"_blank\";" 
 + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_html 
 = strtran(news_html, "&amp;#", "&#")</p>


<p class=Code>dim page&nbsp;as&nbsp;C</p>


<p class=Code>page = <<%html%</td></tr>
</table>


<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code><html><head></p>


<p class=Code></p>


<p class=Code></head></p>


<p class=Code><body leftmargin = 0 topmargin = 2></p>


<p class=Code><div style = "position:relative;width:500; height:22;overflow:hidden; 
 margin:0px;"></p>


<p class=Code><div id = "spage" style = "position:relative; 
 width:500; height:22; background: #EEEEEE;overflow:hidden; FILTER: progid:DXImageTransform.Microsoft.GradientWipe(GradientSize 
 = 0.20, wipestyle = 0, motion = forward, duration = 1);"></div></p>


<p class=Code></div></p>


<p class=Code</body></html>