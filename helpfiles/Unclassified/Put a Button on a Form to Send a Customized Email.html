	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Put a Button on a Form to Send a Customized Email</p>



<p>This lesson demonstrates how you can use Action Script to send out a 
 customized email message. The goal is to send an email message to a customer 
 asking it to confirm that its correct address.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right-click the "customers" 
 table on the <span class=Screen>Tables/Sets</span> tab of the <span class=Screen>Control 
 Panel</span> and select <span class=Button>Default Form</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Customer_Default_Form.gif"
					x-maintain-ratio=TRUE
					style="width: 522px;
							height: 493px;
							float: none;
							border-style: none;
							border-style: none;"
					width=522
					height=493
					border=0></p>



<ol start=2>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The first step is 
 to create an "email template" that has the body of the message 
 to send to the customer. Select <span class=Button>Email</span> from the 
 <span class=Button>Tools</span> menu. </p>

</li>
</ol>

<p class=Pix><img src="images/email_2.gif"
					x-maintain-ratio=TRUE
					style="width: 338px;
							height: 307px;
							float: none;
							border-style: none;
							border-style: none;"
					width=338
					height=307
					border=0></p>



<p>This brings up the Alpha Five "Email Client". </p>



<p class=Pix><img src="images/email_3.gif"
					x-maintain-ratio=TRUE
					style="width: 583px;
							height: 505px;
							float: none;
							border-style: none;
							border-style: none;"
					width=583
					height=505
					border=0></p>



<ol start=3>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>First you need to 
 specify the email address of the recipient. However, you do not want to 
 use an actual email address. Instead, you want to refer to the field in 
 the customer records that contains the customer's email address. Click 
 <img src="images/Espression_Button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				float: none;
				width: 22px;
				height: 22px;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> to open the <span class=Screen>Expression Builder</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>F2</span> 
 to open the <span class=Control>Field Name</span> list. </p>

</li>
</ol>

<p class=Pix><img src="images/email_4.gif"
					x-maintain-ratio=TRUE
					style="width: 330px;
							height: 312px;
							float: none;
							border-style: none;
							border-style: none;"
					width=330
					height=312
					border=0></p>



<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Scroll down, select 
 the "Email" field, and click <span class=Button>Insert</span>. 
 The <span class=Screen>Expression Builder</span> looks like this: </p>

</li>
</ol>

<p class=Pix><img src="images/email_5.gif"
					x-maintain-ratio=TRUE
					style="width: 340px;
							height: 127px;
							float: none;
							border-style: none;
							border-style: none;"
					width=340
					height=127
					border=0></p>



<ol start=6>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 to close the <span class=Screen>Expression Builder</span>. Alpha Five 
 puts "=Email" in the <span class=Control>To</span> field.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The = prefix 
 tells Alpha Five that the text that follows is to be treated&nbsp;as&nbsp;an 
 expression.&nbsp; </p>



<p class=Pix><img src="images/email_6.gif"
					x-maintain-ratio=TRUE
					style="width: 582px;
							height: 159px;
							float: none;
							border-style: none;
							border-style: none;"
					width=582
					height=159
					border=0></p>



<ol start=7>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Next, fill in the 
 <span class=Control>Subject:</span> field: "Confirming Your Mailing 
 Address".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now create the body 
 of the message. Click inside the message body portion of the email. Type 
 "Dear " to start the message. </p>

</li>
</ol>

<p class=Pix><img src="images/email_7.gif"
					x-maintain-ratio=TRUE
					style="width: 289px;
							height: 103px;
							float: none;
							border-style: none;
							border-style: none;"
					width=289
					height=103
					border=0></p>



<ol start=9>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now you want to insert 
 a field from the current record. Click the <span class=Button>Insert Mail 
 Merge Field</span> button. </p>

</li>
</ol>

<p class=Pix><img src="images/email_8.gif"
					x-maintain-ratio=TRUE
					style="width: 474px;
							height: 39px;
							float: none;
							border-style: none;
							border-style: none;"
					width=474
					height=39
					border=0></p>



<ol start=10>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Screen>Insert 
 Field</span> dialog opens. Note that this is a modeless dialog. You can 
 leave it open while you type your message. </p>

</li>
</ol>

<p class=Pix><img src="images/email_9.gif"
					x-maintain-ratio=TRUE
					style="width: 339px;
							height: 376px;
							float: none;
							border-style: none;
							border-style: none;"
					width=339
					height=376
					border=0></p>



<ol start=11>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the "Firstname" 
 field and then click the <span class=Button>Insert Field</span> button. 
 Type in the rest of the message&nbsp;as&nbsp;shown below: </p>

</li>
</ol>

<p class=Pix><img src="images/email_10.gif"
					x-maintain-ratio=TRUE
					style="width: 374px;
							height: 148px;
							float: none;
							border-style: none;
							border-style: none;"
					width=374
					height=148
					border=0></p>



<ol start=12>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now you are ready 
 to insert the customer address information. Select the "company" 
 field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make sure the <span 
 class=Control>Suppress line if blank?</span> check box is checked. <a HREF="http://support.alphasoftware.com/imagesV8/email_11.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>

</li>
</ol>

<p class=Pix><img src="images/email_11.gif"
					x-maintain-ratio=TRUE
					style="width: 339px;
							height: 376px;
							float: none;
							border-style: none;
							border-style: none;"
					width=339
					height=376
					border=0></p>



<ol start=14>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Insert 
 Field</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>New 
 Line</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Continue selecting 
 fields and typing text in the message body until you screen looks like 
 this: </p>

</li>
</ol>

<p class=Pix><img src="images/email_12.gif"
					x-maintain-ratio=TRUE
					style="width: 454px;
							height: 283px;
							float: none;
							border-style: none;
							border-style: none;"
					width=454
					height=283
					border=0></p>



<ol start=17>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now save the template. 
 Click the <span class=Button>Save</span> button to save the script.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You can save templates 
 in text files, or in the current table's Library (where forms, reports, 
 etc. are stored). Select the <span class=Button>Alpha Five Library</span> 
 option, and enter "ConfirmAddress"&nbsp;as&nbsp;the template 
 name. </p>

</li>
</ol>

<p class=Pix><img src="images/email_13.gif"
					x-maintain-ratio=TRUE
					style="width: 308px;
							height: 188px;
							float: none;
							border-style: none;
							border-style: none;"
					width=308
					height=188
					border=0></p>



<ol start=19>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Before closing the 
 <span class=Screen>Email Editor</span>, click the <span class=Button>Preview</span> 
 button to see how your email will look.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now you are ready 
 to put a button on the form. Click the <span class=Button>Design</span> 
 button to switch the form to <span class=Screen>Design Mode</span>. <a HREF="http://support.alphasoftware.com/imagesV8/Custom_Action_Script_1.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>

</li>
</ol>

<p class=Pix><img src="images/Custom_Action_Script_1.gif"
					x-maintain-ratio=TRUE
					style="width: 522px;
							height: 358px;
							float: none;
							border-style: none;
							border-style: none;"
					width=522
					height=358
					border=0></p>



<ol start=21>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Button 
 Object</span> tool <img src="images/Button_tool_button.gif"
						x-maintain-ratio=TRUE
						style="float: none;
								width: 22px;
								height: 22px;
								border-style: none;
								border-style: none;"
						width=22
						height=22
						border=0>&nbsp;on the <span class=Screen>Toolbox</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click and drag to 
 draw a button just above the <span class=Button>Email</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When you release 
 the button, the <span class=Screen>Define Button</span> dialog box appears. 
 </p>

</li>
</ol>

<p class=Pix><img src="images/email_14.gif"
					x-maintain-ratio=TRUE
					style="width: 418px;
							height: 159px;
							float: none;
							border-style: none;
							border-style: none;"
					width=418
					height=159
					border=0></p>



<ol start=24>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Specify the button 
 <span class=Control>Label</span> and then use the <span class=Control>Style</span> 
 drop-down box to select the style of button you want.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Screen>Embedded 
 Action Script Editor</span> appears. </p>

</li>
</ol>

<p class=Pix><img src="images/Embedded_Action_Script_Editor.gif"
					x-maintain-ratio=TRUE
					style="width: 478px;
							height: 447px;
							float: none;
							border-style: none;
							border-style: none;"
					width=478
					height=447
					border=0></p>



<ol start=27>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Add 
 New Action</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "Email" 
 category and the "Send an email message" Action. </p>

</li>
</ol>

<p class=Pix><img src="images/Action_Email_Send_an_Email_Message.gif"
					x-maintain-ratio=TRUE
					style="width: 627px;
							height: 229px;
							float: none;
							border-style: none;
							border-style: none;"
					width=627
					height=229
					border=0></p>



<ol start=29>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The Genie appears. 
 When you send a message you can either use Alpha Five's built in email 
 client, or you can use your default email client (e.g. Outlook, Eudora 
 etc.). If you choose the built-in Alpha Five email client, you get more 
 options (as you will see on the next screen). For the purpose of this 
 lesson, please choose the "Alpha Five built-in client". </p>

</li>
</ol>

<p class=Pix><img src="images/email_17.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 362px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=362
					border=0></p>



<ol start=30>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You can either specify 
 the message header&nbsp;as&nbsp;Part of the Genie, or you can extract 
 the header from a saved template. Check the <span class=Control>Load message 
 header from a saved email template</span> check box.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The "message 
 header" is the address portion of the message, not the body. </p>



<p class=Pix><img src="images/email_18.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 350px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=350
					border=0></p>



<ol start=31>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You can specify that 
 Alpha Five should prompt for the template name at runtime, or you can 
 specify the template name now. Having Alpha Five prompt at runtime is 
 useful if you want the operator to be able to select one of several different 
 email messages to send to the client. Enter "ConfirmAddress"&nbsp;as&nbsp;the 
 <span class=Control>Template name</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/email_19.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 352px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=352
					border=0></p>



<ol start=32>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span> 
 to move to the next Genie page. </p>

</li>
</ol>

<p class=Pix><img src="images/email_20.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 336px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=336
					border=0></p>



<ol start=33>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You also want to 
 load the message body from a template, so check the <span class=Control>Load 
 message body from a saved email template</span> check box. </p>

</li>
</ol>

<p class=Pix><img src="images/email_21.gif"
					x-maintain-ratio=TRUE
					style="width: 481px;
							height: 116px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=116
					border=0></p>



<ol start=34>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Finally, choose "Open 
 Alpha Five email client&nbsp;as&nbsp;a modal dialog box". &nbsp;&nbsp;<a HREF="http://support.alphasoftware.com/imagesV8/email_21.gif"><a><a class="wiki"  href="Picture" rel="">Picture</a></a></a></p>

</li>
</ol>

<p class=Pix><img src="images/email_22.gif"
					x-maintain-ratio=TRUE
					style="width: 444px;
							height: 99px;
							float: none;
							border-style: none;
							border-style: none;"
					width=444
					height=99
					border=0></p>



<ol start=35>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Finish</span> 
 to close the Genie. Your screen should now look like this: </p>

</li>
</ol>

<p class=Pix><img src="images/email_23.gif"
					x-maintain-ratio=TRUE
					style="width: 478px;
							height: 112px;
							float: none;
							border-style: none;
							border-style: none;"
					width=478
					height=112
					border=0></p>



<ol start=37>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Finish</span> 
 to close the <span class=Screen>Define Button Genie</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Run the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a valid email 
 address in the <span class=Control>Email</span> field (your own would 
 be a good idea). Your screen should look like this: </p>

</li>
</ol>

<p class=Pix><img src="images/email_24.gif"
					x-maintain-ratio=TRUE
					style="width: 495px;
							height: 111px;
							float: none;
							border-style: none;
							border-style: none;"
					width=495
					height=111
					border=0></p>



<ol start=41>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Send 
 Email Confirmation</span> button. The Alpha Five email client pops up 
 with all the correct information merged into the message header and body. 
 </p>

</li>
</ol>

<p class=Pix><img src="images/email_25.gif"
					x-maintain-ratio=TRUE
					style="width: 505px;
							height: 521px;
							float: none;
							border-style: none;
							border-style: none;"
					width=505
					height=521
					border=0></p>



<ol start=42>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now click the <span 
 class=Button>Send</span> button&nbsp;to send the email.&nbsp;as&nbsp;you 
 can see, Action Scripting makes it very easy for you to create highly 
 customized email components to your applications.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : When you send 
 an email message using the Alpha Five email client, the message is stored 
 in the Alpha Five email outbox. This is a table you can add to the current 
 database.</p>



<ol start=43>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>To do so, click the 
 <img src="images/Add_Button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				float: none;
				width: 22px;
				height: 22px;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> icon on the <span class=Screen>Control Panel</span> toolbar 
 and select the "A_EMAIL.DBF.DBF" table in the Alpha Five program 
 folder.</p>

</li>
</ol>

<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : <a href="../References/Email/Netmailer.html" title="Netmailer" class="wiki">Netmailer</a> 
 automates the sending of emails. However, Netmailer does <span class=Bolded>not</span> 
 use the email templates created through the process described here.</p>


	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Put+a+Button+on+a+Form+to+Send+a+Customized+Email">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/View/Form/","status":"pending","tags":"desktop, review","notes":"Alpha Five","keywords":"desktop,form","pagename":""} --->
</body></html>