	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Method>&ltTBL>.QUERY_CREATE()</p>



<p class=A5>Syntax</p>



<p>Either specify the <span class=Argument>Flags</span>, <span class=Argument>Filter_Expression</span>,
 and <span class=Argument>Order_Expression</span> arguments or specify
 the required values in the <span class=Argument>Query</span> dot variable,
 then use the following command:</p>



<p><span class=Argument>&ltINDEX></span>&nbsp;as&nbsp;P = &ltTBL>.QUERY_CREATE(
 [ <span class=Argument>Flags</span>&nbsp;as&nbsp;C [,&nbsp;<span class=Argument>Filter_Expression</span>&nbsp;as&nbsp;C&nbsp;[,&nbsp;<span
 class=Argument>Order_Expression</span>&nbsp;as&nbsp;C ]]]&nbsp;)</p>

<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Flags</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. Default = the current value of <span class=Argument>Query.options</span>.
 If <span class=Argument>query.options</span> are not specified, you can
 provide instructions using the <span class=Argument>Flags</span> variable.&nbsp;Refer
 to <span class=Argument>query.options</span> below.</p>


<p class=Note><img src="images/icon_warning.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 37px;
							height: 33px;
							float: none;
							border-style: none;
							border-style: none;"
					width=37
					height=33
					border=0> <span class=Note>Note</span> : Alpha Five
 does not clear the prior values of <span class=Argument>Query.options</span>,
 <span class=Argument>Query.Filter</span> , or <span class=Argument>Query.Order</span>
 when you do a new query.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Filter_Expression</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. Default = the current value of <span class=Argument>Query.Filter</span>.
 An expression that evaluates to a logical value for each record in the
 table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Order_Expression</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. Default = the current value of <span class=Argument>Query.Order</span>.
 An expression that evaluates to a character value and references one or
 more fields in the table.</td></tr>
</table>


<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 2.555%;">
<col style="width: 5.026%;">
<col style="width: 5.231%;">
<col style="width: 75.882%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 2.555%;" valign="top" width="2.555%">
<p class=TableHead>Variable</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableHeadCenter>Type</td>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 81.113%;" valign="top" width="81.113%">
<p class=TableHead>Description</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.555%;" valign="top" width="2.555%">
<p class=TableLeft><span class=Argument>Query.Description</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 81.113%;" valign="top" width="81.113%">
<p class=TableLeft>The name of the query.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.555%;" valign="top" width="2.555%">
<p class=TableLeft><span class=Argument>Query.Order</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 81.113%;" valign="top" width="81.113%">
<p class=TableLeft>Optional.&nbsp;Default = "" (record number
 order). A character expression that includes a reference to at least one
 field in the table. <p class=TableLeft><b>DEPRECATED:</b> Use Order_Expression variable</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.555%;" valign="top" width="2.555%">
<p class=TableLeft><span class=Argument>Query.Filter</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 81.113%;" valign="top" width="81.113%">
<p class=TableLeft>Optional.&nbsp;Default = ".T." (all records).
 A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that evaluates to a logical value and selects the
 records to retrieve. <p class=TableLeft><b>DEPRECATED:</b> Use Filter_Expression variable</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="11" class="TableCell" style="x-cell-content-align: top; width: 2.555%;" valign="top" width="2.555%">
<p class=TableLeft><span class=Argument>Query.Options</span></td>
<td colspan="1" rowspan="11" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 81.113%;" valign="top" width="81.113%">
<p class=TableLeft>Optional.&nbsp;Default = Record order, ascending, not
 unique.  <p class=TableLeft><b>DEPRECATED:</b> Use Flags variable.
<p class=TableLeft>Controls whether Alpha Five uses an index, a new query list, or
 an existing query list to satisfy a query. This string can contain one
 or more of the following codes:</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="tableHeader" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableHeadCenter>Code</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>This flag does two things. The first behaviour is to
 force Alpha Five to build a query list rather than use an index (should
 an existing index that matches the query definition be available). The
 second behaviour is to prevent Alpha Five from setting this query list
 as the "last used query". (When you open a Form or Browse, if
 you do not explicitly define a query for the layout, Alpha Five will use
 the "last used query" for the table or set on which the layout
 is based. ) </td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>D</td>
<td class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>The descending order option puts the records in descending
 alphabetical order or, for a numeric field, from highest to lowest value.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>T</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>Temporary query.&nbsp;Alpha Five will automatically
 delete this query if necessary if building a new query would cause it
 to run out of query slots. there are a maximum of 16 query slots.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>U</td>
<td class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>The unique option includes only unique records in the
 query list.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>M</td>
<td class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>Instructs Alpha Five not to check to see if an existing
 query list could be used. Alpha Five will build a new query list, even
 if there was an existing query list that matched the query definition.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>X</td>
<td class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>Use an index even if an existing query exists (which
 Alpha Five would otherwise have used in preference to the index).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p class=TableCenter>I</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class=TableLeft>The I flag is obsolete. It was used by Alpha Five V1
 to indicate that the index should be case-insensitive. However since V2,
 Alpha Five automatically builds all indexes&nbsp;as&nbsp;Case-insensitive.
 It is documented because in some situations, the Script Recorder will
 show Xbasic code that includes the "I" flag.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p align="center">L</td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class="TableLeft">(Version 9) Forces a query on an active-link table to be performed locally (i.e.
client-side), even if the query optimizer determines that the query could have
been performed on the server.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.231%;" valign="top" width="5.231%">
<p align="center">S</td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.882%;" valign="top" width="75.882%">
<p class="TableLeft">(Version 9) Executes a query on an active-link table on the server if the query
optimizer determines that the query can be performed on the server. This is the
default for queries on active-link tables.</td></tr>
</table>

<p class=A5>Description</p>



<p>The &ltTBL>.QUERY_CREATE() method orders and selects data from the
 table referenced by &ltTBL>. Originally, you specified the selection criteria, order
 expression and query options by setting the values of the query variables
 ( <span class=Argument>query.description, query.order</span>, etc.). <b>In more modern, robust
 usage you specify the optional function arguments instead.</b></p>



<p>Once you have set the query variables, use the &ltTBL>.QUERY_CREATE() method
 to run the query. An object pointer, &ltINDEX>, is returned. &ltINDEX>
 will reference either:</p>



<ul>

	<li class=kadov-p-CBullet1><p class=Bullet1>a previously created query
 list that satisfies the query definition</p>

</li>

	<li class=kadov-p-CBullet1><p class=Bullet1>an index with the same
 definition&nbsp;as&nbsp;the query</p>

</li>

	<li class=kadov-p-CBullet1><p class=Bullet1>a new query list</p>

</li>
</ul>

<p>Alpha Five will only select a previously created query list if the query
 list is still up to date. It will be out of date if the table was edited
 after the query list was built.</p>



<p>If Alpha Five selects a previously created query list, or an existing
 index, the result is returned instantaneously. If a new query list must
 be built, the time taken to build the query list is a function of the
 size of the table, and whether Alpha Five can use Lightning Query Optimization.</p>



<p><span class=Argument>Query.Filter</span> is the filter expression (a
 character string). It can be any valid Alpha Five expression that returns
 a result of .T. (TRUE) or .F. (FALSE). For example, the following are
 valid filter expressions:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>"Lastname = \"smith\" .and. state = \"CA\""</p>


<p class=Code>"Lastname = 'smith' .and. state = 'CA'"</p>


<p class=Code>".not. (Company = \"\")"</p>


<p class=Code>"(lastname = \"smith\" .or. lastname = \"jones\")
 .and. state = \"ca\""</p>


<p class=Code>"(lastname = 'smith' .or. lastname = 'jones') .and.
 state = 'ca'"</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The <span class=Argument>Query.Filter</span>
 and <span class=Argument>Query.Order</span> expressions cannot include
 references to the table pointer.</p>



<p><span class=Argument>Query.Order</span> is the order expression (a character
 string). It can be any valid Alpha Five expression that references one
 or more fields. If you want to perform a multi-level sort on <span class=Bolded>character</span>
 fields, (i.e. sort by <span class=Code1>Lastname</span>, and within <span
 class=Code1>Lastname</span>, sort by <span class=Code1>firstname</span>
 ), you simply create an expression on your sort fields, starting with
 the outer level sort. For example to sort by <span class=Code1>Lastname</span>,
 and then by <span class=Code1>firstname</span>, you would use this&nbsp;order
 expression:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Lastname + firstname</td></tr>
</table>

<p>If your sort expression concatenates fields of a different type, (e.g.
 a character field and a date field), you should convert all of the fields
 to character. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Lastname + cdate(donation_date) ' a character field and a
 date</p>


<p class=Code>Str(score) + Lastname ' a numeric field and a character field
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
</table>

<p>You can set an option in <span class=Code1>query.options</span> to control
 whether Alpha Five uses an index, a new query list, or an existing query
 list to satisfy a query.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : You should reset
 <span class=Code1>query.filter</span>, <span class=Code1>query.order</span>,
 and <span class=Code1>query.options</span> to NULL ("") after
 you finish using them. Since they are global variables, this prevents
 other scripts from accidentally using inappropriate values.</p>



<p>You can determine whether a reference to an index or a query list was
 returned by using the <a href="../Index/INDEX.TYPE_GET Method.html" title="INDEX.TYPE_GET Method" class="wiki">&lt;INDEX&gt;.TYPE_GET(</a>)
 method. It returns 2 for an index and 6 for a query list.</p>



<p>A query list is like an index in that it does not contain the records
 themselves. It just contains the key values of the selected records, and
 pointers to the actual records in the underlying table. Therefore, if
 you modify a record value when a query list is active, you are modifying
 the actual data in the table.</p>



<p>The query list files are stored in the private path, which is set using
 the <span class=Button>View > Settings</span> command from the <span
 class=Screen>Control Panel</span>. The query list file names match this
 pattern: $$*.MPX. The <span class=Button>View > Settings</span> command
 has an option that allows you to specify that the $$*.MPX files (i.e.
 the temporary query files) for a table should be automatically deleted
 when Alpha Five is exited. Otherwise, Alpha Five will retain the last
 four queries for each table.</p>



<p>As with indexes, you can use the &ltTBL>.FETCH_FIND() method with
 query lists to find records by key value. In most ways, query list behave
 the same&nbsp;as&nbsp;indexes. The table below summarizes the differences.</p>




<table style="width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 50%;">
<col style="width: 50%;">

<tr>
<td class="tableHeader" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;" valign="top" width="50%">
<p class=TableHead>Indexes</td>
<td class="tableHeader" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-left-style: None;" valign="top" width="50%">
<p class=TableHead>Query Lists</td></tr>

<tr>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>All users who share a table have the same indexes.</td>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-left-style: None;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Each user creates their own query lists.</td></tr>

<tr>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Exclusive access to the table is required to add an
 index.</td>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-left-style: None;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Exclusive access to the table is not required to build
 a query list.</td></tr>

<tr>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Indexes are dynamic. They are updated when records are
 edited. Key values are always correctly sorted and records that do not
 satisfy index filters are removed from the index immediately.</td>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-left-style: None;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Queries are static. They are not updated when records
 are edited. After it is edited, a record that no longer satisfies the
 query filter remains in the query list. New records are added to the end
 of the query list.</td></tr>

<tr>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Can use the &ltTBL>.FETCH_FIND() method to find records
 by key value.</td>
<td class="TableCell" style="width: 50%;
			x-cell-content-align: top;
			border-spacing: 0px;
			border-left-style: None;
			border-top-style: None;" valign="top" width="50%">
<p class=TableLeft>Can use the &ltTBL>.FETCH_FIND() method to find records
 by key value.</td></tr>
</table>

<p>The optional <span class=Argument>query.description</span> assigns a
 name to the query. The query name can be up to 24 characters long. If
 Alpha Five selects an existing query, or index, rather than running building
 a new query list, the <span class=Argument>query.description</span> is
 not used.</p>



<p>The <span class=Argument>Query.Order</span> expression is used to designate
 which field or expression sets the primary order of the query. To query
 a subset of records, you can specify a <span class=Argument>Query.Filter</span>
 expression. To be included in the query list, a record must satisfy this
 filter.</p>



<p>If the <span class=Argument>Query.Filter</span> expression is undefined,
 the filter is assumed to be .T. (TRUE). This means that every record in
 the table will be selected. If the Order expression is undefined, the
 order is assumed to be record number order. You <span class=Bolded>cannot
 leave both</span> the <span class=Argument>Query.Order</span> expression
 and <span class=Argument>Query.Filter</span> expression undefined. If
 you wish to select all records in the table, you should specify:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>query.filter = ".T."</td></tr>
</table>

<p>In the case where &ltTBL> references a table that is the parent
 table of a set, the <span class=Argument>Query.Filter</span> expression
 can reference fields in the sets primary table, and any child tables linked
 to the parent table with a one-to-one link. Fields from child tables linked
 to the parent with a one-to-many link cannot be used in the <span class=Argument>Query.Filter</span>
 expression, unless the FLATTENQUERY()or CROSSLEVEL() function is used (See
 below).</p>



<p>Use the <a href="../Index/INDEX.RECORDS_GET Method.html" title="INDEX.RECORDS_GET Method" class="wiki">&lt;INDEX&gt;.RECORDS_GET(</a>)
 method to find out how many records were selected by a query.</p>



<p>When you create a query for a table using the &ltTBL>.QUERY_CREATE() method,
 then next time a form or browse that is based on the same table is opened,
 the last created query will be automatically selected, unless the form
 or browse specifies its own filter and order properties.</p>



<p>Each table has four slots for query lists. If you create more that four
 queries for a table (without using the &ltINDEX>.DROP(), or <a href="TBL.QUERY_DETACH_ALL Method.html" title="TBL.QUERY_DETACH_ALL Method" class="wiki">&lt;TBL&gt;.QUERY_DETACH_ALL(</a>)
 method to delete previously built queries), the new queries will take
 up one of the four slot positions, pushing one of the older queries off
 the list of open query lists.</p>



<p class=A5><a name=Responding_to_a_Query_with_No_Records>Responding to
 a Query with No Records</a></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim qry&nbsp;as&nbsp;P</p>


<p class=Code>dim nrecs&nbsp;as&nbsp;N</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>query.description = "Time Sheet"</p>


<p class=Code>query_order = "NAME"</p>


<p class=Code>query_filter = "NAME = VAR->Name .and. DATE = {"
 + VAR->Date + "}"</p>


<p class=Code>query_flags = ""</p>


<p class=Code>qry = tbl.query_create(query_flags, query_filter, query_order)</p>


<p class=Code>nrecs = qry.records_get()</p>


<p class=Code>IF (nrecs = 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;qry.drop()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Null Query","There
 are no records in the Query" ,UI_INFORMATION_SYMBOL)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.order = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.filter = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>Active-Link Tables (Version 9)</p>



<p>When a query is run on an active-link table, Alpha Five will analyze the
query expression and determine if any part of the query can be run on the
server. If possible, then the portion of the query that can be run on the
server, and any remaining portion of the query will be run on the client. If you
want to disable the query analyzer and force the query to run on the client, use
the "L" query flag.</p>





<p class=A5>See Also</p>



<p><a href="../../Functions/Table Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="/Desktop/Reference/Design/Data/DBF/FLATTENQUERY AND CROSSLEVEL Compared.html" title="FLATTENQUERY AND CROSSLEVEL Compared" class="wiki">FLATTENQUERY</a>,
 <a href="../../Functions/Query Functions/Query Functions and Methods.html" title="Query Functions and Methods" class="wiki">Query Functions and   Methods</a></p>





	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.QUERY_CREATE+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"dbf","status":"pending"}--->
</body></html>