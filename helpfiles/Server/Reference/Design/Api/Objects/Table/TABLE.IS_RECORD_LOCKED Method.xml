<page>
   <topic>table.IS_RECORD_LOCKED Function</topic>
   <syntax>L Is_Record_Locked()</syntax>
   <description>return TRUE if the record is locked.</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>Table Functions and  Methods</ref>
   </see>
   <original><![CDATA[&ltTBL>.IS_RECORD_LOCKED()
Syntax
Result_Flag as L = &ltTBL>.IS_RECORD_LOCKED()
Description
The &ltTBL>.IS_RECORD_LOCKED() method returns .T. (TRUE) if the current record is locked (i.e. another user or session has the record in change mode).
This method is new to V5. Previously, if you tried to put a record into change mode and another user or session already had the record in change mode, an error condition would occur, which your script could trap with the ON ERROR command. However, this technique is slow because Alpha Anywhere makes several attempts to get a lock on the record before reporting the error. Using the &ltTBL>.IS_RECORD_LOCKED() method is easier and faster.
Example
This script checks if the current record is locked before making a change.
dim tbl as P
tbl = table.current()
status = tbl.is_record_locked()
if (.not. status) then
    tbl.change_begin()
    tbl.field1 = var1
    tbl.change_end(.T.)
else
    ui_msg_box("Error", "Record locked by another user")
end if

See Also
Table Functions and  Methods]]></original>
</page>