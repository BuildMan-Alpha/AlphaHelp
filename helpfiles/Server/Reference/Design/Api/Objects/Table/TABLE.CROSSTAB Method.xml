<page>
   <topic>table.CROSSTAB Function</topic>
   <syntax>V Crosstab()</syntax>
   <description>Cross tabulate records of database into result database.</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>Table Functions and  Methods</ref>
      <ref>Table Operation  Methods</ref>
   </see>
   <original><![CDATA[&ltTBL>.CROSSTAB()
Syntax
Specify the required values in the Crosstab dot variable, then use the following command:
&ltTBL>.CROSSTAB()
VariableTypeDescription
Crosstab.dbCThe filename of the resulting table.
Crosstab.filterCEOptional. Default = ".T." (all records).
A character  filter expression that selects the records to process.
Crosstab.rowCThe field or combination of fields that will occupy the crosstabs horizontal axis.
Crosstab.columnCThe name of the field or combination of fields that will occupy the crosstabs vertical axis.
Crosstab.tabulateCThe name of the field or combination of fields that you want to summarize in the crosstab.
Crosstab.codeNThe following Summary Operation Codes to specify the type of summarization performed on the tabulation expression.
CodeOperationDescription
SUM_OP_TOTAL (1)TotalReturns the sum of values for the specified field or expression.
SUM_OP_COUNT (2)CountReturns a count of the number of records included in the specified field or expression.
SUM_OP_MIN (3)MinReturns the minimum (smallest) value for the specified field or expression.
SUM_OP_MAX (4)MaxReturns the maximum (largest) value for the specified field or expression.
SUM_OP_AVERAGE (5)AverageReturns the average of values for the specified field or expression.
SUM_OP_FIRST (6)FirstReturns the first value for the specified field or expression.
SUM_OP_LAST (7)LastReturns the last value for the specified field or expression.
Crosstab.optionsCOptional. Default = Ascending with duplicate records. Specifies the options used when ordering the Result table records. This string can contain one or more of the following index codes:
CodeDescription
DThe Descending Order option puts the records in descending alphabetical order or, for a numeric field, from highest to lowest value.
UThe Unique option uses only unique records in the crosstab.

Description
The &ltTBL>.CROSSTAB() method is a high-level utility used to cross-tabulate the records of a specified table, creating a new table, specified by the crosstab.db parameter, to store the result. Most parameters passed to &ltTBL>.CROSSTAB()through the crosstab function variable correspond directly with the prompts appearing on the Create New Operation screen after clicking Operations > New > Crosstab.
To define a crosstab, you specify the data you want to summarize and how the rows and columns in the resulting table are to be generated. You can perform cross-tabulation on character, numeric, date, and logical fields. Some summary operations do not make sense with some field types (e.g., totaling date values).
The crosstab.row parameter contains the field or combination of fields that will occupy the crosstabs horizontal axis. The crosstab.column is the name of the field or combination of fields that will occupy the crosstabs vertical axis. These expressions pertain to the Group by row and Group by column operators on the Crosstab screen.
The crosstab.tabulate parameter is the name of the field or combination of fields that you want to summarize in the crosstab. You use the following Summary Operation Codes to specify the type of summarization performed on the tabulation expression:
The crosstab.options parameter allows you to specify the options used when ordering the Result table records.
Example
This script creates a crosstab that shows the number of people with the same last name, for each city and in each state.
dim tbl as P
tbl = table.open("c:\a5\a_sports\customer.dbf")
crosstab.db = "c:\a5\a_sports\result.dbf"
crosstab.filter = ""
crosstab.row = "LAST_NAME"
crosstab.column = "STATE_PROV"
crosstab.options = "I"
crosstab.tabulate = "LAST_NAME"
crosstab.code = 2
tbl.crosstab()
tbl.close()

Alpha Anywhere ignores any query that may have been applied to the table. In the following example, all records are summarized, not just the records in the current query.
dim tbl as P
tbl = table.open("c:\a5\a_sports\customer.dbf")
query.filter = "state = 'MA' "
index = tbl.query_create()
crosstab.filter = ""
crosstab.row = "LAST_NAME"
crosstab.column = "STATE_PROV"
crosstab.options = "I"
crosstab.tabulate = "LAST_NAME"
crosstab.code = 2
tbl.crosstab()
tbl.close()

See Also
Table Functions and  Methods, Table Operation  Methods]]></original>
</page>