	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description">Populates control values in a dialog component from fields in the User table</span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Function>A5WS_Get_WebUser_Values()</p>



<p class=A5>Syntax</p>



<p class=Normal><span class=Argument>Result </span>as&nbsp;P 
 = A5WS_Get_WebUser_Values( <span class=Argument>CurrentForm</span>&nbsp;as&nbsp;P [, <span class="Argument">UserValue</span> as p [,
 <span class=Argument>Request</span>&nbsp;as&nbsp;P&nbsp;]])</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Result </span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>The result value is not meaningful if the function is being used in a web component. 
<ul>
  <li class=kadov-p-CTableBullet>
    <p class=TableBullet>result.errors  = Will return TRUE if any errors are found during processing. </p>


  </li>
  <li class=kadov-p-CTableBullet>
    <p class=TableBullet>result.error_text = Error messages returned. </p>


  </li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>CurrentForm</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>The <span class=Code1>CurrentForm</span> variable.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>UserValue</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. A pointer variable used to pass user defined values to the function. These will override the same values passed by the  <a href="../../../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable. Users can be found by three possible values passed in the variable. They are checked in sequence until a match is found. If no <span class="Argument">UserValue</span> variables are specified, the function will use the values passed by  
the  <a href="../../../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable.
<ul>
<li class=kadov-p-CTableBullet><p class=TableBullet>UserValue.guid = The user GUID value for the desired user record </p>

</li>
<li class=kadov-p-CTableBullet><p class=TableBullet>UserValue.userid = The 'userid' value for the desired user record</p>

 </li>
<li class=kadov-p-CTableBullet><p class=TableBullet>userValue.ulink = The 'ulink' value saved in the desired user record </p>

</li>
</ul>
</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Request</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. The <a href="../../../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable. The request variable should be considered READ ONLY. It is added automatically by the server when run from a web page. Users may be found by 
<ul>
<li class=kadov-p-CTableBullet><p class=TableBullet>request.variables.guid = The user GUID value for the desired user record </p>

</li>
<li class=kadov-p-CTableBullet><p class=TableBullet>request.variables.userid = The 'userid' value for the desired user record </p>

</li>
<li class=kadov-p-CTableBullet><p class=TableBullet>request.variables.ulink = The 'ulink' value saved in the desired user record </p>

</li>
</ul>
</td></tr>
 
 

</table>

<p class=A5>Description</p>


<p>The A5WS_Get_WebUser_Values() function populates control values in a 
  dialog component from fields in the User table. The function returns values from web user table as <span class="Code1">CurrentForm.Controls.<fieldname>.value</span> for each field in table.  Accepts user identification as <span class="Code1">UserValue.guid, UserValue.userid</span> or <span class="Code1">UserValue.ulink</span>. If the <span class="Code1">UserValue</span> variable is empty or not supplied, the function will  use the same values passed by the system <span class="Code1">request</span> variable.</p>


<p>The name of each control in the dialog must <span class=Bolded>exactly</span> match the name of the field in the user table. A list of valid field names can be found by using the <span class="A3Function"><a href="A5WS_User_File_Field_List Function.html" title="Retrieve a list of the active fields for the web user table in the current project" class="wiki">A5WS_User_File_Field_List(</a>)</span> function. Typically used in the Server 
  Initialize event of a dialog component. You can also use this function 
  in the Server After Validate event to repopulate values after a save. <a href="../../../../../../Guide/Design/View/Component/Adding Users with a Web Component.html" title="Adding Users with a Web Component" class="wiki">Adding Users with a Web Component</a> shows how the function is used in  dialog component events. </p>


<ol>
  <li class=kadov-p-CListNumber>
    <p class=ListNumber>Display the <span 
 class=Screen>Form > Properties</span> menu page of the <span class=Screen>Dialog 
      Builder</span>.</p>


  </li>
  <li class=kadov-p-CListNumber>
    <p class=ListNumber>Click <img src="images/Web_Properties_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 17px;
			height: 18px;
			float: none;
			border-style: none;
			border-style: none;"
	width=17
	height=18
	border=0> in the <span class=Button>Server Events > Initialize</span> property.</p>


  </li>
</ol>

<p class=A5>Limitations</p>


<p>May only be used in a web component or web page. </p>


<p class=A5>Example</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>a5ws_get_webuser_values(CurrentForm)</td></tr>
</table>
<p class=A5>Using the Function Outside of a Dialog Component </p>


<p>The function is designed to be used within Server Events of a dialog component. However, it can be used on any xbasic code section on a web page or component to return various values for a specific user. It is helpful to get a list of valid field names currently being used in the user security table by using the <span class="A3Function"><a href="A5WS_User_File_Field_List Function.html" title="Retrieve a list of the active fields for the web user table in the current project" class="wiki">A5WS_User_File_Field_List(</a>)</span> function. One additional field named <span class="Code1">groups</span> can be returned. It will contain a comma delimited list of the security groups assigned to the user. The group values returned will be the <span class="Code1">group_guid</span> value for each group, not the group names. A list of group names assigned to the user can be found using the function <a href="A5WS_Get_User_Assignments Function.html" title="Returns a list of groups to which a user belongs" class="wiki">A5WS_Get_User_Assignments</a>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>?a5ws_User_File_Field_List()</p>


<p class=Code>= Email</p>


<p class=Code>Guid</p>


<p class=Code>Password</p>


<p class=Code>Ulink</p>


<p class=Code>Userid</p>


</td></tr>
</table>

<p>The fields to be output from the function must be defined. The function will only return values for field names passed to the function as <span class="Code1"><pointer>.Controls.<fieldname>.value</span> and will only return values for fields currently being used by the security system. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim output as p</p>


<p class=Code>dim output.controls as p</p>


<p class=Code>dim output.controls.email.value as c</p>


<p class=Code>dim output.controls.userid.value as c</p>


<p class=Code>dim output.controls.groups.value as c</p>


<p class=Code>dim output.controls.guid.value as c	</p>


</td></tr>
</table>

<p>A value must be passed to the function in the <span class="TableLeft"> <a href="../../../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system</span> variable to find the current user. This can be in the form <span class="Code1">request.variables.guid, request.variables.userid</span> or <span class="Code1">request.variables.ulink</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim UserValue as p</p>


<p class=Code>dim UserValue.ulink as c</p>


<p class=Code>UserValue.ulink = "00000008"</p>


</td></tr>
</table>

<p>The function will return the values found in the <span class="Code1">output.controls.<fieldname>.</span><span class="Code1">value</span>. The <span class="Code1">result.errors</span> value can be tested to determine if any errors occured during processing. Any error messages will  be should in the <span class="Code1">result.error_text</span> value. The <span class="Code1">userid</span> value can be used to get a list of group names for the user using the function <a href="A5WS_Get_User_Assignments Function.html" title="Returns a list of groups to which a user belongs" class="wiki">A5WS_Get_User_Assignments</a>. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim result as p</p>


<p class=Code>dim error_message as c</p>


<p class=Code>dim group_list as c</p>


<p class=Code>result = a5ws_Get_WebUser_Values(output,UserValue)</p>


<p class=Code>if result.errors = .T. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;error_message = result.error_text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if </p>


<p class=Code>group_list = a5ws_get_user_assignments(output.controls.userid.value,request)</p>


<p class=Code>group_list = crlf_to_comma(group_list)</p>


</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Application Functions/Web Application Functions.html" title="Web Application Functions" class="wiki">Web Application Functions</a>,&nbsp;<a href="../../../../../../Guide/Design/View/Component/Adding Users with a Web Component.html" title="Adding Users with a Web Component" class="wiki">Adding Users with a Web Component</a></p>

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:A5WS_Get_WebUser_Values+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description">Populates control values in a dialog component from fields in the User table</span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending"}--->
</body></html>