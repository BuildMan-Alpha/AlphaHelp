<page>
	<group>JSON Functions</group>
	<topic>
vartojsonhash()
	</topic>
	
	<syntax>
C jsonHash = varToJSonHash(p propertyArray, c hashProperty [, L flagSpecialTags [, L flagCondense [, flagUseDoubleQuotes ]]])
	</syntax>
	
	<arguments>
		<argument>
			<name>
				propertyArray
			</name>
			<description>
				Xbasic property array
			</description>
		</argument>
		
		<argument>
			<name>
				hashProperty
			</name>
			<description>
				name of the property in the Xbasic array to be used as the hash key
			</description>
		</argument>
		
		<argument>
			<name>
				flagSpecialTags
			</name>
			<description>
				specifies if the property array uses the special {javascript} directive to indicate that the JSON property should be generated as Javascript and not as a string. Default if false.
			</description>
		</argument>
		
		<argument>
			<name>
				flagCondense				
			</name>
			<description>
				 indicates if the generated JSON should be condensed to eliminate line breaks. 
			</description>
		</argument>
		
		<argument>
			<name>
				flagUseDoubleQuotes
			</name>
			<description>
				indicates if strings and property names should be double quoted. By default property names are not quoted and strings are single quoted.
			</description>
		</argument>
	</arguments>
	
	
<description>
The varToJsonHash() Function converts an Xbasic property array to a JSON hash. 
</description>

<discussion></discussion>
<sections>
	<section>
		<description>Vartojsonhash() is used with the following. Consider this Xbasic property array:</description>
<example>
DIM P[0] as p
p[].name = "John Smith"
p[..].address = "123 Main Street"
p[..].age = 23

p[].name = "Fredia Malt"
p[..].address = "456 Center Lane"
p[..].age = 33
</example>
</section>

<section>
	<description>
		We can convert this to a JSON hash, using the 'name' property as the hash index as follows:
dim jsonHash as c 
	</description>
	<example>
		jsonHash = vartojsonHash(p,"name")
	</example>
</section>

<section>
	<description>
		The resulting JSON string looks like this:
	</description>
	<example>
		{
    'John Smith' : {address: '123 Main Street',age: 23},
    'Fredia Malt' : {address: '456 Center Lane',age: 33}
}
	</example>
</section>

<section>
	<description>
		In this next example we use the flagSpecialTags property
	</description>
	<example>
		DIM P[0] as p
p[].name = "John Smith"
p[..].address = "123 Main Street"
p[..].age = 23
p[..].sayHello = "{javascript}function() { alert('hello John') }"



p[].name = "Fredia Malt"
p[..].address = "456 Center Lane"
p[..].age = 33

jsonHash = vartojsonHash(p,"name", .t.)
	</example>
</section>

<section>
	<description>
		The resulting JSON string is:
	</description>
	<example>
		{
    'John Smith' : {address: '123 Main Street',age: 23,sayHello: function() { alert('hello John') }},
    'Fredia Malt' : {address: '456 Center Lane',age: 33}
}
	</example>
</section>


</sections>

	<see>
		<ref>vartojson()</ref>
		<ref>vartojsonstandard()</ref>
		<ref>JSON Data</ref>
		
	</see>
</page>