	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<b>SQL_Lookup() Function</b>&nbsp;<br />
Gets a value from a table in a remote database  using AlphaDAO.
<p><strong>Syntax</strong>: <br />
A <i>value</i> = sql_lookup(C<i> connection</i> ,C <i>table</i> ,C  <i>filter</i>, C <i>result_Expression</i> [,SQL::arguments&nbsp; <i>arguments</i> ]  )<br />
&nbsp;</p>
<p>Where:</p>
<div>
<table style="BORDER-COLLAPSE: collapse" id="table43" border="1" cellspacing="1" cellpadding="3">
    <tbody>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>value  </i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">Value returned by the function. Can be of any type, depending on the  value that <i>result_expression</i> evaluates to.
Returns a null value if no matching value was found
as of Build 3209_3580.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>connection  </i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">An explicit AlphaDAO connection string, or a named connection string.  (e.g. ::name::myconnectionstring), or a pointer to an open connection. </td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>table</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">The name of the table in the remote database in which to perform the  lookup.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>filter</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">A filter expression to determine which record in the remote table to  find. The filter expression must use SQL syntax and must use portable AlphaDAO  functions. For example, strings must be single quoted, the AND,&nbsp; OR and NOT  operators are not surrounded by periods. The filter expression can use  arguments. For example, customerid = :whatcustomerid</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>result_Expression</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">A expression to determine what value gets returned. The expression  can be as simple as a single column name in the remote table, or it can be a  complex expression. The expression must be written using portable AlphaDAO  syntax.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>arguments</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">If the filter expression includes arguments, you must supply argument  values using a SQL::arguments object.</td>
        </tr>
    </tbody>
</table>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Examples:</p>
<p class="xbasic">connection =  "{A5API=Access,FileName='C:\northwind2\northwind2003.mdb',UserName='Admin'}"<br />
table  = "customers"<br />
result_expression = "concatenate(city,' -  ',contactname)"<br />
filter = "customerid =  'bolid'"<br />
?sql_lookup(connection,table,filter,result_expression)<br />
= "Madrid  - Mart�n Sommer"<br />
&nbsp;</p>
<p class="xbasic">'This example uses a named connection string and it uses  arguments in the filter</p>
<p class="xbasic">connection = "::Name::Northwind"<br />
table =  "customers"<br />
result_expression = "concatenate(city,' -  ',contactname)"<br />
filter = "customerid = :whatcustomerid"</p>
<p class="xbasic">dim args as sql::arguments</p>
<p class="xbasic">args.set("whatcustomerid","Bolid")<br />
?sql_lookup(connection,table,filter,result_expression,args)<br />
=  "Madrid - Mart�n Sommer"<br />
&nbsp;</p>
<p class="xbasic">'In this example we pass in an open connection.</p>
<p class="xbasic">'Since the function will not have to open and then close the  connection, it is significantly faster</p>
<p class="xbasic">dim cn as sql::connection</p>
<p class="xbasic">cn.open("::Name::Northwind")</p>
<p class="xbasic">table = "customers"<br />
result_expression = "concatenate(city,' -  ',contactname)"<br />
filter = "customerid =  'bolid'"<br />
?sql_lookup(cn,table,filter,result_expression)<br />
= "Madrid - Mart�n  Sommer"</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL_Lookup+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending"}--->
</body></html>