	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" >
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Using the A5_ADO_TO_ARRAY() function</p>

<p>This script demonstrates how to use the <a href="../../Objects/Array/A5_ADO_TO_ARRAY Function.html" title="A5_ADO_TO_ARRAY Function" class="wiki">A5_ADO_TO_ARRAY(</a>)function which populates an array with data from an <span class=Screen>Access</span> database, or an ADO connection string. Refer to the Xbasic Reference manual for a full description of the parameters that can be passed to the A5_ADO_TO_ARRAY() function. The A5_ADO_TO_ARRAY() function is a wrapper function. Inside the function, direct calls are made to ADO to fetch the data. </p>

<p class=Pix> <img src="images/XD_ADO_to_array.gif" x-maintain-ratio=TRUE style="border: none; width: 550px; height: 396px; float: none; border-style: none; border-style: none;" width=550 height=396 border=0></p>

<p class=A5>Example</p>

<p>Using the A5_ADO_TO_ARRAY() function is easier for users who do not have a lot of experience using ADO.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ado.MdbFileName = find_Northwind()'Returns the filename of the Northwind.mdb file on this computer.</p>

<p class=Code>'If northwind.mdb not found, then prompt user to download it.</p>

<p class=Code>if ado.MdbFilename = "failed" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>end if</td> </tr> </table><p>Make sure the northwind database file is available and has been selected.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim xxx&nbsp;as&nbsp;P</p>

<p class=Code>dim data&nbsp;as&nbsp;C</p>

<p class=Code>dim recordMsg&nbsp;as&nbsp;C</p>

<p class=Code>dim indx&nbsp;as&nbsp;N</p>

<p class=Code>ado.sql = "SELECT CustomerID, ContactName, CompanyName, city FROM Customers ORDER BY ContactName"</p>

<p class=Code>do.Rows = 20</p>

<p class=Code>do.Page = 1</p>

<p class=Code>if file.filename_parse(ado.MdbFilename,"Ne") <> "northwind.mdb" then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error","You have not selected the Northwind.MDB file.")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>end if</p>

<p class=Code>if file.exists(ado.mdbfilename) = .f. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error","The specified file was not found: " + ado.mdbfilename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>end if</td> </tr> </table><p>Display a multi-column list box 150 characters wide, with 6 columns each 25 characters wide. The buttons are selectively enabled or disabled based on the values of the <span class=Code1>info.currentPage</span> and <span class=Code1>info.TotalPages</span> variables returned by the previous call.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>data = ""</p>

<p class=Code>recordMsg = ""</p>

<p class=Code>indx = 1</p>

<p class=Code>ui_dlg_box("Access Data",<<%dlg%</p>

<p class=Code>{startup=init}</p>

<p class=Code><a class="wiki"  href="%O={@@}%.150,25indx^#data" rel="">%O={@@}%.150,25indx^#data</a>;</p>

<p class=Code><First?xxx.info.currentPage\>1> <Prev?xxx.info.currentPage\>1> {text=20,1:recordMsg}</p>

<p class=Code><Next?xxx.info.currentPage<xxx.info.TotalPages> <Last?xxx.info.currentPage<xxx.info.TotalPages>;</p>

<p class=Code>%dlg%,<<%code%</td> </tr> </table><p>Add the event handlers for the navigation buttons. Passing <a href="../Variable Functions/LOCAL_VARIABLES Function.html" title="LOCAL_VARIABLES Function" class="wiki">LOCAL_VARIABLES(</a>)allows the receiving <span class=Code1>get_data()</span>function to populate the local <span class=Code1>xxx</span> dot variable. The data returned is controlled by the <span class=Code1>do.page</span> variable.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if (a_dlg_button = "init") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(local_variables())</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "next") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;do.page = do.page + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (do.page > xxx.info.totalPages) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do.page = xxx.info.totalPages</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(local_variables())</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "prev") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;do.page = do.page -1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (do.page < 1) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do.page = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(local_variables())</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "first") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;do.page = 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(local_variables())</p>

<p class=Code>end if</p>

<p class=Code>if (a_dlg_button = "Last") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;do.page = xxx.info.totalPages</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_data(local_variables())</p>

<p class=Code>end if</p>

<p class=Code>%code%)</td> </tr> </table><p>Add the event handlers for the navigation buttons.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>function get_data&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;with vars</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;xxx = a5_ado_to_array(ado, do)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if xxx.error.HasError = .t. then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", xxx.error.errorText)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit function</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;data = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for i = 1 to do.rows</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_i = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for j = 1 to xxx.fields.FieldArray.size()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Put in a tab stop every 1.5 inches</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_i = data_i + xxx.array.row<a class="wiki"  href="i" rel="">i</a>.data<a class="wiki"  href="j" rel="">j</a>.initial + "{T="+1.5*j+"}"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next j</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = data + data_i + crlf()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next i</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;data = alltrim(data)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;recordMsg = "Page " + xxx.info.CurrentPage +" of " + xxx.info.TotalPages + " pages"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;indx = indx</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end with</p>

<p class=Code>end function</td> </tr> </table><p class=A5>Next</p>

<p> <a href="/Desktop/Guide/Design/View/Xdialog/Building Connection Strings.html" title="Building Connection Strings" class="wiki">Building Connection Strings</a></p>

<p class=A5>See Also</p>

<p> <a href="../../Objects/Array/A5_ADO_TO_ARRAY Function.html" title="A5_ADO_TO_ARRAY Function" class="wiki">A5_ADO_TO_ARRAY(</a>), <a href="/Desktop/Guide/Design/View/Xdialog/ADO Examples.html" title="ADO Examples" class="wiki">ADO Examples</a></p>

<p class=A5>Limitations</p>

<p>Desktop applications only</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+the+A5_ADO_TO_ARRAY__+function">-->


	<div class="wikitopline clearfix" >
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop","status":"pending"}--->
</body></html>