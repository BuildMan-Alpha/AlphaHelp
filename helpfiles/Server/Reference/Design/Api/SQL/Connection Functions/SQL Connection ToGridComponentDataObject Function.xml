<page>
   <topic>SQL::Connection ToGridComponentDataObject Function Function</topic>
   <syntax>L ToGridComponentDataObject(SQLStatement as C, [Arguments as SQL::Arguments,] DataArray as p[], FieldArray as p[] [, RowsToCopy = -1 as N [, StartRow = 1 as N ]])</syntax>
   <arguments>
     <argument>
         <name>SQLStatement</name>
         <description>Character</description>
     </argument>
     <argument>
         <name> Arguments</name>
         <description>SQL::Arguments</description>
     </argument>
     <argument>
         <name> DataArray</name>
         <description>Pointer</description>
     </argument>
     <argument>
         <name> FieldArray</name>
         <description>Pointer</description>
     </argument>
     <argument>
         <name> RowsToCopy = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> StartRow = 1</name>
         <description>Numeric</description>
     </argument>
   </arguments>
   <description>Fetch data to a Grid Component Data Object using a SQL Query.
Note: You must dim the arrays first:  DIM MyArray[1] as P
</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>SQL::Connection Object</ref>
   </see>
   <original><![CDATA[ SQL::Connection::ToGridComponentDataObject()
Syntax
Result_Flag as L = SQL::Connection>.ToGridComponentDataObject(  Query as C [, Arguments> as SQL::Arguments  [, DataArray as P [, FieldArray as P [, RowsToCopy as N [, StartRow as N ]]]] )
ArgumentDescription
Result_FlagTRUE (.T.) if the operation was successful; otherwise  FALSE (.F.).
&ltSQL::Connection>A SQL::Connection object.
QueryA SQL SELECT statement.
Arguments>Optional. A SQL::Arguments object.  One or more arguments to be resolved when the SELECT statement is executed.
DataArrayOptional. Pointer array. The DataArray argument will be initialized with current values.
FieldArrayOptional. Pointer array. The FieldArray argument will contain field information.
RowsToCopyOptional. Default = -1 (all). The number of rows to  copy.
StartRowOptional. Default = 1 (first). The first row to copy.

Description
The ToGridComponentDataObject() method fetches data in a format suitable  for a grid component using. Note: You must dim the arrays first.
Limitations
Example
dim DataArray[0] as P
dim FieldArray[0] as P
dim conn as SQL::Connection
dim cs as C
dim str as C
cs = "{A5API=Access, FileName='C:\Program Files\A5V8\MDBFiles\Alphasports.mdb',  UserName='Admin'}"
if .not. conn.open(cs) then
    ui_msg_box("Error",  conn.CallResult.text)
    end
end if
if .not. conn.ToGridComponentDataObject("select * from  customer", DataArray, FieldArray) then
    ui_msg_box("Error",  conn.CallResult.text)
    conn.close()
    end
end if
str = property_to_string(dataarray)
showvar(str)
conn.close()

The str variable's contents look like this.
1data1initial=1>
current=1>
IsNull=.F.>
>
2TEXT="">
initial="Michael">
current="Michael">
IsNull=.F.>
>
3TEXT="">
initial="Graham">
current="Graham">
IsNull=.F.>
>
...

See Also
SQL::Connection Object]]></original>
</page>