<page>
   <topic>SQL::Connection ToPropertyArray Function Function</topic>
   <syntax>L ToPropertyArray(SQLStatement as C [, Arguments as SQL::Arguments,] Array as p[] [, RowsToCopy = -1 as N [, StartRow = 1 as N ]])</syntax>
   <arguments>
     <argument>
         <name>SQLStatement</name>
         <description>Character</description>
     </argument>
     <argument>
         <name> Arguments</name>
         <description>SQL::Arguments</description>
     </argument>
     <argument>
         <name> Array</name>
         <description>Pointer</description>
     </argument>
     <argument>
         <name> RowsToCopy = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> StartRow = 1</name>
         <description>Numeric</description>
     </argument>
   </arguments>
   <description>Fetch data to a property array using a SQL query.
Note: You must dim the array first:  DIM MyArray[1] as P
</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>SQL::Connection Object</ref>
   </see>
   <original><![CDATA[ SQL::Connection::ToPropertyArray()
Syntax
Result_Flag as L = .ToPropertyArray(  Query as C [,  as SQL::Arguments  [, DataArray as P [, RowsToCopy as N [, StartRow as N ]]]] )
ArgumentDescription
Result_FlagTRUE (.T.) if the operation was successful; otherwise  FALSE (.F.).
A SQL::Connection object.
QueryThe SQL query that selects the data to retrieve.
Optional. A SQL::Arguments object.  One or more arguments to be resolved when the SELECT statement is executed.
DataArrayPointer array to receive the retrieved data.
RowsToCopyOptional. Default = -1 (all). The number of rows to  copy.
StartRowOptional. Default = 1 (first). The first row to copy.

Description
The ToPropertyArray() method fetches the results of the query to the  DataArray property array. The property  array will be initialized with columns matching the names of the fields  retrieved.
Note : Spaces are replaced  with underscores.
Limitations
Examples
dim conn as SQL::Connection
dim connString as C
dim query as C
dim args as SQL::Arguments
dim array0 as P
dim results as C
query = "select firstname, lastname from customer where  lastname > 'm'"
connString = "{A5API='Access', FileName='c:\program  files\a5v8\mdbfiles\alphasports.mdb'}"
if .not. conn.open(connString)
    ui_msg_box("Error",  conn.CallResult.text)
    end
end if
if .not. conn.ToPropertyArray(query, args, array, 5, 3)
    ui_msg_box("Error",  conn.CallResult.text)
    conn.close()
    end
end if
results = property_to_string(array)
ui_msg_box("Results", results)
conn.close()

See Also
SQL::Connection Object]]></original>
</page>