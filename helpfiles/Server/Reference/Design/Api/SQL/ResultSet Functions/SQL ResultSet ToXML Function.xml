<page>
   <topic>SQL::ResultSet ToXML Function Function</topic>
   <syntax>C ToXML([ RowsToCopy = -1 as N [, StartRow = -1 as N [, Documentname as C [, RowName as C [, Header as C [, ReferenceColumns as SQL::TableInfo [, UserContext as P]]]]]]])</syntax>
   <arguments>
     <argument>
         <name> RowsToCopy = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> StartRow = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> Documentname</name>
         <description>Character</description>
     </argument>
     <argument>
         <name> RowName</name>
         <description>Character</description>
     </argument>
     <argument>
         <name> Header</name>
         <description>Character</description>
     </argument>
     <argument>
         <name> ReferenceColumns</name>
         <description>SQL::TableInfo</description>
     </argument>
     <argument>
         <name> UserContext</name>
         <description>Pointer</description>
     </argument>
   </arguments>
   <description>Convert ResultSet an XML formatted string.
</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>SQL::ResultSet Object</ref>
      <ref>Limitations</ref>
   </see>
   <original> SQL::ResultSet::ToXML()
Syntax
XML_String as C = .ToXML(  [ RowsToCopy as N [, StartRow as N [, DocumentName as C  [, RowName as C [, Header as C [, ReferenceColumns as SQL::TableInfo  [, UserContext as P ]]]]]]] )
ArgumentDescription
XML_StringThe XML formatted data returned by the query.
A SQL::ResultSet object created with a DIM statement.
RowsToCopyOptional. Default = -1. The number of rows to copy.
StartRowOptional. Default = 1. The first row to copy.
DocumentNameOptional. The tag for the document element. See example.
RowNameOptional. The tag for the row element. See example.
HeaderOptional. The tag for the header element. See example.
ReferenceColumnsOptional. A SQL::TableInfo object.  When data is formatted for a column in the result set: (1) if ReferenceColumns  has a column with a matching name, that object will be used to format  the data; (2) otherwise the ColumnInfo property of the result set is used  to format the data.
UserContextOptional. The user context is passed into the evaluation  of the expression when data is formatted.

Description
The ToXML() method converts a SQL::ResultSet object to a XML formatted string.
Example
dim conn as SQL::Connection
dim rs as SQL::ResultSet
dim connString as C
dim select_exp as C
dim ti as SQL::TableInfo
connString = "{A5API='Access', FileName='c:\program  files\a5v8\mdbfiles\alphasports.mdb'}"
select_exp = "select * from customer where bill_state_region  = 'ny'"
if .not. conn.open(connString)
    ui_msg_box("Error",  conn.CallResult.text)
    end
end if
if .not. conn.execute(select_exp)
    ui_msg_box("Error",  conn.CallResult.text)
    conn.close()
    end
end if
rs = conn.ResultSet
ti = rs.ToTableInfo()
ui_msg_box("XML Data", rs.toxml(-1, -1, "DocName",  "RowName", "HeaderName"))
conn.close()

The XML data looks like this:
HeaderName

    
        Michael
        Graham
    
    
        Sally
        Peabody
    
...

See Also
SQL::ResultSet Object
Limitations</original>
</page>