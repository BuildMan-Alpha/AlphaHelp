<page>
   <topic>SQL::ResultSet ToJSON Function Function</topic>
   <syntax>C ToJSON([ RowsToCopy = -1 as N [, StartRow = -1 as N [, ReferenceColumns as SQL::TableInfo [, UserContext as P]]]])</syntax>
   <arguments>
     <argument>
         <name> RowsToCopy = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> StartRow = -1</name>
         <description>Numeric</description>
     </argument>
     <argument>
         <name> ReferenceColumns</name>
         <description>SQL::TableInfo</description>
     </argument>
     <argument>
         <name> UserContext</name>
         <description>Pointer</description>
     </argument>
   </arguments>
   <description>Convert a ResultSet to a JSON formatted string.
</description>
   <discussion>
      ...put discussion here....
   </discussion>
   <example><![CDATA[
...put example code here....
]]></example>
   <sections>
       <section>
            <description>put description here</description>
            <example><![CDATA[
      ...put example here....
]]></example>
       </section>
   </sections>
   <see>
      <ref>SQL::ResultSet Object</ref>
      <ref>SQL ResultSet::ToJSONObjectSyntax Function</ref>
      <ref>Limitations</ref>
      <ref>Desktop applications only prior to Version 9 Platinum.</ref>
   </see>
   <original> SQL::ResultSet::ToJSON()
Syntax
Result_Flag as L = .ToJSON(  Query as C [,  as SQL::Arguments  ] [, RowsToCopy as N [, StartRow as N [, ReferenceColumns as SQL::TableInfo  [, UserContext as P ]]]] )
ArgumentDescription
Result_FlagTRUE (.T.) if the operation was successful; otherwise  FALSE (.F.).
A SQL::ResultSet object.
QueryA SQL SELECT statement.
Optional. A SQL::Arguments object.  One or more arguments to be resolved when the SELECT statement is executed.
RowsToCopyOptional. Default = -1 (all). The number of rows to  copy.
StartRowOptional. Default = -1 (current). The first row to copy.
ReferenceColumnsOptional. A SQL::TableInfo object.  When data is formatted for a column in the result set: (1) if ReferenceColumns  has a column with a matching name, that object will be used to format  the data; (2) otherwise the ColumnInfo property of the result set is used  to format the data.
UserContextOptional. The user context is passed into the evaluation  of the expression when data is formatted.

Description
The ToJSON() method converts the data in one or more rows to an implementation  of JavaScript Object Notation format specific to the Alpha Five AJAX implementation.
The function formats the data in column major order with indexes to  map the rows using objects for each column with index, name, value and  (optionally) HREF tags.
You can control column data formatting with . If the named expression  HREF is defined for a column, the function will generate the HREF tag  using the expression provided. If ExternalFileNameExpression is set, the data will be stored to a file as well.
Example
 

See Also
SQL::ResultSet Object,SQL ResultSet::ToJSONObjectSyntax Function
Limitations
Desktop applications only prior to Version 9 Platinum.</original>
</page>