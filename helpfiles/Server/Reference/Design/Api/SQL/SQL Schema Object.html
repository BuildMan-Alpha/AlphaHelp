	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>SQL::Schema Object</p>



<p>A <span class=Code1>SQL::Schema</span> object (a database description) 
 is a container for one or more <a href="SQL TableInfo Object.html" title="SQL TableInfo Object" class="wiki">SQL::TableInfo</a> 
 objects (table descriptions).</p>



<p class=A5><a name=Properties>Properties</a></p>



<p>The <span class=Code1>SQL::Schema</span> object has the following properties.</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Property</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Type</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Mode</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Comment</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The comment stored for the table (if the database supports 
 it).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Name</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The unique name of the table. Note: The table must be 
 unique for the owner, but may not be globally unique.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NativeAPI</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The name of the API active when this object was created.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>NativeSyntax</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The name of the syntax at the time the object was created.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Owner</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The SQL database user or group that owns the table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Table</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>P</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>An array of table ( <a href="SQL TableInfo Object.html" title="SQL TableInfo Object" class="wiki">SQL::TableInfo</a> 
 ) definitions.</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>TableInDependencyOrder</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>P</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>R</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>An array of table ( <a href="SQL TableInfo Object.html" title="SQL TableInfo Object" class="wiki">SQL::TableInfo</a> 
 ) definitions</span> ordered from the top of the dependency hierarchy.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>XML</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>RW</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The schema in XML format.</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> :&nbsp;as&nbsp;of 
 the writing of this help topic, it is impossible to DIM an array of objects 
 based on a class. The following code sample shows a work-around.</p>



<p>This example creates an array containing five <span class=Code1>SQL::TableInfo</span> 
 objects.</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>dim ti&nbsp;as&nbsp;SQL::TableInfo</p>


<p class=Code>dim arr[5]&nbsp;as&nbsp;P</p>


<p class=Code>arr[1] = ti</p>


<p class=Code>for i = 2 to 5</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;arr[i] = ti.clone()</p>


<p class=Code>next i</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> :The <span class=Code1>TableInDependencyOrder</span> 
 property lists all tables in the order they should be created and populated 
 in copying them to a new database.</p>



<p class=A5><a name=Methods>Methods</a></p>




<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 14.984%;">
<col style="width: 85.015%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableHead>Method</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema AddTable Function.html" title="SQL Schema AddTable Function" class="wiki">::AddTable(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Gets the subscript index of the requested column name.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema Clear Function.html" title="SQL Schema Clear Function" class="wiki">::Clear(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Clears out the schema&nbsp;as&nbsp;if it had just been 
 created.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema Clone Function.html" title="SQL Schema Clone Function" class="wiki">::Clone(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Makes a copy of a schema and its contents.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema ListTables Function.html" title="SQL Schema ListTables Function" class="wiki">::ListTables(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Lists tables in the current cache.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema ListTablesWithTypes Function.html" title="SQL Schema ListTablesWithTypes Function" class="wiki">::ListTablesWithTypes(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Lists tables and types in the current cache.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema TableNumber Function.html" title="SQL Schema TableNumber Function" class="wiki">::TableNumber(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Returns the subscript index of the requested table name 
 in the table array property.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema TablesReferencedBy Function.html" title="SQL Schema TablesReferencedBy Function" class="wiki">::TablesReferencedBy(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Returns a set of tableinfos for tables referenced by the table passed in  
 in the table array property.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema TablesReferencing Function.html" title="SQL Schema TablesReferencing Function" class="wiki">::TablesReferencing(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Returns a set of tableinfos for tables that reference the table passed in 
 in the table array property.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 14.984%;" valign="top" width="14.984%">
<p class=TableLeft><a href="Schema Functions/SQL Schema UpdateStatistics Function.html" title="SQL Schema UpdateStatistics Function" class="wiki">::UpdateStatistics(</a>)</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 85.015%;" valign="top" width="85.015%">
<p class=TableLeft>Returns information on the tables in the schema for 
 the specified connection.</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="AlphaDAO Objects.html" title="AlphaDAO Objects" class="wiki">SQL Objects</a></p>





<p class=A5>Limitations</p>




<p class=A5>Example</p>
<p>This example interactive window session shows how to use the <strong>sql::schema</strong> object and the <strong>tablesReferencing </strong>and <strong>tablesReferencedBy </strong>methods of the <strong>sql::schema</strong> object.</p>


<p>The connection string is pointing to a SQL Server version of Northwind.
</p>
<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>dim cn as sql::connection <br>
?cn.open("::Name::nw")<br>
= .T.<br>
dim s as sql::Schema<br>
?cn.GetSchema(s)<br>
= .T.<br>
<br>
?s.TableNumber("customers")<br>
= 2<br>
dim tiCustomer as sql::TableInfo<br>
tiCustomers = s.table[2]<br>
r1 = s.TablesReferencedBy(tiCustomers)<br>
?r1.table.count <br>
= 0<br>
r2 = s.TablesReferencing(tiCustomers)<br>
?r2.table.Count<br>
= 1<br>
?r2.table<a class="wiki"  href="1" rel="">1</a>.name <br>
= "Orders"<br>
<br>
dim tiOrders as sql::TableInfo <br>
?s.tableNumber("orders")<br>
= 5<br>
tiOrders = s.table[5]<br>
r3 = s.TablesReferencedBy(tiOrders)<br>
<br>
?r3.Table.count <br>
= 3<br>
<br>
?r3.table[1].name <br>
= "Customers"<br>
<br>
?r3.table[2].name <br>
= "Employees"<br>
<br>
?r3.table[3].name <br>
= "Shippers"<br>
<br>
r4 = s.TablesReferencing(tiOrders)<br>
?r4.Table.count <br>
= 1<br>
<br>
?r4.table[1].name <br>
= "Order Details"<br>
</p></td></tr></table>
<p> </p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL+Schema+Object">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"accept"}--->
</body></html>