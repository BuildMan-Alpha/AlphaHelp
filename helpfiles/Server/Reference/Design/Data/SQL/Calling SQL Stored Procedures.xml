<page>
	<topic>Calling SQL Stored Procedures</topic>
	<description>Stored Procedures are compiled SQL code stored in the database. Calling stored procedures as opposed to sending over query strings improves the performance of a web application. Not only is there less network traffic since only short commands are sent instead of long query stings, but the execution of the actual code itself also improves. The reason is because a stored procedure is already compiled ahead of time. Stored procedures are also cached by SQL Server when they are run to speed things up for subsequent calls.</description>
<sections>
<section>
	
	<description>Other than improving performance, stored procedures are also helpful because they provide another layer of abstraction for your web application. For instance, you can change a query in a stored procedure and get different results without having to recompile your objects. Using stored procedures also makes your objects cleaner, and SQL Server's convenient backup tool makes it easy to back them up.
</description>
	
</section>	
	
<section>
	<title>Examples</title>
	<description>The following script was stored in an A5W page named "sql_connect.a5w". The values for the variables password, username, and Database_name were provided.</description>
	<example><![CDATA[<%a5
Dim Conn as P
Dim rs as P
Dim sql as C
dim connection_string as C
conn = ole.create("ADODB.Connection")
rs = ole.create("adodb.recordset")
connection_string = "Provider=MSDASQL.1;Password= " + password + ";User ID= " + username + " ;Persist Security Info=True;Initial Catalog=" + Database_name + ";Data Source=" + Database_name
conn.ConnectionString = connection_string
%>]]></example>
</section>		
<section>
	
	<description>The page that needed to make a connection included "sql_connect.a5w".</description>
	<example><![CDATA[<%a5
a5w_include("sql_connect.a5w")
dim rs as P
rs = ole.create("adodb.recordset")
rs.CursorType = 3
conn.Open()
sql = "sp_user_names " + "'" + user_id +"'"
rs.Open(sql,conn)
Name = rs.fields.item(0).value
%> ]]></example>
</section>		
<section>
	
	<description>Thanks To: David Brown. </description>
	
</section>	
	
</sections>	
<limitations>Web publishing applications only.</limitations>
	
</page>