	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>DLG_INTUSER Dialog Component</p>



<p class=A5>Purpose</p>



<p>The DLG_INTUSER dialog component is used by administrators to edit  security information for internal users. </p>



<p class=Pix><img src="images/ASW_dlg_intuser.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 446px;
							height: 334px;
							border-style: none;
							border-style: none;"
					width=446
					height=334
					border=1> </p>



<p class=A5>Description</p>



<p>The DLG_INTUSER dialog component contains the text controls necessary 
 to edit a <span class=Code1>internal_users</span> table record and a matching security record for the user, if a security record exists. </p>


<p>Control names for fields that contain data for the <span class="Code1">internal_users</span> table are the same as the field names in the table. The name of each security control in the dialog must exactly match the name of the field in the user table. A list of valid security field names can be found by using the <a href="http://support.alphasoftware.com/alphafivehelpv8/Functions/A5WS_User_File_Field_List%28%29.htm">A5WS_User_File_Field_List()</a> function. Two other fields are recognized by the security functions used in this component, <span class="Code1">confirm_password</span> and <span class="Code1">groups</span>. <span class="Code1">Confirm_password</span> is used to confirm a password entry, and <span class="Code1">groups</span> saves the security group assignments for this user. </p>


<p>There are three controls that have the <span class="Button">control type</span> set to "hidden". These controls are <span class="Code1">emp_id, guid,</span> and <span class="Code1">ulink</span>. These controls are required and hold values used in the events to find and save the correct records in the tables. The <span class="Code1">guid</span> control is empty if there is no security record found for the user.  </p>


<p>There are two email fields on the dialog. One is <span class="Code1">emp_email </span>and displays the email saved in the <span class="Code1">internal_users</span> table as a label. The other is <span class="Code1">email</span> that is a validation email saved in the security table used to validate the users identity. These may have the same value or they may be different. The <span class="Code1">userid </span>in this configuration is also an email address and it may match the values in the other email fields. </p>


<p class=A5>Containers</p>



<p><a href="../A5W/ASWUSERONE.A5W.html" title="ASWUSERONE.A5W" class="wiki">ASWUSERONE.A5W</a></p>



<p class=A5>Notable Grid Control Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader" colspan="1" rowspan="1">
<p class=TableHead>Control</td>
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft><a class="wiki"  href="Merge Cells Begin" rel="">Merge Cells Begin</a>.1</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Merge Cell  Properties > Row heading </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Name (First - Last) ".</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>Emp_Fname</td>
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> set to TRUE</p>


<p class=TableLeft><span class=Button>General > Require value </span> set to TRUE</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>Dept</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Dropdown".</p>

</td></tr>
 
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> set to TRUE</p>


<p class=TableLeft><span class=Button>General > Require value </span> set to TRUE</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">DropDownBox Properties  > Choices </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Define Choices > List type</span> 
 is set to "Dynamic".</p>


<p class=TableLeft><span class=Button>Data Source > Data source type</span> 
 is set to "Variable".</p>


<p class=TableLeft><span class=Button>Data Source > Variable name</span> 
 is set to "deptlist".</p>

</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>Password</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Textbox  Properties > MaxLength </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "60" Must large enough to hold encrypted password. </p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class="Button">Textbox  Properties > Is a password field </span> </td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE. </p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class="Button">Row  Properties > Security Groups </span> </td>
<td class="TableCell">
<p class=TableLeft>Set to "Accounting, Administrators, Marketing". </p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>Confirm_Password</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Textbox  Properties > Is a password field </span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class="Button">Row  Properties > Security Groups </span> </td>
<td class="TableCell">
<p class=TableLeft>Set to "Accounting, Administrators, Marketing".</p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>email</td>
<td class="TableCell">
<p class=TableLeft><span class="Button">Row  Properties > Bubble help text</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Email used to validate user and send lost data to user .".</p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
  <p class=TableLeft>redirpage</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Dropdown".</p>

</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">DropDownBox Properties  > Choices </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Define Choices > List type</span> 
 is set to "Dynamic".</p>


<p class=TableLeft><span class=Button>Data Source > Data source type</span> 
 is set to "Variable".</p>


<p class=TableLeft><span class=Button>Data Source > Variable name</span> 
 is set to "pagelist".</p>

</td></tr> 
 
<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class="Button">Row  Properties > Security Groups </span> </td>
<td class="TableCell">
<p class=TableLeft>Set to "Accounting, Administrators, Marketing".</p>


</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="4" colspan="1">
<p class=TableLeft>groups</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control Type </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Checkbox".</p>

</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">CheckBox Properties  > Choices </span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Define Choices > List type</span> 
 is set to "Dynamic".</p>


<p class=TableLeft><span class=Button>Data Source > Data source type</span> 
 is set to "Variable".</p>


<p class=TableLeft><span class=Button>Data Source > Variable name</span> 
 is set to "grouplist".</p>

</td></tr> 
 
<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class="Button">CheckBox Properties  > Orientation </span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Vertical" </p>


</td></tr> 

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class="Button">Row  Properties > Security Groups </span> </td>
<td class="TableCell">
<p class=TableLeft>Set to "Accounting, Administrators, Marketing".</p>


</td></tr>
</table>

<p class=A5>Event Code</p>


<p>The <span class=Code1>Initialize</span> event code finds user records from the <span class="Code1">internal_users</span> table and security data and populates the controls. If the <span class=Code1>Request.variables.emp_id</span> variable has a non-null value, 
 the script uses this value to retrieve the corresponding record from the 
 <span class=Code1>internal_users</span> table. The variable value was passed form the previous page. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>If eval_valid("Request.variables.emp_id ") ' Value passed to page - also used in 'ulink' </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;
  if Request.variables.emp_id <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query.filter  = "emp_id = \""+Request.variables.emp_id+"\"" )
 ' find the record</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query.order  = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\internal_users.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qdx = tbl.query_create()</td></tr>
</table>


<p>If the query finds a single record, the script writes the values from the fields of the internal_users record to the values 
in the dialog's controls.  </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if qdx.records_get() = 1 ' got one match</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.emp_Fname.value = alltrim(tbl.emp_Fname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.emp_Lname.value = alltrim(tbl.emp_Lname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.emp_id.value = alltrim(tbl.emp_id)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.dept.value = alltrim(tbl.Dept)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.ulink.value = alltrim(tbl.emp_id)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


</td></tr>
</table>

<p>The event code then re-populates the <span class="Code1">ulink</span> control with the <span class="Code1">emp_id</span> from the record found and uses that value to find a security record for the user. The value is placed in a request variable to pass to the <a href="../../Api/Functions/Web Application/Security Functions/A5WS_Get_User_Values Function.html" title="Deprecated. Use A5WS_Get_WebUser_Values() instead" class="wiki">A5WS_GET_USER_VALUES(</a>) function. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.variables.ulink = alltrim(CurrentForm.Controls.emp_id.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a5ws_get_user_values(CurrentForm,request)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'find security record by 'ulink' as we don't have 'GUID', do not use email as it can change</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>



<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</p>


</td></tr>
</table>

<p>Finally, If  the validation <span class="Code1">email</span> control is empty, the userid may be placed in the control as a default value. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>'set validation email address to same as userid if no email has been entered</p>


<p class=Code>if alltrim(CurrentForm.Controls.userid.value) <> "" </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if alltrim(CurrentForm.Controls.email.value) = "" </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.email.value = alltrim(CurrentForm.Controls.userid.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</td></tr>
</table>

<p>&nbsp;</p>


<p>The <span class=Code1>Validate</span> event code validates the security data entered, if any, and saves it if there are no errors. The function <a href="../../Api/Functions/Web Application/Security Functions/A5WS_Save_User_Values Function.html" title="Deprecated. Use A5WS_Save_WebUser_Values() instead" class="wiki">A5WS_SAVE_USER_VALUES(</a>)will return <span class="Code1">CurrentForm.Has_error = .t.</span> if the data does not meet the security validation rules. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5ws_save_user_values(CurrentForm,request) ' validate and save
</td></tr>
</table>


<p>&nbsp;</p>


<p>The <span class=Code1>AfterValidate</span> event code starts by setting a Flag variable to designate if this is a new record. The event code then searches for a <span class="Code1">internal_users</span> record that matches the <span class="Code1">emp_id</span> control. This control would have a value if this is an existing record. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim FlagNew as l = .T.</p>


<p class=Code>if CurrentForm.Controls.emp_id.value <> "" ' indicates existing record (could also use any other known value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.filter = "emp_Id= \""+alltrim(CurrentForm.Controls.emp_id.value)+"\""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;query.order = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\internal_users.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;qdx = tbl.query_create()</td></tr>
</table>

<p>If the query finds a single record, the script writes the values 
in the dialog's controls into the fields of the <span class="Code1">internal_users</span> record. It sets the flag to FALSE to indicate this is an existing record. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if qdx.records_get() = 1 ' got one</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.emp_fname = alltrim(CurrentForm.Controls.emp_Fname.value) </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.emp_lname = alltrim(CurrentForm.Controls.emp_Lname.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.email = alltrim(CurrentForm.Controls.userid.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.Dept = alltrim(CurrentForm.Controls.dept.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FlagNew = .F. ' no need to resave security as 'ulink' was already used to find security record</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;elseif qdx.records_get() > 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FlagNew = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


<p class=Code>end if</td></tr>
</table>

<p>If the flag is TRUE, this is a new record and a new record is saved into the <span class="Code1">internal_users</span> table. After the record is saved, but before the table is closed, the <span class="Code1">emp_id </span>value for this new record is saved in a request variable. The security values are re-saved by the <a href="../../Api/Functions/Web Application/Security Functions/A5WS_Save_User_Values Function.html" title="Deprecated. Use A5WS_Save_WebUser_Values() instead" class="wiki">A5WS_SAVE_USER_VALUES(</a>) function to add this <span class="Code1">emp_id</span> value to the security <span class="Code1">ulink</span> field. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if FlagNew = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl = table.open("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\internal_users.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.enter_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.emp_fname = alltrim(CurrentForm.Controls.emp_Fname.value) </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.emp_lname = alltrim(CurrentForm.Controls.emp_Lname.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.email = alltrim(CurrentForm.Controls.userid.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.Dept = alltrim(CurrentForm.Controls.dept.value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.enter_end()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;request.variables.ulink = alltrim(tbl.emp_id)	'get new 'ulink' value</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.close()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a5ws_save_user_values(CurrentForm,request) ' resave security with new 'ulink' value</p>


<p class=Code>end if</td></tr>
</table>

<p>The <span class=Code1>Finally, event code reloads the security values using the function <a href="../../Api/Functions/Web Application/Security Functions/A5WS_Get_User_Values Function.html" title="Deprecated. Use A5WS_Get_WebUser_Values() instead" class="wiki">A5WS_GET_USER_VALUES(</a>) to show the latest changes. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>a5ws_get_user_values(CurrentForm,request)</td></tr>
</table>

<p>&nbsp;</p>


<p>The <span class=Code1>Activate</span> event code creates the variables needed for the dropdown and checkbox controls. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
	
<p class=Code>grouplist = a5ws_get_groups(request,.t.)</p>


<p class=Code>'Departments are built from security groups in this case</p>


<p class=Code>'remove 'customers' from list of groups </p>


<p class=Code>deptlist = filter_string(grouplist,"Customers",crlf(),.T.)</p>


<p class=Code>'remove second word for each line, which is a group guid</p>


<p class=Code>deptlist = *for_each(x,word(x,1,"|"),deptlist)</p>


<p class=Code>'create redirect page dropdown</p>


<p class=Code>pagelist = a5ws_get_page_list(request)</p>


</td></tr>
</table>



<p class=A5>See Also</p>



<p><a href="../../../../Guide/Design/View/Grid/Web Publishing Components.html" title="Web Publishing Components" class="wiki">Web Publishing Components</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DLG_INTUSER+Dialog+Component">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"server,design,ref,component"}--->
</body></html>