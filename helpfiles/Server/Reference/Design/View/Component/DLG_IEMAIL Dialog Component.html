	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>DLG_IEMAIL Dialog Component</p>



<p class=A5>Purpose</p>



<p>The <span class=Code1>Validate</span> event of the dialog sends an email 
 using the <a href="/Api/Functions/System/Email Functions/EMAIL_SEND Function.xml" title="EMAIL_SEND Function" class="wiki">EMAIL_SEND(</a>) function.</p>



<p class=Pix><img src="images/ASW_DLG_IEMAIL.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 572px;
							height: 314px;
							float: none;
							border-style: none;
							border-style: none;"
					width=572
					height=314
					border=0> </p>



<p class=A5>Description</p>



<p>The DLG_IEMAIL dialog component contains four text box controls and 
 a text area control. The Send To, CC, and BCC controls support lookups 
 of the <span class=Code1>firstname</span>, <span class=Code1>lastname</span>, 
 and <span class=Code1>email</span> fields of the <span class=Code1>customer</span> 
 table.</p>



<p class=A5>Container</p>



<p><a href="../A5W/ASWSENDEMAIL.A5W.html" title="ASWSENDEMAIL.A5W" class="wiki">ASWSENDEMAIL.A5W</a></p>



<p class=A5>Notable Grid Control Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader" colspan="1" rowspan="1">
<p class=TableHead>Control</td>
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>sendto</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Custom error message</span> 
 set to "&nbsp;Send To Email Address is Required&nbsp;".</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup > Lookup Definition</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup Window > Grid name</span> 
 is <a href="GRD_CUSTEMAIL Grid Component.html" title="GRD_CUSTEMAIL Grid Component" class="wiki">GRD_CUSTEMAIL</a></p>


<p class=TableLeft><span class=Button>Field Mapping > Field map</span> 
 copies the <span class=Code1>Email</span> field to <span class=Code1>Sendto</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>cc</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup > Lookup Definition</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup Window > Grid name</span> 
 is <a href="GRD_CUSTEMAIL Grid Component.html" title="GRD_CUSTEMAIL Grid Component" class="wiki">GRD_CUSTEMAIL</a></p>


<p class=TableLeft><span class=Button>Field Mapping > Field map</span> 
 copies the <span class=Code1>Email</span> field to <span class=Code1>cc</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>bcc</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup > Lookup Definition</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Lookup Window > Grid name</span> 
 is <a href="GRD_CUSTEMAIL Grid Component.html" title="GRD_CUSTEMAIL Grid Component" class="wiki">GRD_CUSTEMAIL</a></p>


<p class=TableLeft><span class=Button>Field Mapping > Field map</span> 
 copies the <span class=Code1>Email</span> field to <span class=Code1>bcc</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="2" colspan="1">
<p class=TableLeft>subject</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Custom error message</span> 
 set to "&nbsp;Subject Line is Required&nbsp;".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft>body</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textarea"</td></tr>
</table>

<p class=A5>Notable Component Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Submit/Reset Buttons > Submit 
 button label</span></td>
<td class="TableCell">
<p class=TableLeft>Changed from "Submit" to "Send"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Submit/Reset Buttons > Reset button 
 label</span></td>
<td class="TableCell">
<p class=TableLeft>Changed from "Reset" to "Clear"</td></tr>
</table>

<p class=A5>Event Code</p>



<p>This code was placed under the <span class=Button>Server Events > 
 Validate</span> property. The script cancels the email send if the user 
 does not have an email profile.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if email_profile_valid()= .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Has_Error 
 = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Error_Message 
 = "&nbsp;Email Profile Not Defined"</p>


<p class=Code>end if</td></tr>
</table>

<p>This code was placed under the <span class=Button>Server Events > 
 AfterValidate</span> property. If the email send was unsuccessful, it 
 returns an error. Otherwise, it erases the form's field in readiness for 
 another email.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if email_send(CurrentForm.Controls.sendto, CurrentForm.Controls.subject, 
 CurrentForm.Controls.body, "", CurrentForm.Controls.cc, CurrentForm.Controls.bcc) 
 = 0 'not sent</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Has_Error 
 = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Error_Message 
 = "&nbsp;Error: Email Not Sent"</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.sendto 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.cc 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.bcc 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.subject 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.body 
 = ""</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="/Index/AlphaSportsWeb/Web Publishing Components.html" title="Web Publishing Components" class="wiki">Web Publishing Components</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DLG_IEMAIL+Dialog+Component">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"server,design,ref,component"}--->
</body></html>