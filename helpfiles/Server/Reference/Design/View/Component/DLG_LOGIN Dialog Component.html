	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>DLG_LOGIN Dialog Component</p>



<p class=A5>Purpose</p>



<p>The DLG_LOGIN dialog component accepts user name and password to support 
 the login process. Event code checks into the <span class=Code1>customer</span> 
 and <span class=Code1>user_names</span> tables to see if the user is known. 
 If the answer is yes, the code sets the user's access rights and saves 
 them in a cookie using the <a href="../../Api/Internet Methods/RESPONSE.ADD_COOKIE Method.html" title="RESPONSE.ADD_COOKIE Method" class="wiki">RESPONSE.ADD_COOKIE(</a>) 
 method.</p>



<p class=Pix><img src="images/ASW_dlg_login.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 248px;
							height: 87px;
							float: none;
							border-style: none;
							border-style: none;"
					width=248
					height=87
					border=0> </p>



<p class=A5>Description</p>



<p>The DLG_LOGIN dialog component contains two text box controls and two 
 buttons.</p>



<p class=A5>Containers</p>



<p><a href="../A5W/LOGIN.A5W.html" title="LOGIN.A5W" class="wiki">LOGIN.A5W</a>,  
 <a href="../A5W/LOGIN.A5W.html" title="LOGIN.A5W" class="wiki">LOGINUSERDATA.A5W</a></p>



<p class=A5>Notable Grid Control Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader" colspan="1" rowspan="1">
<p class=TableHead>Control</td>
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="1" colspan="1">
<p class=TableLeft>user_name</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="3" colspan="1">
<p class=TableLeft>password</td>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Control type</span></td>
<td class="TableCell">
<p class=TableLeft>Set to "Textbox"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Control Settings > Validation 
 rules</span></td>
<td class="TableCell">
<p class=TableLeft><span class=Button>General > Enable rules</span> 
 set to TRUE.</p>


<p class=TableLeft><span class=Button>General > Require value</span> 
 set to FALSE.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td class="TableCell">
<p class=TableLeft><span class=Button>Textbox properties > Is a password 
 field</span></td>
<td class="TableCell">
<p class=TableLeft>Set to TRUE.</td></tr>
</table>

<p class=A5>Notable Component Property Settings</p>




<table style="x-cell-content-align: top;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader">
<p class=TableHead>Property</td>
<td class="TableHeader">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Submit/Reset Buttons > Submit 
 button label</span></td>
<td class="TableCell">
<p class=TableLeft>Changed from "Submit" to "Login"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell">
<p class=TableLeft><span class=Button>Submit/Reset Buttons > Reset button 
 label</span></td>
<td class="TableCell">
<p class=TableLeft>Changed from "Reset" to "Clear"</td></tr>
</table>

<p class=A5>Event Code</p>



<p>This <span class=Code1>Validate</span> event code tests the user name 
 and password for both "public" and "internal" users. 
 The script first tests to see if the user name and password exist in the 
 <span class=Code1>customer</span> (public) table, then in the internal 
 <span class=Code1>user_names</span> table.</p>



<p>In the case a true customer, his or her email address is the user name.</p>



<p>All users, public and internal, have a minimum user level of 1. Customers 
 are type "C" and internal users are type "I". This 
 script computes the value of <span class=Code1>login_val</span>, which 
 is saved in a session cookie. The value of <span class=Code1>login_val</span> 
 is defined as: <span class=Code1>id number + | + type + | + user level</span>. 
 For example: "00001|I|2".</p>



<p>The script first tests the values in the dialog's controls. If either 
 is NULL, the script sets the <span class=Code1>currentform.has_error</span> 
 variable to TRUE (.T.), sets the error message, and exits. Otherwise, 
 the script DIMs working variables and sets <span class=Code1>login_val</span> 
 to NULL.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if user_name = "" .or. password = "" 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentform.has_error 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentform.error_message 
 = "&nbsp;User name or password cannot be blank."</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 customer_values&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 internal_values&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 login_val&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;login_val 
 = ""</td></tr>
</table>

<p>Next, the script looks into the <span class=Code1>customer</span> and 
 <span class=Code1>user_names</span> tables for matches for the <span class=Code1>user_name</span> 
 value.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;customer_values 
 = lookup("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\customer", "email =" 
 + quote(user_name), "alltrim(password) + \"|\" + alltrim(customer_id)")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;internal_values 
 = lookup("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\user_names", "user_name=" 
 + quote(user_name), "alltrim(password) + \"|\" + user_id 
 + \"|\" + level")</td></tr>
</table>

<p>If the <span class=Code1>customer</span> user name value matches, the 
 script computes the value of <span class=Code1>login_val</span> and displays 
 <a href="../A5W/INDEX.A5W.html" title="INDEX.A5W" class="wiki">INDEX.A5W</a>. The access level is initially set 
 to 1. If there is no match in the <span class=Code1>customer</span> table, 
 the script next checks the <span class=Code1>user_names</span> table and 
 checks for a match. If a match is found, the script computes <span class=Code1>login_val</span>. 
 In this case the user's specific access level is inserted into <span class=Code1>login_val</span> 
 and displays <a href="../A5W/ASWINDEX.A5W.html" title="ASWINDEX.A5W" class="wiki">ASWINDEX.A5W</a>. If no match 
 is found, the script generates an error message.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 word(customer_values, 1, "|") = password then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login_val 
 = alltrim(word(customer_values, 2, "|") ) + "|C|1"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Currentform.RedirectTarget 
 = "index.a5w"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;elseif 
 word(internal_values,1,"|") = password then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login_val 
 = alltrim(word(internal_values, 2, "|") ) + "|I|" + 
 alltrim(word(internal_values, 3, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session.targetURL 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Currentform.RedirectTarget 
 = "aswindex.a5w"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ELSE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentform.has_error 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentform.error_message 
 = "&nbsp;Invalid user name or password."</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.Controls.password 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</td></tr>
</table>

<p>Finally, if the script has found a valid user entry in either table, 
 it writes a cookie named <span class=Code1>login</span> that contains 
 <span class=Code1>login_val</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 login_val <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.add_cookie("login", 
 login_val, 0)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</td></tr>
</table>

<p>The <span class=Code1>AfterValidate</span> event returns the user to 
 the prior page. The <span class=Code1>session.targetURL</span> variable 
 is only used for public pages. Its value will be blank for an internal 
 logon.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("session.targetURL") = .T. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 session.targetURL <> "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CurrentForm.RedirectTarget 
 = session.targetURL</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../../../../Guide/Design/View/Grid/Web Publishing Components.html" title="Web Publishing Components" class="wiki">Web Publishing Components</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DLG_LOGIN+Dialog+Component">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"server,design,ref,component"}--->
</body></html>