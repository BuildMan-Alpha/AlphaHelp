	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>SEARCH_UDF.A5W</p>



<p class=A5>Purpose</p>



<p>The SEARCH_UDF.A5W page contains the search code used by the <a href="ASWSEARCH.A5W.html" title="ASWSEARCH.A5W" class="wiki">ASWSEARCH.A5W</a> 
 page.</p>



<p class=A5>Description</p>



<p>The SEARCH_UDF.A5W page contains the following functions:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Fill_OptionWhat__|Fill_OptionWhat()))</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Fill_OptionField__|Fill_OptionField()))</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Fill_OptionRec__|Fill_OptionRec()))</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Fill_OptionVal__|Fill_OptionVal()))</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Fill_OptionWhat__|Fill_OptionWhat()))</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Find_Value__|Find_Value()))</p>

</li>
</ul>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Do not open 
 this page in the <span class=Screen>WYSIWYG</span> tab of the <span class=Screen>HTML 
 Editor</span> and then save it. This will result in the loss of Xbasic 
 code, which the underlying <span class=Screen>Microsoft ActiveX</span> 
 control does not properly support.</p>



<p class=A5>Links</p>



<p>The <a href="ASWSEARCH.A5W.html" title="ASWSEARCH.A5W" class="wiki">ASWSEARCH.A5W</a> page includes the 
 SEARCH_UDF.A5W page.</p>



<p class=A5><a name=Fill_OptionWhat__>Fill_OptionWhat()</a></p>



<p>The <span class=Code1>Fill_OptionWhat()</span> function returns the 
 formatted code for a list box.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION fill_optionwhat&nbsp;as&nbsp;C(currselections&nbsp;as&nbsp;C)</p>


<p class=Code>'first value is a table name</p>


<p class=Code>'second value is a display value</p>


<p class=Code>what_list = <<%text%</p>


<p class=Code>|< Select ></p>


<p class=Code>customer|Customers</p>


<p class=Code>product|Products</p>


<p class=Code>invoice_header|Invoices</p>


<p class=Code>%text%</p>


<p class=Code>'findwhat value is first value in currselections</p>


<p class=Code>fill_optionwhat = a5_html_list_populate(what_list, word(currselections, 
 1, "|"), 3)</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Fill_OptionBy__>Fill_OptionBy()</a></p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION fill_optionby&nbsp;as&nbsp;C (currselections&nbsp;as&nbsp;C)</p>


<p class=Code>'get a list of character fields in 'findwhat' table</p>


<p class=Code>by_list = "|< Select >"</p>


<p class=Code>if word(currselections, 1, "|") <> "" 
 ' a findwhat value is specified</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fld_list 
 = table.external_field_name_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\\" + word(currselections, 
 1, "|"), "n|t")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for 
 each foo in fld_list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 word(foo, 2, "|") = "C" 'only list character fields</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by_list 
 = by_list + crlf()+ word(foo, 1, "|") + "|" + w_upper(stritran(word(foo, 
 1, "|"), "_", " "))</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>end if</p>


<p class=Code>fill_optionby = a5_html_list_populate(by_list, word(currselections, 
 2, "|"), 3)</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Fill_OptionVal__>Fill_OptionVal()</a></p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION fill_optionval&nbsp;as&nbsp;C(currselections&nbsp;as&nbsp;C)</p>


<p class=Code>'get a list of unique values in field in 'findwhat' table</p>


<p class=Code>val_list = "|< Select >"</p>


<p class=Code>if word(currselections, 1, "|") <> "" 
 ' a findwhat value is specified</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fld 
 = word(currselections, 2, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 fld <> "" ' a findby value is specified</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val_list 
 = val_list + crlf()+ table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\\"+ 
 word(currselections, 1, "|"), "alltrim(" + fld + ")", 
 fld, "alltrim(" + fld + ") <> \"\" .and. 
 unique_key_value()")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</p>


<p class=Code>fill_optionval = a5_html_list_populate(val_list, word(currselections, 
 3, "|"), 3)</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Fill_OptionRec__>Fill_OptionRec()</a></p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION fill_optionrec&nbsp;as&nbsp;C(currselections&nbsp;as&nbsp;C)</p>


<p class=Code>'get a list of records in field in 'findwhat' table that 
 have findval 'value' in 'findby' field</p>


<p class=Code>rec_list = "|< Select >"</p>


<p class=Code>table = word(currselections, 1, "|")</p>


<p class=Code>fld = word(currselections, 2, "|")</p>


<p class=Code>val = word(currselections, 3, "|")</p>


<p class=Code>' The next list is used to determine what to value to return 
 and display to identify the record</p>


<p class=Code>' It has the format of 'table name|identifier field|content 
 expression</p>


<p class=Code>rec_disp_list =<<%text%</p>


<p class=Code>customer * customer_id * alltrim(firstname) + " " 
 + alltrim(lastname)</p>


<p class=Code>product * product_id * desc</p>


<p class=Code>invoice_header * Invoice_number * Invoice_number</p>


<p class=Code>%text%</p>


<p class=Code>if val <> "" ' a findval value is specified, 
 find display</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' 
 populate an array to find values to return</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;delete 
 a_disp</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim 
 a_disp<a class="wiki"  href="line_count(rec_disp_list)" rel="">line_count(rec_disp_list)</a>&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_disp.initialize_properties("table 
 * id * content", rec_disp_list)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;content_idx 
 = a_disp.find(lower(table), "lower(table)")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 content_idx > 0 ' a content_expression was found</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret_value 
 = a_disp<a class="wiki"  href="content_idx" rel="">content_idx</a>.content</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id 
 = a_disp<a class="wiki"  href="content_idx" rel="">content_idx</a>.id</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec_list 
 = rec_list + crlf()+ table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\\" 
 + table, "alltrim(" + id + ") + \"|\" + alltrim(" 
 + ret_value + ")", ret_value, "" + fld + "=\"" 
 + val + "\"")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</p>


<p class=Code>fill_optionrec = a5_html_list_populate(rec_list, word(currselections, 
 4, "|"), 3)</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Fill_OptionField__>Fill_OptionField()</a></p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION fill_optionfield&nbsp;as&nbsp;C(currselections&nbsp;as&nbsp;C)</p>


<p class=Code>'get a list of character fields in 'findwhat' table</p>


<p class=Code>field_list = "|< Select >"</p>


<p class=Code>table = word(currselections, 1, "|")</p>


<p class=Code>rec = word(currselections, 4, "|")</p>


<p class=Code>if table <> "" .and. rec <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fld_list 
 = table.external_field_name_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\\"+ table,"n|t")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for 
 each foo in fld_list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 word(foo, 2, "|") = "C" 'only list character fields</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field_list 
 = field_list + crlf()+ word(foo, 1, "|") + "|" + w_upper(stritran(word(foo, 
 1, "|"), "_", " "))</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>end if</p>


<p class=Code>fill_optionfield = a5_html_list_populate(field_list, word(currselections, 
 5, "|"), 3)</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Find_Value__>Find_Value()</a></p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>FUNCTION find_value&nbsp;as&nbsp;c(currselections&nbsp;as&nbsp;C)</p>


<p class=Code>find_value = ""</p>


<p class=Code>table = word(currselections,1,"|")</p>


<p class=Code>rec = word(currselections,4,"|")</p>


<p class=Code>fld = word(currselections,5,"|")</p>


<p class=Code>if fld = "" .or. rec = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;exit 
 function</p>


<p class=Code>end if</p>


<p class=Code>if fld = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;exit 
 function</p>


<p class=Code>end if</p>


<p class=Code>' This list is used to identify what identifier is used for 
 a table</p>


<p class=Code>rec_find_list =<<%text%</p>


<p class=Code>customer|customer_id</p>


<p class=Code>product|product_id</p>


<p class=Code>invoice_header|Invoice_number</p>


<p class=Code>%text%</p>


<p class=Code>delete a_find</p>


<p class=Code>dim a_find<a class="wiki"  href="line_count(rec_find_list)" rel="">line_count(rec_find_list)</a>&nbsp;as&nbsp;p</p>


<p class=Code>a_find.initialize_properties("table|id", rec_find_list)</p>


<p class=Code>content_idx = a_find.find(lower(table), "lower(table)")</p>


<p class=Code>if content_idx > 0 ' a content_expression was found</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;id 
 = a_find<a class="wiki"  href="content_idx" rel="">content_idx</a>.id</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;find_value 
 = table.external_record_content_get("<a class="wiki"  href="PathAlias.ADB_Path" rel="">PathAlias.ADB_Path</a>\\" 
 + table, fld, "", "" + id + "=\"" + 
 rec + "\"")</p>


<p class=Code>end if</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5>Page Security Information</p>



<p>Always Allowed</p>



<p class=A5>See Also</p>



<p><a href="AlphaSportsWeb Web Pages.html" title="AlphaSportsWeb Web Pages" class="wiki">Web Pages</a></p>


	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SEARCH_UDF.A5W">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"server,ref,a5w"}--->
</body></html>