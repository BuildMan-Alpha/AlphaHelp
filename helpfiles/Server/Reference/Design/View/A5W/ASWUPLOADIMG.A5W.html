	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>ASWUPLOADIMG.A5W</p>



<p class=A5>Purpose</p>



<p>The ASWUPLOADIMG.A5W page allows an administrator to upload images to the server to add to the <span class="Code1">product</span> table.</p>



<p class=A5>Description</p>



<p>The ASWUPLOADIMG.A5W page uses a process described in <a href="../../../../Guide/Design/View/A5W/Uploading Files to the Application Server.html" title="Uploading Files to the Application Server" class="wiki">Uploading Files to the Application_Server</a> to upload images to the server. Images are allowed in png, bmp, and jpg formats. Xbasic code on the page checks the file for proper format, converts the image to jpg, and then add the image to the proper product record as an image file reference field. The page includes the <a href="../Component/GRD_PRODIMG Grid Component.html" title="GRD_PRODIMG Grid Component" class="wiki">GRD_PRODIMG</a> grid component to show the current image for a specific product record. </p>


<p>Two parameters are passed in the page URL. A filter expression is included to filter the <a href="../Component/GRD_PRODIMG Grid Component.html" title="GRD_PRODIMG Grid Component" class="wiki">GRD_PRODIMG</a> grid to show a single record. The ASWUPLOADIMG.A5W page also receives the <span class="Code1">pid</span> parameter    in the calling URL. <span class="Code1">pid</span> must be a valid value    from the <span class="Code1">product_ID</span> field. For example: <span class="Code1">aswuploadimg.a5w?pid=P003&grd_prodimg_filter=Product%5Fid%3D%22P003%22</span>. Note: The filter expression in encoded with <a href="../../Api/Functions/Encryption Functions/URLENCODE Function.html" title="URLENCODE Function" class="wiki">URLENCODE(</a>) to replace characters are not allowed within URLs. <span class="Code1">pid </span>is saved in a hidden field so it will be available when the page is submitted. </p>


<p>Much of the page was  created in another HTML 
editing program. The page was built by inserting to <a href="../Component/GRD_PRODIMG Grid Component.html" title="GRD_PRODIMG Grid Component" class="wiki">GRD_PRODIMG</a> grid on a new empty page. The Xbasic code that tests the values and saves the image was added to page above the <span class=Code1><%a5 ... %></span> section that loads and runs the component code. Most of the code below that section was deleted and replaced with the html code from the other HTML editing program. Finally the code that shows the grid was added in the correct location on the new page.</p>


<p>The page HTML  uses embedded <span class=Code1><%a5 ... %></span> strings 
to add values for the page URL, an error message, pid, and the code to show the grid. </p>


<p class=A5>Links</p>



<p>The <a href="../Component/GRD_INTPROD Grid Component.html" title="GRD_INTPROD Grid Component" class="wiki">GRD_INTPROD</a> grid component opens  
  
 the ASWUPLOADIMG.A5W from a link in the detail section.</p>



<p class=Pix><img src="images/ASWUPLOADIMG_A5W.gif"
					x-maintain-ratio=TRUE
					style="width: 586px;
							height: 318px;
							border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							float: none;"
					width=586
					height=318
					border=1></p>



<p class=PixCaption>ASWUPLOADIMG.A5W in the WYSIWYG tab of the HTML Editor 
 </p>



<p class=Pix><img src="images/ASWUPLOADIMG_A5W_2.png"
						x-maintain-ratio=TRUE
						style="border-left-style: Solid;
								border-left-width: 1px;
								border-right-style: Solid;
								border-right-width: 1px;
								border-top-style: Solid;
								border-top-width: 1px;
								border-bottom-style: Solid;
								border-bottom-width: 1px;
								width: 418px;
								height: 377px;
								float: none;"
						width=418
						height=377
						border=1></p>



<p class=PixCaption>ASWUPLOADIMG.A5W in the Browser </p>



<p class=A5>Edits to the Page Source</p>



<p>When you look at ASWPACKREINDEX.A5W with the <span class=Screen>Source</span> tab of the <span class=Screen>HTML Editor</span>, you will see a large 
amount of HTML and Xbasic code. The <span class=Screen>HTML Editor</span> placed almost all of it there automatically,&nbsp;as&nbsp;we used the <span class=Screen>WYSIWYG</span> tab to place the tables, text, graphics,  and components on the page. There are a few interesting exceptions, where we changed the page code through the <span class=Screen>Source</span> tab.</p>


<p>Initially, the page checks for a valid <span class="Code1">pid</span> value. If the <span class=Code1>pid</span> argument is missing or is NULL, control goes back to <a href="ASWPRODUCTS.A5W.html" title="ASWPRODUCTS.A5W" class="wiki">ASWPRODUCTS.A5W</a></p>





<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if eval_valid("pid") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("aswproducts.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>elseif pid = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response.redirect("aswproducts.a5w")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if </p>


</td></tr>
</table>

<p>Next, the script checks if any submit buttons have been pressed. If the <span class="Button">clear </span>button is pressed, the variable <span class="Code1">clear</span> will have a value. The existing image saved in the record is replaced with a default image.  </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>dim msg as c = ""</p>


<p class=Code>dim FlagImageSaved as l = .F.</p>


<p class=Code>if eval_valid("clear") clear existing images, reload defaults</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;pid = alltrim(pid)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if file.exists("[PathAlias.ADB_Path]\Images\\"+ pid +".jpg")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.remove("[PathAlias.ADB_Path]\Images\\"+ pid +".jpg")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FlagImageSaved = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


</td></tr>
</table>

<p>If the submit button named <span class="Button">cmd</span> is pressed the variable <span class="Code1">cmd</span> will have a value. The code tests if a file was uploaded and checks if the file extension was jpg, bmp, or png. If no file was uploaded or the file does not have the correct extension, an error message is created. </p>



<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>elseif eval_valid("cmd")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if FileToUpload.filename <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim ext as c</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ext = ut(file.filename_parse(FileToUpload.filename,"e"))</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if inlist(ext,".JPG",".BMP",".PNG") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = "File must be an image.  Valid images are JPG, PNG and BMP"</p>


</td></tr>
</table>

<p>The code then tries to create a file on the server from the uploaded file. The <span class="Code1">pid</span> value is tested for correct format. If the file could not be saved on the server, or <span class="Code1">pid</span> had an incorrect format, an error message is created. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>elseif eval_valid("cmd")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if FileToUpload.filename <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim ext as c</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ext = ut(file.filename_parse(FileToUpload.filename,"e"))</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if inlist(ext,".JPG",".BMP",".PNG") = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = "File must be an image.  Valid images are JPG, PNG and BMP"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;&nbsp;dim fn as C  save raw file</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fn = "[PathAlias.ADB_Path]\images\remove" + ext</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.from_blob(fn, FileToUpload.data)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid = alltrim(pid)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if left(pid,1) = "P" .and. len(pid) = 4</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.remove(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = "File could not be saved. No product Id provided"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg = "Error. File was not be saved."</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


</td></tr>
</table>

<p>If no errors were found, the <span class="Code1">msg</span> variable is empty. The code then converts the image to jpg format is needed and tries to save the file to the<span class="Code1"> \images</span> folder. If the image file is saved, a variable<span class="Code1"> FlagImageSaved </span>is set to TRUE. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if msg = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim bmp_data as b</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    case ext = ".jpg"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    &nbsp;&nbsp;&nbsp;&nbsp;dim jpg_data as b</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;&nbsp;jpg_data = file.to_blob(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ext = ".png"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim png_data as b</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;png_data = file.to_blob(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data = png_to_bitmap(png_data)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jpg_data = bitmap_to_jpeg(bmp_data,100)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ext = ".bmp"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data = file.to_blob(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jpg_data = bitmap_to_jpeg(bmp_data,100)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end select</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.From_blob("[PathAlias.ADB_Path]\images\\" + pid + ".jpg",jpg_data)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.remove(fn)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FlagImageSaved = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>end if</p>


</td></tr>
</table>

<p>If the image file was created and pid has a value, the image name is saved in the product record as an image file reference field..</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code>if FlagImageSaved = .T. .and. pid <> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;img_path = "[PathAlias.ADB_Path]\Images\\"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rel_path = "Images\\"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;def_image = "noimage"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl = table.open("[PathAlias.ADB_Path]\product.dbf")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.order("product_id")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if tbl.fetch_find(pid)> 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if file.exists("[PathAlias.ADB_Path]\Images\\"+ pid +".jpg")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.picture = "=filename_decode(\""+rel_path+ pid +".jpg\")"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.picture = "=filename_decode(\""+rel_path+ def_image+".jpg\")"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if </p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.close() </p>


<p class=Code>end if </p>


</td></tr>
</table>

<p>The page html has a style added for the buttons on the page.</p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1><style type="text/css"></span></p>


<p class=Code><span class=HTML1><!--</span></p>


<p class=Code><span class=HTML1>.button {</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;width: 200px;</span></p>


<p class=Code><span class=HTML1>}</span></p>


<p class=Code><span class=HTML1>--></span></p>


<p class=Code><span class=HTML1></style></span></p>



</td></tr>
</table>

<p>The new page HTML code was added to the page. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
	<p class=Code><span class=HTML1></head></span></p>


<p class=Code><span class=HTML1><body bgcolor="#ffffff"></span></p>


<p class=Code><span class=HTML1><form action=" <%a5 ? request.request_uri %> " method="post" enctype="multipart/form-data"></span></p>


<p class=Code><span class=HTML1><table></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle" class="aswFormHeaderFont">Images for This Product </td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle">Enter Image File Name to upload </td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle" class="aswErrorDataTD"><%a5 ?msg %></td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle"><input type="file" name="FileToUpload" size="50" ></td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle"><input name="cmd" type="submit" class="button" value="Upload Image to Record"></span><span class=HTML1>&nbsp;</span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<input name="clear" type="submit" class="button" value="Remove Images from Record"></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<input type="hidden" name="pid" value="<%a5 ?pid %>"></td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>



</td></tr>
</table>

<p>Finally, the row to show the grid was added along with the other HTML for the page. </p>




<table class="htmlTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;
			width: 100%;
			border-spacing: 0px;
			border-left-style: None;
			border-right-style: None;
			border-top-style: None;
			border-bottom-style: None;" valign="top">
<td style="width: 100%;
			padding-right: 10px;
			padding-left: 10px;" width="100%">
<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle" valign="top"><%A5 ?x_grd_prodimg.Output.Body.Grid_HTML %></td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;<tr></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;<td align="middle" valign="top"><a onclick=window.close() href="#">Close</a></td></span></p>


<p class=Code><span class=HTML1>&nbsp;&nbsp;</tr></span></p>


<p class=Code><span class=HTML1></table></span></p>


<p class=Code><span class=HTML1></form></span></p>


<p class=Code><span class=HTML1
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"server,ref,a5w"}--->
</body></html>