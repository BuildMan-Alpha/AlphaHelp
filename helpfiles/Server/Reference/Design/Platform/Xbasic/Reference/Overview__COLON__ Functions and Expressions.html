	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Overview: Functions and Expressions</p>



<p>Expressions are used throughout Alpha Anywhere for a variety of purposes. 
 They are used to order and select records, display calculations on layouts, 
 link two tables together, and to specify conditions under which events 
 occur. For example, you can create an expression for a calculated field 
 to show sales totals at the bottom of a Report, or you can create a duplicate 
 key expression so that Alpha Anywhere knows which records in your table are 
 duplicates.</p>



<p>No matter what you use expressions for, the syntax you use for creating 
 expressions is the same throughout the program. This chapter contains 
 a detailed discussion of this syntax, letting you get the most from Alpha 
 Five.</p>



<p>You will see expressions in many different situations, but the most 
 common are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="/Desktop/Guide/Design/View/Browse/Unique and Filtered Indexes.html" title="Unique and Filtered Indexes" class="wiki">Index   Definitions</a></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="/Desktop/Guide/Design/View/Form/Filter Builder.html" title="Filter Builder" class="wiki">Filter   Expressions</a></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="/Desktop/Guide/Design/Data/Operation/Order Builder.html" title="Order Builder" class="wiki">Order   Expressions</a></p>

</li>
</ul>

<p>When you want to derive a value by performing computations on variables, 
 fields, and constants, you do it by forming an expression. An expression 
 is like a formula composed of combinations of:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="What is a Variable__QUESTION__.html" title="What is a Variable?" class="wiki">Variables</a></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Constants</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Table Field Names</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Layout Field Names</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="/Index/Functions and Methods Title.html" title="Functions and Methods Title" class="wiki">Xbasic   Functions</a></p>

</li>
</ul>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The maximum 
 length of an expression is approximately 950 characters.</p>



<p class=A5><a name=Data_Types>Data Types</a></p>



<p>The result of this formula can be a numeric, a character string, a date, 
 or a logical value.</p>



<p>All expressions return a value which can be used in an Xbasic script. 
 This value can either be assigned to a variable or passed along&nbsp;as&nbsp;a 
 parameter to an Xbasic function.</p>



<p>Alpha Anywhere is very particular about the data type of an expression and 
 the context in which the expression is used. If the data type to which 
 the expression evaluates does not match the expected or required data 
 type, an error will occur.</p>



<p>For example, the <a href="../../../Api/Objects/Trace/TRACE.WRITELN Method.html" title="TRACE.WRITELN Method" class="wiki">TRACE.WRITELN(</a>) 
 method requires a character parameter. To print a numeric value in the 
 <span class=Screen>Trace</span> window, the following statement is used:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>num = 5</p>


<p class=Code>trace.writeln (str ( num ) )</p></td></tr>
</table>

<p>The expression <span class=Code1>str(num)</span>, which is passed to 
 the TRACE.WRITELN() method, converts the numeric variable to a string.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>TIP</span> : The following 
 shortcut would also work. It relies on the fact that Alpha Anywhere implicitly 
 converts variable types when concatenating them with character variables:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>trace.writeln("" + num)</td></tr>
</table>

<p class=A5><a name=What_is_a_Filter_Expression_>What is a Filter Expression?</a></p>



<p>The <span class=Bolded>Filter Expression</span> determines the records 
 you are going to work with. The expression has the following characteristics:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>It must evaluate to a logical 
 value. When it evaluates to .T. (TRUE), the record is included. When the 
 expression evaluates to .F. (FALSE), the record is excluded.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>It typically refers to 
 one or more fields in the table (e.g. <span class=Code1>DOB >= {1/1/48} 
 .and. isnotblank(LASTNAME)</span> ).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>If may include functions 
 that manipulate or evaluate field values.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>An empty expression selects 
 all records previously selected by any filter associated with the underlying 
 form or browse. If that expression is empty, you will get all records 
 in the table.</p>

</li>
</ul>

<p>In many situations an expression is passed&nbsp;as&nbsp;a character 
 argument to a function. In these situations the expression must be quoted. 
 Values and variables within quoted expressions must also be quoted. In 
 order to avoid confusion about the meaning of the quotes, there are three 
 optional (but equivalent) methods for quoting values and variables within 
 these quoted expressions. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>report.preview("Customer List", "lastname 
 > 'm'")</p>


<p class=Code>report.preview("Customer List", "lastname 
 > \"m\"")</p>


<p class=Code>report.preview("Customer List", "lastname 
 > " + quote("m"))</td></tr>
</table>

<p>Filter expressions may use <a href="/Desktop/Guide/Design/View/Xdialog/ASK Variables.html" title="ASK Variables" class="wiki">ASK   Variables</a> to get user input at run-time.</p>



<p class=A5><a name=Writing_a_Filter_Expression>Writing a Filter Expression</a></p>



<p>A filter expression contains specially formatted character data in the 
 format.</p>



<p><span class=Argument>Filter_Sub_Expression1</span> [ .AND. <span class=Optional>|</span>.OR. 
 <span class=Argument>Filter_Sub_Expression2</span> [ ... .AND. <span class=Optional>|</span>.OR. 
 <span class=Argument>Filter_Sub_ExpressionN</span> ]]</p>



<p>A filter sub-expression references at least one field in a table in 
 one of the following formats. The following are examples of typical sub-expressions.</p>




<div align=center>
<table style="x-cell-content-align: top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Format and Examples</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="3" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Character</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Character_Field</span> = " 
 <span class=Argument>Character_Value</span> "</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Character_Field</span> = <span 
 class=Argument>Character_Variable</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>left( <span class=Argument>Character_Field</span>,1) 
 > " <span class=Argument>Character_Value</span> "</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="3" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Date</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Date_Field</span> = ctod(" 
 <span class=Argument>Date_Value</span> ")</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Date_Field</span> < <span class=Argument>Date_Variable</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>month( <span class=Argument>Date_Field</span> ) = <span 
 class=Argument>Number</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="3" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Logical</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Logical_Field</span> = .T.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Logical_Field</span> <> <span 
 class=Argument>Logical_Variable</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>.not. <span class=Argument>Logical_Field</span> = .F.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="3" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Number</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Number_Field</span> > <span 
 class=Argument>Number</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Number_Field = Number_Variable</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>ceiling( <span class=Argument>Number_Field</span> ) 
 <= 12</td></tr>
</table>
</div>
<p class=A5><a name=What_is_an_Order_Expression_>What is an Order Expression?</a></p>



<p>The <span class=Bolded>Order Expression</span> determines the order 
 in which to display the records you have selected. The expression has 
 the following characteristics:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>It must evaluate to a character 
 value less than or equal to 240 characters in length.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>It typically refers to 
 one or more fields in the table (e.g. <span class=Code1>left(LASTNAME,8)+left(FIRSTNAME,8)</span> 
 ).</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>If may include functions 
 that manipulate or evaluate field values.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>An empty expression uses 
 the order associated with the underlying form or browse. If that expression 
 is empty, your will get records in record number order.</p>

</li>
</ul>

<p>Complete lists of Alpha functions and methods can be found in <a href="/Index/Function List.html" title="Function List" class="wiki">Function List</a> and <a href="/Index/Method List.html" title="Method List" class="wiki">Method List</a></p>



<p class=A5>Key Terms</p>




<div align=center>
<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 22.513%;">
<col style="width: 77.487%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableHead>Term</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableHead>Definition</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft>Expression</td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>Any combination of fields, constant values, functions, 
 and operators that can evaluate to a single value.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../FUNCTION.html" title="FUNCTION" class="wiki">Function</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A pre-defined keyword used in an expression, Each function 
 has a particular purpose. For example, DATE()is a function to determine 
 the current date.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../Operators/Using Operators.html" title="Using Operators" class="wiki">Operator</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A symbol used to represent a mathematical, relational, 
 logical, or string operation. Example operators: +, -, *.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="/Desktop/Guide/Design/Data/FieldRules/Expression Builder.html" title="Expression Builder" class="wiki">Expression   Builder</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A visual tool used to create expressions in Alpha Five.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../Operators/Arithmetic Operators.html" title="Arithmetic Operators" class="wiki">Numeric   Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>An expression that evaluates to a numeric value. For 
 example, 3+4 is a numeric expression that evaluates to 7.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../Operators/Character Operators.html" title="Character Operators" class="wiki">Character   Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>An expression that evaluates to a character value. <a href="Overview__COLON__ Functions and Expressions.html#What_is_an_Order_Expression_" title="Overview: Functions and Expressions" class="wiki">Order   Expressions</a> are always Character Expressions.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft>Date Expression</td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>An expression that evaluates to a date value.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../Operators/Logical Operators.html" title="Logical Operators" class="wiki">Logical   Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>An expression that evaluates to either TRUE or FALSE. 
 For example, 2+4=7 is a logical expression that&nbsp;evaluates to FALSE. 
 <a href="Overview__COLON__ Functions and Expressions.html#What_is_a_Filter_Expression_" title="Overview: Functions and Expressions" class="wiki">Filter   expressions</a> are always Logical Expressions.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../../../Tutorials/Alpha Five User Guide (Desktop)/Using Sets/Create and Restructure Sets.html#Linking_Fields" title="Create and Restructure Sets" class="wiki">Linking   Key Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A character expression used to specify common field(s) 
 between two tables.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft>Conditional Expression</td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A logical expression used to determine whether or not 
 an event occurs.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">Filter   Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A logical expression used to select records.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../../../Unclassified/Writing Expressions.html#Character_Order_Expressions" title="Writing Expressions" class="wiki">Order   Expression</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A character expression used to sort records.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="/Desktop/Guide/Design/Data/FieldRules/Calculated Fields.html" title="Calculated Fields" class="wiki">Calculated   Field</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A virtual field defined for a table, set or layout. 
 Calculated fields </p>


<p class=TableLeft>aren </p>


<p class=TableLeft>'t stored on disk. They're calculated&nbsp;as&nbsp;Needed.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 22.513%;" valign="top" width="22.513%">
<p class=TableLeft><a href="../../Desktop/Field Rules__COLON__ Field Types.html#Calculated_Fields" title="Field Rules: Field Types" class="wiki">Calculated   Field Rule</a></td>
<td class="TableCell" style="x-cell-content-align: top; width: 77.487%;" valign="top" width="77.487%">
<p class=TableLeft>A Field Rule that inserts and expression's value into 
 a field whenever a record is entered or changed.</td></tr>
</table>
</div>
<p class=A5>See Also</p>



<p><a href="../../../Api/Functions/Expression Evaluation Functions/Expression Evaluation Functions and Methods.html" title="Expression Evaluation Functions and Methods" class="wiki">Expression   Evaluation Functions</a>, <a href="../../../../../Guide/Design/Platform/Xbasic/Writing Expressions.html" title="Writing Expressions" class="wiki">Using   Quotes in Expressions</a>, <a href="../../../Api/Functions/Trace Functions/Trace Functions and Methods.html" title="Trace Functions and Methods" class="wiki">TRACE   Methods</a>, <a href="../Command Statements.html" title="Command Statements" class="wiki">Command Statements</a>, 
 <a href="Xbasic Language Reference.html" title="Xbasic Language Reference" class="wiki">Command Statements Reference</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Overview%3A+Functions+and+Expressions">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"accept","keywords":"ref,xbasic"}--->
</body></html>