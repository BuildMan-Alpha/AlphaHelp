	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Understanding Variable Scope</p>

<p>You may DIM a variable in two locations in an A5W page.</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>In a code block ( <span class=Code1>&lt%a5 ... %></span> ) inside or outside of the <span class=HTML1>&ltBODY> ... &lt/BODY></span> tags</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>In a function</p>

</li> </ul><p>In the illustration below a session may consist of many pages. The variables that you create with the <span class=Code1>DIM variable_name</span> syntax are only visible inside within a single page. They are even more limited in <span class=Bolded>scope</span> . Looking at Page 1 below, <span class=Code1>a1</span> and <span class=Code1>a3</span> are available to be read or set within their bounding white box. They are not visible inside function <span class=Code1>foo()</span>. Likewise, <span class=Code1>a5</span> is visible in function <span class=Code1>foo()</span>, but not visible anywhere else in page 1. The scope of a1, a3, and a5 is <span class=Bolded>local</span> .</p>

<p>In contrast, the variables that you create with the <span class=Bolded>DIM GLOBAL variable_name</span> syntax are visible anywhere within the page. Thus, <span class=Code1>a2</span>, <span class=Code1>a4</span>, and <span class=Code1>a6</span> are available to be read or set anywhere within their bounding green box. Variable <span class=Code1>a7</span> is available anywhere within its bound red box. The scope of these variables is <span class=Bolded>global</span> .</p>

<p>To share variables between pages, you must use <a href="../A5W/Understanding and Using Session Variables.html" title="Understanding and Using Session Variables" class="wiki">session variables</a>. There is more about session variables in <a href="../A5W/Understanding and Using Session Variables.html" title="Understanding and Using Session Variables" class="wiki">Understanding and Using Session Variables</a>. </p>

<p class=Pix><img src="images/WPT_A5W_Variable_Scope.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 562px; height: 521px; border-style: none; border-style: none;" width=562 height=521 border=0></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page with the following content.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Variable Scope&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim global nVal0&nbsp;as&nbsp;N = 14</p>

<p class=Code>dim nVal1&nbsp;as&nbsp;N = 12</p>

<p class=Code>dim nVal2&nbsp;as&nbsp;N</p>

<p class=Code>nVal2 = 10</p>

<p class=Code>set_var()</p>

<p class=Code>? "nVal0 in page = " + nVal0 + "&ltbr>"</p>

<p class=Code>? "nVal1 in page = " + nVal1 + "&ltbr>"</p>

<p class=Code>? "nVal2 in page = " + nVal2 + "&ltbr>"</p>

<p class=Code>? "nVal3 in page = " + nVal3 + "&ltbr>"</p>

<p class=Code>? "nVal4 in page = " + nVal4 + "&ltbr>"</p>

<p class=Code>%></p>

<p class=Code>&lt%a5</p>

<p class=Code>function set_var()</p>

<p class=Code>dim nVal3&nbsp;as&nbsp;N = 8</p>

<p class=Code>dim global nVal4&nbsp;as&nbsp;N = 6</p>

<p class=Code>? "nVal0 in function = " + nVal0 + "&ltbr>"</p>

<p class=Code>? "nVal1 in function = " + nVal1 + "&ltbr>"</p>

<p class=Code>? "nVal2 in function = " + nVal2 + "&ltbr>"</p>

<p class=Code>? "nVal3 in function = " + nVal3 + "&ltbr>"</p>

<p class=Code>? "nVal4 in function = " + nVal4 + "&ltbr>"</p>

<p class=Code>end function</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File > Save As</span> .</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter "Variable Scope" in the <span class=Control>File name</span> field and click <span class=Button>Save</span> .</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Close_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to close the <span class=Screen>HTML Editor</span> .</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>A5W Pages</span> page of the <span class=Screen>Web Projects Control Panel</span> .</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right click the "Variable Scope" entry and select <span class=Button>Publish (Local Webroot) and open</span> . Your new page will appear in your Internet browser. The results should look like this.&nbsp; </p>

</li> </ol><p class=Pix><img src="images/WPT_Variable_Scope_Error_1.gif" x-maintain-ratio=TRUE style="border: none; width: 487px; height: 326px; float: none; border-style: none; border-style: none;" width=487 height=326 border=0></p>

<ol start=7> <li class=kadov-p-CListNumber><p class=ListNumber>If you look at the page, you will see that <span class=Code1>set_var()</span> function runs before the page prints its local variables. When <span class=Code1>set_var()</span> attempts to print <span class=Code1>nVal0</span> to <span class=Code1>nVal4</span> , it turns out that <span class=Code1>nVal1</span> is <span class=Bolded>not in scope</span> . <span class=Code1>nVal1</span> is <span class=Bolded>local</span> to the page and unknown to <span class=Code1>set_var()</span>. An error results. Place an Xbasic comment at the beginning of this line and try publishing the page again. </p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>'? "nVal1 in function = " + nVal1 + "&ltbr>"</td></tr> </table><p class=Pix><img src="images/WPT_Variable_Scope_Error_2.gif" x-maintain-ratio=TRUE style="border: none; width: 487px; height: 326px; float: none; border-style: none; border-style: none;" width=487 height=326 border=0></p>

<ol start=8> <li class=kadov-p-CListNumber><p class=ListNumber>This time the problem with scope is that <span class=Code1>nVal2</span> is also <span class=Bolded>local</span> to the page and unknown to <span class=Code1>set_var()</span>. An error results. Place an Xbasic comment at the beginning of this line and try publishing the page again. </p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>'? "nVal2 in function = " + nVal2 + "&ltbr>"</td></tr> </table><p class=Pix><img src="images/WPT_Variable_Scope_Error_3.gif" x-maintain-ratio=TRUE style="border: none; width: 487px; height: 326px; float: none; border-style: none; border-style: none;" width=487 height=326 border=0></p>

<ol start=9> <li class=kadov-p-CListNumber><p class=ListNumber>This time the problem with scope is that <span class=Code1>nVal3</span> is <span class=Bolded>local</span> to the function <span class=Code1>set_var()</span> and unknown to the page. An error results. Place an Xbasic comment at the beginning of this line and try publishing the page again. </p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>'? "nVal3 in page = " + nVal3 + "&ltbr>"</td></tr> </table> <ol start=10> <li class=kadov-p-CListNumber><p class=ListNumber>Finally, the page runs without error. Both the <span class=Code1>set_var()</span> function and the page are able to print their local variables and the global variables. </p>

</li> </ol><p class=Pix><img src="images/WPT_Variable_Scope.gif" x-maintain-ratio=TRUE style="border: none; width: 487px; height: 326px; float: none; border-style: none; border-style: none;" width=487 height=326 border=0></p>

<p class=A5>See Also</p>

<p><a href="/Index/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Understanding+Variable+Scope">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","keywords":"server,design,guide,xbasic,html,a5w","tags":"web"}--->
</body></html>