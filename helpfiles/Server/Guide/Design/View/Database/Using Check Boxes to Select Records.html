	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Using Check Boxes to Select Records</p>

<p>This example shows how to use check boxes in a grid to select records to print. In this case the example prints labels, but the technique is applicable to selecting records for any process.</p>

<p>This example passes the selected list of <span class=Code1>Customer_IDs</span> to a second page named <span class=Code1>PrintLabel.a5w</span>. It prints the appropriate records using the <span class=Code1>CustomerLabels</span> label layout or <span class=Code1>Letter to Customers</span> letter layout of the AlphaSports <span class=Code1>customer</span> table.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new read-only grid tabular component based on the AlphaSports customer table with a search part.</p>

</li> </ol> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid > Query (DBF)</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter "Lastname" in the <span class=Control>Order</span> field.</p>

</li> </ol><p class=A5><span class=Screen><a name=Selecting_the_Fields_to_Display>Selecting the Fields to Display</a></span></p>

<ol start=4> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid > Fields</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Press CTRL and click to select the "Customer_ID", "Firstname", "Lastname", "Company", "Phone", "Bill_Address_1", "Bill_City", "Bill_State_Region", "Bill_Postal_Code", "Bill_Country", and "Email" fields.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Press <img src="images/Move_Right_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to add them to the <span class=Control>Selected Fields</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Customer_Id" field in the <span class=Control>Selected Fields</span> list:</p>

</li> <ol start=1> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "True" in the <span class=Button>Column Properties > Freeform layout</span> list (click the check box).</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click</p>

<p class=ListAlpha></p>

<p class=ListAlpha>in the <span class=Button>Column Properties > Freeform template</span> field to display the <span class=Screen>Freeform Column Layout</span> dialog.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Enter the following HTML code and click <span class=Button>OK</span>. This line of code adds the "Customer_Id" to a check box selection list.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltinput type="check box" name="cust_id[]" value="</span> {Customer_Id} <span class=HTML1>"></span></td> </tr> </table> <li class=kadov-p-CListNumber><p class=ListNumber>Add <span class=HTML1>white-space: nowrap;</span> to each field's <span class=Button>Label Properties > In-line style</span> field.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Change the C <span class=Button>olumn Properties > Column heading</span> values&nbsp;as&nbsp;follows:</p>

</li> <ol start=1> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change "Bill_Address_1" to "Address".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change "Bill_City" to "City".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change "Bill_State_Region" to "State".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change "Bill_Postal_Code" to "Postal Code".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change "Bill_Country" to "Country".</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>The "Email" field opens your email client to send a message. To achieve this effect:</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change its <span class=Button>Display Settings > Control type</span> to "Link".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Set its <span class=Button>Link Properties > Display what in link</span> field to "Value in Field".</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Sets its <span class=Button>Link Properties > Link address type</span> field to "Field value is an email address".</p>

</li> </ol> </ol><p class=A5><a name=Setting_Grid_Properties>Setting Grid Properties</a></p>

<ol start=11> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Grid > Properties</span> menu.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Corporate" style in the <span class=Screen>Select Style</span> dialog box.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select "True" in the <span class=Button>Shading and Dividers > Alternate row shading</span> list (enable the check box).</p>

</li> </ol><p class=A5>&nbsp; <a name=Defining_the_Search_Part><a>Defining the Search Part</a></a></p>

<ol start=14> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Search > Fields</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Press CTRL and click to select the "Customer_ID", "Lastname", "Company", and "Ship_State_Region" in the <span class=Control>Available Fields</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Press <img src="images/Move_Right_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to add them to the <span class=Control>Selected Fields</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Search > Properties</span> menu.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>Search Options > Initial state</span> to "Closed".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Save</span> and name the grid "CustomerGridRadiobuttons". Close the <span class=Screen>Grid Builder</span>.</p>

</li> </ol><p class=A5><a name=Creating_the_CustomerGridLabels_Page>Creating the CustomerGridLabels Page</a></p>

<ol start=21> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New > OK</span> to create a new A5W page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter "SelectLabelType" in the <span class=Control>File name</span> field, and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Insert Component > Select</span>, pick "CustomerGridRadiobuttons", and click <span class=Button>OK > OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Insert three buttons into the grid into the table cell that contains the Data. </p>

</li> </ol><p class=Pix><img src="images/WPT_Adding_Buttons_to_Page.gif" x-maintain-ratio=TRUE style="border: none; width: 453px; height: 291px; float: none; border-style: none; border-style: none;" width=453 height=291 border=0></p>

<ol start=25> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Position the cursor and click <img src="images/Button_tool_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> to insert a push button. You will notice that the Grid Builder automatically adds beginning and ending <span class=HTML1>form</span> tags.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Position the cursor between the push button and the closing <span class=HTML1>form</span> tag and insert a space character and another push button. Insert another space character and a third push button</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Double click the buttons and modify their labels&nbsp;as&nbsp;shown above.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Source</span> tab.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Just after the <span class=HTML1>&lthead></span> tag insert the following Javascript code. The <span class=HTML1>determineSelectedRadioButton()</span> function builds a list of <span class=Code1>Customer_Id</span> values of selected records.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>function printLabels()</span></p>

<p class=Code><span class=HTML1>{</span></p>

<p class=Code><span class=HTML1>var toolbar = 'no';</span></p>

<p class=Code><span class=HTML1>var menubar = 'no';</span></p>

<p class=Code><span class=HTML1>var location = 'no';</span></p>

<p class=Code><span class=HTML1>var statusbar = 'no';</span></p>

<p class=Code><span class=HTML1>var resizable = 'yes';</span></p>

<p class=Code><span class=HTML1>var width = 750;</span></p>

<p class=Code><span class=HTML1>var height = 500;</span></p>

<p class=Code><span class=HTML1>window.open('PrintLabel.a5w?'+determineCustIdsFromCheck boxes(),'LabelsWindow','location='+location+',menubar='+menubar+',toolbar='+toolbar+',status='+statusbar+',resizable='+resizable+',width='+width+',height='+height)</span></p>

<p class=Code><span class=HTML1>}</span></p>

<p class=Code><span class=HTML1>function determineSelectedRadioButton()</span></p>

<p class=Code><span class=HTML1>{</span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>var retVal = '';</span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>for (i = 0; i &lt document.SelectCustomer.cust_id.length; i++)</span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>{</span></span> </span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>if (document.SelectCustomer.cust_id<a class="wiki"  href="i" rel="">i</a>.checked)</span></span> </span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>{</span></span> </span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>retVal = document.SelectCustomer.cust_id<a class="wiki"  href="i" rel="">i</a>.value;</span></span> </span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>break;</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>}</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>}</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>return retVal;</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>}</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td></tr> </table> <ol start=27 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The next step is to modify the HTML table that contains the Xbasic commands to display the various grid component parts. The unmodified code will look something like this.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&lttable></span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttr></span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttd></span> &lt%A5 ?x_out.Output.Body.Grid_Echo %> <span class=HTML1>&lt/td></span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/tr></span></span> </span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttr></span></span> </span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttd></span> &lt%A5 ?x_out.Output.Body.UpdateErrors %> <span class=HTML1>&lt/td></span></span> </span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/tr></span></span> </span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttd></span> &lt%A5 ?x_out.Output.Body.Search_HTML %> <span class=HTML1>&lt/td></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/tr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttd></span> &lt%A5 ?x_out.Output.Body.Grid_HTML %></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&ltform method=post></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&ltinput id=button1 type=button value="Print Labels" name=button1>&nbsp;</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&ltinput id=button2 type=button value="Print Labels (open in a new window)" name=button2>&nbsp;</span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&ltinput id=button3 type=button value="Clear Selections" name=button3></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form>&lt/td></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/tr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lttd></span> &lt%A5 ?x_out.Output.Body.DetailView_HTML %> <span class=HTML1>&lt/td></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&lt/tr></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/table></span></span> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td></tr> </table> <ol start=28> <li class=kadov-p-CListNumber><p class=ListNumber>Modify this code&nbsp;as&nbsp;follows.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>When the user selects a customer using a radio button and then clicks the "Print Labels" or "Print Labels (open in a new window)" button, the form data is submitted to a page named "PrintLabel.a5w". This page builds a query for the selected customer and then generates a PDF file containing the selected label or letter.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform method=post></span></td> </tr> </table><p>becomes</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform name=SelectCustomer method=post action="printlabel.a5w"></span></td> </tr> </table> <ol start=34> <ol start=2> <li class=kadov-p-CListAlpha><p class=ListAlpha>The three buttons are modified to apply the current style sheet's button style.</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltinput</span></td> </tr> </table><p>becomes</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltinput class="</span> &lt%a5 ? tmpl.style_name %> <span class=HTML1>Button"</span></td> </tr> </table> <ol start=34> <ol start=3> <li class=kadov-p-CListAlpha><p class=ListAlpha>Change the type parameters of the three buttons. The first button submits the page and loads the page specified in the <span class=HTML1>&ltform></span> tag above. Thus, you need to change the code from:</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>type=button</span></td> </tr> </table><p>to</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>type=submit</span></td> </tr> </table> <ol start=34> <ol start=4> <li class=kadov-p-CListAlpha><p class=ListAlpha>The second button works differently. Instead of submitting the form, this button uses client-side JavaScript to open a new browser window and load the labels within it, using the Javascript <span class=HTML1>printLabels()</span> function. This JavaScript has control over the size of the window&nbsp;as&nbsp;well&nbsp;as&nbsp;other properties such&nbsp;as&nbsp;whether or not the window has toolbars or can be resized. Thus, you need to add this code at the end of the <span class=HTML1>&ltbutton></span> tag:</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1><span class=HTML1>&nbsp; <span class=HTML1>on<x>click="printLabels();"</span></span> </span></td></tr> </table> <ol start=34> <ol start=5> <li class=kadov-p-CListAlpha><p class=ListAlpha>The third button uses the standard form technique for clearing current selections. You need to change the code from:</p>

</li> </ol> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>type=button</span></td> </tr> </table><p>to</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>type=clear</span></td> </tr> </table><p>The revised <span class=HTML1>&ltform></span> and <span class=HTML1>&ltbutton></span> code looks like this.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltform name=SelectCustomer method=post action="printlabel.a5w"></span></p>

<p class=Code><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput class="&lt%a5 ? tmpl.style_name %>Button" type=submit value="Print Labels"></span></span> </span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput class="&lt%a5 ? tmpl.style_name %>Button" type=button value="Print Labels (open in a new window)" on<x>click="printLabels();"></span></span> </span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&nbsp;&nbsp;&nbsp;&nbsp; <span class=HTML1>&ltinput class="&l;%a5 ? tmpl.style_name %>Button" type=reset value="Clear Selections"></span></span> </span></span></span></span></span></p>

<p class=Code><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1><span class=HTML1>&lt/form></span></span> </span></span></span></span></span></td></tr> </table> <ol start=29 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Save the page and close the <span class=Screen>HTML Editor</span>.</p>

</li> </ol><p class=A5>Creating the PrintLabels Page</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page and switch to the <span class=Screen>Source</span> view in the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Paste the following code above the <span class=HTML1>&lthtml></span> tag.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>if eval_valid("cust_id")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if cust_id[1] = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto CustidNotSpecified</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim filter&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim order&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = cust_id.dump()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = *for_each(x,"customer_id = " + quote(x),filter)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = strtran(alltrim(filter), crlf()," .or. ")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;order = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim filename&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filename = session.session_folder + chr(92) + "templabels.pdf"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filename = label.saveas("CustomerLabels@[PathAlias.ADB_Path]\customer.dbf","PDF",filter,order,filename,.f.)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(filename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect(session.session_url + "templabels.pdf?" + time("hms3"))</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CustidNotSpecified:</p>

<p class=Code>%></td></tr> </table><p>This Xbasic code first checks to see if it has received the <span class=Code1>cust_id</span> parameter from the calling page. If it has been received and exists, the code next checks to see if it contains any values. If not, the script goes to the error handler <span class=Code1>CustidNotSpecified:</span>.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>if eval_valid("cust_id")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if cust_id[1] = ""</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto CustidNotSpecified</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</td></tr> </table><p>If the script continues, it uses the <a href="../../../../Reference/Design/Api/Functions/Internal Use Only/__STAR__FOR_EACH Function.html" title="*FOR_EACH Function" class="wiki">*for_each(</a>) function to build a list of arguments for a filter expression, separating each argument with an <span class=Code1>.or.</span> operator.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim filter&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim order&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = cust_id.dump()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = *for_each(x,"customer_id = " + quote(x),filter)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter = strtran(alltrim(filter), crlf()," .or. ")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;order = ""</td></tr> </table><p>Next, the script creates a filename that is located in the current session folder and passes that name&nbsp;as&nbsp;one of the arguments in the <a href="../../../../Reference/Design/Api/Objects/Object/OBJECT.SAVEAS Method.html" title="OBJECT.SAVEAS Method" class="wiki">LABEL.SAVEAS(</a>) method. Since this is using an Alpha Five print routine, it would only work with an Alpha Five table.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim filename&nbsp;as&nbsp;c</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filename = session.session_folder + chr(92) + "templabels.pdf"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filename = label.saveas("CustomerLabels@[PathAlias.ADB_Path]\customer.dbf", "PDF", filter, order, filename, .f.)</td></tr> </table><p>Finally, if the print routine worked and the PDF file was created, the script loads the new PDF file using the <a href="../../../../Reference/Design/Api/Internet Methods/RESPONSE.REDIRECT Method.html" title="RESPONSE.REDIRECT Method" class="wiki">RESPONSE.REDIRECT(</a>) method. The <span class=Code1>time("hms3")</span> argument added to the filename guarantees that you open the most recent PDF file, and not any version that might have been cached.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if file.exists(filename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect(session.session_url + "templabels.pdf?" + time("hms3"))</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>else</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;CustidNotSpecified:</p>

<p class=Code>%></td></tr> </table> <ol start=3 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Paste the following code into the body of the document. It displays an error message if an error occurs.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltp>Error: You must call page with a query string that specifies the Customer ID(s).&ltbr></span></p>

<p class=Code><span class=HTML1>For example:</span> &lt%a5 ? request.script_name %> <span class=HTML1>?cust_id[]=000001&amp;cust_id[]=000013&lt/p></span></td> </tr> </table> <ol start=4 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>Save the PrintLabel.A5W page and display the <span class=Screen>A5W Pages</span> tab of the <span class=Screen>Web Projects Control Panel</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right click the "SelectLabelType" page, select <span class=Button>Publish (Local Webroot) and open</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select a couple of records and try the different print buttons.</p>

</li> </ol><p class=A5>See Also</p>

<p><a href="/Index/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Check+Boxes+to+Select+Records">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","keywords":"server,guide,adb","tags":"web"}--->
</body></html>