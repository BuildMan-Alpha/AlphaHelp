<page>
<topic>Calling UDFs from a Grid or Dialog Component</topic>      
<description>Web publishing applications only. This document describes how you can call user defined functions (UDFs) from a Grid Component, Dialog Component, or A5W page.</description>
<sections>
<section>
      <note>The Calling UDFs from a Grid or Dialog Component topic describes a technique available to Alpha Anywhere database users.</note>
      
      
</section>      
<section>
      <description>When you are designing a Grid component you always have an Alpha Anywhere Database open (.ADB file). Any UDFs that you have defined in this database, by definition, are available when you design and test a component.
However, when you publish your component to your web server, there is not necessarily any way of knowing which, if any database (.ADB file) the server has open. In fact, it is likely that the server will not have any database open. as a result, the references in your component to any UDFs will fail. Here is a practical example of the problem:

Say that you have defined a UDF called fullname() that takes two arguments: firstname and lastname. You may have defined a calculated field in a grid component that is based on .DBF tables:
</description>
      <example><![CDATA[username = fullname(firstname,lastname)
 ]]></example>
      
</section>     
<section>
      <description>At design time, the calculated field works because the fullname()UDF is available.
Alpha Anywhere has at least three different possible solutions to the problem. The most appropriate solution will depend on the specifics of your situation.
If you have compiled the functions in your database into an .aex file then you can publish your .AEX file along with the other files in your application, and in the .A5W page that displays your component, you can include this code:
</description>
      <example><![CDATA[<%A5
a5w_load_aex("myComponentFile.aex")
%> ]]></example>
     
</section>  
<section>
      <description>Where myComponentFile.aex is the name of the .AEX file that you created.
The A5W_LOAD_AEX() function can take a CR-LF delimited list of .AEX files, allowing you to load multiple .AEX libraries.
</description>
      <note><![CDATA[It is very important that the A5W_LOAD_AEX() function appear before the A5W_RUN_COMPONENT() function. This function typically appears in the <head> section of the page, which means that you will have to switch to the Source view in the HTML Editor in order to insert this code.]]></note>
</section>
    <section>
          <description>If you wish to unload the .AEX file, you can call the A5W_UNLOAD_AEX() function after the A5W_RUN_COMPONENT() function.</description>
          <note>The A5W_LOAD_AEX()and A5W_UNLOAD_AEX() functions require build 2047 or above.</note>
    </section>
      
</sections>      
      <see>
            <ref>Change In Way AEX Files are Used in a Web Application.</ref>
      </see>
      
</page>