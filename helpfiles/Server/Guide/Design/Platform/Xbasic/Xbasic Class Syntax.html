	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Xbasic_Class_Syntax">Xbasic Class Syntax</h1>
The syntax in this article describes Xbasic classes in Backus-Naur Form (BNF).<br />
<br />
<strong>Notes on Syntax</strong><br />
1.       Keywords are in uppercase and bolded.<br />
2.       Substitutable values (rules) are in angle brackets "&lt;&gt;".  The rule for replacement is listed below.<br />
3.       Rules are expressed as &lt;<em>rule</em>&gt; : option | option | option; where the vertical bar "|" means "OR".<br />
4.       Values in square brackets "[]" are optional.<br />
5.       Underlined elements are the default for optional items.<br />
6.       The symbol "*" means that the element that precedes it can occur zero or more times.  For simplicity sake, we have omitted commas in argument lists.<br />
<h2 class="showhide_heading" id="Syntax_Diagram">Syntax Diagram</h2>
<strong>DEFINE CLASS</strong> [ <b><u>GLOBAL</u></b>| <strong>SHARED</strong> | <strong>LOCAL</strong> | <strong>SYSTEM</strong> ] &lt;name&gt; [ <strong>INHERITS</strong> &lt;classname&gt; ]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;classelement&gt;*<br />
<strong>END CLASS</strong><br />
<br />
&lt;<em>classelement</em>&gt; :           &lt;constructor&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;dimStatement&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;functionStatement&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|           &lt;constantStatement&gt;<br />
<br />
&lt;<em>constructor</em>&gt; :              <strong>FUNCTION</strong> [&lt;simpleaccess&gt;] &lt;classname&gt; (&lt;functionargument&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<strong>Notes:</strong><br />
<ul><li>A class name may include a namespace prefix separated from the name by two colons (<strong>::</strong>).
</li><li>A namespace may have multiple parts separated by periods.
</li><li>A constructor function has the same name as the class.
</li><li>There can be multiple constructors per class.  The constructor that executes depends on the arguments provided when the class is created. The <strong>new</strong> keyword is used to invoke a specific constructor.
</li><li>A constructor may have limited access to control how a class is created from outside.
</li></ul>&lt;<em>destructor</em>&gt;:   <strong>FUNCTION</strong> ~&lt;classname&gt; ( )<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<strong>Notes:</strong><br />
<ul><li>A destructor has the same name as the class with the tilde "~" character preceding it.
</li><li>There can be only one destructor per class.
</li><li>All destructors are public and virtual.
</li></ul><br />
&lt;<em>dimStatement</em>&gt; :          <strong>DIM</strong> [&lt;<span style="text-decoration:underline;">simpleaccess</span>&gt; | &lt;mixedaccess&gt; ] [ <strong>STATIC</strong> |<strong> <span style="text-decoration:underline;">VIRTUAL</span> </strong>] &lt;name&gt; [&lt;arraydefinition&gt;] <strong>AS</strong> &lt;typename&gt; [= &lt;expression&gt;]<br />
<br />
&lt;<em>functionStatement</em>&gt; :    <strong>FUNCTION</strong> [&lt;simpleaccess&gt;] [ <strong>STATIC</strong> |<strong> <span style="text-decoration:underline;">VIRTUAL</span> </strong>] &lt;name&gt; [AS &lt;typename&gt; ](&lt;functionargument&gt;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>END FUNCTION</strong><br />
<br />
&lt;<em>constantStatement</em>&gt; :   <strong>CONSTANT</strong> [&lt;simpleaccess&gt;] &lt;name&gt; = &lt;literal value&gt;<br />
<strong>Note:</strong> A constant is static by definition.<br />
<br />
&lt;<em>simpleaccess</em>&gt; :          <strong> <span style="text-decoration:underline;">PUBLIC</span> </strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <strong>PROTECTED</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <strong>PRIVATE</strong><br />
<br />
<br />
&lt;<em>mixedaccess</em>&gt; :  &lt;simpleaccess&gt; <strong>READ</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;simpleaccess&gt; <strong>WRITE</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;simpleaccess&gt; <strong>READ</strong> &lt;simpleaccess&gt; <strong>WRITE</strong><br />
<br />
<br />
&lt;<em>functionargument</em>&gt; : [<strong>BYREF</strong> | <span style="text-decoration:underline;"> <strong>BYVAL</strong> </span> ] [<strong>OPTIONAL</strong> | <strong>PARAMS</strong> ] <strong>AS</strong> &lt;typename&gt; [ = &lt;expression&gt;]<br />
<strong>Notes:</strong><br />
<ul><li>OPTIONAL indicates that the parameter may be omitted.
</li><li>The effect is the same as overloading the function.
</li><li>At run time, the initialization expression is executed if the argument is missing.
</li></ul>PARAMS can be used at most once in an argument list.<br />
<ul><li>It must be used on the last argument in the overload.
</li><li>At run time, all parameters in this position and those that follow must either match or be inherited from the type specified.
</li><li>The interpreter converts the arguments into an array of the same type as the declared type of the arguments collection
</li></ul><strong>Substitutable Value Definitions</strong><br />
&lt;<em>classname</em>&gt;:  the name of the class being defined<br />
&lt;<em>arraydefinition</em>&gt;: the valid XBasic syntax for defining an array<br />
&lt;<em>typename</em>&gt;: a valid single letter type or class name<br />
&lt;<em>name</em>&gt;: a valid XBasic identifier<br />
&lt;<em>literal value</em>&gt;: a valid XBasic literal value (the type is implied)<br />
&lt;<em>expression</em>&gt;: a valid XBasic expression (constant, new operator, and so on)<br />
<h2 class="showhide_heading" id="Class_Example">Class Example</h2>
In the example below, note that the member variable <strong>InstanceCount </strong>is <strong>static</strong>. That means there is only one <strong>InstanceCount</strong>, no matter how many copies of <strong>TestClass </strong>have been DIMmed. On the other hand, each instance of <strong>TestClass </strong>has its own copy of the member variable <strong>Data</strong>.<br />
<br />
Also note that the member method <strong>TestClass()</strong> is the constructor for class <strong>TestClass</strong>. Therefore it is called immediately after an instance of <strong>TestClass </strong>is DIMmed. Similarly, the member method <strong>~TestClass()</strong> is the destructor for class <strong>TestClass</strong>. Therefore it is called immediately before an instance of <strong>TestClass </strong>is destroyed.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >DEFINE CLASS TestClass
&nbsp;
            dim public read protected write Name as C
            dim public Data as A
            dim public read protected write static InstanceCount as N
&nbsp;
            FUNCTION PUBLIC TestClass()
                        Initialize()
            END FUNCTION
&nbsp;
            FUNCTION ~TestClass()
                        InstanceCount = InstanceCount - 1
            END FUNCTION
&nbsp;
            FUNCTION protected Initialize as V()
                        Data = &#34;&#34;
                        InstanceCount = InstanceCount + 1
            END FUNCTION
&nbsp;
            FUNCTION public static DefaultDataType as C ()
                        DefaultDataType = &#34;C&#34;
            END FUNCTION
&nbsp;
            FUNCTION public AddToData as V ( PARAMS NewValue as C)
                        for i = 1 to NewValue.Size()
                                    *concat(Data, NewValue(i))
                        next
            END FUNCTION
&nbsp;
            FUNCTION public AddToData as V ( PARAMS NewValue as N)
                        for i = 1 to NewValue.Size()
                                    Data = Data + NewValue(i)
                        next
            END FUNCTION
&nbsp;
            FUNCTION public Clear as V ()
                        Initialize()
            END FUNCTION
&nbsp;
END CLASS</pre></div><br />
<h3 class="showhide_heading" id="Exercises">Exercises</h3>
<ol><li>How does this class keep track of its instance count?
</li><li>How do the two <strong>AddToData </strong>overloads work?
</li><li>There are at least two potential bugs in the class above. Can you find them?
</li></ol><h2 class="showhide_heading" id="See_also">See also</h2>
<a href="Xbasic with Classes.html" title="Xbasic with Classes V11" class="wiki">Xbasic with Classes </a><br />
<a href="Xbasic Class Syntax.html" title="Xbasic Class Syntax V11" class="wiki">Xbasic Class Syntax </a><br />
<a href="/Desktop/Guide/Design/Data/SQL/Designing an Xbasic Class.html" title="Designing an Xbasic Class V11" class="wiki">Designing an Xbasic Class </a><br />
<a href="Implementing an Xbasic Class.html" title="Implementing an Xbasic Class V11" class="wiki">Implementing an Xbasic Class </a><br />
<a href="Testing and Using an Xbasic Class V11.html" title="Testing and Using an Xbasic Class V11" class="wiki">Testing and Using an Xbasic Class </a><br />
<a href="Subclasses and Inheritance.html" title="Subclasses and Inheritance V11" class="wiki">Subclasses and Inheritance </a><br />
<a href="Classes in Namespaces.html" title="Classes in Namespaces V11" class="wiki">Classes in Namespaces </a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Xbasic+Class+Syntax+V11">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common,review","status":"pending","notes":"v11","keywords":"server,design,guide,xbasic"}--->
</body></html>