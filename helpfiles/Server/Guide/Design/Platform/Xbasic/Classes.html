	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<h1>Classes</h1>
	<p>Classes are easy to define and use in your applications. When you open the Script Editor, you will notice that the toolbar has two new  icons (4th and 5th icon in the image below) for creating new classes and new  enumerations.</p>
<p>
	<img src="images/ScriptEditorToolbar.jpg" height="87" width="490" alt="Image" /></p>
<p>&nbsp;</p>
<p>The section below is a short introduction to  classes.</p>
<!-- startAnchor --><a name="Introduction to Classes"></a><!-- endAnchor -->
<h3>Introduction to Classes</h3>
<p>The purpose of a class definition is to encapsulate data with the methods  that operate on the data.<br />
<br />
For our first simple example, let us assume  that you want to create a class that represents a person, and includes name,  gender and marital status. The class we will define has a method to validate, a  method to edit the contents, and a method to generate a full name.<br />
<br />
Here  is our example code (you can paste this into a new Xbasic script&nbsp; - paste it  into a script not a class):<br />
&nbsp;</p>
<p><b>NOTE:</b> This sample will not work in V11 unless you add "<i>option __A5V10CLASS__</i>" to the top of the script.</p>
<p class="xbasic"><br />
define class personInformation<br />
dim first_name as c<br />
dim  last_name as c<br />
dim gender as c<br />
dim married as l = .f.<br />
&nbsp;</p>
<p class="xbasic">function Validate as l()<br />
if self.first_name = "" then <br />
&nbsp;&nbsp;&nbsp;  ui_msg_box("Error","Firstname is empty.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit  function<br />
end if<br />
if self.last_name = "" then<br />
&nbsp;&nbsp;&nbsp;  ui_msg_box("Error","Lastname is empty.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit  function<br />
end if<br />
if self.gender = "" then<br />
&nbsp;&nbsp;&nbsp; ui_msg_box("Error","Gender  is not specified.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit function<br />
end  if<br />
Validate = .t.<br />
end function <br />
&nbsp;</p>
<p class="xbasic">function Edit as v()<br />
ui_dlg_box("Edit  Person",&lt&lt%dlg%<br />
First Name:|[.40self.first_name];<br />
Last  Name:|[.40self.last_name];<br />
Gender:|[40self.gender^={Male,Female}];<br />
Married:|(married);<br />
{line=2};<br />
&lt*&OK>;<br />
%dlg%)<br />
end  function <br />
&nbsp;</p>
<p class="xbasic">function FullName as c()<br />
if self.gender = "Male" then<br />
&nbsp;&nbsp;&nbsp;  FullName = "Mr " + first_name - " " + last_name<br />
else if self.married then  <br />
&nbsp;&nbsp;&nbsp; FullName = "Mrs " + first_name - " " + last_name<br />
else <br />
&nbsp;&nbsp;&nbsp;  FullName = "Ms " + first_name - " " + last_name<br />
end if <br />
end  function<br />
end class<br />
<br />
&nbsp;</p>
<p>Having defined the class, we can now use this class in the same script (paste  this into the same script where you defined the class).</p>
<p class="xbasic"><br />
dim person as personInformation<br />
<br />
person.gender =  "Male"<br />
person.Edit()<br />
while .not. person.Validate()<br />
person.Edit()  <br />
end while<br />
ui_msg_box("Salutation","Hello  "+person.FullName())<br />
<br />
&nbsp;</p>
<p>When you run the script that contains this class definition, you will see  this dialog:</p>
<p>
	<img src="images/Class_Example1.jpg" height="168" width="314" alt="Image" /></p>
<p>&nbsp;</p>
<p>As you can see, once the class is dimmed, the properties and methods defined  in the class are accessible.</p>
<!-- startAnchor --><a name="Visibility -&nbsp; Making a Class Visible Outside the Script that Defines It"></a><!-- endAnchor -->
<h3>Visibility -&nbsp; Making a Class Visible Outside the Script that Defines It</h3>
<p>Class definitions are similar to variables in that they have a scope, which  defaults to local, but can be optionally specified as session, global, or  system.</p>
<p>You will notice that after you run the script, if you go to the Interactive  window and type:</p>
<p class="xbasic"><br />
dim person as personInformation<br />
&nbsp;</p>
<p><br />
You will get an error:</p>
<p class="xbasic">ERROR: Variable not found 'person' (extended type  'personInformation').</p>
<p><br />
This is because after the script runs, the class is no longer visible,  since it was local to the script (just as the variables that were DIMmed locally  to the script are not visible).<br />
<br />
If you change first line of the script  from:</p>
<p class="xbasic">define class personInformation<br />
&nbsp;</p>
<p>to:</p>
<p class="xbasic">define class global personInformation<br />
&nbsp;</p>
<p>and run the script again, then go to the Interactive window, and type:</p>
<p class="xbasic">dim person as personInformation</p>
<p>you will see that it works.</p>
<p>&nbsp;</p>
<p>You have created a 'personInformation' object, and all of the object's  properties and methods work, just as they did in the original script.</p>
<p>The scope of a class can be 'local', 'shared', 'global' or 'system'.</p>
<ul>
    <li>Global and shared classes exactly match the behavior of global variables and  shared variables regarding visibility.</li>
    <li>'System' is a level above 'global' in terms of visibility, since a system  class is available even if you close the database that defines the  class.<br />
    <br />
    &nbsp;</li>
</ul>
<!-- startAnchor --><a name="Creating a Class the Loads Automatically"></a><!-- endAnchor -->
<h3>Creating a Class that Loads Automatically</h3>
<p>To create a class that loads automatically, or nearly so, (rather than requiring your to  first run the script that defines the class, as we have done in the prior  examples), you create the class definition in the new Class Editor in V10  (rather than in a script, as we have done in the previous examples).</p>
<p>To open the Class Editor, open the Code Editor and click the New Class icon  on the toolbar:</p>
<p>
	<img src="images/CodeEditorClassIcon.gif" height="30" width="32" alt="Image" /></p>
<p><br />
Even though a class can be defined in a script, the problem with doing  this is that the script must be run before the class is available for use.</p>
<p>On the other hand, if you create your class in the Class Editor, the class  will be will automatically be available when it is used, once a variable has been dim'd as the class.</p>
<p>To change our example so that the personInformation class is always available  when needed, open the Class Editor, and paste the class definition from above  into the editor.</p>
<p>(Note: Only paste the class definition, not the code that instantiates and  uses the class!. The last line of code that you paste must be 'end class'.)</p>
<p>When you paste the code into the Class Editor, be sure that the scope of the  Class is set to Global. The first line of the class definition should be:</p>
<p class="xbasic">define class global personInformation<br />
&nbsp;</p>
<p>Save the class with the same name as the class itself.</p>
<p>Now close the database and reopen it and then go to the Interactive window  and type:</p>
<p class="xbasic">dim p as personInformation</p>
<p>&nbsp;</p>
<p>Notice that it works! Alpha Five has automatically loaded the class into  memory for you and you are able to use the class anywhere.</p>
<!-- startAnchor --><a name="Static Methods - What They Are and How They are Used"></a><!-- endAnchor -->
<h3>Static Methods - What They Are and How They are Used</h3>
<p>A static class method is a method that does not require an 'instance' of the  class to exist.</p>
<p>A good example of a static method is table.open(). The table.open() command  creates an initialized table object that provides access to instance methods,  like &lttable>.change_begin() to start changing a record, and  &lttable>.close() - to close the table we opened.<br />
&nbsp;</p>
<p>You can create static methods in your Xbasic classes by using the <a class="wiki"  href="static" rel="">static</a>  keyword in the function definition.</p>
<p>Taking our original example, we add a static method called 'createPerson' to  the 'personInformation' class, which will let us create a person object and  initialize some of its properties:<br />
&nbsp;</p>
<p class="xbasic">define class global personInformation<br />
&nbsp;</p>
<p class="xbasic">dim first_name as c<br />
dim last_name as c<br />
dim gender as  c<br />
dim married as l = .f.<br />
&nbsp;</p>
<p class="xbasic">function Validate as l()<br />
if self.first_name = "" then <br />
&nbsp;&nbsp;&nbsp;  ui_msg_box("Error","Firstname is empty.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit  function<br />
end if<br />
&nbsp;</p>
<p class="xbasic">if self.last_name = "" then<br />
&nbsp;&nbsp;&nbsp; ui_msg_box("Error","Lastname  is empty.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit function<br />
end if<br />
&nbsp;</p>
<p class="xbasic">if self.gender = "" then<br />
&nbsp;&nbsp;&nbsp; ui_msg_box("Error","Gender is  not specified.")<br />
&nbsp;&nbsp;&nbsp; Validate = .f.<br />
&nbsp;&nbsp;&nbsp; exit function<br />
end if<br />
&nbsp;</p>
<p class="xbasic">Validate = .t.<br />
end function <br />
&nbsp;</p>
<p class="xbasic">function Edit as v()<br />
ui_dlg_box("Edit  person",&lt&lt%dlg%<br />
First Name:|[.40self.first_name];<br />
Last  Name:|[.40self.last_name];<br />
Gender:|[40self.gender^={Male,Female}];<br />
Married:|(married);<br />
{line=2};<br />
&lt*&OK>;<br />
%dlg%)<br />
end  function <br />
&nbsp;</p>
<p class="xbasic">function FullName as c()<br />
if self.gender = "Male" then<br />
&nbsp;&nbsp;&nbsp;  FullName = "Mr " + first_name - " " + last_name<br />
else if self.married then  <br />
&nbsp;&nbsp;&nbsp; FullName = "Mrs " + first_name - " " + last_name<br />
else <br />
&nbsp;&nbsp;&nbsp;  FullName = "Ms " + first_name - " " + last_name<br />
end if <br />
end  function<br />
&nbsp;</p>
<p class="xbasic">function <a class="wiki"  href="static" rel="">static</a> CreatePerson as p(fname as c,lname as c,gender  as c)<br />
dim person as personInformation<br />
person.first_name =  fname<br />
person.last_name = lname<br />
person.gender = gender<br />
CreatePerson =  person<br />
end function <br />
&nbsp;</p>
<p class="xbasic">end class<br />
&nbsp;</p>
<p>Now in the interactive window, we can create a new person object by using the  'personInformation.CreatePerson()' method, for example:<br />
&nbsp;</p>
<p class="xbasic">pd = personInformation.CreatePerson("John","Public","Male")<br />
?  pd.first_name<br />
= "John"<br />
<br />
pd.edit()<br />
&nbsp;</p>
<p>Using the static method of the personInformation class, we have created a new  instance of that class and initialized some of its properties. Alternatively, we  could have done this (which does not use the static method of the Class):</p>
<p class="xbasic">dim pd as personInformation</p>
<p class="xbasic">pd.first_name = "John"</p>
<p class="xbasic">pd.last_name = "Public"</p>
<p class="xbasic">pd.gender&nbsp; = "Male"</p>
<p class="xbasic">pd.edit()</p>
<p>Note that in a program, a static method defined in a class file can only be used once a variable has been dim'd as the class somewhere. The variable need not be in scope when the static method is invoked.</p>
<!-- startAnchor --><a name="Inheritance of Classes"></a><!-- endAnchor -->
<h3>Inheritance of Classes</h3>
<p>Inheritance is the concept of taking one class definition, and extending it  to add new data and methods. If we take our example class of personInformation,  an example of extending personInformation might be to create an  'employeeInformation' class which is built on the personInformation class, but  adds a 'salary' property.<br />
<br />
<br />
Here is an example that extends the  personInformation class to create a new class called  employeeInformation:<br />
&nbsp;</p>
<p class="xbasic">define class global employeeInformation inherits  personInformation<br />
&nbsp;</p>
<p class="xbasic">dim salary as n<br />
&nbsp;</p>
<p class="xbasic">function Edit as v()<br />
ui_dlg_box("Edit  employee",&lt&lt%dlg%<br />
First Name:|[.40self.first_name];<br />
Last  Name:|[.40self.last_name];<br />
Gender:|[40self.gender^={Male,Female}];<br />
Married:|(married);<br />
Salary:|[40self.salary];<br />
{line=2};<br />
&lt*&OK>;<br />
%dlg%)<br />
end  function <br />
&nbsp;</p>
<p class="xbasic">function [static] CreateEmployee as p(fname as c,lname as  c,gender as c,salary as n)<br />
dim employee as  employeeInformation<br />
employee.first_name = fname<br />
employee.last_name =  lname<br />
employee.gender = gender<br />
employee.salary = salary<br />
CreateEmployee  = employee<br />
end function <br />
&nbsp;</p>
<p class="xbasic">end class<br />
&nbsp;</p>
<p class="xbasic">&nbsp;</p>
<p>In the interactive window, we can now use employeeInformation - note that the  FullName() method that personInformation defines is available to the  employeeInformation class.<br />
&nbsp;</p>
<p class="xbasic"><br />
dim e as employeeInformation<br />
e =  employeeInformation.CreateEmployee("Sam","Smith","Male",70000)<br />
?  e.FullName()<br />
= "Mr Sam Smith"<br />
<br />
? e.salary<br />
= 70000</p>
<h2>See Also</h2>
<p><a href="Xbasic with Classes.html" title="Xbasic with Classes V11" class="wiki">Xbasic with Classes </a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Classes+V10">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common,review","status":"pending","keywords":"server,design,guide,xbasic","notes":"version 10"}--->
</body></html>