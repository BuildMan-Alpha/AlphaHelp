	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_write_a_socket_server_in_Xbasic">How to write a socket server in Xbasic</h1>
Below is a very basic server that you could expand to use multiple sockets and threads as required. It should give you a good starting point on how to use sockets in Xbasic. It does not implement any specific protocol on top of the sockets: that is left to you.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >dim Running            as l            = .t.    &#39;Set this to .f. from elsewhere to stop the server.
dim ListeningPort    as n            = 1234    &#39;The correct port should be defined in the protocol specification.
dim ServerSocket    as INET::Socket
if ServerSocket.Listen(ListeningPort)
    while Running
        dim WorkerSocket    as INET::Socket
        dim AcceptTimeout    as n            = 10000    &#39;10 seconds
        if ServerSocket.Accept(WorkerSocket,AcceptTimeout)
            &#39;This section could go into a spawned worker thread for maximum scalability
            dim RawRequest    as c            = &#34;&#34;
            if WorkerSocket.Read(RawRequest)
                &#39;RawRequest now contains at least part of a request from a client. Next:
                &#39; 1) Verify that the request is complete, and read more from the WorkerSocket if necessary.
                &#39; 2) Parse RawRequest based on the protocol specification to determine what must be done.
                &#39; 3) Take some appropriate action based on the parsed request.
                &#39; 4) Send a response using WorkerSocket.Write() or WorkerSocket.WriteBinary().
                &#39; 5) Close the socket or loop back to reading, depending on the protocol specification.
            else
                &#39;WorkerSocket.CallResult.Text will have a description of why the Read() failed.
            end if
            &#39;end of section that could go into a worker thread
        else
            &#39;No new client connected within the timeout period.
            &#39;Most servers should just do nothing and loop back around to wait again.
        end if
    end while
else
    msgbox(&#34;Server could not be started: &#34; + ServerSocket.CallResult.Text)
end if</pre></div><br />
<div class="clearfix rbox note"><img src="images/close.png" alt="Close" width="16" height="16" class="rbox-close" onclick="$(this).parent().fadeOut();" title="Close" /><div class="rbox-title"><img src="images/information.png" alt="note" width="16" height="16" title="note" class="icon" /><span>Note</span></div><div class="rbox-data">Since Xbasic does not have block-level scoping of variables, <strong>Dim WorkerSocket as INET::Socket</strong> inside the <strong>while</strong> loop does <em>not</em> guarantee a new unique socket for each pass. Therefore, spawning threads with unique sockets is non-trivial.<br />
<br />
Ultimately, this task is better handled by C#, which is available in Version 11 and later, or a C++ DLL.</div></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+write+a+socket+server+in+Xbasic">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","tags":"review","notes":"code with limited explanation","keywords":"server,design,guide,xbasic"}--->
</body></html>