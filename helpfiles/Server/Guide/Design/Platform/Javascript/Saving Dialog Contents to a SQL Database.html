	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Saving_Dialog_Contents_to_a_SQL_Database">Saving Dialog Contents to a SQL Database</h1>
You may not want to save your dialog contents to a DBF database, especially if you are using the dialog in a high-traffic Internet application. Instead, you can email the submitted data or save it to a SQL database. In this example, we'll save it to a SQL database.<br />
<br />
As before, we must first create an appropriate database. For our example, we'll use Microsoft SQL Server; you can use any SQL database you have available, including Microsoft Access. Since we already have the table structure in Alpha Five, this is a very easy process.<br />
<br />
First, go into your SQL database and create a new table. We created a new database named <em>soldier</em> using Microsoft SQL Server Management Studio. Then go to Alpha and create and then run an export operation from the <strong>soldier</strong> DBF table through a new AlphaDAO connection string (named <strong>soldier</strong>) to the <strong>soldier</strong> SQL table.<br />
<br />
<a href="javascript:void(0)" class="internal" onmouseover="return convertOverlib(this,'&nbsp;',['WIDTH=1190','HEIGHT=852','BACKGROUND=img/wiki_up/soldier_table_export.png']);">
	<img src="images/soldier_table_export.png" height="868" width="1221" alt="Image" /></a><br />
<br />
Now the SQL Server has a table <strong>soldier</strong> within a database <strong>soldier</strong>, which we can access through the named connection string <strong>soldier</strong>.<br />
<br />
Note that this process will not create indexes or a primary key. You can add an auto-incremented ID field to the table and make it the primary key if you wish. You can also add indexes for any field or combination of fields. This will not require any of the following code to change, since auto-incremented fields are not included in INSERT statements.<br />
<br />
Alternatively, just create the table, primary key, and indexes directly in SQL Server Management Studio or your database design tool of choice. You'll still need to create a connection string in Alpha Five.<br />
<br />
The code to handle the <strong>afterDialogValidate</strong> event is now:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >function afterDialogValidate as v (e as p)
&#39;... comments omitted ...
&#39;debug(1)
&nbsp;
&#39;Insert a new record into a remote SQL database.
&#39;DIM a connection variable
DIM cn as SQL::Connection
dim flagResult as l 
flagResult = cn.open(&#34;::Name::soldier&#34;)
if flagResult = .f. then 
  e.javascript=&#34;alert(&#39;Error, Could not connect to database. Error was: &#34; 
  e.javascript=e.javascript + cn.CallResult.text + &#34;&#39;);&#34;
  end 
end if
&nbsp;
&#39;Specify that we are using Portable SQL syntax
cn.PortableSQLEnabled = .t.
&nbsp;
&#39;Dim a SQL arguments object, create arguments and set their values
DIM args as sql::arguments
args.set(&#34;NAME&#34;,e.dataSubmitted.NAME)
args.set(&#34;RANK&#34;,e.dataSubmitted.RANK)
args.set(&#34;SERIALNR&#34;,e.dataSubmitted.SERIALNR)
&nbsp;
dim sqlInsertStatement as c 
sqlInsertStatement = &amp;lt;&amp;lt;%txt%
INSERT INTO soldier  (NAME, RANK, SERIALNR) VALUES (:NAME, :RANK, :SERIALNR)
%txt%
&nbsp;
dim flag as l 
flag = cn.Execute(sqlInsertStatement,args)
if flag = .f. then 
  e.javascript=&#34;alert(&#39;Error, Record was not inserted. Error was: &#34; 
  e.javascript=e.javascript + cn.CallResult.text + &#34;&#39;);&#34;
else
  if cn.AffectedRows() = 1 then 
    e.javascript=&#34;&#39;);&#34;+e.dataSubmitted.NAME + &#34;alert(&#39;Submitted: &#34; + e.dataSubmitted.RANK
    e.javascript=e.javascript + &#34;alert(&#39;Submitted: &#34; + e.dataSubmitted.SERIALNR + &#34;&#39;);&#34;
  else
    e.javascript=&#34;, &#34;
  end if 
end if 
&nbsp;
&#39;Now, close the connection 
cn.close()
&nbsp;
end function</pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Saving+Dialog+Contents+to+a+SQL+Database+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common,review","status":"pending","notes":"Alpha Five","keywords":"guide,javascript,sql,dbf"}--->
</body></html>