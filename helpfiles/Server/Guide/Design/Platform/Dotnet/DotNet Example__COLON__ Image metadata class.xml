<page>
	<topic>DotNet Example: Image metadata class</topic>
	<description>When writing an Xbasic function that uses the .NET Framework, you always have the option of writing or using a custom .NET class that gives you a simplified interface compared to using the .NET Framework classes directly. In DotNet Example: Image metadata function we tackled the problem of extracting EXIF metadata from a JPEG file using the .NET Framework classes directly. In this article we'll use a freely available .NET library, Exifacto(external link).
</description>
	<sections>
		<section>
		<description>It is interesting to note that while DotNet Example: Image metadata function used the System.Windows.Media.Imaging namespace(external link) (WPF), Exifacto(external link) uses the System.Drawing.Imaging namespace(external link) (Windows Forms). Windows Presentation Foundation and the older Windows Forms system have a large amount of duplication, so this is not really too surprising.

 The following script assumes that you have either checked out the project from googlecode.com using Subversion as described in the project pages, or downloaded and unzipped the attached DLL.
</description>
		<example><![CDATA[dim sv as dotnet::services
dim assy as dotnet::assemblyreference
 
'edit the path to the DLL in the next line
assy.FileName = "<path>\exifacto.dll" 
sv.RegisterAssembly("exif",assy)
 
'edit the path to the image in the next line
filename="<full path to image file>"
 
ex = new exif::Exifacto::exifdata(filename)
 
CameraMake=ex.CameraMake
CameraModel=ex.CameraModel
Copyright=ex.Copyright
DateTimeOriginal=ex.DateTimeOriginal
ImageDescription=ex.ImageDescription
Orientation=ex.Orientation.value__
ExposureProgram=ex.ExposureProgram.value__
Software=ex.Software
 
'show selected properties
exif_data = filename + \
  crlf()+"Camera: "+CameraMake+" "+CameraModel+" taken "+DateTimeOriginal+ \
  crlf()+"Description: "+ImageDescription+crlf()+"Copyright: "+Copyright+ \
  crlf()+"Orientation: "+Orientation+" ExposureProgram: "+ExposureProgram+ \
  crlf()+"Software: "+Software
ui_msg_box("exif",exif_data)
 
showvar(ex) 'show all properties]]></example>
</section>
	</sections>
	<see>
<ref>.NET Framework Support in Alpha Anywhere </ref>
<ref>DotNet::AssemblyReference</ref>
<ref>DotNet::Services</ref>
<ref href="/documentation/index?search=DotNet::Services.CreateObject Method">CreateObject Method</ref>
<ref href="/documentation/index?search=DotNet::Services.CallStaticFunction Method">CallStaticFunction Method</ref>
<ref href="/documentation/index?search=DotNet::Services.ConstructGenericTypeName Static Method">ConstructGenericTypeName Method</ref>
<ref href="/documentation/index?search=DotNet::Services.GetStaticProperty Method">GetStaticProperty Method</ref>
<ref href="/documentation/index?search=SetStaticProperty Method">SetStaticProperty Method</ref>
<ref href="/documentation/index?search=DotNet::Services.RegisterClass Method">RegisterClass Method</ref>
<ref href="/documentation/index?search=DotNet::Services.RegisterAssembly Method">RegisterAssembly Method</ref>
<ref href="/documentation/index?search=DotNet::Services.RegisterNamespace Method">RegisterNamespace Method</ref>
<ref href="/documentation/index?search=DotNet::Services.GenerateWebServiceClientFromURL Method">GenerateWebServiceClientFromURL Method</ref>
<ref href="/documentation/index?search=DotNet::Services.GenerateWebServiceClientFromWSDL Method">GenerateWebServiceClientFromWSDL </ref>
<ref href="/documentation/index?search=Preloaded .NET Classes">Preloaded .NET Classes </ref>
<ref href="/documentation/index?search=Writing Xbasic wrapper classes for .NET classes">Writing Xbasic wrapper classes for .NET classes </ref>
<ref href="/documentation/index?search=DotNetPath Function">DotNetPath Function</ref>
<ref>DotNet Examples </ref>
<ref href="/documentation/index?search=DotNet Example: Image metadata function">DotNet Example: Image metadata function</ref>
		
		
		
		
	</see>
	
</page>