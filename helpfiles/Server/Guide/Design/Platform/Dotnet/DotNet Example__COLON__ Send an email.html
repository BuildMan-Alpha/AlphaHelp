	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="DotNet_Example:_Send_an_email">DotNet Example: Send an email</h1>
This example is an Xbasic script that sends an email using the .NET System::Net::Mail class. Copy this into a new script, fill in your parameters, and test it from your desktop.<br />
<br />
You can easily turn this into a customized Send_Email function for your Web site or application with (at a minimum) the recipient, subject, and body as passed parameters, and all other settings declared within the function. Note that a message can have multiple To, CC, and Bcc recipients; those properties are collections of MailAddress objects. You can see the properties and methods of the Mail.MailMessage class from the Xbasic editor:<br />
<br />

	<img src="images/MailMessage_Properties_and_Methods.png" alt="Image" /><br />
<br />
If you want display names with your email addresses (e.g. "Mortimer Snerd &lt;mort@edgarbergen.com)"), use one of the long MailAddress constructors described <a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddress.mailaddress.aspx" rel="external nofollow">here</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />, e.g.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >msg.From = new System::Net::Mail::MailAddress(&#34;mort@edgarbergen.com&#34;,&#34;Mortimer Snerd&#34;)</pre></div><br />
<br />
You can also use a long constructor for the MailMessage object to initialize it using two MailAddress objects corresponding to the From and To addresses, e.g.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" >dim FromAddr as System::Net::Mail::MailAddress = \
  new System::Net::Mail::MailAddress(&#34;charlie@edgarbergen.com&#34;,&#34;Charlie McCarthy&#34;)
dim ToAddr as System::Net::Mail::MailAddress = \
  new System::Net::Mail::MailAddress(&#34;mort@edgarbergen.com&#34;,&#34;Mortimer Snerd&#34;)
dim Msg as System::Net::Mail::MailMessage = \
  new System::Net::Mail::MailMessage(FromAddr ,ToAddr)</pre></div><br />
<br />
In our sample code below we use the simple MailAddress constructor, which does not allow for a display name.<br />
<br />
If you want file attachments, uncomment the msg.Attachments.Add line. If you want them sometimes, add a test for a non-zero length for FileAttachment. If you want multiple attachments, add a FOR or FOR EACH loop on an array of attachment names. It would also be good to test for the existence of each file you want to send before attaching it.<br />
<br />
This general method for sending email is a good alternative to the various email functions built into Xbasic.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox2" >&#39;most commonly used parameters
dim recipient as C = &#34;mort@edgarbergen.com&#34;
dim subj as C = &#34;Mortimer Snerd&#34;
dim body as C = &#34;(your recipient here, must be one valid email)&#34;
dim isHtml as L = .T. &#39;.T. if body is HTML, otherwise .F.
dim FileAttachment as C = &#34;(your subject line here)&#34;
dim CC as C = &#34;(your email body here)&#34;
dim Bcc as C = &#34;(your attachment file path here)&#34;
&#39;If you want multiple recipients, CCs, or BCCs, you need to write FOR or FOR EACH loops
&#39; to add them
&nbsp;
&#39;parameters that are often static for a web site
dim sender as C = &#34;(your CC here, must be one valid email)&#34;
dim EmailServer as C  = &#34;(your BCC here, must be one valid email)&#34; &#39;put your server here
dim EmailPort as N = 587 &#39;usually 25 (plain) or 465 (SSL/TLS). 587 for GMail TLS.
dim isSSL as L = .T. &#39;.T. if SSL/TLS, .F. if not
dim EmailUser as C = &#34;(your sender here, must be one valid email)&#34;
dim EmailPassword as C = &#34;smtp.gmail.com&#34;
&nbsp;
dim msg as System::Net::Mail::MailMessage = new System::Net::Mail::MailMessage()
msg.To.Add(recipient)
msg.From = new System::Net::Mail::MailAddress(sender)
msg.Subject = subj 
msg.Body = body
msg.BodyEncoding = System::Text::Encoding::UTF8
msg.IsBodyHtml = isHtml 
msg.Priority = System::Net::Mail::MailPriority::Normal
dim addrCC as System::Net::Mail::MailAddress = new System::Net::Mail::MailAddress(CC)
msg.CC.Add(addrCC)
dim addrBcc as System::Net::Mail::MailAddress = new System::Net::Mail::MailAddress(Bcc)
msg.Bcc.Add(addrBcc)
&nbsp;
&#39;Uncomment the next line if you want to have a file attachment
&#39;msg.Attachments.Add(new System::Net::Mail::Attachment(FileAttachment))
&nbsp;
dim MailClient as System::Net::Mail::SmtpClient = \
    new System::Net::Mail::SmtpClient(EmailServer,EmailPort)
MailClient.EnableSsl = isSSL 
MailClient.UseDefaultCredentials = .F.
MailClient.Credentials = new System::Net::NetworkCredential(EmailUser, EmailPassword)
MailClient.Send(msg) &#39;this does the actual sending of email
msg.Dispose() &#39;clean up</pre></div><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/system.net.mail.aspx" rel="external nofollow">System.Net.Mail Namespace documentation on MSDN</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<a href=".NET Framework Support.html" title=".NET Framework Support in Alpha Five V11" class="wiki">.NET Framework Support in Alpha Five V11</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNet__NAMESPACE__AssemblyReference.html" title="DotNet::AssemblyReference" class="wiki">DotNet::AssemblyReference</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNet__NAMESPACE__Services.html" title="DotNet::Services" class="wiki">DotNet::Services</a><br />
<a href="../../../../Reference/Design/Api/DotNet/CreateObject Method.html" title="CreateObject Method" class="wiki">CreateObject Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/CallStaticFunction Method.html" title="CallStaticFunction Method" class="wiki">CallStaticFunction Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/ConstructGenericTypeName Method.html" title="ConstructGenericTypeName Method" class="wiki">ConstructGenericTypeName Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/GetStaticProperty Method.html" title="GetStaticProperty Method" class="wiki">GetStaticProperty Method</a><br />
<a href="SetStaticProperty Method.html" title="SetStaticProperty Method" class="wiki">SetStaticProperty Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterClass Method.html" title="RegisterClass Method" class="wiki">RegisterClass Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterAssembly Method.html" title="RegisterAssembly Method" class="wiki">RegisterAssembly Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterNamespace Method.html" title="RegisterNamespace Method" class="wiki">RegisterNamespace Method</a><br />
<a href="../../../../Reference/Design/Api/OLE/GenerateWebServiceClientFromURL Method.html" title="GenerateWebServiceClientFromURL Method" class="wiki">GenerateWebServiceClientFromURL Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/GenerateWebServiceClientFromWSDL Method.html" title="GenerateWebServiceClientFromWSDL Method" class="wiki">GenerateWebServiceClientFromWSDL Method</a><br />
<a href="Preloaded .NET Classes.html" title="Preloaded .NET Classes V11" class="wiki">Preloaded .NET Classes V11</a><br />
<a href="../Xbasic/Writing Xbasic Wrapper Classes for .NET classes.html" title="Writing Xbasic wrapper classes for .NET classes V11" class="wiki">Writing Xbasic wrapper classes for .NET classes V11</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNetPath Function.html" title="DotNetPath Function" class="wiki">DotNetPath Function</a><br />
<a href="/Index/DotNet Examples V11.html" title="DotNet Examples V11" class="wiki">DotNet Examples V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DotNet+Example%3A+Send+an+email">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web,common","status":"pending","keywords":"server,design,guide,xbasic,dotnet"}--->
</body></html>