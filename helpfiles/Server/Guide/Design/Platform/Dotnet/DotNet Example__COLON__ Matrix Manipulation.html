	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="DotNet_Example:_Matrix_Manipulation">DotNet Example: Matrix Manipulation</h1>
Mapack is a C# class library for basic linear algebra. It computes Norm, Determinant, Cholesky, LU, QR, SVD, least squares and eigenproblems. See <a class="wiki external" target="_blank" href="http://www.lutzroeder.com/dotnet/" rel="external nofollow">Lutz Roeder's site</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />, and download the source from <a class="wiki external" target="_blank" href="https://github.com/lutzroeder/Mapack/archives/master" rel="external nofollow">here</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" />. You can compile it yourself from source, or download the compiled DLL and example program attached to this page.<br />
<br />
The following sample is an Xbasic script based closely on the C# example provided with Mapack. Read the code and the comments to understand, among other things, how to use .NET <em><a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx" rel="external nofollow">indexers</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /></em> from Xbasic.<br />
<br />
Copy the sample into a new script in Alpha Five, edit the path to the Mapack dll, and run it. Compare the results you get to running the compiled C# example.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >&#39;Register Mapack
&nbsp;
dim sv as dotnet::services
dim assy as dotnet::assemblyreference
assy.FileName = &#34;&amp;lt;your path here&amp;gt;\Mapack.dll&#34; 
if .not. sv.RegisterAssembly(&#34;Mapack&#34;,assy)
    ui_msg_box(&#34;RegisterAssembly&#34;,&#34;Mapack not found at &#34;+assy.FileName)
    end 
end if
&nbsp;
dim p as p &#39;for display
&nbsp;
&#39;Exercise Mapack
&nbsp;
&#39;Create and populate matrix A
dim A as Mapack::Mapack::Matrix = new Mapack::Mapack::Matrix(3,3)
&#39;Note: Alpha Five automatically translates Xbasic 1-based indexing to 
&#39;  .NET 0-based indexers (class looks like an array)
A(1,1) = 2.0; A(1,2) = 1.0; A(1,3) = 2.0;
A(2,1) = 1.0; A(2,2) = 4.0; A(2,3) = 0.0;
A(3,1) = 2.0; A(3,2) = 0.0; A(3,3) = 8.0;
&nbsp;
&#39;Calculate and store determinant, trace, and norms of A
dim p.A as C = A.ToString()
dim p.Det as N = A.Determinant
dim p.Trace as N = A.Trace
dim p.Norm1 as N = A.Norm1
dim p.InfinityNorm as N = A.InfinityNorm
dim p.FrobeniusNorm as N = A.FrobeniusNorm
&nbsp;
&#39;Calculate the Singular Value Decomposition of A and store norm, 
&#39;   condition, and rank
dim svg as Mapack::Mapack::SingularValueDecomposition = \
        new Mapack::Mapack::SingularValueDecomposition(A)
dim p.Norm2 as N = svg.Norm2
dim p.Condition as N = svg.Condition
dim p.Rank as N = svg.Rank
&nbsp;
&#39;Calculate and store transpose and inverse of A
dim p.Transpose as C = A.Transpose().ToString()
dim p.Inverse as C = A.Inverse.ToString()
&nbsp;
&#39;A * A.Inverse should be the identity matrix, within epsilon
&#39;Note that the matrix multiplication * operator is not supported,
&#39;  so we use the (static) Matrix.Multiply method
dim I as Mapack::Mapack::Matrix = \
           Mapack::Mapack::Matrix.Multiply(A,A.Inverse)
dim p.AAinv as C = I.ToString()
&nbsp;
&#39;Note we could also have said:
&#39;   dim p.AAinv as C = A.Multiply(A,A.Inverse).ToString()
&nbsp;
&#39;Create and populate matrix B and solve the linear equation A*X=B
dim B as Mapack::Mapack::Matrix = new Mapack::Mapack::Matrix(3,3)
B(1, 1) = 2.0; B(1, 2) = 0.0; B(1, 3) = 0.0;
B(2, 1) = 1.0; B(2, 2) = 0.0; B(2, 3) = 0.0;
B(3, 1) = 2.0; B(3, 2) = 0.0; B(3, 3) = 0.0;
dim p.B as C = B.ToString()
&nbsp;
dim X as Mapack::Mapack::Matrix = A.Solve(B)
dim p.X as C = X.ToString()
&nbsp;
&#39;Check the result: T = A*X should be equal to B
dim T as Mapack::Mapack::Matrix = A.Multiply(A,X)
dim p.T as C = T.ToString()
&nbsp;
&#39;Calculate the Eigenvalue Decomposition of A and store the 
&#39;   Eigenvalues and Eigenvector matrix
dim eigen as Mapack::Mapack::EigenvalueDecomposition = \
           new Mapack::Mapack::EigenvalueDecomposition(A)
dim p.DiagMatrix as C = eigen.DiagonalMatrix.ToString()
&nbsp;
dim p.RealEigenvalues as C
&nbsp;
for each eigenvalue in eigen.RealEigenvalues
  p.RealEigenvalues = p.RealEigenvalues + eigenvalue + crlf()
next
&nbsp;
p.EigenvectorMatrix = eigen.EigenvectorMatrix.ToString()
&nbsp;
&#39;Note: If we used a for loop as below, we would have to use 
&#39; 0-based indexing  because Alpha Five does not automatically 
&#39; correct the offset function calls
&nbsp;
&#39;dim index as n
&#39;for index = 0 to eigen.RealEigenvalues.Length-1
&#39;  p.RealEigenvalues = p.RealEigenvalues + \
&#39;         eigen.RealEigenvalues.GetValue(index) + crlf()
&#39;next
&nbsp;
&#39;There are a few more lines to the Mapack C# example but they are 
&#39;  just multiplication and are left as an exercise for the student
&nbsp;
&#39;Show the results: you can compare these to the output of the C# example
showvar(p)</pre></div><br />
<br />
Running the above script will give you a pop-up window showing all the saved variables:<br />
<br />

	<img src="images/mapack_showvar.png" alt="Image" /><br />
<br />
Running the C# Example program gives:<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox1" >A = 
2 1 2 
1 4 0 
2 0 8 

A.Determinant = 40
A.Trace = 14
A.Norm1 = 10
A.NormInfinite = 10
A.NormFrobenius = 9.69535971483266
A.Norm2 = 8.62422264025397
A.Condition = 7.98847395632229
A.Rank = 3

A.Transpose = 
2 1 2 
1 4 0 
2 0 8 

A.Inverse = 
0.8 -0.2 -0.2 
-0.2 0.3 0.05 
-0.2 0.05 0.175 

I = A * A.Inverse = 
1 1.38777878078145E-17 0 
0 1 0 
0 0 1 

B = 
2 0 0 
1 0 0 
2 0 0 

A.Solve(B)
1 0 0 
0 0 0 
0 0 0 

A * A.Solve(B) = B = 
2 0 0 
1 0 0 
2 0 0 

A = V * D * V
D = 
1.0795832454869 0 0 
0 4.29619411425913 0 
0 0 8.62422264025397 

lambda = 
1.0795832454869
4.29619411425913
8.62422264025397

V = 
-0.912578082576527 0.280716539220287 0.297320479969233 
0.312482141860836 0.947745163412308 0.0642963159647745 
0.263735007572021 -0.151582749139746 0.952610369429297 

V * D * V' = 
2 1 2 
1 4 -1.11022302462516E-16 
2 -1.11022302462516E-16 8 

A * V = 
-0.985204008148176 1.20601274357339 2.56415801476184 
0.337350484866818 4.07169719286952 0.554505743828331 
0.284723895423112 -0.651228914677396 8.21552391537285 

V * D = 
-0.985204008148176 1.20601274357339 2.56415801476183 
0.337350484866819 4.07169719286952 0.554505743828331 
0.284723895423113 -0.651228914677396 8.21552391537284</pre></div><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a class="wiki external" target="_blank" href="http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx" rel="external nofollow">.NET indexers on MSDN</a><img src="images/external_link.gif" alt="(external link)" width="15" height="14" title="(external link)" class="icon" /><br />
<a href=".NET Framework Support.html" title=".NET Framework Support in Alpha Five V11" class="wiki">.NET Framework Support in Alpha Five V11</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNet__NAMESPACE__AssemblyReference.html" title="DotNet::AssemblyReference" class="wiki">DotNet::AssemblyReference</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNet__NAMESPACE__Services.html" title="DotNet::Services" class="wiki">DotNet::Services</a><br />
<a href="../../../../Reference/Design/Api/DotNet/CreateObject Method.html" title="CreateObject Method" class="wiki">CreateObject Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/CallStaticFunction Method.html" title="CallStaticFunction Method" class="wiki">CallStaticFunction Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/ConstructGenericTypeName Method.html" title="ConstructGenericTypeName Method" class="wiki">ConstructGenericTypeName Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/GetStaticProperty Method.html" title="GetStaticProperty Method" class="wiki">GetStaticProperty Method</a><br />
<a href="SetStaticProperty Method.html" title="SetStaticProperty Method" class="wiki">SetStaticProperty Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterClass Method.html" title="RegisterClass Method" class="wiki">RegisterClass Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterAssembly Method.html" title="RegisterAssembly Method" class="wiki">RegisterAssembly Method</a><br />
<a href="../../../../Reference/Design/Platform/Dotnet/RegisterNamespace Method.html" title="RegisterNamespace Method" class="wiki">RegisterNamespace Method</a><br />
<a href="../../../../Reference/Design/Api/OLE/GenerateWebServiceClientFromURL Method.html" title="GenerateWebServiceClientFromURL Method" class="wiki">GenerateWebServiceClientFromURL Method</a><br />
<a href="../../../../Reference/Design/Api/DotNet/GenerateWebServiceClientFromWSDL Method.html" title="GenerateWebServiceClientFromWSDL Method" class="wiki">GenerateWebServiceClientFromWSDL Method</a><br />
<a href="Preloaded .NET Classes.html" title="Preloaded .NET Classes V11" class="wiki">Preloaded .NET Classes V11</a><br />
<a href="../Xbasic/Writing Xbasic Wrapper Classes for .NET classes.html" title="Writing Xbasic wrapper classes for .NET classes V11" class="wiki">Writing Xbasic wrapper classes for .NET classes V11</a><br />
<a href="../../../../Reference/Design/Api/DotNet/DotNetPath Function.html" title="DotNetPath Function" class="wiki">DotNetPath Function</a><br />
<a href="/Index/DotNet Examples V11.html" title="DotNet Examples V11" class="wiki">DotNet Examples V11</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:DotNet+Example%3A+Matrix+Manipulation">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending","keywords":"dotnet"}--->
</body></html>