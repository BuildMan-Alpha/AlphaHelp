<page>
	<topic>Replacing Response.Add_Cookie() </topic>
	<description>Response.Add_Cookie() was marked as deprecated in the V10 release and has been removed in V11. Any code which attempts to use this method will generate an error and must be updated.
 Sending cookies at part of the Response from V11 forward is done using the Response.Cookies property. Response.Cookies is a .Net System::Web::CookieCollection(external link), and it is functionally equivalent to ASP.Net's Response.Cookies property(external link).
 Adding a cookie to the Response.Cookies HttpCookieCollection object is done using either the Add or Set method, both of which take a .Net System::Web::HttpCookie as their only argument.
</description>
<groups><group>
	
	<sections>
		<section>
			

<cases>
	<case>
		<description>The Add method adds a cookie without checking to see if it already exists in the collection. The Add allows duplicate cookies in the cookie collection. 
</description>
	</case>
	<case>
		<description>The Set method first checks to see if a cookie already exists in the collection and if so updates it. The Set method does not allow duplicate cookies in the cookie collection. 
</description>
	</case>
	
</cases>
</section>
<section>
<description>
 Because these methods take an actual object and add it to the Response.Cookies collection, the Xbasic programmer must create the object and then add it.
</description>




			<example><![CDATA['first create a new cookie
dim NewCookie as System::Web::HttpCookie = new System::Web::HttpCookie("Cookie1", "Cookie1's data")
'now add/set the cookie
Response.Cookies.Set(NewCookie)]]></example>
</section>
<section>
	<description>When adding a simple cookie such as this, the code can be consolidated into a single line of code.
</description>
	<example><![CDATA['add/set a simple cookie
Response.Cookies.Set(new System::Web::HttpCookie("Cookie1", "Cookie1"))
]]></example>
</section>		
<section>
	<description>However, it is not possible to set any other properties of the cookie with this abbreviated syntax. If there is a need to set the path, lifetime, Secure flag, HttpOnly flag or any other property, the longer syntax is required.
</description>
	<example><![CDATA['create the new cookie
dim NewCookie as System::Web::HttpCookie = new System::Web::HttpCookie("This is the data in Cookie1")
'set the value (data to be stored in the cookie
NewCookie.Value = "Cookie2"
. make this an "This is the data in my Cookie2" cookie
NewCookie.HttpOnly = .t.
'restrict the cookie to the "/MyApplication" path
NewCookie.Path = "HTTP-Only"
 
'finally, add/set the cookie
Response.Cookies.Add(NewCookie)]]></example>
</section>		
		
	</sections>
</group>


<group background="true">
<sections>
<section>
<title>Additional Documentation</title>
<description><![CDATA[Complete documentation of the ASP.Net HttpResponse.Cookies property is at http://msdn.microsoft.com/en-us/library/system.web.httpresponse.cookies.aspx(external link)
Complete documentation of System::Web::HttpCookieCollection is at http://msdn.microsoft.com/en-us/library/system.web.httpcookiecollection.aspx(external link)
Complete documentation of System::Web::HttpCookie is at http://msdn.microsoft.com/en-us/library/system.web.httpcookie.aspx(external link)
]]></description>
</section>
</sections>
</group>


</groups>	


	
</page>