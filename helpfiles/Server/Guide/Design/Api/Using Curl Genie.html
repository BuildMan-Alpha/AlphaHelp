
<html>
    <head>
        <link rel="stylesheet"  href="documentation.css"  type="text/css" />
    </head>
<body >
    <h1>CURL Object</h1>
    <h2>Using the CURL Genie to Generate Xbasic Code</h2>
    <p>
The easiest way to get started with the Xbasic CURL class is to use the genie on the right click menu in the 
Code editor.
    </p>
    <img src="images/libcurl_script_menu.png"/>
<p>
type your CURL command in...
</p>
    <img src="images/libcurl_curl_genie_1.png"/>
<p>
... and press the button to generate the code.
</p>
    <img src="images/libcurl_curl_genie_2.png"/>
<p>
... then proceed to edit the generated script to replace constant strings that are included in
the generated scripts with variables.
</p>

<h1>Understanding the Generated CURL Xbasic Script</h1>
<p>
If you look at the script generated by the above example, you will notice that a 
CURLFile and CURL
object are dimmed.
</p>
<p>
The CURL object is used for building up and executing the CURL command.
</p>
<p>
The CURLFile object is used to hold the results of a CURL request.
</p>
<p>
The setOpt() calls are all for setting the various CURL command options, all of which are available on the command line as parameters.
The names that are used for the parameters are all consistent with those used by 
the libCURL library (which is used internally by Xbasic).
</p>
<p>
The Exec() call does the work once everything is set up (using setOpt calls), Exec() returns logical 'true' if the command succeeded, else 'false' if there was a failure.
</p>
<p>
In the event of a successful operation, the file object that you passed in will contain the result of the request.
</p>
<p>
The GetHeaders() call returns the headers, but only if SetHeaderFlag(.t.) was called on the file object before the call.
In the example below, headers will always be empty.
</p>
<p>
The GetContent() call returns the data, in this case the HTML for the http request.
</p>
<p>
The content can either be a string or binary data - if the http request was for an image, GetContent() will return binary data.
</p>
	<p>
&nbsp;</p>
	<p class="xbasicSmall">
dim cf_1 as extension::CURLFile <br>
dim flag_1 as l <br>
dim ce as extension::CURL <br>
ce = extension::CURL.Init() <br>
ce.setOpt(&quot;URL&quot;,&quot;http://www.google.com&quot;) <br>
ce.setOpt(&quot;NOPROGRESS&quot;,1) <br>
ce.setOpt(&quot;USERAGENT&quot;,&quot;CURL/7.34.0&quot;) <br>
ce.setOpt(&quot;MAXREDIRS&quot;,50) <br>
ce.setOpt(&quot;CAINFO&quot;,&quot;C:\msysgit\msysgit\mingw\bin\CURL-ca-bundle.crt&quot;) <br>
ce.setOpt(&quot;SSH_KNOWNHOSTS&quot;,&quot;C:\Users\Cian\AppData\Roaming/_ssh/known_hosts&quot;) <br>
ce.setOpt(&quot;TCP_KEEPALIVE&quot;,1) ce.SetOpt(&quot;FILE&quot;,cf_1) <br>
flag_1 = ce.Exec() <br>
if flag_1 then <br>
&nbsp;&nbsp;&nbsp; showvar( &quot;Headers: &quot;+crlf()+cf_1.GetHeaders()+crlf()+&quot;Content:&quot;+crlf()+cf_1.GetContent())
<br>
else <br>
&nbsp;&nbsp;&nbsp; showvar(&quot;error: &quot; + ce.Error() ) <br>
end if <br>
ce.close() <br>
&nbsp;</p>
<p>
To see the header information, add this line before the call to Exec() in the script
</p>
	<p class="xbasic">
<code>
cf_1.SetHeaderFlag(.t.)
</code>
	</p>
<!---HELPMETADATA: {"status":"accept","tags":"common","keywords":"server,api,guide"} --->
</body>
</html>