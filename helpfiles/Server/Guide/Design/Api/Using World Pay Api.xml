<page>
    <topic>WorldPay API</topic>
    
    <groups>
        <group background="true">
    <title>Introduction</title>
    <sections>
        <section>
            <description>A new XBasic class called WorldPayAPI::SoapActions has been added to support the WorldPay Online Commerce Suite. All of the documented methods of the WorldPay SOAP API are included in this class. Click here to see the official WorldPay API documentation. WorldPay
                is one of the world's leading payment companies. The WorldPay integration within Alpha Anywhere allows developers to process credit card and ACH transactions easily through WorldPay. You will need to setup a WorldPay merchant account to get started. See Alpha
                Anywhere / WorldPay Info Before using the WorldPayAPI::SoapActions class you will need to make note of your WorldPay account Id, account subid( if any) and merchant pin. If you are testing with a sandboxed WorldPay developer account, you will also need to provide
                the test credit card information that will be provided by WorldPay.</description>
        </section>
        
        
      </sections></group>  <group> <title>To instantiate a WorldPayAPI::SoapActions object</title><sections>
        
        
        <section>
           
            <example><![CDATA[dim wp as WorldPayAPI::SoapActions = new WorldPayAPI::SoapActions() ]]></example>
        </section>
        <section>
            <description>You will be passing in a dot variable that contains (at a minimum) the required properties for each of the WorldPayAPI::SoapActions methods.</description>
        </section>
        
        
        
        
        </sections></group>
        <group>  <title>The WorldPayAPI::SoapActions methods include:</title>
            <sections>
        
        <section>
          
            <cases>
                <case>
                    <title>Credit Card Transactions</title>
                    <cases>
                        <case>
                            <title>processCCSale</title>
                            <description>Process a credit card sale</description>
                            <cases>
                                <case>
                                
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCCAuth</title>
                            <description>Authorize a credit card sale</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                   
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCCCredit</title>
                            <description>Process a standalone credit card credit</description>
                            <cases>
                                <case>
                                     
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                            
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCCPost</title>
                            <description>Process a post/capture of a previous credit card auth</description>
                            <cases>
                                <case>
                                   
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processAuthReverse</title>
                            <description>Perform a reversal of a credit card auth</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processVoid</title>
                            <description>Void a previous auth or sale</description>
                            <cases>
                                <case>
                                    
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                               
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCredit</title>
                            <description>Issue credit for a previous CC or ACH Sale</description>
                            <cases>
                                <case>
                              
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
                
                <case>
                    <title>Gift Card Transactions</title>
                    <cases>
                      <case>
                            <title>processSVSale</title>
                            <description>Process a gift card sale</description>
                            <cases>
                                <case>
                                   
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                     <case>
                            <title>processSVAddValue</title>
                            <description>Add value to a gift card</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin,amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                         <case>
                            <title>processSVIssue</title>
                            <description>Issue a new gift card</description>
                            <cases>
                                <case>
                                     
                                    <description>Required Properties: acctid, subid, merchantpin,amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                   
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                         <case>
                            <title>processSVDeactivate</title>
                            <description>Deactivate a gift card</description>
                            <cases>
                                <case>
                                     
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                   
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                         <case>
                            <title>processSVRefund</title>
                            <description>Refund a gift card transaction</description>
                            <cases>
                                <case>
                               
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    
                    </cases>
                    
                </case>
                
                
                
                
                
                
                
                
                
                
                
                <case>
                    <title>Stored Profiles</title>
                    <cases>
                        <case>
                            <title>processProfileSale</title>
                            <description>Issue CC, ACH or ExtACH sale using a stored profile.</description>
                            <cases>
                                <case>
                                
                                    <description>Required Properties: acctid, subid, merchantpin, amount, userprofileid, last4digits</description>
                                </case>
                                <case>
                                 
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processProfileCredit</title>
                            <description>Issue credit using a stored profile</description>
                            <cases>
                                <case>
                                 
                                    <description>Required Properties: acctid, subid, merchantpin, amount, userprofileid, last4digits</description>
                                </case>
                                <case>
                                 
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processProfileUpdate</title>
                            <description>Updates a stored profile</description>
                            <cases>
                                <case>
                                    
                                    <description>Required Properties: acctid, subid, merchantpin, userprofileid, last4digits, accttype, profilenobill</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCCProfileAdd</title>
                            <description>Store credit card using a stored profile</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                   
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCKProfileAdd</title>
                            <description>Store ACH using a stored profile</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, ckname, ckaba, ckno, ckacct</description>
                                </case>
                                <case>
                                   
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processExtACHProfileAdd</title>
                            <description>Store ExtACH using a stored profile</description>
                            <cases>
                                <case>
                               
                                    <description>Required Properties: acctid, subid, merchantpin, ckname, ckaba, ckno, ckacct</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processProfileDelete</title>
                            <description>Delete a stored profile</description>
                            <cases>
                                <case>
                              
                                    <description>Required Properties: acctid, subid, merchantpin, userprofileid, last4digits, ipaddress</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processProfileRetrieve</title>
                            <description>Retrieves the account number, address and billing info</description>
                            <cases>
                                <case>
                            
                                    <description>Required Properties: acctid, subid, merchantpin, userprofileid, last4digits</description>
                                </case>
                                <case>
                              
                                    <description>Response Object: ProcessProfileResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processAccountLookup</title>
                            <description>Performs an account lookup for the stored profile</description>
                            <cases>
                                <case>
                              
                                    <description>Required Properties: acctid, subid, merchantpin, ssnum, billaddress</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessAccountLookupResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
                
                <case>
                    <title>Debit Card Transactions</title>
                    <cases>
                        <case>
                            <title>processDebitSale</title>
                            <description>Process PIN-Debit sale transaction</description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, customerid, swipedata</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitAuth</title>
                            <description>Process PIN-Debit auth transaction</description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, customerid, swipedata</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitReturn</title>
                            <description>Process PIN-Debit return transaction</description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, customerid, orderid, historyid</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitVoid</title>
                            <description>Process PIN-Debit void transaction</description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitPost</title>
                            <description>Issue PIN-Debit post</description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitPinless</title>
                            <description>Issue pinless debit</description>
                            <cases>
                                <case>
                                    <description>Required Properties:  acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname </description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                         <case>
                            <title>processDebitPinlessCredit</title>
                            <description> Issue pinless credit </description>
                            <cases>
                                <case>
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                  <case>
                                    <description>Response Object: ProcessResult</description>
                                </case>
                                
                            </cases>
                        </case>
                        
                        
                        
                        
                    </cases>
                    
                    
                </case>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <case>
                    <title>ACH Transactions</title>
                    <cases>
                        <case>
                            <title>processACHSale</title>
                            <description>Process a ACH sale</description>
                            <cases>
                                <case>
                                
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ckname, ckaba, ckno, ckacct, cktype</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processVoid</title>
                            <description>Void a previous check authorization</description>
                            <cases>
                                <case>
                                 
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processCredit</title>
                            <description>Issue credit for a previous ACH sale</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processACHCredit</title>
                            <description>Process a standalone ACH credit</description>
                            <cases>
                                <case>
                               
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ckname, ckaba, ckno, ckacct, cktype</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processACHVerification</title>
                            <description>Process a ACH verification</description>
                            <cases>
                                <case>
                                
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ckname, ckaba, ckno, ckacct, cktype</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>Check 21 Transactions</title>
                    <cases>
                        <case>
                            <title>processC21Sale</title>
                            <description>Process a check 21 ICL/RCC sale</description>
                            <cases>
                                <case>
                                    
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ckname, firstname, lastname, ckaba,</description>
                                </case>
                                <case>
                                
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>-</title>
                            <description>-</description>
                            <cases>
                                <case>
                            
                                    <description>Required Properties: ckno, ckacct, ckaccttype, billstreet, housenumber, companyname, phone,</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object:</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>-</title>
                            <description>-</description>
                            <cases>
                                <case>
                                    
                                    <description>Required Properties: email, billaddress</description>
                                </case>
                                <case>
                                
                                    <description>Response Object:</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processC21Credit</title>
                            <description>Process a check 21 ICL/RCC credit</description>
                            <cases>
                                <case>
                                 
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                                 
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processC21Void</title>
                            <description>Process a check 21 ICL/RCC void</description>
                            <cases>
                                <case>
                                   
                                    <description>Required Properties: acctid, subid, merchantpin, amount, orderid, historyid</description>
                                </case>
                                <case>
                              
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>Recurring Records</title>
                    <cases>
                        <case>
                            <title>processRecurAdd</title>
                            <description>Creates a recurring record without an initial transaction</description>
                            <cases>
                                <case>
                               
                                    <description>Required Properties: acctid, subid, merchantpin, accttype, acctdata1, acctdata2, acctname,</description>
                                </case>
                                <case>
                                 
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>-</title>
                            <description>-</description>
                            <cases>
                                <case>
                                
                                    <description>Required Properties: recurring, recur_nextbillingdate</description>
                                </case>
                                <case>
                              
                                    <description>Response Object:</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processRecurUpdate</title>
                            <description>Updates a recurring record</description>
                            <cases>
                                <case>
                          
                                    <description>Required Properties: acctid, subid, merchantpin, orderid</description>
                                </case>
                                <case>
                                 
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processRecurCancel</title>
                            <description>Cancels an active recurring record</description>
                            <cases>
                                <case>
                              
                                    <description>Required Properties: acctid, subid, merchantpin, orderid, canceltype</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>3rd Party Check Processing</title>
                    <cases>
                        <case>
                            <title>processExtACHConsumerDisbursement</title>
                            <description>Process a standalone ext ACH consumer disbursement</description>
                            <cases>
                                <case>
                                  
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                              
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processExtACHCredit</title>
                            <description>Process an extented ACH credit</description>
                            <cases>
                                <case>
                                    
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processExtACHSale</title>
                            <description>Process an extended ACH sale</description>
                            <cases>
                                <case>
                                   
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                    
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>processExtACHVoid</title>
                            <description>Process sn extended ACH void</description>
                            <cases>
                                <case>
                                   
                                    <description>Required Properties: acctid, subid, merchantpin, amount, ccnum, expmon, expyear, ccname</description>
                                </case>
                                <case>
                                  
                                    <description>Response Object: ProcessResult</description>
                                </case>
                            </cases>
                        </case>
                    </cases>
                </case>
            </cases>
        </section>
        <section>
            <note>Only the required properties are indicated in the table above. Each of the methods takes a variety of properties and objects that are further described in the WorldPay SOAP Integration Guide. See The WorldPay SOAP Integration Guide ("WPAY_SOAP_Integration_Guide.pdf")</note>
        </section>
        
        </sections></group>
        <group>  <title>Response Objects</title><sections>
        
        
        <section>
          
            <cases>
                <case>
                    <title>Builtin XBasic CallResult</title>
                    <cases>
                        <case>
                            <title>returnDataValue</title>
                            <description>Contains one of the 3 possible WorldPay response objects, dependent upon the API method called.</description>
                            <cases>
                                <case>
                                    <description>ProcessResult</description>
                                </case>
                                <case>
                                    <description>ProcessProfileResult</description>
                                </case>
                                <case>
                                    <description>ProcessAccountLookupResult</description>
                                </case>
                            </cases>
                        </case>
                        <case>
                            <title>Canceled</title>
                            <description>Value is .T. if the API call is canceled otherwise .F.</description>
                        </case>
                        <case>
                            <title>Error</title>
                            <description>Value is .T. on error condition, otherwise .F.</description>
                        </case>
                        <case>
                            <title>NativeCode</title>
                            <description>Native response code value returned from the request, if any.</description>
                        </case>
                        <case>
                            <title>NativeText</title>
                            <description>Native text value returned from the request, typically Success or Declined.</description>
                        </case>
                        <case>
                            <title>Code</title>
                            <description>Value is response code value of the API call, if any.</description>
                        </case>
                        <case>
                            <title>Text</title>
                            <description>Value indicates the status of the API call.</description>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>WorldPay Response Objects:</title>
                </case>
                <case>
                    <title>ProcessResult</title>
                    <cases>
                        <case>
                            <title>status</title>
                            <description>Declined or approved.</description>
                        </case>
                        <case>
                            <title>result</title>
                            <description>Colon delimited result code.</description>
                        </case>
                        <case>
                            <title>total</title>
                            <description>Floating point number indicating transaction dollar amount in US dollars. Round to 2 decimal places as required.</description>
                        </case>
                        <case>
                            <title>orderid</title>
                            <description>Order key id of the original transaction.</description>
                        </case>
                        <case>
                            <title>historyid</title>
                            <description>History key id of the original transaction.</description>
                        </case>
                        <case>
                            <title>authcode</title>
                            <description>Colon delimited result code.</description>
                        </case>
                        <case>
                            <title>merchantordernumber</title>
                            <description>Customer's unique alpha-numeric number.</description>
                        </case>
                        <case>
                            <title>acctid</title>
                            <description>If subid LoadBalancing is enabled, includes the acctid used for the transaction.</description>
                        </case>
                        <case>
                            <title>subid</title>
                            <description>If subid LoadBalancing is enabled, includes the subid used for transaction.</description>
                        </case>
                        <case>
                            <title>transdate</title>
                            <description>Date and time of the transaction in ISO 8601 format. See WorldPay doc for details.</description>
                        </case>
                        <case>
                            <title>paytype</title>
                            <description>Payment type used to process the transaction (MasterCard, Visa, Amex, etc.)</description>
                        </case>
                        <case>
                            <title>duplicate</title>
                            <description>0 or 1, 1 indicates a duplicate was detected.</description>
                        </case>
                        <case>
                            <title>avsresult</title>
                            <description>AVS result code.</description>
                        </case>
                        <case>
                            <title>cvv2result</title>
                            <description>CVV2 result code.</description>
                        </case>
                        <case>
                            <title>batchnumber</title>
                            <description>Batch number asssigned to the transaction.</description>
                        </case>
                        <case>
                            <title>last4digits</title>
                            <description>Last four digits of the credit card or ACH transaction.</description>
                        </case>
                        <case>
                            <title>entrymethod</title>
                            <description>Indicates how the transaction was processed.</description>
                        </case>
                        <case>
                            <title>partialapproval</title>
                            <description>0 or 1, 1 indicates a partial amount was received.</description>
                        </case>
                        <case>
                            <title>actioncode</title>
                            <description>Code identifying partial approval amount.</description>
                        </case>
                        <case>
                            <title>balance</title>
                            <description>Balance inquiry amount.</description>
                        </case>
                        <case>
                            <title>recurbillingamount</title>
                            <description>Recurring amount.</description>
                        </case>
                        <case>
                            <title>recurextbillingdate</title>
                            <description>Date to recur.</description>
                        </case>
                        <case>
                            <title>recurbillingcycle</title>
                            <description>Recur cycle.</description>
                        </case>
                        <case>
                            <title>recurbillingmax</title>
                            <description>Max number of recurrings.</description>
                        </case>
                        <case>
                            <title>recurcanceldate</title>
                            <description>Cancel date of recurrings.</description>
                        </case>
                        <case>
                            <title>recurlastattempted</title>
                            <description>Date of last recurring attempted.</description>
                        </case>
                        <case>
                            <title>recurbillingstatus</title>
                            <description>Status of recurring.</description>
                        </case>
                        <case>
                            <title>recurtotalaccept</title>
                            <description>Total number of approved recurrings processed.</description>
                        </case>
                        <case>
                            <title>achrcode</title>
                            <description>ACH return code</description>
                        </case>
                        <case>
                            <title>transactiontype</title>
                            <description>Type of transaction.</description>
                        </case>
                        <case>
                            <title>additionaldata</title>
                            <description>XML document containing additional data. See WorldPay SOAP Integration Guide doc.</description>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>ProcessProfileResult</title>
                    <cases>
                        <case>
                            <title>status</title>
                            <description>Declined or approved.</description>
                        </case>
                        <case>
                            <title>result</title>
                            <description>Colon delimited result code. Round to 2 decimal places as required.</description>
                        </case>
                        <case>
                            <title>orderid</title>
                            <description>Order key id of the original transaction.</description>
                        </case>
                          <case>
                            <title>historyid</title>
                            <description>History key id of the original transaction.</description>
                        </case>
                          <case>
                            <title>authcode</title>
                            <description>Colon delimited result code.</description>
                        </case>
                          <case>
                            <title>merchantordernumber</title>
                            <description>Customer's unique alpha-numeric number.</description>
                        </case>
                          <case>
                            <title>transdate</title>
                            <description>Date and time of the transaction in ISO 8601 format. See WorldPay doc for details.</description>
                        </case>
                          <case>
                            <title>paytype</title>
                            <description>Payment type used to process the transaction (MasterCard, Visa, Amex, etc.)</description>
                        </case>
                          <case>
                            <title>duplicate</title>
                            <description>0 or 1, 1 indicates a duplicate was detected.</description>
                        </case>
                          <case>
                            <title>userprofileid</title>
                            <description>User profile id of the transaction.</description>
                        </case>
                          <case>
                            <title>last4digits</title>
                            <description>Last four digits of the credit card or ACH transaction.</description>
                        </case>
                          <case>
                            <title>acctid</title>
                            <description>If subid LoadBalancing is enabled, includes the acctid used for the transaction.</description>
                        </case>
                        
                          <case>
                            <title>subid</title>
                            <description>If subid LoadBalancing is enabled, includes the subid used for transaction.</description>
                        </case>
                          <case>
                            <title>avsresult</title>
                            <description>AVS result code.</description>
                        </case>
                          <case>
                            <title>cvv2result</title>
                            <description>CVV2 result code.</description>
                        </case>
                          <case>
                            <title>batchnumber</title>
                            <description>Batch number asssigned to the transaction.</description>
                        </case>
                        
                          <case>
                            <title>entrymethod</title>
                            <description>Indicates how the transaction was processed.</description>
                        </case>
                          <case>
                            <title>partialapproval</title>
                            <description>0 or 1, 1 indicates a partial amount was received.</description>
                        </case>
                          <case>
                            <title>actioncode</title>
                            <description>Code identifying partial approval amount.</description>
                        </case>
                          <case>
                            <title>additionaldata</title>
                            <description>XML document containing additional data. See WorldPay SOAP Integration Guide doc.</description>
                        </case>
                        
                          <case>
                            <title>billaddr1</title>
                            <description>Billing address.</description>
                        </case>
                           <case>
                            <title>billaddr2</title>
                            <description>Billing address (extended).</description>
                        </case>
                           <case>
                            <title>billcity</title>
                            <description>Billing city.</description>
                        </case>
                           <case>
                            <title>billstate</title>
                            <description>Billing state.</description>
                        </case>
                    </cases>
                </case>
                <case>
                    <title>ProcessAccountLookupResult</title>
                    <cases>
                        <case>
                            <title>status</title>
                            <description>Declined or approved.</description>
                        </case>
                        <case>
                            <title>result</title>
                            <description>Colon delimited result code.</description>
                        </case>
                        <case>
                            <title>orderid</title>
                            <description>Order key id of the original transaction.</description>
                        </case>
                                <case>
                            <title>historyid</title>
                            <description>History key id of the original transaction.</description>
                        </case>
                                <case>
                            <title>authcode</title>
                            <description>Colon delimited result code.</description>
                        </case>
                                <case>
                            <title>paytype</title>
                            <description>Payment type used to process the transaction (MasterCard, Visa, Amex, etc.)</description>
                        </case>
                                <case>
                            <title>last4digits</title>
                            <description>Last four digits of the credit card or ACH transaction.</description>
                        </case>
                                <case>
                            <title>entrymethod</title>
                            <description>Indicates how the transaction was processed.</description>
                        </case>
                                <case>
                            <title>transactiontype</title>
                            <description>Type of transaction.</description>
                        </case>
                                <case>
                            <title>firstname</title>
                            <description>Customer's first name</description>
                        </case>
                                <case>
                            <title>lastname</title>
                            <description>Customer's last name </description>
                        </case>
                                <case>
                            <title>phone</title>
                            <description>Customer's phone</description>
                        </case>
                                <case>
                            <title>addr1</title>
                            <description>Customer's address 1</description>
                        </case>
                                <case>
                            <title>addr2</title>
                            <description>Customer's address 2</description>
                        </case>
                                <case>
                            <title>city</title>
                            <description>Customer's city</description>
                        </case>
                                <case>
                            <title>state</title>
                            <description>Customer's state</description>
                        </case>
                                <case>
                            <title>zipcode</title>
                            <description>Customer's zip code / postal code</description>
                        </case>
                                <case>
                            <title>country</title>
                            <description>Customer's country</description>
                        </case>
                        
                                <case>
                            <title>additionaldata</title>
                            <description>XML document containing additional data. See WorldPay SOAP Integration Guide doc.</description>
                        </case>
                               
                    </cases>
                </case>
            </cases>
        </section>
        
        
        
        
        <section>
            <title>WorldPay:: Classes </title>
            <cases>
                <case>
                    <title>WorldPay::Recur</title>
                    <cases>
                        <case>
                            <title>create</title>
                            <description>Type int: A value of 1 will create the recurring entry</description>
                           
                        </case>             
                         <case>
                            <title>billingcycle</title>
                            <description>Type int. Coded value, 0 through 11, see WorldPay doc for details.</description>
                            
                        </case>                   
                         <case>
                            <title>billingmax</title>
                            <description>Type int. Number of max re-bills (1,2,3, -1 = unlimited)</description>
                          
                        </case>              
                         <case>
                            <title>start</title>
                            <description>Type int. Number of days to start the recur.</description>
                           
                        </case>              
                         <case>
                            <title>amount</title>
                            <description>Type float. Recurring amount.</description>
                           
                        </case>              
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::Address</title>
                    <cases>
                        <case>
                            <title>addr1</title>
                            <description>Type string. Consumer billing address 1</description>
                           
                        </case>     
                            <case>
                            <title>addr2</title>
                            <description>Type string. Consumer billing address 2</description>
                           
                        </case>                  
                            <case>
                            <title>addr3</title>
                            <description>Type string. Consumer billing address 3</description>
                          
                        </case>     
                            <case>
                            <title>city</title>
                            <description>Type string. Consumer billing city</description>
                           
                        </case>     
                            <case>
                            <title>state</title>
                            <description>Type string. Consumer billing state</description>
                          
                        </case>     
                            <case>
                            <title>zip</title>
                            <description>Type string. Consumer billing zip code</description>
                           
                        </case>     
                            <case>
                            <title>country</title>
                            <description>Type string. Consumer billing country</description>
                          
                        </case>     
                        
                        
                        
                        
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::CustomEmail</title>
                    <cases>
                        <case>
                            <title>emailto</title>
                            <description>Type string. Email address to send consumer email recipt, default is ci_email address.</description>
                          
                        </case>       
                         <case>
                            <title>emailfrom</title>
                            <description>Type string. Return email address on consumers email receipt. Default is null@atsbank.com.</description>
                           
                        </case>                  
                         <case>
                            <title>emailsubject</title>
                            <description>Type string. Subject line on the consumers email receipt. Default is Payment Receipt #xyz</description>
                            
                        </case>       
                         <case>
                            <title>emailtext</title>
                            <description>Type string. Email body text on consumers receipt. Default is generic receipt message.</description>
                           
                        </case>       
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::CustomFields</title>
                    <cases>
                        <case>
                            <title>custom1</title>
                            <description>Type string. Merchant's custom field #1</description>
                          
                        </case>              
                        <case>
                            <title>custom2</title>
                            <description>Type string. Merchant's custom field #2</description>
                           
                        </case>                    
                        <case>
                            <title>custom3</title>
                            <description>Type string. Merchant's custom field #3</description>
                            
                        </case>                 
                        <case>
                            <title>custom4</title>
                            <description>Type string. Merchant's custom field #4</description>
                          
                        </case>                 
                        <case>
                            <title>custom5</title>
                            <description>Type string. Merchant's custom field #5</description>
                         
                        </case>                 
                        <case>
                            <title>custom6</title>
                            <description>Type string. Merchant's custom field #6</description>
                           
                        </case>                 
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::HotelLodging</title>
                    <cases>
                        <case>
                            <title>chargetypeamx</title>
                            <description>Type string. Code indicating type of charge. 1= Hotel, 2 = Restaurant, 3 = Gift Shop</description>
                           
                        </case>                 
                        <case>
                            <title>roomrateamt</title>
                            <description>Type string. Room rate in US dollars, ex. 0.00.</description>
                           
                        </case>                  
                        <case>
                            <title>checkindate</title>
                            <description>Type string. Check in date (yymmdd)</description>
                           
                        </case>                 
                        <case>
                            <title>checkoutdate</title>
                            <description>Type string. Check out date (yymmdd)</description>
                          
                        </case>                 
                        <case>
                            <title>purchaseid</title>
                            <description>Type string. Hotel folio number (25 alphanumeric chars max) </description>
                           
                        </case>                 
                        <case>
                            <title>pproperty</title>
                            <description>Type string. Prestigious property indicator, used by Visa only, see WorldPay doc.</description>
                         
                        </case>                 
                        <case>
                            <title>extracharges</title>
                            <description>Type string. Coded 6 1-digit codes for charges, see WorldPay doc.</description>
                         
                        </case>                 
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::AutoRental</title>
                    <cases>
                        <case>
                            <title>rentalagreementnum</title>
                            <description>Type string. 25 alphanumeric chars max</description>
                            
                        </case>                  
                    </cases>     
                </case>     
                 <case>
                    <cases>
                        <case>
                            <title>rentalrate</title>
                            <description>Type string. Rental rate amount</description>
                           
                        </case>      
                          <case>
                            <title>noshowprogind</title>
                            <description>Type char. Value of "1" indicates a no show charge </description>
                           
                        </case>                        
                          <case>
                            <title>extracharges</title>
                            <description>Type char. Coded character value, "0" thru "5", see WOrldPay doc.</description>
                            
                        </case>            
                          <case>
                            <title>rentaldate</title>
                            <description>Type string. Rental start date, yy/mm/dd</description>
                           
                        </case>            
                          <case>
                            <title>rentalreturndate</title>
                            <description>Type string. Rental end date, yy/mm/dd</description>
                          
                        </case>            
                          <case>
                            <title>rentername</title>
                            <description>Type string. Renter's name</description>
                          
                        </case>            
                          <case>
                            <title>rentalreturncity</title>
                            <description>Type string. Return city</description>
                          
                        </case>            
                          <case>
                            <title>rentalreturnstatecountry</title>
                            <description>Type string. Return State/Country, ISO3 coding</description>
                           
                        </case>            
                          <case>
                            <title>rentalreturnlocationid</title>
                            <description>Type string. 10 char location id </description>
                          
                        </case>            
                         
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::AutoRepair</title>
                    <cases>
                        <case>
                            <title>vin</title>
                            <description>Type string. Vehicle identification number</description>
                            
                        </case>             
                         <case>
                            <title>odometer</title>
                            <description>Type string. Odometer mileage</description>
                           
                        </case>                    
                         <case>
                            <title>workorder</title>
                            <description>Type string. Merchant's work order number</description>
                           
                        </case>               
                         <case>
                            <title>unit</title>
                            <description>Type string. Truck/Vehicle unit number </description>
                           
                        </case>               
                         <case>
                            <title>repaircode</title>
                            <description>Type string. Code to identify type of repair</description>
                           
                        </case>               
                        
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::FSA</title>
                    <cases>
                        <case>
                            <title>healthcareflag</title>
                            <description>Type int. 1 = on, 0 = off</description>
                         
                        </case>          
                         <case>
                            <title>rxamount</title>
                            <description>Type float. Qualified presecription amount</description>
                           
                        </case>                   
                         <case>
                            <title>clinicamount</title>
                            <description>Type float. Qualified medical clinic amount</description>
                           
                        </case>           
                         <case>
                            <title>visionamount</title>
                            <description>Type sfloat. Qualified vision amount</description>
                            
                        </case>           
                         <case>
                            <title>dentalamount</title>
                            <description>Type float. Qualified dental amount</description>
                    
                        </case>           
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::PurchaseCardLevel2</title>
                    <cases>
                        <case>
                            <title>pocustomerrefid</title>
                            <description>Type string. Cardholders customer id or reference number</description>
                       
                        </case>           
                          <case>
                            <title>taxamount</title>
                            <description>Type float. Total tax charged fot the transaction</description>
                           
                        </case>                   
                          <case>
                            <title>taxexempt</title>
                            <description>Type int. 1 = tax exempt, 0 = taxable</description>
                            
                        </case>            
                    </cases>     
                </case>     
                 <case>
                    <title>WorldPay::PurchaseCardLevel3</title>
                    <cases>
                        <case>
                            <title>lineitems</title>
                            <description>Type string. See WorldPay doc, Appendix F</description>
                          
                        </case>                  
                    </cases>     
                </case>     
                   <case>
                    <title>WorldPay::Restaurant</title>
                    <cases>
                        <case>
                            <title>gratuityamount</title>
                            <description>Type float. The gratuity amount</description>
                          
                        </case>                  
                    </cases>     
                </case>     
                   <case>
                    <title>WorldPay::FleetCardData</title>
                    <cases>
                        <case>
                            <title>atpump</title>
                            <description>Type int. Coded value, 1 = yes, 0 = no</description>
                          
                        </case>        
                          <case>
                            <title>idnumber</title>
                            <description>Type string. User id</description>
                            
                        </case>                   
                          <case>
                            <title>vehicleid</title>
                            <description>Type string. Vehicle id</description>
                            
                        </case>         
                          <case>
                            <title>driverid</title>
                            <description>Type string. Driver id</description>
                          
                        </case>         
                          <case>
                            <title>odometerreading</title>
                            <description>Type string. Odometer reading</description>
                            
                        </case>         
                          <case>
                            <title>miscnumericdata</title>
                            <description>Type string. Customer data</description>
                           
                        </case>         
                          <case>
                            <title>jobnumber</title>
                            <description>Type string. Job number</description>
                            
                        </case>         
                          <case>
                            <title>purchasedevsequencenumber</title>
                            <description>Type string. Purchase device sequence number</description>
                           
                        </case>         
                          <case>
                            <title>departmentnumber</title>
                            <description>Type string. Department number</description>
                            
                        </case>         
                        
                    </cases>     
                </case>     
            </cases>
        </section></sections></group>    
    <group><title>Example Code</title><sections>
        
   <section>
    
      <description>The XBasic example code below can be used to test numerous methods of the WorldPayAPI::SoapActions class. You will need to provide your own merchantpin, test credit card info, acctid, 
</description> 
    <example><![CDATA[dim runTests as l = .t. 

if (runTests) 
    dim cr as CallResult 
    dim p as p 
    p.merchantpin = "1234567890" 
    p.ccname = "WORLDPAY/TEST" 
    p.amount = 3.98 
    p.expmon = 12  
    p.expyear = 2015 
    p.companyname = "enterCompanyNameHere" 
    p.phone = "222-222-2222" 
    p.acctid = "enterYourAcctIdHere" 
    p.subid = "enterYourSubIdHere" 
     
    'for testing credits/returns 
    p.historyid = "enterHistoryIdHere" 
    p.orderid = "enterOrderIdHere" 
     
    ' for testing profile update method 
    p.accttype = 1 
    p.profilenobill = 0 
     
    '// ------ TEST CARD DATA ---------- ** 
    'uncomment / comment out as required for testing 
     
    ' test Visa  
    'p.ccnum = "enterVisaCardNumHere" 
     
    ' test Amex 
    p.ccnum = "enterAmexCardNumHere" 
     
    p.userprofileid = "enterUserProfileIdHere" 
    p.last4digits = "entelast4DigitsHere" 
    p.ipaddress = "enterIPAddressHere" 
     
    ' test Discover 
    'p.ccnum = "enterDiscoverCardNumHere" 
     
    '  ------END TEST CARD DATA -------- 
     
    ' instantiate wp object from class 
    dim wp as WorldPayAPI::SoapActions = new WorldPayAPI::SoapActions()

    ' test custom fields, not required for all methods. Notice the use of WorldPay::CustomFields class 
    p.customizedfields = new WorldPay::CustomFields() 
    p.customizedfields.custom1 = "My custom Field #1" 
    p.customizedfields.custom2 = "My custom Field #2" 
     
    ' test custom email, not required for all methods. Notice the use of WorldPay::CustomEmail class 
    p.customizedemail = new WorldPay::CustomEmail() 
    p.customizedemail.emailto = "mycustomer@acmewidgets.com"
     
    ' test bill and ship addresses, not required for all methods. Notice the use of the WorldPay::Address class 
    p.billaddress = new WorldPay::Address() 
    p.billaddress.addr1 = "1 Bay Road" 
    p.billaddress.city = "Duxbury" 
    p.billaddress.state = "MA" 
    p.billaddress.zip = "02332" 
     
    p.shipaddress = new WorldPay::Address() 
    p.shipaddress.addr1 = "700 Congress St." 
    p.shipaddress.city = "Fairfield" 
    p.shipaddress.state = "CT" 
    p.shipaddress.zip = "06430" 
     
    'uncomment / comment out as required for testing 
    cr = wp.processCreditCardSale(p) 
    'cr = wp.processCreditCardAuth(p) 
    'cr =  wp.processAuthReverse(p) 
    'cr = wp.processVoid(p) 
    'cr = wp.processCredit(p) 
    'cr = wp.processCCProfileAdd(p) 
    'cr = wp.processProfileSale(p) 
    'cr = wp.processProfileDelete(p) 
    'cr = wp.processProfileUpdate(p) 
     
    dim msgTmpl as c 
    dim resultType as c = trim(cr.ReturnDataValue)
     
    select  
        case resultType = "ProcessResult"  
            msgTmpl = "Status: "+ cr.ReturnDataValue.status + crlf()+ \ 
            "Paytype "+ cr.ReturnDataValue.paytype + crlf()+ \ 
            "Total: "+ round(cr.ReturnDataValue.total,2) + crlf()+ \ 
            "Last 4 digits: " + cr.ReturnDataValue.last4digits + crlf()+ \ 
            "AuthCode: " + cr.ReturnDataValue.authcode + crlf() + \ 
            "OrderId: "+ cr.ReturnDataValue.orderid + crlf()+ \ 
            "HistoryId: "+ cr.ReturnDataValue.historyid  
         
        case resultType = "ProcessProfileResult"  
            msgTmpl = "Status: "+ cr.ReturnDataValue.status + crlf()+ \ 
            "Paytype "+ cr.ReturnDataValue.paytype + crlf()+ \ 
            "Total: "+ round(cr.ReturnDataValue.total,2) + crlf() + \ 
            "Last 4 digits: " + cr.ReturnDataValue.last4digits + crlf()+ \ 
            "AuthCode: " + cr.ReturnDataValue.authcode + crlf() + \ 
            "OrderId: "+ cr.ReturnDataValue.orderid + crlf() + \ 
            "HistoryId: "+ cr.ReturnDataValue.historyid + crlf() + \ 
            "UserProfileId: "+cr.ReturnDataValue.userprofileid  
         
        case resultType = "ProcessAccountLookupResult"  
            msgTmpl = "Status: "+ cr.ReturnDataValue.status + crlf()+\ 
            "Paytype "+ cr.ReturnDataValue.paytype + crlf()+ \ 
            "OrderId: "+ cr.ReturnDataValue.orderid+crlf()+ \ 
            "HistoryId: "+ cr.ReturnDataValue.historyid + \ 
            "AuthCode: " + cr.ReturnDataValue.authcode + crlf() + \ 
            "Last 4 digits: " + cr.ReturnDataValue.last4digits + crlf()+ \ 
            "First name: " + cr.ReturnDataValue.firstname + crlf()+ \ 
            "Last name: " + cr.ReturnDataValue.lastname + crlf()+ \ 
            "Phone : " + cr.ReturnDataValue.phone + crlf()+ \ 
            "Address1: " + cr.ReturnDataValue.addr1 + crlf()+ \ 
            "Address2: " + cr.ReturnDataValue.addr2 + crlf()+ \ 
            "City: " + cr.ReturnDataValue.city + crlf()+ \ 
            "State: " + cr.ReturnDataValue.state + crlf()+ \
            "Zip code: " + cr.ReturnDataValue.zipcode + crlf()+ \ 
            "Country: " + cr.ReturnDataValue.country + crlf() 
         
        case else 
            msgTmpl = "Error, unknown result type." 
     
    end select 
    ui_msg_box("WorldPay Results",msgTmpl) 
         
end if ]]></example>   
       
   </section>     
        
        
        
        
        
        
        
        
    </sections>
    </group>
    </groups>
</page>