<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/theme.css" />

<title>JSON_Data</title>
<style>
<!--
.xbasicSmall      { font-family: Courier New; font-size: 9pt; color: #0000FF; margin-left: .75in;
               margin-top: 0; margin-bottom: 0 }
               
.xbasicSmallSpan      { font-family: Courier New; font-size: 9pt; color: #0000FF;  }

-->
</style>
</head>

<body>

&nbsp;<p align="center"><font align="center" size="7">JSON Data</font>

</p>

<div class="helpserver_toc">
<ul>
<li>
	<a href="#Introduction">Introduction</a>
</li>
<li>
	<a href="#Using JSON with Xbasic">Using JSON with Xbasic</a>
</li>
<li>
	<a href="#Using JSON with Javascript">Using JSON with Javascript</a>
</li>
<li>
	<a href="#Using JSON to send Data between a Client and Server">Using JSON to send Data between a Client and Server</a>
</li>


<li><a href="#JSON Functions">JSON Functions</a>
<ul>
	<li><a href="#a5_compact_json()">a5_compact_json()</a> </li>
	<li><a href="#a5_expand_json()">a5_expand_json()</a> </li>
	<li><a href="#a5_json_extractvalues()">a5_json_extractvalues()</a> </li>
	<li><a href="#a5_json_populatearray()">a5_json_populatearray()</a> </li>
	<li><a href="#a5_json_prep()">a5_json_prep()</a> </li>
	<li><a href="#a5_makejsontree()">a5_makejsontree()</a> </li>
	<li><a href="#a5_merge_json_into_template()">a5_merge_json_into_template()</a>
	</li>
	<li><a href="#a5_sql_nested_query_to_json_document()">a5_sql_nested_query_to_json_document()</a>
	</li>
	<li><a href="#a5_url_from_storagejsonformat()">a5_url_from_storagejsonformat()</a>
	</li>
	<li><a href="#a5_xbasictreetojsontree()">a5_xbasictreetojsontree()</a> </li>
	<li><a href="#a5w_ajaxtojson()">a5w_ajaxtojson()</a> </li>
	<li><a href="#argumentsfromjson()">argumentsfromjson()</a> </li>
	<li><a href="#argumentstojson()">argumentstojson()</a> </li>
	<li><a href="#crlf_to_json()">crlf_to_json()</a> </li>
	<li><a href="#crlf_to_json()">crlf_to_json()</a> </li>
	<li><a href="#json_composite()">json_composite()</a> </li>
	<li><a href="#json_enumerate()">json_enumerate()</a> </li>
	<li><a href="#json_extract()">json_extract()</a> </li>
	<li><a href="#json_filter()">json_filter()</a> </li>
	<li><a href="#json_flatten()">json_flatten()</a> </li>
	<li><a href="#json_from_bson()">json_from_bson()</a> </li>
	<li><a href="#json_from_xml()">json_from_xml()</a> </li>
	<li><a href="#json_from_xml_odata()">json_from_xml_odata()</a> </li>
	<li><a href="#json_generate()">json_generate()</a> </li>
	<li><a href="#json_parse()">json_parse()</a> </li>
	<li><a href="#json_parse()">json_parse()</a> </li>
	<li><a href="#json_reformat()">json_reformat()</a> </li>
	<li><a href="#json_reformat_safe()">json_reformat_safe()</a> </li>
	<li><a href="#json_reformat_safe()">json_reformat_safe()</a> </li>
	<li><a href="#json_sample_array()">json_sample_array()</a> </li>
	<li><a href="#json_select()">json_select()</a> </li>
	<li><a href="#json_sqlquery()">json_sqlquery()</a> </li>
	<li><a href="#json_standardize()">json_standardize()</a> </li>
	<li><a href="#json_to_bson()">json_to_bson()</a> </li>
	<li><a href="#json_to_xml()">json_to_xml()</a> </li>
	<li><a href="#json_validate()">json_validate()</a> </li>
	<li><a href="#property_from_json()">property_from_json()</a> </li>
	<li><a href="#property_to_json()">property_to_json()</a> </li>
	<li><a href="#vartojson()">vartojson()</a> </li>
	<li><a href="#vartojsonhash()">vartojsonhash()</a> </li>
	<li><a href="#vartojsonstandard()">vartojsonstandard()</a> </li>
	<li><a href="#xbasic_expression_to_json()">xbasic_expression_to_json()</a>
	</li>
	<li><a href="#xbasic_from_json()">xbasic_from_json()</a> </li>
	<li><a href="#xbasic_script_to_json()">xbasic_script_to_json()</a> </li>
	<li><a href="#'json class">'json class</a> </li>
	<li><a href="#dim json as extension::JSON">dim json as extension::JSON</a>
	</li>
</ul></li>

</ul>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="Introduction">Introduction</a></h1>


<p>&nbsp;</p>


<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
<p><font size="2"><font color="#0000FF">JSON</font>, or Javascript Object 
Notation, is simply a terse way of storing javascript objects. In many programming languages, 
to create an object you must first create a variable and then create the children 
of that variable independently. For example, you could define an 
object named 'o'&nbsp; in javascript like this:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = new Object();<br>
o.firstName = 'Selwyn';<br>
o.lastName = 'Rabins';</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">Using this method, the children of the 'o' object 
			would need to be created one by one; each one including the name of 
			its parent object. This results in a lot of code that is often difficult to interpret. 
			In this case the object 'o' has a very simple name. However, it is 
			not be hard to imagine situations in which the object name is much 
			longer or where the programmer wants a child of the object to be an 
			array or an object in and of itself. JSON provides a compelling 
			alternative that makes this task straightforward. Rather than define 
			each child individually, all of the children that belong to an 
			object are enclosed in curly brackets. Each child in the object, 
			except for the last child, is then delimited using a comma.&nbsp;
			</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = {<br>
firstname: 'Selwyn',<br>
lastName: 'Rabins'<br>
}</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">The simplicity of JSON's format has made it 
			ubiquitous in Web application development. Having a good 
			understanding of JSON is therefore very helpful in building web 
			applications. JSON is very frequently used for data storage, where 
			it is gaining in popularity over xml, and many websites return data in 
			JSON format. Because of this JSON is the ideal way for sending 
			complex data from the client to the server, or from the server to 
			the client.</font></p>
			<p>&nbsp;</p>
			<p><font size="2">In the javascript language JSON is processed 
			inline. This means that you can use JSON in javascript and it will 
			be automatically recognized by the javascript engine. You can add 
			objects, arrays, and literal values to your JSON data, write some 
			javascript code to build a given part of an object, and it will just 
			work. When the javascript engine comes across any JSON data it knows 
			that a sub-object is a sub-object, an array is an array, and a 
			literal value is a literal value. You do not have to parse JSON in 
			javascript. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Most of Alpha Anywhere's server-side code is 
			written in Xbasic, a language that does not support JSON natively. 
			However, Alpha Anywhere does support a lot of methods that work with JSON 
			and allow you to both import and export JSON to and from your 
			components. How do these methods work? When you create a JSON 
			object, the children of that object are read in Xbasic as a string. 
			The Xbasic methods then take that string, work against it, and return 
			either JSON or Xbasic. Alpha Anywhere's set of methods can do the 
			same thing for Xbasic objects, returning either JSON or Xbasic. This 
			gives you the ability to parse a string into an object and an object into a string. 
			For example, take the following Xbasic object:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
dim o.firstName as c = &quot;Selwyn&quot;<br>
dim o.lastName as c = &quot;Rabins&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
<p>&nbsp;</p>
<p><font size="2">You could create an 'o' object like the one above in Xbasic. 
It would work, but you would end up having to write a lot of unnecessary code 
for each of the 'o' parent object's children. Include Alpha Anywhere's JSON 
parse method, and you can easily simplify things by placing the data for 'o' 
object's children into a JSON format:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
o = json_parse(&quot;{firstName: 'Selwyn', lastName: 'Rabins'}&quot;)</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p align="left">&nbsp;</p>
			<p align="left">&nbsp;</p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<p>The concepts in JSON can be used both in the server and client side in 
javascript.</p>
<p>JSON is a data interchange format</p>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="Using JSON with Xbasic">Using JSON with Xbasic</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The example below demonstrates how you can apply this 
			information in building a <font color="#0000FF">UX component</font> 
			using Xbasic on the server-side that uses JSON. You can also follow 
			the videos here </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_1.swf">
								<font size="2"><u>Part 1</u></font></a><font size="2">,
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_2.swf">
								<u>Part 2</u></a>, </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_3.swf">
								<font size="2"><u>Part 3</u></font></a></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Using Xbasic on the server-side to work with 
								JSON:</b></p>
<p>&nbsp;<br>
								1. In Alpha Anywhere's toolbar click on the
<font color="#0000FF">Interactive Window</font> button. This will open the Code 
editor.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive.png" width="241" height="53"></p>
<p>&nbsp;</p>
<p>2. In the Code Editor, go to the <font color="#0000FF">Interactive</font> tab 
and define the following dot variable name 'pp' by entering this code. This is 
an Xbasic object. Hit <font color="#0000FF">Enter</font> at the end of every 
line.</p>
<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>3. Now add <i>?json_generate(pp)</i> to the end of the pp object. Hit
<font color="#0000FF">Enter</font> again.</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
						<p><font size="2" color="#333300">?json_generate(pp)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>4. You should see a generated JSON representation of the pp object. You have 
succesfully serialized the 'pp' 
object to a JSON string.</p>
<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">= {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30</font></p>
<p><font size="2" color="#333300">}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive2.png" width="295" height="195"></p>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">In JSON objects start with curly brackets , close 
			curly bracket defines the end of the object. Inside the object you 
			have name value pairs. All of the property names are double quoted. 
			Can also encode logical values. </font><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p>= {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : true</p>
<p>}</p>
<p>&nbsp;</p>
<p>Can also instatiate an object from a JSON string. Go the other way</p>
<p>&nbsp;</p>
<p>dim txt as c </p>
<p>txt = &lt;&lt;%str%</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : ture</p>
<p>}</p>
<p>%str%</p>
<p>dim pp2 as p</p>
<p>pp2 = json_parse(txt)</p>
<p>debug(1)</p>
<p>&nbsp;</p>
<p>can open debugger, run pp2, see property of name </p>
<p>-------------------------------------</p>
<p>Video 2 Working with Arrays</p>
<p>&nbsp;</p>
<p>previous video parsed a string. What if you wanted nested arrays or 
sub-objects. All properties in JSON are delimited with a comma </p>
<p>&nbsp;</p>
<p>add another property, an address object that contains a street, number, city, </p>
<p>&nbsp;</p>
<blockquote>
	<p>dim txt as c </p>
	<p>txt = &lt;&lt;%str%</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : true,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Address&quot; : {</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Number&quot; : 123,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;City&quot; : Boston</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	}</p>
	<p>}</p>
	<p>%str%</p>
	<p>dim pp2 as p</p>
	<p>pp2 = json_parse(txt)</p>
	<p>debug(1)</p>
</blockquote>
<p>Just as address is a subject, there could be sub-objects inside address .</p>
<p>When we look in pp2 now we see address as an object with subojects inside it</p>
<p>Now Create an array</p>
<p>&nbsp;</p>
<p>Add another property, children. Now this will be an array, notated with 
square brackets. Within the array you can have literal values or objects 
themselves. Here we have an object containing&nbsp; Name and Age as the first 
element of an array. </p>
<p>&nbsp;</p>
<blockquote>
	<p>dim txt as c </p>
	<p>txt = &lt;&lt;%str%</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : true,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Address&quot; : {</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Number&quot; : 123,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;City&quot; : Boston</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	},</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Children&quot; : [</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3}</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	]</p>
	<p>}</p>
	<p>%str%</p>
	<p>dim pp2 as p</p>
	<p>pp2 = json_parse(txt)</p>
	<p>debug(1)</p>
</blockquote>
<p>-----------------------</p>
<p>Video 3</p>
<p>&nbsp;</p>
<p>JSON representation of objects. Now we can add to the array by giving Fred 
another two children.</p>
<p>&nbsp;</p>
<p>&quot;Children&quot; : [</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Sally&quot;, &quot;Age&quot; : 5}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Kim&quot;, &quot;Age&quot; : 7}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
]</p>
<p>&nbsp;</p>
<p>You don't have to put each property on its own line. But between each 
property there has to be a comma. Each item in an array is also delimited by a 
comma, except for the last item in the array or object</p>
<p>&nbsp;</p>
<p>Now if you go to debugger you can see the array containing three items, if 
you click on it. Complex xbasic object by taking info from JSON. Can also pass 
things the other way</p>
<p>&nbsp;</p>
<p>add this to the bottom of your code</p>
<p>&nbsp;</p>
<blockquote>
	<p>dim txt2 as c</p>
	<p>txt2 = json_generate(pp2)</p>
	<p>showvar(txt2)</p>
</blockquote>
<p>&nbsp;</p>
<p>Now when you run this you should see JSON.</p>
<p>The JSON generate functions has some options, special flags let you run JSON 
that contains javascript functions</p>
<p>&nbsp;</p>
<p>Have shown how JSON can be used to serialize objects in xbasic, pass Json and 
get an xbasic object back</p>
<p>&nbsp;</p>
<p>How JSON is very useful to send data back and forth from the client and or 
server</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		<p>&nbsp;</p>
		<p>&nbsp;</td>
	</tr>
</table>
<p>&nbsp;you can work with JSON on 
								the server side (using Xbasic) and on the 
								client-side (using Javascript). <br>
								<br>
								We show how </p>
<p>&nbsp;</p>
<p><font size="2">Json to XML </font></p>
<p>&nbsp;</p>
<p><font size="2">this is how json is used in javascript and how it is used in 
xbasic. it has to be string in xbasic.</font></p>
<p><font size="2">JSON is used by many services and to communicate between a 
server and a client. Alpha Anywhere therefore has a set of tools to mapulate 
JSON data.</font></p>
<p><font size="2">JSON Parse is slower but forgiving. Not all things that 
purport to be JSON are JSON. For example, the use of quotes around a string, 
this is not required on microsoft's parser. </font></p>
<p><font size="2">JSON from services that you want to manipulate in some way, 
filter out fields, add in fields, extract an individual element from JSON.</font></p>
<p><font size="2">Xbasic and Javascript JSON functions</font></p>
<p><font size="2">take json text and then do something with it and return a 
result</font></p>
<p><font size="2">json select- pass it a string of json data and return a string 
out of that</font></p>
<p><font size="2">crlf - takes something like colors and turn it into a json 
array,</font></p>
<p><font size="2">JSON parse and generate most important Parse take a sting and 
turns it into an xbasic object returns the object. Could access it as you 
expect. </font></p>
<p><font size="2">Generate takes a variable and returns JSON. </font></p>
<p><font size="2">tags flags nulls --logic that exists</font></p>
<p><font size="2">JS object notation in the parsing that xbasic can do is not as 
full as the JS object notation that exists in Javascript</font></p>
<p>&nbsp;</p>
<p><font size="2">when you use a date object in JS that is a complete date 
object. In JSON string that you end with that is transportable, that is not 
transported. It doesn't necessarily support that feature. </font></p>
<p>&nbsp;</p>
<p><font size="2">In JS object notation you can create functions as properties 
inside an JS object, anywhere else wonder what is going on.</font></p>
<p>&nbsp;</p>
<p><font size="2">AA supports special flags special tags - look for strings that 
have certain features if we see that we will output them as javascript</font></p>
<p><font size="2"><br>
<br>
dim o as p<br>
o.myFunc = &quot;function(){...}&quot;<br>
<br>
?json_generate(o,.t.)<br>
&quot;{myFunc: 'function(){...}'}&quot;<br>
<br>
o.myFunc = &quot;{javascript}function(){...}&quot;<br>
<br>
?json_generate(o,.t.)<br>
&quot;{myFunc: function(){...}}&quot;</font></p>
<p><font size="2">all operating inside the context of xbasic - generating a 
strring that will be consumed by a browser, can have js extras in the actual 
json it will not blow things up.</font></p>
<p>&nbsp;</p>
<p><font size="2">generate walking over object, return everything in JSON 
syntax. </font></p>
<p>&nbsp;</p>
<p><font size="2">Xbasic JSON functions - you would use these in Xbasic code, 
often times the easiest way to get into the client is Javascript. When someone 
clicks a button do a ajax callback, does manipulations, then has an object.. the 
client broswer is waiting for the response , take that object generate out some 
JSON and return it to the client. Xbasic is currently the coding langugae on the 
server. Sometimes you need to turn that into something the client side browser 
can recognize, that is going to be Javascript.</font></p>
<p>&nbsp;</p>
<p><font size="2">For a UX component how would you go about doing something like 
this.</font></p>
<p>&nbsp;</p>
<p><font size="2">You can use JSON to store data, have some data, have it 
generate, save it on the server, use it latter, parse it.</font></p>
<p><font size="2">can be thought of inside of JS - can do everything that JS can 
do - use it extensively. </font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><font size="2">if the json data is coming from a file on disk - </font></p>
<p>&nbsp;</p>
<p><font size="2">pulling json off the web - pulls and returns json. pull send 
request to cnn.com , return news stories in json format, call external servers 
and ask for thins</font></p>
<p><font size="2">now an object that you can access.</font></p>
<p>&nbsp;</p>
<p><font size="2">all of these json functions are used to create the code. 
builders we have written that build the code</font></p>
<p><font size="2">SQl have a ux that you want to access the sql have builder 
that you enter the address filter etc to get to that data. behind the scenes 
this is getting turned into , resean alpha is refered to as a low code 
environment. </font></p>
<p>&nbsp;</p>
<p><font size="2">How would you implement this code.</font></p>
<p><font size="2">Might have a button that is tied to an AJAX callback which 
turns around and calls up some Xbasic. You might add these functions to that 
Xbasic to allow you to go out and get JSON data from an external source and then 
return that as xbasic into your component.</font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><font size="2">some will take an object and reutn a string</font></p>
<p><font size="2">some of them will take a string and return a string</font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div id="yui_3_16_0_1_1445516875381_23382" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	Json_parse - handles incorrectly formatted json (i.e. JSON spec requires 
	names be quoted)<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445516875381_23398" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	This uses a microsoft JSON parser.<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445516875381_23397" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	? json_parse(&quot;{ foo : 1}&quot;)</div>
<div id="yui_3_16_0_1_1445516875381_23396" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	= foo = 1</div>
<div id="yui_3_16_0_1_1445516875381_23385" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445516875381_23394" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	property_from_json() - requires proper JSON, but is 2 to 5 times faster than 
	json_parse()<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445516875381_23393" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	dim ptr as p</div>
<div id="yui_3_16_0_1_1445516875381_23380" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	property_from_json(ptr,&quot;{ foo : 1}&quot;)</div>
<div id="yui_3_16_0_1_1445516875381_23379" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	Error parsing json: Name of an object member must be a string</div>
<div id="yui_3_16_0_1_1445516875381_23378" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
&nbsp;</div>
<div id="yui_3_16_0_1_1445516875381_23377" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	property_from_json(ptr,&quot;{ \&quot;foo\&quot; : 1}&quot;)</div>
<div id="yui_3_16_0_1_1445516875381_23311" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	? ptr.foo</div>
<div id="yui_3_16_0_1_1445516875381_23387" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	= 1</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON with Javascript">Using JSON with Javascript</a></h1>



<p>&nbsp;</p>
<p>Using Javascript on the client-side to work with 
								JSON<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_4.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_5.swf">
								Watch Video - Part 2</a></p>
<p>&nbsp;</p>
<p>Video 1. Have shown how to serialize objects. What have we learned? A JSON 
object starts and ends with curly brackets, have as many name value pairs as you 
want within those curly brackets. Each name value paior is delimited with a 
comma. Each entry can be an array, a literal, or an object. Can represent very 
complex objects using JSON. JSON is very easy to read and understand.</p>
<p>&nbsp;</p>
<p>Moving to UX component wher e we can play with JSON on the JS side.</p>
<p>Working PReview. Have a button that will create an object in Javascript and 
then serialize it to JSON and then print it out.</p>
<p>&nbsp;</p>
<p>Open the UX builder</p>
<p>Go to controls, add a button</p>
<p>executing an javascript funtions called objectsTest()</p>
<p>have JS variable object being initialized by passing into it a JSON string</p>
<p>equivalent to using JSON parse on the xbasic side to instantiate an xbasic 
object on a JSON string</p>
<p>Object literal an JSON look similar but are not identical</p>
<p>&nbsp;</p>
<blockquote>
	<p>function objectsTest() {</p>
	<p>&nbsp;&nbsp;&nbsp; var obj = {</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Firstname&quot; : Fred&quot;,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Lastname&quot; : &quot;Smith&quot;,</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Children&quot; : [</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 10},</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</p>
	<p>&nbsp;&nbsp;&nbsp; };</p>
	<p>&nbsp;</p>
	<p>&nbsp;&nbsp;&nbsp; var msg = JSON.stringify(obj);</p>
	<p>&nbsp;&nbsp;&nbsp; $('msg1').innerHTML = msg;</p>
	<p>&nbsp;&nbsp;&nbsp; </p>
	<p>}</p>
	<p>&nbsp;</p>
	<p>function parseJSON()&nbsp; {</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var json = {dialog.object}.getValue('jsonIn')</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var obj = JSON.parse(json);</p>
	<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(obj 
	[Children'][1]['Name']);</p>
	<p>}</p>
</blockquote>
<p>call javascript method json.stringify serialize this object into a string 
called msg1 </p>
<p>and then we are goping to put msg1 into the text of a div</p>
<p>&nbsp;</p>
<p>Video2----------------------------</p>
<p>Using JSON on the client side in JS here displaying the resulting string in 
the HTML</p>
<p>Just like on the Xbasic side where we use json_parse and json_generate there 
exists similar features in javascript on the client-side</p>
<p>&nbsp;second button on UX component parse JSON</p>
<p>&nbsp;</p>
<p>taking the string of JSON from a text area fiueld , parsing it , then doing 
an alert from the name field of the second item in the children array. In order 
to read a value you use square brackets syntax or you can use dot notation, ex. 
obj.children</p>
<p>children is array, js arrays are zero based, the first item in the array is 0 
the second item is 1. </p>
<p>&nbsp;</p>
<p>Run this component, click parse button , should return &quot;Joan&quot;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON to send Data between a Client and Server">Using JSON to send Data between a Client and Server</a></h1>
<p>&nbsp;</p>
<p>How JSON is useful to parse information between client and server.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Using JSON to send complex data to the server from the client</h2>
<p>UX Component<br>
								<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_5.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_6.swf">
								Watch Video - Part 2</a><br>
								&nbsp;</p>
<p>Continuing video on introduction to JSON. Useful for passing information form 
the client to the server. How do you pass information into an AJAX callback</p>
<p>&nbsp;</p>
<p>New Button Make AJAx callback</p>
<p>&nbsp;</p>
<p>Add Ajax callback click edit in edit click event dialog</p>
<p>in genie you can specify additional data to submit. This data will be 
available inside your custom event handler.</p>
<p>&nbsp;</p>
<p>What is expected is a Query string, name value pairs delimited with an &amp; 
sign, type in a Review help text in Action Javascript Ajax Callback Action</p>
<p>Additional data to submit property</p>
<p>&nbsp;</p>
<p>Save</p>
<p>&nbsp;</p>
<p>new function</p>
<p>&nbsp;</p>
<p>function additionalAjaxData() {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var json = {dialog.object}.getValue('jsonIn');</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //return '__additionalData=' + 
json;</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var data = 
A5.ajax.buildURLParam('__additionalData', json);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return data;</p>
<p>}</p>
<p>&nbsp;</p>
<p>all we are going to do is read the value that is in the text area field and 
send back to the server an name value pair formatted like a query string. the 
important part here is that hte value part of the name value pair needs to be 
URL encoded. Inside the Alpha JS library there is a buildURL function that 
encodes that value.</p>
<p>Additional Ajax data simply does a return</p>
<p>Run case and see how it looks when button is clicked</p>
<p>&nbsp;</p>
<p>Actual Xbasic function that will handel the callback</p>
<p>&nbsp;</p>
<blockquote>
	<p>function xb as c (e as p)</p>
	<p>&nbsp;</p>
	<p>&nbsp;&nbsp;&nbsp; dim json as c</p>
	<p>&nbsp;&nbsp;&nbsp; json = e.__additionalData</p>
	<p>&nbsp;</p>
	<p>&nbsp;&nbsp;&nbsp; dim p as p </p>
	<p>&nbsp;&nbsp;&nbsp; p = json_parse(json)</p>
	<p>&nbsp;&nbsp;&nbsp; dim msg as c</p>
	<p>&nbsp;&nbsp;&nbsp; msg = &quot;Message from Xbasic. The name of the second 
	child is: &quot; + p.children[2].name</p>
	<p>&nbsp;</p>
	<p>&nbsp;&nbsp;&nbsp; dim js as c</p>
	<p>&nbsp;&nbsp;&nbsp; js = &quot;alert('&quot; + js_escape(msg) + &quot;');&quot;</p>
	<p>&nbsp;</p>
	<p>&nbsp;&nbsp;&nbsp; xb = js</p>
	<p>end function</p>
</blockquote>
<p>------------------video 2</p>
<p>&nbsp;</p>
<p>Introduction to JSON. Useful when you want to arbitrary information generated 
on the client side. </p>
<p>&nbsp;</p>
<p>inside this function e there is a property called additional data. This got 
sent back as part of our ajax callback, just a string of data. Now if we look at 
p, see it is an xbasic object. In Xbasic the arrays are 1 based not 0 based, 
unlike js. Now create a javascript response to send back to the client.</p>
<p>&nbsp;</p>
<p>when you return a string, need to make sure it is javascript safe, send the 
following alert message back to the client. </p>
<p>&nbsp;</p>
<p>Took a string of JSON data, sent it back to the server as part of an ajax 
callback, passed the information on the sever using the parse function, 
extracted the name field from the second array item in the childrens array, 
constructed a message from that, and then passed that message back to the 
server.</p>
<p>&nbsp;</p>
<p>Next, using the templating function using JSON data sent from server to the 
client.</p>
<p>&nbsp;</p>
<p>&nbsp;</p><hr color="#000000">
<p>
								<br>
								Using JSON to send complex data from the server 
								to the client<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_7.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_8.swf">
								Watch Video - Part 2</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_9.swf">
								Watch Video - Part 3</a><br>
								<br>
								Advanced example - sending complex data from the 
								server and formatting the data for presentation 
								on the client side using a template<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_10.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_11.swf">
								Watch Video - Part 2</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_12.swf">
								Watch Video - Part 3</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_13.swf">
								Watch Video - Part 4</a><br>
								<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json.zip">
								Download component</a><br>
								<br>
								Date Added: 2014-10-15</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div id="yui_3_16_0_1_1445604035652_6777" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	<hr color="#000000"><br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445604035652_6778" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	- the advantage is alpha five will syntax check the json, and display a red 
	squiggly line under any syntax errors that are encountered</div>
<span style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255);">
&lt;&lt;%json%</span><br style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
&nbsp;<div id="yui_3_16_0_1_1445604035652_6768" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	%json%</div>
<p>&nbsp;</p>
<span style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255);">
Multiple conditions in a freeform report</span><div id="yui_3_16_0_1_1445604035652_7023" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445604035652_7014" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	(A user was having trouble with this)</div>
<div id="yui_3_16_0_1_1445604035652_7017" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	<br>
&nbsp;</div>
<div id="yui_3_16_0_1_1445604035652_7015" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
	I can walk you through the steps when you have time (after the JSON doc is 
	complete) - but add this to your list.</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
		<p>
						<b>Xbasic Code Editors - JSON Strings - Real-time 
						Validation</b> - If you use the specify
						<font color="#0000FF" face="Courier New">&lt;&lt;%json%</font>...
						<font color="#0000FF" face="Courier New">%json%</font> 
						delimiters to enter a long string of JSON data, the 
						Xbasic editor will perform real-time validation on the 
						JSON data.</p>
		<p>
						For example, in the image below, the JSON has an error 
						because of the trailing comma after the last property 
						(age: 23). Notice the squiggly red line indicating the 
						error. If you click on the error indicator you will see 
						the error message.</p>
		<p>
						&nbsp;</p>
		<p>
						<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/jsonvalidator.gif"></p>
<p>&nbsp;</p>
						<table border="1" cellspacing="1" cellpadding="3" id="table88" style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; margin-left: 0.5in; border-collapse: collapse; " width="992">

							
							
							<tr>
								<td width="103" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								UX Component</td>
								<td width="143" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								Intro to JSON</td>
								<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								&nbsp;</td>
							</tr>

							
							
							</table>
		<p class="note">
						<b>NOTE</b>: When you test code in the Javascript editor 
						you are not testing it in the context of the browser. 
						That means you can't test code that assumes that the DOM 
						is present. Also certain Javascript global objects such 
						as window and document are not defined. The alert(), 
						function is also not defined.</p>
		<p>
						The Interactive Window pane in the Javascript editor is 
						shown below. The window is divided into two sections. 
						The top section is the Java




scri
			
			
			pt code that you want to 
						test and the bottom window shows results.</p>
		<p>
						You can print text to the results window by using any of 
						the following functions in your Javascript code:</p>
		<p>
						&nbsp;</p>
		<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><font color="#0000FF" face="Courier New">console.log('text to 
			log')</font> - prints text and follows text with a line break</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><font color="#0000FF" face="Courier New">print('text to print')</font> 
			- prints text but does not follow text with a line break</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><font color="#0000FF" face="Courier New">printJSON(objectToPrint)
			</font>- emits nicely formatted JSON</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><font color="#0000FF" face="Courier New">
			printJSONCompact(objectToPrint)</font> - emits the JSON in a single 
			line</li>
		</ul>
		<p class="note">
						<b>NOTE</b>: When you are done testing your Javascript, 
						be sure to remove or comment out any print(), printJSON() 
						or printJSONCompact() functions in your code as these 
						functions only are defined in the context of the 
						Javascript editor.</p>
		<p>
						&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/js_interactivewindow.jpg"></p>
		<p>
						&nbsp;</p>
		<p>
						<a href="http://www.ajaxvideotutorials.com/V12Videos/js_mdi_editor_interactiveWindow.swf">
						Watch Video</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>When you specify a custom data source the following dialog appears:</p>
<p>&nbsp;</p>
<p>
<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/reports_custom2.jpg"></p>
<p>&nbsp;</p>
<p>You specify the name of an Xbasic function that will return the data to be 
printed by the report.</p>
<p>The Xbasic function can return data in one of two formats:</p>
<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	Delimited</li>
	<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	JSON</li>
</ul>
<p>In both cases, the Xbasic function returns a string of data (that is either 
in delimited or JSON format - explained below).</p>
<p>The function prototype for the Xbasic function is (assuming you specified 
that the Function name was <font color="#0000FF" face="Courier New">
myDataFunction</font> in the <font color="#0000FF" face="Courier New">Function 
name</font> property in image shown above):</p>
<p>&nbsp;</p>
<p class="xbasic">function myDataFunction as c (e as p)</p>
<p class="xbasic">myDataFunction = &lt;&lt;%txt%</p>
<p class="xbasic">......the delimited, or JSON format data goes here</p>
<p class="xbasic">%txt%</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">end function </p>
<p>&nbsp;</p>
<p>Notice that the function takes a single input parameter,
<font color="#0000FF" face="Courier New">e</font>.</p>
<p>The <font color="#0000FF" face="Courier New">e</font> object that is passed 
into the function includes the value of any arguments that were passed into the 
report.</p>
<p>For example, assume that you specified that the Custom Data Source uses an 
argument called <font color="#0000FF" face="Courier New">whatCountry</font>. 
Your Xbasic function can reference the value in this argument as follows:</p>
<p class="xbasicSmall">dim country as c </p>
<p class="xbasicSmall">country = argVal(e.arguments,&quot;whatCountry&quot;)</p>
<p>&nbsp;</p>
<p><b>Understanding the Format of the JSON Data Your Custom Function Must Return</b></p>
<p>&nbsp;</p>
<p>The JSON data that your function returns can be <span class="xbasicSmallSpan">Simple</span> or <span class="xbasicSmallSpan">Complex</span>.</p>

<p><b>Simple JSON</b></p>
<p>For Simple JSON, the string that you return is just an <span class="xbasicSmallSpan">array</span> of JSON objects, For example:</p>

<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
[
	{"Firstname" : "Fred", "Lastname" : "Smith"},
	{"Firstname" : "Harry", "Lastname" : "Jones"}
]
%json%
end function 
</pre>

<p>&nbsp;</p>
<p>In this case since no schema is supplied the data are all considered to be character type of length 1024 characters. While the advantage of this format is
that is extremely simple, it does mean that you will need to adjust the size of each field you place on your report because its default size will likely be too large.</p>



<p><b>Complex JSON</b></p>
<p>For Complex JSON, the string that you return is an <span class="xbasicSmallSpan">object</span> with two properties, <span class="xbasicSmallSpan">schema</span>
and <span class="xbasicSmallSpan">data</span>. The <span class="xbasicSmallSpan">schema</span> object defines the schema of the data (for example, field type, size, etc.)
and the <span class="xbasicSmallSpan">data</span> property is an array of JSON objects that define the data for the report. For example:</p>

<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
	"schema" : { "firstname" : { "type" : "C" , "width": 30 } 
	           , "lastname" : { "type" : "C"  , "width": 30} 
	           , "company" : { "type" : "C"  , "width": 30} 
	           , "age" : { "type" : "N" , "width" : 3, "decimal" : 0 }
	},
	"data": 
		[
			{"firstname":"Fred", "lastname":"Smith", "company" : "Alpha Software", "age" : 30},
			{"firstname":"John", "lastname":"Jones", "company" : "Beta Software", "age" : 23}
		]
}
%json%
end function 
</pre>
<p>&nbsp;</p>
<p>In the above example, we have specified the size and type of each field in the <span class="xbasicSmallSpan">data</span> array. Notice that we have also specified the number of decimal places
for the numeric field.</p>

<p>The data types supported in the schema are: </p>

<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">C - Character (you must also specify a "width" property for this type)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">N - Numeric (you must also specify a "width" and "decimal" property for this type)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">L - logical</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">M - memo</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">D - date</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">T - date/time</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">Y - short time</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">E - exponent numeric</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">K - guid</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">JPEG - Jpeg field (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">PNG - PNG (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">BMP - BMP (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">I - Image Reference Field (data in the data property is a image file name but the report will treat the data as an image).</li>
</ul>


<p class="note"><b>Note</b>: If you specify that a field uses the Date (D), 
Date/Time (T) or Short time (Y) format in the schema, the data in the data array 
must be a string in UTC date format. For example: 2014-10-27T23:06:50.361Z. The 
date part format is yyyy-mm-dd and the time part uses GMT. In the case of a 
Short time field, the date portion of the UTC date string is ignored.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The schema also allows you to extract data from objects within each row and to map property names in the <span class="xbasicSmallSpan">data</span> array to different names. 
For example in the data shown below, the address property is an object with two sub-properties. 
</p>

<pre class="xbasicSmall" xtag="">
{
   "name": "Fred Smith",
   "company" : "XYZ Corp",
   "address": {
       "street": "Main Street",
       "number": 23
    }
}
</pre>

<p>&nbsp;</p>
<p>Shown below is how the function would be defined to return the JSON data. Notice that the JSON object has both a <span class="xbasicSmallSpan">schema</span>
and a <span class="xbasicSmallSpan">data</span> property. The schema indicates what fields will be available to the report. 
The list of fields specified by the schema are:
<span class="xbasicSmallSpan">name</span>, <span class="xbasicSmallSpan">companyName</span>, <span class="xbasicSmallSpan">street</span> and <span class="xbasicSmallSpan">number</span>. 
</p>
<p>Notice that the <span class="xbasicSmallSpan">data</span>
array does not have a property called <span class="xbasicSmallSpan">companyName</span>. It has a property called <span class="xbasicSmallSpan">company</span>. So the <span class="xbasicSmallSpan">schema</span>
property for the <span class="xbasicSmallSpan">companyName</span> field indicates that the <span class="xbasicSmallSpan">source</span> of this field is the <span class="xbasicSmallSpan">company</span>
property in the <span class="xbasicSmallSpan">data</span> array. Similarly, the <span class="xbasicSmallSpan">street</span> field in the <span class="xbasicSmallSpan">schema</span> is mapped to the 
<span class="xbasicSmallSpan">address.street</span> property in the <span class="xbasicSmallSpan">data</span> array.</p>

<p>If the definition for a field in the <span class="xbasicSmallSpan">schema</span> omits the <span class="xbasicSmallSpan">source</span> property, then the <span class="xbasicSmallSpan">source</span>
is the same as the item name. For example the definition for the <span class="xbasicSmallSpan">name</span> field in the schema shown below does not have a <span class="xbasicSmallSpan">source</span>
property, therefore this field is mapped to the <span class="xbasicSmallSpan">name</span> property in the <span class="xbasicSmallSpan">data</span> array.</p>





<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
    "schema": {
        "name": {
            "type": "c",
            "width": 30
        },
        "companyName: {
        	"source": "company",
        	"type" : "c",
        	"width" : 30
        },
        
        "street": {
            "source": "address.street",
            "type": "c",
            "width": 40
        },
        "number": {
            "source": "address.number",
            "type": "n",
            "width": 5,
            "decimal": 0
        }
    },
    "data": [
        {
            "name": "Fred Smith",
            "company" : "XYZ Corp",
            "address": {
                "street": "Main Street",
                "number": 23
            }
        },
        {
            "name": "John Jones",
            "company" : "ABC Corp",
            "address": {
                "street": "Corner Road",
                "number": 3
            }
        }
    ]
}
%json%
end function 
</pre>

<p>&nbsp;</p>
<p>In the next example, we show how the JSON object that you specify can include image data. The binary data for the image are encoded as base64 strings. 
The example shows the complete function definition. Notice that the schema indicates that the <span class="xbasicSmallSpan">image</span> field will be stored as a 
<span class="xbasicSmallSpan">PNG</span>. Notice also that in the first record, the base64 encoded data in the <span class="xbasicSmallSpan">image</span> property does <b>not</b> include the 
MIME type at the start of the base64 encoded data. This data is therefore presumed to be a 
<span class="xbasicSmallSpan">PNG</span> image since the <span class="xbasicSmallSpan">schema</span> indicates that the image is 
a <span class="xbasicSmallSpan">PNG</span> type. Notice however, that the second row of data in the <span class="xbasicSmallSpan">data</span> array has a MIME type prefix on the base64 encoded image data. The data
for the image is for a <span class="xbasicSmallSpan">BMP</span> image. The image will therefore be converted from 
<span class="xbasicSmallSpan">BMP</span> to <span class="xbasicSmallSpan">PNG</span> automatically.</p>
 </p>

<pre class="xbasicSmall">

function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
   "schema" : {
      "name" : { "type" : "C" , "width": 30 }, 
      "image" : { "type" : "Png" }
	},
	"data": 
       [
          {"name":"John Smith", "image" : "iVBORw...(data truncated for readability)....AAAElFTkSuQmCC" },
          {"name":"Jane Smith", "image" : "data:image/bmp;base64,Qk02AwAAA...(data truncated for readability)....AAAADYAAAAAA=="}
       ]
}
%json%	
end function
</pre>




<p>
						&nbsp;</p>
						<table border="1" cellspacing="1" cellpadding="3" id="table84" style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; margin-left: 0.5in; border-collapse: collapse; " width="992">

							
							
							<tr>
								<td width="160" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								UX Component - List Control</td>
								<td width="201" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								Displaying Data From Twitter</td>
								<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								The Twitter API returns data in JSON format. The 
								List control on a UX component is easily 
								populated with JSON data. The Twitter API, 
								however, is a little tricky to work with because 
								it requires an OAuth authorization before you 
								can call the API functions. Xbasic contains two 
								built-in functions that simplify this.<br>
								<br>
								In this example we show how you can easily build 
								a List control that displays Tweets that are 
								retrieved by making a REST API call to Twitter.
								<br>
								<br>
								In the example we use built-in Xbasic functions 
								to get a 'bearer token' from Twitter. Once we 
								have this token, we can make calls to the 
								Twitter API to get data in a JSON format that is 
								used to populate the List control.<br>
								<br>
								<b>IMPORTANT</b>: The video shows selecting the 
								Twitter List from the 'Defined Controls' section 
								of the UX builder toolbox. This has been 
								changed. You should now select the 'Twitter_Display_Tweets_in_a_List_Control' 
								sample UX Component template in the dialog that 
								appears when you create a new UX component.<br>
								<br>
								<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part1.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part2.swf">
								Watch Video - Part 2</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part3.swf">
								Watch Video - Part 3</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part4.swf">
								Watch Video - Part 4</a></td>
							</tr>

							
							
							</table>
		<p>
						<b>Client-Side Template Tester - User Interface 
						Improvements - </b>The user interface in the client-side 
						template tester window has been enhanced. The window is 
						now resizable and has separate tabs for JSON Data, 
						Template, Javascript and CSS.</p>
		<p>
						As you edit in any of these windows the template preview 
						is automatically updated in the right part of the 
						window.</p>
		<p>
						&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/client-side_template_window_resizeable.jpg"></p>
		<table border="1" cellspacing="1" cellpadding="3" id="table76" style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; margin-left: 0.5in; border-collapse: collapse; " width="1092">

							
							
							<tr>
								<td width="173" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								Code Editor</td>
								<td width="204" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								Highlighting Opening and Closing 'Pair' 
								Delimiters</td>
								<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								When editing Xbasic or Javascript code, html, 
								JSON etc. it is often helpful to be able to see 
								the start and end of different 'pairs'. For 
								example in an Xbasic function call, highlighting 
								the opening an closing parentheses. Or in a 
								Javascript function, highlighting the opening 
								and closing curly braces. In some HTML text, the 
								opening and closing tags (e.g. &lt;div&gt;, &lt;body&gt;, 
								&lt;p&gt; , etc.)<br>
								<br>
								In addition, once a 'pair' has been identified, 
								keyboard shortcuts (Control&nbsp; ] and 
								Control-Shift ] )&nbsp; allow you to quickly 
								move focus from the start of the 'pair' to the 
								end of the 'pair' or to select all of the text 
								inside the 'pair'.<br>
								<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/code_editor_highlighting_pairs.swf">
								Watch Video</a></td>
							</tr>

							
							
							</table>
		<p>&nbsp;</p>
<p>&nbsp;</p>
		<p>
						<b>AlphaDAO - ResultSet - Generating JSON Data - .ToJSONObjectSyntax() 
						Method</b> - When you use the .ToJSONObjectSyntax() 
						method to generate JSON data from a resultset, and you 
						set the optional ConvertToText flag to .f. (it defaults 
						to .t.), then date and date time values in the resultset 
						now create Javascript date objects. For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						dim cn as sql::Connection<br>
						cn.open(&quot;::Name::_northwind&quot;)<br>
						<br>
						cn.PortableSQLEnabled = .t.<br>
						cn.Execute(&quot;select first 5 orderid, orderdate from 
						orders&quot;) </p>
		<p class="xbasic">
						rs = cn.ResultSet<br>
						<br>
						?rs.ToJSONObjectSyntax(-1,-1,.f.,.f.)<br>
						= {&quot;orderid&quot; : 10255, &quot;orderdate&quot; : new Date(1952, 11, 
						18, 0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10249, &quot;orderdate&quot; : new Date(1996, 6, 5, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10250, &quot;orderdate&quot; : new Date(1996, 6, 8, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10251, &quot;orderdate&quot; : new Date(1996, 6, 8, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10252, &quot;orderdate&quot; : new Date(1996, 6, 9, 
						0, 0, 0, 0)}<br>
						<br>
&nbsp;</p>
		<p>&nbsp;</p>
		<p>
						<b>UX Component - Server Side Event Handlers - Data 
						Submitted&nbsp; - JSON</b> - When the UX makes any type 
						of Ajax callback, the data that are submitted (including 
						data in Repeating Sections) are now available in a 
						convenient new property called</p>
		<p class="xbasic">
						e.dataSubmittedJSON</p>
		<p>
						&nbsp;</p>
		<p>
						For example, assume your UX had the following controls:</p>
		<p>
						Firstname, Lastname and a Repeating Section called 
						'CONTAINER_1' with AddressType and Address.</p>
		<p>
						The e.dataSubmittedJSON value might look like this:</p>
		<p class="xbasic">
						{ </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; FIRSTNAME: 'Fred',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; LASTNAME: 'Smith',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; CONTAINER_1: [</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESSTYPE: 'Work',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESS: '123 Main St'</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESSTYPE: 'Home',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESS: '456 Center St'</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; ]</p>
		<p class="xbasic">
						}</p>
		<p>
						You can use the Xbasic JSON_Parse() function to parse 
						this JSON string.</p>
		<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr color="#000000">
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">

<h1 align="center"><a name="JSON Functions"><font size="6">JSON</font><font size="6"> Functions</font></a></h1>

</p>
<h3 class="showhide_heading" id="Syntax">&nbsp;</h3>



<h1><a name="a5_compact_json()">a5_compact_json()</a></h1>
<p>&nbsp;</p>
a5_compact_json(c jsondata [,l flagcompact [,l flagusequotes ]])

<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><br>
<h1><a name="a5_expand_json()">a5_expand_json()</a></h1>

a5_expand_json(c jsondata ,c map )
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>

<h1><a name="a5_json_extractvalues()">a5_json_extractvalues()</a></h1>
a5_json_extractvalues()<h3 class="showhide_heading">Syntax</h3>
C <span style="color:#090; background:"><em>Result </em></span>=  a5_JSON_extractValues(C <span style="color:#090; background:"><em>txt </em></span>)<br />
<br />
<table class="normal" id="fancytable_1">
	
		<tr>
			<td class="odd"><strong>Argument</strong> </td>
			<td class="odd"> <strong>Description</strong></td>
		</tr>
		<tr>
			<td class="even">C <span style="color:#060; background:"><em>Result</em></span> </td>
			<td class="even"> String containg name:value pairs</td>
		</tr>
		<tr>
			<td class="odd">C <span style="color:#060; background:"><em>txt</em></span> </td>
			<td class="odd"> JSON expression to parse</td>
		</tr>
</table><br />
<h3 class="showhide_heading" id="Description">Description</h3>
Extracts name/value pairs from a JSON string.<br />

<h3 class="showhide_heading" id="Limitations">Limitations</h3>
<h3 class="showhide_heading" id="Examples">Examples</h3>
This example demonstrates parsing a relatively simple JSON string with two small twists: it contains a quoted string, and there is a comma inside the quoted string.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >?a5_JSON_extractValues(&#34;{name:Fred, city: Boston, address: \&#34;123 Main St, Suite 23\&#34;, state: MA}&#34;)
= name:Fred
city: Boston
address: &#34;123 Main St, Suite 23&#34;
state: MA</pre></div><br />
<br />
This real-life example parses a JSON string returned by the Twitter API.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox1" >c = &lt;&lt;%txt%
#{"completed_in":0.014,"max_id":157517767036248066,"max_id_str":"157517767036248066",
"next_page":"?page=2&max_id=157517767036248066&q=Red%20Sox&rpp=2","page":1,"query":"Red+Sox",
"refresh_url":"?since_id=157517767036248066&q=Red%20Sox",
"results":[{"created_at":"Thu, 12 Jan 2012 17:42:16 +0000",
"from_user":"Liliancje","from_user_id":453416927,"from_user_id_str":"453416927",
"from_user_name":"Lilian Clum","geo":null,"id":157517767036248066,
"id_str":"157517767036248066","iso_language_code":"en","metadata":{"result_type":"recent"},
"profile_image_url":"http://a0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg",
"profile_image_url_https":"https://si0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg",
"source":"&lt;a href="http://twitterfeed.com" rel="nofollow"&gt;twitterfeed&lt;/a&gt;",
"text":"JASON VARITEK Boston Red Sox Majestic AUTHENTIC Home Baseball Jersey, 44/LARGE: Same Style Authentic On-Field Je... http://t.co/MR8spX5g",
"to_user":null,"to_user_id":null,"to_user_id_str":null,"to_user_name":null},
{"created_at":"Thu, 12 Jan 2012 17:41:56 +0000",
"from_user":"BR_BOSRedSox","from_user_id":15908353,"from_user_id_str":"15908353",
"from_user_name":"Boston Red Sox","geo":null,"id":157517679777951744,
"id_str":"157517679777951744","iso_language_code":"en","metadata":{"result_type":"recent"},
"profile_image_url":"http://a3.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg",
"profile_image_url_https":"https://si0.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg",
"source":"&lt;a href="http://twitterfeed.com" rel="nofollow"&gt;twitterfeed&lt;/a&gt;",
"text":"http://t.co/B4SxnH3d - Boston Red Sox Headlines - Red Sox Mailbag: Boston In No Rush to Sign Jacoby Ellsbury to L... http://t.co/1oWDduRM",
"to_user":null,"to_user_id":null,"to_user_id_str":null,"to_user_name":null}],
"results_per_page":2,"since_id":0,"since_id_str":"0"}%txt%

? a5_json_extractvalues(c)
= completed_in:0.014
max_id:157517767036248066
max_id_str:157517767036248066
next_page:?page=2&max_id=157517767036248066&q=Red%20Sox&rpp=2
page:1
query:Red+Sox
refresh_url:?since_id=157517767036248066&q=Red%20Sox
results:created_at:Thu, 12 Jan 2012 17:42:16 +0000
from_user:Liliancje
from_user_id:453416927
from_user_id_str:453416927
from_user_name:Lilian Clum
geo:null
id:157517767036248066
id_str:157517767036248066
iso_language_code:en
metadata:result_type:recent
profile_image_url:http://a0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg
profile_image_url_https:https://si0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg
source:&lt;a href="http://twitterfeed.com" rel="nofollow"&gt;twitterfeed&lt;/a&gt;
text:JASON VARITEK Boston Red Sox Majestic AUTHENTIC Home Baseball Jersey, 44/LARGE: Same Style Authentic On-Field Je... http://t.co/MR8spX5g
to_user:null
to_user_id:null
to_user_id_str:null
to_user_name:null
created_at:Thu, 12 Jan 2012 17:41:56 +0000
from_user:BR_BOSRedSox
from_user_id:15908353
from_user_id_str:15908353
from_user_name:Boston Red Sox
geo:null
id:157517679777951744
id_str:157517679777951744
iso_language_code:en
metadata:result_type:recent
profile_image_url:http://a3.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg
profile_image_url_https:https://si0.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg
source:&lt;a href="http://twitterfeed.com" rel="nofollow"&gt;twitterfeed&lt;/a&gt;
text:http://t.co/B4SxnH3d - Boston Red Sox Headlines - Red Sox Mailbag: Boston In No Rush to Sign Jacoby Ellsbury to L... http://t.co/1oWDduRM
to_user:null
to_user_id:null
to_user_id_str:null
to_user_name:null
results_per_page:2
since_id:0
since_id_str:0</pre></div>
<p>&nbsp;</p>


<h1><a name="a5_json_populatearray()">a5_json_populatearray()</a></h1>
a5_json_populatearray(p arr ,c txt )

<p>&nbsp;</p>

<h1><a name="a5_json_prep()">a5_json_prep()</a></h1>
<p>&nbsp;</p>

a5_json_prep(p p )

<p>&nbsp;</p>

<h1><a name="a5_makejsontree()">a5_makejsontree()</a></h1>
<p>&nbsp;</p>
a5_makejsontree(p treein [,* opsin ])

<p>&nbsp;</p>

<h1><a name="a5_merge_json_into_template()">a5_merge_json_into_template()</a></h1>
a5_merge_json_into_template(c jsondata ,c template [,c javascriptfunctions [,c partialtemplatesjson [,c localcss [,l flagusev8 ]]]])

<p>a5_merge_JSON_into_template() Function - Application Server - The 
a5_merge_JSON_into_template() function did not work when called from Xbasic code 
running in the Application Server. It only worked in the Development Server.</p>
<h1>&nbsp;</h1>
		<p>
						<b>Template Tester - Tools Menu</b> - The Template 
						Tester can now be opened directly from the Tools menu 
						when the Web Control Panel has focus.</p>
		<p>
						The Template Tester is useful when you are constructing 
						templates that generate HTML by expanding data in an 
						object. See 'Client-side Templates' in the Release Notes 
						for information on templates.</p>
		<p class="note">
						<b>NOTE</b>: While templates are documented in a section 
						called 'Client-side Templates' this is somewhat 
						misleading because you can also use templates in 
						server-side code using the a5_merge_JSON_into_template() 
						Xbasic function.</p>
		<h1>&nbsp;</h1>
<p><b>Using Client-side Templates on the Server-side - 
a5_merge_JSON_into_template() Function</b> -&nbsp; Because Alpha Anywhere has 
the ability to execute Javascript from an Xbasic script, you can actually use 
client-side templates in Xbasic using the a5_merge_JSON_into_template() 
function.</p>
<p>The syntax for the function is:</p>
<p class="xbasic">c <i>Result</i> = a5_merge_JSON_into_template(C <i>jsonData</i> 
,C <i>template</i> [,C <i>javascriptFunctions</i> [,C <i>partialTemplatesJSON</i> 
[,C <i>localCSS</i> ]]])<br>
&nbsp;</p>
<p>For example:</p>
<p>&nbsp;</p>
<p class="xbasic">dim data as c <br>
data = &lt;&lt;%txt%<br>
{firstname: 'Fred', lastname: 'Jones'}<br>
%txt%<br>
<br>
template = &lt;&lt;%html%<br>
Name: {firstname} {lastname}<br>
%html%<br>
<br>
htmlOut = a5_merge_JSON_into_template(data,template)<br>
<br>
showvar(htmlOut)<br>
&nbsp;</p>
<p>&nbsp;</p>
<h1>&nbsp;</h1>



<h1><a name="a5_sql_nested_query_to_json_document()">a5_sql_nested_query_to_json_document()</a></h1>
a5_sql_nested_query_to_json_document(p ops ,p args [,c mode ])
<p>&nbsp;</p>
		<p>
						<b>a5_sql_nested_query_to_json_document() Function</b> - 
						Queries one or more SQL databases and returns a JSON 
						document with the query result.</p>
		<p>
						This function is inspired by NoSQL databases that return 
						a JSON document with a query result. The JSON document 
						return by such a query often contains nested JSON 
						documents (for example for each customer, show orders 
						for that customer, and for each order, show order 
						details for that order).</p>
		<p>
						For example, here is a sample JSON document returned by 
						this function showing customers, nested orders, and 
						nested order details:</p>
		<p class="xbasicSmall">
						
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerId": "HUNGO",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"companyName": "Hungry Owl All-Night Grocers",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderid": "10298",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerid": "HUNGO",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"value": "10298",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderDetails": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10298",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ProductID": "2",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"UnitPrice": "15.2",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Quantity": "40",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Discount": "0"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderid": "10309",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerid": "HUNGO",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"value": "10309",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderDetails": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10309",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ProductID": "4",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"UnitPrice": "17.6",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Quantity": "20",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Discount": "0"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p>
		<p class="xbasicSmall">
						
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
truncated for brevity....<br>
&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						The syntax for the function is</p>
		<p>
						P <i>result</i> = a5_sql_nested_query_to_json_document( 
						P <i>options</i>, SQL::Arguments <i>Args</i>)</p>
		<p>
						&nbsp;</p>
		<p>
						The <i>result</i> object that is returned has these 
						properties</p>
		<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>hasError</i> - .t. or .f. depending on whether the function 
			returns an error.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>errorText</i> - the error text if hasError is .t.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>data</i> - the JSON data returned by the function</li>
		</ul>
		<p>
						&nbsp;</p>
		<p>
						The options object that is passed into the function has 
						these properties:</p>
		<p>
						&nbsp;</p>
		<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>options.connectionString</i> - The connection string for the 
			query. This is an optional property. You can also specify a query 
			string to use for each nested query. If you do not specify <i>
			options.connectionString</i>, then you MUST specify a connection 
			string for each query. Typically, you will querying against a single 
			database, and so it is most efficient to specify the <i>
			options.connectionString</i> parameter and NOT specify a connection 
			string for each SQL statement.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>options.SQL</i> - a CRLF delimited list of SQL statements to 
			execute. The indentation in the parameter indicates the hierarchy of 
			the query. See below for more details.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>options.flagUseSubSelects</i>&nbsp; - Indicates if child SQL 
			queries use a SQL Sub-select in the WHERE clause. If you are querying 
			against a single database then this is the most efficient option. If 
			each query specifies its own connection string, then this flag must 
			be set to .f.. 
			</li>
		</ul>
		<p>&nbsp;</p>
		<p>Example <i>options.SQL</i> parameter:</p>
		<p>&nbsp;</p>
		<p class="xbasic"><font size="2">options.sql = 
		&lt;&lt;%txt%<br>
		{sql: 'select * from customers where country = :whatCountry ', name: 
		'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql:'select * from orders', name: 'orders', parentKey: 'cId', 
		key: 'cId'}<br>
		%txt%</font><br>
&nbsp;</p>
		<p>
						Notice that the<i> options.sql </i>property is a CRLF 
						delimited string of JSON strings in this format:</p>
		<p class="xbasic">
						options.SQL = &lt;&lt;%txt%</p>
		<p class="xbasic">
						{JSON string 1}</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; {JSON string2}</p>
		<p class="xbasic">
						%txt%</p>
		<p>
						&nbsp;</p>
		<p>
						The fact that {JSON string 2} is indented (using a 
						single Tab character NOT spaces) is significant. The 
						indentation indicates that this query is an immediate child of the 
						query in the line above it.</p>
		<p>
						You can have multiple levels of indentation. and 
						multiple queries with the same parent, for 
						example:</p>
		<p class="xbasic">
						options.SQL = &lt;&lt;%txt%</p>
		<p class="xbasic">
						{JSON string 1}</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; {JSON string2}</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {JSON string 
						3}</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; {JSON string 4}</p>
		<p class="xbasic">
						%txt%</p>
		<p>
						&nbsp;</p>
		<p>
						In the above example, the SQL query defined by {JSON 
						string 3} is a child of {JSON string2}. The query 
						defined by {JSON string 1} has two child queries. A real 
						world example of an hierarchy that would be defined 
						using the above structure might be:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						Customers</p>
		<p class="xbasic">
						`&nbsp;&nbsp;&nbsp; Orders</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						OrderDetails</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; Payments</p>
		<p>
						&nbsp;</p>
		<p>
						The individual JSON strings each have these properties</p>
		<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>sql</i> - The actual SQL statement to execute</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>name</i> - An arbitrary name. Must be unique. This name is 
			used for the child records in the JSON document that is returned.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>parentKey&nbsp; - </i>Only required for child queries. 
			Defines the field in the child SQL statement that joins the child 
			query with the parent query.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>key - </i>Only required for child queries. Defines the field 
			in the child's parent SQL query that joins the child query with the 
			parent query.</li>
		</ul>
		<p>&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						Example 1 - Simple two level query</p>
		<p class="xbasicSmall">
						dim ops as p<br>
						ops.connectionString = &quot;::Name::northwind&quot;<br>
						ops.sql = &lt;&lt;%txt%<br>
						{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId'}<br>
						%txt%<br>
						dim args as sql::Arguments<br>
						args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>
						p = a5_sql_nested_query_to_json_document(ops,args)<br>
						?p.data</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;=

{<br>
&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CompanyName": "Blondesddsl pre et fils",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactName": "Frdrique Citeaux",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactTitle": "Marketing Manager",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Address": "24, place Klber",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"City": "Strasbourg",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Region": null,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"PostalCode": "67000",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Country": "France",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Phone": "88.60.15.31",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Fax": "88.60.15.32",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"image": null,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"imageThumb": null,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10265",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "2",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "07/25/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RequiredDate": "08/22/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShippedDate": "08/12/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "1",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "55.28",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipName": "Blondel pre et fils",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipAddress": "24, place Klber",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipCity": "Strasbourg",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipRegion": null,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipPostalCode": "67000",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipCountry": "France"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10297",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "5",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "09/04/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RequiredDate": "10/16/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShippedDate": "09/10/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "2",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "5.74",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipName": "Blondel pre et fils",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipAddress": "24, place Klber",</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						truncated for brevity......<br>
						
						
						
						</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p class="xbasicSmall">
						<br>
						&nbsp;</p>
		<p>
						Example 2 - Simple three level query</p>
		<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						<br>
						dim ops as p<br>
						ops.connectionString = &quot;::Name::northwind&quot;<br>
						ops.sql = &lt;&lt;%txt%<br>
						{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' }<br>
						&nbsp;&nbsp;&nbsp;
						{sql: 'select * from orders', name: 'orders', parentKey: 
						'customerid', key: 'customerId'}<br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						{sql: 'select * from [order details]', name: 'orderDetails', 
						parentKey: 'orderId', key: 'orderId'}<br>
						%txt%</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						<br>
						dim args as sql::Arguments<br>
						args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>
						p = a5_sql_nested_query_to_json_document(ops,args)<br>
						&nbsp;</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						<br>
						<br>
						&nbsp;</p>
		<p>
						Example 3 - Three level query where each query is in a 
						different database (the connection string is specified 
						for each query). </p>
		<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						<br>
						'since each query specifies its own connection string, 
						the flagUseSubSelects flag must </p>
<p class="xbasicSmall">
						'be set to .f.</p>
<p class="xbasicSmall">
						<br>
						ops.flagUseSubSelects = .f.<br>
						ops.sql = &lt;&lt;%txt%<br>
						{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' , connectionString: 
						'::Name::northwind'}<br>
						&nbsp;&nbsp;&nbsp;
						{sql: 'select * from orders', name: 'orders', parentKey: 
						'customerid', key: 'customerId', connectionString: 
						'::Name::northwind2'}<br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						{sql: 'select * from [order details]', name: 'orderDetails', 
						parentKey: 'orderId', key: 'orderId' , connectionString: 
						'::Name::northwind2'}<br>
						%txt%<br>
						dim args as sql::Arguments<br>
						args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>
						p = a5_sql_nested_query_to_json_document(ops,args)<br>
						<br>
						<br>
						&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p>
						<b>Limiting the Number of Child Records</b></p>
		<p>
						If you want to limit the number of records retrieved at 
						any level in the hierarchy, you can.</p>
		<p>
						To limit the number of records at the top level of the 
						hierarchy, you would simply use the FIRST clause in your 
						SQL select statement. However, for child queries, using 
						the FIRST clause in the SQL will not work (because you 
						want the FIRST n records within <b>EACH</b> parent 
						group, not the FIRST n records in <b>ALL</b> parent 
						groups).</p>
		<p>
						To limit the number of records in a child query, you use 
						the 'limit' property in the JSON object that defines the 
						query.</p>
		<p>
						For example in the code shown below we are fetching the 
						first 5 orders for each customer:</p>
		<p>
						&nbsp;</p>
		<p class="xbasicSmall">
						dim ops as p<br>
						ops.connectionString = &quot;::Name::northwind&quot;<br>
						ops.sql = &lt;&lt;%txt%<br>
						{sql: 'select * from customers', name: 'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId', limit: 5}<br>
						%txt%<br>
&nbsp;</p>
		<p class="xbasicSmall">&nbsp;</p>
		<p><b>NOTE</b>: If you do use a FIRST clause in a child SQL statement, 
		the SQL statement is automatically parsed and the FIRST clause is 
		removed and converted into a 'limit' property in the JSON definition. 
		So, the following two objects are actually equivalent:</p>
		<p>&nbsp;</p>
		<p class="xbasicSmall">dim ops as p<br>
		ops.connectionString = &quot;::Name::northwind&quot;<br>
		ops.sql = &lt;&lt;%txt%<br>
		{sql: 'select * from customers', name: 'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
		key: 'customerId', limit: 5}<br>
		%txt%<br>
&nbsp;</p>
		<p>&nbsp;</p>
		<p class="xbasicSmall">dim ops as p<br>
		ops.connectionString = &quot;::Name::northwind&quot;<br>
		ops.sql = &lt;&lt;%txt%<br>
		{sql: 'select * from customers', name: 'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql: 'select <font color="#FF0000">FIRST 5</font> * from 
		orders', name: 'orders', parentKey: 'customerid', key: 'customerId'}<br>
		%txt%<br>
&nbsp;</p>
		<p class="xbasicSmall">&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						<b>Eliminating Key Values</b></p>
		<p>
						By default, the JSON that is created shows the parent 
						key value in the child data. For example in the example 
						JSON shown below (which shows a customer, and all of 
						their orders), the 'CustomerID' property is shown n each 
						item in the 'orders' array. This is really not 
						necessary.</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;=

{<br>
&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">"CustomerID": "BLONP",</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CompanyName": "Blondesddsl pre et fils",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactName": "Frdrique Citeaux",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10265",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">"CustomerID": "BLONP",</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "2",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "07/25/1996 12:00:00 00 am",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "1",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "55.28",<br>
&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p>
						In order to suppress parent key values in child records, 
						you can set the 'sparse' property to .t. in the object 
						you pass into the a5_sql_nested_query_to_json_document() 
						function. For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasicSmall">
						dim ops as p</p>
		<p class="xbasicSmall">
						<font color="#FF0000">ops.sparse = .t.<br>
						</font>ops.connectionString = &quot;::Name::northwind&quot;<br>
						ops.sql = &lt;&lt;%txt%<br>
						{sql: 'select * from customers', name: 'customer' }<br>
&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId', limit: 5}<br>
						%txt%<br>
&nbsp;</p>
		<p>
						&nbsp;</p>
		<p>
						<b>Preserving Data Types in the JSON </b></p>
		<p>
						You can use the <i>convertToText</i> property in the 
						options that you pass in to control whether the 
						generated JSON converts all data to strings, or 
						preserves data types.</p>
		<p>
						For exmaple:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						ops.convertToText = .f.<br>
						p = a5_sql_nested_query_to_json_document(ops,args)</p>
		<p class="xbasic">
						&nbsp;</p>
		<p>
						would result in JSON that looked like this:</p>
		<p>
						&nbsp;</p>
		<p class="xbasicSmall">
						&nbsp;&quot;customer&quot;: [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;customerId&quot;: &quot;GREAL&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;companyName&quot;: &quot;Great Lakes Food Market&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orders&quot;: [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orderid&quot;: 10528,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orderdate&quot;: new Date(1997,05,06,00,00,0),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;value&quot;: 10528,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						........</p>
		<p>
						&nbsp;</p>
		<p>
						Notice that the 'orderDate, orderId, and value 
						properties are typed.</p>
<h1>&nbsp;</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
		<p>
						<b>a5_sql_schema_to_json() Function</b> - Takes a schema 
						of a SQL database and generates a JSON representation of 
						the schema showing all tables in the database, and their 
						relationships.</p>
		<p>
						&nbsp;</p>
		<p>
						Example:</p>
		<p>
						&nbsp;</p>
		<p>
						Type the following commands in the Interactive window:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						dim cn as sql::Connection</p>
		<p class="xbasic">
						?cn.Open(&quot;::Name::northwind&quot;)</p>
		<p class="xbasic">
						= .T.<br>
						dim sn as sql::Schema</p>
		<p class="xbasic">
						?cn.GetSchema(sn)</p>
		<p class="xbasic">
						= .T.</p>
		<p class="xbasic">
						dim jsonSchema as c </p>
		<p class="xbasic">
						jsonSchema = a5_sql_schema_to_json(sn,{ 
						show_field_type_info : true }) </p>
		<p class="xbasic">
						showvar( jsonSchema)<br>
&nbsp;</p>
		<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="a5_url_from_storagejsonformat()">a5_url_from_storagejsonformat()</a></h1>
<p>&nbsp;</p>
a5_url_from_storagejsonformat(c json [,n numberofsecondsbeforeurlexpires ])
		<p><b>a5_url_fromStorageJSONformat() Function</b> - Generates a signed 
		URL to download a file from Amazon S3 storage.</p>
<p>The <font color="#0000FF" face="Courier New">a5_url_from_storageJSONformat()</font> function can be used to display/download 
a file from storage (e.g. Amazon S3) directly, with very little load on the 
Alpha server. The purpose of the function is to take a JSON string that defines 
the address of an object in storage (e.g. Amazon S3) and to generate a signed URL that 
can be used to download the object directly to the client from storage without 
having to first download the object to the Alpha server and then have the Alpha 
server send the file to the client.</p>
<p>&nbsp;</p>
<p>The JSON string format that defines the address of an object in storage is:</p>
<p class="xbasic">{cs: '<i>storage connection string</i>', object: '<i>name of 
object</i>', source: '<i>vendor</i>'}</p>
<p>&nbsp;</p>
<p class="note"><b>NOTE</b>: Currently the only vendor supported is Amazon S3 so
<i>vendor</i> must be set to 'S3'</p>
<p class="note"><b>NOTE: </b>The storage connection string is defined by 
selecting the Tools, Storage Connection Strings menu when the Web Projects 
Control Panel has focus. When you define storage connection strings you have the 
option of encrypting the storage connection string. You must NOT encrypt the 
storage connection string or else Alpha Anywhere will not be able to parse the 
storage connection string to determine your storage credentials.</p>
<p>&nbsp;</p>
<p>For example, assume you have a named storage connection string called 
'myS3bucket'. A JSON string that defines the address of an object called 'ProductPrices.pdf' 
would be:</p>
<p class="xbasic">{cs: 'myS3bucket', object: 'ProductPrices.pdf', source: 'S3'}</p>
<p>&nbsp;</p>
		<p>To generate a URL to display or download this object you would do the 
		following:</p>
		<p>&nbsp;</p>
		<p class="xbasic">dim address as c </p>
		<p class="xbasic">address = &lt;&lt;%txt%</p>
<p class="xbasic">{&nbsp;&nbsp;&nbsp; </p>
		<p class="xbasic">&nbsp;&nbsp;&nbsp; cs: 'myS3bucket', </p>
		<p class="xbasic">&nbsp;&nbsp;&nbsp; object: 'ProductPrices.pdf', </p>
		<p class="xbasic">&nbsp;&nbsp;&nbsp; source: 'S3'</p>
		<p class="xbasic">}</p>
		<p class="xbasic">%txt%</p>
		<p class="xbasic">dim url as c </p>
		<p class="xbasic">url = a5_url_from_storateJSONformat(address)</p>
		<p class="xbasic">&nbsp;</p>
<p>The resulting URL would look something like this (assuming that the bucket 
name specified in the connection string was 'myBucket'):</p>
		<p class="xbasic">https://s3.amazonaws.com/myBucket/ProductPrices.pdf?AWSAccessKeyId=<i>key</i>&amp;Expires=<i>expiration</i>&amp;Signature=<i>signature</i></p>
<p>Where:</p>
		<p><i>key</i> - your access key - as defined in the storage connection 
		string</p>
		<p><i>expires</i> - indicates how long the URL can be used for (only 
		applies if the object was uploaded to storage as 'Protected Read')</p>
		<p><i>signature</i> - a special signature based on the credentials 
		specified in the storage connection string.</p>
		<p>By default, the <i>expires</i> property is 240 seconds. That means 
		that if the URL is used more than 240 seconds after it was generated, 
		Amazon S3 will return a 'permission denied' error. The
		<font color="#0000FF" face="Courier New">a5_url_from_storageJSONformat()</font> 
		function takes an optional second argument where you can specify how 
		long the URL is good for in seconds. The default value for this 
		parameter is 240.</p>
		<p>&nbsp;</p>
	<p>&nbsp;</p>
	<p>&nbsp;</p>
	<p><b>File Upload - Amazon S3</b> - A new action has been added to Action 
	Javascript for the UX component to upload files to a bucket in Amazon S3 
	storage. </p>
	<p class="note"><b>NOTE</b>: This action is not available for the Grid 
	Component. However, the standard 'File Upload' and 'Image Upload' actions in 
	Action Javascript, which are supported in the Grid now supports an option 
	to target the upload to Amazon S3.</p>
	<p>
	<br>
	<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_amazon_s3_1.swf">Watch Video 
	- Part 1</a><br>
	<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_amazon_s3_2.swf">Watch Video 
	- Part 2</a></p>
	<p>&nbsp;</p>
	<p>The benefit of this method is that the upload occurs directly to the 
	Amazon servers without putting any load on the the Alpha Application Server.</p>
	<p class="note"><b>NOTE</b>: There is a small load on the Alpha Server for 
	each file that is uploaded because a callback has to be made to the Alpha 
	server to sign the URL used for the upload. This is necessary because the 
	secret key for your Amazon account is stored on the Alpha server.</p>
	<p>Features of the Amazon S3 File Upload include:</p>
	<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to upload a single file or multiple files</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to define rules for maximum size of an individual file, or 
		all files (if multiple file upload is supported)</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to show progress during while file(s) are being uploaded</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to cancel an file upload</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">full event model that allows you to completely customize the action.</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to specify the name (including sub-folder name) for each 
		object that is stored on S3. A Javascript function can be called to 
		dynamically compute the fully qualified name of the object on S3.</li>
		<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">ability to set read permission on the uploaded files (public read or 
		authenticated read)</li>
	</ul>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="a5_xbasictreetojsontree()">a5_xbasictreetojsontree()</a></h1>
a5_xbasictreetojsontree(c treedata [,c separator ])

<p>&nbsp;</p>

<h1><a name="a5w_ajaxtojson()">a5w_ajaxtojson()</a></h1>
<p>&nbsp;</p>
a5w_ajaxtojson(p tmpl ,p do )

<p>&nbsp;</p>

<h1><a name="argumentsfromjson()">argumentsfromjson()</a></h1>
<p>&nbsp;</p>
argumentsfromjson(p args ,c json )

<p>&nbsp;</p>

<h1><a name="argumentstojson()">argumentstojson()</a></h1>
<p>&nbsp;</p>
argumentstojson(* argsorargsxml [,l flagcompact ])

<p>&nbsp;</p>

<h1><a name="crlf_to_json()">crlf_to_json()</a></h1>
<p>&nbsp;</p>
&nbsp;<p>crlf_to_json(c txt [,c delimiter ]) </p>
<p>&nbsp;</p>

<h1><a name="json_composite()">json_composite()</a></h1>
<p>&nbsp;</p>
json_composite(c parent,c relations, c jsontext [, c mode[, c limits[,c views[,c 
calcs]]]] )

<p>&nbsp;</p>

<h1><a name="json_enumerate()">json_enumerate()</a></h1>
<p>&nbsp;</p>
json_enumerate(c jsontext)

<p>&nbsp;</p>

<h1><a name="json_extract()">json_extract()</a></h1>
<p>&nbsp;</p>
json_extract(c jsontext,c tag)
		<p>
						<b>json_extract() Function</b> - Extracts a property 
						from a JSON object .</p>
		<p>
						Syntax</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						c <i>text</i> = json_extract( C <i>json_text</i>, c <i>
						property_name</i>)</p>
		<p>
						&nbsp;</p>
		<p class="note">
						<b>NOTE</b> The JSON text passed to the function must be 
						properly formed (i.e. use double quotes on property and 
						string names). You can use json_reformat_safe() to 
						'clean' up the JSON string before calling json_extract.</p>
		<p>
						&nbsp;</p>
		<p>
						For example:</p>
		<p class="xbasic">
						dim json as c </p>
		<p class="xbasic">
						json = &lt;&lt;%txt%</p>
		<p class="xbasic">
						{ </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; name: 'Fred',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; address: {</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; street: '123 
						Main St',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; city: 
						'Boston',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state: 'MA'</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; }</p>
		<p class="xbasic">
						}</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						'json_extract() requires properly formed JSON, so</p>
		<p class="xbasic">
						'we first call json_reformat_safe()</p>
		<p class="xbasic">
						dim json2 as c </p>
		<p class="xbasic">
						json2 = json_reformat_safe(json)</p>
		<p class="xbasic">
						?json_extract(json2,&quot;name&quot;)</p>
		<p class="xbasic">
						= &quot;Fred&quot;</p>
		<p class="xbasic">
						?json_extract(json2,&quot;address&quot;)</p>
		<p class="xbasic">
						= &quot;</p>
		<p class="xbasic">
						{</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; street: '123 
						Main St',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; city: 
						'Boston',</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state: 'MA'</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; }</p>
		<p class="xbasic">
						&quot;</p>
		<p class="xbasic">
						%txt%</p>
		<p>
						&nbsp;</p>
		<p>&nbsp;</p>
		
<h1><a name="json_filter()">json_filter()</a></h1>
<p>&nbsp;</p>

json_filter(c jsontext,c tags[,l exclude])


<p>&nbsp;</p>


<h1><a name="json_flatten()">json_flatten()</a></h1>
<p>&nbsp;</p>

json_flatten(c jsontext,c patterns)</h1>
<p>
						<b>json_flatten() Function</b> - Takes a JSON string 
						that defines an array of hierarchical objects and 
						'flattens' the array.</p>
<p>
						This function is useful for Reporting where the report 
						data source is set to a Custom data source that returns 
						JSON data. If the JSON data that is returned is 
						hierarchical, then you will need to 'flatten' it in 
						order to get it into an appropriate format for the 
						report writer.</p>
<p>
						The syntax for json_flatten() is</p>
<p>
						c <i>output</i> = json_flatten(C <i>jsonIn</i>, c <i>
						template</i>)</p>
<p>
						The format of the template is shown in the following 
						example.</p>
<p>
						&nbsp;</p>
<p>
						Consider the following JSON String:</p>
						

<pre class="xbasicSmall">

[
        {
            "id": "alfki",
            "name": "customer 1",
            "__a5crc": -253329,
            "orders": [
                {
                    "orderId": 1,
                    "orderData": "12/1/2013",
                    "ordcust": "1|||alfki",
                    "orderDetails": [
                        {
                            "lineitemId": 1,
                            "prodId": 1,
                            "qty": 3,
                            "ordprod": "1|||1"
                        },
                        {
                            "lineitemId": 4,
                            "prodId": 3,
                            "qty": 2,
                            "ordprod": "1|||3"
                        }
                    ]
                },
                {
                    "orderId": 3,
                    "orderData": "12/3/2013",
                    "ordcust": "3|||alfki",
                    "orderDetails": [
                        {
                            "lineitemId": 6,
                            "prodId": 4,
                            "qty": 9,
                            "ordprod": "3|||4"
                        },
                        {
                            "lineitemId": 7,
                            "prodId": 3,
                            "qty": 1,
                            "ordprod": "3|||3"
                        }
                    ]
                }
            ]
        },
        {
            "id": "bolid",
            "name": "customer 2",
            "__a5crc": -194126,
            "orders": [
                {
                    "orderId": 2,
                    "orderData": "12/2/2013",
                    "ordcust": "2|||bolid",
                    "orderDetails": [
                        {
                            "lineitemId": 2,
                            "prodId": 6,
                            "qty": 6,
                            "ordprod": "2|||6"
                        },
                        {
                            "lineitemId": 3,
                            "prodId": 9,
                            "qty": 7,
                            "ordprod": "2|||9"
                        }
                    ]
                }
            ]
        }
]</pre>
<pre class="xbasicSmall">

</pre>						
						
<p>
						The JSON object defined by the above string shows an 
						array of customers with embedded orders. For each order, 
						there are embedded line-items.</p>
<p>
						The structure of the JSON object is</p>
<p>
						&nbsp;</p>
<p class="xbasic">
						Customers</p>
<p class="xbasic">
						&nbsp;&nbsp;&nbsp; Orders</p>
<p class="xbasic">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Order Details</p>
<p>
						The json_flatten() function takes two arguments - the 
						JSON string you want to flatten, and a template that 
						defines which properties in the input JSON you want to 
						map to the output JSON.</p>
<p>
						Assume that the following template is specified:</p>
						

<pre class="xbasicSmall">

{
   "id" : "id" ,
   "name" : "name" ,
   "orders" : [ 
                 { 
                    "orderId" : "orderId" , 
                    "orderData" : "orderData" , 
                    "orderDetails" : [
                                         { 
                                            "lineitemId" : "lineitemId" , 
                                            "prodId" : "prodId" , 
                                            "qty" : "qty" 
                                         }
                                    ] 
                } 
              ]
}

</pre>
					
<p>
						If you 'flatten' this JSON using the above template, you will get the following 
						output:</p>
						
<pre class="xbasicSmall">
[
    {
        "id": "alfki",
        "name": "customer 1",
        "orderId": 1,
        "orderData": "12/1/2013",
        "lineitemId": 1,
        "prodId": 1,
        "qty": 3
    },
    {
        "id": "alfki",
        "name": "customer 1",
        "orderId": 1,
        "orderData": "12/1/2013",
        "lineitemId": 4,
        "prodId": 3,
        "qty": 2
    },
    {
        "id": "alfki",
        "name": "customer 1",
        "orderId": 3,
        "orderData": "12/3/2013",
        "lineitemId": 6,
        "prodId": 4,
        "qty": 9
    },
    {
        "id": "alfki",
        "name": "customer 1",
        "orderId": 3,
        "orderData": "12/3/2013",
        "lineitemId": 7,
        "prodId": 3,
        "qty": 1
    },
    {
        "id": "bolid",
        "name": "customer 2",
        "orderId": 2,
        "orderData": "12/2/2013",
        "lineitemId": 2,
        "prodId": 6,
        "qty": 6
    },
    {
        "id": "bolid",
        "name": "customer 2",
        "orderId": 2,
        "orderData": "12/2/2013",
        "lineitemId": 3,
        "prodId": 9,
        "qty": 7
    }
]
</pre>
<p>
						Notice that the template has omitted the '__a5crc' in 
						the input property. The template indicated which 
						properties were to be extracted from the input JSON. It 
						also indicates that the property name should be called 
						in the output JSON.</p>
<p>
						For example, the template indicates:</p>
<p class="xbasicSmall">
						&nbsp;"id" : "id"</p>
<p>
						Had that been:</p>
<p>
						&nbsp;</p>
<p class="xbasicSmall">
						&nbsp;"id" : "CustomerId"</p>
<p class="xbasic">
						&nbsp;</p>
<p>
						The output JSON would have named the 'id' property 'CustomerId'.</p>
<p>
						&nbsp;</p>
<p>
						Here is a simpler example:</p>
<p>
						&nbsp;</p>
<p class="xbasicSmall">
						dim json as c <br>
						json = &lt;&lt;%str%<br>
						[<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;name&quot;: &quot;John&quot;, &quot;kids&quot; : [ {&quot;name&quot;: &quot;callie&quot;},{&quot;name&quot; 
						: &quot;griffin&quot;} ]},<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;name&quot;: &quot;Tom&quot;, &quot;kids&quot; : [ { &quot;name&quot; : &quot;betty&quot; } ]}<br>
						]<br>
						%str%<br>
						<br>
						dim template as c<br>
						template = &lt;&lt;%str%<br>
						{&quot;id&quot; : &quot;id&quot;, &quot;name&quot; : &quot;firstname&quot;, &quot;kids&quot; : [ {&quot;name&quot;: 
						&quot;name&quot;} ] }<br>
						%str%<br>
						<br>
						dim json2 as c <br>
						json2 = json_flatten(json,template)<br>
						json2 = json_reformat(json2)</p>
<p>
						<br>
						Here is what json2 looks like:</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						[<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;John&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;callie&quot;<br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;John&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;griffin&quot;<br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;Tom&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;betty&quot;<br>
&nbsp;&nbsp;&nbsp; }<br>
						]</p>
<p>
						&nbsp;</p>
<p>
						The json_flatten() function can also be used to simply 
						map property names in the input JSON to new property 
						names in the output JSON. For example, consider the 
						following script:</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p class="xbasicSmall">
						dim json as c <br>
						json = &lt;&lt;%str%<br>
						[<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;name&quot;: &quot;John&quot;},<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;name&quot;: &quot;Tom&quot;}<br>
						]<br>
						%str%<br>
						<br>
						dim template as c<br>
						template = &lt;&lt;%str%<br>
						{&quot;id&quot; : &quot;id&quot;, &quot;name&quot; : &quot;firstname&quot;}<br>
						%str%<br>
						<br>
						<br>
						dim json2 as c <br>
						json2 = json_flatten(json,template)<br>
						json2 = json_reformat(json2)<br>
						showvar(json2)<br>
&nbsp;</p>
<p>
						The resulting JSON will look like this:</p>
<p class="xbasicSmall">
						[<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;firstname&quot;: &quot;John&quot;},<br>
&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;firstname&quot;: &quot;Tom&quot;}<br>
						]</p>
<p class="xbasicSmall">
						&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="json_from_bson()">json_from_bson()</a></h1>
json_from_bson(b bson)


<h1><a name="json_from_xml()">json_from_xml()</a></h1>
json_from_xml(c xmltext[,c toptag[,c options]])



<h1><a name="json_from_xml_odata()">json_from_xml_odata()</a></h1>
json_from_xml_odata(c xmltext[,c toptag[,c options]])
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><br>



<h1><a name="json_generate()">json_generate()</a></h1>
<p>&nbsp;</p>
<br>
json_generate(* var [,l flagspecialtags [,l flagcondense [,c indent [,l 
flaghonornulls [,*&nbsp;opsin ]]]]])<br>
&nbsp;<p>&nbsp;</p>
<p>JSON_GENERATE Function<br>
&nbsp;</p>
</h1>
		<p>
						<b>json_generate() Function - Performance</b> - The 
						json_generate() function has been re-written and is now 
						considerably faster. </p>
		<p>
						<b>NOTE</b>: Previously the json_generate() function 
						would escape single quotes. However the JSON spec does 
						not require this and so single quotes are no longer 
						escaped. For example:</p>
		<p class="xbasic">
						dim pj as p<br>
						pj.text = &quot;some text with ' single quote&quot;<br>
						?json_generate(pj)<br>
						= {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;text&quot;: &quot;some text with ' single quote&quot;<br>
						}</p>
		<hr color="#000000">
<p class=A5>Old generate</p>
<p class=A5>Syntax</p>
<p>json_generate(<span class=Argument>var</span> as p)</p>
<table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 15.952%;"> <col style="width: 84.048%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableHead>Argument</td> <td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableHead>Description</td> </tr>
<tr style="x-cell-content-align: top;" valign="top"><td class="TableCell" style="x-cell-content-align: top; width: 14.433%;" valign="top" width="14.433%"><p class=TableLeft> <span class=Argument>  var</span></p></td><td class="TableCell" style="x-cell-content-align: top; width: 85.567%;" valign="top" width="85.567%"><p class=TableLeft>pointer to variable.</p></td></tr>
</table>
<p class=A5>Description</p>
<p>Generates a string in JSON format from an Xbasic dot variable. This function should be used in place of varToJSON() which will be deprecated. The json_generate() function is identical to varToJSON() in all respects, except that the attribute name and string values are quoted using double quotes in accordance with the official JSON specification.<p>
						&nbsp;</p>
<p>
						&nbsp;</p>
<p>
						<b>File.to_property() Function</b> - Can now 
						automatically de-serialize a file that was serialized 
						using property_to_string(), property_to_blob() or 
						json_generate().</p>
		<p>
						Example:</p>
		<p class="xbasic">
						dim src.fname as c = &quot;john&quot;<br>
						dim src.lname as c = &quot;public&quot;<br>
						file.From_string(&quot;c:\data\sample.txt&quot;,property_to_string(src))<br>
						file.From_string(&quot;c:\data\sample.json&quot;,json_generate(src))<br>
						file.From_blob(&quot;c:\data\sample.dat&quot;,property_to_blob(src))<br>
						<br>
						<br>
						dim p1 as p<br>
						file.to_property(&quot;c:\data\sample.txt&quot;,p1)<br>
						? p1<br>
						= fname = &quot;john&quot;<br>
						lname = &quot;public&quot;<br>
						<br>
						<br>
						dim p2 as p<br>
						file.to_property(&quot;c:\data\sample.json&quot;,p2)<br>
						? p2<br>
						= fname = &quot;john&quot;<br>
						lname = &quot;public&quot;<br>
						<br>
						dim p3 as p<br>
						file.to_property(&quot;c:\data\sample.dat&quot;,p3)<br>
						? p3<br>
						= fname = &quot;john&quot;<br>
						lname = &quot;public&quot;</p>
		<p>
						&nbsp;</p>
		<p>&nbsp;</p>


<h1><a name="json_parse()">json_parse()</a></h1>
<p>&nbsp;</p>
json_parse(c jsontext [,l flagjavascriptsyntax ])
<h1>&nbsp;</h1>
<h1><br>
JSON_PARSE Function<br>
&nbsp;</h1>
		<p><b>json_parse() Function - Parsing Javascript Object Literals - </b>
		The JSON parse function now takes an optional second argument to 
		indicate if the JSON being parsed is a Javascript object literal rather 
		than a JSON string. For example, consider the following Xbasic code 
		which defined an Xbasic object (i.e. dot variable):</p>
		<p>&nbsp;</p>
		<p class="xbasic">dim p as p<br>
		p.name = &quot;Fred&quot;<br>
		p.sayHello = &quot;{javascript}function() { alert('hello');}&quot;</p>
		<p class="xbasic">&nbsp;</p>
		<p>Now, generate a Javascript object literal. Pass in .t. as the second 
		argument to <font color="#0000FF" face="Courier New">vartojson()</font> 
		to indicate that we want an Javascript object literal and not a JSON 
		string.</p>
		<p class="xbasic">&nbsp;</p>
		<p class="xbasic">dim jsObject as c </p>
		<p class="xbasic">jsObject = vartojson(p,.t.)<br>
&nbsp;</p>
		<p>Here is what the resulting string looks like:</p>
		<p class="xbasic">&nbsp;{<br>
		name: 'Fred',<br>
		sayHello: function() { alert('hello');}<br>
		}</p>
		<p>&nbsp;</p>
		<p>Now, in order to be able to parse this object literal back to Xbasic, 
		we use the json_parse() function but we set the optional second argument 
		to .t.</p>
		<p class="xbasic"><br>
		dim pj as p<br>
		pj = json_parse(jsObject ,.t.)<br>
		?pj.name <br>
		= &quot;Fred&quot;<br>
		<br>
		?pj.sayHello<br>
		= &quot;{javascript}function() { alert('hello');}&quot;<br>
		<br>
		<b><br>
&nbsp;</b></p>
		<p>&nbsp;</p>
<p class=A5>Syntax</p>
<p>json_parse(<span class=Argument>jsonTxt</span> as c)</p>
<table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 15.952%;"> <col style="width: 84.048%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableHead>Argument</td> <td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableHead>Description</td> </tr>
<tr style="x-cell-content-align: top;" valign="top"><td class="TableCell" style="x-cell-content-align: top; width: 14.433%;" valign="top" width="14.433%"><p class=TableLeft> <span class=Argument> jsonTxt</span></p></td><td class="TableCell" style="x-cell-content-align: top; width: 85.567%;" valign="top" width="85.567%"><p class=TableLeft>JSON formatted text.</p></td></tr>
</table>
<p class=A5>Description</p>
<p>Parses a string in JSON format and returns an Xbasic dot variable. This function is simply a wrapper on the INET::JSONParser.parse() method. However, unlike the low level INET::JSONParser.parse() method, the json_parse() function can also be used to parse strings that are in Javascript array format. (INET::JSONParser.parse() can only be used for strings that are in JSON format.) For example:<br>
<table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%">
<p class=Code>p=json_parse("<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/1,2,3" rel="">1,2,3</a>")</p>
<p class=Code>?p</p>
<p class=Code>=&nbsp;<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/1" rel="">1</a>&nbsp;=&nbsp;1</p>
<p class=Code>
<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/2" rel="">2</a>&nbsp;=&nbsp;2</p>
<p class=Code>
<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/3" rel="">3</a>&nbsp;=&nbsp;3</p>
<p class=Code>&nbsp;</p>
<p class=Code>p2&nbsp;=&nbsp;json_parse("<a class="wiki"  href="{name:\"Fred&nbsp;Smith\",&nbsp;age:&nbsp;23&nbsp;},{name:\"John&nbsp;Jones\",&nbsp;age:&nbsp;45}" rel="">{name:\"Fred&nbsp;Smith\",&nbsp;age:&nbsp;23&nbsp;},{name:\"John&nbsp;Jones\",&nbsp;age:&nbsp;45}</a>")</p>
<p class=Code>?p2<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/1" rel="">1</a></p>
<p class=Code>=&nbsp;age&nbsp;=&nbsp;23</p>
<p class=Code>name&nbsp;=&nbsp;"Fred&nbsp;Smith"</p>
<p class=Code>?p2<a class="wiki"  href="../../../../dev/AlphaHelp/helpfiles/Server/Reference/Design/Api/Functions/JSON%20Functions/2" rel="">2</a></p>
<p class=Code>=&nbsp;age&nbsp;=&nbsp;45</p>
<p class=Code>name&nbsp;=&nbsp;"John&nbsp;Jones"</p>
</td></tr></table>
The json_parse() function  can interpret Javascript Date() functions in the JSON string. This allows you to parse JSON strings generated by the json_generate() function, if the json_generate() function generated a JSON string that uses the Date() function.<br>
<br>
<br>
The following example shows a round trip using json_parse() and json_generate() to show how date and time values are preserved.<br><p class=A5>Example</p>
 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim&nbsp;p&nbsp;as&nbsp;p</p>
<p class=Code>p.name&nbsp;=&nbsp;"Karen"</p>
<p class=Code>p.dob&nbsp;=&nbsp;date()</p>
<p class=Code>p.time&nbsp;=&nbsp;now()</p>
<p class=Code></p>
<p class=Code>?json_generate(p)</p>
<p class=Code>{</p>
<p class=Code>"name":&nbsp;"Karen",</p>
<p class=Code>"dob":&nbsp;Date(06/02/2012),</p>
<p class=Code>"time":&nbsp;Date(06/02/2012&nbsp;10:17:11&nbsp;32&nbsp;pm)</p>
<p class=Code>}</p>
<p class=Code></p>
<p class=Code>dim&nbsp;jsonTxt&nbsp;as&nbsp;c&nbsp;</p>
<p class=Code>jsonTxt&nbsp;=&nbsp;json_generate(p)</p>
<p class=Code>dim&nbsp;p2&nbsp;as&nbsp;p</p>
<p class=Code>p2&nbsp;=&nbsp;json_parse(jsonTxt)</p>
<p class=Code>?p2</p>
<p class=Code></p>
<p class=Code>=&nbsp;dob&nbsp;=&nbsp;{06/02/2012}</p>
<p class=Code>name&nbsp;=&nbsp;"Karen"</p>
<p class=Code>time&nbsp;=&nbsp;06/02/2012&nbsp;10:17:11&nbsp;32&nbsp;pm</p>
</td></tr></table>
<p class=A5>NOTE<span style="font-weight: 400">: If the data in the JSON string 
contains any strings with line breaks (designated as '\n' in the data) , 
json_parse() will return LF delimited data, not CR-LF delimited data. You will 
need to use the convert_lf_to_crlf() function to convert LFs to CR-LFs.</span></p>
	<p class=A5><span style="font-weight: 400">Example:</span></p>
<p class=Code>dim&nbsp;p&nbsp;as&nbsp;p</p>
<p class=Code>p.name&nbsp;=&nbsp;"Alpha&quot; + crlf() + &quot;Beta&quot;</p>
<p class=Code>?json_generate(p)</p>
	<p class=Code>{name: 'Alpha\nBeta'}</p>
	<p class=Code>p2 = json_parse(json_generate(p))</p>
	<p class=Code>?p2.name = p.name</p>
	<p class=Code>= .F.</p>
	<p class=Code>?convert_lf_to_crlf(p2.name) = p.name</p>
	<p class=Code>= .T.</p>
<p class=Code>&nbsp;</p>
<p class=Code>&nbsp;</p>
<p class=Code>&nbsp;</p>
<p class=Code>&nbsp;</p>
<p class=Code>&nbsp;</p>


<h1><a name="json_reformat()">json_reformat()</a></h1>
<p>&nbsp;</p>
	json_reformat(c jsontext [, l indented] )



<p>&nbsp;</p>



<h1><a name="json_reformat_safe()">json_reformat_safe()</a></h1>
<p>&nbsp;</p>
json_reformat_safe(c json [,l indented ])
		<p>
						<b>json_reformat_safe() Function</b> - Reformats as 
						string of JSON data with line-breaks and optional 
						indentation.</p>
		<p>
						Syntax:</p>
		<p class="xbasic">
						c <i>json_text</i> = json_reformat_safe(<i>json_text</i> 
						[, <i>flagIndent</i> = .t.])</p>
		<p>
						&nbsp;</p>
		<p>
						For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasicSmall">
						dim json as c </p>
		<p class="xbasicSmall">
						json = &lt;&lt;%txt%</p>
		<p class="xbasicSmall">
						{firstname: 'Fred', lastname: 'Smith', Address: {<br>
						Street: '123 Main St', <br>
						City: 'Boston', <br>
						State: 'Ma'<br>
						}<br>
						}<br>
						%txt%</p>
		<p class="xbasicSmall">
						&nbsp;</p>
		<p class="xbasicSmall">
						?json_reformat_safe(json)</p>
		<p class="xbasicSmall">
						= {<br>
&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;Fred&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;lastname&quot;: &quot;Smith&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;Address&quot;: {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Street&quot;: &quot;123 Main St&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;City&quot;: &quot;Boston&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;State&quot;: &quot;Ma&quot;<br>
&nbsp;&nbsp;&nbsp; }<br>
						}</p>
		<p>
						&nbsp;</p>
		<p class="note">
						<b>NOTE: </b>json_reformat_safe() wraps the lower 
						level json_reformat() function. The json_reformat() 
						function only accepts 'properly formed' JSON strings 
						(property names must be double quoted and string values 
						must be double quoted). json_reformat_safe() will 
						automatically convert JSON strings where property names 
						are not quoted and strings are single quoted.</p>
<h1><br>
&nbsp;</h1>
<h1><a name="json_sample_array()">json_sample_array()</a></h1>

json_sample_array(c jsontext[, format [,n limit]])


<p>&nbsp;</p>


<h1><a name="json_select()">json_select()</a></h1>
json_select(c jsontext,c columns[,c primarykey[,l crc[,c flags]]])
<p>&nbsp;</p>
<p>&nbsp;</p>



<h1><a name="json_sqlquery()">json_sqlquery()</a></h1>

json_sqlquery(c json ,c sqlstatement [,* argsin [,c columntypes [,* otheropsin ]]])
<p>&nbsp;</p>
		<p>
						<b>json_sqlQuery() Function</b> - Allows you to filter a 
						JSON array using a simple SQL query syntax. For example 
						assume you have a JSON string as shown below. The JSON 
						is an array of objects. You can think of this as a table 
						with the following fields: firstname, lastname, city and 
						state.</p>
		<p>
						&nbsp;</p>
		<p>
						&nbsp;</p>
		<p class="xbasicSmall">
						dim json as c <br>
						json = &lt;&lt;%str%<br>
						[<br>
&nbsp;&nbsp;&nbsp; {firstname: 'John', lastname: 'Smith', city: 'Boston', state: 
						'MA'},<br>
&nbsp;&nbsp;&nbsp; {firstname: 'Fred', lastname: 'Jones', city: 'Cambridge', 
						state: 'MA'},<br>
&nbsp;&nbsp;&nbsp; {firstname: 'Tom', lastname: 'King', city: 'New York', state: 
						'NY'}<br>
						]<br>
						%str%<br>
&nbsp;</p>
		<p>
						Assume that you want to apply a filter to this string to 
						retrieve certain records and also to sort the result.</p>
		<p>
						The SQL that you would need to express your query might 
						be:</p>
		<p class="xbasic">
						select * from JSONTABLE WHERE state = 'MA' ORDER BY 
						lastname</p>
		<p>
						&nbsp;</p>
		<p>
						Or if you would like to use arguments in your SQL, you 
						might express your query as:</p>
		<p class="xbasic">
						select * from JSONTABLE WHERE state = :whatstate ORDER 
						BY lastname</p>
		<p>
						&nbsp;</p>
		<p>
						Here is how you can use the json_sqlQuery() function:</p>
		<p class="xbasicSmall">
						<br>
						dim args as sql::arguments <br>
						args.add(&quot;whatstate&quot;,&quot;MA&quot;)<br>
						dim jsonResult as c <br>
						json2 = json_sqlQuery(json,&quot;select * from jsontable 
						where state = :whatstate ORDER BY lastname&quot;,args)</p>
		<p>
						&nbsp;</p>
		<p>
						The resulting string will be:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						[</p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; {firstname: 'Fred', lastname: 
						'Jones', city: 'Cambridge', state: 'MA'},<br>
&nbsp;&nbsp;&nbsp; {firstname: 'John', lastname: 'Smith', city: 'Boston', state: 
						'MA'}</p>
		<p class="xbasic">
						]<br>
						&nbsp;</p>
		<p>&nbsp;</p>



<h1><a name="json_standardize()">json_standardize()</a></h1>
json_standardize(c json [,l flagreformat ])
		<p>
						<b>JSON_standardize() function</b> - Takes non-standard 
						JSON and standardizes it. Also corrects for trailing 
						commas in the JSON (which are illegal)</p>
		<p>
						&nbsp;</p>
		<p>
						For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						?json_standardize(&quot;{name: 'Fred', age: 21}&quot;)</p>
		<p class="xbasic">
						&nbsp;{<br>
						&quot;name&quot;: &quot;Fred&quot;,<br>
						&quot;age&quot;: 21<br>
						}</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						?json_standardize(&quot;{name: 'Fred', age: 21,}&quot;)</p>
		<p class="xbasic">
						&nbsp;{<br>
						&quot;name&quot;: &quot;Fred&quot;,<br>
						&quot;age&quot;: 21<br>
						}<br>
&nbsp;</p>
<h1>&nbsp;</h1>
<h1><a name="json_to_bson()">json_to_bson()</a></h1>
json_to_bson(c json)



<p>&nbsp;</p>



<h1><a name="json_to_xml()">json_to_xml()</a></h1>
<p>&nbsp;</p>
json_to_xml(c jsontext[,c toptag[,c options]])
		<p>
						<b>json_to_xml() Function - ATOM Format</b> - The 
						json_to_xml() function can now generate XML using the 
						&quot;atom&quot; format:</p>
		<p>
						&nbsp;</p>
		<p>
						For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						js = &lt;&lt;%str%<br>
						{<br>
&nbsp;&nbsp;&nbsp; &quot;OrderId&quot;:10248,<br>
&nbsp;&nbsp;&nbsp; &quot;ProductID&quot;:11,<br>
&nbsp;&nbsp;&nbsp; &quot;UnitPrice&quot;:14,<br>
&nbsp;&nbsp;&nbsp; &quot;Quantity&quot;:12,<br>
&nbsp;&nbsp;&nbsp; &quot;Discount&quot;:0<br>
						}<br>
						%str%<br>
						<br>
						dim xml as c <br>
						xml = json_to_xml(js)</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
						&lt;data&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;OrderId&gt;O10248&lt;/OrderId&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;ProductID&gt;11&lt;/ProductID&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;UnitPrice&gt;14&lt;/UnitPrice&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Quantity&gt;12&lt;/Quantity&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Discount&gt;0&lt;/Discount&gt;<br>
						&lt;/data&gt;<br>
&nbsp;</p>
		<p class="xbasic">
						<br>
						<br>
						dim format as c <br>
						format = &lt;&lt;%str%<br>
						{ &quot;format&quot; : &quot;atom&quot;}<br>
						%str%<br>
						<br>
						dim xml as c = json_to_xml(js,&quot;&quot;,format)<br>
						<br>
						&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
						&lt;atom:entry xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;<br>
						xmlns:m=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&quot;<br>
						xmlns:d=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices&quot;&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;atom:content type=&quot;application/xml&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;m:properties&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:OrderId&gt;O10248&lt;/d:OrderId&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:ProductID&gt;11&lt;/d:ProductID&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:UnitPrice&gt;14&lt;/d:UnitPrice&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:Quantity&gt;12&lt;/d:Quantity&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&lt;d:Discount&gt;0&lt;/d:Discount&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/m:properties&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/atom:content&gt;<br>
						&lt;/atom:entry&gt;</p>
		<p>
						&nbsp;</p>
		<p>
						<b>json_to_xml() Function</b> - Convert JSON to XML - 
						Takes a string of JSON data and converts it to XML.</p>
		<p>
						Syntax</p>
		<p class="xbasic">
						c <i>xml</i> = json_to_xml(c <i>json, </i>c<i> attribute</i>)</p>
		<p>
						Example</p>
		<p class="xbasic">
						dim json as c </p>
		<p class="xbasic">
						json = &lt;&lt;%txt%</p>
		<p class="xbasic">
						{ </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; &quot;firstname&quot; : &quot;john&quot; , </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; &quot;lastname&quot; : &quot;public&quot; , </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; &quot;num&quot; : [1,2,3] , </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; &quot;flag&quot; : true , </p>
		<p class="xbasic">
						&nbsp;&nbsp;&nbsp; &quot;place&quot; : { &quot;state&quot; : &quot;Texas&quot;} </p>
		<p class="xbasic">
						}</p>
		<p class="xbasic">
						%txt%</p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						dim xml as c </p>
		<p class="xbasic">
						xml = json_to_xml(json,&quot;person&quot;)</p>
		<p class="xbasic">
						&nbsp;</p>
		<p>
						The resulting XML string looks like this:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
						&lt;person&gt;<br>
						&nbsp; &nbsp;&lt;firstname&gt;john&lt;/firstname&gt;<br>
						&nbsp; &nbsp;&lt;lastname&gt;public&lt;/lastname&gt;<br>
						&nbsp; &nbsp;&lt;num&gt;1&lt;/num&gt;<br>
						&nbsp; &nbsp;&lt;num&gt;2&lt;/num&gt;<br>
						&nbsp; &nbsp;&lt;num&gt;3&lt;/num&gt;<br>
						&nbsp; &nbsp;&lt;flag&gt;true&lt;/flag&gt;<br>
						&nbsp; &nbsp;&lt;place&gt;<br>
						&nbsp; &nbsp; &nbsp; &lt;state&gt;Texas&lt;/state&gt;<br>
						&nbsp; &nbsp;&lt;/place&gt;<br>
						&lt;/person&gt;<br>
&nbsp;</p>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>

<h1><a name="json_validate()">json_validate()</a></h1>
<p>&nbsp;</p>
json_validate(c jsontext)
<h1>&nbsp;</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
		<p>
						<span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8000001907349px; font-style: normal; font-variant: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; font-weight: 700; background-color: rgb(255, 255, 255)">
						a5_json_viewer()&nbsp; Function </span>
						<span style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8000001907349px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255);">
						- The A5_json_viewer() function can be used to open a 
						viewer for JSON data.</span></p>
		<p>
						&nbsp;</p>
		<p>
						<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/a5_json_viewer.jpg"></p>
		<p>
						&nbsp;</p>
		<h1>&nbsp;</h1>
<h1>&nbsp;</h1>


<h1><a name="property_from_json()">property_from_json()</a></h1>
<p>&nbsp;</p>
property_from_json(p prop , c jsontext)<p>&nbsp;</p>
<p>&nbsp;</p>
</h1>


<h1><a name="property_to_json()">property_to_json()</a></h1>
<p>&nbsp;</p>
property_to_json(p prop [, l changesonly] )<p>&nbsp;</p>
</h1>


<h1><a name="vartojson()">vartojson()</a></h1>
<p>&nbsp;</p>
vartojson(* var [,l flagspecialtags [,l flagcondense [,c indent [,l flagquotesonpropnames [,l flaghonornulls ]]]]])</h1>
<h1><br>
&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="vartojsonhash()">vartojsonhash()</a></h1>
<p>
						&nbsp;</p>
<p>
						vartojsonhash(p p ,c hashproperty [,l flagspecialtags 
						[,l flagcondense [,l&nbsp;flagusedoublequotes ]]])<b><br>
&nbsp;</b></p>
<p>
						<b>varToJsonHash() Function</b> - Converts an Xbasic 
						property array to a JSON hash </p>
		<p>
						&nbsp;</p>
		<p>
						Syntax:</p>
		<p class="xbasic">
						C jsonHash = varToJSonHash(p propertyArray, c 
						hashProperty [, L flagSpecialTags&nbsp; [, L&nbsp; 
						flagCondense [, flagUseDoubleQuotes ]]])</p>
		<p>
						&nbsp;</p>
		<p>
						Where:</p>
		<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>propertyArray</i> - Xbasic property array</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>hashProperty</i> - name of the property in the Xbasic array 
			to be used as the hash key</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>flagSpecialTags</i> - specifies if the property array uses 
			the special {javascript} directive to indicate that the JSON 
			property should be generated as Javascript and not as a string. 
			Default if false.</li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>flagCondense</i> - indicates if the generated JSON should be 
			condensed to eliminate line breaks. </li>
			<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px"><i>flagUseDoubleQuotes</i> - indicates if strings and property 
			names should be double quoted. By default property names are not 
			quoted and strings are single quoted.</li>
		</ul>
		<p>
						&nbsp;</p>
		<p>
						Example:</p>
		<p>
						Consider the following Xbasic property array:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						DIM P[0] as p<br>
						p[].name = &quot;John Smith&quot;<br>
						p[..].address = &quot;123 Main Street&quot;<br>
						p[..].age = 23</p>
		<p class="xbasic">
						<br>
						<br>
						<br>
						p[].name = &quot;Fredia Malt&quot;<br>
						p[..].address = &quot;456 Center Lane&quot;<br>
						p[..].age = 33</p>
		<p>
						&nbsp;</p>
		<p>
						We can convert this to a JSON hash, using the 'name' 
						property as the hash index as follows:</p>
		<p>
						dim jsonHash as c </p>
		<p class="xbasic">
						jsonHash = vartojsonHash(p,&quot;name&quot;)<br>
&nbsp;</p>
		<p>
						The resulting JSON string looks like this:</p>
		<p class="xbasic">
						<br>
						{<br>
&nbsp;&nbsp;&nbsp; 'John Smith' : {address: '123 Main Street',age: 23},<br>
&nbsp;&nbsp;&nbsp; 'Fredia Malt' : {address: '456 Center Lane',age: 33}<br>
						}<br>
&nbsp;</p>
		<p>
						In this next example we use the <i>flagSpecialTags</i> 
						property</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						DIM P[0] as p<br>
						p[].name = &quot;John Smith&quot;<br>
						p[..].address = &quot;123 Main Street&quot;<br>
						p[..].age = 23</p>
		<p class="xbasic">
						p[..].sayHello = &quot;{javascript}function() { alert('hello 
						John') }&quot;</p>
		<p class="xbasic">
						<br>
						<br>
						<br>
						p[].name = &quot;Fredia Malt&quot;<br>
						p[..].address = &quot;456 Center Lane&quot;<br>
						p[..].age = 33</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						jsonHash = vartojsonHash(p,&quot;name&quot;, .t.)<br>
&nbsp;</p>
		<p class="xbasic">
						&nbsp;</p>
		<p>
						The resulting JSON string is:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						{<br>
&nbsp;&nbsp;&nbsp; 'John Smith' : {address: '123 Main Street',age: 23,sayHello: 
						function() { alert('hello John') }},<br>
&nbsp;&nbsp;&nbsp; 'Fredia Malt' : {address: '456 Center Lane',age: 33}<br>
						}</p>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>

<h1><a name="vartojsonstandard()">vartojsonstandard()</a></h1>
vartojsonstandard(* var [,l flagspecialtags [,l flagcondense [,c indent [,l flagquotesonpropnames [,l jqueryformat [,l flaghonornulls [,* opsin ]]]]]]])


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_expression_to_json()">xbasic_expression_to_json()</a></h1>
xbasic_expression_to_json(c script)


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_from_json()">xbasic_from_json()</a></h1>
xbasic_from_json(c script)


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_script_to_json()">xbasic_script_to_json()</a></h1>
xbasic_script_to_json(c script)


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="'json class">'json class</a></h1>
'json class


<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="dim json as extension::JSON">dim json as extension::JSON</a></h1>
dim json as extension::JSON
		<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><b>2. Advanced Method: Define Message Using a JSON String</b></p>
		<p>The JSON method exposes the full functionality of the Mandrill 
		service. To see all of the options that are available, please see the 
		Mandrill API documentation.</p>
		<p>If you want to use advanced features, like track opens, or schedule 
		delivery, you will need to use this option.</p>
		<p>Here is an example of how you can use this method:</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p class="xbasic">DIM json as C = &lt;&lt;%str%<br>
		{<br>
&nbsp;&nbsp;&nbsp; &quot;message&quot;: {<br>
&nbsp;&nbsp;&nbsp; &quot;to&quot;: [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;email&quot;: &quot;john@acme.com&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;John Smith&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; ],<br>
&nbsp;&nbsp;&nbsp; &quot;from_email&quot;: &quot;Sales@alpha.com&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;subject&quot;: &quot;Information You Requested&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;html&quot;: &quot;Here is the &lt;b&gt;information&lt;/b&gt; you requested&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;text&quot;: &quot;Plain Text Message&quot;,<br>
&nbsp;&nbsp;&nbsp; &quot;preserve_recipients&quot;: false<br>
		},<br>
		&quot;asynch&quot;: false,<br>
		&quot;ip_pool&quot;: null,<br>
		&quot;send_at&quot;: null<br>
		}<br>
		%str%</p>
<p class="xbasic">dim pResult as p</p>
<p class="xbasic">pResult = email_send_mandrill(&quot;mysecretkey&quot;,json)</p>
<p>&nbsp;</p>
<p><b>Generating the JSON String From Xbasic</b></p>
<p>Xbasic has powerful functions for generating JSON from an Xbasic dot 
variable. For example, the json_generate() function will generate JSON from a 
.dot variable.&nbsp; A powerful way to programmatically construct the JSON 
string that you pass into the email_send_mandrill() function is to build up an 
Xbasic .dot variable with the various properties that you want to set, then call 
json_generate() to generate the JSON.</p>
<p>&nbsp;</p>
	<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

</body>

</html>
