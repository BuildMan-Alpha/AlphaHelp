<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/theme.css" />

<title>JSON_Data</title>

</head>

<body>

&nbsp;<p align="center"><font align="center" size="7">JSON Data</font>

</p>

<div class="helpserver_toc">
<ul>
<li>
	<a href="#Introduction">Introduction</a>
</li>
<li>
	<a href="#Using JSON with Xbasic">Using JSON with Xbasic</a>
	<ul>
		<li>
			<a href="#JSON and Sub-Objects">JSON and Sub-Objects</a>
		</li>
		<li>
			<a href="#JSON and Arrays">JSON and Arrays</a>
		</li>
	</ul>
</li>
<li>
	<a href="#Using JSON with Javascript">Using JSON with Javascript</a>
</li>
<li>
	<a href="#Using JSON to send Data between a Client and Server">Using JSON to send Data 
	from Client to Server</a>
</li>
<li>
	<a href="#JSON and sending data from Server to Client">JSON and sending data from Server to Client</a>
</li>
<li>
	<a href="#JSON from the Server-side, and Advanced Templates">JSON from the 
	Server-side and the Template Tester</a>
</li>
<li>
	<a href="#JSON Functions and Special Flags">JSON Functions and Special Flags</a>
</li>
<li>
	<a href="#Interrogating JSON Data">Interrogating JSON Data</a>
</li>
<li>
	<a href="#BSON Queries and JSON">BSON Queries and JSON</a>
</li>
<li><a href="#JSON Functions">JSON Functions</a>
<ul>
	<li><a href="#a5_json_extractvalues()">a5_json_extractvalues()</a> </li>
	<li><a href="#a5_json_populatearray()">a5_json_populatearray()</a> </li>
	<li><a href="#a5_json_prep()">a5_json_prep()</a> </li>
	<li><a href="#a5_makejsontree()">a5_makejsontree()</a> </li>
	<li><a href="#a5_merge_json_into_template()">a5_merge_json_into_template()</a>
	</li>
	<li><a href="#a5_sql_nested_query_to_json_document()">a5_sql_nested_query_to_json_document()</a>
	</li>
	<li><a href="#a5_url_from_storagejsonformat()">a5_url_from_storagejsonformat()</a>
	</li>
	<li><a href="#a5_xbasictreetojsontree()">a5_xbasictreetojsontree()</a> </li>
	<li><a href="#a5w_ajaxtojson()">a5w_ajaxtojson()</a> </li>
	<li><a href="#argumentsfromjson()">argumentsfromjson()</a> </li>
	<li><a href="#argumentstojson()">argumentstojson()</a> </li>
	<li><a href="#crlf_to_json()">crlf_to_json()</a> </li>
	<li><a href="#json_composite()">json_composite()</a> </li>
	<li><a href="#json_enumerate()">json_enumerate()</a> </li>
	<li><a href="#json_extract()">json_extract()</a> </li>
	<li><a href="#json_filter()">json_filter()</a> </li>
	<li><a href="#json_flatten()">json_flatten()</a> </li>
	<li><a href="#json_from_bson()">json_from_bson()</a> </li>
	<li><a href="#json_from_xml()">json_from_xml()</a> </li>
	<li><a href="#json_from_xml_odata()">json_from_xml_odata()</a> </li>
	<li><a href="#json_generate()">json_generate()</a> </li>
	<li><a href="#json_parse()">json_parse()</a> </li>
	<li><a href="#json_reformat()">json_reformat()</a> </li>
	<li><a href="#json_reformat_safe()">json_reformat_safe()</a> </li>
	<li><a href="#json_sample_array()">json_sample_array()</a> </li>
	<li><a href="#json_select()">json_select()</a> </li>
	<li><a href="#json_sqlquery()">json_sqlquery()</a> </li>
	<li><a href="#json_standardize()">json_standardize()</a> </li>
	<li><a href="#json_to_bson()">json_to_bson()</a> </li>
	<li><a href="#json_to_xml()">json_to_xml()</a> </li>
	<li><a href="#json_validate()">json_validate()</a> </li>
	<li><a href="#property_from_json()">property_from_json()</a> </li>
	<li><a href="#property_to_json()">property_to_json()</a> </li>
	<li><a href="#vartojson()">vartojson()</a> </li>
	<li><a href="#vartojsonhash()">vartojsonhash()</a> </li>
	<li><a href="#vartojsonstandard()">vartojsonstandard()</a> </li>
	<li><a href="#xbasic_expression_to_json()">xbasic_expression_to_json()</a>
	</li>
	<li><a href="#xbasic_from_json()">xbasic_from_json()</a> </li>
	<li><a href="#xbasic_script_to_json()">xbasic_script_to_json()</a> </li>
	<li><a href="#'json class">'json class</a> </li>
	<li><a href="#dim json as extension::JSON">dim json as extension::JSON</a>
	</li>
</ul></li>

</ul>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="Introduction">Introduction</a></h1>


<p>&nbsp;</p>


<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
<p><font size="2"><font color="#0000FF">JSON</font>, or Javascript Object 
Notation, is simply a terse way of storing javascript objects. In many programming languages, 
to create an object you must first create a variable and then create the children 
of that variable independently. For example, you could define an 
object named 'o'&nbsp; in javascript like this:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = new Object();<br>
o.firstName = 'Selwyn';<br>
o.lastName = 'Rabins';</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">Using this method, the children of the 'o' object 
			would need to be created one by one; each one including the name of 
			its parent object. This results in a lot of code that is often difficult to interpret. 
			In this case the object 'o' has a very simple name. However, it is 
			not be hard to imagine situations in which the object name is much 
			longer or where the programmer wants a child of the object to be an 
			array or an object in and of itself. JSON provides a compelling 
			alternative that makes this task straightforward. Rather than define 
			each child individually, all of the children that belong to an 
			object are enclosed in curly brackets. Each child in the object, 
			except for the last child, is then delimited using a comma.&nbsp;
			</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = {<br>
firstname: 'Selwyn',<br>
lastName: 'Rabins'<br>
}</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">The simplicity of JSON's format has made it 
			ubiquitous in Web application development. JSON is very frequently used for data storage, where 
			it is gaining in popularity over xml, and many websites return data in JSON format. 
			This makes it possible, for example, to pull news stories off the 
			web in json format, work with apps like twitter, or call external servers 
and ask for things. Once you acquire this JSON it is then very easy to 
			manipulate. Among other things you can filter out fields, add 
			fields, or extract an individual element from the data. JSON is the ideal way for sending 
			complex data from the client to the server, or from the server to 
			the client. Having a good understanding of JSON is therefore very 
			helpful in building web applications.</font></p>
			<p>&nbsp;</p>
			<p><font size="2">In the javascript language JSON is processed 
			inline. This means that you can use JSON in javascript and it will 
			be automatically recognized by the javascript engine. You can add 
			objects, arrays, and literal values to your JSON data, write some 
			javascript code to build a given part of an object, and it will just 
			work. When the javascript engine comes across any JSON data it knows 
			that a sub-object is a sub-object, an array is an array, and a 
			literal value is a literal value. You do not have to parse JSON in 
			javascript. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Most of Alpha Anywhere's server-side code is 
			written in Xbasic, a language that does not support JSON natively. 
			However, Alpha Anywhere does support a lot of methods that work with JSON 
			and allow you to both import and export JSON to and from your 
			components. How do these methods work? When you create a JSON 
			object, the children of that object are read in Xbasic as a string. 
			The Xbasic methods then take that string, work against it, and return 
			either JSON or Xbasic. Alpha Anywhere's set of methods can do the 
			same thing for Xbasic objects, returning either JSON or Xbasic. This 
			gives you the ability to parse a string into an object and an object into a string. 
			For example, take the following Xbasic object:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
dim o.firstName as c = &quot;Selwyn&quot;<br>
dim o.lastName as c = &quot;Rabins&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
<p>&nbsp;</p>
<p><font size="2">You could create an 'o' object like the one above in Xbasic. 
It would work, but you would end up having to write a lot of unnecessary code 
for each of the 'o' parent object's children. Include Alpha Anywhere's JSON 
parse method, and you can easily simplify things by placing the data for 'o' 
object's children into a JSON format:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
o = json_parse(&quot;{firstName: 'Selwyn', lastName: 'Rabins'}&quot;)</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p align="left">&nbsp;</p>
			<p align="left">&nbsp;</p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<h1>&nbsp;</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>&nbsp;</h1>
<h1><a name="Using JSON with Xbasic">Using JSON with Xbasic</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The example below demonstrates how you can apply this 
			information in building a <font color="#0000FF">UX component</font> 
			using Xbasic on the server-side that uses JSON.&nbsp; To be used as 
			Xbasic, JSON needs to be a string. For more information you can follow 
			this video </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_1.swf">
								<font size="2"><u>here</u></font></a><font size="2">.
			</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Create JSON from Xbasic:</b></p>
<p>&nbsp;<br>
								1. In Alpha Anywhere's toolbar click on the
<font color="#0000FF">Interactive Window</font> button. This will open the Code 
editor.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive.png" width="241" height="53"></p>
<p>&nbsp;</p>
<p>2. In the Code Editor, go to the <font color="#0000FF">Interactive</font> tab 
and define the following dot variable name 'pp' by entering this code. This is 
an Xbasic object. Hit <font color="#0000FF">Enter</font> at the end of every 
line.</p>
<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>3. Now add <i>?json_generate(pp)</i> to the end of the pp object. Hit
<font color="#0000FF">Enter</font> again.</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
						<p><font size="2" color="#333300">?json_generate(pp)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>4. You should see a generated JSON representation of the pp object. You have 
succesfully serialized the 'pp' 
object into a JSON string.</p>
<p>&nbsp;</p>
			
<p align="center">
<img border="0" src="images/interactive2.png" width="295" height="195"></p>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">In <font color="#0000FF">JSON</font> objects start 
			with a curly bracket and end with a closed curly bracket. Inside the 
			object are name value pairs. All property names are double quoted. 
			In this object, for example, the property names are &quot;Name&quot;, &quot;Age&quot;. 
			JSON can also encode the logical values true and false. Add a new 
			'Married' property to your Xbasic code and set it to true <i>'pp.Married 
			= .t.'</i>.</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
						<p><font size="2" color="#333300">pp.Married = .t.</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">Now run this object again using ?json_generate(pp). 
			The generated JSON should look like this:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">= {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : 
true</font></p>
<p><font size="2" color="#333300">}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">In addition to creating JSON data from Xbasic you 
			can also instatiate an object from a JSON string. The following 
			example will demostrate how.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Create Xbasic from JSON:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive.png" width="241" height="53"></p>
<p>&nbsp;</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button on the top 
left of the Code Editor's toolbar.</p>
<p align="center"><br>
<img border="0" src="images/interactive3.png" width="253" height="105"></p>
<p align="left">3. This will open a new tab in the Code Editor. Enter the 
following code. Hit <font color="#0000FF">Enter</font> after every line.</p>
<p align="left">&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">dim txt as c </font> </p>
<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
<p><font size="2" color="#333300">{</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : true</font></p>
<p><font size="2" color="#333300">}</font></p>
<p><font size="2" color="#333300">%str%</font></p>
<p><font size="2" color="#333300">dim pp2 as p</font></p>
<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
<p><font size="2" color="#333300">debug(1)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<table border="1" width="100%" style="border-width: 0px">
				<tr>
					<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br>
						<font size="2"><b>Note:</b> In Xbasic the angle bracket, angle bracket 
						&lt;&lt; defines a string whose definition expands over 
multiple lines. Here we have defined all of our JSON data as an xbasic string 
						and have given that string a variable name of 'txt'. A 
						Xbasic object named pp2 is then created that takes as 
						its value the parsed txt variable.</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>4. The <i>debug(1)</i> has been added to the end of this code so we can see 
the JSON data in the debugger. Click the<font color="#0000FF"> lightning bolt</font> 
in the toolbar to run the code.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive4.png" width="259" height="67"></p>
<p>&nbsp;</p>
<p>5. The<font color="#0000FF"> Xbasic debugger</font> will open. Type '<i>pp2</i>' 
into the <font color="#0000FF">Expression</font> entry box at the bottom of the 
debugger. </p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive5.png" width="177" height="93"></p>
<p align="left">6. Hit <font color="#0000FF">Enter</font> and then click the
<font color="#0000FF">expand</font> or 'plus' button
<img border="0" src="images/expand.png" width="9" height="9">, to the left of the 
Expression box, to show all of the JSON data in the pp2 object.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive6.png" width="240" height="77"></p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive7.png" width="255" height="116"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>


<h1><a name="JSON and Sub-Objects">JSON and Sub-Objects</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The previous example showed how to parse a string 
			containing JSON data that contained simple literal values. However, 
			what if you wanted 
			to create sub-objects within your data? As the objects in the 
			examples above demonstrate, all properties in JSON are delimited 
			with a comma; except for the last property which has nothing after 
			it. As long as a property is delimited and has a property name in 
			double quotes followed by a colon, the definition can be an object, 
			array, or literal. To see how to create a sub-object in JSON that 
			can be used with Xbasic watch this
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_2.swf">
								<u>video</u></a>, or follow the guide below.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Creating a Sub-Object in JSON to use with Xbasic:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button
<img border="0" src="images/newpage.png" width="14" height="15"> on the top 
left of the Code Editor's toolbar.</p>
<p>3. Enter the same code into the Code Editor that you did in step 3 of the 
'<i>Create Xbasic from JSON</i>' example. The code should look like this.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive8.png" width="270" height="186"></p>
<p align="center">&nbsp;</p>
<p align="left">4. Now place a comma after the &quot;<i>Married</i>&quot; property. Hit 
enter and on the line below the &quot;<i>Married</i>&quot; property add a new property 
name called &quot;<i>Address</i>&quot;.</p>
<p>5. <font size="2">Place a colon next to the 'Address' and a set of curly 
brackets. Inside the brackets add three more properties; a &quot;Street&quot; property, 
			&quot;Number&quot; property, and a &quot;City&quot; property, </font></p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<blockquote>
	<p><font size="2" color="#333300"><br>
	dim txt as c </font> </p>
	<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
	<p><font size="2" color="#333300">{</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Name&quot;: &quot;Fred&quot;,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Age&quot;: 30,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Married&quot; : true,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Address&quot; : {</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </font> </p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Number&quot; : 123,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;City&quot; : &quot;Boston&quot;</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	}</font></p>
	<p><font size="2" color="#333300">}</font></p>
	<p><font size="2" color="#333300">%str%</font></p>
	<p><font size="2" color="#333300">dim pp2 as p</font></p>
	<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
	<p><font size="2" color="#333300">debug(1)</font></p>
</blockquote>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
			<p>&nbsp;</p>
<p>6. Now click the <font color="#0000FF">lightning bolt</font> icon
<img border="0" src="images/lightning.png" width="16" height="15"> in the Alpha 
Anywhere toolbar to run this code. The debugger should open. type pp2 into the 
Expression entry box at the bottom of the debugger and hit <font color="#0000FF">
Enter</font>.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive9.png" width="398" height="70"></p>
<p align="center">&nbsp;</p>
<p>7. Click the <font color="#0000FF">Expand</font> or plus button
<img border="0" src="images/expand.png" width="9" height="9"> to the right of 
the Expression entry.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive10.png" width="466" height="113"></p>
<p align="center">&nbsp;</p>
<p align="left">8. Click on the <font color="#0000FF">Address</font> value to 
expand the Address sub-object that you defined. You should see all of the JSON 
data from the sub-object you defined inside of your Xbasic code.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive11.png" width="350" height="88"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="JSON and Arrays">JSON and Arrays</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p><font size="2"><font color="#0000FF">Arrays</font> in JSON start with a 
square bracket <font color="#0000FF">[ </font>and end with a square bracket
<font color="#0000FF">]</font>. JSON arrays are base 0, meaning the first 
element in a JSON array is 0, the second element is 1, the third element is 2, 
and so on. This is different from Xbasic which is base 1. Arrays can contain 
literal values or objects themselves. This example will show how to add an array 
property to your JSON data named &quot;Children&quot;, to be used in an Xbasic object 
named pp2. This array will use objects as its elements. The first element in the 
array will be this object <i>{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3} </i>which has the 
&quot;Name&quot; of &quot;John&quot; and an &quot;Age&quot; of 3. Like all objects, each of the properties 
within this object are delimited by a comma, with the exception on the last 
property in the object. For more information on the steps that follow watch this&nbsp;</font><a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_3.swf"><font size="2"><u>video</u></font></a></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Creating an Array in JSON to use with Xbasic:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button
<img border="0" src="images/newpage.png" width="14" height="15"> on the top 
left of the Code Editor's toolbar.</p>
<p>3. Enter the following code into the New Script page in the Code Editor.</p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p><font size="2" color="#333300"><br>
dim txt as c </font></p>
<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
<p><font size="2" color="#333300">{</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Married&quot; : true,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Address&quot; : {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Number&quot; : 123,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;City&quot; : Boston</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
<font size="2">&nbsp;&quot;Children&quot; : [</font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3}</font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
]</font></p>
<p><font size="2" color="#333300">}</font></p>
<p><font size="2" color="#333300">%str%</font></p>
<p><font size="2" color="#333300">dim pp2 as p</font></p>
<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
<p><font size="2" color="#333300">debug(1)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
<p>&nbsp;</p>
<p>4. Create two more elements for the &quot;Children&quot; array. As with objects, each 
element in the array should have a <font color="#0000FF">trailing comma</font>; 
excepting the last element which has no comma. The result should look something 
like this:</p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p>&nbsp;</p>
<p><font size="2" color="#333300">&quot;Children&quot; : [</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Sally&quot;, &quot;Age&quot; : 5},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Kim&quot;, &quot;Age&quot; : 7}</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
]</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
			<p>&nbsp;</p>
<p>5. Now click the<font color="#0000FF"> lightning</font> icon in the toolbar 
and run the code. The <font color="#0000FF">Debugger</font> should open. Enter 
pp2 into the <font color="#0000FF">Expression</font> box at the bottom on the 
debugger.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/array1.png" width="446" height="70"></p>
<p align="center">&nbsp;</p>
<p align="left">6. Click the <font color="#0000FF">Expand</font> or 'plus' 
button next to the Expression box to see all of the properties in the pp2 
object.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/array2.png" width="482" height="136"></p>
<p>&nbsp;</p>
<p>7. Click on the <font color="#0000FF">Children</font> array property that you 
defined. The elements within that property will be displayed.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/array3.png" width="328" height="90"></p>
<p align="center">&nbsp;</p>
<p align="left">8. Now click on one of the elements in your Children array in 
the <font color="#0000FF">Value</font> list. You should be able to see the 
object properties for each element.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/array4.png" width="255" height="68"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">This example has shown how to create a complex Xbasic 
			object using data parsed from JSON that includes an array. You can 
			also pass things from Xbasic into JSON using <i>json_generate()</i>. 
			Here is How.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Show your Xbasic object's data in JSON form:</b></p>
<p>&nbsp;</p>
<p>8. Remove the <i>debug(1)</i> line in your code and add this to the end 
instead. This code will output the JSON from the pp2 Xbasic object using the <i>
json_generate()</i> method. The <i>showvar()</i> method will display the result.</p>
<p>&nbsp;</p>
<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p>&nbsp;</p>
<p><font size="2" color="#333300">dim txt2 as c<br>
txt2 = json_generate(pp2)<br>
showvar(txt2)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>		
			
			
			
			
<p>9. Click the lightning icon
<img border="0" src="images/lightning.png" width="16" height="15"> to
<font color="#0000FF">run</font> the code. A Variable dialog will open 
displaying the pp2 objects data in JSON form. The result should look something 
like this:</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/array5.png" width="283" height="465"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON with Javascript">Using JSON with Javascript</a></h1>
<p>&nbsp;</p>



<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">So far, this guide has shown how to serialize 
			objects, but you can also use Javascript on the client-side to work 
			with JSON. This example will demonstrate how you can incorporate 
			JSON into a UX component and then manipulate the JSON data using 
			Javascript. For more information watch this video
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_4.swf">
								<u>Part 1</u></a> and </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_5.swf">
			<font size="2"><u>Part 2</u></font></a><font size="2">. To recap, we have 
			covered the following about JSON objects so far. A JSON object 
			starts and ends with curly brackets and has as many name value pairs 
			as you want within those 
			curly brackets. Each name value pair is delimited with a comma. Each 
			entry can be an array, a literal, or an object. In this way it is 
			possible to represent a very 
			complex object using JSON while still maintaining the ability to 
			easily read and understand it</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Output a JSON on the Client-side in a UX Component:</b></p>
<p><br>
								1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the Start with a blank UX Component radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs4.png" width="163" height="173"></p>
<p align="center">&nbsp;</p>
<p>4. On the Controls page, open the <font color="#0000FF">Other Controls</font> dropdown that appears 
in the Design menu. Double click on the <font color="#0000FF">[Button]</font> 
control option to add it to your UX component.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs7.png" width="201" height="116"></p>
<p align="center">&nbsp;</p>
<p>5. Add a
<font color="#0000FF">[Static text:]</font> control to your component in the same 
way. </p>
<p>6. You can arrange the controls using the up and down arrows in the toolbar such that 
they go <font color="#0000FF">[Button], [Static Text:].</font></p>
<p align="center"><br>
<img border="0" src="images/jsonjs8.png" width="268" height="58"></p>
<p align="center">&nbsp;</p>
<p>7. Click on the <font color="#0000FF">[Button] </font>control in your list to highlight it. Go over 
to the Control Properties list to the Right. Find Button Properties.</p>
<p>8. In the Button Properties section find the <font color="#0000FF">Button text</font> property and change 
the button text to 'Objects'.</p>
<p>9. Scroll down the Properties list until you reach the <font color="#0000FF">Javascript 
(Touch. Mouse. Pointer Events)</font> section. 
Click the button <img border="0" src="images/abutton.png" width="15" height="14"> next to the <font color="#0000FF">click</font> property.</p>
<p>10. The <font color="#0000FF">Edit Click Event</font> dialog will open. Click 
the <font color="#0000FF">Text mode</font> radio button. In the Javascript 
Attribute work area write <i>objectsTest(); </i>and click <font color="#0000FF">
Save</font>. </p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs9.png" width="303" height="162"></p>
<p>&nbsp;</p>
<p>11. Now Click on the <font color="#0000FF">[Static Text:]</font> control that you created. In the 
Properties menu under Static Text Properties find the Static text property.</p>
<p>12. Next to the Static text property enter the following html <i>&lt;div 
id=&quot;msg1&quot;&gt;&lt;/div&gt;</i>.</p>
<p align="center">
<img border="0" src="images/jsonjs2.png" width="313" height="64"></p>
<p>&nbsp;</p>
<p>13. Still in the Controls page, find the Code dropdown in the menu and under 
it click the <font color="#0000FF">Javascript functions</font> option. Enter the 
following code to define the <i>objectsTest()</i> function.<br>
&nbsp;</p>
		

		<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p><font size="2" color="#333300"><br>
function objectsTest() {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var obj = {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Firstname&quot; : &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Lastname&quot; : &quot;Smith&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Children&quot; : [</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 10},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
<p>&nbsp;</p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var msg = JSON.stringify(obj);</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; $('msg1').innerHTML = msg;&nbsp;&nbsp;
</font></p>
<p><font size="2" color="#333300">}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>
			
			
			
			
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Note:</b> Here we have designed a button that will create an object in Javascript, serialize 
			that object to JSON, and then print the JSON data out. The <i>var 
			obj</i> is a javascript variable object that is initialized by 
			passing into it a JSON string. This is the
			equivalent on the Xbasic side to using JSON parse to instantiate an xbasic 
			object from a JSON string. In this example we are initializing an 
			object using an object literal. An object literal and JSON look 
			similar but are not technically identical. Our object literal 
			contains a <i>Firstname</i> property, <i>Lastname</i> property, and 
			a <i>Children</i> property which is an array containing additional 
			object properties. After defining the object literal, a call javascript method,
			<i>JSON.stringify()</i>, is used to 
			serialize the object into a string with the name <i>msg1</i>. Using 
			innerHTML, this <i>msg1</i> string is then inserted into the text of 
			the div that we defined for the [Static text] control in our 
			component. This means that when the <i>'Objects'</i> button is 
			clicked, using javascript, the [Static text] control will be filled 
			in with html that displays the JSON data. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">&nbsp;</p>
<p align="left">14. Go to <font color="#0000FF">Working Preview</font> and click 
on the '<font color="#0000FF">Objects</font>' button.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs.png" width="594" height="69"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="left"><b>Create a Button that Parses JSON data:</b></p>
<p align="left">&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p align="left">4. On the Controls page, go to the <font color="#0000FF">Data Controls</font> 
dropdown section in the design menu and double click on the
<font color="#0000FF">[TextArea]</font> control option. </p>
<p align="center">
<img border="0" src="images/jsonjs5.png" width="252" height="95"></p>
<p align="center">&nbsp;</p>
<p align="left">5. In the <font color="#0000FF">New Control</font> dialog that opens select
<font color="#0000FF">'Create a single new control'</font>. Give the control the
<font color="#0000FF">Name</font> <i>jsonIn</i> and the <font color="#0000FF">
Label</font> <i>Json In</i>. Under Data Type select <font color="#0000FF">
Character</font> and click <font color="#0000FF"><u>O</u>K</font>.</p>
<p align="center">
<img border="0" src="images/jsonjs6.png" width="220" height="215"></p>
<p align="center">&nbsp;</p>
<p align="left">6. On the Controls page, open the <font color="#0000FF">Other Controls</font> dropdown that appears 
in the Design menu. Double click on the <font color="#0000FF">[Button]</font> 
control option to add it to your UX component.</p>
<p>7. Select the<font color="#0000FF"> [TextArea]</font> control that you 
labeled <i>Json In</i>. Look to the right. In the <font color="#0000FF">Field 
properties</font> section inside the Control Properties list, find the
<font color="#0000FF">Default value</font> property.</p>
<p>9. Change the Default value to be this string of JSON.</p>
<p>&nbsp;</p>
			
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<p><br>
						<font size="2" color="#333300">{&quot;Firstname&quot; : &quot;Fred&quot;,&quot;Lastname&quot; 
						: &quot;Smith&quot;,&quot;Children&quot; : [{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 
						10},{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}]}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>10. Select the<font color="#0000FF"> [Button]</font> control in the control list. In the Properties list on the right find the 
<font color="#0000FF">Button Properties</font> section.</p>
<p>11. In the Button Properties section, change the <font color="#0000FF">Button text</font> property to read 
Parse JSON.</p>
<p>12. Scroll down to the <font color="#0000FF">Javascript (Touch. Mouse. Pointer Events)</font> properties 
section and click the button next to the 'click' property.</p>
<p>13. The Edit Click Event Editor will appear. Click on the Text Mode radio 
button. In the Javascript Attribute work area type <i>parseJSON(); </i>and click
<font color="#0000FF">Save</font>.</p>
<p>14. In the design menu open the <font color="#0000FF">Code</font> dropdown 
and click on the Javascript functions option. Under the <i>objectsTest()</i> 
function that you defined earlier write the following code.</p>
<p>&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><font size="2" color="#333300"><br>
			function parseJSON()&nbsp; {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var json = {dialog.object}.getValue('jsonIn')</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var obj = JSON.parse(json);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(obj 
	['Children'][1]['Name']);</font></p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Note:</b> Just like on the Xbasic side where we use 
			json_parse and json_generate there exists similar features in 
			javascript on the client-side. In this example, the parse JSON 
			button is taking a string of JSON from a text area field , parsing it , 
			and then doing an alert from the name field of the second item in the 
			children array. Square brackets are used for syntax in order to read a value 
			in the 'Children' array, that was defined in our JSON data . You can 
			also use dot notation to accomplish this, for example obj.children. 
			The [1] next to the Children array indicates that we are calling the 
			second element of that array. Javascript arrays are zero based, 
			meaning the first item in the 
			array is always 0 the second item is 1. The second element, in the 
			JSON data here, is an object containing a &quot;Name&quot; property, &quot;Joan&quot;, 
			and an &quot;Age&quot; property, '12'. The ['Name'] that follows the [1] in 
			our code means that we are only interested in returning the &quot;Name&quot; 
			property. When you run this component and click the parse JSON button, 
			an alert should return &quot;Joan&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p align="left">15. Now go to Working Peview and click the Parse JSON button. 
You should see an alert pop up giving you the name of the second element in the 
Children array from the JSON data you defined for the Text area control.</p>
<p>&nbsp;</div>			
			
			
			
<p align="center">
<img border="0" src="images/jsonjs3.png" width="458" height="205"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON to send Data between a Client and Server">Using JSON to send Data 
from Client to Server</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">JSON is useful for passing information form the 
			client to the server.&nbsp; One way to accomplish this is by passing 
			information into an Ajax callback. You might have a button that is tied to an AJAX callback which 
turns around and calls up some Xbasic. You might then add some of Alpha 
			Anywhere's JSON functions to that Xbasic to allow you to go out and get JSON data from an external source and then 
return that data as Xbasic into your component.</font></p>
			<p>&nbsp;</p>
<p><font size="2">Xbasic is currently the coding language on the 
server. Sometimes you need to turn that into something the client side browser 
can recognize, that is going to be Javascript. The easiest way to get into the client is 
through Javascript. When someone 
clicks a button do an ajax callback, that callback is handled in Xbasic, which does 
some manipulations and then returns an object to the 
client browser in the form of a string. The browser, which&nbsp; is waiting for the response, 
then takes that object and generates some actual JSON, that it returns to the client.
</font></p>
			<p>&nbsp;</p>
			<p><font size="2">When you want to parse a complex set of data, you can parse JSON data back into 
			an ajax 
			callback and, on the Xbasic side, parse that data and extract values 
			from it. For more information watch these videos
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_5.swf">
								<u>Part 1</u></a> and
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_6.swf">
								<u>Part 2</u></a> or follow the examples below.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p align="left">4. On the Controls page, go to the <font color="#0000FF">Data Controls</font> 
dropdown section in the design menu and double click on the
<font color="#0000FF">[TextArea]</font> control option. </p>
<p>5. In the <font color="#0000FF">New Control</font> dialog that opens select
<font color="#0000FF">'Create a single new control'</font>. Give the control the
<font color="#0000FF">Name</font> <i>jsonIn</i> and the <font color="#0000FF">
Label</font> <i>Json In</i>. Under Data Type select <font color="#0000FF">
Character</font> and click <font color="#0000FF"><u>O</u>K</font>.<br>
								&nbsp;</p>
<p>6. Select the<font color="#0000FF"> [TextArea]</font> control that you 
labeled <i>Json In</i>. Look to the right. In the <font color="#0000FF">Field 
properties</font> section inside the Control Properties list, find the
<font color="#0000FF">Default value</font> property.</p>
<p>7. Change the Default value to be this string of JSON.</p>
<p>&nbsp;</p>
			
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<p><br>
						<font size="2" color="#333300">{&quot;Firstname&quot; : &quot;Fred&quot;,&quot;Lastname&quot; 
						: &quot;Smith&quot;,&quot;Children&quot; : [{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 
						10},{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}]}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>
								<br>
								8. On the <font color="#0000FF">Controls</font> page, open the 
			<font color="#0000FF">Other Controls</font> 
dropdown in the menu and double click on <font color="#0000FF">[Button]</font> control to add it to the UX 
component.</p>
<p>9.&nbsp; With the Button control selected, look in the control 
<font color="#0000FF">Properties</font> list 
on the right. Under the <font color="#0000FF">Button Properties </font>section, find the 
<font color="#0000FF">Button text</font> 
property.</p>
<p>10. Change the Button text property to read 'Make and Ajax Callback'</p>
<p>11. Scroll down the Properties list until you reach the <font color="#0000FF">Javascript (Touch. Mouse. Pointer Events)</font> section. 
Click the button next to the <font color="#0000FF">click</font> property.</p>
<p>12. The <font color="#0000FF">Edit onClick Event </font>dialog will open. Select the 
<font color="#0000FF">Action Javascript</font> radio 
button option at the top and click the <font color="#0000FF">Add New Action</font> button.</p>
<p>13. In the Action Javascript Select and Action dialog select 
<font color="#0000FF">Action Callbacks</font> <font color="#0000FF">and Javascript</font> from the Categories list on the left.</p>
<p>14. From the<font color="#0000FF"> Actions:</font> list on the right select<font color="#0000FF"> Ajax Callback</font>. And click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback.png" width="381" height="64"></p>
<p align="center">&nbsp;</p>
<p align="left">15. An <font color="#0000FF">Action Javascript Ajax Callback</font> dialog will open. </p>
<p align="left">16. In the <font color="#0000FF">Ajax Callback</font> section of the dialog, leave the
<font color="#0000FF">Callback type</font> property set to <font color="#0000FF">
InternalXbasicFunction</font> and type <i>xb</i> next to the
<font color="#0000FF">Function name</font> property.<br>
								17. In the Advanced section of the dialog, find 
the <font color="#0000FF">Additional data to submit</font> property and next to it type <i>additionalAjaxData()</i>. 
Click <font color="#0000FF">OK</font>,<font color="#0000FF"> OK</font>, and
<font color="#0000FF">Save</font>.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback2.png" width="515" height="178"></p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Note: The <font color="#0000FF">Additional data to submit</font> property 
			represents the data that is going to be submitted from the client 
			side to the server side. This property allows you to use an xbasic 
			function to return data. You can specify additional data to submit 
			in the Action Javascript Ajax Callback genie. This data will be 
			available inside your custom event handler, in this case the click 
			event. What is expected from the Additional data to submit property 
			is a Query string, name value pairs delimited with an &amp; sign, type 
			in a Review help text in Action Javascript Ajax Callback Action. 
			This feature is useful when you want to arbitrary information 
			generated on the client side. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">18.&nbsp; Click on the <font color="#0000FF">Code</font> 
dropdown and select <font color="#0000FF">Javascript functions</font>. In the 
Javascript workspace add the following code. </p>
<p align="left">&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p align="left"><font size="2" color="#333300">function 
			additionalAjaxData() {</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			var json = {dialog.object}.getValue('jsonIn');</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			//return '__additionalData=' + json;</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			var data = A5.ajax.buildURLParam('__additionalData',json);</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			return data;</font></p>
			<p align="left"><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>



<p align="left">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Note: All we are going to do is read the value that is in 
			the text area field and send back to the server a name value pair 
			formatted like a query string. The important part here is that the 
			value part of the name value pair needs to be URL encoded. Inside 
			the Alpha JS library there is a buildURL function that takes first 
			arg as name second arg as value. It then encodes that value.<br>
			Additional Ajax data simply does a return</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">&nbsp;</p>
<p align="left">19. From the Code dropdown click on the <font color="#0000FF">
Xbasic functions</font> option. Add the following Xbasic.</p>
<p align="left">&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function xb as c (e as p)</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim json as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; json = e.__additionalData</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim p as p 
			</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; p = json_parse(json)</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim msg as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; msg = &quot;Message from Xbasic. The name of the second 
	child is: &quot; + p.children[2].name</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim js as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; js = &quot;alert('&quot; + js_escape(msg) + &quot;');&quot;</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; xb = js</font></p>
			<p><font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">This code takes the string of JSON data that we 
			defined earlier and sends it back to the server as part of an ajax 
			callback. It then parses this information on the server using the 
			parse function. Afterward, it extracts the name field, from the second array item in the childrens array, 
			and uses this to construct an object that is fed into an alert message 
			and passed to the client. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Going line by line this is what this looks like. 
			The <i>xb</i> in this case is the actual Xbasic function that will handle 
			the Ajax callback. In the line <i>dim json as c,</i> we create an 
			Xbasic character variable called <i>json</i>. This variable is then 
			set to <i>= e.__additionalData</i>.&nbsp; The <i>e</i> is a pointer 
			variable that is passed into the <i>xb</i> function. It points to an 
			object that contains a property called <i>additionalData</i>, which 
			is a string that is sent back as part of the Ajax callback. The <i>p</i> 
			in the line <i>dim p as p</i> defines an second Xbasic pointer 
			variable that is set to <i>=json_parse(json)</i>. The <i>json_parse()</i> 
			function parses a string, in this case the <i>json</i> string that 
			we defined, in JSON format and returns an Xbasic variable. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Next we create a javascript 
			response to send back to the client. In <i>dim msg as c</i> we 
			create yet a third Xbasic variable, a character variable called <i>
			msg</i>, that contains a string and the second element of the 
			children array; the array that was included in the string that we 
			parsed. In Xbasic arrays are 1 based, meaning the first element in 
			the array is [1] and the second element is [2]. This is unlike 
			Javascript which is 0 based. When <i>msg</i> is defined it is then 
			passed into a <i>js</i> object that is tied to a javascript alert. When you return a string, 
			you need to make sure it is Javascript safe. In <i>dim js as c</i>, 
			a <i>js</i> object is created that is set to be an alert message 
			that to be sent back to the client. Xbasic still views this alert 
			message as a string, but javascript will interpret it as javascript. 
			The line <i>xb = js</i> is equivalent to a <i>return</i> statement 
			in javascript. In this case we are returning the <i>js</i> string to 
			the javascript that operates the client side code.<br>
			&nbsp;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>



<p align="left">&nbsp;</p>
<p align="left">20. Now go to Working Preview and click the Make Ajax Callback 
button. You should see something like this:</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback3.png" width="663" height="200"></p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p>
								<br>
<h1><a name="JSON and sending data from Server to Client">JSON and sending data from Server to Client</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			&nbsp;</p>
		<p>
						<font size="2">UX Component - Server Side Event Handlers - Data 
						Submitted&nbsp; - JSON - When the UX makes any type 
						of Ajax callback, the data that are submitted (including 
						data in Repeating Sections) are now available in a 
						property called</font></p>
		<p class="xbasic">
						<font size="2">e.dataSubmittedJSON</font></p>
		<p>
						&nbsp;</p>
		<p>
						<font size="2">For example, assume your UX had the following controls:</font></p>
		<p>
						<font size="2">Firstname, Lastname and a Repeating Section called 
						'CONTAINER_1' with AddressType and Address.</font></p>
		<p>
						<font size="2">The e.dataSubmittedJSON value might look like this:</font></p>
		<p class="xbasic">
						<font size="2">{ </font> </p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp; FIRSTNAME: 'Fred',</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp; LASTNAME: 'Smith',</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp; CONTAINER_1: [</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
						</font> </p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESSTYPE: 'Work',</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESS: '123 Main St'</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESSTYPE: 'Home',</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						ADDRESS: '456 Center St'</font></p>
		<p class="xbasic">
						&nbsp;</p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font></p>
		<p class="xbasic">
						<font size="2">&nbsp;&nbsp;&nbsp; ]</font></p>
		<p class="xbasic">
						<font size="2">}</font></p>
		<p>
						<font size="2">You can use the Xbasic JSON_Parse() function to parse 
						this JSON string.</font></p>
			<p>&nbsp;</p>
			<p>&nbsp;</p>
			<p>&nbsp;</p>
			<p><font size="2">In this example, look at how you can make a callback from the client 
			to the server to retrieve data from the server in JSON format and 
			then work with the data that was sent back from the server and 
			display it on the client. In some nicely formated html on the client 
			side</font></p>
			<p>&nbsp;</p>
			<p>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_7.swf">
			<font size="2">Watch Video - Part 1</font></a><font size="2"><br>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_8.swf">Watch Video - Part 2</a><br>
			</font>
			<font size="2">
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_9.swf">
			Watch Video - Part 3</a></font><br>
			<font size="2">
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_10.swf">
								Watch Video - Part 4</a></font></p>
		</blockquote>
		<p>&nbsp;</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Use JSON to send data from the Server to the Client:</b></p>
<p>&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p>4. Open the Other Controls dropdown and double click on [Button] to add a 
button to the UX component. </p>
<p>5. Click on the <font color="#0000FF">[Static Text]</font> control in the Other Controls dropdown to add a 
static text control to the UX component.</p>
<p>6. Select the Static test control and look at the Control Properties list. In 
the Static Text Properties section change the Static text property to this:</p>
<p>&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><br>
			<font size="2" color="#333300">&lt;div id=&quot;msg2&quot;&gt;&lt;/div&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>&nbsp;</p>
<p>7. Select the button that you added to you component. Go to the the 
Properties list on the right. </p>
<p>8. In the Button Properties section change the Button text property to read
<i>Fetch data from server</i>.</p>
<p>9. Go to the <font color="#0000FF">Javascript</font> <font color="#0000FF">(Touch. Mouse. Pointer Events)</font> 
section of the Properties list and 
choose the <font color="#0000FF">click</font> property</p>
<p>10. The Edit Click Event dialog will open. Leave the Action Javascript radio 
button selected.</p>
<p>11. Click the Add New Action button. The Action Javascript - Select an Action 
dialog will open.</p>
<p>12. In the Categories: list select Ajax Callbacks and Javascript option. In 
the Actions: list select Ajax Callback. Click OK.</p>
<p>13. The Action Javascript - Ajax Callback Action genie will appear. Set the<font color="#0000FF"> Function name</font> 
property to be 
xb2</p>
<p>14. Click the button
<img border="0" src="images/abutton.png" width="15" height="14"> next to the 
<font color="#0000FF">After callback complete Javascript</font> property. </p>
<p>15. The After Callback Complete Javascript dialog will open. Add a function 
called <i>expandTemplate(); </i>and click <font color="#0000FF"><u>O</u>K</font> 
and <font color="#0000FF"><u>O</u>K</font> and <font color="#0000FF"><u>O</u>K</font> 
again. <font color="#0000FF">Save</font>.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxserverclient.png" width="195" height="92"></p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p><font size="2"><b>Note:</b> As you probably know Ajax is asynchronos. In 
creating this Ajax callback this means that you can't have the function, <i>
expandTemplate()</i>, be triggered immediately. As a result, in this example you 
can not 
add more actions to the <font color="#0000FF">Edit Click Event</font> dialog 
unless you click the <font color="#0000FF">Run actions 
synchronously</font> button at the bottom of the dialog. In this example, we are 
leaving this unchecked.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>16. Open the Code dropdown and click on the Javascript functions page. Enter the following code:</p>&nbsp;

<div align="center">
<table border="1" width="9in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			//A5.u.element.setContent() is like setting the .innerHTML of ele, 
			but preserves drag scroll behavior</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, 'this is the expanded template');</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
			<p>&nbsp;</p>
		</blockquote></td>
	</tr>
</table>
</div>


<p><br>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2"><b>Note:</b> Instead of setting
								<i>.innerHTML</i> 
								directly we are using a helper function called
								<i>A5.u.element.setContent()</i>. This is the preferred way 
								of writing this code if there is a possibility that drag 
								scrolling is enabled. If the 
								element that you are setting the <i>.innerHTML</i> on 
								had grad scrolling enabled, and you set innerHTML 
								directly, it would destroy the drag scrolling 
								capability. Moving on, after the client receives 
								the data we want to format 
								it:</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</p>
<p>
								17. Save your Component and go to the
								<font color="#0000FF">Web Projects Control Panel</font>. 
								From the <font color="#0000FF">Tools</font> 
								dropdown select the <font color="#0000FF">Open Template Tester 
								window</font>.&nbsp; On JSON tab click 
								<font color="#0000FF">Load Example</font>.</p>
<p>
								18. From the Select Example list choose the 
								Simple object, simple template object. Click
								<font color="#0000FF"><u>O</u>K</font>.</p>
<p>
								19. Want JSON that is standards compliant. JSON 
								standard required double quotes. Highlight the 
								inserted JSON and hit the <font color="#0000FF">
								Reformat JSON</font> button.</p>
<p>
								20. Go to the Template page and change the html 
								to read the following:</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span style=&quot;color:blue;&quot;&gt;{lastname}&lt;/span&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								21.
								Click the <font color="#0000FF">Show Javascript</font> 
								button. This will show the Javascript 
								that takes data and expands the html. Copy 
								this javascript to the clipboard.</p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient2.png" width="520" height="231"></p>
<p align="center">
								&nbsp;</p>
<p>
								22. Go to the <font color="#0000FF">Code</font> 
								dropdown again and open Javascript functions.
								Paste the Javascript into the expandTemplate 
								function that you defined.</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 'Hello &lt;b&gt;{firstname}&lt;/b&gt; 
			&lt;span style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, 'this is the expanded template');</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								23.&nbsp; To get data returned by Xbasic 
								callback open the <font color="#0000FF">Xbasic 
								function</font> page from the Code dropdown 
								list. Enter the following code:</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2" color="#333300">function xb2 as c (e as p)</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
								</font> </p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
								delete p </font> </p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.firstname as c = &quot;Fred&quot;</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.lastname as c = &quot;Smith&quot;</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.date as c = &quot;&quot; + date()</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								json as c</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; json 
								= json_generate(p)</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								js as c</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js = 
								&quot;{dialog.object}._data = &quot; + json +&quot;;&quot;</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xb2 = 
								js</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2">In this code <i>dim json as c</i> 
								creates an Xbasic object. This object, <i>json</i>, 
								is then set to be <i>=json_generate(p)</i>. The 
								json_generate() function takes a variable, in 
								this case a variable called p, and returns JSON 
								data in this object in the form of a string. 
								Xbasic now has a string in Xbasic that can read 
								and manipulate. Next we create an Xbasic object 
								named <i>js</i>, in the<i> line dim js as c</i>, 
								and set this equal to xb2. This code effectively 
								places the JSON data inside a temporary 
								variable inside the UX component.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								24. Go to the <font color="#0000FF">Working 
								Preview</font> tab. Click the Fetch data from 
								server button.</p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient3.png" width="299" height="98"></p>
<p align="center">
								&nbsp;</p>
<p align="left">
								25. Now back to your Javascript functions page 
								and change the <i>expandTemplate()</i> function 
								to include <i>d = {dialog.object}._data; </i></p>
<p align="left">
								26. Also change<i> A5.u.element.setContent(ele, 
								'this is the expanded template')</i>; to read <i>&nbsp;A5.u.element.setContent(ele, 
								html)</i></p>
<p align="left">
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; _d = {dialog.object}._data;</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 'Hello &lt;b&gt;{firstname}&lt;/b&gt; 
			&lt;span style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, html);</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>

<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2">Using&nbsp;<i>A5.u.element.setContent()</i> 
								is like setting the <i>.innerHTML</i> of <i>ele</i>. 
								Unlike <i>.innerHTML</i>, <i>A5.u.element.setContent()</i> preserves 
								the drag scroll behavior. The <i>_d</i> in this 
								code represents the data that the template will 
								expand. Setting <i>_d</i> to <i>{dialog.object}._data;</i> 
								makes <i>_d</i> draw its data from the Xbasic 
								function definition we defined in step 23. When 
								you run the component now you should see that 
								the same data that is defined on the 
								server-side, i.e in Xbasic.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								27. Go to Working Preview and click the Fetch 
								data from server button again:</p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient4.png" width="298" height="100"></p>
<p align="left">
								&nbsp;</p>
<p align="left">
								28. Go back to the <font color="#0000FF">Design</font> 
								tab. To make sure that your code is calling data 
								from the server, reopen your Xbasic functions 
								page in the Code dropdown.</p>
<p align="left">
								29. Change the <i>&quot;Fred&quot; </i>and<i> &quot;Smith&quot; </i>
								in your xb2 function to something different, 
								like &quot;<i>Salmo</i>&quot; and <i>&nbsp;&quot;trutta&quot; </i>or 
								anything.</p>
<p align="left">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient5.png" width="481" height="294"></p>
<p align="center">
								&nbsp;</p>
<p align="left">
								30. In the Code dropdown open the Javascript 
								functions page again.</p>
<p>
								31. Now add something to consume the date. Change this 
								line of code <i>'Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span 
								style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</i> by 
								adding <i>'on {date}</i>.'</p>
<div align="center">
&nbsp;<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">'Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span 
			style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt; on {date}.'</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								32.
								Go to <font color="#0000FF">Working Preview</font> and click button.</p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient6.png" width="315" height="104"></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">To summarize, the Ajax Callback can be made to the server. 
			The server Xbasic is now free to use any Xbasic code that it wants to compute 
			data to send back to the server. Data that gets sent back is encoded 
			on the server-side into an Xbasic object, in this case a p variable. 
			This variable then gets converted into a JSON string which gets sent back 
			to the client</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
<h1><a name="JSON from the Server-side, and Advanced Templates">JSON from the Server-side and 
the Template Tester</a></h1>
<p>&nbsp;</p></p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<br>
			<font size="2">The client-side template tester 
			window is very useful in laying out JSON data on the client side. 
			The user interface for the Template Tester is resizable and has 
			separate tabs for <font color="#0000FF">JSON Data</font>, 
			<font color="#0000FF">Template</font>, <font color="#0000FF">Javascript</font> and 
			<font color="#0000FF">CSS</font>.
			As you edit in any of these windows the template preview is 
			automatically updated in the right part of the window. </font>
			<p>&nbsp;</p>
			<p><font size="2">While the Template Tester does help in presenting 
			JSON data from the server-side on the client, It is still necessary 
			to define some xbasic and javascript in order to use a specific set 
			of JSON data. When editing Xbasic or Javascript code, html, 
								and JSON it is often helpful to be able to see 
			the start and end of different opening and closing 'pair' 
			delimiters. For 
								example in an Xbasic function call, highlighting 
								the opening an closing parentheses. Or in a 
								Javascript function, highlighting the opening 
								and closing curly braces. In some HTML text, the 
								opening and closing tags (e.g. &lt;div&gt;, &lt;body&gt;, 
								&lt;p&gt; , etc.). Once a 'pair' has been identified, 
								keyboard shortcuts <font color="#0000FF">(Control&nbsp; ] and 
								Control-Shift ] )</font>&nbsp; allow you to quickly 
								move focus from the start of the 'pair' to the 
								end of the 'pair' or to select all of the text 
								inside the 'pair'. For more on this
			<a href="http://www.ajaxvideotutorials.com/V12Videos/code_editor_highlighting_pairs.swf">
			<u>watch this video</u></a><u>.</u></font><br>
&nbsp;</p>
			<p><font size="2">To follow the advanced example below watch the 
			following videos</font><a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_10.swf"><font size="2">
								<u>Part 1</u></font></a><font size="2">,
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_11.swf">
								<u>Part 2</u></a>,<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_12.swf">
								<u>Part 3</u></a>,
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_13.swf">
								<u>Part 4</u></a> or simply </font>
								<font size="2">
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json.zip">
								<u>download the component</u></a>.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient9.png" width="250" height="418"></p>
<p>
								&nbsp;</p>
<p>
								<b>Create JSON from the Server side presented in 
								an Advanced Template:</b></p>
<p>
								&nbsp;</p>
<p><font size="2">1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</font></p>
<p><font size="2">3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </font> </p>
<p><font size="2">4. Open the Other Controls dropdown and double click on<font color="#0000FF"> [Button]</font> to add a 
button to the UX component. </font> </p>
<p><font size="2">5. Click on the <font color="#0000FF">[Static Text]</font> control in the Other Controls dropdown to add a 
static text control to the UX component.</font></p>
<p><font size="2">6. Select the Static test control and look at the Control Properties list. In 
the Static Text Properties section change the Static text property to this:</font></p>
<p>&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><font size="2"><br>
			</font><font size="2" color="#333300">&lt;div id=&quot;msg3&quot;&gt;&lt;/div&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</div>


<p><font size="2">7. Select the button that you added to you component. Go to the the 
Properties list on the right. </font> </p>
<p><font size="2">8. In the Button Properties section change the Button text property to read
<i>Fancy Report</i>. Save your component.</font></p>
<p>
								<font size="2">9. In the Web Projects Control 
								Panel click on Tools and select the 
								<font color="#0000FF">Open Template Tester 
								window</font> from the dropdown.</font></p>
<p>
								<font size="2">10. Click Load Example. From the 
								list of choices select the '<i>Same as previous example, but 
								with CSS to style the output</i>' option.</font></p>
<p>
								<font size="2">11.
								Copy JSON data to the clipboard.</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient14.png" width="453" height="496"></p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			If you have completed the <a href="#JSON and sending data from Server to Client">
			JSON and sending data from Server to Client</a> guide you will 
			notice that this template contains slightly more complex JSON data. 
			As you can tell from the square starting brackets
			<font color="#0000FF">[ ]</font>, this JSON object is an array. Each item in the array is 
			filled with an object whose name starts with <i>'orderId:'</i>. The
			<i>orderItems</i> property inside this object is itself an array 
			that contains objects as properties. Because there is this much 
			nested data, computing this on the server is the appropriate thing to do. 
			We then want to consume the JSON data on client side and output html. 
			The
			Javascript function that gets called by the template
			Template uses some CSS, also defined in the genie, to
			take a simple example and expand it.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								<font size="2">12. Go back to&nbsp; your 
								component and, on the Controls page, select the 
								button control your created. </font></p>
<p>
								<font size="2">13. Scroll down the Properties 
								list to the<font color="#0000FF"> Javascript 
								(Touch, Mouse, Pointer Events)</font> section.</font></p>
<p>
								<font size="2">14. Click the button
								<img border="0" src="images/abutton.png" width="15" height="14"> 
								next to the <font color="#0000FF">click</font> 
								property.</font></p>
<p><font size="2">15. The Edit Click Event dialog will open. Leave the Action Javascript radio 
button selected.</font></p>
<p><font size="2">16. Click the Add New Action button. The Action Javascript - Select an Action 
dialog will open.</font></p>
<p><font size="2">17. In the Categories: list select Ajax Callbacks and Javascript option. In 
the Actions: list select Ajax Callback. Click <font color="#0000FF">OK</font>.</font></p>
<p><font size="2">18. The Action Javascript - Ajax Callback Action genie will appear. Set the<font color="#0000FF"> Function name</font> 
property to be xb3</font></p>
<p><font size="2">19. Click the button
<img border="0" src="images/abutton.png" width="15" height="14"> next to the 
<font color="#0000FF">After callback complete Javascript</font> property. </font> </p>
<p><font size="2">20. The <font color="#0000FF">After Callback Complete Javascript</font> dialog will open. Add a function 
called <i>expandTemplate2(); </i>and click <font color="#0000FF"><u>O</u>K</font> 
and <font color="#0000FF"><u>O</u>K</font> and <font color="#0000FF"><u>O</u>K</font> 
again. <font color="#0000FF">Save</font>.</font></p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<font size="2">
								<img border="0" src="images/ajaxserverclient7.png" width="225" height="84"></font></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">21. Go to the Code dropdown and 
								open the Xbasic functions page. Define a function called 
								<i>xb3</i> using the following code:</font></p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
<p>
								<font size="2" color="#333300"><br>
								function xb3 as c (e as p)</font></p>
<blockquote>
	<p><font size="2" color="#333300">dim json as c</font></p>
	<p><font size="2" color="#333300">json = &lt;&lt;%txt%</font></p>
	<p>&nbsp;</p>
	<p><font size="2" color="#808080">//Insert Template JSON here</font></p>
	<p>&nbsp;</p>
	<p><font size="2" color="#333300">%txt%</font></p>
	<p><font size="2" color="#333300">dim js as c</font></p>
	<p><font size="2" color="#333300">js = &quot;{dialog.object}._data2 = &quot; + json +&quot;;&quot;</font></p>
	<p><font size="2" color="#333300">xb3 = js</font></p>
</blockquote>
<p>
								<font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								<font size="2">22. Paste the JSON you copied 
								from the template into your <i>xb3</i> function 
								definition between <i>json = &lt;&lt;%txt%</i> and
								</font><i><font size="2">%txt%</font></i></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">Here we are using <i>&lt;&lt;%txt%</i> and
								</font><i><font size="2">%txt%</font></i><font size="2"> 
			delimeters. If you use the specify <i><font color="#0000FF">&lt;&lt;%json%... 
			%json%</font></i> delimiters to enter a long string of JSON data, 
			the Xbasic editor will perform real-time validation on the JSON 
			data. For example, in the image below, the JSON has an error because 
			of the trailing comma after the last property (age: 23). Notice the 
			squiggly red line indicating the error. </font></p>
			<p align="center">
			<img border="0" src="images/ajaxserverclient12.png" width="185" height="143"></p>
			<p align="center">&nbsp;</p>
			<p align="left"><font size="2">If you click on the error indicator 
			you will see the error message.</font></p>
			<p align="left">&nbsp;</p>
			<p align="center">
			<img border="0" src="images/ajaxserverclient13.png" width="347" height="65"></p>
			<p><font size="2"><br>
			in a realworld example you would do data querys to get the JSON 
			information<br>
			Take this JSON and put it into a temporary variable called _data2</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								<font size="2">23.
								Go to the Javascript functions page. Define the function 
								expandTemplate2() using this code.</font></p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate2() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; _d = {dialog.object}._data2;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; </font>
			<font size="2" color="#808080">//Insert Javascript here</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p>&nbsp;</p>
			<p><font size="2">&nbsp;&nbsp; </font> <font size="2" color="#333300">var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp; &nbsp;var ele = 
			$('msg3');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;A5.u.element.setContent(ele, 
			html);</font></p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								<font size="2">24. Go back to
								<font color="#0000FF">Open Template Tester 
								window</font> and click the
								<font color="#0000FF">Show Javascript</font> 
								hyperlink in the lower left of the dialog. Find 
								the template section of the javascript marked <i>
								var _t = [</i> </font></p>
<p>
								<font size="2">25. Copy the Javascript between&nbsp;<i>var 
								_t = [ </i>and <i>].join('');</i> in the
								<font color="#0000FF">Open Template Tester 
								window.</font> </font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient10.png" width="492" height="156"></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">26. Open the
								<font color="#0000FF">Javascript functions</font> 
								page in the Code dropdown. Paste the code you 
								copied inside the <i>expandTemplate2()</i> 
								function.<br>
								27.
								Go back to the <font color="#0000FF">Open Template Tester 
								window.</font> Open the <font color="#0000FF">Javascript</font> tab and copy 
								the javascript function displayed in the tab to clipboard.</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient11.png" width="512" height="77"></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">28. In your component, open the 
								Code dropdown in the Design tab. Go to the 
								Javascript functions page and paste the function 
								you copied above the <i>expandTemplate2()</i> 
								definition.</font></p>
<p>
								<font size="2">29. Open the
								<font color="#0000FF">Open Template Tester 
								window. </font>Click on the
								<font color="#0000FF">CSS</font> tab and copy 
								all of the CSS code.</font></p>
<p>
								30. Open your component page. <font size="2">Go to 
								the Properties page and find the CSS properties 
								section. </font></p>
<p>
								<font size="2">31. Click the button
								<img border="0" src="images/abutton.png" width="15" height="14"> 
								next to the <font color="#0000FF">Local CSS definitions</font>, 
								click the code tab at the bottom of the
								<font color="#0000FF">CSS Editor[]</font> and 
								paste all of your CSS inside the editor.</font></p>
<p>
								<font size="2">32. Now go to 
								<font color="#0000FF">Working Preview</font>. 
								You should see something like this:</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient8.png" width="727" height="537"></p>
<p>
								&nbsp;</p>
<p>
								<font size="2">33. Open your component and go to 
								the Xbasic functions page in the Code dropdown.
								</font> </p>
<p>
								&nbsp;</p>
<p>
								<font size="2">34.
								Try adding to or altering the JSON data that is 
								nested inside your Xbasic function.</font></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">To summarize, an ajax callback can go to the server, get a very 
			complex set of data represented as a JSON object, and send that data back 
			to the client. Then using the templating features on the client 
			side you can use that data to create a very rich layout from that 
			JSON data. JSON can 
			be used on the server side to serialize xbasic objects. You can use
			<i>json_generate</i> to serialize Xbasic objects into json data and 
			<i>json_parse</i> to parse json data back into xbasic objects. On 
			the client side 
			you can use <i>json_stringify</i> and <i>json parse</i> to serialize objects into json strings and to parse json strings into javascript objects. 
			json is the perfect mechanism for parsing information from the 
			client side to the server side or the server side to the client 
			side.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
								<h1><a name="JSON Functions and Special Flags">JSON Functions and Special Flags</a></h1></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
<p><font size="2">The javascript object notation that Xbasic uses to parse JSON 
is not as full as the javascript object notation that exists in Javascript 
itself.&nbsp; Javascript can process functions as properties directly from JSON. 
In comparison, Xbasic requires a string of JSON to be able to parse data, which 
it then feeds into a browser. Converting everthing, including all of the 
javascript extras, into string format prevents the JSON from blowing things up 
when it is used in Xbasic. On the other hand, not being able to use all of the 
types of data that can exist inside of JSON leads to a great loss in potential 
capability for an application. For example, say you had a completed date object in Javascript 
that was stored in JSON. If you transformed that JSON into a string, you would end with 
something that is transportable but that would not be transported. It would lose 
all functionality. The way Alpha Anywhere gets around this problem is through 
special Xbasic tags, flags, and nulls; markers that indicate logic that exists 
inside of JSON data. It is these flags that allow Xbasic to do everything with 
JSON that can be done in Javascript. Alpha Anywhere simply ooks for parts of 
			strings generated from JSON and, if it sees any, outputs 
			them as javascript. For example: Here <i>dim o as p</i> is an xbasic 
object. The <i>o.myFunc = &quot;function(){...}&quot;</i> defines a string </font></p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
			o.myFunc = &quot;function(){...}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p align="left"><font size="2">Below is the output from the <i>
			o.myFunc</i> function produced by <i>json_generate()</i>. As you can 
			see from the single quotes around <i>'function(){...}'</i>, the 
			output&nbsp; is a string. Even if the flag in the generate function 
			was false <i>.f.</i> you would get the same thing; a string will 
			produce a string. If you ran this in javascript it would also view 
			it as a string.</font></p>
			<p align="left">&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.t.)<br>
			&quot;{myFunc: 'function(){...}'}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p align="left"><font size="2">This is the same 'o' xbasic object 
			function. However, here the function is marked as a javascript 
			function. </font></p>
			<p align="left">&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			o.myFunc = &quot;{javascript}function(){...}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p align="left">&nbsp;</p>
			<p align="left"><font size="2">This time, when we run the function 
			in json_generate(), no single quotes appear. Javascript will view 
			this as a viable function.</font></p>
			<p><font size="2">&nbsp;</font></p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.t.)<br>
			&quot;{myFunc: function(){...}}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p align="left">&nbsp;</p>
			<p align="left"><font size="2">If you were to turn the boolean flag 
			in json_generate to false <i>.f.</i> then you would again end up 
			with a string, as shown below. This string would include the 
			bracketed <i>{javascript}</i> marker inside of it.</font></p>
			<p>&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.f.)<br>
			&quot;{myFunc: '{javascript}function(){...}'}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>
			
		</blockquote></td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>



<h1><a name="Interrogating JSON Data">Interrogating JSON Data</a></h1>
<p>&nbsp;</p>



<div id="yui_3_16_0_1_1445604035652_7023" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<font size="2" face="Verdana">
			<br>
			There are several ways to use Xbasic to extract information from 
			JSON data. </font>
			</blockquote>
		
		</td>
	</tr>
</table>
	<p>&nbsp;</p>
<blockquote>
	<p><b><font face="Verdana">For JSON data that contains objects:</font></b></p>
	<p>&nbsp;</p>
	<p><font face="Verdana"><font size="2">1. First define a JSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p>
</blockquote>
<div align="center">
	<table border="1" width="51%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						</font><font face="Verdana" size="2" color="#333300">dim 
						jso as extension::JSON</font></font></blockquote>
					</td>
				</tr>
			</table>
		<blockquote>
			<p align="left"><font size="2" face="Verdana">2. Next equate the  
		object with the JSON data you wish to query using <font color="#0000FF">setJson()</font>. 
			You can read this data in from a file. Here we are going against 
			JSON data that contains an object.</font></p>
	</blockquote>
	<font face="Verdana">
	<table border="1" width="51%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">jso.setJson(&quot;{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}&quot;)</font></font></font></blockquote>
					</td>
				</tr>
			</table>
		</div>
		
	<blockquote>
		<p>3. These different methods will return the following results:</blockquote>
<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p align="center"><br>
			<font size="2">&quot;{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
	<p align="center">&nbsp;</div>
<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<font face="Verdana" size="2">= &quot;john&quot;</font></blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<font face="Verdana" size="2">= &quot;public&quot;</font></blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.nameIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;firstname&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.nameIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;lastname&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getProperty(&quot;firstname&quot;)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;john&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getProperty(&quot;lastname&quot;)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;public&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.isArray()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= .F.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.isObject()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= .T.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
<blockquote>
	<p><br>&nbsp;<p><b>For JSON data that contains arrays:</b></p>
	<p>&nbsp;</p>
	<p><font size="2">1. First define an JSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p>
	<p>&nbsp;</p>
	
	<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">dim jsa as extension::JSON</font></font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
		<p><br><font size="2" face="Verdana">2. Next set the  
		object to be the JSON data that contains the array you wish to query using <font color="#0000FF">setJson()</font>. 
			You can also read this data in from a file. </font><br><br>&nbsp;<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">jsa.setJson(&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;)</font></font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
		<p><br>3. These different methods will return the following results.<p><br>&nbsp;
		
		<div align="center">
		<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p align="center"><br>
			<font size="2">&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>


	<p><br>&nbsp;<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= 4</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			&nbsp;<p><font face="Verdana" size="2">
			= &quot;one&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			&nbsp;<p><font face="Verdana" size="2">
			= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(2)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= .T.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2" color="#0000FF">
		jselem = jsa.getIndexed(3)</font></td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jselem.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jselem.getJson()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= {&quot;firstname&quot;:&quot;john&quot;,&quot;lastname&quot;:&quot;public&quot;}</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
	<font face="Verdana" size="2" color="#0000FF">
		jselem.setProperty(&quot;middlename&quot;,&quot;Q&quot;)</font></td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
	<font face="Verdana" size="2">
		? jselem.getJson()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">= {&quot;firstname&quot;:&quot;john&quot;,&quot;lastname&quot;:&quot;public&quot; 
			, &quot;middlename&quot; : &quot;Q&quot;}</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
</blockquote>
<p><br><br><br><br>

<h1><a name="BSON Queries and JSON">BSON Queries and JSON</a> </h1> 





<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<font size="2" face="Verdana">
			<br>
			</font><font size="2">BSON was created by the developers of Mongo 
			DB. BSON is JSON data that is converted to binary. </font>
			</blockquote>
		
		</td>
	</tr>
</table>
	<p>&nbsp;</p>
<blockquote>
	<p><b>Interrogating BSON data from JSON:</b></p>
	<p>&nbsp;</p>
	<p>1. <font size="2">First define an BSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p></blockquote>
<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
		<tr>
			<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
			<blockquote><font size="2"><br><font color="#333300">dim bso as 
				extension::BSON</font></font></blockquote></td>
		</tr>
	</table></div>
<blockquote>
	<p>2. <font size="2" face="Verdana">Next set the BSON object to include the 
	JSON data you wish to query using <font color="#0000FF">setJson()</font>. 
			</font><br>&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">bso.setJson(&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;)</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p><br>3. Call your BSON object as BSON data using <font color="#0000FF">getBson()</font>.<p>&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">dim </font>
					<font color="#0000FF">bs</font><font color="#333300"> as b = bso.getBson()</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>4. You can look at the binary:<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
				<font size="2"><br></font>
				<font color="#0000FF" face="Verdana" size="2">? bs</font></td>
			</tr>
		</table></div>
	<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">= 0000 : 4c 
					00 00 00 02 30 00 04 00 00 00 6f 6e 65 00 10 <br>
					0010 : 31 00 02 00 00 00 08 32 00 01 03 33 00 2e 00 00 <br>
					0020 : 00 02 66 69 72 73 74 6e 61 6d 65 00 05 00 00 00 <br>
					0030 : 6a 6f 68 6e 00 02 6c 61 73 74 6e 61 6d 65 00 07 <br>
					0040 : 00 00 00 70 75 62 6c 69 63 00 00 00 </font></font>
				</blockquote></td>
			</tr>
		</table></div>
	<p>
	<br>
	5. You can Query against this data as well.<br>
	
	
	<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? bs.size()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p>
	<font face="Verdana" size="2">
			= 76</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
	<p>
	<br>
	<b>Getting JSON Back from BSON:</b><br>
	<br>
	1. Define a JSON object that lives in the extension namespace inside of 
	Xbasic. Put BSON after extension. Only BSON knows how to deserialize BSON.<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">dim bso2 as 
					extension::BSON</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	2. Now set the JSON object against the BSON data you want to convert to JSON 
	using setBson().<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">
					bso2.setBson(bs)</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	3. Call your JSON object from the BSON data using getJson().<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">? 
					bso2.getJson()</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	4. Result.<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">= [ &quot;one&quot;, 
					2, true, { &quot;firstname&quot; : &quot;john&quot;, &quot;lastname&quot; : &quot;public&quot; } ]</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>&nbsp;<p>&nbsp;</blockquote>
</div>
<h1><a name="JSON Data Format with Custom Xbasic Functions">JSON Data Formatting 
for Custom Xbasic Functions</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<br>
			&nbsp;</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p></p>
<p>&nbsp;</p>
<p>When you specify a custom data source the following dialog appears:</p>
<p>You specify the name of an Xbasic function that will return the data to be 
printed by the report.</p>
<p>The Xbasic function can return data in one of two formats:</p>
<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	Delimited</li>
	<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
	JSON</li>
</ul>
<p>In both cases, the Xbasic function returns a string of data (that is either 
in delimited or JSON format - explained below).</p>
<p>The function prototype for the Xbasic function is (assuming you specified 
that the Function name was <font color="#0000FF" face="Courier New">
myDataFunction</font> in the <font color="#0000FF" face="Courier New">Function 
name</font> property in image shown above):</p>
<p>&nbsp;</p>
<p class="xbasic">function myDataFunction as c (e as p)</p>
<p class="xbasic">myDataFunction = &lt;&lt;%txt%</p>
<p class="xbasic">......the delimited, or JSON format data goes here</p>
<p class="xbasic">%txt%</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">end function </p>
<p>&nbsp;</p>
<p>Notice that the function takes a single input parameter,
<font color="#0000FF" face="Courier New">e</font>.</p>
<p>The <font color="#0000FF" face="Courier New">e</font> object that is passed 
into the function includes the value of any arguments that were passed into the 
report.</p>
<p>For example, assume that you specified that the Custom Data Source uses an 
argument called <font color="#0000FF" face="Courier New">whatCountry</font>. 
Your Xbasic function can reference the value in this argument as follows:</p>
<p class="xbasicSmall">dim country as c </p>
<p class="xbasicSmall">country = argVal(e.arguments,&quot;whatCountry&quot;)</p>
<p>&nbsp;</p>
<p><b>Understanding the Format of the JSON Data Your Custom Function Must Return</b></p>
<p>&nbsp;</p>
<p>The JSON data that your function returns can be <span class="xbasicSmallSpan">Simple</span> or <span class="xbasicSmallSpan">Complex</span>.</p>

<p><b>Simple JSON</b></p>
<p>For Simple JSON, the string that you return is just an <span class="xbasicSmallSpan">array</span> of JSON objects, For example:</p>

<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
[
	{"Firstname" : "Fred", "Lastname" : "Smith"},
	{"Firstname" : "Harry", "Lastname" : "Jones"}
]
%json%
end function 
</pre>

<p>&nbsp;</p>
<p>In this case since no schema is supplied the data are all considered to be character type of length 1024 characters. While the advantage of this format is
that is extremely simple, it does mean that you will need to adjust the size of each field you place on your report because its default size will likely be too large.</p>



<p><b>Complex JSON</b></p>
<p>For Complex JSON, the string that you return is an <span class="xbasicSmallSpan">object</span> with two properties, <span class="xbasicSmallSpan">schema</span>
and <span class="xbasicSmallSpan">data</span>. The <span class="xbasicSmallSpan">schema</span> object defines the schema of the data (for example, field type, size, etc.)
and the <span class="xbasicSmallSpan">data</span> property is an array of JSON objects that define the data for the report. For example:</p>

<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
	"schema" : { "firstname" : { "type" : "C" , "width": 30 } 
	           , "lastname" : { "type" : "C"  , "width": 30} 
	           , "company" : { "type" : "C"  , "width": 30} 
	           , "age" : { "type" : "N" , "width" : 3, "decimal" : 0 }
	},
	"data": 
		[
			{"firstname":"Fred", "lastname":"Smith", "company" : "Alpha Software", "age" : 30},
			{"firstname":"John", "lastname":"Jones", "company" : "Beta Software", "age" : 23}
		]
}
%json%
end function 
</pre>
<p>&nbsp;</p>
<p>In the above example, we have specified the size and type of each field in the <span class="xbasicSmallSpan">data</span> array. Notice that we have also specified the number of decimal places
for the numeric field.</p>

<p>The data types supported in the schema are: </p>

<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">C - Character (you must also specify a "width" property for this type)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">N - Numeric (you must also specify a "width" and "decimal" property for this type)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">L - logical</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">M - memo</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">D - date</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">T - date/time</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">Y - short time</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">E - exponent numeric</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">K - guid</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">JPEG - Jpeg field (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">PNG - PNG (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">BMP - BMP (data in the JSON data property is expected to be base64 encoded)</li>
<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">I - Image Reference Field (data in the data property is a image file name but the report will treat the data as an image).</li>
</ul>


<p class="note"><b>Note</b>: If you specify that a field uses the Date (D), 
Date/Time (T) or Short time (Y) format in the schema, the data in the data array 
must be a string in UTC date format. For example: 2014-10-27T23:06:50.361Z. The 
date part format is yyyy-mm-dd and the time part uses GMT. In the case of a 
Short time field, the date portion of the UTC date string is ignored.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The schema also allows you to extract data from objects within each row and to map property names in the <span class="xbasicSmallSpan">data</span> array to different names. 
For example in the data shown below, the address property is an object with two sub-properties. 
</p>

<pre class="xbasicSmall" xtag="">
{
   "name": "Fred Smith",
   "company" : "XYZ Corp",
   "address": {
       "street": "Main Street",
       "number": 23
    }
}
</pre>

<p>Shown below is how the function would be defined to return the JSON data. Notice that the JSON object has both a <span class="xbasicSmallSpan">schema</span>
and a <span class="xbasicSmallSpan">data</span> property. The schema indicates what fields will be available to the report. 
The list of fields specified by the schema are:
<span class="xbasicSmallSpan">name</span>, <span class="xbasicSmallSpan">companyName</span>, <span class="xbasicSmallSpan">street</span> and <span class="xbasicSmallSpan">number</span>. 
</p>
<p>Notice that the <span class="xbasicSmallSpan">data</span>
array does not have a property called <span class="xbasicSmallSpan">companyName</span>. It has a property called <span class="xbasicSmallSpan">company</span>. So the <span class="xbasicSmallSpan">schema</span>
property for the <span class="xbasicSmallSpan">companyName</span> field indicates that the <span class="xbasicSmallSpan">source</span> of this field is the <span class="xbasicSmallSpan">company</span>
property in the <span class="xbasicSmallSpan">data</span> array. Similarly, the <span class="xbasicSmallSpan">street</span> field in the <span class="xbasicSmallSpan">schema</span> is mapped to the 
<span class="xbasicSmallSpan">address.street</span> property in the <span class="xbasicSmallSpan">data</span> array.</p>

<p>If the definition for a field in the <span class="xbasicSmallSpan">schema</span> omits the <span class="xbasicSmallSpan">source</span> property, then the <span class="xbasicSmallSpan">source</span>
is the same as the item name. For example the definition for the <span class="xbasicSmallSpan">name</span> field in the schema shown below does not have a <span class="xbasicSmallSpan">source</span>
property, therefore this field is mapped to the <span class="xbasicSmallSpan">name</span> property in the <span class="xbasicSmallSpan">data</span> array.</p>





<pre class="xbasicSmall">
function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
    "schema": {
        "name": {
            "type": "c",
            "width": 30
        },
        "companyName: {
        	"source": "company",
        	"type" : "c",
        	"width" : 30
        },
        
        "street": {
            "source": "address.street",
            "type": "c",
            "width": 40
        },
        "number": {
            "source": "address.number",
            "type": "n",
            "width": 5,
            "decimal": 0
        }
    },
    "data": [
        {
            "name": "Fred Smith",
            "company" : "XYZ Corp",
            "address": {
                "street": "Main Street",
                "number": 23
            }
        },
        {
            "name": "John Jones",
            "company" : "ABC Corp",
            "address": {
                "street": "Corner Road",
                "number": 3
            }
        }
    ]
}
%json%
end function 
</pre>

<p>In the next example, we show how the JSON object that you specify can include image data. The binary data for the image are encoded as base64 strings. 
The example shows the complete function definition. Notice that the schema indicates that the <span class="xbasicSmallSpan">image</span> field will be stored as a 
<span class="xbasicSmallSpan">PNG</span>. Notice also that in the first record, the base64 encoded data in the <span class="xbasicSmallSpan">image</span> property does <b>not</b> include the 
MIME type at the start of the base64 encoded data. This data is therefore presumed to be a 
<span class="xbasicSmallSpan">PNG</span> image since the <span class="xbasicSmallSpan">schema</span> indicates that the image is 
a <span class="xbasicSmallSpan">PNG</span> type. Notice however, that the second row of data in the <span class="xbasicSmallSpan">data</span> array has a MIME type prefix on the base64 encoded image data. The data
for the image is for a <span class="xbasicSmallSpan">BMP</span> image. The image will therefore be converted from 
<span class="xbasicSmallSpan">BMP</span> to <span class="xbasicSmallSpan">PNG</span> automatically.</p>

<pre class="xbasicSmall">

function myjson as c(e as p)
myjson = &lt;&lt;%json%
{
   "schema" : {
      "name" : { "type" : "C" , "width": 30 }, 
      "image" : { "type" : "Png" }
	},
	"data": 
       [
          {"name":"John Smith", "image" : "iVBORw...(data truncated for readability)....AAAElFTkSuQmCC" },
          {"name":"Jane Smith", "image" : "data:image/bmp;base64,Qk02AwAAA...(data truncated for readability)....AAAADYAAAAAA=="}
       ]
}
%json%	
end function
</pre>




<p>
						&nbsp;</p>
						<table border="1" cellspacing="1" cellpadding="3" id="table84" style="color: rgb(0, 0, 0); font-family: 'Times New Roman'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; margin-left: 0.5in; border-collapse: collapse; " width="992">

							
							
							<tr>
								<td width="160" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								UX Component - List Control</td>
								<td width="201" style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								Displaying Data From Twitter</td>
								<td style="font-family: Tahoma; font-size: 8pt; vertical-align: top; ">
								The Twitter API returns data in JSON format. The 
								List control on a UX component is easily 
								populated with JSON data. The Twitter API, 
								however, is a little tricky to work with because 
								it requires an OAuth authorization before you 
								can call the API functions. Xbasic contains two 
								built-in functions that simplify this.<br>
								<br>
								In this example we show how you can easily build 
								a List control that displays Tweets that are 
								retrieved by making a REST API call to Twitter.
								<br>
								<br>
								In the example we use built-in Xbasic functions 
								to get a 'bearer token' from Twitter. Once we 
								have this token, we can make calls to the 
								Twitter API to get data in a JSON format that is 
								used to populate the List control.<br>
								<br>
								<b>IMPORTANT</b>: The video shows selecting the 
								Twitter List from the 'Defined Controls' section 
								of the UX builder toolbox. This has been 
								changed. You should now select the 'Twitter_Display_Tweets_in_a_List_Control' 
								sample UX Component template in the dialog that 
								appears when you create a new UX component.<br>
								<br>
								<br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part1.swf">
								Watch Video - Part 1</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part2.swf">
								Watch Video - Part 2</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part3.swf">
								Watch Video - Part 3</a><br>
								<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_twitter_list_part4.swf">
								Watch Video - Part 4</a></td>
							</tr>

							
							
							</table>
		<p>
						&nbsp;</p>
		<p>
						<b>AlphaDAO - ResultSet - Generating JSON Data - .ToJSONObjectSyntax() 
						Method</b> - When you use the .ToJSONObjectSyntax() 
						method to generate JSON data from a resultset, and you 
						set the optional ConvertToText flag to .f. (it defaults 
						to .t.), then date and date time values in the resultset 
						now create Javascript date objects. For example:</p>
		<p>
						&nbsp;</p>
		<p class="xbasic">
						dim cn as sql::Connection<br>
						cn.open(&quot;::Name::_northwind&quot;)<br>
						<br>
						cn.PortableSQLEnabled = .t.<br>
						cn.Execute(&quot;select first 5 orderid, orderdate from 
						orders&quot;) </p>
		<p class="xbasic">
						rs = cn.ResultSet<br>
						<br>
						?rs.ToJSONObjectSyntax(-1,-1,.f.,.f.)<br>
						= {&quot;orderid&quot; : 10255, &quot;orderdate&quot; : new Date(1952, 11, 
						18, 0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10249, &quot;orderdate&quot; : new Date(1996, 6, 5, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10250, &quot;orderdate&quot; : new Date(1996, 6, 8, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10251, &quot;orderdate&quot; : new Date(1996, 6, 8, 
						0, 0, 0, 0)}<br>
						{&quot;orderid&quot; : 10252, &quot;orderdate&quot; : new Date(1996, 6, 9, 
						0, 0, 0, 0)}<br>
						<br>
&nbsp;</p>
<hr color="#000000">
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">

<h1 align="center"><a name="JSON Functions"><font size="6">JSON</font><font size="6"> Functions</font></a></h1>
<p align="center">&nbsp;</p>

</p>
<h3 class="showhide_heading" id="Syntax"><span style="font-weight: 400">all of 
these json functions are used to create the code. builders we have written that 
build the code. <font size="2">JSON parse and generate most important </font>
</span></h3>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>



<h1><a name="a5_compact_json()">a5_compact_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Internal Use Only</b>. <font color="#808080">Compacts a JSON string</font></font></p>
		</blockquote>
		</td>
	</tr>
</table>
<blockquote>
	<blockquote>
		<blockquote>
<font size="2" color="#808080">a5_compact_json(c jsondata [,l flagcompact [,l flagusequotes ]])
</font>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<font size="2" face="Verdana" color="#808080">a5_compact_json() uses codes for the property names.</font></div>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">&nbsp;</div>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<font color="#808080">E<font size="2" face="Verdana">xample:</font></font></div>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<div><font size="2" face="Verdana" color="#808080"><br>&nbsp;</div>
				<div>json = &quot;{name: 'selwyn', city: 'lexington'}&quot;</font></div>
				<div>&nbsp;</div>
				<div><font size="2" face="Verdana" color="#808080">?a5_compact_json(json)</div>
				<div>= data = {&quot;a&quot;: &quot;selwyn&quot;,&quot;b&quot;: &quot;lexington&quot;}</div>
				<div>map = {&quot;a&quot;: &quot;name&quot;,&quot;b&quot;: &quot;city&quot;}</font></div>
			</div>
			<h1>&nbsp;</h1>
			<h1>
			<span style="font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 255, 255)">
			<font size="2" face="Verdana" color="#808080">as you can see this function returns two strings, a) the coded json, and the 
'map' that shows how the new property names map to the old property names</font></span></h1>
		</blockquote>
	</blockquote>
</blockquote>
<h1><br>
<h1><a name="a5_expand_json()">a5_expand_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			</font>
			<font size="2" face="Verdana"><b>Internal Use Only</b>. </font>
			<font size="2" color="#808080">Expands a JSON string to go back from the compacted json to the real 
			json you &nbsp;call the a5_expand_json() function</font></p>
		</blockquote>
		</td>
	</tr>
</table>

<p><font color="#808080"><b>Syntax:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><font size="2">a5_expand_json(c jsondata ,c map )
</font></font></p>

<blockquote>
	<blockquote>
		<blockquote>

			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<font size="2" face="Verdana" color="#808080">p= a5_compact_json(json)</font></div>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<font size="2" face="Verdana" color="#808080">?a5_expand_json(p.data,p.map)</font></div>
			<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
				<font size="2" face="Verdana" color="#808080">= {&quot;name&quot;:&quot;selwyn&quot;,&quot;city&quot;:&quot;<wbr>lexington&quot;}</font></div>
		</blockquote>
	</blockquote>
</blockquote>
<p class="showhide_heading">&nbsp;</p>

<h1><a name="a5_json_extractvalues()">a5_json_extractvalues()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Extracts name/value pairs from a JSON string.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Syntax:</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; C <i>Result</i> = 
a5_JSON_extractValues(C <i>txt</i> )</p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><br>C <i>Result</i> :&nbsp;&nbsp;&nbsp;&nbsp; String containing name:value pairs<br>C 
			<i>txt</i> :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSON 
expression to parse</p>
			<p><br><br /><b>Examples:</b></p>
			<p>&nbsp;</p>This example demonstrates parsing a relatively simple JSON 
		string with two small twists: it contains a quoted string, and there is 
		a comma inside the quoted string.<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">?a5_JSON_extractValues(&quot;{name:Fred, city: Boston, address: \&quot;123 Main St, Suite 23\&quot;, state: MA}&quot;)<br>= name:Fred<br>city: Boston<br>address: &quot;123 Main St, Suite 23&quot;<br>state: MA</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p><br /><br />This real-life example parses a JSON string 
		returned by the Twitter API.</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" bordercolor="#D1CB9A" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">c = &lt;&lt;%txt%<br>#{&quot;completed_in&quot;:0.014,&quot;max_id&quot;:157517767036248066,&quot;max_id_str&quot;:&quot;157517767036248066&quot;,<br>&quot;next_page&quot;:&quot;?page=2&amp;max_id=157517767036248066&amp;q=Red%20Sox&amp;rpp=2&quot;,&quot;page&quot;:1,&quot;query&quot;:&quot;Red+Sox&quot;,<br>&quot;refresh_url&quot;:&quot;?since_id=157517767036248066&amp;q=Red%20Sox&quot;,<br>&quot;results&quot;:[{&quot;created_at&quot;:&quot;Thu, 12 Jan 2012 17:42:16 +0000&quot;,<br>&quot;from_user&quot;:&quot;Liliancje&quot;,&quot;from_user_id&quot;:453416927,&quot;from_user_id_str&quot;:&quot;453416927&quot;,<br>&quot;from_user_name&quot;:&quot;Lilian Clum&quot;,&quot;geo&quot;:null,&quot;id&quot;:157517767036248066,<br>&quot;id_str&quot;:&quot;157517767036248066&quot;,&quot;iso_language_code&quot;:&quot;en&quot;,&quot;metadata&quot;:{&quot;result_type&quot;:&quot;recent&quot;},<br>&quot;profile_image_url&quot;:&quot;http://a0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg&quot;,<br>&quot;profile_image_url_https&quot;:&quot;https://si0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg&quot;,<br>&quot;source&quot;:&quot;&lt;a href=&quot;http://twitterfeed.com&quot; rel=&quot;nofollow&quot;&gt;twitterfeed&lt;/a&gt;&quot;,<br>&quot;text&quot;:&quot;JASON VARITEK Boston Red Sox Majestic AUTHENTIC Home 
					Baseball Jersey, 44/LARGE: Same Style Authentic On-Field 
					Je... http://t.co/MR8spX5g&quot;,<br>&quot;to_user&quot;:null,&quot;to_user_id&quot;:null,&quot;to_user_id_str&quot;:null,&quot;to_user_name&quot;:null},<br>{&quot;created_at&quot;:&quot;Thu, 12 Jan 2012 17:41:56 +0000&quot;,<br>&quot;from_user&quot;:&quot;BR_BOSRedSox&quot;,&quot;from_user_id&quot;:15908353,&quot;from_user_id_str&quot;:&quot;15908353&quot;,<br>&quot;from_user_name&quot;:&quot;Boston Red Sox&quot;,&quot;geo&quot;:null,&quot;id&quot;:157517679777951744,<br>&quot;id_str&quot;:&quot;157517679777951744&quot;,&quot;iso_language_code&quot;:&quot;en&quot;,&quot;metadata&quot;:{&quot;result_type&quot;:&quot;recent&quot;},<br>&quot;profile_image_url&quot;:&quot;http://a3.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg&quot;,<br>&quot;profile_image_url_https&quot;:&quot;https://si0.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg&quot;,<br>&quot;source&quot;:&quot;&lt;a href=&quot;http://twitterfeed.com&quot; rel=&quot;nofollow&quot;&gt;twitterfeed&lt;/a&gt;&quot;,<br>&quot;text&quot;:&quot;http://t.co/B4SxnH3d - Boston Red Sox Headlines - 
					Red Sox Mailbag: Boston In No Rush to Sign Jacoby Ellsbury 
					to L... http://t.co/1oWDduRM&quot;,<br>&quot;to_user&quot;:null,&quot;to_user_id&quot;:null,&quot;to_user_id_str&quot;:null,&quot;to_user_name&quot;:null}],<br>&quot;results_per_page&quot;:2,&quot;since_id&quot;:0,&quot;since_id_str&quot;:&quot;0&quot;}%txt%<br>
						<br>? a5_json_extractvalues(c)<br>= completed_in:0.014<br>max_id:157517767036248066<br>max_id_str:157517767036248066<br>next_page:?page=2&amp;max_id=157517767036248066&amp;q=Red%20Sox&amp;rpp=2<br>page:1<br>query:Red+Sox<br>refresh_url:?since_id=157517767036248066&amp;q=Red%20Sox<br>results:created_at:Thu, 12 Jan 2012 17:42:16 +0000<br>from_user:Liliancje<br>from_user_id:453416927<br>from_user_id_str:453416927<br>from_user_name:Lilian Clum<br>geo:null<br>id:157517767036248066<br>id_str:157517767036248066<br>iso_language_code:en<br>metadata:result_type:recent<br>profile_image_url:http://a0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg<br>profile_image_url_https:https://si0.twimg.com/profile_images/1730506616/rnhizx453h_135249004-2_normal.jpg<br>source:&lt;a href=&quot;http://twitterfeed.com&quot; rel=&quot;nofollow&quot;&gt;twitterfeed&lt;/a&gt;<br>text:JASON VARITEK Boston Red Sox Majestic AUTHENTIC Home 
					Baseball Jersey, 44/LARGE: Same Style Authentic On-Field 
					Je... http://t.co/MR8spX5g<br>to_user:null<br>to_user_id:null<br>to_user_id_str:null<br>to_user_name:null<br>created_at:Thu, 12 Jan 2012 17:41:56 +0000<br>from_user:BR_BOSRedSox<br>from_user_id:15908353<br>from_user_id_str:15908353<br>from_user_name:Boston Red Sox<br>geo:null<br>id:157517679777951744<br>id_str:157517679777951744<br>iso_language_code:en<br>metadata:result_type:recent<br>profile_image_url:http://a3.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg<br>profile_image_url_https:https://si0.twimg.com/profile_images/1157609127/BR_LOGO_normal.jpg<br>source:&lt;a href=&quot;http://twitterfeed.com&quot; rel=&quot;nofollow&quot;&gt;twitterfeed&lt;/a&gt;<br>text:http://t.co/B4SxnH3d - Boston Red Sox Headlines - Red 
					Sox Mailbag: Boston In No Rush to Sign Jacoby Ellsbury to 
					L... http://t.co/1oWDduRM<br>to_user:null<br>to_user_id:null<br>to_user_id_str:null<br>to_user_name:null<br>results_per_page:2<br>since_id:0<br>since_id_str:0</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		<p><br /></p>
	</blockquote>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="a5_json_populatearray()">a5_json_populatearray()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Takes an array of JSON objects and populates an 
			Xbasic property array.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
<h3 class="showhide_heading" id="Syntax0">Syntax: <span style="font-weight: 400">a5_JSON_PopulateArray(P<i> arr</i> ,C 
<i>txt</i> )</span><br /></h3>
<blockquote>
	<blockquote>
		<blockquote>
			<h3 class="showhide_heading" id="Examples0">
			<span style="font-weight: 400">P <i>arr</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Array to populate with data<br>C <i>txt </i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
String of JSON data</span></h3>
			<h3 class="showhide_heading">Example:</h3>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">txt = &lt;&lt;%txt%<br>[<br>{firstname: 'Fred', lastname: 'Smith', married: true, kids: 2} ,<br>{firstname: 'richard', lastname: 'smith'}<br>]<br>%txt%<br>
						<br>dim arr[0] as p <br>a5_JSON_PopulateArray(arr,txt)<br>&nbsp;<br>?arr.size()<br>= 2<br>
						<br>?arr[1]<br>= firstname = "Fred"<br>kids = 2<br>lastname = "Smith"<br>married = .T.</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
</blockquote>
<p>&nbsp;</p>

	
	</article>

<h1><a name="a5_json_prep()">a5_json_prep()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			Used before calling VarToJSON() to remove property 
			values that are nulls. </font>
			<article id="top1" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
<a href="../../../Reference/Design/Api/Functions/Variable%20Functions/varToJSON%20Function.html" title="varToJSON Function" class="wiki">
			<font size="2">VarToJSON Function</font></a></article></p>
		</blockquote>
		</td>
	</tr>
</table>
<article id="top0" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
<h3 class="showhide_heading" id="Syntax1">Syntax: <span style="font-weight: 400">
a5_JSON_Prep(P <i>p</i> )</span></h3>
<blockquote>
	<blockquote>
<font size="2">&nbsp;P<i> p</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Property array to preprocess<br><br /><br />
</font>
<p>&nbsp;</p>
<p>&nbsp;</p>

	</blockquote>
</blockquote>
<h1><a name="a5_json_viewer()">a5_json_viewer()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			a5_json_viewer() Function - The A5_json_viewer() function can be 
			used to open a viewer for JSON data.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<blockquote>
	<blockquote>
		<p align="center">
						<img border="0" src="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/a5_json_viewer.jpg"></p>

	</blockquote>
</blockquote>

<h1><a name="a5_makejsontree()">a5_makejsontree()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			Takes an array and makes a JSON tree. Array has these 
			properties at a minimum: .label, .level, </font></p>
		</blockquote>
		</td>
	</tr>
</table>
&nbsp;<p><b><font size="2">Syntax:</font></b><font size="2">
a5_makejsontree(p treein [,* opsin ]) </font></p>
<p><font size="2">a5_makeJSONTree as c (treeIn as p, opsIn = null_value())</font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="a5_merge_json_into_template()">a5_merge_json_into_template()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">While templates are documented in a section 
			called 'Client-side Templates' this is somewhat misleading because 
			you can also use templates in server-side code using the 
			a5_merge_JSON_into_template() Xbasic function.<br>
&nbsp;</font></p>
			<p><font size="2">Using Client-side Templates on the Server-side - 
			a5_merge_JSON_into_template() Function - Because Alpha Anywhere has 
			the ability to execute Javascript from an Xbasic script, you can 
			actually use client-side templates in Xbasic using the 
			a5_merge_JSON_into_template() function.<br>
&nbsp;</font></p>
			<p><font size="2"><br>
			a5_merge_JSON_into_template() Function - Application Server - The 
			a5_merge_JSON_into_template() function did not work when called from 
			Xbasic code running in the Application Server. It only worked in the 
			Development Server.<br>
&nbsp;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
&nbsp;<p><b><font size="2">Syntax:</font></b><font size="2">
a5_merge_json_into_template(c jsondata ,c template [,c javascriptfunctions [,c partialtemplatesjson [,c localcss [,l flagusev8 ]]]])
</font></p>

<p><font size="2">c <i>Result</i> = a5_merge_JSON_into_template(C <i>jsonData</i> 
,C <i>template</i> [,C <i>javascriptFunctions</i> [,C <i>partialTemplatesJSON</i> 
[,C <i>localCSS</i> ]]])</font></p>
<p>&nbsp;</p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Example:</font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><font size="2"><br></font>
						<font size="2" color="#333300">dim data as c <br>data = &lt;&lt;%txt%<br>{firstname: 'Fred', lastname: 'Jones'}<br>%txt%<br>
						<br>template = &lt;&lt;%html%<br>Name: {firstname} {lastname}<br>%html%<br>
						<br>htmlOut = a5_merge_JSON_into_template(data,template)<br>
						<br>showvar(htmlOut)</font><font size="2"><br>&nbsp;</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		<p>&nbsp;</p>
	</blockquote>
</blockquote>



<h1><a name="a5_sql_nested_query_to_json_document()">a5_sql_nested_query_to_json_document()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			a5_sql_nested_query_to_json_document() Function - 
			Queries one or more SQL databases and returns a JSON document with 
			the query result.<br>
			This function is inspired by NoSQL databases that return a JSON 
			document with a query result. The JSON document return by such a 
			query often contains nested JSON documents. For example for each 
			customer, show orders for that customer, and for each order, show 
			order details for that order.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
&nbsp;<p><b><font size="2">Syntax:</font></b><font size="2">
a5_sql_nested_query_to_json_document(p ops ,p args [,c mode ]) </font></p>
<p><font size="2">P <i>result</i> = a5_sql_nested_query_to_json_document( 
						P <i>options</i>, SQL::Arguments <i>Args</i>)</font></p>
<blockquote>
	<blockquote>
		<blockquote>
			<p>&nbsp;</p>
			<p><b><font size="2">Examples:</font></b></p>
			<p>&nbsp;</p>
			<p><font size="2">For example, here is a sample JSON document returned by 
						this function showing customers, nested orders, and 
						nested order details:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p>&nbsp;</p>
						<p class="xbasicSmall">
						<font face="Verdana" size="2" color="#333300">{<br>&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerId": "HUNGO",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"companyName": "Hungry Owl All-Night Grocers",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderid": "10298",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerid": "HUNGO",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"value": "10298",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderDetails": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10298",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ProductID": "2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"UnitPrice": "15.2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Quantity": "40",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Discount": "0"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderid": "10309",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"customerid": "HUNGO",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"value": "10309",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orderDetails": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10309",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ProductID": "4",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"UnitPrice": "17.6",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Quantity": "20",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Discount": "0"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</font></p>
						<p class="xbasicSmall">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
truncated for brevity....</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
	<blockquote>
		<blockquote>
			<p>T<font size="2">he <i>result</i> object that is returned has these 
						properties</font></p>
			<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">hasError</font></i><font size="2"> - .t. or .f. depending on whether the function 
			returns an error.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">errorText</font></i><font size="2"> - the error text if hasError is .t.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">data</font></i><font size="2"> - the JSON data returned by the function</font></li>
			</ul>
			<p>&nbsp;</p>
			<p><font size="2">The options object that is passed into the function has 
						these properties:</font></p>
			<p>&nbsp;</p>
			<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">options.connectionString</font></i><font size="2"> - The connection string for the 
			query. This is an optional property. You can also specify a query 
			string to use for each nested query. If you do not specify <i>options.connectionString</i>, then you MUST specify a connection 
			string for each query. Typically, you will querying against a single 
			database, and so it is most efficient to specify the <i>options.connectionString</i> parameter and NOT specify a connection 
			string for each SQL statement.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">options.SQL</font></i><font size="2"> - a CRLF delimited list of SQL statements to 
			execute. The indentation in the parameter indicates the hierarchy of 
			the query. See below for more details.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">options.flagUseSubSelects</font></i><font size="2">&nbsp; - Indicates if child SQL 
			queries use a SQL Sub-select in the WHERE clause. If you are querying 
			against a single database then this is the most efficient option. If 
			each query specifies its own connection string, then this flag must 
			be set to .f.. 
			</font> 
			</li>
			</ul>
			<p>&nbsp;</p>
			<p><font size="2">Example <i>options.SQL</i> parameter:</font></p>
			<p>&nbsp;</p>
			<p class="xbasic"><font size="2" face="Verdana">options.sql = 
		&lt;&lt;%txt%<br>{sql: 'select * from customers where country = :whatCountry ', name: 
		'customer' }<br>&nbsp;&nbsp;&nbsp; {sql:'select * from orders', name: 'orders', parentKey: 'cId', 
		key: 'cId'}<br>%txt%<br>&nbsp;</font></p>
			<p><font size="2">Notice that the<i> options.sql </i>property is a CRLF 
						delimited string of JSON strings in this format:</font></p>
			<p class="xbasic"><font size="2" face="Verdana">options.SQL = &lt;&lt;%txt%</font></p>
			<p class="xbasic"><font size="2" face="Verdana">{JSON string 1}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp; {JSON string2}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">%txt%</font></p>
			<p>&nbsp;</p>
			<p><font size="2">The fact that {JSON string 2} is indented (using a 
						single Tab character NOT spaces) is significant. The 
						indentation indicates that this query is an immediate child of the 
						query in the line above it.</font></p>
			<p><font size="2">You can have multiple levels of indentation. and 
						multiple queries with the same parent, for 
						example:</font></p>
			<p class="xbasic"><font size="2" face="Verdana">options.SQL = &lt;&lt;%txt%</font></p>
			<p class="xbasic"><font size="2" face="Verdana">{JSON string 1}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp; {JSON string2}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {JSON string 
						3}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp; {JSON string 4}</font></p>
			<p class="xbasic"><font size="2" face="Verdana">%txt%</font></p>
			<p>&nbsp;</p>
			<p><font size="2">In the above example, the SQL query defined by {JSON 
						string 3} is a child of {JSON string2}. The query 
						defined by {JSON string 1} has two child queries. A real 
						world example of an hierarchy that would be defined 
						using the above structure might be:</font></p>
			<p>&nbsp;</p>
			<p class="xbasic"><font size="2" face="Verdana">Customers</font></p>
			<p class="xbasic"><font size="2" face="Verdana">`&nbsp;&nbsp;&nbsp; Orders</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						OrderDetails</font></p>
			<p class="xbasic"><font size="2" face="Verdana">&nbsp;&nbsp;&nbsp; Payments</font></p>
			<p>&nbsp;</p>
			<p><font size="2">The individual JSON strings each have these properties</font></p>
			<ul style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">sql</font></i><font size="2"> - The actual SQL statement to execute</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">name</font></i><font size="2"> - An arbitrary name. Must be unique. This name is 
			used for the child records in the JSON document that is returned.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">parentKey&nbsp; - </font> </i><font size="2">Only required for child queries. 
			Defines the field in the child SQL statement that joins the child 
			query with the parent query.</font></li>
				<li style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<i><font size="2">key - </font> </i><font size="2">Only required for child queries. Defines the field 
			in the child's parent SQL query that joins the child query with the 
			parent query.</font></li>
			</ul>
			<p>&nbsp;</p>
			<p>&nbsp;</p>
			<p>&nbsp;</p>
			<p><font size="2">Example 1 - Simple two level query</font></p>
			<p class="xbasicSmall"><font size="2">dim ops as p<br>ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' }<br>&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId'}<br>%txt%<br>dim args as sql::Arguments<br>args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>p = a5_sql_nested_query_to_json_document(ops,args)<br>?p.data</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2">&nbsp;=

{<br>&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CompanyName": "Blondesddsl pre et fils",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactName": "Frdrique Citeaux",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactTitle": "Marketing Manager",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Address": "24, place Klber",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"City": "Strasbourg",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Region": null,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"PostalCode": "67000",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Country": "France",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Phone": "88.60.15.31",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Fax": "88.60.15.32",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"image": null,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"imageThumb": null,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10265",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "07/25/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RequiredDate": "08/22/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShippedDate": "08/12/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "55.28",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipName": "Blondel pre et fils",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipAddress": "24, place Klber",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipCity": "Strasbourg",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipRegion": null,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipPostalCode": "67000",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipCountry": "France"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10297",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CustomerID": "BLONP",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "5",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "09/04/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"RequiredDate": "10/16/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShippedDate": "09/10/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "5.74",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipName": "Blondel pre et fils",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipAddress": "24, place Klber",</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						truncated for brevity......<br></font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2"><br>&nbsp;</font></p>
			<p><font size="2">Example 2 - Simple three level query</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2"><br>dim ops as p<br>ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' }<br>&nbsp;&nbsp;&nbsp;
						{sql: 'select * from orders', name: 'orders', parentKey: 
						'customerid', key: 'customerId'}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						{sql: 'select * from [order details]', name: 'orderDetails', 
						parentKey: 'orderId', key: 'orderId'}<br>%txt%</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2"><br>dim args as sql::Arguments<br>args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>p = a5_sql_nested_query_to_json_document(ops,args)<br>&nbsp;</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2"><br><br>&nbsp;</font></p>
			<p><font size="2">Example 3 - Three level query where each query is in a 
						different database (the connection string is specified 
						for each query). </font> </p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2"><br>'since each query specifies its own connection string, 
						the flagUseSubSelects flag must </font> </p>
			<p class="xbasicSmall"><font size="2">'be set to .f.</font></p>
			<p class="xbasicSmall"><font size="2"><br>ops.flagUseSubSelects = .f.<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers where country = :whatCountry 
						', name: 'customer' , connectionString: 
						'::Name::northwind'}<br>&nbsp;&nbsp;&nbsp;
						{sql: 'select * from orders', name: 'orders', parentKey: 
						'customerid', key: 'customerId', connectionString: 
						'::Name::northwind2'}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						{sql: 'select * from [order details]', name: 'orderDetails', 
						parentKey: 'orderId', key: 'orderId' , connectionString: 
						'::Name::northwind2'}<br>%txt%<br>dim args as sql::Arguments<br>args.add(&quot;whatCountry&quot;,&quot;France&quot;)<br>p = a5_sql_nested_query_to_json_document(ops,args)<br>
			<br><br>&nbsp;</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p><b><font size="2">Limiting the Number of Child Records</font></b></p>
			<p><font size="2">If you want to limit the number of records retrieved at 
						any level in the hierarchy, you can.</font></p>
			<p><font size="2">To limit the number of records at the top level of the 
						hierarchy, you would simply use the FIRST clause in your 
						SQL select statement. However, for child queries, using 
						the FIRST clause in the SQL will not work (because you 
						want the FIRST n records within <b>EACH</b> parent 
						group, not the FIRST n records in <b>ALL</b> parent 
						groups).</font></p>
			<p><font size="2">To limit the number of records in a child query, you use 
						the 'limit' property in the JSON object that defines the 
						query.</font></p>
			<p><font size="2">For example in the code shown below we are fetching the 
						first 5 orders for each customer:</font></p>
			<p>&nbsp;</p>
			<p class="xbasicSmall"><font size="2">dim ops as p<br>ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers', name: 'customer' }<br>&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId', limit: 5}<br>%txt%<br>&nbsp;</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p><b><font size="2">NOTE</font></b><font size="2">: If you do use a FIRST clause in a child SQL statement, 
		the SQL statement is automatically parsed and the FIRST clause is 
		removed and converted into a 'limit' property in the JSON definition. 
		So, the following two objects are actually equivalent:</font></p>
			<p>&nbsp;</p>
			<p class="xbasicSmall"><font size="2">dim ops as p<br>ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers', name: 'customer' }<br>&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
		key: 'customerId', limit: 5}<br>%txt%<br>&nbsp;</font></p>
			<p>&nbsp;</p>
			<p class="xbasicSmall"><font size="2">dim ops as p<br>ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers', name: 'customer' }<br>&nbsp;&nbsp;&nbsp; {sql: 'select
			<font color="#FF0000">FIRST 5</font> * from 
		orders', name: 'orders', parentKey: 'customerid', key: 'customerId'}<br>%txt%<br>&nbsp;</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p>&nbsp;</p>
			<p><b><font size="2">Eliminating Key Values</font></b></p>
			<p><font size="2">By default, the JSON that is created shows the parent 
						key value in the child data. For example in the example 
						JSON shown below (which shows a customer, and all of 
						their orders), the 'CustomerID' property is shown n each 
						item in the 'orders' array. This is really not 
						necessary.</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p class="xbasicSmall"><font size="2">&nbsp;=

{<br>&nbsp;&nbsp;&nbsp;&nbsp;"customer": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">"CustomerID": "BLONP",</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CompanyName": "Blondesddsl pre et fils",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ContactName": "Frdrique Citeaux",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"orders": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderID": "10265",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF0000">"CustomerID": "BLONP",</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"EmployeeID": "2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"OrderDate": "07/25/1996 12:00:00 00 am",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ShipVia": "1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Freight": "55.28",<br>&nbsp;</font></p>
			<p class="xbasicSmall">&nbsp;</p>
			<p><font size="2">In order to suppress parent key values in child records, 
						you can set the 'sparse' property to .t. in the object 
						you pass into the a5_sql_nested_query_to_json_document() 
						function. For example:</font></p>
			<p>&nbsp;</p>
			<p class="xbasicSmall"><font size="2">dim ops as p</font></p>
			<p class="xbasicSmall"><font size="2" color="#FF0000">ops.sparse = .t.<br>
			</font><font size="2">ops.connectionString = &quot;::Name::northwind&quot;<br>ops.sql = &lt;&lt;%txt%<br>{sql: 'select * from customers', name: 'customer' }<br>&nbsp;&nbsp;&nbsp; {sql: 'select * from orders', name: 'orders', parentKey: 'customerid', 
						key: 'customerId', limit: 5}<br>%txt%<br>&nbsp;</font></p>
			<p>&nbsp;</p>
			<p><b><font size="2">Preserving Data Types in the JSON </font> </b></p>
			<p><font size="2">You can use the <i>convertToText</i> property in the 
						options that you pass in to control whether the 
						generated JSON converts all data to strings, or 
						preserves data types.</font></p>
			<p><font size="2">For exmaple:</font></p>
			<p>&nbsp;</p>
			<p class="xbasic"><font size="2" face="Verdana">ops.convertToText = .f.<br>p = a5_sql_nested_query_to_json_document(ops,args)</font></p>
			<p class="xbasic">&nbsp;</p>
			<p><font size="2">would result in JSON that looked like this:</font></p>
			<p>&nbsp;</p>
			<p class="xbasicSmall"><font size="2">&nbsp;&quot;customer&quot;: [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;customerId&quot;: &quot;GREAL&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;companyName&quot;: &quot;Great Lakes Food Market&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orders&quot;: [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orderid&quot;: 10528,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;orderdate&quot;: new Date(1997,05,06,00,00,0),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&quot;value&quot;: 10528,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						........</font></p>
			<p>&nbsp;</p>
			<p><font size="2">Notice that the 'orderDate, orderId, and value 
						properties are typed.</font></p>
			<p>&nbsp;</p>
		</blockquote>
	</blockquote>
</blockquote>
		<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="a5_url_from_storagejsonformat()">a5_url_from_storagejsonformat()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Takes a JSON definition for an object in storage 
			(e.g. Amazon S3) and generates a signed URL to download the object. 
			E.g. take this: &quot;{cs: 'alphamediacapture',object: 
			'my_movies7.xlsx',source: 'S3'}&quot; and generates a signed URL to 
			download the object. 'numberOfSecondsBeforeURLExpires' - if the 
			object is protected, specify the number of seconds that the URL can 
			be used for after it has been generated. Default is 240 seconds.</font><br>
			<br>
			<font size="2">a5_url_fromStorageJSONformat() Function - Generates a 
			signed URL to download a file from Amazon S3 storage.<br>
			The a5_url_from_storageJSONformat() function can be used to 
			display/download a file from storage (e.g. Amazon S3) directly, with 
			very little load on the Alpha server. The purpose of the function is 
			to take a JSON string that defines the address of an object in 
			storage (e.g. Amazon S3) and to generate a signed URL that can be 
			used to download the object directly to the client from storage 
			without having to first download the object to the Alpha server and 
			then have the Alpha server send the file to the client.</font><br>
&nbsp;</p>
			<p><font size="2">NOTE: Currently the only vendor supported is 
			Amazon S3 so vendor must be set to 'S3'</font></p>
			<p><font size="2"><br>
			NOTE: The storage connection string is defined by selecting the 
			Tools, Storage Connection Strings menu when the Web Projects Control 
			Panel has focus. When you define storage connection strings you have 
			the option of encrypting the storage connection string. You must NOT 
			encrypt the storage connection string or else Alpha Anywhere will 
			not be able to parse the storage connection string to determine your 
			storage credentials.</font></p>
			<p>&nbsp;</p>
			<p><font size="2">Where:<br>
			key - your access key - as defined in the storage connection string<br>
			expires - indicates how long the URL can be used for (only applies 
			if the object was uploaded to storage as 'Protected Read')<br>
			signature - a special signature based on the credentials specified 
			in the storage connection string.<br>
			By default, the expires property is 240 seconds. That means that if 
			the URL is used more than 240 seconds after it was generated, Amazon 
			S3 will return a 'permission denied' error. The 
			a5_url_from_storageJSONformat() function takes an optional second 
			argument where you can specify how long the URL is good for in 
			seconds. The default value for this parameter is 240.<br>
			<br>
			File Upload - Amazon S3 - A new action has been added to Action 
			Javascript for the UX component to upload files to a bucket in 
			Amazon S3 storage. <br>
			NOTE: This action is not available for the Grid Component. However, 
			the standard 'File Upload' and 'Image Upload' actions in Action 
			Javascript, which are supported in the Grid now supports an option 
			to target the upload to Amazon S3.<br>
&nbsp;</font></p>
			<p>
		<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_amazon_s3_1.swf">
			<font size="2">Watch Video 
	- Part 1</font></a><font size="2"><br>
			</font>
		<a href="http://www.ajaxvideotutorials.com/V12Videos/ux_amazon_s3_2.swf">
			<font size="2">Watch Video 
	- Part 2</font></a><font size="2"><br>
&nbsp;</font></p>
			<p><font size="2">The benefit of this method is that the upload 
			occurs directly to the Amazon servers without putting any load on 
			the the Alpha Application Server.<br>
			NOTE: There is a small load on the Alpha Server for each file that 
			is uploaded because a callback has to be made to the Alpha server to 
			sign the URL used for the upload. This is necessary because the 
			secret key for your Amazon account is stored on the Alpha server.<br>
			Features of the Amazon S3 File Upload include:</font></p>
			<p><font size="2"><br>
			ability to upload a single file or multiple files<br>
			ability to define rules for maximum size of an individual file, or 
			all files (if multiple file upload is supported)<br>
			ability to show progress during while file(s) are being uploaded<br>
			ability to cancel an file upload<br>
			full event model that allows you to completely customize the action.<br>
			ability to specify the name (including sub-folder name) for each 
			object that is stored on S3. A Javascript function can be called to 
			dynamically compute the fully qualified name of the object on S3.<br>
			ability to set read permission on the uploaded files (public read or 
			authenticated read)<br>
&nbsp;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p><b>Syntax:</b> a5_url_from_storagejsonformat(c json [,n numberofsecondsbeforeurlexpires ])
		<p>a5_url_from_storageJSONformat as c (json as c , 
numberOfSecondsBeforeURLExpires = 240)</p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b>Examples:</b></p>
			<p>&nbsp;</p>
			<p>The JSON string format that defines the address of an object in storage is:</p>
			<p class="xbasic">&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">{cs: 'storage connection 
					string', object: 'name of object', source: 'vendor'}</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p>For example, assume you have a named storage connection string called 
'myS3bucket'. A JSON string that defines the address of an object called 'ProductPrices.pdf' 
would be:</p>
			<p class="xbasic">&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">{cs: 'myS3bucket', object: 'ProductPrices.pdf', 
					source: 'S3'}</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p>To generate a URL to display or download this object you would do the 
		following:</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><font face="Verdana" size="2" color="#333300"><br>dim address as c 
						</font></p>
						<p><font face="Verdana" size="2" color="#333300">address = &lt;&lt;%txt%</font></p>
						<p><font face="Verdana" size="2" color="#333300">{&nbsp;&nbsp;&nbsp; 
						</font></p>
						<p><font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; cs: 'myS3bucket',
						</font></p>
						<p><font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; object: 'ProductPrices.pdf',
						</font></p>
						<p><font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; source: 'S3'</font></p>
						<p><font face="Verdana" size="2" color="#333300">}</font></p>
						<p><font face="Verdana" size="2" color="#333300">%txt%</font></p>
						<p><font face="Verdana" size="2" color="#333300">dim url as c
						</font></p>
						<p><font face="Verdana" size="2" color="#333300">url = a5_url_from_storateJSONformat(address)</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p class="xbasic">&nbsp;</p>
			<p>The resulting URL would look something like this (assuming that the bucket 
name specified in the connection string was 'myBucket'):</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">https://s3.amazonaws.com/myBucket/ProductPrices.pdf?AWSAccessKeyId=key&amp;Expires=expiration&amp;Signature=signature</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		<p>&nbsp;</p>
	</blockquote>
</blockquote>
<h1><a name="a5_xbasictreetojsontree()">a5_xbasictreetojsontree()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Take a CRLF delimited string that Xdialog uses for 
			Tree Control data and converts to a JSON string.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
a5_xbasictreetojsontree(c treedata [,c separator ])<p>a5_XbasicTreeToJSONTree as c (treedata as c, separator as c = &quot;.&quot; )<br>
<br>
&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="a5w_ajaxtojson()">a5w_ajaxtojson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">&nbsp;Dumps out JSON from a data source.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
a5w_ajaxtojson(p tmpl ,p do )

<p>A5w_AJAXToJSON AS P ( tmpl AS P, do AS P )<br>
&nbsp;</p>

<p>&nbsp;</p>

<h1><a name="argumentsfromjson()">argumentsfromjson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Appends arguments to an argument object from a JSON 
			argument definition</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
argumentsfromjson(p args ,c json )

<p>argumentsFromJSON as v (args as sql::arguments, json as c )<br>
&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="argumentstojson()">argumentstojson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Serializes arguments to a JSON string</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
argumentstojson(* argsorargsxml [,l flagcompact ])

<p>function argumentsToJSON as c (argsOrArgsXML as A, flagCompact = .f. )<br>
&nbsp;</p>
<p>&nbsp;</p>

<p>&nbsp;</p>

<h1><a name="crlf_to_json()">crlf_to_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Converts cr-lf delimited text to JSON. First row of 
			text is assumed to be the field names. Default delimiter (character 
			between fields) is |. crlf - takes something like colors and turn it into a json 
array,</font></p>
		</blockquote>
		</td>
	</tr>
</table>
&nbsp;<p><b>Syntax:</b> crlf_to_json(c txt [,c delimiter ]) </p>
<p>crlf_to_json as c (txt as c, delimiter = &quot;|&quot;)<br>
&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="json_composite()">json_composite()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Turns flat lists into tree structure.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
json_composite(c parent,c relations, c jsontext [, c mode[, c limits[,c views[,c 
calcs]]]] )

<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Examples: </font></b></p>
			<p>&nbsp;</p>
			<p><font size="2">Turning flat lists into tree structure</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br><font size="2" color="#333300">dim relations as c = &lt;&lt;%str%<br>{&nbsp;<br>&quot;orders&quot; : {<br>&quot;customerId&quot; : &quot;id&quot;,<br>&nbsp; &quot;orderDetails&quot; : {<br>&nbsp; &nbsp; &nbsp;&nbsp;&quot;orderId2&quot; : &quot;orderId&quot;<br>&nbsp; &nbsp; }<br>}<br>}<br>%str%<br>
						<br>dim def as c<br><br>def = &lt;&lt;%txt%<br>{<br>&quot;customers&quot;: [<br>{&quot;id&quot;: &quot;alfki&quot;, &quot;name&quot;: &quot;305 - 14th Ave. S.\nSuite 3B&quot;},<br>{&quot;id&quot;: &quot;bolid&quot;, &quot;name&quot;: &quot;name 2&quot;}<br>],<br>&quot;orders&quot;: [<br>{&quot;orderId&quot;: 1, &quot;customerId&quot;: &quot;alfki&quot;, &quot;orderData&quot;: 
					&quot;12/1/2013&quot;},<br>{&quot;orderId&quot;: 2, &quot;customerId&quot;: &quot;bolid&quot;, &quot;orderData&quot;: 
					&quot;12/2/2013&quot;},<br>{&quot;orderId&quot;: 3, &quot;customerId&quot;: &quot;alfki&quot;, &quot;orderData&quot;: 
					&quot;12/3/2013&quot;},<br>{&quot;orderId&quot;: 4, &quot;customerId&quot;: &quot;alfki&quot;, &quot;orderData&quot;: 
					&quot;12/1/2013&quot;}<br>],<br>&quot;orderDetails&quot;: [<br>{&quot;lineitemId&quot;: 1, &quot;orderId2&quot;: 1, &quot;prodId&quot;: 1, &quot;qty&quot;: 3},<br>{&quot;lineitemId&quot;: 2, &quot;orderId2&quot;: 2, &quot;prodId&quot;: 6, &quot;qty&quot;: 6},<br>{&quot;lineitemId&quot;: 3, &quot;orderId2&quot;: 2, &quot;prodId&quot;: 9, &quot;qty&quot;: 7},<br>{&quot;lineitemId&quot;: 4, &quot;orderId2&quot;: 1, &quot;prodId&quot;: 3, &quot;qty&quot;: 2},<br>{&quot;lineitemId&quot;: 5, &quot;orderId2&quot;: 1, &quot;prodId&quot;: 3, &quot;qty&quot;: 8},<br>{&quot;lineitemId&quot;: 6, &quot;orderId2&quot;: 3, &quot;prodId&quot;: 4, &quot;qty&quot;: 9},<br>{&quot;lineitemId&quot;: 7, &quot;orderId2&quot;: 3, &quot;prodId&quot;: 3, &quot;qty&quot;: 1},<br>{&quot;lineitemId&quot;: 8, &quot;orderId2&quot;: 6, &quot;prodId&quot;: 2, &quot;qty&quot;: 3}<br>]<br>}<br>%txt%<br>
						<br><br>t1 = now()<br>output =&nbsp;json_composite(&quot;customers&quot;,relations,def,&quot;&quot;)<br>t2 = now()<br>'showvar(output)<br>showvar( json_reformat(&quot;{&quot;+output+&quot;}&quot;,.t.) , &quot;took &quot;+(t2-t1) 
					)</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
</blockquote>

<p>&nbsp;</p>

<h1><a name="json_enumerate()">json_enumerate()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Gets all of the top level property names.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Syntax:</b>
json_enumerate(c jsontext) </p>

<blockquote>
	<blockquote>
		<p><b><font size="2">Examples</font></b></p>
		<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p>&nbsp;</p>
						<p><font size="2" color="#333300">? json_enumerate(&quot;{ \&quot;firstname\&quot; 
						: \&quot;joe\&quot; , \&quot;lastname\&quot; : \&quot;plumber\&quot; }&quot;)<br>
						= firstname<br>
						lastname</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>

<h1><a name="json_extract()">json_extract()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json_extract() Function - Extracts a property from a 
			JSON object. Note: The JSON text passed to the function must be 
			properly formed (i.e. use double quotes on property and string 
			names). You can use json_reformat_safe() to 'clean' up the JSON 
			string before calling json_extract.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax:</font></b><font size="2">
json_extract(c jsontext,c tag) </font>
<p><font size="2">c text = json_extract( C json_text, c property_name)</font></p>
<p>&nbsp;</p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Examples: </font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p>&nbsp;</p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">dim json as c
						</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">json = &lt;&lt;%txt%</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">{ </font>
						</p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; name: 'Fred',</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; address: {</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; street: '123 
						Main St',</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; city: 
						'Boston',</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state: 'MA'</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">}</font></p>
						<p class="xbasic">&nbsp;</p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">'json_extract() requires properly formed JSON, so</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">'we first call json_reformat_safe()</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">dim json2 as c 
						</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">json2 = json_reformat_safe(json)</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">?json_extract(json2,&quot;name&quot;)</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">= &quot;Fred&quot;</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">?json_extract(json2,&quot;address&quot;)</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">= &quot;</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">{</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; street: '123 
						Main St',</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; city: 
						'Boston',</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state: 'MA'</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">&quot;</font></p>
						<p class="xbasic">
						<font face="Verdana" size="2" color="#333300">%txt%</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		<p>&nbsp;</p>
	</blockquote>
</blockquote>
		
<h1><a name="json_filter()">json_filter()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json_filter() Function - Extracts or omits certain 
			properties from a JSON string. NOTE: Conceptually, this function is 
			similar to the filter_string() function, except that it operates on 
			JSON strings. Where:</font></p>
			<ul style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<font face="Verdana, Arial, sans-serif" size="2"><i>json</i> - input string of JSON data</font></li>
				<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<font face="Verdana, Arial, sans-serif" size="2"><i>propertyNames</i> - comma delimited list of the property 
				names in the JSON string that you want to filter</font></li>
				<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
				<font face="Verdana, Arial, sans-serif" size="2"><i>exclude</i> = .t. or .f. - default .f. - if exclude = .t. 
				the specified <i>propertyNames</i> are excluded from the JSON 
				string</font></li>
			</ul>
		</blockquote>
		</td>
	</tr>
</table>

<b>Syntax:</b>

json_filter(c jsontext,c tags[,l exclude])


			
			<p>c result = json_filter(c json [, c properyNames [, L exclude]] )<br>
			&nbsp;</p>
			<blockquote>
				<blockquote>
					<blockquote>
						<p><b>Examples:</b></p>
					</blockquote>
				</blockquote>
				<div style="color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 12.8px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
					<blockquote>
						<blockquote>
							<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
								<tr>
									<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
									<p class="xbasicSmall">&nbsp;</p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">'extract object with a single field</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">dim json as c
									</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">json = &lt;&lt;%txt%</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">{</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; one&quot; : 1 , 
									</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; two&quot; : &quot;TWO&quot; , 
									</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">&nbsp;&nbsp;&nbsp; three : [ 1 ,2 ,3 ]</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">}</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">%txt%<br>&nbsp;</font></p>
									<p class="xbasicSmall">
									<font face="Verdana" size="2" color="#333300">? json_filter(json,&quot;one&quot;)<br>= { &nbsp;&quot;one&quot; : 1}<br>
									<br><br>? json_filter(json,&quot;two&quot;)<br>= { &nbsp;&quot;two&quot; : &quot;TWO&quot;}<br>
									<br>? json_filter(json,&quot;three&quot;)<br>= { &nbsp;&quot;three&quot; : [ 1 ,2 ,3 ]}<br>
									<br>'exclude a single field<br>? json_filter(json,&quot;one&quot;,.t.)<br>= { &nbsp;&quot;two&quot; : &quot;TWO&quot; , &quot;three&quot; : [ 1 ,2 ,3 ]}<br>
									<br><br>? json_filter(json,&quot;two&quot;,.t.)<br>= { &nbsp;&quot;one&quot; : 1 , &quot;three&quot; : [ 1 ,2 ,3 ]}<br>
									<br>? json_filter(json,&quot;three&quot;,.t.)<br>= { &nbsp;&quot;one&quot; : 1 , &quot;two&quot; : &quot;TWO&quot;}<br>
									<br><br>'include multiple (comma separated) fields<br>? json_filter(json,&quot;one,two&quot;)<br>= { &nbsp;&quot;one&quot; : 1 , &quot;two&quot; : &quot;TWO&quot;}<br>? json_filter(json,&quot;one,three&quot;)<br>= { &nbsp;&quot;one&quot; : 1 , &quot;three&quot; : [ 1 ,2 ,3 ]}</font></p>
									<p class="xbasicSmall">&nbsp;</p></td>
								</tr>
							</table>
						</blockquote>
					</blockquote></div>
</blockquote>
			<p>&nbsp;</p>


<h1><a name="json_flatten()">json_flatten()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json_flatten() Function - Takes a JSON string that 
			defines an array of hierarchical objects and 'flattens' the array.<br>
			This function is useful for Reporting where the report data source 
			is set to a Custom data source that returns JSON data. If the JSON 
			data that is returned is hierarchical, then you will need to 
			'flatten' it in order to get it into an appropriate format for the 
			report writer.</font></p>
		</blockquote>
		</td>
	</tr>
</table>

<b><font size="2">Syntax:</font></b><font size="2">

json_flatten(c jsontext,c patterns)</font></h1>
<p>
						<font size="2">c <i>output</i> = json_flatten(C <i>jsonIn</i>, c <i>
						template</i>)</font></p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Examples:</font></b></p>
			<p>&nbsp;</p>
			<p><font size="2">The format of the template is shown in the following 
						example.
						Consider the following JSON String:</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p><font size="2" color="#333300"><br>[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "__a5crc": -253329,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orders": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/1/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordcust": "1|||alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderDetails": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "1|||1"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 4,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "1|||3"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/3/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordcust": "3|||alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderDetails": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 4,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 9,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "3|||4"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 7,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "3|||3"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "bolid",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "__a5crc": -194126,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orders": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/2/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordcust": "2|||bolid",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderDetails": [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "2|||6"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 9,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 7,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ordprod": "2|||9"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>]</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">The JSON object defined by the above string shows an 
		array of customers with embedded orders. For each order, there are 
		embedded line-items.<br>The structure of the JSON object is<br><br>&nbsp;&nbsp;&nbsp;
		Customers<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		Orders<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		Order Details</font></p>
			<p><font size="2"><br>The json_flatten() function takes two arguments - the JSON string you 
		want to flatten, and a template that defines which properties in the 
		input JSON you want to map to the output JSON.<br>Assume that the following template is specified:<br>&nbsp;</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">{<br>&nbsp;&nbsp; "id" : "id" ,<br>&nbsp;&nbsp; "name" : "name" ,<br>&nbsp;&nbsp; "orders" : [ 
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId" : "orderId" ,
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData" : "orderData" ,
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderDetails" : [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId" : "lineitemId" ,
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId" : "prodId" ,
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty" : "qty"
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
						<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>}</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">If you 'flatten' this JSON using the above template, 
		you will get the following output:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p class=><font size="2" color="#333300">[<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/1/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 3<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/1/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 4,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 2<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/3/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 4,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 9<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "alfki",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 1",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/3/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 7,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 1<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "bolid",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/2/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 6,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 6<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "bolid",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "customer 2",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderId": 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "orderData": "12/2/2013",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "lineitemId": 3,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "prodId": 9,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "qty": 7<br>&nbsp;&nbsp;&nbsp; }<br>]</font><br>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Notice that the template has omitted the '__a5crc' in 
		the input property. The template indicated which properties were to be 
		extracted from the input JSON. It also indicates that the property name 
		should be called in the output JSON.<br>For example, the template indicates:</font></p>
			<p><font size="2"><br>&nbsp;&quot;id&quot; : &quot;id&quot;</font></p>
			<p><font size="2"><br>Had that been:<br><br>&nbsp;&quot;id&quot; : &quot;CustomerId&quot;<br>
			<br>The output JSON would have named the 'id' property 'CustomerId'.</font></p>
			<p><font size="2">Here is a simpler example:<br>&nbsp;</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim json as c
						<br>json = &lt;&lt;%str%<br>[<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;name&quot;: &quot;John&quot;, &quot;kids&quot; : [ {&quot;name&quot;: &quot;callie&quot;},{&quot;name&quot; 
						: &quot;griffin&quot;} ]},<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;name&quot;: &quot;Tom&quot;, &quot;kids&quot; : [ { &quot;name&quot; : &quot;betty&quot; } ]}<br>]<br>%str%<br>
						<br>dim template as c<br>template = &lt;&lt;%str%<br>{&quot;id&quot; : &quot;id&quot;, &quot;name&quot; : &quot;firstname&quot;, &quot;kids&quot; : [ {&quot;name&quot;: 
						&quot;name&quot;} ] }<br>%str%<br><br>dim json2 as c <br>json2 = json_flatten(json,template)<br>json2 = json_reformat(json2)</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Here is what json2 looks like:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">[<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;John&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;callie&quot;<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;John&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;griffin&quot;<br>&nbsp;&nbsp;&nbsp; },<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;id&quot;: 2,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;Tom&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;name&quot;: &quot;betty&quot;<br>&nbsp;&nbsp;&nbsp; }<br>]</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">The json_flatten() function can also be used to simply 
						map property names in the input JSON to new property 
						names in the output JSON. For example, consider the 
						following script:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim json as c
						<br>json = &lt;&lt;%str%<br>[<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;name&quot;: &quot;John&quot;},<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;name&quot;: &quot;Tom&quot;}<br>]<br>%str%<br>
						<br>dim template as c<br>template = &lt;&lt;%str%<br>{&quot;id&quot; : &quot;id&quot;, &quot;name&quot; : &quot;firstname&quot;}<br>%str%<br>
						<br><br>dim json2 as c <br>json2 = json_flatten(json,template)<br>json2 = json_reformat(json2)<br>showvar(json2)<br>&nbsp;</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p>The resulting JSON will look like this:</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">[<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 1, &quot;firstname&quot;: &quot;John&quot;},<br>&nbsp;&nbsp;&nbsp; {&quot;id&quot; : 2, &quot;firstname&quot;: &quot;Tom&quot;}<br>]</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		</blockquote>
</blockquote>
<p>&nbsp;</p>
<h1><a name="json_from_bson()">json_from_bson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2" face="Verdana">BSON was created by the developers of Mongo 
			DB. BSON is JSON data that is converted to binary. The 
			json_from_bson() function converts BSON data back into JSON. </font>
			</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>

<b><font size="2">Syntax: </font></b>json_from_bson(b bson) </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="json_from_xml()">json_from_xml()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>

<b><font size="2">Syntax: </font></b>json_from_xml(c xmltext[,c toptag[,c options]]) </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>



<h1><a name="json_from_xml_odata()">json_from_xml_odata()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>

<b><font size="2">Syntax: </font></b>json_from_xml_odata(c xmltext[,c toptag[,c options]]) </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><br>



<h1><a name="json_generate()">json_generate()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">Generate takes a variable and returns JSON. </font></p>
			<p><font size="2">generate walking over object, return everything in JSON 
syntax. </font></p>
		<p>
						<font size="2">json_generate() Function - Performance - The 
						json_generate() function has been re-written and is now 
						considerably faster. </font> </p>
		<p>
						<font size="2">NOTE: Previously the json_generate() function 
						would escape single quotes. However the JSON spec does 
						not require this and so single quotes are no longer 
						escaped. </font></p>
			<p>
						&nbsp;</p>
			<p>
						<font size="2">Generates a string in JSON format from an 
						Xbasic dot variable. This function should be used in 
						place of varToJSON() which will be deprecated. The 
						json_generate() function is identical to varToJSON() in 
						all respects, except that the attribute name and string 
						values are quoted using double quotes in accordance with 
						the official JSON specification.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
json_generate(* var [,l flagspecialtags [,l flagcondense [,c indent [,l 
flaghonornulls [,*&nbsp;opsin ]]]]])<br>
&nbsp;<blockquote>
	<blockquote>
		<blockquote>
			<p>json_generate(<span class=Argument>var</span> as p)</p>
			<p><span class=Argument>var&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span>pointer to variable.</p>
			<p>&nbsp;</p>
			<p><b>Example:</b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim pj as p<br>pj.text = &quot;some text with ' single quote&quot;<br>?json_generate(pj)<br>= {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;text&quot;: &quot;some text with ' single quote&quot;<br>}</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
	<blockquote>
		<blockquote>
			<p><b>File.to_property() Function</b> - Can now 
						automatically de-serialize a file that was serialized 
						using property_to_string(), property_to_blob() or 
						json_generate().</p>
			<p>Example:</p>
			<p class="xbasic">dim src.fname as c = &quot;john&quot;<br>dim src.lname as c = &quot;public&quot;<br>file.From_string(&quot;c:\data\sample.txt&quot;,property_to_string(src))<br>file.From_string(&quot;c:\data\sample.json&quot;,json_generate(src))<br>file.From_blob(&quot;c:\data\sample.dat&quot;,property_to_blob(src))<br>
			<br><br>dim p1 as p<br>file.to_property(&quot;c:\data\sample.txt&quot;,p1)<br>? p1<br>= fname = &quot;john&quot;<br>lname = &quot;public&quot;<br>
			<br><br>dim p2 as p<br>file.to_property(&quot;c:\data\sample.json&quot;,p2)<br>? p2<br>= fname = &quot;john&quot;<br>lname = &quot;public&quot;<br>
			<br>dim p3 as p<br>file.to_property(&quot;c:\data\sample.dat&quot;,p3)<br>? p3<br>= fname = &quot;john&quot;<br>lname = &quot;public&quot;</p>
		</blockquote>
	</blockquote>
</blockquote>
		<p>
						&nbsp;</p>
		<p>&nbsp;</p>


<h1><a name="json_parse()">json_parse()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">JSON parse is one of the most important functions 
			for dealing with JSON in Xbasic. The <font color="#0000FF">
			json_parse</font> function p</font><font face="Verdana"><font size="2">arses a string in JSON format and returns an Xbasic dot 
variable. This function is simply a wrapper on the INET::JSONParser.parse() 
method. However, unlike the low level INET::JSONParser.parse() method, the 
json_parse() function can also be used to parse strings that are in Javascript 
array format. (INET::JSONParser.parse() can only be used for strings that are in 
JSON format.)</font>.</font></p>
<p>
&nbsp;</p>
			<p>
<font size="2">JSON Parse is sometimes slower than other methods but it is also forgiving. Not all things that purport to be JSON 
are in fact JSON. For example, the use of quotes around a string. This is not required 
on Microsoft's parser but it is required in Javascript. </font>
<font size="2" face="Verdana">This uses a Microsoft JSON parser:</font></p>
	<font face="Verdana">
		</blockquote>
	

<div align="center">
	<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
			<tr>
				<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
				<blockquote>
					<p class=><font size="2"><br></font>
<font size="2" face="Verdana" color="#333300">? json_parse(&quot;{ foo : 1}&quot;)<br>
= foo = 1</font></p>
				</blockquote></td>
			</tr>
		</table>
	</div>	
		
		
		</font>
		<blockquote>
			<p>
<font size="2" face="Verdana">Json_parse can handle this incorrectly formatted json, i.e. JSON spec 
requires names be quoted.</font><font size="2"> The json_parse() function can 
take an optional second argument to 
indicate if the JSON being parsed is a Javascript object literal rather than a 
JSON string. For example, the <i>json_parse()</i> function can interpret Javascript
<i>Date()</i> functions in a JSON string. This allows you to parse JSON strings generated by 
the json_generate() function, if the json_generate() function generated a JSON 
string that uses the <i>Date()</i> function.</font></p>
			<p>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<b>Syntax:</b>
json_parse(c jsontext [,l flagjavascriptsyntax ])
<p>json_parse(<span class=Argument>jsonTxt</span> as c)</p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><span class=Argument>jsonTxt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span>JSON formatted text.</p>
			<p>&nbsp;</p>
			<p><b>Examples:</b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim p as p<br>p.name = &quot;Fred&quot;<br>p.sayHello = &quot;{javascript}function() { alert('hello');}&quot;</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Now, generate a Javascript object literal. Pass in .t. 
		as the second argument to <font color="#0000FF">vartojson()</font> to 
		indicate that we want an Javascript object literal and not a JSON 
		string.</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br></font>
						<font size="2" color="#333300">dim jsObject as c <br>jsObject = vartojson(p,.t.)</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Here is what the resulting string looks like:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br></font>
						<font size="2" color="#333300">{<br>name: 'Fred',<br>sayHello: function() { alert('hello');}<br>}</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Now, in order to be able to parse this object literal back to Xbasic, 
		we use the json_parse() function but we set the optional second argument 
		to .t.</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim pj as p<br>pj = json_parse(jsObject ,.t.)<br>?pj.name 
						<br>= &quot;Fred&quot;<br><br>?pj.sayHello<br>= &quot;{javascript}function() { alert('hello');}&quot;</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">p=json_parse(&quot;1,2,3&quot;)<br>?p<br>=&nbsp;1&nbsp;=&nbsp;1<br>2&nbsp;=&nbsp;2<br>3&nbsp;=&nbsp;3<br>
						<br>p2&nbsp;=&nbsp;json_parse(&quot;{name:\&quot;Fred&nbsp;Smith\&quot;,&nbsp;age:&nbsp;23&nbsp;},{name:\&quot;John&nbsp;Jones\&quot;,&nbsp;age:&nbsp;45}&quot;)<br>?p21<br>=&nbsp;age&nbsp;=&nbsp;23<br>name&nbsp;=&nbsp;&quot;Fred&nbsp;Smith&quot;<br>?p22<br>=&nbsp;age&nbsp;=&nbsp;45<br>name&nbsp;=&nbsp;&quot;John&nbsp;Jones&quot;</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">The following example shows a round trip using json_parse() and json_generate() to show how date and time values are preserved.</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim&nbsp;p&nbsp;as&nbsp;p<br>p.name&nbsp;=&nbsp;&quot;Karen&quot;<br>p.dob&nbsp;=&nbsp;date()<br>p.time&nbsp;=&nbsp;now()<br>
						<br>?json_generate(p)<br>{<br>&quot;name&quot;:&nbsp;&quot;Karen&quot;,<br>&quot;dob&quot;:&nbsp;Date( 06/02/2012 ),<br>&quot;time&quot;:&nbsp;Date( 06/02/2012&nbsp;10:17:11&nbsp;32&nbsp;pm )<br>}<br>
						<br>dim&nbsp;jsonTxt&nbsp;as&nbsp;c&nbsp;<br>jsonTxt&nbsp;=&nbsp;json_generate(p)<br>dim&nbsp;p2&nbsp;as&nbsp;p<br>p2&nbsp;=&nbsp;json_parse(jsonTxt)<br>?p2<br>
						<br>=&nbsp;dob&nbsp;=&nbsp;{06/02/2012}<br>name&nbsp;=&nbsp;&quot;Karen&quot;<br>time&nbsp;=&nbsp;06/02/2012&nbsp;10:17:11&nbsp;32&nbsp;pm</font><br>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">NOTE: If the data in the JSON string contains any 
		strings with line breaks (designated as '\n' in the data) , json_parse() 
		will return LF delimited data, not CR-LF delimited data. You will need 
		to use the convert_lf_to_crlf() function to convert LFs to CR-LFs. 
		Example:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><br><font size="2" color="#333300">dim&nbsp;p&nbsp;as&nbsp;p<br>p.name&nbsp;=&nbsp;&quot;Alpha&quot; + crlf() + &quot;Beta&quot;<br>?json_generate(p)<br>{name: 'Alpha\nBeta'}<br>p2 = json_parse(json_generate(p))<br>?p2.name = p.name<br>= .F.<br>?convert_lf_to_crlf(p2.name) = p.name<br>= .T.</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		</blockquote>
</blockquote>
<p class=A5>&nbsp;</p>
<p class=Code>&nbsp;</p>


<h1><a name="json_reformat()">json_reformat()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			Takes json and reformats it so that it is presented on one line or 
			extended to include multiple lines. </font>
			<font size="2" face="Verdana">&nbsp;The json_reformat() function only accepts 'properly formed' JSON 
			strings (property names must be double quoted and string values must 
			be double quoted).</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b><font size="2">Syntax:</font></b><font size="2">
	json_reformat(c jsontext [, l indented] ) </font> </p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Example:</font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br></font>
						<font size="2" color="#333300">? json_reformat( extn.ToJson() 
					, .t.)<br>= {<br>&nbsp;&nbsp; &quot;Alternate-Protocol&quot;: &quot;443:quic&quot;,<br>&nbsp;&nbsp; &quot;Cache-Control&quot;: &quot;private, max-age=0&quot;,<br>&nbsp;&nbsp; &quot;Content-Disposition&quot;: &quot;attachment&quot;,<br>&nbsp;&nbsp; &quot;Content-Encoding&quot;: &quot;gzip&quot;,<br>&nbsp;&nbsp; &quot;Content-Type&quot;: &quot;application/json; charset=UTF-8&quot;,<br>&nbsp;&nbsp; &quot;Date&quot;: &quot;Tue, 28 Jan 2014 22:14:23 GMT&quot;,<br>&nbsp;&nbsp; &quot;Expires&quot;: &quot;-1&quot;,<br>&nbsp;&nbsp; &quot;Server&quot;: &quot;gws&quot;,<br>&nbsp;&nbsp; &quot;X-Frame-Options&quot;: &quot;SAMEORIGIN&quot;,<br>&nbsp;&nbsp; &quot;X-XSS-Protection&quot;: &quot;1; mode=block&quot;,<br>&nbsp;&nbsp; &quot;X-Firefox-Spdy&quot;: &quot;3&quot;<br>}<br>
						</font><font size="2"><br>&nbsp;</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
		</blockquote>
		</blockquote>
</blockquote>



<h1><a name="json_reformat_safe()">json_reformat_safe()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			The
			json_reformat_safe() function reformats a string of JSON data 
			with line-breaks and optional indentation. 
			json_reformat_safe() wraps the lower level json_reformat() function. 
			The json_reformat() function only accepts 'properly formed' JSON 
			strings (property names must be double quoted and string values must 
			be double quoted). json_reformat_safe() will automatically convert 
			JSON strings where property names are not quoted and strings are 
			single quoted.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax: </font></b><font size="2">json_reformat_safe(c json [,l indented ])
</font>
		<p>
						<font size="2">c <i>json_text</i> = json_reformat_safe(<i>json_text</i> 
						[, <i>flagIndent</i> = .t.])</font></p>
		
		
		<blockquote>
			<blockquote>
				<div>
					<blockquote>
						<p><b>Example:</font></b></p>
						<p>&nbsp;</p>
						<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
							<tr>
								<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
								<blockquote>
									<p>&nbsp;</p>
									<p><font size="2" color="#333300">dim json as c
									</font></p>
									<p><font size="2" color="#333300">json = &lt;&lt;%txt%</font></p>
									<p><font size="2" color="#333300">{firstname: 'Fred', lastname: 'Smith', Address: {<br>Street: '123 Main St', 
									<br>City: 'Boston', <br>State: 'Ma'<br>}<br>}<br>%txt%</font></p>
									<p>&nbsp;</p>
									<p><font size="2" color="#333300">?json_reformat_safe(json)</font></p>
									<p><font size="2" color="#333300">= {<br>&nbsp;&nbsp;&nbsp; &quot;firstname&quot;: &quot;Fred&quot;,<br>&nbsp;&nbsp;&nbsp; &quot;lastname&quot;: &quot;Smith&quot;,<br>&nbsp;&nbsp;&nbsp; &quot;Address&quot;: {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Street&quot;: &quot;123 Main St&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;City&quot;: &quot;Boston&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;State&quot;: &quot;Ma&quot;<br>&nbsp;&nbsp;&nbsp; }<br>}</font></p>
									<p>&nbsp;</p>
								</blockquote></td>
							</tr>
						</table>
					</blockquote>
				</div>
			</blockquote>
</blockquote>

<h1>&nbsp;</h1>
<h1><a name="json_sample_array()">json_sample_array()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The json_sample_array() function takes&nbsp;a JSON&nbsp;array&nbsp;as input 
			and 
			returns Fieldnames by default. If the format is specified, it will return 
			count/sparse information.</font><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>

<font size="2"><b>Syntax:</b> json_sample_array(c jsontext[, format [,n limit]]) </font>
<blockquote>
	<blockquote>
		<p><font size="2"><br>format spec parameters<br><br>$n - name<br>$i - case insensitive name<br>$c - count - occurences of field<br>$m - records sampled<br>$s - field is sparse (true or false)<br>
		<br>I am going to add support for type/width parameters as well limit to&nbsp;sample&nbsp;only 
'limit' records<br><br>json&nbsp;= file.to_string(&quot;e:\dev\v12bugs\jsonh.txt&quot;)<br>?&nbsp;json_sample_array(json)<br>= OrderID<br>CustomerID<br>EmployeeID<br>OrderDate<br>__primaryKey<br>__a5crc<br>__LIST__LIST2<br>__LIST__LIST3<br>?&nbsp;json_sample_array(json,&quot;$n|$c of $m|$s&quot;)<br>= OrderID|830 of 830|false<br>CustomerID|830 of 830|false<br>EmployeeID|830 of 830|false<br>OrderDate|830 of 830|false<br>__primaryKey|830 of 830|false<br>__a5crc|830 of 830|false<br>__LIST__LIST2|830 of 830|false<br>__LIST__LIST3|830 of 830|false<br>?&nbsp;json_sample_array(json,&quot;$i|$c of $m|$s&quot;)<br>= orderid|830 of 830|false<br>customerid|830 of 830|false<br>employeeid|830 of 830|false<br>orderdate|830 of 830|false<br>__primarykey|830 of 830|false<br>__a5crc|830 of 830|false<br>__list__list2|830 of 830|false<br>__list__list3|830 of 830|false<br>
		<br><br>this is the result i am looking for<br><br>OrderID<br>CustomerID<br>EmployeeID<br>OrderDate<br>_primaryKey<br>_a5crc<br>_LIST_LIST2<br>_LIST_LIST3<br>
		<br><br>what i need is some thing like:<br><br><br>txt = file.to_string(&quot;c:\bugs\jsonh.txt&quot;)<br>
		<br>dim js as extension::JSON<br>js.setJson(txt)<br>?js.getLength()<br>= 830<br>
		<br>p0 = js.getIndexed(0)<br>firstrow = p0.getJson()<br>showvar(json_reformat(firstrow))<br>?p0.getLength()<br>= 8<br>?p0.nameIndexed(7)<br>
		<br><br>recursion on objects that accumulate across all rows - it only recurses objects 
(not arrays - which I assume to be separate views)<br><br><br>The recursion is off by default, you need to use the new<br>
		<br><br>$r - recursive name<br><br>or<br><br>$ri - case insensitive recursive name<br>
		<br>dim js as c = &nbsp;&lt;&lt;%str%<br>[<br>&nbsp;&nbsp;{ &quot;firstname&quot; : &quot;sam&quot; , &quot;lastname&quot; : &quot;spade&quot; , &quot;address&quot; : { &quot;State&quot; : &quot;CA&quot; , 
&quot;City&quot; : &quot;Los Angelos&quot; } } ,<br>&nbsp;&nbsp;{ &quot;firstname&quot; : &quot;john&quot; , &quot;lastname&quot; : &quot;doe&quot; , &quot;age&quot; : 30 , &quot;address&quot; : { 
&quot;State&quot; : &quot;CA&quot; , &quot;City&quot; : &quot;Los Angelos&quot; , &quot;alive&quot; : false} }<br>
		]<br>%str%<br><br><br>?&nbsp;json_sample_array(js,&quot;$r|$s&quot;)<br>= firstname|false<br>lastname|false<br>address.State|false<br>address.City|false<br>address.alive|true<br>age|true<br>
		<br><br>?&nbsp;json_sample_array(js,&quot;$ri|$s&quot;)<br>= firstname|false<br>lastname|false<br>address.state|false<br>address.city|false<br>address.alive|true<br>age|true<br>
		<br>&nbsp;</font></p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
	</blockquote>
</blockquote>
<h1><a name="a5_sql_schema_to_json()">a5_sql_schema_to_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The a5_sql_schema_to_json() Function takes a schema of 
			a SQL database and generates a JSON representation of the schema 
			showing all tables in the database, and their relationships.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>

<b><font size="2">Syntax:</font></b></p>
<blockquote>
	<blockquote>
			<p><b><font size="2">Example:</font></b></p>
			<p>&nbsp;</p>
			<p><font size="2">Type the following commands in the Interactive window:</font><font size="2" face="Verdana"><br>&nbsp;</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br><font color="#333300">dim 
						cn as sql::Connection<br>
						?cn.Open(&quot;::Name::northwind&quot;)<br>
						= .T.<br>
						dim sn as sql::Schema<br>
						?cn.GetSchema(sn)<br>
						= .T.<br>
						dim jsonSchema as c <br>
						jsonSchema = a5_sql_schema_to_json(sn,{ 
						show_field_type_info : true }) <br>
						showvar( jsonSchema)<br>
&nbsp;</font></font></p>
					</blockquote></td>
				</tr>
			</table>
	</blockquote>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="json_select()">json_select()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json select- pass it a string of json data and return 
			a string out of that</font></p>
		</blockquote>
		</td>
	</tr>
</table>

<b><font size="2">Syntax: </font></b>json_select(c jsontext,c columns[,c primarykey[,l crc[,c flags]]])
<p>&nbsp;</p>
<p>&nbsp;</p>



<h1><a name="json_sqlquery()">json_sqlquery()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json_sqlQuery() Function - Allows you to filter a 
			JSON array using a simple SQL query syntax. For example assume you 
			have a JSON string as shown below. The JSON is an array of objects. 
			You can think of this as a table with the following fields: 
			firstname, lastname, city and state.</font></p>
		</blockquote>
		</td>
	</tr>
</table>

<b><font size="2">Syntax:</font></b><font size="2">

json_sqlquery(c json ,c sqlstatement [,* argsin [,c columntypes [,* otheropsin ]]])
</font>


<div>
<blockquote>
	<blockquote>
		<p>&nbsp;</p>
		<blockquote>
			<p><b><font size="2">Examples:</font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br></font>
						<font size="2" color="#333300">dim json as c <br>json = &lt;&lt;%str%<br>[<br>{firstname: 'John', lastname: 'Smith', city: 'Boston', 
					state: 'MA'},<br>{firstname: 'Fred', lastname: 'Jones', city: 'Cambridge', 
					state: 'MA'},<br>{firstname: 'Tom', lastname: 'King', city: 'New York', 
					state: 'NY'}<br>]<br>%str%</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Assume that you want to apply a filter to this string to 
						retrieve certain records and also to sort the result.
						The SQL that you would need to express your query might 
						be:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br></font>
						<font size="2" color="#333300">select * from 
					JSONTABLE WHERE state = 'MA' ORDER BY lastname</font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Or if you would like to use arguments in your SQL, you 
						might express your query as:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=><font size="2"><br><font color="#333300">select * from JSONTABLE WHERE state = 
					:whatstate ORDER BY lastname</font></font></p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">Here is how you can use the json_sqlQuery() function:<br>&nbsp;</font></p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p><font size="2" color="#333300">dim args as sql::arguments
						<br>args.add(&quot;whatstate&quot;,&quot;MA&quot;)<br>dim jsonResult as c
						<br>json2 = json_sqlQuery(json,&quot;select * from jsontable 
						where state = :whatstate ORDER BY lastname&quot;,args)</font></p>
						<p>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p><font size="2">The resulting string will be:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p><font size="2" color="#333300">[</font></p>
						<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; {firstname: 'Fred', lastname: 
						'Jones', city: 'Cambridge', state: 'MA'},<br>&nbsp;&nbsp;&nbsp; {firstname: 'John', lastname: 'Smith', city: 'Boston', state: 
						'MA'}</font></p>
						<p><font size="2" color="#333300">]</font><br>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
</blockquote>
		<p>&nbsp;</p>
</div>


<h1><a name="json_standardize()">json_standardize()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">JSON_standardize() function - Takes non-standard JSON 
			and standardizes it. Also corrects for trailing commas in the JSON 
			(which are illegal)</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax:</font></b><font size="2">
json_standardize(c json [,l flagreformat ]) </font>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Examples:</font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p><font size="2" color="#333300">?json_standardize(&quot;{name: 
					'Fred', age: 21}&quot;)<br>&nbsp;{<br>&quot;name&quot;: &quot;Fred&quot;,<br>&quot;age&quot;: 21<br>}<br>
						<br>?json_standardize(&quot;{name: 'Fred', age: 21,}&quot;)<br>&nbsp;{<br>&quot;name&quot;: &quot;Fred&quot;,<br>&quot;age&quot;: 21<br>}</font></p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
	</blockquote>
</blockquote>
		<p>
						&nbsp;</p>
<h1><a name="json_to_bson()">json_to_bson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2" face="Verdana">BSON was created by the developers of Mongo 
			DB. BSON is JSON data that is converted to binary. </font>
			</p>
		</blockquote>
		</td>
	</tr>
</table>

<b><font size="2">Syntax: </font></b>json_to_bson(c json)



<p>&nbsp;</p>



<h1><a name="json_to_xml()">json_to_xml()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">json_to_xml() Function - Convert JSON to XML - Takes 
			a string of JSON data and converts it to XML. json_to_xml() Function 
			- ATOM Format - The json_to_xml() function can now generate XML 
			using the &quot;atom&quot; format:</font></p>
		</blockquote>
		</td>
	</tr>
</table>
		<p>
						<b><font size="2">Syntax:</font></b><font size="2">
json_to_xml(c jsontext[,c toptag[,c options]]) </font></p>
<p>
						<font size="2">c <i>xml</i> = json_to_xml(c <i>json, </i>c<i> attribute</i>)</font></p>
<blockquote>
	<blockquote>
		<blockquote>
			<p><b><font size="2">Example:</font></b></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p><font size="2" color="#333300">dim json as c <br>json = &lt;&lt;%txt%<br>{ 
						<br>&quot;firstname&quot; : &quot;john&quot; , <br>&quot;lastname&quot; : &quot;public&quot; ,
						<br>&quot;num&quot; : [1,2,3] , <br>&quot;flag&quot; : true , 
						<br>&quot;place&quot; : { &quot;state&quot; : &quot;Texas&quot;} 
						<br>}<br>%txt%<br><br>dim xml as c <br>xml = json_to_xml(json,&quot;person&quot;)</font><br>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
			<p class="xbasic">&nbsp;</p>
			<p>The resulting XML string looks like this:</p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p><font size="2" color="#333300">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;person&gt;<br>&nbsp; &nbsp;&lt;firstname&gt;john&lt;/firstname&gt;<br>&nbsp; &nbsp;&lt;lastname&gt;public&lt;/lastname&gt;<br>&nbsp; &nbsp;&lt;num&gt;1&lt;/num&gt;<br>&nbsp; &nbsp;&lt;num&gt;2&lt;/num&gt;<br>&nbsp; &nbsp;&lt;num&gt;3&lt;/num&gt;<br>&nbsp; &nbsp;&lt;flag&gt;true&lt;/flag&gt;<br>&nbsp; &nbsp;&lt;place&gt;<br>&nbsp; &nbsp; &nbsp; &lt;state&gt;Texas&lt;/state&gt;<br>&nbsp; &nbsp;&lt;/place&gt;<br>&lt;/person&gt;</font><br>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
			<p class="xbasic">&nbsp;</p>
			<p><font size="2">ATOM Format:</font></p>
			<p>&nbsp;</p>
			<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
				<tr>
					<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
					<blockquote>
						<p class=>&nbsp;</p>
						<p class="xbasic">
						<font size="2" face="Verdana" color="#333300">js = &lt;&lt;%str%<br>{<br>&nbsp;&nbsp;&nbsp; &quot;OrderId&quot;:10248,<br>&nbsp;&nbsp;&nbsp; &quot;ProductID&quot;:11,<br>&nbsp;&nbsp;&nbsp; &quot;UnitPrice&quot;:14,<br>&nbsp;&nbsp;&nbsp; &quot;Quantity&quot;:12,<br>&nbsp;&nbsp;&nbsp; &quot;Discount&quot;:0<br>}<br>%str%<br>
						<br>dim xml as c <br>xml = json_to_xml(js)</font></p>
						<p class="xbasic">&nbsp;</p>
						<p class="xbasic">&nbsp;</p>
						<p class="xbasic">
						<font size="2" face="Verdana" color="#333300">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;data&gt;<br>&nbsp;&nbsp;&nbsp; &lt;OrderId&gt;O10248&lt;/OrderId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;ProductID&gt;11&lt;/ProductID&gt;<br>&nbsp;&nbsp;&nbsp; &lt;UnitPrice&gt;14&lt;/UnitPrice&gt;<br>&nbsp;&nbsp;&nbsp; &lt;Quantity&gt;12&lt;/Quantity&gt;<br>&nbsp;&nbsp;&nbsp; &lt;Discount&gt;0&lt;/Discount&gt;<br>&lt;/data&gt;<br>&nbsp;</font></p>
						<p class="xbasic">
						<font size="2" face="Verdana" color="#333300"><br><br>dim format as c 
						<br>format = &lt;&lt;%str%<br>{ &quot;format&quot; : &quot;atom&quot;}<br>%str%<br>
						<br>dim xml as c = json_to_xml(js,&quot;&quot;,format)<br>
						<br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;atom:entry xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot;<br>xmlns:m=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&quot;<br>xmlns:d=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices&quot;&gt;<br>&nbsp;&nbsp;&nbsp; &lt;atom:content type=&quot;application/xml&quot;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;m:properties&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:OrderId&gt;O10248&lt;/d:OrderId&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:ProductID&gt;11&lt;/d:ProductID&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:UnitPrice&gt;14&lt;/d:UnitPrice&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;d:Quantity&gt;12&lt;/d:Quantity&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
						&lt;d:Discount&gt;0&lt;/d:Discount&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/m:properties&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/atom:content&gt;<br>&lt;/atom:entry&gt;</font></p>
						<p>&nbsp;</p>
					</blockquote></td>
				</tr>
			</table>
		</blockquote>
		<p>
						&nbsp;</p>
		</blockquote>
</blockquote>

<h1><a name="json_validate()">json_validate()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax:</font></b><font size="2">
json_validate(c jsontext) </font>
<h1>&nbsp;</h1>


<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="property_from_json()">property_from_json()</a></h1>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The property_from_json() requires proper JSON, but is 
			2 to 5 times faster than json_parse()</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax: </font></b><font size="2">property_from_json(p prop , c jsontext)</font><blockquote>
	<blockquote>
		<blockquote>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p class=><br>
								<font size="2" color="#333300">dim ptr as p<br>
								property_from_json(ptr,&quot;{ foo : 1}&quot;)<br>
								Error parsing json: Name of an object member 
								must be a string<br>
								<br>
								property_from_json(ptr,&quot;{ \&quot;foo\&quot; : 1}&quot;)<br>
								? ptr.foo<br>
								= 1</font></p>
							</blockquote></td>
						</tr>
					</table>
					</blockquote>
	</blockquote>
</blockquote>
<p>&nbsp;</p>
</h1>


<h1><a name="property_to_json()">property_to_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax: </font></b><font size="2">property_to_json(p prop [, l changesonly] )</font><p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</h1>


<h1><a name="vartojson()">vartojson()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<b><font size="2">Syntax: </font></b><font size="2">vartojson(* var [,l flagspecialtags [,l flagcondense [,c indent [,l flagquotesonpropnames [,l flaghonornulls ]]]]])</font></h1>
<h1><br>
&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1>&nbsp;</h1>
<h1><a name="vartojsonhash()">vartojsonhash()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The <font color="#0000FF">varToJsonHash()</font> 
			Function converts an Xbasic property array to a JSON hash</font>.
			<font size="2">Vartojsonhash() is used with the following:</font></p>
		<p>
						&nbsp;</p>
		<ul style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<font face="Verdana, Arial, sans-serif" size="2"><i>propertyArray</i> 
			- Xbasic property array</font></li>
			<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<font face="Verdana, Arial, sans-serif" size="2"><i>hashProperty</i> 
			- name of the property in the Xbasic array to be used as the hash 
			key</font></li>
			<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<font face="Verdana, Arial, sans-serif" size="2"><i>flagSpecialTags</i> 
			- specifies if the property array uses the special {javascript} 
			directive to indicate that the JSON property should be generated as 
			Javascript and not as a string. Default if false.</font></li>
			<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<font face="Verdana, Arial, sans-serif" size="2"><i>flagCondense</i> 
			- indicates if the generated JSON should be condensed to eliminate 
			line breaks. </font> </li>
			<li style="font-family: Tahoma; font-size: 9pt; margin-left: .5in; margin-top: 0px; margin-bottom: 5px">
			<font face="Verdana, Arial, sans-serif" size="2"><i>
			flagUseDoubleQuotes</i> - indicates if strings and property names 
			should be double quoted. By default property names are not quoted 
			and strings are single quoted.</font></li>
		</ul>
		</blockquote>
		</td>
	</tr>
</table>
		<p>
						<b><font size="2">Syntax:</font></b><font size="2">&nbsp;
						vartojsonhash(p p ,c hashproperty [,l flagspecialtags 
						[,l flagcondense [,l&nbsp;flagusedoublequotes ]]])<br>
						C jsonHash = varToJSonHash(p propertyArray, c 
						hashProperty [, L flagSpecialTags [, L flagCondense [, 
						flagUseDoubleQuotes ]]])</font></p>
<p>
						&nbsp;</p>
		<blockquote>
			<blockquote>
				<blockquote>
					<p><b><font size="2">Example:</font></b></p>
					<p>&nbsp;</p>
					<p><font size="2">Consider the following Xbasic property array:</font></p>
					<p>&nbsp;</p>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p class=>&nbsp;</p>
								<p><font size="2" color="#333300">DIM P[0] as p<br>p[].name = &quot;John Smith&quot;<br>p[..].address = &quot;123 Main Street&quot;<br>p[..].age = 23<br>
								<br>p[].name = &quot;Fredia Malt&quot;<br>p[..].address = &quot;456 Center Lane&quot;<br>p[..].age = 33</font></p>
							</blockquote></td>
						</tr>
					</table>
					<p>&nbsp;</p>
					<p><font size="2">We can convert this to a JSON hash, using the 'name' 
						property as the hash index as follows:</font></p>
					<p><font size="2">dim jsonHash as c </font></p>
					<p>&nbsp;</p>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p><font size="2"><br></font>
								<font size="2" color="#333300">jsonHash = 
							vartojsonHash(p,&quot;name&quot;)</font></p>
							</blockquote></td>
						</tr>
					</table>
					<p>&nbsp;</p>
					<p><font size="2">The resulting JSON string looks like this:</font></p>
					<p>&nbsp;</p>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p><font size="2"><br><font color="#333300">{<br>&nbsp;&nbsp;&nbsp; 'John Smith' : {address: '123 Main Street',age: 23},<br>&nbsp;&nbsp;&nbsp; 'Fredia Malt' : {address: '456 Center Lane',age: 33}<br>}</font></font></p>
							</blockquote></td>
						</tr>
					</table>
					<p>&nbsp;</p>
					<p><font size="2">In this next example we use the <i>flagSpecialTags</i> 
						property</font></p>
					<p>&nbsp;</p>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p><font size="2"><br><font color="#333300">DIM P[0] as p<br>p[].name = &quot;John Smith&quot;<br>p[..].address = &quot;123 Main Street&quot;<br>p[..].age = 23<br>p[..].sayHello = &quot;{javascript}function() { 
							alert('hello John') }&quot;<br><br><br><br>p[].name = &quot;Fredia Malt&quot;<br>p[..].address = &quot;456 Center Lane&quot;<br>p[..].age = 33<br>
								<br>jsonHash = vartojsonHash(p,&quot;name&quot;, .t.)</font><br>&nbsp;</font></p>
							</blockquote></td>
						</tr>
					</table>
					<p>&nbsp;</p>
					<p>The resulting JSON string is:</p>
					<p>&nbsp;</p>
					<table border="1" width="85%" cellspacing="0" style="border-width: 0px">
						<tr>
							<td bgcolor="#F4F4DF" style="border-style: none; border-width: medium">
							<blockquote>
								<p><font size="2"><br><font color="#333300">{<br>&nbsp;&nbsp;&nbsp; 'John Smith' : {address: '123 Main Street',age: 23,sayHello: 
						function() { alert('hello John') }},<br>&nbsp;&nbsp;&nbsp; 'Fredia Malt' : {address: '456 Center Lane',age: 33}<br>}</font></font></p>
							</blockquote></td>
						</tr>
					</table>
				</blockquote>
				<p>&nbsp;</p>
			</blockquote>
</blockquote>

<h1>&nbsp;</h1>
<h1><a name="vartojsonstandard()">vartojsonstandard()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>vartojsonstandard(* var [,l flagspecialtags [,l flagcondense [,c indent [,l flagquotesonpropnames [,l jqueryformat [,l flaghonornulls [,* opsin ]]]]]]])
</p>


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_expression_to_json()">xbasic_expression_to_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>xbasic_expression_to_json(c script) </p>


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_from_json()">xbasic_from_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
<p>xbasic_from_json(c script) </p>


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="xbasic_script_to_json()">xbasic_script_to_json()</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
xbasic_script_to_json(c script)


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="'json class">'json class</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
		</blockquote>
		</td>
	</tr>
</table>
'json class


<p>&nbsp;</p>
<p>&nbsp;</p>


<h1><a name="dim json as extension::JSON">dim json as extension::JSON</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2" face="Verdana">A JSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
dim json as extension::JSON
		<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
	<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>








<!---HELPMETADATA: {"status":"accept","tags":"common","keywords":"server,api,guide"} --->
</body>
</html>