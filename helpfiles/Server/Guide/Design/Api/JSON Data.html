<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="../../../../../../../Users/Cian/Documents/My%20Web%20Sites/theme.css" />

<title>JSON_Data</title>

</head>

<body>

&nbsp;<p align="center">&nbsp;</p>

<div class="helpserver_toc">
<ul>
<li>
	<a href="#JSON Data">JSON Data</a>
</li>
<li>
	<a href="#Introduction">Introduction</a>
</li>
<li>
	<a href="#Using JSON with Xbasic">Using JSON with Xbasic</a>
	<ul>
		<li>
			<a href="#JSON and Sub-Objects">JSON and Sub-Objects</a>
		</li>
		<li>
			<a href="#JSON and Arrays">JSON and Arrays</a>
		</li>
	</ul>
</li>
<li>
	<a href="#Using JSON with Javascript">Using JSON with Javascript</a>
</li>
<li>
	<a href="#Using JSON to send Data between a Client and Server">Using JSON to send Data 
	from Client to Server</a>
</li>
<li>
	<a href="#JSON and sending data from Server to Client">JSON and sending data from Server to Client</a>
</li>
<li>
	<a href="#JSON from the Server-side, and Advanced Templates">JSON from the 
	Server-side and the Template Tester</a>
</li>
<li>
	<a href="#JSON Functions and Special Flags">JSON Functions and Special Flags</a>
</li>
<li>
	<a href="#Interrogating JSON Data">Interrogating JSON Data</a>
</li>
<li>
	<a href="#BSON Queries and JSON">BSON Queries and JSON</a>
</li>
<li>
	<a href="#Using JSON with Reports">Using JSON with Reports</a>
</li>
<li>
	<a href="#JSON, Reports, and Schema">JSON, Reports, and Schema</a>
</li>
<li>
	<a href="#Including Image data in a JSON schema object">Including Image data in a JSON schema object.</a>
</li>

<li><a href="#JSON Functions">JSON Functions</a>
</li>


</ul>
</div>


<h1 align="center"><span style="font-weight: 400">


<a name="JSON Data"><font size="7">JSON</font><font size="7"> Data</font></a></span>
</h1>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>

<p>&nbsp;</p>

<h1><a name="Introduction">Introduction</a></h1>


<p>&nbsp;</p>


<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
<p><font size="2"><font color="#0000FF">JSON</font>, or Javascript Object 
Notation, is simply a terse way of storing javascript objects. In many programming languages, 
to create an object you must first create a variable and then create the children 
of that variable independently. For example, you could define an 
object named 'o'&nbsp; in javascript like this:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = new Object();<br>
o.firstName = 'Selwyn';<br>
o.lastName = 'Rabins';</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">Using this method, the children of the 'o' object 
			would need to be created one by one; each one including the name of 
			its parent object. This results in a lot of code that is often difficult to interpret. 
			In this case the object 'o' has a very simple name. However, it is 
			not be hard to imagine situations in which the object name is much 
			longer or where the programmer wants a child of the object to be an 
			array or an object in and of itself. JSON provides a compelling 
			alternative that makes this task straightforward. Rather than define 
			each child individually, all of the children that belong to an 
			object are enclosed in curly brackets. Each child in the object, 
			except for the last child, is then delimited using a comma.&nbsp;
			</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">var o = {<br>
firstname: 'Selwyn',<br>
lastName: 'Rabins'<br>
}</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">The simplicity of JSON's format has made it 
			ubiquitous in Web application development. JSON is very frequently used for data storage, where 
			it is gaining in popularity over xml, and many websites return data in JSON format. 
			This makes it possible, for example, to pull news stories off the 
			web in json format, work with apps like twitter, or call external servers 
and ask for things. Once you acquire this JSON it is then very easy to 
			manipulate. Among other things you can filter out fields, add 
			fields, or extract an individual element from the data. JSON is the ideal way for sending 
			complex data from the client to the server, or from the server to 
			the client. Having a good understanding of JSON is therefore very 
			helpful in building web applications.</font></p>
			<p>&nbsp;</p>
			<p><font size="2">In the javascript language JSON is processed 
			inline. This means that you can use JSON in javascript and it will 
			be automatically recognized by the javascript engine. You can add 
			objects, arrays, and literal values to your JSON data, write some 
			javascript code to build a given part of an object, and it will just 
			work. When the javascript engine comes across any JSON data it knows 
			that a sub-object is a sub-object, an array is an array, and a 
			literal value is a literal value. You do not have to parse JSON in 
			javascript. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Most of Alpha Anywhere's server-side code is 
			written in Xbasic, a language that does not support JSON natively. 
			However, Alpha Anywhere does support a lot of methods that work with JSON 
			and allow you to both import and export JSON to and from your 
			components. How do these methods work? When you create a JSON 
			object, the children of that object are read in Xbasic as a string. 
			The Xbasic methods then take that string, work against it, and return 
			either JSON or Xbasic. Alpha Anywhere's set of methods can do the 
			same thing for Xbasic objects, returning either JSON or Xbasic. This 
			gives you the ability to parse a string into an object and an object into a string. 
			For example, take the following Xbasic object:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
dim o.firstName as c = &quot;Selwyn&quot;<br>
dim o.lastName as c = &quot;Rabins&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
<p>&nbsp;</p>
<p><font size="2">You could create an 'o' object like the one above in Xbasic. 
It would work, but you would end up having to write a lot of unnecessary code 
for each of the 'o' parent object's children. Include Alpha Anywhere's JSON 
parse method, and you can easily simplify things by placing the data for 'o' 
object's children into a JSON format:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
o = json_parse(&quot;{firstName: 'Selwyn', lastName: 'Rabins'}&quot;)</font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p align="left">&nbsp;</p>
			<p align="left">&nbsp;</p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<h1>&nbsp;</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>&nbsp;</h1>
<h1><a name="Using JSON with Xbasic">Using JSON with Xbasic</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The example below demonstrates how you can apply this 
			information in building a <font color="#0000FF">UX component</font> 
			using Xbasic on the server-side that uses JSON.&nbsp; To be used as 
			Xbasic, JSON needs to be a string. For more information you can follow 
			this video </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_1.swf">
								<font size="2"><u>here</u></font></a><font size="2">.
			</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Create JSON from Xbasic:</b></p>
<p>&nbsp;<br>
								1. In Alpha Anywhere's toolbar click on the
<font color="#0000FF">Interactive Window</font> button. This will open the Code 
editor.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive.png" width="241" height="53"></p>
<p>&nbsp;</p>
<p>2. In the Code Editor, go to the <font color="#0000FF">Interactive</font> tab 
and define the following dot variable name 'pp' by entering this code. This is 
an Xbasic object. Hit <font color="#0000FF">Enter</font> at the end of every 
line.</p>
<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>3. Now add <i>?json_generate(pp)</i> to the end of the pp object. Hit
<font color="#0000FF">Enter</font> again.</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
						<p><font size="2" color="#333300">?json_generate(pp)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>4. You should see a generated JSON representation of the pp object. You have 
succesfully serialized the 'pp' 
object into a JSON string.</p>
<p>&nbsp;</p>
			
<p align="center">
<img border="0" src="images/interactive2.png" width="295" height="195"></p>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">In <font color="#0000FF">JSON</font> objects start 
			with a curly bracket and end with a closed curly bracket. Inside the 
			object are name value pairs. All property names are double quoted. 
			In this object, for example, the property names are &quot;Name&quot;, &quot;Age&quot;. 
			JSON can also encode the logical values true and false. Add a new 
			'Married' property to your Xbasic code and set it to true <i>'pp.Married 
			= .t.'</i>.</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">&nbsp;dim pp as p</font></p>
<p><font size="2" color="#333300">pp.Name = &quot;Fred&quot;</font></p>
<p><font size="2" color="#333300">pp.Age = 30</font></p>
						<p><font size="2" color="#333300">pp.Married = .t.</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">Now run this object again using ?json_generate(pp). 
			The generated JSON should look like this:</font></p>
			<p>&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">= {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : 
true</font></p>
<p><font size="2" color="#333300">}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
			<p><font size="2">In addition to creating JSON data from Xbasic you 
			can also instatiate an object from a JSON string. The following 
			example will demostrate how.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Create Xbasic from JSON:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive.png" width="241" height="53"></p>
<p>&nbsp;</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button on the top 
left of the Code Editor's toolbar.</p>
<p align="center"><br>
<img border="0" src="images/interactive3.png" width="253" height="105"></p>
<p align="left">3. This will open a new tab in the Code Editor. Enter the 
following code. Hit <font color="#0000FF">Enter</font> after every line.</p>
<p align="left">&nbsp;</p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
&nbsp;<p><font size="2" color="#333300">dim txt as c </font> </p>
<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
<p><font size="2" color="#333300">{</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Married&quot; : true</font></p>
<p><font size="2" color="#333300">}</font></p>
<p><font size="2" color="#333300">%str%</font></p>
<p><font size="2" color="#333300">dim pp2 as p</font></p>
<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
<p><font size="2" color="#333300">debug(1)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<table border="1" width="100%" style="border-width: 0px">
				<tr>
					<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
					<blockquote>
						<p><br>
						<font size="2"><b>Note:</b> In Xbasic the angle bracket, angle bracket 
						&lt;&lt; defines a string whose definition expands over 
multiple lines. Here we have defined all of our JSON data as an xbasic string 
						and have given that string a variable name of 'txt'. A 
						Xbasic object named pp2 is then created that takes as 
						its value the parsed txt variable.</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>4. The <i>debug(1)</i> has been added to the end of this code so we can see 
the JSON data in the debugger. Click the<font color="#0000FF"> lightning bolt</font> 
in the toolbar to run the code.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive4.png" width="259" height="67"></p>
<p>&nbsp;</p>
<p>5. The<font color="#0000FF"> Xbasic debugger</font> will open. Type '<i>pp2</i>' 
into the <font color="#0000FF">Expression</font> entry box at the bottom of the 
debugger. </p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive5.png" width="177" height="93"></p>
<p align="left">6. Hit <font color="#0000FF">Enter</font> and then click the
<font color="#0000FF">expand</font> or 'plus' button
<img border="0" src="images/expand.png" width="9" height="9">, to the left of the 
Expression box, to show all of the JSON data in the pp2 object.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive6.png" width="240" height="77"></p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive7.png" width="255" height="116"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>


<h1><a name="JSON and Sub-Objects">JSON and Sub-Objects</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">The previous example showed how to parse a string 
			containing JSON data that contained simple literal values. However, 
			what if you wanted 
			to create sub-objects within your data? As the objects in the 
			examples above demonstrate, all properties in JSON are delimited 
			with a comma; except for the last property which has nothing after 
			it. As long as a property is delimited and has a property name in 
			double quotes followed by a colon, the definition can be an object, 
			array, or literal. To see how to create a sub-object in JSON that 
			can be used with Xbasic watch this
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_2.swf">
								<u>video</u></a>, or follow the guide below.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Creating a Sub-Object in JSON to use with Xbasic:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button
<img border="0" src="images/newpage.png" width="14" height="15"> on the top 
left of the Code Editor's toolbar.</p>
<p>3. Enter the same code into the Code Editor that you did in step 3 of the 
'<i>Create Xbasic from JSON</i>' example. The code should look like this.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive8.png" width="270" height="186"></p>
<p align="center">&nbsp;</p>
<p align="left">4. Now place a comma after the &quot;<i>Married</i>&quot; property. Hit 
enter and on the line below the &quot;<i>Married</i>&quot; property add a new property 
name called &quot;<i>Address</i>&quot;.</p>
<p>5. <font size="2">Place a colon next to the 'Address' and a set of curly 
brackets. Inside the brackets add three more properties; a &quot;Street&quot; property, 
			&quot;Number&quot; property, and a &quot;City&quot; property, </font></p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<blockquote>
	<p><font size="2" color="#333300"><br>
	dim txt as c </font> </p>
	<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
	<p><font size="2" color="#333300">{</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Name&quot;: &quot;Fred&quot;,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Age&quot;: 30,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Married&quot; : true,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Address&quot; : {</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </font> </p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;Number&quot; : 123,</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	&quot;City&quot; : &quot;Boston&quot;</font></p>
	<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	}</font></p>
	<p><font size="2" color="#333300">}</font></p>
	<p><font size="2" color="#333300">%str%</font></p>
	<p><font size="2" color="#333300">dim pp2 as p</font></p>
	<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
	<p><font size="2" color="#333300">debug(1)</font></p>
</blockquote>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
			<p>&nbsp;</p>
<p>6. Now click the <font color="#0000FF">lightning bolt</font> icon
<img border="0" src="images/lightning.png" width="16" height="15"> in the Alpha 
Anywhere toolbar to run this code. The debugger should open. type pp2 into the 
Expression entry box at the bottom of the debugger and hit <font color="#0000FF">
Enter</font>.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive9.png" width="398" height="70"></p>
<p align="center">&nbsp;</p>
<p>7. Click the <font color="#0000FF">Expand</font> or plus button
<img border="0" src="images/expand.png" width="9" height="9"> to the right of 
the Expression entry.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive10.png" width="466" height="113"></p>
<p align="center">&nbsp;</p>
<p align="left">8. Click on the <font color="#0000FF">Address</font> value to 
expand the Address sub-object that you defined. You should see all of the JSON 
data from the sub-object you defined inside of your Xbasic code.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/interactive11.png" width="350" height="88"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="JSON and Arrays">JSON and Arrays</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p><font size="2"><font color="#0000FF">Arrays</font> in JSON start with a 
square bracket <font color="#0000FF">[ </font>and end with a square bracket
<font color="#0000FF">]</font>. JSON arrays are base 0, meaning the first 
element in a JSON array is 0, the second element is 1, the third element is 2, 
and so on. This is different from Xbasic which is base 1. Arrays can contain 
literal values or objects themselves. This example will show how to add an array 
property to your JSON data named &quot;Children&quot;, to be used in an Xbasic object 
named pp2. This array will use objects as its elements. The first element in the 
array will be this object <i>{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3} </i>which has the 
&quot;Name&quot; of &quot;John&quot; and an &quot;Age&quot; of 3. Like all objects, each of the properties 
within this object are delimited by a comma, with the exception on the last 
property in the object. For more information on the steps that follow watch this&nbsp;</font><a href="http://www.ajaxvideotutorials.com/V12Videos/json_xbasic_3.swf"><font size="2"><u>video</u></font></a></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Creating an Array in JSON to use with Xbasic:</b></p>
<p>&nbsp;</p>
<p>1. In Alpha Anywhere's toolbar click on the <font color="#0000FF">Interactive 
Window</font> button. This will open the Code editor.</p>
<p>2. The <font color="#0000FF">Code Editor</font> will open. Click the
<font color="#0000FF">New Script using Xbasic Editor</font> button
<img border="0" src="images/newpage.png" width="14" height="15"> on the top 
left of the Code Editor's toolbar.</p>
<p>3. Enter the following code into the New Script page in the Code Editor.</p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p><font size="2" color="#333300"><br>
dim txt as c </font></p>
<p><font size="2" color="#333300">txt = &lt;&lt;%str%</font></p>
<p><font size="2" color="#333300">{</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Name&quot;: &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Age&quot;: 30,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Married&quot; : true,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Address&quot; : {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Street&quot; : &quot;Main Street&quot;,&nbsp;&nbsp;&nbsp;&nbsp; </font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;Number&quot; : 123,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&quot;City&quot; : Boston</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font>
<font size="2">&nbsp;&quot;Children&quot; : [</font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3}</font></p>
<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
]</font></p>
<p><font size="2" color="#333300">}</font></p>
<p><font size="2" color="#333300">%str%</font></p>
<p><font size="2" color="#333300">dim pp2 as p</font></p>
<p><font size="2" color="#333300">pp2 = json_parse(txt)</font></p>
<p><font size="2" color="#333300">debug(1)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
<p>&nbsp;</p>
<p>4. Create two more elements for the &quot;Children&quot; array. As with objects, each 
element in the array should have a <font color="#0000FF">trailing comma</font>; 
excepting the last element which has no comma. The result should look something 
like this:</p>
<p>&nbsp;</p>


<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p>&nbsp;</p>
<p><font size="2" color="#333300">&quot;Children&quot; : [</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;John&quot;, &quot;Age&quot; : 3},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Sally&quot;, &quot;Age&quot; : 5},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&quot;Name&quot; : &quot;Kim&quot;, &quot;Age&quot; : 7}</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
]</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
	</div>		
			
			
			
			
			<p>&nbsp;</p>
<p>5. Now click the<font color="#0000FF"> lightning</font> icon in the toolbar 
and run the code. The <font color="#0000FF">Debugger</font> should open. Enter 
pp2 into the <font color="#0000FF">Expression</font> box at the bottom on the 
debugger.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/array1.png" width="446" height="70"></p>
<p align="center">&nbsp;</p>
<p align="left">6. Click the <font color="#0000FF">Expand</font> or 'plus' 
button next to the Expression box to see all of the properties in the pp2 
object.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/array2.png" width="482" height="136"></p>
<p>&nbsp;</p>
<p>7. Click on the <font color="#0000FF">Children</font> array property that you 
defined. The elements within that property will be displayed.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/array3.png" width="328" height="90"></p>
<p align="center">&nbsp;</p>
<p align="left">8. Now click on one of the elements in your Children array in 
the <font color="#0000FF">Value</font> list. You should be able to see the 
object properties for each element.</p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/array4.png" width="255" height="68"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">This example has shown how to create a complex Xbasic 
			object using data parsed from JSON that includes an array. You can 
			also pass things from Xbasic into JSON using <i>json_generate()</i>. 
			Here is How.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p><b>Show your Xbasic object's data in JSON form:</b></p>
<p>&nbsp;</p>
<p>8. Remove the <i>debug(1)</i> line in your code and add this to the end 
instead. This code will output the JSON from the pp2 Xbasic object using the <i>
json_generate()</i> method. The <i>showvar()</i> method will display the result.</p>
<p>&nbsp;</p>
<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p>&nbsp;</p>
<p><font size="2" color="#333300">dim txt2 as c<br>
txt2 = json_generate(pp2)<br>
showvar(txt2)</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>		
			
			
			
			
<p>9. Click the lightning icon
<img border="0" src="images/lightning.png" width="16" height="15"> to
<font color="#0000FF">run</font> the code. A Variable dialog will open 
displaying the pp2 objects data in JSON form. The result should look something 
like this:</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/array5.png" width="283" height="465"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON with Javascript">Using JSON with Javascript</a></h1>
<p>&nbsp;</p>



<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">So far, this guide has shown how to serialize 
			objects, but you can also use Javascript on the client-side to work 
			with JSON. This example will demonstrate how you can incorporate 
			JSON into a UX component and then manipulate the JSON data using 
			Javascript. For more information watch this video
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_4.swf">
								<u>Part 1</u></a> and </font>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientside_5.swf">
			<font size="2"><u>Part 2</u></font></a><font size="2">. To recap, we have 
			covered the following about JSON objects so far. A JSON object 
			starts and ends with curly brackets and has as many name value pairs 
			as you want within those 
			curly brackets. Each name value pair is delimited with a comma. Each 
			entry can be an array, a literal, or an object. In this way it is 
			possible to represent a very 
			complex object using JSON while still maintaining the ability to 
			easily read and understand it</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Output a JSON on the Client-side in a UX Component:</b></p>
<p><br>
								1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the Start with a blank UX Component radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs4.png" width="163" height="173"></p>
<p align="center">&nbsp;</p>
<p>4. On the Controls page, open the <font color="#0000FF">Other Controls</font> dropdown that appears 
in the Design menu. Double click on the <font color="#0000FF">[Button]</font> 
control option to add it to your UX component.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs7.png" width="201" height="116"></p>
<p align="center">&nbsp;</p>
<p>5. Add a
<font color="#0000FF">[Static text:]</font> control to your component in the same 
way. </p>
<p>6. You can arrange the controls using the up and down arrows in the toolbar such that 
they go <font color="#0000FF">[Button], [Static Text:].</font></p>
<p align="center"><br>
<img border="0" src="images/jsonjs8.png" width="268" height="58"></p>
<p align="center">&nbsp;</p>
<p>7. Click on the <font color="#0000FF">[Button] </font>control in your list to highlight it. Go over 
to the Control Properties list to the Right. Find Button Properties.</p>
<p>8. In the Button Properties section find the <font color="#0000FF">Button text</font> property and change 
the button text to 'Objects'.</p>
<p>9. Scroll down the Properties list until you reach the <font color="#0000FF">Javascript 
(Touch. Mouse. Pointer Events)</font> section. 
Click the button <img border="0" src="images/abutton.png" width="15" height="14"> next to the <font color="#0000FF">click</font> property.</p>
<p>10. The <font color="#0000FF">Edit Click Event</font> dialog will open. Click 
the <font color="#0000FF">Text mode</font> radio button. In the Javascript 
Attribute work area write <i>objectsTest(); </i>and click <font color="#0000FF">
Save</font>. </p>
<p align="center">&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs9.png" width="303" height="162"></p>
<p>&nbsp;</p>
<p>11. Now Click on the <font color="#0000FF">[Static Text:]</font> control that you created. In the 
Properties menu under Static Text Properties find the Static text property.</p>
<p>12. Next to the Static text property enter the following html <i>&lt;div 
id=&quot;msg1&quot;&gt;&lt;/div&gt;</i>.</p>
<p align="center">
<img border="0" src="images/jsonjs2.png" width="313" height="64"></p>
<p>&nbsp;</p>
<p>13. Still in the Controls page, find the Code dropdown in the menu and under 
it click the <font color="#0000FF">Javascript functions</font> option. Enter the 
following code to define the <i>objectsTest()</i> function.<br>
&nbsp;</p>
		

		<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
<p><font size="2" color="#333300"><br>
function objectsTest() {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var obj = {</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Firstname&quot; : &quot;Fred&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Lastname&quot; : &quot;Smith&quot;,</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Children&quot; : [</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 10},</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
	{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
<p>&nbsp;</p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var msg = JSON.stringify(obj);</font></p>
<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; $('msg1').innerHTML = msg;&nbsp;&nbsp;
</font></p>
<p><font size="2" color="#333300">}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>
			
			
			
			
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Note:</b> Here we have designed a button that will create an object in Javascript, serialize 
			that object to JSON, and then print the JSON data out. The <i>var 
			obj</i> is a javascript variable object that is initialized by 
			passing into it a JSON string. This is the
			equivalent on the Xbasic side to using JSON parse to instantiate an xbasic 
			object from a JSON string. In this example we are initializing an 
			object using an object literal. An object literal and JSON look 
			similar but are not technically identical. Our object literal 
			contains a <i>Firstname</i> property, <i>Lastname</i> property, and 
			a <i>Children</i> property which is an array containing additional 
			object properties. After defining the object literal, a call javascript method,
			<i>JSON.stringify()</i>, is used to 
			serialize the object into a string with the name <i>msg1</i>. Using 
			innerHTML, this <i>msg1</i> string is then inserted into the text of 
			the div that we defined for the [Static text] control in our 
			component. This means that when the <i>'Objects'</i> button is 
			clicked, using javascript, the [Static text] control will be filled 
			in with html that displays the JSON data. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">&nbsp;</p>
<p align="left">14. Go to <font color="#0000FF">Working Preview</font> and click 
on the '<font color="#0000FF">Objects</font>' button.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/jsonjs.png" width="594" height="69"></p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="center">&nbsp;</p>
<p align="left"><b>Create a Button that Parses JSON data:</b></p>
<p align="left">&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p align="left">4. On the Controls page, go to the <font color="#0000FF">Data Controls</font> 
dropdown section in the design menu and double click on the
<font color="#0000FF">[TextArea]</font> control option. </p>
<p align="center">
<img border="0" src="images/jsonjs5.png" width="252" height="95"></p>
<p align="center">&nbsp;</p>
<p align="left">5. In the <font color="#0000FF">New Control</font> dialog that opens select
<font color="#0000FF">'Create a single new control'</font>. Give the control the
<font color="#0000FF">Name</font> <i>jsonIn</i> and the <font color="#0000FF">
Label</font> <i>Json In</i>. Under Data Type select <font color="#0000FF">
Character</font> and click <font color="#0000FF"><u>O</u>K</font>.</p>
<p align="center">
<img border="0" src="images/jsonjs6.png" width="220" height="215"></p>
<p align="center">&nbsp;</p>
<p align="left">6. On the Controls page, open the <font color="#0000FF">Other Controls</font> dropdown that appears 
in the Design menu. Double click on the <font color="#0000FF">[Button]</font> 
control option to add it to your UX component.</p>
<p>7. Select the<font color="#0000FF"> [TextArea]</font> control that you 
labeled <i>Json In</i>. Look to the right. In the <font color="#0000FF">Field 
properties</font> section inside the Control Properties list, find the
<font color="#0000FF">Default value</font> property.</p>
<p>9. Change the Default value to be this string of JSON.</p>
<p>&nbsp;</p>
			
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<p><br>
						<font size="2" color="#333300">{&quot;Firstname&quot; : &quot;Fred&quot;,&quot;Lastname&quot; 
						: &quot;Smith&quot;,&quot;Children&quot; : [{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 
						10},{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}]}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>&nbsp;</p>
<p>10. Select the<font color="#0000FF"> [Button]</font> control in the control list. In the Properties list on the right find the 
<font color="#0000FF">Button Properties</font> section.</p>
<p>11. In the Button Properties section, change the <font color="#0000FF">Button text</font> property to read 
Parse JSON.</p>
<p>12. Scroll down to the <font color="#0000FF">Javascript (Touch. Mouse. Pointer Events)</font> properties 
section and click the button next to the 'click' property.</p>
<p>13. The Edit Click Event Editor will appear. Click on the Text Mode radio 
button. In the Javascript Attribute work area type <i>parseJSON(); </i>and click
<font color="#0000FF">Save</font>.</p>
<p>14. In the design menu open the <font color="#0000FF">Code</font> dropdown 
and click on the Javascript functions option. Under the <i>objectsTest()</i> 
function that you defined earlier write the following code.</p>
<p>&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><font size="2" color="#333300"><br>
			function parseJSON()&nbsp; {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var json = {dialog.object}.getValue('jsonIn')</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var obj = JSON.parse(json);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(obj 
	['Children'][1]['Name']);</font></p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Note:</b> Just like on the Xbasic side where we use 
			json_parse and json_generate there exists similar features in 
			javascript on the client-side. In this example, the parse JSON 
			button is taking a string of JSON from a text area field , parsing it , 
			and then doing an alert from the name field of the second item in the 
			children array. Square brackets are used for syntax in order to read a value 
			in the 'Children' array, that was defined in our JSON data . You can 
			also use dot notation to accomplish this, for example obj.children. 
			The [1] next to the Children array indicates that we are calling the 
			second element of that array. Javascript arrays are zero based, 
			meaning the first item in the 
			array is always 0 the second item is 1. The second element, in the 
			JSON data here, is an object containing a &quot;Name&quot; property, &quot;Joan&quot;, 
			and an &quot;Age&quot; property, '12'. The ['Name'] that follows the [1] in 
			our code means that we are only interested in returning the &quot;Name&quot; 
			property. When you run this component and click the parse JSON button, 
			an alert should return &quot;Joan&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p align="left">15. Now go to Working Peview and click the Parse JSON button. 
You should see an alert pop up giving you the name of the second element in the 
Children array from the JSON data you defined for the Text area control.</p>
<p>&nbsp;</div>			
			
			
			
<p align="center">
<img border="0" src="images/jsonjs3.png" width="458" height="205"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><a name="Using JSON to send Data between a Client and Server">Using JSON to send Data 
from Client to Server</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">JSON is useful for passing information form the 
			client to the server.&nbsp; One way to accomplish this is by passing 
			information into an Ajax callback. In this case, you might have a button that is tied to an AJAX callback which 
turns around and calls up some Xbasic. You could then add some of Alpha 
			Anywhere's JSON functions to that Xbasic code to allow you to go out, get JSON data from an external source, and then 
return that data to your component in Xbasic.</font></p>
			<p>&nbsp;</p>
<p><font size="2">Xbasic is currently the coding language on the 
server. Sometimes you need to turn Xbasic code into something the client side 
browser can recognize, i.e Javascript. The easiest way to get into the client is 
through Javascript. When someone 
clicks a button do an Ajax callback, that callback is handled in Xbasic, which does 
some manipulations and then returns an object to the 
client browser in the form of a string. The browser, which&nbsp; is waiting for the response, 
then takes that object and generates some actual JSON, that it returns to the client.
</font></p>
			<p>&nbsp;</p>
			<p><font size="2">When you want to parse a complex set of data, you can parse JSON data back into 
			an ajax 
			callback and, on the Xbasic side, parse that data and extract values 
			from it. For more information on how to do this watch these videos
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_5.swf">
								<u>Part 1</u></a> and
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_clientToServer_6.swf">
								<u>Part 2</u></a> or follow the examples below.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p align="left">4. On the Controls page, go to the <font color="#0000FF">Data Controls</font> 
dropdown section in the design menu and double click on the
<font color="#0000FF">[TextArea]</font> control option. </p>
<p>5. In the <font color="#0000FF">New Control</font> dialog that opens select
<font color="#0000FF">'Create a single new control'</font>. Give the control the
<font color="#0000FF">Name</font> <i>jsonIn</i> and the <font color="#0000FF">
Label</font> <i>Json In</i>. Under Data Type select <font color="#0000FF">
Character</font> and click <font color="#0000FF"><u>O</u>K</font>.<br>
								&nbsp;</p>
<p>6. Select the<font color="#0000FF"> [TextArea]</font> control that you 
labeled <i>Json In</i>. Look to the right. In the <font color="#0000FF">Field 
properties</font> section inside the Control Properties list, find the
<font color="#0000FF">Default value</font> property.</p>
<p>7. Change the Default value to be this string of JSON.</p>
<p>&nbsp;</p>
			
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<p><br>
						<font size="2" color="#333300">{&quot;Firstname&quot; : &quot;Fred&quot;,&quot;Lastname&quot; 
						: &quot;Smith&quot;,&quot;Children&quot; : [{&quot;Name&quot; : &quot;Jackie&quot;, &quot;Age&quot; : 
						10},{&quot;Name&quot; : &quot;Joan&quot;, &quot;Age&quot; : 12}]}</font></p>
					</blockquote>
					</td>
				</tr>
			</table>
			</div>
			
			<p>
								<br>
								8. On the <font color="#0000FF">Controls</font> page, open the 
			<font color="#0000FF">Other Controls</font> 
dropdown in the menu and double click on <font color="#0000FF">[Button]</font> control to add it to the UX 
component.</p>
<p>9.&nbsp; With the Button control selected, look in the control 
<font color="#0000FF">Properties</font> list 
on the right. Under the <font color="#0000FF">Button Properties </font>section, find the 
<font color="#0000FF">Button text</font> 
property.</p>
<p>10. Change the Button text property to read 'Make and Ajax Callback'</p>
<p>11. Scroll down the Properties list until you reach the <font color="#0000FF">Javascript (Touch. Mouse. Pointer Events)</font> section. 
Click the button next to the <font color="#0000FF">click</font> property.</p>
<p>12. The <font color="#0000FF">Edit onClick Event </font>dialog will open. Select the 
<font color="#0000FF">Action Javascript</font> radio 
button option at the top and click the <font color="#0000FF">Add New Action</font> button.</p>
<p>13. In the Action Javascript Select and Action dialog select 
<font color="#0000FF">Action Callbacks</font> <font color="#0000FF">and Javascript</font> from the Categories list on the left.</p>
<p>14. From the<font color="#0000FF"> Actions:</font> list on the right select<font color="#0000FF"> Ajax Callback</font>. And click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback.png" width="381" height="64"></p>
<p align="center">&nbsp;</p>
<p align="left">15. An <font color="#0000FF">Action Javascript Ajax Callback</font> dialog will open. </p>
<p align="left">16. In the <font color="#0000FF">Ajax Callback</font> section of the dialog, leave the
<font color="#0000FF">Callback type</font> property set to <font color="#0000FF">
InternalXbasicFunction</font> and type <i>xb</i> next to the
<font color="#0000FF">Function name</font> property.<br>
								17. In the Advanced section of the dialog, find 
the <font color="#0000FF">Additional data to submit</font> property and next to it type <i>additionalAjaxData()</i>. 
Click <font color="#0000FF">OK</font>,<font color="#0000FF"> OK</font>, and
<font color="#0000FF">Save</font>.</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback2.png" width="515" height="178"></p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">Note: The <font color="#0000FF">Additional data to submit</font> property 
			represents the data that is going to be submitted from the client 
			side to the server side. This property allows you to use an Xbasic 
			function to return data. You can specify additional data to submit 
			in the Action Javascript Ajax Callback genie. This data will be 
			available inside your custom event handler, in this case the click 
			event. What is expected from the Additional data to submit property 
			is a Query string, name value pairs delimited with an &amp; sign, type 
			in a Review help text in Action Javascript Ajax Callback Action. 
			This feature is useful when you want to generate arbitrary information 
			on the client side. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">18.&nbsp; Click on the <font color="#0000FF">Code</font> 
dropdown and select <font color="#0000FF">Javascript functions</font>. In the 
Javascript workspace add the following code. </p>
<p align="left">&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p align="left"><font size="2" color="#333300">function 
			additionalAjaxData() {</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			var json = {dialog.object}.getValue('jsonIn');</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			//return '__additionalData=' + json;</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			var data = A5.ajax.buildURLParam('__additionalData',json);</font></p>
			<p align="left"><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			return data;</font></p>
			<p align="left"><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>



<p align="left">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2"><b>Note:</b> Here we are reading the value that is in 
			the text area field and sending back to the server a name value pair. 
			This name value pair is 
			formatted like a query string. The 
			value part of the name value pair needs to be URL encoded. Inside 
			the Alpha JS library there is a buildURL function that takes its first argument as name 
			and its second argument as a value. The buildURL function then encodes that value. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">&nbsp;</p>
<p align="left">19. From the Code dropdown click on the <font color="#0000FF">
Xbasic functions</font> option. Add the following Xbasic.</p>
<p align="left">&nbsp;</p>


<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function xb as c (e as p)</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim json as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; json = e.__additionalData</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim p as p 
			</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; p = json_parse(json)</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim msg as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; msg = &quot;Message from Xbasic. The name of the second 
	child is: &quot; + p.children[2].name</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; dim js as c</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; js = &quot;alert('&quot; + js_escape(msg) + &quot;');&quot;</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; xb = js</font></p>
			<p><font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">This code takes the string of JSON data that we 
			defined earlier and sends it back to the server as part of an ajax 
			callback. It then parses this information on the server using the 
			parse function. Afterward, it extracts the name field, from the second array item in the childrens array, 
			and uses this to construct an object that is fed into an alert message 
			and passed to the client. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Going line by line this is what this looks like. 
			The <i>xb</i> in this case is the actual Xbasic function that will handle 
			the Ajax callback. In the line <i>dim json as c,</i> we create an 
			Xbasic character variable called <i>json</i>. This variable is then 
			set to <i>= e.__additionalData</i>.&nbsp; The <i>e</i> is a pointer 
			variable that is passed into the <i>xb</i> function. It points to an 
			object that contains a property called <i>additionalData</i>, which 
			is a string that is sent back as part of the Ajax callback. The <i>p</i> 
			in the line <i>dim p as p</i> defines an second Xbasic pointer 
			variable that is set to <i>=json_parse(json)</i>. The <i>json_parse()</i> 
			function parses a string, in this case the <i>json</i> string that 
			we defined, in JSON format and returns an Xbasic variable. </font></p>
			<p>&nbsp;</p>
			<p><font size="2">Next we create a javascript 
			response to send back to the client. In <i>dim msg as c</i> we 
			create yet a third Xbasic variable, a character variable called <i>
			msg</i>, that contains a string and the second element of the 
			children array; the array that was included in the string that we 
			parsed. In Xbasic arrays are 1 based, meaning the first element in 
			the array is [1] and the second element is [2]. This is unlike 
			Javascript which is 0 based. When <i>msg</i> is defined it is then 
			passed into a <i>js</i> object that is tied to a javascript alert. When you return a string, 
			you need to make sure it is Javascript safe. In <i>dim js as c</i>, 
			a <i>js</i> object is created that is set to be an alert message 
			that to be sent back to the client. Xbasic still views this alert 
			message as a string, but javascript will interpret it as javascript. 
			The line <i>xb = js</i> is equivalent to a <i>return</i> statement 
			in javascript. In this case we are returning the <i>js</i> string to 
			the javascript that operates the client side code.<br>
			&nbsp;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>



<p align="left">&nbsp;</p>
<p align="left">20. Now go to Working Preview and click the Make Ajax Callback 
button. You should see something like this:</p>
<p align="left">&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxcallback3.png" width="663" height="200"></p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p>
								<br>
<h1><a name="JSON and sending data from Server to Client">JSON and sending data from Server to Client</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">In this example, look at how you can make a callback from the client 
			to the server to retrieve data from the server in JSON format and 
			then work with the data that was sent back from the server and 
			display it on the client. In some nicely formated html on the client 
			side</font></p>
			<p>&nbsp;</p>
			<p>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_7.swf">
			<font size="2">Watch Video - Part 1</font></a><font size="2"><br>
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_8.swf">Watch Video - Part 2</a><br>
			</font>
			<font size="2">
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_9.swf">
			Watch Video - Part 3</a></font><br>
			<font size="2">
			<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_10.swf">
								Watch Video - Part 4</a></font></p>
		</blockquote>
		<p>&nbsp;</td>
	</tr>
</table>
<p>&nbsp;</p>
<p><b>Use JSON to send data from the Server to the Client:</b></p>
<p>&nbsp;</p>
<p>1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</p>
<p>3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </p>
<p>4. Open the Other Controls dropdown and double click on [Button] to add a 
button to the UX component. </p>
<p>5. Click on the <font color="#0000FF">[Static Text]</font> control in the Other Controls dropdown to add a 
static text control to the UX component.</p>
<p>6. Select the Static test control and look at the Control Properties list. In 
the Static Text Properties section change the Static text property to this:</p>
<p>&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><br>
			<font size="2" color="#333300">&lt;div id=&quot;msg2&quot;&gt;&lt;/div&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>&nbsp;</p>
<p>7. Select the button that you added to you component. Go to the the 
Properties list on the right. </p>
<p>8. In the Button Properties section change the Button text property to read
<i>Fetch data from server</i>.</p>
<p>9. Go to the <font color="#0000FF">Javascript</font> <font color="#0000FF">(Touch. Mouse. Pointer Events)</font> 
section of the Properties list and 
choose the <font color="#0000FF">click</font> property</p>
<p>10. The Edit Click Event dialog will open. Leave the Action Javascript radio 
button selected.</p>
<p>11. Click the Add New Action button. The Action Javascript - Select an Action 
dialog will open.</p>
<p>12. In the Categories: list select Ajax Callbacks and Javascript option. In 
the Actions: list select Ajax Callback. Click OK.</p>
<p>13. The Action Javascript - Ajax Callback Action genie will appear. Set the<font color="#0000FF"> Function name</font> 
property to be 
xb2</p>
<p>14. Click the button
<img border="0" src="images/abutton.png" width="15" height="14"> next to the 
<font color="#0000FF">After callback complete Javascript</font> property. </p>
<p>15. The After Callback Complete Javascript dialog will open. Add a function 
called <i>expandTemplate(); </i>and click <font color="#0000FF"><u>O</u>K</font> 
and <font color="#0000FF"><u>O</u>K</font> and <font color="#0000FF"><u>O</u>K</font> 
again. <font color="#0000FF">Save</font>.</p>
<p>&nbsp;</p>
<p align="center">
<img border="0" src="images/ajaxserverclient.png" width="195" height="92"></p>
<p align="center">&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p><font size="2"><b>Note:</b> As you probably know Ajax is asynchronos. In 
creating this Ajax callback this means that you can't have the function, <i>
expandTemplate()</i>, be triggered immediately. As a result, in this example you 
can not 
add more actions to the <font color="#0000FF">Edit Click Event</font> dialog 
unless you click the <font color="#0000FF">Run actions 
synchronously</font> button at the bottom of the dialog. In this example, we are 
leaving this unchecked.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>16. Open the Code dropdown and click on the Javascript functions page. Enter the following code:</p>&nbsp;

<div align="center">
<table border="1" width="9in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			//A5.u.element.setContent() is like setting the .innerHTML of ele, 
			but preserves drag scroll behavior</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, 'this is the expanded template');</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
			<p>&nbsp;</p>
		</blockquote></td>
	</tr>
</table>
</div>


<p><br>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2"><b>Note:</b> Instead of setting
								<i>.innerHTML</i> 
								directly we are using a helper function called
								<i>A5.u.element.setContent()</i>. This is the preferred way 
								of writing this code if there is a possibility that drag 
								scrolling is enabled. If the 
								element that you are setting the <i>.innerHTML</i> on 
								had grad scrolling enabled, and you set innerHTML 
								directly, it would destroy the drag scrolling 
								capability. Moving on, after the client receives 
								the data we want to format 
								it:</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</p>
<p>
								17. Save your Component and go to the
								<font color="#0000FF">Web Projects Control Panel</font>. 
								From the <font color="#0000FF">Tools</font> 
								dropdown select the <font color="#0000FF">Open Template Tester 
								window</font>.&nbsp; On JSON tab click 
								<font color="#0000FF">Load Example</font>.</p>
<p>
								18. From the Select Example list choose the 
								Simple object, simple template object. Click
								<font color="#0000FF"><u>O</u>K</font>.</p>
<p>
								19. Want JSON that is standards compliant. JSON 
								standard required double quotes. Highlight the 
								inserted JSON and hit the <font color="#0000FF">
								Reformat JSON</font> button.</p>
<p>
								20. Go to the Template page and change the html 
								to read the following:</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span style=&quot;color:blue;&quot;&gt;{lastname}&lt;/span&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								21.
								Click the <font color="#0000FF">Show Javascript</font> 
								button. This will show the Javascript 
								that takes data and expands the html. Copy 
								this javascript to the clipboard.</p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient2.png" width="520" height="231"></p>
<p align="center">
								&nbsp;</p>
<p>
								22. Go to the <font color="#0000FF">Code</font> 
								dropdown again and open Javascript functions.
								Paste the Javascript into the expandTemplate 
								function that you defined.</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 'Hello &lt;b&gt;{firstname}&lt;/b&gt; 
			&lt;span style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, 'this is the expanded template');</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								23.&nbsp; To get data returned by Xbasic 
								callback open the <font color="#0000FF">Xbasic 
								function</font> page from the Code dropdown 
								list. Enter the following code:</p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2" color="#333300">function xb2 as c (e as p)</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
								</font> </p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
								delete p </font> </p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.firstname as c = &quot;Fred&quot;</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.lastname as c = &quot;Smith&quot;</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								p.date as c = &quot;&quot; + date()</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								json as c</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; json 
								= json_generate(p)</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dim 
								js as c</font></p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js = 
								&quot;{dialog.object}._data = &quot; + json +&quot;;&quot;</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xb2 = 
								js</font></p>
<p>
								&nbsp;</p>
<p>
								<font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2">In this code <i>dim json as c</i> 
								creates an Xbasic object. This object, <i>json</i>, 
								is then set to be <i>=json_generate(p)</i>. The 
								json_generate() function takes a variable, in 
								this case a variable called p, and returns JSON 
								data in this object in the form of a string. 
								Xbasic now has a string in Xbasic that can read 
								and manipulate. Next we create an Xbasic object 
								named <i>js</i>, in the<i> line dim js as c</i>, 
								and set this equal to xb2. This code effectively 
								places the JSON data inside a temporary 
								variable inside the UX component.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								24. Go to the <font color="#0000FF">Working 
								Preview</font> tab. Click the Fetch data from 
								server button.</p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient3.png" width="299" height="98"></p>
<p align="center">
								&nbsp;</p>
<p align="left">
								25. Now back to your Javascript functions page 
								and change the <i>expandTemplate()</i> function 
								to include <i>d = {dialog.object}._data; </i></p>
<p align="left">
								26. Also change<i> A5.u.element.setContent(ele, 
								'this is the expanded template')</i>; to read <i>&nbsp;A5.u.element.setContent(ele, 
								html)</i></p>
<p align="left">
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; _d = {dialog.object}._data;</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 'Hello &lt;b&gt;{firstname}&lt;/b&gt; 
			&lt;span style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var ele = 
			$('msg2');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; 
			A5.u.element.setContent(ele, html);</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>

<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
<p>
								<font size="2">Using&nbsp;<i>A5.u.element.setContent()</i> 
								is like setting the <i>.innerHTML</i> of <i>ele</i>. 
								Unlike <i>.innerHTML</i>, <i>A5.u.element.setContent()</i> preserves 
								the drag scroll behavior. The <i>_d</i> in this 
								code represents the data that the template will 
								expand. Setting <i>_d</i> to <i>{dialog.object}._data;</i> 
								makes <i>_d</i> draw its data from the Xbasic 
								function definition we defined in step 23. When 
								you run the component now you should see that 
								the same data that is defined on the 
								server-side, i.e in Xbasic.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								27. Go to Working Preview and click the Fetch 
								data from server button again:</p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient4.png" width="298" height="100"></p>
<p align="left">
								&nbsp;</p>
<p align="left">
								28. Go back to the <font color="#0000FF">Design</font> 
								tab. To make sure that your code is calling data 
								from the server, reopen your Xbasic functions 
								page in the Code dropdown.</p>
<p align="left">
								29. Change the <i>&quot;Fred&quot; </i>and<i> &quot;Smith&quot; </i>
								in your xb2 function to something different, 
								like &quot;<i>Salmo</i>&quot; and <i>&nbsp;&quot;trutta&quot; </i>or 
								anything.</p>
<p align="left">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient5.png" width="481" height="294"></p>
<p align="center">
								&nbsp;</p>
<p align="left">
								30. In the Code dropdown open the Javascript 
								functions page again.</p>
<p>
								31. Now add something to consume the date. Change this 
								line of code <i>'Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span 
								style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt;'</i> by 
								adding <i>'on {date}</i>.'</p>
<div align="center">
&nbsp;<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">'Hello &lt;b&gt;{firstname}&lt;/b&gt; &lt;span 
			style=&quot;color: blue;&quot;&gt;{lastname}&lt;/span&gt; on {date}.'</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								32.
								Go to <font color="#0000FF">Working Preview</font> and click button.</p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient6.png" width="315" height="104"></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">To summarize, the Ajax Callback can be made to the server. 
			The server Xbasic is now free to use any Xbasic code that it wants to compute 
			data to send back to the server. Data that gets sent back is encoded 
			on the server-side into an Xbasic object, in this case a p variable. 
			This variable then gets converted into a JSON string which gets sent back 
			to the client</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
<h1><a name="JSON from the Server-side, and Advanced Templates">JSON from the Server-side and 
the Template Tester</a></h1>
<p>&nbsp;</p></p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<br>
			<font size="2">The client-side template tester 
			window is very useful in laying out JSON data on the client side. 
			The user interface for the Template Tester is resizable and has 
			separate tabs for <font color="#0000FF">JSON Data</font>, 
			<font color="#0000FF">Template</font>, <font color="#0000FF">Javascript</font> and 
			<font color="#0000FF">CSS</font>.
			As you edit in any of these windows the template preview is 
			automatically updated in the right part of the window. </font>
			<p>&nbsp;</p>
			<p><font size="2">While the Template Tester does help in presenting 
			JSON data from the server-side on the client, It is still necessary 
			to define some xbasic and javascript in order to use a specific set 
			of JSON data. When editing Xbasic or Javascript code, html, 
								and JSON it is often helpful to be able to see 
			the start and end of different opening and closing 'pair' 
			delimiters. For 
								example in an Xbasic function call, highlighting 
								the opening an closing parentheses. Or in a 
								Javascript function, highlighting the opening 
								and closing curly braces. In some HTML text, the 
								opening and closing tags (e.g. &lt;div&gt;, &lt;body&gt;, 
								&lt;p&gt; , etc.). Once a 'pair' has been identified, 
								keyboard shortcuts <font color="#0000FF">(Control&nbsp; ] and 
								Control-Shift ] )</font>&nbsp; allow you to quickly 
								move focus from the start of the 'pair' to the 
								end of the 'pair' or to select all of the text 
								inside the 'pair'. For more on this
			<a href="http://www.ajaxvideotutorials.com/V12Videos/code_editor_highlighting_pairs.swf">
			<u>watch this video</u></a><u>.</u></font><br>
&nbsp;</p>
			<p><font size="2">To follow the advanced example below watch the 
			following videos</font><a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_10.swf"><font size="2">
								<u>Part 1</u></font></a><font size="2">,
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_11.swf">
								<u>Part 2</u></a>,<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_12.swf">
								<u>Part 3</u></a>,
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json_serverToClient_advancedExample_13.swf">
								<u>Part 4</u></a> or simply </font>
								<font size="2">
								<a href="http://www.ajaxvideotutorials.com/V12Videos/json.zip">
								<u>download the component</u></a>.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="center">
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient9.png" width="250" height="418"></p>
<p>
								&nbsp;</p>
<p>
								<b>Create JSON from the Server side presented in 
								an Advanced Template:</b></p>
<p>
								&nbsp;</p>
<p><font size="2">1. In the <font color="#0000FF">Web Projects 
control Panel</font> click the <font color="#0000FF">New Component or File</font> 
button. In the New File dialog select <font color="#0000FF">Web Component</font> 
and click <font color="#0000FF">Next</font>. Select <font color="#0000FF">UX</font> 
and click <font color="#0000FF">Next</font> again. <br>
								2. On the Select UX Component template page 
leave the '<font color="#0000FF">Start with a blank UX Component</font>' radio button selected and click
<font color="#0000FF"><u>O</u>K</font>.</font></p>
<p><font size="2">3. On the <font color="#0000FF">Design</font> tab of the UX Builder open the 
UX <font color="#0000FF">Controls</font> page from the menu list. </font> </p>
<p><font size="2">4. Open the Other Controls dropdown and double click on<font color="#0000FF"> [Button]</font> to add a 
button to the UX component. </font> </p>
<p><font size="2">5. Click on the <font color="#0000FF">[Static Text]</font> control in the Other Controls dropdown to add a 
static text control to the UX component.</font></p>
<p><font size="2">6. Select the Static test control and look at the Control Properties list. In 
the Static Text Properties section change the Static text property to this:</font></p>
<p>&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p><font size="2"><br>
			</font><font size="2" color="#333300">&lt;div id=&quot;msg3&quot;&gt;&lt;/div&gt;</font></p>
		</blockquote></td>
	</tr>
</table>
<p>&nbsp;</div>


<p><font size="2">7. Select the button that you added to you component. Go to the the 
Properties list on the right. </font> </p>
<p><font size="2">8. In the Button Properties section change the Button text property to read
<i>Fancy Report</i>. Save your component.</font></p>
<p>
								<font size="2">9. In the Web Projects Control 
								Panel click on Tools and select the 
								<font color="#0000FF">Open Template Tester 
								window</font> from the dropdown.</font></p>
<p>
								<font size="2">10. Click Load Example. From the 
								list of choices select the '<i>Same as previous example, but 
								with CSS to style the output</i>' option.</font></p>
<p>
								<font size="2">11.
								Copy JSON data to the clipboard.</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient14.png" width="453" height="496"></p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font size="2"><br>
			If you have completed the <a href="#JSON and sending data from Server to Client">
			JSON and sending data from Server to Client</a> guide you will 
			notice that this template contains slightly more complex JSON data. 
			As you can tell from the square starting brackets
			<font color="#0000FF">[ ]</font>, this JSON object is an array. Each item in the array is 
			filled with an object whose name starts with <i>'orderId:'</i>. The
			<i>orderItems</i> property inside this object is itself an array 
			that contains objects as properties. Because there is this much 
			nested data, computing this on the server is the appropriate thing to do. 
			We then want to consume the JSON data on client side and output html. 
			The
			Javascript function that gets called by the template
			Template uses some CSS, also defined in the genie, to
			take a simple example and expand it.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								<font size="2">12. Go back to&nbsp; your 
								component and, on the Controls page, select the 
								button control your created. </font></p>
<p>
								<font size="2">13. Scroll down the Properties 
								list to the<font color="#0000FF"> Javascript 
								(Touch, Mouse, Pointer Events)</font> section.</font></p>
<p>
								<font size="2">14. Click the button
								<img border="0" src="images/abutton.png" width="15" height="14"> 
								next to the <font color="#0000FF">click</font> 
								property.</font></p>
<p><font size="2">15. The Edit Click Event dialog will open. Leave the Action Javascript radio 
button selected.</font></p>
<p><font size="2">16. Click the Add New Action button. The Action Javascript - Select an Action 
dialog will open.</font></p>
<p><font size="2">17. In the Categories: list select Ajax Callbacks and Javascript option. In 
the Actions: list select Ajax Callback. Click <font color="#0000FF">OK</font>.</font></p>
<p><font size="2">18. The Action Javascript - Ajax Callback Action genie will appear. Set the<font color="#0000FF"> Function name</font> 
property to be xb3</font></p>
<p><font size="2">19. Click the button
<img border="0" src="images/abutton.png" width="15" height="14"> next to the 
<font color="#0000FF">After callback complete Javascript</font> property. </font> </p>
<p><font size="2">20. The <font color="#0000FF">After Callback Complete Javascript</font> dialog will open. Add a function 
called <i>expandTemplate2(); </i>and click <font color="#0000FF"><u>O</u>K</font> 
and <font color="#0000FF"><u>O</u>K</font> and <font color="#0000FF"><u>O</u>K</font> 
again. <font color="#0000FF">Save</font>.</font></p>
<p align="center">
								&nbsp;</p>
<p align="center">
								<font size="2">
								<img border="0" src="images/ajaxserverclient7.png" width="225" height="84"></font></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">21. Go to the Code dropdown and 
								open the Xbasic functions page. Define a function called 
								<i>xb3</i> using the following code:</font></p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="60%" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
<p>
								<font size="2" color="#333300"><br>
								function xb3 as c (e as p)</font></p>
<blockquote>
	<p><font size="2" color="#333300">dim json as c</font></p>
	<p><font size="2" color="#333300">json = &lt;&lt;%txt%</font></p>
	<p>&nbsp;</p>
	<p><font size="2" color="#808080">//Insert Template JSON here</font></p>
	<p>&nbsp;</p>
	<p><font size="2" color="#333300">%txt%</font></p>
	<p><font size="2" color="#333300">dim js as c</font></p>
	<p><font size="2" color="#333300">js = &quot;{dialog.object}._data2 = &quot; + json +&quot;;&quot;</font></p>
	<p><font size="2" color="#333300">xb3 = js</font></p>
</blockquote>
<p>
								<font size="2" color="#333300">end function</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								<font size="2">22. Paste the JSON you copied 
								from the template into your <i>xb3</i> function 
								definition between <i>json = &lt;&lt;%txt%</i> and
								</font><i><font size="2">%txt%</font></i></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">Here we are using <i>&lt;&lt;%txt%</i> and
								</font><i><font size="2">%txt%</font></i><font size="2"> 
			delimeters. If you use the specify <i><font color="#0000FF">&lt;&lt;%json%... 
			%json%</font></i> delimiters to enter a long string of JSON data, 
			the Xbasic editor will perform real-time validation on the JSON 
			data. For example, in the image below, the JSON has an error because 
			of the trailing comma after the last property (age: 23). Notice the 
			squiggly red line indicating the error. </font></p>
			<p align="center">
			<img border="0" src="images/ajaxserverclient12.png" width="185" height="143"></p>
			<p align="center">&nbsp;</p>
			<p align="left"><font size="2">If you click on the error indicator 
			you will see the error message.</font></p>
			<p align="left">&nbsp;</p>
			<p align="center">
			<img border="0" src="images/ajaxserverclient13.png" width="347" height="65"></p>
			<p><font size="2"><br>
			in a realworld example you would do data querys to get the JSON 
			information<br>
			Take this JSON and put it into a temporary variable called _data2</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								<font size="2">23.
								Go to the Javascript functions page. Define the function 
								expandTemplate2() using this code.</font></p>
<p>
								&nbsp;</p>

<div align="center">
<table border="1" width="7in" style="border-width: 0px">
	<tr>
		<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">function expandTemplate2() {</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _d = {</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;firstname&quot; : &quot;Fred&quot;,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			&quot;lastname&quot;: &quot;Smith&quot;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; };</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; _d = {dialog.object}._data2;</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var _t = [</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; </font>
			<font size="2" color="#808080">//Insert Javascript here</font></p>
			<p>&nbsp;</p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; ].join('');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; var settings = 
			{</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; template: _t,</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; partials: ''</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp; }</font></p>
			<p>&nbsp;</p>
			<p><font size="2">&nbsp;&nbsp; </font> <font size="2" color="#333300">var html = 
			A5.u.template.expand(_d,settings);</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp; &nbsp;var ele = 
			$('msg3');</font></p>
			<p><font size="2" color="#333300">&nbsp;&nbsp;&nbsp;&nbsp;A5.u.element.setContent(ele, 
			html);</font></p>
			<p><font size="2" color="#333300">}</font></p>
		</blockquote></td>
	</tr>
</table>
</div>


<p>
								&nbsp;</p>
<p>
								<font size="2">24. Go back to
								<font color="#0000FF">Open Template Tester 
								window</font> and click the
								<font color="#0000FF">Show Javascript</font> 
								hyperlink in the lower left of the dialog. Find 
								the template section of the javascript marked <i>
								var _t = [</i> </font></p>
<p>
								<font size="2">25. Copy the Javascript between&nbsp;<i>var 
								_t = [ </i>and <i>].join('');</i> in the
								<font color="#0000FF">Open Template Tester 
								window.</font> </font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient10.png" width="492" height="156"></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">26. Open the
								<font color="#0000FF">Javascript functions</font> 
								page in the Code dropdown. Paste the code you 
								copied inside the <i>expandTemplate2()</i> 
								function.<br>
								27.
								Go back to the <font color="#0000FF">Open Template Tester 
								window.</font> Open the <font color="#0000FF">Javascript</font> tab and copy 
								the javascript function displayed in the tab to clipboard.</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient11.png" width="512" height="77"></p>
<p align="center">
								&nbsp;</p>
<p>
								<font size="2">28. In your component, open the 
								Code dropdown in the Design tab. Go to the 
								Javascript functions page and paste the function 
								you copied above the <i>expandTemplate2()</i> 
								definition.</font></p>
<p>
								<font size="2">29. Open the
								<font color="#0000FF">Open Template Tester 
								window. </font>Click on the
								<font color="#0000FF">CSS</font> tab and copy 
								all of the CSS code.</font></p>
<p>
								30. Open your component page. <font size="2">Go to 
								the Properties page and find the CSS properties 
								section. </font></p>
<p>
								<font size="2">31. Click the button
								<img border="0" src="images/abutton.png" width="15" height="14"> 
								next to the <font color="#0000FF">Local CSS definitions</font>, 
								click the code tab at the bottom of the
								<font color="#0000FF">CSS Editor[]</font> and 
								paste all of your CSS inside the editor.</font></p>
<p>
								<font size="2">32. Now go to 
								<font color="#0000FF">Working Preview</font>. 
								You should see something like this:</font></p>
<p>
								&nbsp;</p>
<p align="center">
								<img border="0" src="images/ajaxserverclient8.png" width="727" height="537"></p>
<p>
								&nbsp;</p>
<p>
								<font size="2">33. Open your component and go to 
								the Xbasic functions page in the Code dropdown.
								</font> </p>
<p>
								&nbsp;</p>
<p>
								<font size="2">34.
								Try adding to or altering the JSON data that is 
								nested inside your Xbasic function.</font></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
			<font size="2">To summarize, an ajax callback can go to the server, get a very 
			complex set of data represented as a JSON object, and send that data back 
			to the client. Then using the templating features on the client 
			side you can use that data to create a very rich layout from that 
			JSON data. JSON can 
			be used on the server side to serialize xbasic objects. You can use
			<i>json_generate</i> to serialize Xbasic objects into json data and 
			<i>json_parse</i> to parse json data back into xbasic objects. On 
			the client side 
			you can use <i>json_stringify</i> and <i>json parse</i> to serialize objects into json strings and to parse json strings into javascript objects. 
			json is the perfect mechanism for parsing information from the 
			client side to the server side or the server side to the client 
			side.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
								<h1><a name="JSON Functions and Special Flags">JSON Functions and Special Flags</a></h1></p>
<p>
								&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
&nbsp;</p>
<p><font size="2">The javascript object notation that Xbasic uses to parse JSON 
is not as full as the javascript object notation that exists in Javascript 
itself.&nbsp; Javascript can process functions as properties directly from JSON. 
In comparison, Xbasic requires a string of JSON to be able to parse data, which 
it then feeds into a browser. Converting everthing, including all of the 
javascript extras, into string format prevents the JSON from blowing things up 
when it is used in Xbasic. On the other hand, not being able to use all of the 
types of data that can exist inside of JSON leads to a great loss in potential 
capability for an application. For example, say you had a completed date object in Javascript 
that was stored in JSON. If you transformed that JSON into a string, you would end with 
something that is transportable but that would not be transported. It would lose 
all functionality. The way Alpha Anywhere gets around this problem is through 
special Xbasic tags, flags, and nulls; markers that indicate logic that exists 
inside of JSON data. It is these flags that allow Xbasic to do everything with 
JSON that can be done in Javascript. Alpha Anywhere simply ooks for parts of 
			strings generated from JSON and, if it sees any, outputs 
			them as javascript. For example: Here <i>dim o as p</i> is an xbasic 
object. The <i>o.myFunc = &quot;function(){...}&quot;</i> defines a string </font></p>
			
			<div align="center">
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<br>
						<font size="2" color="#333300">dim o as p<br>
			o.myFunc = &quot;function(){...}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p align="left"><font size="2">Below is the output from the <i>
			o.myFunc</i> function produced by <i>json_generate()</i>. As you can 
			see from the single quotes around <i>'function(){...}'</i>, the 
			output&nbsp; is a string. Even if the flag in the generate function 
			was false <i>.f.</i> you would get the same thing; a string will 
			produce a string. If you ran this in javascript it would also view 
			it as a string.</font></p>
			<p align="left">&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.t.)<br>
			&quot;{myFunc: 'function(){...}'}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</p>
			<p align="left"><font size="2">This is the same 'o' xbasic object 
			function. However, here the function is marked as a javascript 
			function. </font></p>
			<p align="left">&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			o.myFunc = &quot;{javascript}function(){...}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p align="left">&nbsp;</p>
			<p align="left"><font size="2">This time, when we run the function 
			in json_generate(), no single quotes appear. Javascript will view 
			this as a viable function.</font></p>
			<p><font size="2">&nbsp;</font></p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.t.)<br>
			&quot;{myFunc: function(){...}}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p align="left">&nbsp;</p>
			<p align="left"><font size="2">If you were to turn the boolean flag 
			in json_generate to false <i>.f.</i> then you would again end up 
			with a string, as shown below. This string would include the 
			bracketed <i>{javascript}</i> marker inside of it.</font></p>
			<p>&nbsp;</p>
			<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2" color="#333300">
			<br>
			?json_generate(o,.f.)<br>
			&quot;{myFunc: '{javascript}function(){...}'}&quot;</font></blockquote>
					</td>
				</tr>
			</table>
			<p>&nbsp;</div>
			
		</blockquote></td>
	</tr>
</table>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>
<p>
								&nbsp;</p>



<h1><a name="Interrogating JSON Data">Interrogating JSON Data</a></h1>
<p>&nbsp;</p>



<div id="yui_3_16_0_1_1445604035652_7023" style="color: rgb(0, 0, 0); font-family: 'Helvetica Neue', 'Segoe UI', Helvetica, Arial, 'Lucida Grande', sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<font size="2" face="Verdana">
			<br>
			There are several ways to use Xbasic to extract information from 
			JSON data. </font>
			</blockquote>
		
		</td>
	</tr>
</table>
	<p>&nbsp;</p>
<blockquote>
	<p><b><font face="Verdana">For JSON data that contains objects:</font></b></p>
	<p>&nbsp;</p>
	<p><font face="Verdana"><font size="2">1. First define a JSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p>
</blockquote>
<div align="center">
	<table border="1" width="51%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						</font><font face="Verdana" size="2" color="#333300">dim 
						jso as extension::JSON</font></font></blockquote>
					</td>
				</tr>
			</table>
		<blockquote>
			<p align="left"><font size="2" face="Verdana">2. Next equate the  
		object with the JSON data you wish to query using <font color="#0000FF">setJson()</font>. 
			You can read this data in from a file. Here we are going against 
			JSON data that contains an object.</font></p>
	</blockquote>
	<font face="Verdana">
	<table border="1" width="51%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">jso.setJson(&quot;{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}&quot;)</font></font></font></blockquote>
					</td>
				</tr>
			</table>
		</div>
		
	<blockquote>
		<p>3. These different methods will return the following results:</blockquote>
<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p align="center"><br>
			<font size="2">&quot;{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
	<p align="center">&nbsp;</div>
<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<font face="Verdana" size="2">= &quot;john&quot;</font></blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<font face="Verdana" size="2">= &quot;public&quot;</font></blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.nameIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;firstname&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.nameIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;lastname&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getProperty(&quot;firstname&quot;)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;john&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.getProperty(&quot;lastname&quot;)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= &quot;public&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.isArray()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= .F.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="339" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">? jso.isObject()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2">= .T.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
<blockquote>
	<p><br>&nbsp;<p><b>For JSON data that contains arrays:</b></p>
	<p>&nbsp;</p>
	<p><font size="2">1. First define an JSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p>
	<p>&nbsp;</p>
	
	<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">dim jsa as extension::JSON</font></font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
		<p><br><font size="2" face="Verdana">2. Next set the  
		object to be the JSON data that contains the array you wish to query using <font color="#0000FF">setJson()</font>. 
			You can also read this data in from a file. </font><br><br>&nbsp;<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
				<tr>
					<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
					<blockquote>
						<font size="2"><br>
						<font color="#333300">jsa.setJson(&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;)</font></font></blockquote>
					</td>
				</tr>
			</table>
			</div>
			
		<p><br>3. These different methods will return the following results.<p><br>&nbsp;
		
		<div align="center">
		<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p align="center"><br>
			<font size="2">&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>


	<p><br>&nbsp;<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= 4</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(0)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			&nbsp;<p><font face="Verdana" size="2">
			= &quot;one&quot;</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(1)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			&nbsp;<p><font face="Verdana" size="2">
			= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jsa.getIndexed(2)</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= .T.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2" color="#0000FF">
		jselem = jsa.getIndexed(3)</font></td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jselem.getLength()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= 2</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? jselem.getJson()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">
			= {&quot;firstname&quot;:&quot;john&quot;,&quot;lastname&quot;:&quot;public&quot;}</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		&nbsp;</td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
	<font face="Verdana" size="2" color="#0000FF">
		jselem.setProperty(&quot;middlename&quot;,&quot;Q&quot;)</font></td>
		<td bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		&nbsp;<p>&nbsp;</td>
	</tr>
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
	<font face="Verdana" size="2">
		? jselem.getJson()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font face="Verdana" size="2">= {&quot;firstname&quot;:&quot;john&quot;,&quot;lastname&quot;:&quot;public&quot; 
			, &quot;middlename&quot; : &quot;Q&quot;}</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
</blockquote>
<p><br><br><br><br>

<h1><a name="BSON Queries and JSON">BSON Queries and JSON</a> </h1> 





<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<font size="2" face="Verdana">
			<br>
			</font><font size="2">BSON was created by the developers of Mongo 
			DB. BSON is JSON data that is converted to binary. </font>
			</blockquote>
		
		</td>
	</tr>
</table>
	<p>&nbsp;</p>
<blockquote>
	<p><b>Interrogating BSON data from JSON:</b></p>
	<p>&nbsp;</p>
	<p>1. <font size="2">First define an BSON object that 
	lives in the <font color="#0000FF">extension</font> namespace inside of 
	Xbasic.</font></p></blockquote>
<div align="center">
	<table border="1" width="60%" style="border-width: 0px">
		<tr>
			<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
			<blockquote><font size="2"><br><font color="#333300">dim bso as 
				extension::BSON</font></font></blockquote></td>
		</tr>
	</table></div>
<blockquote>
	<p>2. <font size="2" face="Verdana">Next set the BSON object to include the 
	JSON data you wish to query using <font color="#0000FF">setJson()</font>. 
			</font><br>&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">bso.setJson(&quot;[\&quot;one\&quot;,2,true,{\&quot;firstname\&quot;:\&quot;john\&quot;,\&quot;lastname\&quot;:\&quot;public\&quot;}]&quot;)</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p><br>3. Call your BSON object as BSON data using <font color="#0000FF">getBson()</font>.<p>&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">dim </font>
					<font color="#0000FF">bs</font><font color="#333300"> as b = bso.getBson()</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>4. You can look at the binary:<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
				<font size="2"><br></font>
				<font color="#0000FF" face="Verdana" size="2">? bs</font></td>
			</tr>
		</table></div>
	<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">= 0000 : 4c 
					00 00 00 02 30 00 04 00 00 00 6f 6e 65 00 10 <br>
					0010 : 31 00 02 00 00 00 08 32 00 01 03 33 00 2e 00 00 <br>
					0020 : 00 02 66 69 72 73 74 6e 61 6d 65 00 05 00 00 00 <br>
					0030 : 6a 6f 68 6e 00 02 6c 61 73 74 6e 61 6d 65 00 07 <br>
					0040 : 00 00 00 70 75 62 6c 69 63 00 00 00 </font></font>
				</blockquote></td>
			</tr>
		</table></div>
	<p>
	<br>
	5. You can Query against this data as well.<br>
	
	
	<div align="center">
<table border="1" width="51%" style="border-width: 0px">
	<tr>
		<td width="264" style="border-style: none; border-width: medium" bgcolor="#FFFFFF">
		<font face="Verdana" size="2">
		? bs.size()</font></td>
		<td bgcolor="#F5F7F4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p>
	<font face="Verdana" size="2">
			= 76</font></p>
		</blockquote>
		</td>
	</tr>
</table>
</div>
	<p>
	<br>
	<b>Getting JSON Back from BSON:</b><br>
	<br>
	1. Define a JSON object that lives in the extension namespace inside of 
	Xbasic. Put BSON after extension. Only BSON knows how to deserialize BSON.<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">dim bso2 as 
					extension::BSON</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	2. Now set the JSON object against the BSON data you want to convert to JSON 
	using setBson().<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">
					bso2.setBson(bs)</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	3. Call your JSON object from the BSON data using getJson().<br>
	&nbsp;<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">? 
					bso2.getJson()</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>
	<br>
	4. Result.<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br><font color="#333300">= [ &quot;one&quot;, 
					2, true, { &quot;firstname&quot; : &quot;john&quot;, &quot;lastname&quot; : &quot;public&quot; } ]</font></font></blockquote>
				</td>
			</tr>
		</table></div>
	<p>&nbsp;<p>&nbsp;</blockquote>
</div>
<h1><a name="Using JSON with Reports">Using JSON with Reports</a></h1>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<br>
			<font size="2">You can create reports from JSON data in Alpha 
			Anywhere. This is useful when you want to use data on a report that comes from a 
			web service off a website or when you want to build data without 
			involving a traditional data source like SQL. </font></blockquote>
		</td>
	</tr>
</table>
<blockquote>
	<p><b>Create a Custom Report using simple JSON data:</b></p>
	<p>&nbsp;</p>
	<p>1. In the Web Projects Control Panel menu click on the 
	<font color="#0000FF">Reports(Project)</font> option.</p><font size="2">2. Click the
	<font color="#0000FF">New component or file button</font>. Select
	<font color="#0000FF">Create New Report</font> from the list that appears.</font><p>&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom3.png" width="274" height="96"></p>
	<p align="center">&nbsp;</p>
	<p><font size="2">3. The New Report dialog will open. Specify a
	<font color="#0000FF">&lt;Custom Data Source&gt;</font>.</font></p>
	<p>&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom.png" width="285" height="133"></p>
	<p>&nbsp;</p>
	<p>&nbsp;</p>
	<p align="left">4. <font size="2">The <font color="#0000FF">Specify Custom Data 
Source</font> dialog will open. In the<font color="#0000FF"> Function name
	</font>property, specify the name of the Xbasic function that will return the 
data to be printed by the report. Here the Function name is <i>MyJsonReport</i>.</font></p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom2.png" width="768" height="165"></p>
	<p align="left">&nbsp;</p>
	<p align="left"><font size="2">5. Under the <font color="#0000FF">Data format</font> 
property dropdown select <font color="#0000FF">JSON</font>.</font></p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom4.png" width="754" height="107"></p>
	<p align="center"><u><font size="2">The Xbasic function can return a string of 
data in one of two formats, <font color="#0000FF">Delimited</font> and
	<font color="#0000FF">JSON</font>.</font></u></p>
	<p>&nbsp;</p>
	<p><font size="2">6. Click the button next to the <font color="#0000FF">Local 
Xbasic definition</font> property. Click the <font color="#0000FF">Code Editor</font> 
tab in the <font color="#0000FF">Local Xbasic Function Definition</font> dialog 
when it opens.</font></p>
	<p>7. Add the following Xbasic function containing a simple JSON array. Make 
sure the function name defined in the function, in italics, is the same as the 
Function name you defined in Step 4. When you are done 
Click <font color="#0000FF"><u>O</u>K. </font></p>
	<p>&nbsp;</p>
	<div align="center">
		<table border="1" width="60%" style="border-width: 0px">
			<tr>
				<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
				<blockquote><font size="2"><br></font>
					<font face="Verdana" size="2" color="#333300">function <i>MyJsonReport</i> as c(e as p)<br>
					<i>MyJsonReport</i> = &lt;&lt;%json%<br>[<br>{"Firstname" : "Fred", "Lastname" : "Smith"},<br>{"Firstname" : "Harry", "Lastname" : "Jones"}<br>]<br>%json%<br>end function 
					</font>
				</blockquote></td>
			</tr>
		</table>
		<p>&nbsp;</p></div>
</blockquote>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p><font face="Verdana">
			<p align="left"><font size="2"><b>Note:</b> Since no schema is supplied in this 
function, the data are all considered to be character type of length 1024 characters. While the advantage of this format is
that is extremely simple, it does mean that you will need to adjust the size of each field you place on your report because its default size will likely be too large. 
Notice that the function takes a single input parameter, <i>e</i>. </font>&nbsp;<font size="2">The 
			<i>e</i> object that is passed into the function includes the value of any 
Arguments that were passed into the report.</font></p>
			<p align="left">&nbsp;</p>
			<p align="left"><font size="2">When you close the Local 
					Xbasic Function Definition dialog you might notice the 
					Arguments property. <font color="#0000FF">Arguments</font> 
					are used for when you want to filter the contents of a 
					report. For example, if you wanted a report on such and such 
					a state in the United States, this might involve creating an 
					argument. If you specified that the <font color="#0000FF">&lt;Custom Data Source&gt;</font> uses an argument called 
			<i>whatCountry</i>. Your Xbasic function can reference the 
					value in this argument as follows:</font></p>
			<div align="center">
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
						<blockquote><font size="2"><br></font>
							<font size="2" face="Verdana" color="#333300">dim country as 
					c <br>country = argVal(e.arguments,&quot;whatCountry&quot;)</font></blockquote>
						</td>
					</tr>
				</table></div></font>
		</blockquote></td>
	</tr>
</table>
<blockquote>
	<p>8. Click OK to close the <font size="2"><font color="#0000FF">Specify Custom Data 
Source</font> dialog. The Report Workspace will open up with &lt;Custom Data 
	Source&gt; written in its title bar. <font color="#0000FF">Save</font> your 
	Report.</font></p>
	<p><font size="2">9. Open the <font color="#0000FF">DragDrop List</font>. From 
the Toolbar</font></p>
	<p align="center">
	<img border="0" src="images/custom7.png" width="162" height="76"></p>
	<p><font size="2">9. In the <font color="#0000FF">DragDrop List</font> find the 
section starting with <i>a5_temp_custom_....</i> and underneath it the two 
object properties contained in your JSON array, i.e <i>firstname</i> and <i>lastname</i>.</font></p>
	<p align="center">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom5.png" width="835" height="205"></p>
	<p align="center">&nbsp;</p>
	<p align="left">10. Add these object properties to you report by dragging an 
dropping them into the <font color="#0000FF">Report Header</font>. </p>
	<p align="left">11. The <font color="#0000FF">Drop Fields</font> dialog will 
appear. Click <font color="#0000FF">OK</font>. Afterward a checkmark will appear 
next to each property used.</p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom6.png" width="696" height="113"></p>
	<p align="center">&nbsp;</p>
	<p align="left">12. Drag the second, non-bold, part of the<i> Firstname </i>and
	<i>Lastname</i> properties down into the Detail section of the Report. Like 
this:</p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom9.png" width="286" height="176"></p>
	<p align="left">&nbsp;</p>
	<p align="left">&nbsp;</p>
	<p align="left">13. Click the Print preview the current Report button in the 
toolbar. </p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom8.png" width="245" height="73"></p>
	<p align="left">&nbsp;</p>
	<p align="left">14. Now you should see the JSON data from the array appear in 
Report format.</p>
	<p align="left">&nbsp;</p>
	<p align="center">
	<img border="0" src="images/custom10.png" width="535" height="256"></p>
</blockquote>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<h1><a name="JSON, Reports, and Schema">JSON, Reports, and Schema</a></h1>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2">You might want the string you return to be an 
			object with two object properties, schema and data. The schema object 
			property 
			defines the schema of the data (for example, field type, size, etc.) 
			and the data property is an array of JSON objects that define the 
			data for the report. For example:<br>
&nbsp;</font></p>
			<font face="Verdana">
			<div align="center">
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
						<blockquote><font size="2"><br></font>
							<font size="2" face="Verdana" color="#333300">
							function myjson as c(e as p)<br>
							myjson = &lt;&lt;%json%<br>
							{<br>
							&quot;schema&quot; : { &quot;firstname&quot; : { &quot;type&quot; : &quot;C&quot; , &quot;width&quot;: 
							30 } <br>
							, &quot;lastname&quot; : { &quot;type&quot; : &quot;C&quot; , &quot;width&quot;: 30} <br>
							, &quot;company&quot; : { &quot;type&quot; : &quot;C&quot; , &quot;width&quot;: 30} <br>
							, &quot;age&quot; : { &quot;type&quot; : &quot;N&quot; , &quot;width&quot; : 3, &quot;decimal&quot; : 
							0 }<br>
							},<br>
							&quot;data&quot;: <br>
							[<br>
							{&quot;firstname&quot;:&quot;Fred&quot;, &quot;lastname&quot;:&quot;Smith&quot;, &quot;company&quot; : 
							&quot;Alpha Software&quot;, &quot;age&quot; : 30},<br>
							{&quot;firstname&quot;:&quot;John&quot;, &quot;lastname&quot;:&quot;Jones&quot;, &quot;company&quot; : 
							&quot;Beta Software&quot;, &quot;age&quot; : 23}<br>
							]<br>
							}<br>
							%json%<br>
							end function </font>
						</blockquote></td>
					</tr>
				</table></div></font>
			<p><font size="2"><br>
			In this code the size and type of each 
			field in the data array is specified; as is the 
			number of decimal places for the numeric field. The data types 
			supported in the schema are: </font></p>
			<font face="Verdana">
			<div align="center">
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#DDE8E8">
						<blockquote><font size="2" face="Verdana">
							<font color="#0000FF">C</font> - Character (you must 
							also specify a &quot;width&quot; property for this type)<br>
							<font color="#0000FF">N</font> - Numeric (you must 
							also specify a &quot;width&quot; and &quot;decimal&quot; property for 
							this type)<br>
							<font color="#0000FF">L</font> - logical<br>
							<font color="#0000FF">M</font> - memo<br>
							<font color="#0000FF">D</font> - date<br>
							<font color="#0000FF">T</font> - date/time<br>
							<font color="#0000FF">Y</font> - short time<br>
							<font color="#0000FF">E</font> - exponent numeric<br>
							<font color="#0000FF">K</font> - guid<br>
							<font color="#0000FF">JPEG</font> - Jpeg field (data 
							in the JSON data property is expected to be base64 
							encoded)<br>
							<font color="#0000FF">PNG</font> - PNG (data in the 
							JSON data property is expected to be base64 encoded)<br>
							<font color="#0000FF">BMP</font> - BMP (data in the 
							JSON data property is expected to be base64 encoded)<br>
							<font color="#0000FF">I</font> - Image Reference 
							Field (data in the data property is a image file 
							name but the report will treat the data as an 
							image).</font></blockquote></td>
					</tr>
				</table></div></font>
				
				
				
			<p><font size="2"><br>
			<b>Note:</b> If a field uses the Date (<font color="#0000FF">D</font>), 
			Date/Time (<font color="#0000FF">T</font>) or Short time (<font color="#0000FF">Y</font>) format in the schema, the data in 
			the data array must be a string in UTC date format. For example: 
			2014-10-27T23:06:50.361Z. The date part format is yyyy-mm-dd and the 
			time part uses GMT. In the case of a Short time field, the date 
			portion of the UTC date string is ignored.</font><br>
&nbsp;</p>
			<p><font size="2">A schema allows you to extract data from objects 
			within each row, and to map property names in the data array to 
			different names. For example, the address property can be an object 
			with two sub-properties:</font></p>
			<font face="Verdana">
			<div align="center">
			
			
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
						<blockquote><font size="2"><br></font>
							<i>
	<font face="Verdana" size="2" color="#0000FF">
							{<br>
&nbsp;&nbsp; "name": "Fred Smith",<br>
&nbsp;&nbsp; "company" : "XYZ Corp",<br>
&nbsp;&nbsp; "address": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "street": "Main Street",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "number": 23<br>
&nbsp;&nbsp;&nbsp; }<br>
							}</font></i></blockquote></td>
					</tr>
				</table></div></font>
			<p>&nbsp;</p>
			<p><font size="2">Shown below is how a function would be defined to 
			return this JSON data:</font></p>
			<p>&nbsp;</p>
	<font face="Verdana">
			<div align="center">
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
						<blockquote><font color="#333300"><font size="2"><br></font>
	<font face="Verdana" size="2">
							function myjson as c(e as p)<br>
							myjson = &lt;&lt;%json%<br>
							{<br>
&nbsp;&nbsp;&nbsp; "schema": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "type": "c",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "width": 30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "companyName&quot;: {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	"source": "company",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	"type" : "c",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	"width" : 30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "street": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "source": "address.street",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "type": "c",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "width": 40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "number": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "source": "address.number",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "type": "n",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "width": 5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "decimal": 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; "data": [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>&nbsp;</i></font><i><font size="2" color="#0000FF">{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "Fred Smith",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "company" : "XYZ Corp",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "address": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "street": "Main Street",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "number": 23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "John Jones",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "company" : "ABC Corp",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "address": {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "street": "Corner Road",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "number": 3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font></i><font size="2"><br>
							&nbsp;&nbsp;&nbsp; ]<br>
							}<br>
							%json%<br>
							end function </font></font></blockquote></td>
					</tr>
				</table></div></font>
			<p>
	<font face="Verdana" size="2">
			Notice that the JSON object has both a <i>
<span class="xbasicSmallSpan">schema</span></i>
and a <i> <span class="xbasicSmallSpan">data</span></i> property. The schema indicates what fields will be available to the report. 
The list of fields specified by the schema are:
<i>
<span class="xbasicSmallSpan">name</span></i>, <i> <span class="xbasicSmallSpan">companyName</span></i>, 
			<i> 
<span class="xbasicSmallSpan">street</span></i> and <i> <span class="xbasicSmallSpan">number</span></i>. 
			If you enter this code in the <i>Create a Custom Report using simple 
			JSON data:</i><br>
			example, you would end up with something like this:</font></p>
			<p>&nbsp;</p>
			<p align="center"><font face="Verdana" size="2">
			<img border="0" src="images/custom11.png" width="506" height="197"></font></p>
			<p align="center"><font face="Verdana" size="2">
			<u>Final report</u><br>
&nbsp;</font></p>
			<p align="left"><font size="2">Notice that the <i>data</i> array 
			does not have a property called <i>companyname</i>, even though this 
			data appears in the final report. The <i>schema</i> property for the
			<i>companyname</i> field indicates that the source of this field is 
			the <i>company</i> property in the <i>data</i> array. Similarly, the
			<i>street</i> field in the schema is mapped to the <i>address.street</i> 
			property in the <i>data</i> array. Similarly, if the definition for 
			a field in the <i>schema</i> omits the source property, then the 
			source is the same as the item name. Here </font>
	<font face="Verdana" size="2">
			the definition for the <i> 
<span class="xbasicSmallSpan">name</span></i> field in the <i>schema</i> does 
			not have a source property, therefore this field is mapped to the <i>
			name</i> property in the data array.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<pre class="xbasicSmall" xtag="">
</pre>
<h1><a name="Including Image data in a JSON schema object">Including Image data in a JSON schema object.</a></h1></p>
<pre class="xbasicSmall">
</pre>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDE8E8" style="border-style: none; border-width: medium">
		<blockquote>
			<p><br>
	<font face="Verdana" size="2">
			JSON objects can include image data. </font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p>&nbsp;</p>
			<div align="center">
				<table border="1" width="60%" style="border-width: 0px">
					<tr>
						<td style="border-style: none; border-width: medium" bgcolor="#F4F4DF">
						<blockquote><font size="2"><br></font>
	<font face="Verdana" size="2" color="#333300">
							function myjson as c(e as p)<br>
							myjson = &lt;&lt;%json%<br>
							{<br>
&nbsp;&nbsp; "schema" : {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name" : { "type" : "C" , "width": 30 }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "image" : { "type" : "Png" }<br>
								},<br>
								"data": <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {"name":"John Smith", "image" : "iVBORw...(data truncated for readability)....AAAElFTkSuQmCC" },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {"name":"Jane Smith", "image" : "data:image/bmp;base64,Qk02AwAAA...(data truncated for readability)....AAAADYAAAAAA=="}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]<br>
							}<br>
							%json%	<br>
							end function</font></blockquote></td>
					</tr>
				</table></div>
<p>&nbsp;</p>
<table border="1" width="100%" style="border-width: 0px">
	<tr>
		<td bgcolor="#DDEAC4" style="border-style: none; border-width: medium">
		<blockquote>
			<p><font face="Verdana" size="2"><br>
			The binary data for the image are encoded as base64 strings.&nbsp; 
			Notice that the schema indicates that the
			<span class="xbasicSmallSpan">image</span> field will be stored as a
			<span class="xbasicSmallSpan">PNG</span>. Notice also that in the 
			first record, the base64 encoded data in the
			<span class="xbasicSmallSpan">image</span> property does <b>not</b> 
			include the MIME type at the start of the base64 encoded data. This 
			data is therefore presumed to be a <span class="xbasicSmallSpan">PNG</span> 
			image since the <span class="xbasicSmallSpan">schema</span> 
			indicates that the image is a <span class="xbasicSmallSpan">PNG</span> 
			type. Notice however, that the second row of data in the
			<span class="xbasicSmallSpan">data</span> array has a MIME type 
			prefix on the base64 encoded image data. The data for the image is 
			for a <span class="xbasicSmallSpan">BMP</span> image. The image will 
			therefore be converted from <span class="xbasicSmallSpan">BMP</span> 
			to <span class="xbasicSmallSpan">PNG</span> automatically.</font></p>
		</blockquote>
		</td>
	</tr>
</table>
<p class="xbasic">
						&nbsp;</p>
<p class="xbasic">
						&nbsp;</p>
<hr color="#000000">
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center">

<h1 align="center"><a name="JSON Functions"><font size="6">JSON</font><font size="6"> Functions</font></a></h1>
<p class="showhide_heading">&nbsp;</p>

<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>

<div align="center">

<table border="1" width="74%" style="border-width: 0px">
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
	<h2>
	<font face="Verdana">
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_json_extractvalues().xml">a5_json_extractvalues()</a> </font>
		</h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>&nbsp;</p>
			<p><font size="2" face="Verdana">Extracts name/value pairs from a JSON string.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_json_populatearray().xml">a5_json_populatearray()</a></h2>		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>&nbsp;</p>
			<p>
			<font size="2" face="Verdana">Takes an array of JSON objects and populates an 
			Xbasic property array. </font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
	<h2>
	<font face="Verdana">
		 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_json_prep().xml">a5_json_prep()</a></font>
			</h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
				<font size="2">Used before calling VarToJSON() to remove property 
			values that are nulls.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_makejsontree().xml">a5_makejsontree()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2" face="Verdana">Takes an array and makes a JSON tree. Array has these 
			properties at a minimum: .label, .level. </font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_merge_json_into_template().xml">a5_merge_json_into_template()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>&nbsp;</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_sql_nested_query_to_json_document().xml">a5_sql_nested_query_to_json_document()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2" face="Verdana">The a5_sql_nested_query_to_json_document() Function 
			queries one or more SQL databases and returns a JSON document with 
			the query result. </font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
		
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_url_from_storagejsonformat().xml">a5_url_from_storagejsonformat()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
	<font size="2" face="Verdana">The a5_url_fromStorageJSONformat() Function takes a JSON definition for an object in storage on a 
	site like Amazon S3 and generates a signed URL to downloaded and display 
	the object</font><font size="2"></font></font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2>
	
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5_xbasictreetojsontree().xml">a5_xbasictreetojsontree()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Take a CRLF delimited string that Xdialog uses for 
			Tree Control data and converts to a JSON string.</font></font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/a5w_ajaxtojson().xml">a5w_ajaxtojson()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2" face="Verdana">&nbsp;Dumps out JSON from a data source.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/argumentsfromjson().xml">argumentsfromjson()</a></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2" face="Verdana">Appends arguments to an argument object from a JSON 
			argument definition. </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/argumentstojson().xml">argumentstojson()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Serializes arguments to a JSON string.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/crlf_to_json().xml">crlf_to_json()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Converts cr-lf delimited text to JSON. First row of 
			text is assumed to be the field names. Default delimiter (character 
			between fields) is |. crlf - takes something like colors and turn it into a json 
array.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_composite().xml">json_composite()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Turns flat lists into tree structure. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_composite().xml">json_composite()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Turns flat lists into tree structure. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_enumerate().xml">json_enumerate()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Gets all of the top level property names.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_extract().xml">json_extract()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json_extract() Function extracts a property from a JSON object. 
			</font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_filter().xml">json_filter()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json_filter() Function extracts or omits certain 
			properties from a JSON string. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_flatten().xml">json_flatten()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json_flatten() Function takes a JSON string that 
			defines an array of hierarchical objects and 'flattens' the array.
			</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
	<h2>
	<font face="Verdana">
			 <b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_from_bson().xml">json_from_bson()</a>
			</b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
	<font face="Verdana" size="2">
			The json_from_bson() function converts BSON data back into JSON. 
			</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			
			<h2><b>
			
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_from_xml().xml">json_from_xml()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<font size="2">Produces JSON from xml. The subformat of XML is the 
			Atom format. </font> </blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_from_xml_odata().xml">json_from_xml_odata()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Allows you to convert xml that has been 
			retrieved from a service that has Atom xml output of odata 2.0 or 
			earlier.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium"> 
		<h2><b> <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_generate().xml">json_generate()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2">Generate takes a variable, an Xbasic dot variable, and returns JSON. 
			</font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2><font face="Verdana">
			<b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_parse().xml">json_parse()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2" face="Verdana">The 
			json_parse function parses a string in JSON format and returns an Xbasic dot 
variable. 
			</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_reformat().xml">json_reformat()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2" face="Verdana">Takes json and reformats it so that it is presented on one line or 
			extended to include multiple lines. 
			&nbsp;</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium"> 
			<h2><b> 
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_reformat_safe().xml">json_reformat_safe()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2">The
			json_reformat_safe() function reformats a string of JSON data 
			with line-breaks and optional indentation. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_sample_array().xml">json_sample_array()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">The json_sample_array() function takes&nbsp;a JSON&nbsp;array&nbsp;as input 
			and 
			returns Fieldnames by default. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_select().xml">json_select()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json select- pass it a string of json data and return 
			a string out of that. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			<h2><b>
			<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_sqlquery().xml">json_sqlquery()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json_sqlQuery() Function allows you to filter a JSON array using a simple SQL query syntax. 
			</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_standardize().xml">json_standardize()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">JSON_standardize() function takes non-standard JSON 
			and standardizes it. Also corrects for trailing commas in the JSON 
			(which are illegal). </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2><font face="Verdana">
			 <b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_to_bson().xml">json_to_bson()</a>
		</b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font face="Verdana" size="2">
			BSON was created by the developers of Mongo 
			DB. BSON is JSON data that is converted to binary. 
			</p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_to_xml().xml">json_to_xml()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">json_to_xml() Function takes 
			a string of JSON data and converts it to XML. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/json_validate().xml">json_validate()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Returns an empty string if the JSON is valid. 
			Otherwise it returns an error message to tell you what is wrong with 
			the JSON. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/property_from_json().xml">property_from_json()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">The property_from_json() requires proper JSON, but is 
			2 to 5 times faster than json_parse(). </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/property_to_json().xml">property_to_json()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Takes a property, like a dot variable, and converts 
			it to JSON. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium"> 
		<h2> 
		<font color="#808080" face="Verdana"> <b> 
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/rsToJSON().xml">rsToJSON()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font face="Verdana" size="2">
			Hidden: Takes an AlphaDAO resultset and 
		converts the data to a JSON object. </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/vartojson().xml">vartojson()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Converts an Xbasic variable to a JSON 
			representation. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium"><font face="Verdana">
		<h2><b>
		<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/vartojsonhash().xml">vartojsonhash()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2" face="Verdana">The varToJsonHash() 
			Function converts an Xbasic property array to a JSON hash. </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/vartojsonstandard().xml">vartojsonstandard()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">varToJSON vs varToJSONStandard - standard uses double 
			quotes - old varToJSON assumes single qoutes. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/xbasic_expression_to_json().xml">xbasic_expression_to_json()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">Turns an Xbasic expression into an abstract parse 
			tree that is implemented in JSON. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2><b>&nbsp;<a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/xbasic_from_json().xml">xbasic_from_json()</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2">Create Xbasic from JSON Xbasic tree.</font></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
			 <h2><b>
			 <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/dim json as extension JSON.xml">dim json as extension JSON</a></b></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p><font size="2">Return an Xbasic script represented as a JSON object.
			</font> <a href="http://documentation.alphasoftware.com/Server/Reference/Design/Api/Extension/Json/Functions/xbasic_script_to_json().xml">
			<font size="2">xbasic_script_to_json()</font></a></p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">
		<h2><font color="#8F8FDA">dim json as extension::JSON</font></h2>
		</td>
		<td style="border-style: none; border-width: medium" bgcolor="#F5F7F4">
		<blockquote>
			<p>
			<font size="2">A JSON object that 
	lives in the extension namespace inside of 
	Xbasic. There are a number of extension methods. </font> </p>
		</blockquote>
		</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">&nbsp;</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">&nbsp;</td>
	</tr>
	<tr>
		<td width="471" bgcolor="#FFFFFF" style="border-style: none; border-width: medium">&nbsp;</td>
	</tr>
</table>
</div>


<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>
<p class="showhide_heading">&nbsp;</p>



</body>
</html>