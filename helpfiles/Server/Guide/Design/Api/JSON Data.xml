<page>
	<topic>JSON Data</topic>
	 <groups>
      <group background="true">
     <title>Introduction</title>
          <sections>
              <section>
                
               
                
               <description>JSON, or Javascript Object Notation, is simply a terse way of storing javascript objects. In many programming languages, to create an object you must first create a variable and then create the children of that variable independently. For example, you could define an object named 'o'  in javascript like this:</description>
			   <example><![CDATA[var o = new Object();
 o.firstName = 'Selwyn';
 o.lastName = 'Rabins';]]></example>
			   
              </section>
			  
			  <section>
				  <description>Using this method, the children of the 'o' object would need to be created one by one; each one including the name of its parent object. This results in a lot of code that is often difficult to interpret. In this case the object 'o' has a very simple name. However, it is not be hard to imagine situations in which the object name is much longer or where the programmer wants a child of the object to be an array or an object in and of itself. JSON provides a compelling alternative that makes this task straightforward. Rather than define each child individually, all of the children that belong to an object are enclosed in curly brackets. Each child in the object, except for the last child, is then delimited using a comma.  </description>
				  <example><![CDATA[var o = {
 firstname: 'Selwyn',
 lastName: 'Rabins'
 }]]></example>
				  
			  </section>
			  
			  <section>
				  <description>The simplicity of JSON's format has made it ubiquitous in Web application development. JSON is very frequently used for data storage, where it is gaining in popularity over xml, and many websites return data in JSON format. This makes it possible, for example, to pull news stories off the web in json format, work with apps like twitter, or call external servers and ask for things. Once you acquire this JSON it is then very easy to manipulate. Among other things you can filter out fields, add fields, or extract an individual element from the data. JSON is the ideal way for sending complex data from the client to the server, or from the server to the client. Having a good understanding of JSON is therefore very helpful in building web applications.

In the javascript language JSON is processed inline. This means that you can use JSON in javascript and it will be automatically recognized by the javascript engine. You can add objects, arrays, and literal values to your JSON data, write some javascript code to build a given part of an object, and it will just work. When the javascript engine comes across any JSON data it knows that a sub-object is a sub-object, an array is an array, and a literal value is a literal value. You do not have to parse JSON in javascript. 

Most of Alpha Anywhere's server-side code is written in Xbasic, a language that does not support JSON natively. However, Alpha Anywhere does support a lot of methods that work with JSON and allow you to both import and export JSON to and from your components. How do these methods work? When you create a JSON object, the children of that object are read in Xbasic as a string. The Xbasic methods then take that string, work against it, and return either JSON or Xbasic. Alpha Anywhere's set of methods can do the same thing for Xbasic objects, returning either JSON or Xbasic. This gives you the ability to parse a string into an object and an object into a string. For example, take the following Xbasic object:
</description>
				<example><![CDATA[dim o as p
 dim o.firstName as c = "Selwyn"
 dim o.lastName as c = "Rabins" ]]></example>  
				  
			  </section>
			  <section>
				  <description>You could create an 'o' object like the one above in Xbasic. It would work, but you would end up having to write a lot of unnecessary code for each of the 'o' parent object's children. Include Alpha Anywhere's JSON parse method, and you can easily simplify things by placing the data for 'o' object's children into a JSON format:</description>
				  <example><![CDATA[dim o as p
 o = json_parse("{firstName: 'Selwyn', lastName: 'Rabins'}")]]></example>
				  
			  </section>
			  
			  
          </sections>
      </group>
	</groups>
	
  
  
  
  
  
  
	
  <groups>
    <group background="true">
        <sections>
          <section>
            <title>Using JSON with Xbasic</title>
            <description>The example below demonstrates how you can apply this information in building a UX component using Xbasic on the server-side that uses JSON.  To be used as Xbasic, JSON needs to be a string. For more information you can follow this video  here. </description>
            
            
          </section>          
        </sections>
</group>

    <group>
   
	<sections>
    <section>
      <title>Create JSON from Xbasic:</title>
      <steps>
        <step>
            <description>In Alpha Anywhere's toolbar click on the Interactive Window button. This will open the Code editor.</description>
            <figure><link>images/interactive.png</link></figure>
        </step>
        
        <step>
          <description>In the Code Editor, go to the Interactive tab and define the following dot variable name 'pp' by entering this code. This is an Xbasic object. Hit Enter at the end of every line.</description>
          <example><![CDATA[dim pp as p
pp.Name = "Fred"
pp.Age = 30
]]></example>
        </step>
        
        <step>
          <description>Now add ?json_generate(pp) to the end of the pp object. Hit Enter again.</description>
          <example><![CDATA[dim pp as p
pp.Name = "Fred"
pp.Age = 30
?json_generate(pp)
]]></example>
        </step>
        <step>
          <description>You should see a generated JSON representation of the pp object. You have succesfully serialized the 'pp' object into a JSON string.</description>
          <figure><link>images/interactive2.png</link></figure>
        </step>
      </steps>
      
    </section>    
  </sections>
	</group>
  
    <group background="true">
      <sections>
        <section>
          <description>In JSON objects start with a curly bracket and end with a closed curly bracket. Inside the object are name value pairs. All property names are double quoted. In this object, for example, the property names are "Name", "Age". JSON can also encode the logical values true and false. Add a new 'Married' property to your Xbasic code and set it to true 'pp.Married = .t.'.
</description>
          <example><![CDATA[dim pp as p
pp.Name = "Fred"
pp.Age = 30
pp.Married = .t.
]]></example>
        </section>
         <section>
          <description>Now run this object again using ?json_generate(pp). The generated JSON should look like this:</description>
          <example><![CDATA[= {
        "Name": "Fred",
        "Age": 30,
        "Married" : true
}
]]></example>
        </section>
         <section>
          <description>In addition to creating JSON data from Xbasic you can also instatiate an object from a JSON string. The following example will demostrate how.</description>
         
        </section>
      </sections>
</group>
<group>


<sections>
  <section>
    <title>Create Xbasic from JSON:</title>
    <steps>
      <step>
        <description>In Alpha Anywhere's toolbar click on the Interactive Window button. This will open the Code editor.</description>
        <figure><link>images/interactive.png</link></figure>
      </step>
      <step>
        <description>The Code Editor will open. Click the New Script using Xbasic Editor button on the top left of the Code Editor's toolbar.</description>
        <figure><link>images/interactive3.png</link></figure>
      </step>
      <step>
        <description>This will open a new tab in the Code Editor. Enter the following code. Hit Enter after every line.</description>
        <example><![CDATA[dim txt as c 
txt = <<%str%
{
        "Name": "Fred",
        "Age": 30,
        "Married" : true
}
%str%
dim pp2 as p
pp2 = json_parse(txt)
debug(1)
]]></example>
        <note><![CDATA[Note: In Xbasic the angle bracket, angle bracket << defines a string whose definition expands over multiple lines. Here we have defined all of our JSON data as an xbasic string and have given that string a variable name of 'txt'. A Xbasic object named pp2 is then created that takes as its value the parsed txt variable.]]></note>
      </step>
      
      <step>
        <description>The debug(1) has been added to the end of this code so we can see the JSON data in the debugger. Click the lightning bolt in the toolbar to run the code.</description>
        <figure><link>images/interactive4.png</link></figure>
      </step>
      
      <step>
        <description>The Xbasic debugger will open. Type 'pp2' into the Expression entry box at the bottom of the debugger. 

</description>
        <figure><link>images/interactive5.png</link></figure>
      </step>
      
      <step>
        <description>Hit Enter and then click the expand or 'plus' button , to the left of the Expression box, to show all of the JSON data in the pp2 object.</description>
        <figure><link>images/interactive6.png</link></figure>
      </step>
      <step>
        <description>The expanded Expression box lets you drill down.</description>
        <figure><link>images/interactive7.png</link></figure>
      </step>
      
      
      
    </steps>
  </section>  
</sections>
  
  </group>
</groups>
  <groups>
    <group background="true"><title>JSON and Sub-Objects</title>
      <sections>
        <section>
          <description>The previous example showed how to parse a string containing JSON data that contained simple literal values. However, what if you wanted to create sub-objects within your data? As the objects in the examples above demonstrate, all properties in JSON are delimited with a comma; except for the last property which has nothing after it. As long as a property is delimited and has a property name in double quotes followed by a colon, the definition can be an object, array, or literal. To see how to create a sub-object in JSON that can be used with Xbasic watch this video, or follow the guide below.</description>
          
        </section>
        
      </sections>
      
    </group>
    <group>
      <sections>
        <section>
          <title>Creating a Sub-Object in JSON to use with Xbasic:</title>
          <steps>
            <step>
              <description>In Alpha Anywhere's toolbar click on the Interactive Window button. This will open the Code editor.</description>
            </step>
            <step>
              <description>The Code Editor will open. Click the New Script using Xbasic Editor button  on the top left of the Code Editor's toolbar.</description>
            </step>
            <step>
              <description>Enter the same code into the Code Editor that you did in step 3 of the 'Create Xbasic from JSON' example. The code should look like this.</description>
              <figure><link>images/interactive8.png</link></figure>
       
            </step>
            <step>
              <description>Now place a comma after the "Married" property. Hit enter and on the line below the "Married" property add a new property name called "Address".</description>
            </step>
            <step>
              <description>Place a colon next to the 'Address' and a set of curly brackets. Inside the brackets add three more properties; a "Street" property, "Number" property, and a "City" property, </description>
              <example><![CDATA[dim txt as c 
txt = <<%str%
{
        "Name": "Fred",
        "Age": 30,
        "Married" : true,
        "Address" : {
                       "Street" : "Main Street",     
                        "Number" : 123,
                        "City" : "Boston"
                            }
}
%str%
dim pp2 as p
pp2 = json_parse(txt)
debug(1)
 ]]></example>
           
           
            </step>
            <step>
              <description>Now click the lightning bolt icon  in the Alpha Anywhere toolbar to run this code. The debugger should open. type pp2 into the Expression entry box at the bottom of the debugger and hit Enter.</description>
              <figure><link>images/interactive9.png</link></figure>
            </step>
            
            
            <step>
              <description>Click the Expand or plus button  to the right of the Expression entry.</description>
              <figure><link>images/interactive10.png</link></figure>
            </step>
            
            
            <step>
              <description>Click on the Address value to expand the Address sub-object that you defined. You should see all of the JSON data from the sub-object you defined inside of your Xbasic code.</description>
              <figure><link>images/interactive11.png</link></figure>
            </step>
                   
          </steps>     
        </section>       
      </sections>
    </group>
  </groups>
  
  <groups>
    <group background="true"><title>JSON and Arrays</title>
      <sections>
        <section>
          <description>Arrays in JSON start with a square bracket [ and end with a square bracket ]. JSON arrays are base 0, meaning the first element in a JSON array is 0, the second element is 1, the third element is 2, and so on. This is different from Xbasic which is base 1. Arrays can contain literal values or objects themselves. This example will show how to add an array property to your JSON data named "Children", to be used in an Xbasic object named pp2. This array will use objects as its elements. The first element in the array will be this object {"Name" : "John", "Age" : 3} which has the "Name" of "John" and an "Age" of 3. Like all objects, each of the properties within this object are delimited by a comma, with the exception on the last property in the object. For more information on the steps that follow watch this video</description>
          
        </section>
        
      </sections>
      
    </group>
    <group>
      <sections>
        <section>
          <title>Creating an Array in JSON to use with Xbasic:</title>
          <steps>
            <step>
              <description>In Alpha Anywhere's toolbar click on the Interactive Window button. This will open the Code editor.</description>
            </step>
             <step>
              <description>The Code Editor will open. Click the New Script using Xbasic Editor button  on the top left of the Code Editor's toolbar.</description>
            </step>
             <step>
              <description>Enter the following code into the New Script page in the Code Editor.</description>
              <example><![CDATA[dim txt as c 
txt = <<%str%
{
        "Name": "Fred",
        "Age": 30,
        "Married" : true,
        "Address" : {
                       "Street" : "Main Street",     
                        "Number" : 123,
                        "City" : Boston
                            },
        "Children" : [
                            {"Name" : "John", "Age" : 3}
                            ]
}
%str%
dim pp2 as p
pp2 = json_parse(txt)
debug(1)
 ]]></example>
            
            </step>
            <step>
              <description>Create two more elements for the "Children" array. As with objects, each element in the array should have a trailing comma; excepting the last element which has no comma. The result should look something like this:</description>
              <example><![CDATA["Children" : [
                            {"Name" : "John", "Age" : 3},
                            {"Name" : "Sally", "Age" : 5},
                            {"Name" : "Kim", "Age" : 7}
                            ]
 ]]></example>
            </step>
            
            <step>
              <description>Now click the lightning icon in the toolbar and run the code. The Debugger should open. Enter pp2 into the Expression box at the bottom on the debugger.

</description>
              <figure><link>images/array1.png</link></figure> 
            </step>
            
             <step>
              <description>Click the Expand or 'plus' button next to the Expression box to see all of the properties in the pp2 object.

</description>
              <figure><link>images/array2.png</link></figure> 
            </step>
            
             <step>
              <description>Click on the Children array property that you defined. The elements within that property will be displayed.

</description>
              <figure><link>images/array3.png</link></figure> 
            </step>
            
             <step>
              <description>Now click on one of the elements in your Children array in the Value list. You should be able to see the object properties for each element.</description>
              <figure><link>images/array4.png</link></figure> 
            </step>
            
          </steps>
          
        </section>
        
      </sections>
      
      
      
    </group>
    <group background="true">
      <sections>
        <section>
          <description>This example has shown how to create a complex Xbasic object using data parsed from JSON that includes an array. You can also pass things from Xbasic into JSON using json_generate(). Here is How.</description>
        </section>
      </sections>
      
    </group>
    

  <group>
    <sections>
      <section>
        <title>Show your Xbasic object's data in JSON form:</title>
        <steps>
          <step>
            <description>Remove the debug(1) line in your code and add this to the end instead. This code will output the JSON from the pp2 Xbasic object using the json_generate() method. The showvar() method will display the result.</description>
            <example><![CDATA[dim txt2 as c
txt2 = json_generate(pp2)
showvar(txt2)
 ]]></example>
          </step>
          <step>
            <description>Click the lightning icon  to run the code. A Variable dialog will open displaying the pp2 objects data in JSON form. The result should look something like this:</description>
            <figure><link>images/array5.png</link></figure>
            
          </step>
          
        </steps>
        
      </section>
      
    </sections>

  </group>
 </groups>
  
  
  
  <groups>
    <group background="true">
      <title>Using JSON with Javascript</title>
      
      <sections><section>
      <description>So far, this guide has shown how to serialize objects, but you can also use Javascript on the client-side to work with JSON. This example will demonstrate how you can incorporate JSON into a UX component and then manipulate the JSON data using Javascript. For more information watch this video Part 1 and Part 2. To recap, we have covered the following about JSON objects so far. A JSON object starts and ends with curly brackets and has as many name value pairs as you want within those curly brackets. Each name value pair is delimited with a comma. Each entry can be an array, a literal, or an object. In this way it is possible to represent a very complex object using JSON while still maintaining the ability to easily read and understand it</description>
  </section></sections>
  
    </group>
    <group>
      <sections>
        <section>
          <title>Output a JSON on the Client-side in a UX Component:</title>
          <steps>
            <step>
              <description>In the Web Projects control Panel click the New Component or File button. In the New File dialog select Web Component and click Next. Select UX and click Next again. </description> 
            </step>
            
            <step>
              <description>On the Select UX Component template page leave the Start with a blank UX Component radio button selected and click OK.</description> 
            </step>
            
            <step>
              <description>On the Design tab of the UX Builder open the UX Controls page from the menu list. 

</description> 
              <figure><link>images/jsonjs4.png</link></figure>
            </step>
            
            <step>
              <description>On the Controls page, open the Other Controls dropdown that appears in the Design menu. Double click on the [Button] control option to add it to your UX component.</description> 
                 <figure><link>images/jsonjs7.png</link></figure>
            </step>
            
            <step>
              <description>Add a [Static text:] control to your component in the same way. </description> 
            </step>
            
            <step>
              <description>You can arrange the controls using the up and down arrows in the toolbar such that they go [Button], [Static Text:].</description> 
              <figure><link>images/jsonjs8.png</link></figure>
            </step>
            
            <step>
              <description>Click on the [Button] control in your list to highlight it. Go over to the Control Properties list to the Right. Find Button Properties.</description> 
            </step>
            
            <step>
              <description>In the Button Properties section find the Button text property and change the button text to 'Objects'.</description> 
            </step>
            
            <step>
              <description>Scroll down the Properties list until you reach the Javascript (Touch. Mouse. Pointer Events) section. Click the button  next to the click property.</description> 
            </step>
            
            <step>
              <description>The Edit Click Event dialog will open. Click the Text mode radio button. In the Javascript Attribute work area write objectsTest(); and click Save. </description>
              <figure><link>images/jsonjs9.png</link></figure>
            </step>
            
             <step>
              <description>Now Click on the [Static Text:] control that you created. In the Properties menu under Static Text Properties find the Static text property.</description>
              
            </step>
            
             <step>
              <description>Next to the Static text property enter the following html <div id="msg1"></div>.</description>
              <figure><link>images/jsonjs2.png</link></figure>
            </step>
            
             <step>
              <description>Still in the Controls page, find the Code dropdown in the menu and under it click the Javascript functions option. Enter the following code to define the objectsTest() function.</description>
              <example><![CDATA[function objectsTest() {
    var obj = {
        "Firstname" : "Fred",
        "Lastname" : "Smith",
        "Children" : [
                    {"Name" : "Jackie", "Age" : 10},
                    {"Name" : "Joan", "Age" : 12}
            ]
    };

    var msg = JSON.stringify(obj);
    $('msg1').innerHTML = msg;   
}
 ]]></example>
 <note>Note: Here we have designed a button that will create an object in Javascript, serialize that object to JSON, and then print the JSON data out. The var obj is a javascript variable object that is initialized by passing into it a JSON string. This is the equivalent on the Xbasic side to using JSON parse to instantiate an xbasic object from a JSON string. In this example we are initializing an object using an object literal. An object literal and JSON look similar but are not technically identical. Our object literal contains a Firstname property, Lastname property, and a Children property which is an array containing additional object properties. After defining the object literal, a call javascript method, JSON.stringify(), is used to serialize the object into a string with the name msg1. Using innerHTML, this msg1 string is then inserted into the text of the div that we defined for the [Static text] control in our component. This means that when the 'Objects' button is clicked, using javascript, the [Static text] control will be filled in with html that displays the JSON data. </note>
            </step>
            <step>
              <description>Go to Working Preview and click on the 'Objects' button.</description>
              <figure><link>images/jsonjs.png</link></figure>
            </step>
            
            
          </steps>
          
        </section>
        
        
      </sections>
      
      
      
    </group>
    <group>
      
      <sections>
        <section>
          <title>Create a Button that Parses JSON data:</title>
          <steps>
            <step>
              <description> In the Web Projects control Panel click the New Component or File button. In the New File dialog select Web Component and click Next. Select UX and click Next again. </description>
            </step>
            
             <step>
              <description>On the Select UX Component template page leave the 'Start with a blank UX Component' radio button selected and click OK.</description>
            </step>
            
             <step>
              <description>On the Design tab of the UX Builder open the UX Controls page from the menu list. </description>
            </step>
            
             <step>
              <description>On the Controls page, go to the Data Controls dropdown section in the design menu and double click on the [TextArea] control option. </description>
              <figure><link>images/jsonjs5.png</link></figure>
            </step>
             <step>
              <description>In the New Control dialog that opens select 'Create a single new control'. Give the control the Name jsonIn and the Label Json In. Under Data Type select Character and click OK.</description>
              <figure><link>images/jsonjs6.png</link></figure>
            </step>
            
             <step>
              <description>On the Controls page, open the Other Controls dropdown that appears in the Design menu. Double click on the [Button] control option to add it to your UX component.</description>
            
            </step>
            
            <step>
              <description>Select the [TextArea] control that you labeled Json In. Look to the right. In the Field properties section inside the Control Properties list, find the Default value property.</description>
            </step>
            
             <step>
              <description>Change the Default value to be this string of JSON.</description>
              <example><![CDATA[{"Firstname" : "Fred","Lastname" : "Smith","Children" : [{"Name" : "Jackie", "Age" : 10},{"Name" : "Joan", "Age" : 12}]} ]]></example>
            </step>
            
             <step>
              <description>Select the [Button] control in the control list. In the Properties list on the right find the Button Properties section.</description>
            </step>
            
             <step>
              <description>In the Button Properties section, change the Button text property to read Parse JSON.</description>
            </step>
            
             <step>
              <description>Scroll down to the Javascript (Touch. Mouse. Pointer Events) properties section and click the button next to the 'click' property.</description>
            </step>
            
             <step>
              <description>The Edit Click Event Editor will appear. Click on the Text Mode radio button. In the Javascript Attribute work area type parseJSON(); and click Save.</description>
            </step>
            
             <step>
              <description>In the design menu open the Code dropdown and click on the Javascript functions option. Under the objectsTest() function that you defined earlier write the following code.</description>
           <example><![CDATA[function parseJSON()  {
        var json = {dialog.object}.getValue('jsonIn')
        var obj = JSON.parse(json);
        alert(obj ['Children'][1]['Name']);
}
 ]]></example>
           <note><![CDATA[Note: Just like on the Xbasic side where we use json_parse and json_generate there exists similar features in javascript on the client-side. In this example, the parse JSON button is taking a string of JSON from a text area field , parsing it , and then doing an alert from the name field of the second item in the children array. Square brackets are used for syntax in order to read a value in the 'Children' array, that was defined in our JSON data . You can also use dot notation to accomplish this, for example obj.children. The [1] next to the Children array indicates that we are calling the second element of that array. Javascript arrays are zero based, meaning the first item in the array is always 0 the second item is 1. The second element, in the JSON data here, is an object containing a "Name" property, "Joan", and an "Age" property, '12'. The ['Name'] that follows the [1] in our code means that we are only interested in returning the "Name" property. When you run this component and click the parse JSON button, an alert should return "Joan"]]></note>
           
            </step>
            
            
             <step>
              <description>Now go to Working Peview and click the Parse JSON button. You should see an alert pop up giving you the name of the second element in the Children array from the JSON data you defined for the Text area control.</description>
            
            <figure><link>images/jsonjs3.png</link></figure>
            
            </step>          
          </steps>         
        </section>      
      </sections>
    </group>
  </groups>
  
  <groups>
    <group background="true">
      <title>Using JSON to send Data from Client to Server</title>
      <sections>
        <section>
          <description>JSON is useful for passing information form the client to the server.  One way to accomplish this is by passing information into an Ajax callback. In this case, you might have a button that is tied to an AJAX callback which turns around and calls up some Xbasic. You could then add some of Alpha Anywhere's JSON functions to that Xbasic code to allow you to go out, get JSON data from an external source, and then return that data to your component in Xbasic.

Xbasic is currently the coding language on the server. Sometimes you need to turn Xbasic code into something the client side browser can recognize, i.e Javascript. The easiest way to get into the client is through Javascript. When someone clicks a button do an Ajax callback, that callback is handled in Xbasic, which does some manipulations and then returns an object to the client browser in the form of a string. The browser, which  is waiting for the response, then takes that object and generates some actual JSON, that it returns to the client. 

When you want to parse a complex set of data, you can parse JSON data back into an ajax callback and, on the Xbasic side, parse that data and extract values from it. For more information on how to do this watch these videos Part 1 and Part 2 or follow the examples below.
</description>
          
        </section>
        
      </sections>
    </group>
    <group>
      <sections>
        <section>
          <steps>
            <step>
              <description>In the Web Projects control Panel click the New Component or File button. In the New File dialog select Web Component and click Next. Select UX and click Next again. </description>
            </step>
            
             <step>
              <description>On the Select UX Component template page leave the 'Start with a blank UX Component' radio button selected and click OK.</description>
            </step>
            
             <step>
              <description>On the Design tab of the UX Builder open the UX Controls page from the menu list. </description>
            </step>
            
             <step>
              <description>On the Controls page, go to the Data Controls dropdown section in the design menu and double click on the [TextArea] control option. </description>
            </step>
            
             <step>
              <description>In the New Control dialog that opens select 'Create a single new control'. Give the control the Name jsonIn and the Label Json In. Under Data Type select Character and click OK.</description>
            </step>
            
             <step>
              <description>Select the [TextArea] control that you labeled Json In. Look to the right. In the Field properties section inside the Control Properties list, find the Default value property.</description>
            </step>
            
             <step>
              <description>Change the Default value to be this string of JSON.</description>
              <example><![CDATA[{"Firstname" : "Fred","Lastname" : "Smith","Children" : [{"Name" : "Jackie", "Age" : 10},{"Name" : "Joan", "Age" : 12}]} ]]></example>
            </step>
            
             <step>
              <description>On the Controls page, open the Other Controls dropdown in the menu and double click on [Button] control to add it to the UX component.</description>
            </step>
            
             <step>
              <description>With the Button control selected, look in the control Properties list on the right. Under the Button Properties section, find the Button text property.</description>
            </step>
            
             <step>
              <description>Change the Button text property to read 'Make and Ajax Callback'</description>
            </step>
            
             <step>
              <description>Scroll down the Properties list until you reach the Javascript (Touch. Mouse. Pointer Events) section. Click the button next to the click property.</description>
            </step>
            
             <step>
              <description>The Edit onClick Event dialog will open. Select the Action Javascript radio button option at the top and click the Add New Action button.</description>
            </step>
            
             <step>
              <description>In the Action Javascript Select and Action dialog select Action Callbacks and Javascript from the Categories list on the left.</description>
            </step>
            
              <step>
              <description>From the Actions: list on the right select Ajax Callback. And click OK.</description>
            <figure><link>images/ajaxcallback.png</link></figure>
            </step>
            
             <step>
              <description>An Action Javascript Ajax Callback dialog will open. </description>
            </step>
            
              <step>
              <description>In the Ajax Callback section of the dialog, leave the Callback type property set to InternalXbasicFunction and type xb next to the Function name property.</description>
            </step>
            
             <step>
              <description>In the Advanced section of the dialog, find the Additional data to submit property and next to it type additionalAjaxData(). Click OK, OK, and Save.</description>
         <figure><link>images/ajaxcallback2.png</link></figure>
         <notes><![CDATA[Note: The Additional data to submit property represents the data that is going to be submitted from the client side to the server side. This property allows you to use an Xbasic function to return data. You can specify additional data to submit in the Action Javascript Ajax Callback genie. This data will be available inside your custom event handler, in this case the click event. What is expected from the Additional data to submit property is a Query string, name value pairs delimited with an & sign, type in a Review help text in Action Javascript Ajax Callback Action. This feature is useful when you want to generate arbitrary information on the client side. ]]></notes>
            </step>
            
            <step>
              <description>Click on the Code dropdown and select Javascript functions. In the Javascript workspace add the following code. </description>
          <example><![CDATA[function additionalAjaxData() {
    var json = {dialog.object}.getValue('jsonIn');
    //return '__additionalData=' + json;
    var data = A5.ajax.buildURLParam('__additionalData',json);
    return data;
}
 ]]></example>
 <note>Note: Here we are reading the value that is in the text area field and sending back to the server a name value pair. This name value pair is formatted like a query string. The value part of the name value pair needs to be URL encoded. Inside the Alpha JS library there is a buildURL function that takes its first argument as name and its second argument as a value. The buildURL function then encodes that value. </note>
            </step>
            
            
            <step>
              <description>From the Code dropdown click on the Xbasic functions option. Add the following Xbasic.</description>
           <example><![CDATA[function xb as c (e as p)

    dim json as c
    json = e.__additionalData

    dim p as p 
    p = json_parse(json)
    dim msg as c
    msg = "Message from Xbasic. The name of the second child is: " + p.children[2].name

    dim js as c
    js = "alert('" + js_escape(msg) + "');"

    xb = js
end function
 ]]></example>
           <note><![CDATA[This code takes the string of JSON data that we defined earlier and sends it back to the server as part of an ajax callback. It then parses this information on the server using the parse function. Afterward, it extracts the name field, from the second array item in the childrens array, and uses this to construct an object that is fed into an alert message and passed to the client. 

Going line by line this is what this looks like. The xb in this case is the actual Xbasic function that will handle the Ajax callback. In the line dim json as c, we create an Xbasic character variable called json. This variable is then set to = e.__additionalData.  The e is a pointer variable that is passed into the xb function. It points to an object that contains a property called additionalData, which is a string that is sent back as part of the Ajax callback. The p in the line dim p as p defines an second Xbasic pointer variable that is set to =json_parse(json). The json_parse() function parses a string, in this case the json string that we defined, in JSON format and returns an Xbasic variable. 

Next we create a javascript response to send back to the client. In dim msg as c we create yet a third Xbasic variable, a character variable called msg, that contains a string and the second element of the children array; the array that was included in the string that we parsed. In Xbasic arrays are 1 based, meaning the first element in the array is [1] and the second element is [2]. This is unlike Javascript which is 0 based. When msg is defined it is then passed into a js object that is tied to a javascript alert. When you return a string, you need to make sure it is Javascript safe. In dim js as c, a js object is created that is set to be an alert message that to be sent back to the client. Xbasic still views this alert message as a string, but javascript will interpret it as javascript. The line xb = js is equivalent to a return statement in javascript. In this case we are returning the js string to the javascript that operates the client side code.

 ]]></note>
            </step>
            
            
            <step>
              <description>Now go to Working Preview and click the Make Ajax Callback button. You should see something like this:</description>
        <figure><link>images/ajaxcallback3.png</link></figure>
            </step>
            
          </steps>     
        </section>
      </sections>     
    </group>
  </groups>
  
  <groups>
    <group background="true">
      <title>Using JSON to send Data from Client to Server</title>
      <sections>
        <section>
          <description><![CDATA[JSON is useful for passing information form the client to the server.  One way to accomplish this is by passing information into an Ajax callback. In this case, you might have a button that is tied to an AJAX callback which turns around and calls up some Xbasic. You could then add some of Alpha Anywhere's JSON functions to that Xbasic code to allow you to go out, get JSON data from an external source, and then return that data to your component in Xbasic.

Xbasic is currently the coding language on the server. Sometimes you need to turn Xbasic code into something the client side browser can recognize, i.e Javascript. The easiest way to get into the client is through Javascript. When someone clicks a button do an Ajax callback, that callback is handled in Xbasic, which does some manipulations and then returns an object to the client browser in the form of a string. The browser, which  is waiting for the response, then takes that object and generates some actual JSON, that it returns to the client. 

When you want to parse a complex set of data, you can parse JSON data back into an ajax callback and, on the Xbasic side, parse that data and extract values from it. For more information on how to do this watch these videos Part 1 and Part 2 or follow the examples below.
 ]]></description>
          
        </section>
        
        
      </sections>
    </group>
    
    <group>
      <sections>
        <section>
          <steps>
            <step>
              <description>In the Web Projects control Panel click the New Component or File button. In the New File dialog select Web Component and click Next. Select UX and click Next again. </description>
            </step>
            
             <step>
              <description>On the Select UX Component template page leave the 'Start with a blank UX Component' radio button selected and click OK.</description>
            </step>
            
             <step>
              <description>On the Design tab of the UX Builder open the UX Controls page from the menu list. </description>
            </step>
            
             <step>
              <description>On the Controls page, go to the Data Controls dropdown section in the design menu and double click on the [TextArea] control option. </description>
            </step>
            
             <step>
              <description>In the New Control dialog that opens select 'Create a single new control'. Give the control the Name jsonIn and the Label Json In. Under Data Type select Character and click OK.</description>
            </step>
            
             <step>
              <description>Select the [TextArea] control that you labeled Json In. Look to the right. In the Field properties section inside the Control Properties list, find the Default value property.</description>
            </step>
            
             <step>
              <description>Change the Default value to be this string of JSON.</description>
              <example><![CDATA[{"Firstname" : "Fred","Lastname" : "Smith","Children" : [{"Name" : "Jackie", "Age" : 10},{"Name" : "Joan", "Age" : 12}]} ]]></example>
            </step>
            
             <step>
              <description>On the Controls page, open the Other Controls dropdown in the menu and double click on [Button] control to add it to the UX component.</description>
            </step>
            
            <step>
              <description>With the Button control selected, look in the control Properties list on the right. Under the Button Properties section, find the Button text property.</description>
            </step>
            
            <step>
              <description>Change the Button text property to read 'Make and Ajax Callback'</description>
            </step>
            
            
            <step>
              <description>Scroll down the Properties list until you reach the Javascript (Touch. Mouse. Pointer Events) section. Click the button next to the click property.</description>
            </step>
            
            <step>
              <description>The Edit onClick Event dialog will open. Select the Action Javascript radio button option at the top and click the Add New Action button.</description>
            </step>
            
            <step>
              <description>In the Action Javascript Select and Action dialog select Action Callbacks and Javascript from the Categories list on the left.</description>
            </step>
            
             <step>
              <description>From the Actions: list on the right select Ajax Callback. And click OK.</description>
              <figure><link>images/ajaxcallback.png</link></figure>
            </step>
            
             <step>
              <description>An Action Javascript Ajax Callback dialog will open. </description>
            </step>
            
             <step>
              <description>In the Ajax Callback section of the dialog, leave the Callback type property set to InternalXbasicFunction and type xb next to the Function name property.</description>
            </step>
            
            <step>
              <description>In the Advanced section of the dialog, find the Additional data to submit property and next to it type additionalAjaxData(). Click OK, OK, and Save.</description>
                <figure><link>images/ajaxcallback2.png</link></figure>
         <note><![CDATA[Note: The Additional data to submit property represents the data that is going to be submitted from the client side to the server side. This property allows you to use an Xbasic function to return data. You can specify additional data to submit in the Action Javascript Ajax Callback genie. This data will be available inside your custom event handler, in this case the click event. What is expected from the Additional data to submit property is a Query string, name value pairs delimited with an & sign, type in a Review help text in Action Javascript Ajax Callback Action. This feature is useful when you want to generate arbitrary information on the client side. ]]></note>
         
            </step>
            
            <step>
              <description>Click on the Code dropdown and select Javascript functions. In the Javascript workspace add the following code. </description>
            <example><![CDATA[function additionalAjaxData() {
    var json = {dialog.object}.getValue('jsonIn');
    //return '__additionalData=' + json;
    var data = A5.ajax.buildURLParam('__additionalData',json);
    return data;
}
 ]]></example>
            <note>Note: Here we are reading the value that is in the text area field and sending back to the server a name value pair. This name value pair is formatted like a query string. The value part of the name value pair needs to be URL encoded. Inside the Alpha JS library there is a buildURL function that takes its first argument as name and its second argument as a value. The buildURL function then encodes that value. </note>
            
            </step>
            
            <step>
              <description>From the Code dropdown click on the Xbasic functions option. Add the following Xbasic.</description>
           <example><![CDATA[function xb as c (e as p)

    dim json as c
    json = e.__additionalData

    dim p as p 
    p = json_parse(json)
    dim msg as c
    msg = "Message from Xbasic. The name of the second child is: " + p.children[2].name

    dim js as c
    js = "alert('" + js_escape(msg) + "');"

    xb = js
end function
 ]]></example>
           <note>This code takes the string of JSON data that we defined earlier and sends it back to the server as part of an ajax callback. It then parses this information on the server using the parse function. Afterward, it extracts the name field, from the second array item in the childrens array, and uses this to construct an object that is fed into an alert message and passed to the client. 

Going line by line this is what this looks like. The xb in this case is the actual Xbasic function that will handle the Ajax callback. In the line dim json as c, we create an Xbasic character variable called json. This variable is then set to = e.__additionalData.  The e is a pointer variable that is passed into the xb function. It points to an object that contains a property called additionalData, which is a string that is sent back as part of the Ajax callback. The p in the line dim p as p defines an second Xbasic pointer variable that is set to =json_parse(json). The json_parse() function parses a string, in this case the json string that we defined, in JSON format and returns an Xbasic variable. 

Next we create a javascript response to send back to the client. In dim msg as c we create yet a third Xbasic variable, a character variable called msg, that contains a string and the second element of the children array; the array that was included in the string that we parsed. In Xbasic arrays are 1 based, meaning the first element in the array is [1] and the second element is [2]. This is unlike Javascript which is 0 based. When msg is defined it is then passed into a js object that is tied to a javascript alert. When you return a string, you need to make sure it is Javascript safe. In dim js as c, a js object is created that is set to be an alert message that to be sent back to the client. Xbasic still views this alert message as a string, but javascript will interpret it as javascript. The line xb = js is equivalent to a return statement in javascript. In this case we are returning the js string to the javascript that operates the client side code.
</note>
           
            </step>
            <step>
              <description>Now go to Working Preview and click the Make Ajax Callback button. You should see something like this:</description>
              <figure><link>images/ajaxcallback3.png</link></figure>
              
            </step>
            
            
            
          </steps>
          
          
        </section>
        
        
      </sections>
      
      
      
    </group>
  </groups>
  
	<groups>
    <group background="title">
      <title>JSON and sending data from Server to Client</title>
      <sections>
        <section>
          <description>In this example, look at how you can make a callback from the client to the server to retrieve data from the server in JSON format and then work with the data that was sent back from the server and display it on the client. In some nicely formated html on the client side</description>
          
          
        </section>
        <section>
          
          <description>Watch Video - Part 1
Watch Video - Part 2
Watch Video - Part 3
Watch Video - Part 4</description>
          
        </section>
        
      </sections>
    </group>
    <group>
      <sections><section>
        <title>Use JSON to send data from the Server to the Client:</title>
        <steps>
          <step>
            <description>In the Web Projects control Panel click the New Component or File button. In the New File dialog select Web Component and click Next. Select UX and click Next again. </description>
          </step>
          
          <step>
            <description>On the Select UX Component template page leave the 'Start with a blank UX Component' radio button selected and click OK.</description>
          </step>
          
          <step>
            <description>On the Design tab of the UX Builder open the UX Controls page from the menu list. </description>
          </step>
          
          <step>
            <description>Open the Other Controls dropdown and double click on [Button] to add a button to the UX component. </description>
          </step>
          
          <step>
            <description>Click on the [Static Text] control in the Other Controls dropdown to add a static text control to the UX component.</description>
          </step>
          
          <step>
            <description>Select the Static test control and look at the Control Properties list. In the Static Text Properties section change the Static text property to this:

            </description>
            <example><![CDATA[<div id="msg2"></div>
             ]]></example>
          </step>
          
          <step>
            <description>Select the button that you added to you component. Go to the the Properties list on the right. </description>
          </step>
          
           <step>
            <description>In the Button Properties section change the Button text property to read Fetch data from server.</description>
          </step>
          
           <step>
            <description>Go to the Javascript (Touch. Mouse. Pointer Events) section of the Properties list and choose the click property.</description>
          </step>
          
           <step>
            <description>The Edit Click Event dialog will open. Leave the Action Javascript radio button selected.</description>
          </step>
          
           <step>
            <description>Click the Add New Action button. The Action Javascript - Select an Action dialog will open.</description>
          </step>
          
           <step>
            <description>In the Categories: list select Ajax Callbacks and Javascript option. In the Actions: list select Ajax Callback. Click OK.</description>
          </step>
          
           <step>
            <description>The Action Javascript - Ajax Callback Action genie will appear. Set the Function name property to be xb2</description>
          </step>
          
           <step>
            <description>Click the button  next to the After callback complete Javascript property. </description>
          </step>
          
           <step>
            <description>The After Callback Complete Javascript dialog will open. Add a function called expandTemplate(); and click OK and OK and OK again. Save.</description>
       <figure><link>images/ajaxserverclient.png</link></figure>
   <note>Note: As you probably know Ajax is asynchronos. In creating this Ajax callback this means that you can't have the function, expandTemplate(), be triggered immediately. As a result, in this example you can not add more actions to the Edit Click Event dialog unless you click the Run actions synchronously button at the bottom of the dialog. In this example, we are leaving this unchecked.</note>
          </step>
          
           <step>
            <description>Open the Code dropdown and click on the Javascript functions page. Enter the following code:</description>
       <example><![CDATA[function expandTemplate() {

    var ele = $('msg2');
    //A5.u.element.setContent() is like setting the .innerHTML of ele, but preserves drag scroll behavior
    A5.u.element.setContent(ele, 'this is the expanded template');

}
]]></example>
<note>Note: Instead of setting .innerHTML directly we are using a helper function called A5.u.element.setContent(). This is the preferred way of writing this code if there is a possibility that drag scrolling is enabled. If the element that you are setting the .innerHTML on had grad scrolling enabled, and you set innerHTML directly, it would destroy the drag scrolling capability. Moving on, after the client receives the data we want to format it:</note>
          </step>
          
           <step>
            <description>Save your Component and go to the Web Projects Control Panel. From the Tools dropdown select the Open Template Tester window.  On JSON tab click Load Example.</description>
          </step>
          
           <step>
            <description>From the Select Example list choose the Simple object, simple template object. Click OK.</description>
          </step>
          
          <step>
            <description>Want JSON that is standards compliant. JSON standard required double quotes. Highlight the inserted JSON and hit the Reformat JSON button.</description>
          </step>
          
          <step>
            <description>Go to the Template page and change the html to read the following:</description>
            <example><![CDATA[Hello <b>{firstname}</b> <span style="color:blue;">{lastname}</span>]]></example>
          </step>
          
          <step>
            <description>Click the Show Javascript button. This will show the Javascript that takes data and expands the html. Copy this javascript to the clipboard.</description>
         <figure><link>images/ajaxserverclient2.png</link></figure>
          </step>
          
          <step>
            <description>Go to the Code dropdown again and open Javascript functions. Paste the Javascript into the expandTemplate function that you defined.</description>
          <example><![CDATA[function expandTemplate() {

    var _d = {
            "firstname" : "Fred",
            "lastname": "Smith"
    };
    var _t = [
    'Hello <b>{firstname}</b> <span style="color: blue;">{lastname}</span>'
    ].join('');
    var settings = {
    template: _t,
    partials: ''
    }
    var html = A5.u.template.expand(_d,settings);
    var ele = $('msg2');
    A5.u.element.setContent(ele, 'this is the expanded template');

}
 ]]></example>
          </step>
          
          <step>
            <description>To get data returned by Xbasic callback open the Xbasic function page from the Code dropdown list. Enter the following code:</description>
      <example><![CDATA[function xb2 as c (e as p)
        
        delete p 
        dim p.firstname as c = "Fred"
        dim p.lastname as c = "Smith"
        dim p.date as c = "" + date()
        dim json as c
        json = json_generate(p)

        dim js as c
        js = "{dialog.object}._data = " + json +";"

        xb2 = js

end function
]]></example>
<note><![CDATA[In this code dim json as c creates an Xbasic object. This object, json, is then set to be =json_generate(p). The json_generate() function takes a variable, in this case a variable called p, and returns JSON data in this object in the form of a string. Xbasic now has a string in Xbasic that can read and manipulate. Next we create an Xbasic object named js, in the line dim js as c, and set this equal to xb2. This code effectively places the JSON data inside a temporary variable inside the UX component.]]></note>
          </step>
          
            <step>
            <description>Go to the Working Preview tab. Click the Fetch data from server button.

</description>
<figure><link>images/ajaxserverclient3.png</link></figure>

          </step>
          
            <step>
            <description><![CDATA[Now back to your Javascript functions page and change the expandTemplate() function to include d = {dialog.object}._data; ]]></description>
          </step>
          
            <step>
            <description>Now back to your Javascript functions page and change the expandTemplate() function to include d = {dialog.object}._data; </description>
          </step>
          
          <step>
            <description><![CDATA[Also change A5.u.element.setContent(ele, 'this is the expanded template'); to read  A5.u.element.setContent(ele, html)]]></description>
            <example><![CDATA[function expandTemplate() {

    var _d = {
            "firstname" : "Fred",
            "lastname": "Smith"
    };

    _d = {dialog.object}._data;

    var _t = [
    'Hello <b>{firstname}</b> <span style="color: blue;">{lastname}</span>'
    ].join('');
    var settings = {
    template: _t,
    partials: ''
    }
    var html = A5.u.template.expand(_d,settings);
    var ele = $('msg2');
    A5.u.element.setContent(ele, html);

}
]]></example>
<note>Using A5.u.element.setContent() is like setting the .innerHTML of ele. Unlike .innerHTML, A5.u.element.setContent() preserves the drag scroll behavior. The _d in this code represents the data that the template will expand. Setting _d to {dialog.object}._data; makes _d draw its data from the Xbasic function definition we defined in step 23. When you run the component now you should see that the same data that is defined on the server-side, i.e in Xbasic.</note>
          </step>
 <step>
   <description>Go to Working Preview and click the Fetch data from server button again:</description>
   <figure><link>images/ajaxserverclient4.png</link></figure>
 </step>
 
 <step>
   <description>Go back to the Design tab. To make sure that your code is calling data from the server, reopen your Xbasic functions page in the Code dropdown.</description>
   
 </step>
 
 <step>
   <description>Change the "Fred" and "Smith" in your xb2 function to something different, like "Salmo" and  "trutta" or anything.

</description>
   <figure><link>images/ajaxserverclient5.png</link></figure>
 </step>
 
 <step>
   <description>In the Code dropdown open the Javascript functions page again.</description>
   
 </step>
     <step>
       <description>Now add something to consume the date. Change this line of code 'Hello <b>{firstname}</b> <span style="color: blue;">{lastname}</span>' by adding 'on {date}.'

</description>
       <example><![CDATA['Hello <b>{firstname}</b> <span style="color: blue;">{lastname}</span> on {date}.'
]]></example>
     </step>     
          
<step>
  <description>Go to Working Preview and click button.</description>
  <figure><link>images/ajaxserverclient6.png</link></figure>
  <note>To summarize, the Ajax Callback can be made to the server. The server Xbasic is now free to use any Xbasic code that it wants to compute data to send back to the server. Data that gets sent back is encoded on the server-side into an Xbasic object, in this case a p variable. This variable then gets converted into a JSON string which gets sent back to the client</note>
</step>          
   
        </steps>  
        </section>    
      </sections>
  
    </group>
  </groups>
  
  <groups>
    <group background="true">
      <title>JSON from the Server-side and the Template Tester</title>
      <sections>
        <section>
          <description><![CDATA[The client-side template tester window is very useful in laying out JSON data on the client side. The user interface for the Template Tester is resizable and has separate tabs for JSON Data, Template, Javascript and CSS. As you edit in any of these windows the template preview is automatically updated in the right part of the window. 

While the Template Tester does help in presenting JSON data from the server-side on the client, It is still necessary to define some xbasic and javascript in order to use a specific set of JSON data. When editing Xbasic or Javascript code, html, and JSON it is often helpful to be able to see the start and end of different opening and closing 'pair' delimiters. For example in an Xbasic function call, highlighting the opening an closing parentheses. Or in a Javascript function, highlighting the opening and closing curly braces. In some HTML text, the opening and closing tags (e.g. <div>, <body>, <p> , etc.). Once a 'pair' has been identified, keyboard shortcuts (Control  ] and Control-Shift ] )  allow you to quickly move focus from the start of the 'pair' to the end of the 'pair' or to select all of the text inside the 'pair'. For more on this watch this video.

To follow the advanced example below watch the following videos Part 1, Part 2, Part 3, Part 4 or simply download the component.
]]></description>
          
          
        </section>
        
        
      </sections>
      
    </group>
    
    
    
    
  </groups>
  
	
</page>