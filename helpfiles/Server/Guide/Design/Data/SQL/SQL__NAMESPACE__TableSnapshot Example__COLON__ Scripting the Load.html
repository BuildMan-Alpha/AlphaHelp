	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="SQL::TableSnapshot_Example:_Scripting_the_Load">SQL::TableSnapshot Example: Scripting the Load</h1>
SQL database snapshot objects load and store data and definitions with the help of other objects available to the XBasic programmer.  You can create a snapshot yourself, programmatically; as in this example.  Here, the TableInfo for the table named Contacts is retrieved so that the TableSnapshot has a table definition (we could have scripted the creation of the TableInfo, but that is outside of the scope of this article).  Two instances of RowSnapshot are created and populated with data and then added to the TableSnapshot.<br />
<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >dim cn as SQL::Connection
dim ti as SQL::TableInfo
&nbsp;
dim ts as SQL::TableSnapshot
dim Row as SQL::RowSnapshot
dim Col as SQL::ColumnValue
&nbsp;
cn.open(&#34;::Named::MyDatabase&#34;)		&#39; Open the source database
cn.GetTableInfo(ti, &#34;Contact&#34;)		&#39; Load the schema from the source database
&nbsp;
ts.TableInfo = ti
&nbsp;
&#39; Add two rows
&nbsp;
&#39; Row 1 - Fred Smith
Row = Row.NewInstance()			&#39; Create a new row
&nbsp;
Col = col.NewInstance()			&#39; Create a new column 
Col.Name = &#34;LName&#34;
Col.Value = &#34;Smith&#34;
Row.AddData(Col)			&#39; Add the column to the row
&nbsp;
Col = Col.NewInstance()			&#39; Create a new Column
Col.Name = &#34;FName&#34;
Col.Value = &#34;Fred&#34;
Row.AddData(Col)			&#39; Add the column to the row
&nbsp;
Ts.AddRow(Row)				&#39; Add the column to the row
&nbsp;
&#39; Add the row to the table snapshot
Row = Row.NewInstance()			&#39; Create a new row
&nbsp;
Col = col.NewInstance()			&#39; Create a new column 
Col.Name = &#34;LName&#34;
Col.Value = &#34;LName&#34;
Row.AddData(Col)			&#39; Add the column to the row
&nbsp;
Col = Col.NewInstance()			&#39; Create a new Column
Col.Name = &#34;FName&#34;
Col.Value = &#34;Jones&#34;
Row.AddData(Col)			&#39; Add the column to the row
&nbsp;
Ts.AddRow(Row)				&#39; Add the column to the row
&nbsp;
&#39; Row 2 - Bob Jones
file.from_string(&#34;FName&#34;, ts.XML) 	&#39; Create a new row</pre></div><br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL%3A%3ATableSnapshot+Example%3A+Scripting+the+Load">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending","keywords":"server,guide,sql"}--->
</body></html>