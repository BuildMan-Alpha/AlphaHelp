	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_Dynamically_Construct_SQL_Statements">How to Dynamically Construct SQL Statements</h1>
This interactive session demonstrates how you can programmatically modify SQL statements from Xbasic.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox" >sql = &#34;select firstname, lastname, city from customers where lastame = &#39;smith&#39; order by lastname&#34;
&nbsp;
dim q as sql::Query
?q.parse(sql)
= .T.
&nbsp;
?q.SQLStatement
= &#34;SELECT firstname, lastname, city FROM customers  WHERE lastame = &#39;smith&#39;  ORDER BY lastname&#34;
&nbsp;
dim si as sql::query::SelectItem
?si.parse( &#34;concatenate(firstname,&#39;, &#39;,lastname) as fullname&#34;)
= .T.
q.Column.Add(si)
?q.SQLStatement
= &#34;SELECT firstname, lastname, city,  concatenate(firstname, &#39;, &#39;, lastname)  AS fullname FROM customers  WHERE lastame = &#39;smith&#39;  ORDER BY lastname&#34;
&nbsp;
&nbsp;
dim le as sql::query::LogicalExpression
&#39;remove the where clause by setting to a blank logical expression
q.Where = le
?q.SQLStatement
= &#34;SELECT firstname, lastname, city,  concatenate(firstname, &#39;, &#39;, lastname)  AS fullname FROM customers   ORDER BY lastname&#34;
&nbsp;
&#39;add a new where clause
?le.parse(&#34;lastname = &#39;smith&#39; and firstname = &#39;john&#39;&#34;)
= .T.
q.Where = le 
?q.SQLStatement
= &#34;SELECT firstname, lastname, city,  concatenate(firstname, &#39;, &#39;, lastname)  AS fullname FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;  ORDER BY lastname&#34;
&nbsp;
&#39;remove all columns from the sql
?q.Column.Count
= 4
&#39;execute the remove 4 times
q.Column.Remove(1)
q.Column.Remove(1)
q.Column.Remove(1)
q.Column.Remove(1)
?q.SQLStatement
= &#34;SELECT  FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;  ORDER BY lastname&#34;
&nbsp;
si.parse(&#34;firstname&#34;)
&#39;now add back 1 column
q.Column.Add(si)
?q.SQLStatement
= &#34;SELECT firstname FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;  ORDER BY lastname&#34;
&nbsp;
&#39;count the number of levels in the order by
?q.NestedOrderBy.Count
= 1
&nbsp;
&#39;remove the order by clause
q.NestedOrderBy.Reset()
?q.SQLStatement
= &#34;SELECT firstname FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;&#34;
&nbsp;
&#39;add in a new order by clause
Dim co as SQL::Query::ColumnOrder
?co.parse(&#34;city DESC&#34;)
= .T.
&nbsp;
q.NestedOrderBy.Add(co)
&nbsp;
?q.SQLStatement
= &#34;SELECT firstname FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;  ORDER BY city DESC&#34;
&nbsp;
&#39;now add in another order by clause
co.parse(&#34;lastname&#34;)
q.NestedOrderBy.add(co)
?q.SQLStatement
= &#34;SELECT firstname FROM customers  WHERE lastname = &#39;smith&#39;  AND  firstname = &#39;john&#39;  ORDER BY city DESC, lastname&#34;</pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+Dynamically+Construct+SQL+Statements">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common,review","status":"pending","notes":"code is here but little in way of explanation","keywords":"server,design,guide,sql"}--->
</body></html>