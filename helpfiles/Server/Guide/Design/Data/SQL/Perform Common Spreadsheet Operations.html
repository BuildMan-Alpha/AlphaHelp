	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
	
			<h1 class="showhide_heading" id="How_to_perform_common_spreadsheet_operations">
			Perform
			Common Spreadsheet Operations</h1>
<h3>Table of contents</h3>
<div class="helpserver_toc">
<ul>
	<ul>
	<li>
		<a href="#Basics" class='link'>Basics</a>
	<ul>
		<li>
			<a href="#Creating_and_Managing_Workbooks_and_Spreadsheets" class='link'>Creating and Managing Workbooks and Spreadsheets</a>
		</li>
		<li>
			<a href="#Understanding_spreadsheet_addressing_and_formulas" class='link'>Understanding spreadsheet addressing and formulas</a>
		</li>
		<li>
			<a href="#Getting_and_setting_values" class='link'>Getting and setting values</a>
		</li>
		<li>
			<a href="#Clear_all_or_part_of_a_spreadsheet" class='link'>Clear all or part of a spreadsheet</a>
		</li>
		<li>
			<a href="#Free_a_document_from_memory" class='link'>Free a document from memory</a>
		</li>
		<li>
			<a href="#Run_Excel_on_a_saved_document" class='link'>Run Excel on a saved document</a>
		</li>
		<li>
			<a href="#Database_operations" class='link'>Database operations</a>
		</li>
	</ul>
	</li>
	<li>
		<a href="#Intermediate_Tasks" class='link'>Intermediate Tasks</a>
	<ul>
		<li>
			<a href="#Add_a_formula_to_a_spreadsheet_cell" class='link'>Add a formula to a spreadsheet cell</a>
		</li>
		<li>
			<a href="#Working_with_Pictures" class='link'>Working with Pictures</a>
		</li>
		<li>
			<a href="#Working_with_sheets" class='link'>Working with sheets</a>
		</li>
		<li>
			<a href="#Formats_and_Fonts" class='link'>Formats and Fonts</a>
		</li>
	</ul>
	</li>
	<li>
		<a href="#Advanced_Topics" class='link'>Advanced Topics</a>
	<ul>
		<li>
			<a href="#Working_with_existing_spreadsheets" class='link'>Working with existing spreadsheets</a>
		</li>
		<li>
			<a href="#Working_with_ranges_and_groups" class='link'>Working with ranges and groups</a>
		</li>
		<li>
			<a href="#Insert_or_remove_rows_or_columns" class='link'>Insert or remove rows or columns</a>
		</li>
		<li>
			<a href="#Load_or_save_a_work_book_from_a_memory_image_blob_" class='link'>Load or save a work book from a memory image (blob)</a>
		</li>
		<li>
			<a href="#Adjust_printing_properties" class='link'>Adjust printing properties</a>
		</li>
	</ul>
	</li>
	<li>
		<a href="#See_Also" class='link'>See Also</a>
	</li>
</ul>
</ul></div><br />
<h2 class="showhide_heading" id="Basics">Basics</h2>
<h3 class="showhide_heading" id="Creating_and_Managing_Workbooks_and_Spreadsheets">Creating and Managing Workbooks and Spreadsheets</h3>
<ul><li>Create a new in-memory document (work book)
</li></ul><span style="color:blue; background:">dim Doc as Office::ExcelDocument</span> (for an Excel 2007 spreadsheet)<br />
<em>or</em><br />
<span style="color:blue; background:">dim Doc as Office::Excel2003Document</span> (for an Excel 2003 spreadsheet)<br />
<ul><li>Create a new spreadsheet
</li></ul><span style="color:blue; background:">dim Sheet as Office::Spreadsheet</span><br />
<ul><li>Attach a sheet to a document (work book)
</li></ul><span style="color:blue; background:">Sheet=Doc.AddSheet("My sheet name")</span><br />
<ul><li>Add a string to a spreadsheet cell
</li></ul><span style="color:blue; background:">dim row as N = 1<br />
dim column as N = 1<br />
dim message as C = "Hello, World!"<br />
<br />
Sheet.Write(row, column, message)</span><br />
<em>or</em><br />
<span style="color:blue; background:">Sheet.Write(row, column, message, Format)</span><br />
<h3 class="showhide_heading" id="Understanding_spreadsheet_addressing_and_formulas">Understanding spreadsheet addressing and formulas</h3>
The APIs in the Office class address cells by row and then column number. Excel and compatible sheets call the columns A, B, C, ... (up to 16,384 columns) and the rows 1, 2, 3, ... (up to 1,048,576 rows) and give the column before the row.<br />
<br />
When you are writing (row, column) in an API call, both row and column must be integer numbers. When you are writing a cell reference in a formula, use numbers for the row and letters for the column, e.g. B3 for column 2, row 3. Use '$' to indicate that a row or column in a reference is relative rather than absolute, e.g. $B$3 for the cell 2 columns to the right and 3 columns down.<br />
<br />
Formulas start with '=' and may include operators between cells and sheet designations followed by a '!'. So "=Sheet2!C6-Sheet3!E15" means to subtract the value of row 15 column 5 in Sheet3 from the value of row 6 column 3 in Sheet2.<br />
<h3 class="showhide_heading" id="Getting_and_setting_values">Getting and setting values</h3>
<ul><li>Add a number to a spreadsheet cell
</li></ul><span style="color:blue; background:">dim number as N = 3.1415926<br />
<br />
Sheet.Write(row, column, number)</span><br />
<em>or</em><br />
<span style="color:blue; background:">Sheet.Write(row, column, number, Format)</span><br />
<ul><li>Get cell type
</li></ul><span style="color:blue; background:">dim ct as Office::CellType = Sheet.CellType(row, column)</span><br />
<ul><li>Read cell format
</li></ul><span style="color:blue; background:">dim cf as Office::CellFormat = Sheet.CellFormat(row, column)</span><br />
<ul><li>Read cell contents
</li></ul>Note that Sheet.Read returns an A (Any) type variable<br />
<span style="color:blue; background:">if ct &lt;&gt; Office::CellType::Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;contents = Sheet.Read(row, column)<br />
end if</span><br />
<ul><li>Read cell contents and format
</li></ul><span style="color:blue; background:">if ct &lt;&gt; Office::CellType::Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;Contents = Sheet.Read(row, column, ct)<br />
end if</span><br />
<ul><li>Read cell comment
</li></ul><span style="color:blue; background:">dim comment as C<br />
comment = Sheet.ReadComment(row, column)</span><br />
<ul><li>Read cell formula
</li></ul><span style="color:blue; background:">dim formula as C<br />
if Sheet.IsFormula(row, column)<br />
&nbsp;&nbsp;&nbsp;&nbsp;formula = Sheet.ReadFormula(row, column)<br />
end if</span><br />
<ul><li>Check cell for specific attributes
</li></ul><span style="color:blue; background:">dim answer as L<br />
answer = Sheet.IsBlank(row, column)<br />
answer = Sheet.IsBlank(row, column, cf)<br />
answer = Sheet.IsFormula(row, column)<br />
answer = Sheet.CellIsDateValue(row, column)</span><br />
<ul><li>Copy a cell
</li></ul><span style="color:blue; background:">Sheet.CopyCell(sourceRow, sourceColumn, destinationRow, destinationColumn)</span><br />
<ul><li>Blank a cell without changing the format
</li></ul><span style="color:blue; background:">Sheet.SetBlank(row, column)</span><br />
<ul><li>Blank a cell and change the format
</li></ul><span style="color:blue; background:">Sheet.SetBlank(row, column, cf)</span><br />
<h3 class="showhide_heading" id="Clear_all_or_part_of_a_spreadsheet">Clear all or part of a spreadsheet</h3>
<span style="color:blue; background:">Sheet.Clear()</span><br />
<span style="color:blue; background:">Sheet.Clear(FirstRow, FirstColumn, LastRow, LastColumn)</span><br />
<ul><li>Save a document (work book)
</li></ul><span style="color:blue; background:">Doc.Save(filename)</span><br />
<ul><li>Reinitialize an in-memory document (work book)
</li></ul><span style="color:blue; background:">Doc.Clear()</span><br />
<h3 class="showhide_heading" id="Free_a_document_from_memory">Free a document from memory</h3>
<span style="color:blue; background:">delete Doc</span><br />
<h3 class="showhide_heading" id="Run_Excel_on_a_saved_document">Run Excel on a saved document</h3>
<span style="color:blue; background:">sys_open(filename)</span><br />
<h3 class="showhide_heading" id="Database_operations">Database operations</h3>
<ul><li>Create a spreadsheet from a DBF
</li></ul><span style="color:blue; background:">on error goto noload<br />
myTable = table.open(Path + TableName + ".DBF")<br />
Sheet = Doc.AddSheetFromDBF(myTable, TableName)<br />
'more processing of sheet...<br />
'...<br />
noload:<br />
' continue...</span><br />
<ul><li>Create a spreadsheet from a SQL Query
</li></ul><span style="color:blue; background:">dim cn as sql::connection<br />
if cn.Open(ConnectionString)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if cn.Execute(Query)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheet = Doc.AddSheetFromResultSet(cn.ResultSet, mySheetName)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'More processing...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'...<br />
&nbsp;&nbsp;&nbsp;&nbsp;end if<br />
end if</span><br />
<h2 class="showhide_heading" id="Intermediate_Tasks">Intermediate Tasks</h2>
<h3 class="showhide_heading" id="Add_a_formula_to_a_spreadsheet_cell">Add a formula to a spreadsheet cell</h3>
<span style="color:blue; background:">dim formula as C = "=B2+C3"<br />
<br />
Sheet.WriteFormula(row, column, formula)</span><br />
<em>or</em><br />
<span style="color:blue; background:">Sheet.WriteFormula(row, column, formula, Format)</span><br />
<h3 class="showhide_heading" id="Working_with_Pictures">Working with Pictures</h3>
<ul><li>Add a picture to a spreadsheet cell
</li></ul><span style="color:blue; background:">dim picfile as C = "Daffodils.jpg"<br />
dim picBlob as B<br />
dim Id as N<br />
<br />
Id = Doc.AddPicture(picfile)</span><br />
<em>or</em><br />
<span style="color:blue; background:">picBlob = File.To_Blob(picfile)<br />
Id = Doc.AddPicture(picBlob)</span><br />
<br />
<em>then</em><br />
<br />
<span style="color:blue; background:">Sheet = Doc.AddSheet("Picture")<br />
Sheet.SetPicture(row, column,Id)</span><br />
<h3 class="showhide_heading" id="Working_with_sheets">Working with sheets</h3>
<ul><li>Copy a sheet
</li></ul><span style="color:blue; background:">Doc.CopySheet(newSheetName, oldSheetIndex)</span><br />
<ul><li>Delete a sheet
</li></ul><span style="color:blue; background:">Doc.DeleteSheet(Index)</span><br />
<ul><li>Count sheets in a workbook
</li></ul><span style="color:blue; background:">nSheets = Doc.SheetCount</span><br />
<ul><li>Get a spreadsheet by name
</li></ul><span style="color:blue; background:">Doc.FindSheet(Sheet,sheetName)</span><br />
<ul><li>Get a spreadsheet at an index number
</li></ul><span style="color:blue; background:">Sheet = Doc.GetSheet(Index)</span><br />
<ul><li>Split a sheet
</li></ul><span style="color:blue; background:">Sheet.Split(row, column)</span><br />
<h3 class="showhide_heading" id="Formats_and_Fonts">Formats and Fonts</h3>
<ul><li>Basics
</li></ul><span style="color:blue; background:">dim Format	as Office::Format<br />
dim Font	as Office::Font<br />
Format = Doc.AddFormat()<br />
Font = Doc.AddFont()<br />
Font.Color = Office::Color::DarkBlue<br />
Font.Name = "Tahoma"<br />
Font.Size = 14<br />
Font.Bold = .t.<br />
Format.Font = Font<br />
Format.HorizontalAlignment = Office::HorizontalAlignment::Center</span><br />
<ul><li>Count Fonts
</li></ul><span style="color:blue; background:">nFonts = Doc.FontCount</span><br />
<ul><li>Get a Font
</li></ul><span style="color:blue; background:">font1=doc.GetFont(Index)</span><br />
<ul><li>Count Formats
</li></ul><span style="color:blue; background:">nFonts = Doc.FormatCount</span><br />
<ul><li>Get a Format
</li></ul><span style="color:blue; background:">format1=doc.GetFormat(Index)</span><br />
<ul><li>Apply a Format to a spreadsheet cell or region
</li></ul><span style="color:blue; background:">Sheet.SetFormat(row, column, format)<br />
Sheet.SetFormat(startRow, startColumn, endRow, endColumn, format)</span><br />
<ul><li>Get/set the height/width of a row/column
</li></ul><span style="color:blue; background:">Width = Sheet.ColumnWidth(column)<br />
Height = Sheet.RowHeight(row)<br />
Sheet.SetColumn(FirstColumn, LastColumn, Width [, Format [, Hidden]])
Sheet.SetColumn(row, Height [, Format [, Hidden]])</span><br />
<ul><li>Add an entry in the next available row of a sheet
</li></ul><span style="color:blue; background:">nextRow = Sheet.NextAvailableRow<br />
Sheet.Write(nextRow, 1, "More text")</span><br />
<h2 class="showhide_heading" id="Advanced_Topics">Advanced Topics</h2>
<h3 class="showhide_heading" id="Working_with_existing_spreadsheets">Working with existing spreadsheets</h3>
<ul><li>Load the contents of an existing Excel file
</li></ul><span style="color:blue; background:">dim filename as C = "myworkbook.xlsx"<br />
dim result as L = Doc.Load(filename)</span><br />
<ul><li>Open a spreadsheet file, select a sheet, write to a location, and save
</li></ul><span style="color:blue; background:">dim filename as C = "myworkbook.xlsx"<br />
if Doc.Load(filename)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if Doc.FindSheet(Sheet,sheetName)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sheet.Write(row, column, contents)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Doc.Save(filename)<br />
&nbsp;&nbsp;&nbsp;&nbsp;end if<br />
end if</span><br />
<h3 class="showhide_heading" id="Working_with_ranges_and_groups">Working with ranges and groups</h3>
<ul><li>Merge a cell range (erasing the cell boundary lines)
</li></ul><span style="color:blue; background:">Sheet.SetMerge(FirstRow, LastRow, FirstColumn, LastColumn)</span><br />
<ul><li>Get merged cell range to which a cell belongs
</li></ul><span style="color:blue; background:">Sheet.GetMerge(row, column, FirstRow, LastRow, FirstColumn, LastColumn)</span><br />
<ul><li>Delete (unmerge) a merged cell range
</li></ul><span style="color:blue; background:">Sheet.DeleteMerge(row, column)</span><br />
<ul><li>Group rows and collapse the group
</li></ul><span style="color:blue; background:">Sheet.GroupRows(FirstRow, LastRow, .T.)</span><br />
<ul><li>Group columns and collapse the group
</li></ul><span style="color:blue; background:">Sheet.GroupColumns(FirstColumn, LastColumn, .T.)</span><br />
<h3 class="showhide_heading" id="Insert_or_remove_rows_or_columns">Insert or remove rows or columns</h3>
<span style="color:blue; background:">Sheet.InsertRow(FirstRow, LastRow)<br />
Sheet.InsertColumn(FirstColum, LastColum)<br />
Sheet.RemoveRow(FirstRow, LastRow)<br />
Sheet.RemoveColumn(FirstColum, LastColum)</span><br />
<h3 class="showhide_heading" id="Load_or_save_a_work_book_from_a_memory_image_blob_">Load or save a work book from a memory image (blob)</h3>
<span style="color:blue; background:">dim Data as B<br />
Doc.SaveToBlob(Data)<br />
Doc.LoadFromBlob(Data)</span><br />
<h3 class="showhide_heading" id="Adjust_printing_properties">Adjust printing properties</h3>
<ul><li>Adjust spreadsheet margins
</li></ul><span style="color:blue; background:">Sheet.HeaderMargin = 10<br />
Sheet.FooterMargin = 10<br />
Sheet.MarginLeft = 10<br />
Sheet.MarginRight = 10<br />
Sheet.MarginTop = 10<br />
Sheet.MarginBottom = 10</span><br />
<ul><li>Set spreadsheet orientation and centering
</li></ul><span style="color:blue; background:">Sheet.Landscape = .T.<br />
Sheet.CenterHorizontally = .T.<br />
Sheet.CenterVertically = .F.</span><br />
<ul><li>Set paper size
</li></ul><span style="color:blue; background:">Sheet.Paper = Office::Paper::Legal</span><br />
<ul><li>Create page break at a row
</li></ul><span style="color:blue; background:">Sheet.SetHorizontalPageBreak(row, .T.)</span><br />
<ul><li>Remove page break at a row
</li></ul><span style="color:blue; background:">Sheet.SetHorizontalPageBreak(row, .F.)</span><br />
<ul><li>Create page break at a column
</li></ul><span style="color:blue; background:">Sheet.SetVerticalPageBreak(column, .T.)</span><br />
<ul><li>Remove page break at a column
</li></ul><span style="color:blue; background:">Sheet.SetVerticalPageBreak(column, .F.)</span><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="/Api/Namespace/Office/Generate Excel Spreadsheets Programmatically.html" title="Generate Excel Spreadsheets Programmatically V11" class="wiki">Generate Excel Spreadsheets Programmatically </a><br />
<a href="/Api/Namespace/Office/Office__NAMESPACE__ExcelDocument.html" title="Office::ExcelDocument" class="wiki">Office::ExcelDocument</a><br />
<a href="/Api/Namespace/Office/Office__NAMESPACE__Excel2003Document.html" title="Office::Excel2003Document" class="wiki">Office::Excel2003Document</a><br />
<a href="/Api/Namespace/Office/Office__NAMESPACE__Spreadsheet.html" title="Office::Spreadsheet" class="wiki">Office::SpreadSheet</a><br />
<a href="/Api/Namespace/Office/Office__NAMESPACE__Format.html" title="Office::Format" class="wiki">Office::Format</a><br />
<a href="/Api/Namespace/Office/Office__NAMESPACE__Font.html" title="Office::Font" class="wiki">Office::Font</a><br />
<a href="/Api/Namespace/Office/Office Enumerations.html" title="Office Enumerations" class="wiki">Office Enumerations</a><br />
<a href="/Api/Namespace/Office/Office Example__COLON__ Hello, World spreadsheet.xml" title="Office Example: Hello, World spreadsheet" class="wiki">Office Example: Hello, World Spreadsheet</a><br />
<a href="/Api/Namespace/Office/Office Example__COLON__ Simple Weekly sales spreadsheet.xml" title="Office Example: Simple Weekly sales spreadsheet" class="wiki">Office Example: Simple Weekly sales spreadsheet</a><br />
<a href="/Api/Namespace/Office/Office Example__COLON__ Multiple spreadsheets.xml" title="Office Example: Multiple spreadsheets" class="wiki">Office Example: Multiple Spreadsheets</a><br />
<a href="Office Example__COLON__ Spreadsheet from SQL query.html" title="Office Example: Spreadsheet from SQL query" class="wiki">Office Example: Spreadsheet from SQL query</a><br />
<a href="/Desktop/Guide/Design/Data/DBF/Office Example__COLON__ Spreadsheet from DBF tables.html" title="Office Example: Spreadsheet from DBF tables" class="wiki">Office Example: Spreadsheet from DBF tables</a><br />
<a href="/Api/Namespace/Office/Office Example__COLON__ Spreadsheet with picture.xml" title="Office Example: Spreadsheet with picture" class="wiki">Office Example: Spreadsheet with picture</a><br />
<a href="/Api/Namespace/Office/Office Example__COLON__ Update a spreadsheet.xml" title="Office Example: Update a spreadsheet" class="wiki">Office Example: Update a spreadsheet</a><br />
<a href="../Schema/SQL Example__COLON__ Spreadsheets from SQL schema.html" title="SQL Example: Spreadsheets from SQL schema" class="wiki">SQL Example: Spreadsheets from SQL schema</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+perform+common+spreadsheet+operations">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending","keywords":"guide,sql,dbf,spreadsheet"}--->
</body></html>