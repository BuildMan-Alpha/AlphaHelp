	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2 class="showhide_heading" id="SQL_Example:_Spreadsheets_from_SQL_schema">SQL Example: Spreadsheets from SQL schema</h2>
This example creates a multiple spreadsheets from the tables in a SQL::Schema. After the spreadsheet is populated, it is opened in Microsoft Excel.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >dim DocumentFile as C = &#34;C:\temp\A5OfficeSample6.xls&#34;
dim ConnectionString as C = &#34;{A5API=Access,FileName=&#39;&#34; + a5.get_exe_path() \
                          + &#34;\MDBFiles\Northwind.mdb&#39;,UserName=&#39;Admin&#39;}&#34;
dim Schema	as SQL::Schema
dim Connection 	as SQL::Connection
&nbsp;
&#39;We can manipulate the schema any way we need to prior to saving
&#39;Here we are changing the type of the data column for the 
&#39; Category Picture Column and the Employee Photo Column to
&#39; OLEObject (Access doesn&#39;t tell us, but we know...)
&#39;ToExcel automatically checks to see if an OLEObject is a 
&#39; bitmap and converts it if it is. If you have binary objects
&#39; that are actually JPG, PNG, DIB, or BMP data, set the value
&#39; accordingly.
if Connection.Open(ConnectionString)
	if Connection.GetSchema(Schema) 
	  SetColumnToOLEObject(Schema, &#34;Categories&#34;, &#34;Picture&#34;)
	  SetColumnToOLEObject(Schema, &#34;Employees&#34;, &#34;Photo&#34;)
	  if .not. Schema.ToExcel(DocumentFile,Connection)
		ui_msg_box(&#34;Error Saving Schema Tables&#34;, \
                   &#34;Error:&#34; + crlf(2) + Schema.callresult.text)	
	  else
		sys_open(DocumentFile)
	  end if
	else
	  ui_msg_box(&#34;Error Loading Database Schema&#34;, \
                     &#34;Error:&#34; + crlf(2) \
                    + Connection.callresult.text)	
	end if
else
	ui_msg_box(&#34;Error:&#34;, \
                   &#34;Error Connecting To Database&#34; \
             + ConnectionString + crlf(2) + &#34;Error:&#34; \
             + crlf(2) + Connection.callresult.text)	
end if
&nbsp;
FUNCTION SetColumnToOLEObject as L (Schema as SQL::Schema, \
                                    Table as C, Column as C)
dim Dummy as SQL::IntermediateType 
&nbsp;
dim TableIndex as N = Schema.TableNumber(Table)
if (TableIndex &amp;gt; 0)
  dim TableInfo as SQL::TableInfo = Schema.Table(TableIndex)
  dim ColumnIndex as N = TableInfo.ColumnNumber(Column)
  if (ColumnIndex &amp;gt; 0)
    TableInfo.Column(ColumnIndex).IntermediateType = OLEObject
    SetColumnToOLEObject = .t.
  end if
end if
END FUNCTION</pre></div><br />
<h2 class="showhide_heading" id="See_Also">See Also</h2>
<a href="../../../../Reference/Design/Api/Office/Generate Excel Spreadsheets Programmatically.html" title="Generate Excel Spreadsheets Programmatically V11" class="wiki">Generate Excel Spreadsheets Programmatically </a><br />
<a href="../SQL/Office Example__COLON__ Spreadsheet from SQL query.html" title="Office Example: Spreadsheet from SQL query" class="wiki">Office Example: Spreadsheet from SQL query</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL+Example%3A+Spreadsheets+from+SQL+schema">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","tags":"common, review","notes":"example could use context","keywords":"schema,sql"}--->
</body></html>