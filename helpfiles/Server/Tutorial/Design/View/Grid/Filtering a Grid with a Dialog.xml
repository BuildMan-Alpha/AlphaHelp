<page>
	<topic>Filtering a Grid with a Dialog</topic>
	<sections>
<section>
	<description>One of the most common tasks a web application can perform is to collect the values of one or more variables, then use this data to display a filtered view of a table.
</description>
	
	
</section>		
		<section>
<title>Creating a Grid Component for the Alpha Anywhere Customer Table
</title>			
			<steps>
				<step>
					<description>Create a grid component based on the AlphaSports Customer table.
</description>		
				</step>
				
				<step>
					<description>Display the Grid > Query (DBF) page:
</description>		<cases>
	<case>
		<description>Click the 'up down' icon next to the Order field to display the Order Builder.
</description>
<figure><link>images/Order_button.gif</link></figure>
	</case>
	<case>
		<description>Click the 'down' icon to select "Lastname" in the Sort by list.
</description>
	</case>
	<case>
		<description>Click the 'down' icon to select "Firstname" in the then, sort by list.
</description>
	</case>
	<case>
		<description>Click OK to continue.
</description>
	</case>
</cases>
				</step>
				
				<step>
					<description>Display the Grid > Fields menu.
</description>		<cases>
	<case>
		<description>Select several fields, including the Bill_state_region field.
</description>
	</case>
	<case>
		<description>Fix the Column Properties > Column headings to make them attractive.
</description>
	</case>
</cases>
				</step>
				<step>
					<description>Click File > Save as and name the grid component "Customers".
</description>		
				</step>
				
				<step>
					<description>Close the Grid Component Builder.
</description>		
				</step>
				
				<step>
					<description>Create a new A5W page.
</description>		
				</step>
				
				<step>
					<description>Click File > Save as and name it "Customers".
</description>		
				</step>
				
				<step>
					<description>Click Insert Component to display the Insert Component dialog.
</description>		
				</step>
				
				<step>
					<description>Click Select, pick the "Customers" component, and click OK.
</description>		
				</step>
				
				<step>
					<description>Add a title and center the page elements.
</description>		
				</step>
				
				<step>
					<description>Save the page as  "Customers" and exit from the HTML Editor.
</description>		
				</step>
				
				<step>
					<description>Click the 'lightning' icon and the result should look something like this: 
</description>		
<figure><link>images/WPT_Customers_Page.gif</link></figure>
				</step>
				
			</steps>
			
		</section>
		<section>
			<title>Setting a Variable in a Dialog Component</title>
			<description>The next step is to create a dialog component with a drop down list box control. The control is populated with a list of the unique state values (from the Bill_state_region field) found in the Customer table.</description>
		<steps>
			<step>
				<description>Create a dialog component with a drop down list control.
</description>
			</step>
			<step>
				<description>Display the Form > Controls menu.
</description>
			</step>
			<step>
				<description>Set Control Settings > Name to "States"
</description>
			</step>
			<step>
				<description>Leave the Control Settings > Scope as "Local".
</description>
			</step>
			<step>
				<description>Click the '...' in the DropDownBox Properties > Choices field.
</description><cases>
	<case>
		<description>Define Choices > List Type = "Dynamic"
</description>
	</case>
	<case>
		<description>Define Choices > Maximum Choices = 0.
</description>
	</case>
	<case>
		<description>In the Data Source > Table name field select "customer".
</description>
	</case>
	<case>
		<description>In the Data Source > Table name field enter "Bill_state_region".
</description>
	</case>
	<case>
		<description>Click OK to continue.
</description>
	</case>
	
</cases>
			</step>
			<step>
				<description>Set DropDownBox Properties > Height to 6.
</description>
			</step>
			<step>
				<description>Display the Form > Properties menu.
</description>
			</step>
			<step>
				<description>Click '...' to set Server Events > AfterValidate to the following expression.
</description>
<example><![CDATA[CurrentForm.redirectTarget="Customers.a5w?customers_Filter=Bill_state_region=" + quote(states) ]]></example>
			</step>
			<step>
				<description>Click File > Save as and save the dialog component as "States".
</description>
			</step>
			<step>
				<description>Create a new A5W page.
</description>
			</step>
			<step>
				<description>Click File > Save as and save the page as "States".
</description>
			</step>
			<step>
				<description>Click Insert Component to display the Insert Component dialog.
</description>
			</step>
			<step>
				<description>Click Select, pick the "States" component, and click OK.
</description>
			</step>
			<step>
				<description>Save the new page and exit from the HTML Editor. 
</description>

			</step>
			
		</steps>	
		</section>
<section>
	<section>
	<title>Creating a Grid Component for the Microsoft Access Customer Table
</title>	
<steps>
	<step>
		<description>Create a grid component based on the AlphaSports.MDB database and the Customer table.
</description>
	</step>
	<step>
		<description>On the Grid > Query (ADO) menu:
</description>
<cases>
	<case>
		<description>Click '...' next to the Order field to display the Specify Order dialog.
</description>
	</case>
	<case>
		<description>Select "Lastname" and click '>' to add it to the Order expression.
</description>
	</case>
	<case>
		<description>Click Comma.</description>
	</case>
	<case>
		<description>Select "Firstname" and click '>' to add it to the Order expression.
</description>
	</case>
	<case>
		<description>Click OK to continue.
</description>
	</case>
	
</cases>
	</step>
	<step>
		<description>Display the Grid > Fields menu.
</description>
<cases>
	<case>
		<description>Select several fields, including the Bill_state_region field.
</description>
	</case>
	<case>
		<description>Fix the Column Properties > Column headings to make them attractive.
</description>
	</case>
</cases>
	</step>
	<step>
		<description>Click File > Save as and name the grid component "Customers".
</description>
	</step>
	<step>
		<description>Close the Grid Component Builder.
</description>
	</step>
	<step>
		<description>Create a new A5W page.
</description>
	</step>
	<step>
		<description>Click File > Save as and name it "Customers".
</description>
	</step>
	<step>
		<description>Close the Grid Component Builder.
</description>
	</step>
	<step>
		<description>Create a new A5W page.
</description>
	</step>
	<step>
		<description>Click File > Save as and name it "Customers".
</description>
	</step>
	<step>
		<description>Click Insert Component to display the Insert Component dialog.
</description>
	</step>
	<step>
		<description>Click Select, pick the "Customers" component, and click OK.
</description>
	</step>
	<step>
		<description>Add a title and center the page elements.
</description>
	</step>
	<step>
		<description>Save the page and exit from the HTML Editor.
</description>
	</step>
	<step>
		<description>Click the 'lightning' icon and the result should look something like this: 
</description>
<figure><link>images/WPT_Customers_Page.gif</link></figure>
	</step>
	
	
</steps>
		
		
		
	</section>
	<section>
<title>Setting a Variable in a Dialog Component</title>		
<description>The next step is to create a dialog component with a drop down list box control. The control is populated with a list of the unique state values (from the Bill_state_region field) found in the Customer table.</description>		
		<steps>
<step>
	<description>Create a dialog component with a drop down list control.
</description>
</step>		
<step>
	<description>Display the Form > Controls menu.
</description>
</step>		
<step>
	<description>Set Control Settings > Name to "States"
</description>
</step>	
<step>
	<description>Leave the Control Settings > Scope as "Local".
</description>
</step>	
<step>
	<description>Click the '...' icon in the DropDownBox Properties > Choices field.
</description>
<cases>
	<case>
		<description>1. Define Choices > List Type = "Dynamic"
</description>
	</case>
	<case>
		<description>2. Define Choices > Maximum Choices = 0.
</description>
	</case>
	<case>
		<description>3. In the Data Source > Access filename field select "alphasports.mdb".
</description>
	</case>
	<case>
		<description>4. In the Data Source > SQL SELECT statement field click '....
</description>
	</case>
	<case>
		<description>5. In the Table list select "Customer".
</description>
	</case>
	<case>
		<description>6. In the Field to display list select "Bill_state_region".
</description>
	</case>
	<case>
		<description>7. Click OK > OK to continue.
</description>
	</case>
	
</cases>
</step>	
<step>
	<description>Set DropDownBox Properties > Height to 6.
</description>
</step>	
<step>
	<description>Display the Form > Properties menu.
</description>
</step>	
<step>
	<description>Click '...' to set Server Events > AfterValidate to the following expression.
</description>
<example><![CDATA[CurrentForm.redirectTarget="Customers.a5w?customers_Filter=Bill_state_region='" + states + "'"
]]></example>
</step>	
<step>
	<description>Click File > Save as and save the dialog component as "States".
</description>
</step>	
<step>
	<description>Create a new A5W page.
</description>
</step>	
<step>
	<description>Click File > Save as and save the page as "States".
</description>
</step>	
<step>
	<description>Click Insert Component to display the Insert Component dialog.
</description>
</step>	
<step>
	<description>Click Select, pick the "States" component, and click OK.
</description>
</step>	
<step>
	<description>Save the new page and exit from the HTML Editor.
</description>
</step>	
			
			
		</steps>
		
	</section>
	
<section>
	<title>Creating a Grid Component for the AlphaSports.mdb Customer Table
</title>
	<steps>
		<step>
			<description>Create a grid component based on the AlphaSports database and the Customer table.
</description>
		</step>
		<step>
			<description>On the Grid > Query (AlphaDAO) menu:
</description>
<cases>
	<case>
		<description>Click '...' next to the Order field to display the Specify Order dialog.</description>
	</case>
	<case>
		<description>Select "Lastname" and click the '>' icon to add it to the Order expression.
</description>
	</case>
	<case>
		<description>Click Comma.
</description>
	</case>
	<case>
		<description>Select "Firstname" and click the '>' icon to add it to the Order expression.
</description>
	</case>
	<case>
		<description>Click OK to continue.
</description>
	</case>
	
</cases>
		</step>
		<step>
			<description>Display the Grid > Fields menu.</description>
			<cases>
				<case>
					<description>Select several fields, including the Bill_state_region field.
</description>
				</case>
				<case>
					<description>Fix the Column Properties > Column headings to make them attractive.
</description>
				</case>
			</cases>
		</step>
		<step>
			<description>Click File > Save as and name the grid component "Customers".
</description>
		</step>
		<step>
			<description>Close the Grid Component Builder.
</description>
		</step>
		<step>
			<description>Create a new A5W page.
</description>
		</step>
		<step>
			<description>Click File > Save as and name it "Customers".
</description>
		</step>
		<step>
			<description>Click Insert Component to display the Insert Component dialog.
</description>
		</step>
		<step>
			<description>Click Select, pick the "Customers" component, and click OK.
</description>
		</step>
		<step>
			<description>Add a title and center the page elements.
</description>
		</step>
		<step>
			<description>Save the page as  "Customers" and exit from the HTML Editor.
</description>
		</step>
		<step>
			<description>Click the 'lightning' icon and the result should look something like this: 
</description>
<figure><link>images/WPT_Customers_Page.gif</link></figure>
		</step>
		
		
	</steps>
	
	
</section>	
	
	<section>
		<title>Setting a Variable in a Dialog Component</title>
		<description>The next step is to create a dialog component with a drop down list box control. The control is populated with a list of the unique state values (from the Bill_state_region field) found in the Customer table.
</description>
		<steps>
			<step>
				<description>Create a dialog component with a drop down list control.
</description>
			</step>
				<step>
				<description>Display the Form > Controls menu.
</description>
			</step>
				<step>
				<description>Set Control Settings > Name to "States"
</description>
			</step>
				<step>
				<description>Leave the Control Settings > Scope as "Local".
</description>
			</step>
				<step>
				<description>Click '...' in the DropDownBox Properties > Choices field.
</description><cases>
	<case>
		<description>Define Choices > List Type = "Dynamic"
</description>
	</case>
	<case>
		<description>Define Choices > Maximum Choices = 0.
</description>
	</case>
	<case>
		<description>Check the Data Source > Use saved connection string field.
</description>
	</case>
	<case>
		<description>In the Data Source > AlphaDAO Connection string name field select "Demo Connection".
</description>
	</case>
	<case>
		<description>In the Data Source > AlphaDAO SQL SELECT statement field Click '...'.
</description>
	</case>
	<case>
		<description>Select "customer (Table)" in the Table list.
</description>
	</case>
	<case>
		<description>Select "bill_state_region" in the Field to display list.
</description>
	</case>
	<case>
		<description>Click OK > OK to continue.
</description>
	</case>
	
</cases>
			</step>
				<step>
				<description>Set DropDownBox Properties > Height to 6.
</description>
			</step>
				<step>
				<description>Display the Form > Properties menu.
</description>
			</step>
				<step>
				<description>Click '...' to set Server Events > After Validate to the following expression.
</description>
<example><![CDATA[CurrentForm.redirectTarget="Customers.a5w?customers_Filter=Bill_state_region='" + states + "'"
]]></example>
			</step>
				<step>
				<description>Click File > Save as and save the dialog component as "States".
</description>
			</step>
				<step>
				<description>Create a new A5W page.
</description>
			</step>
				<step>
				<description>Click File > Save as and save the page as "States".
</description>
			</step>
				<step>
				<description>Click Insert Component to display the Insert Component dialog.
</description>
			</step>
				<step>
				<description>Click Select, pick the "States" component, and click OK.
</description>
			</step>
				<step>
				<description>Save the new page and exit from the HTML Editor.
</description>
			</step>
			
			
		</steps>
	</section>
	<section>
<title>Understanding the Dialog After Validate Event</title>		
		<description>Previously we set the After Validate of the dialog component to the following expression.
</description>
		<example>CurrentForm.redirectTarget="Customers.a5w?customers_Filter=Bill_state_region=" + quote(states)
</example>
	</section>
	<section>
		<description>The CurrentForm.redirectTarget command tells the Application Server to next display a different page. The page to display is Customers.a5w. The command uses the A5W Page Filter Syntax to specify that the Customers page must apply the filter Bill_state_region=states, where Bill_state_region is a field in the Customer table and states is the name of the drop down list box control and variable of the dialog box. So, if you selected "DC" in the drop down list box control, and clicked Submit, the expression would be:
</description>
		<example>CurrentForm.redirectTarget=Customers.a5w?customers_Filter=Bill_state_region="DC"
</example>
		
	</section>
	<section>
		<steps>
			<step>
				<description>Select the "Customers.a5w" page in the Web Projects Control Panel, right click, and select Publish (Local Webroot) and open.
</description>
			</step>
			<step>
				<description>Select the "States.a5w" page in the Web Projects Control Panel, right click, and select Publish (Local Webroot) and open.
</description>
			</step>
			<step>
				<description>Select a state from the list box and click Submit. If you selected "ME", you should see this: 
</description>
<figure><link>images/WPT_Filtered_Customer_Page.gif</link></figure>
			</step>
			
		</steps>
		
	</section>
	
</section>		
		
		
	</sections>
	
</page>