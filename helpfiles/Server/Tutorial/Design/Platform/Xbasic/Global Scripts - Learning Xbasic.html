	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Global Scripts - Learning Xbasic</p>



<p>At the beginning of the book, you saw the script <span class=Code1>Choose
 Msg Receiver</span> which is part of the Phone Messages database. <span
 class=Code1>Choose Msg Receiver</span> is used when you take a message
 using the <span class=Screen>Its For You</span> application.&nbsp;The
 script is invoked when you press the <span class=Button>For button</span>
 on the <span class=Screen>Take A Message</span> screen.&nbsp;The script
 pops-up a dialog box&nbsp;as&nbsp;shown below: </p>



<p class=Pix><img src="images/LB_Figure_77.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 280px;
							height: 335px;
							float: none;
							border-style: none;
							border-style: none;"
					width=280
					height=335
					border=0></p>



<p class=PixCaption>Figure 77</p>



<p>This script is not a function nor is it attached to an object event.
 Most of the scripts you have analyzed up until now have been one of these
 two types.&nbsp; <span class=Code1>Choose Msg Receiver</span> is a Global
 Script.&nbsp;It was created in the <span class=Screen>Code Editor</span>
 by using the N <span class=Button>ew > Script using Xbasic editor</span>
 command.&nbsp;Like a global function, it is accessible (callable) from
 any other script in the active database.</p>



<p>Unlike a function, a script does not take input parameters, nor does
 it return a result.&nbsp;But&nbsp;as&nbsp;you saw in the section on variable
 scoping, data can be passed to a script via shared and global variables.</p>



<p>Generally, you would create a global script when you want to create
 an Xbasic program that you can invoke in different places of your application
 or even share among applications.&nbsp;Even if you change the script slightly
 to accommodate different needs, it is convenient to keep the script&nbsp;as&nbsp;a
 separate entity (rather than attached to a specific event).</p>



<p>The <span class=Code1>Choose Msg Receiver</span> script is invoked from
 the <span class=Code1>OnPush</span> event of the <span class=Code1>For</span>
 button with this Xbasic command.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>script_play_local("Choose Msg Receiver")&nbsp;</td></tr>
</table>

<p class=BlankLine>&nbsp;</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>The <span class=Code1>script_play</span> command loads
 and runs the Xbasic commands contained in the named script. The <span
 class=Code1>script_play_local</span> command makes any local variables
 in the calling script available to the called script. See <a href="Variable Scoping.html" title="Variable Scoping" class="wiki">Variable  Scoping</a> in this book for more information.</td></tr>
</table>

<p>The <span class=Code1>Choose Msg Receiver</span> script displays a list
 of message recipients from the <span class=Code1>message_tr</span> table.
 When a recipient has been selected, fields in the <span class=Screen>Take
 Message</span> form are updated to reflect the name and id of the recipient.</p>



<p>The script performs the following actions:</p>



<ul style="list-style: disc;"
	type=disc>

	<li class=kadov-p-CBullet1><p class=Bullet1>It declares a number of
 variables used in the script.</p>

</li>

	<li class=kadov-p-CBullet1><p class=Bullet1>It checks the number of
 entries in the <span class=Code1>message_tr</span> table and defines and
 initializes array variables to hold data from the table.</p>

</li>

	<li class=kadov-p-CBullet1><p class=Bullet1>An Xdialog command opens
 the pop-up Xdialog box and displays the choices from the array variables.</p>

</li>

	<li class=kadov-p-CBullet1><p class=Bullet1>After a selection is made
 in the Xdialog box, some fields on the Take Message form are updated.</p>

</li>
</ul>

<p>The complete script along with an analysis of how it works follows.</p>



<p>Various variables used in the script are declared using dim commands.
 These variables are all local to this script and are discarded when the
 script is finished running.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim rc&nbsp;as&nbsp;N</p>


<p class=Code>dim selection&nbsp;as&nbsp;C</p>


<p class=Code>dim i&nbsp;as&nbsp;N</p>


<p class=Code>dim indx&nbsp;as&nbsp;N</td></tr>
</table>

<p>A count of the number of records in the <span class=Code1>message_tr</span>
 table is stored in the <span class=Code1>rc</span> variable.&nbsp;This
 count is necessary so that the next two array variables, names and <span
 class=Code1>nameslist</span> can be declared big enough to accommodate
 all the records in <span class=Code1>message_tr</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>rc = reccount("message_tr")</td></tr>
</table>

<p><span class=Code1>names</span> is an array variable of type pointer.
 <span class=Code1>nameslist</span> is an variable array of type character.
 <span class=Code1>names</span> will be populated with all the field information
 for each record of <span class=Code1>message_tr</span>.&nbsp; <span class=Code1>nameslist</span>
 will then be populated from the data stored in names.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim names<a class="wiki"  href="rc" rel="">rc</a>&nbsp;as&nbsp;P</p>


<p class=Code>dim nameslist<a class="wiki"  href="rc" rel="">rc</a>&nbsp;as&nbsp;C</td></tr>
</table>

<p class=BlankLine>&nbsp;</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft><span class=Bolded>Variable arrays</span> are multidimensional
 and accessed via their index.&nbsp;So a variable declared&nbsp;as&nbsp;
 <span class=Code1>dim myvariable<a class="wiki"  href="3" rel="">3</a>&nbsp;as&nbsp;C</span> is declaring
 <span class=Code1>myvariable</span> to be an array variable holding up
 to three possible values (sort of three similar variables accessed with
 the same name).&nbsp;Each value is assigned and accessed using the appropriate
 index value.&nbsp;Different array variable values are called elements
 of the array. </p>


<p class=Code>myvariable<a class="wiki"  href="1" rel="">1</a> = The&nbsp;&nbsp;&nbsp;myvariable<a class="wiki"  href="2" rel="">2</a> = Big&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myvariable<a class="wiki"  href="3" rel="">3</a>
 =&nbsp;Chill</p>


<p class=Code>? myvariable<a class="wiki"  href="2" rel="">2</a></p>


<p class=Code>=&nbsp;big</p>


<p>Variable arrays are useful for storing lists of items.&nbsp;The <span
 class=Code1>nameslist</span> character array&nbsp;above will store message
 receiver names:</p>


<p class=Code>? nameslist</p>


<p class=Code>= <a class="wiki"  href="1" rel="">1</a> = "Mike Ahn"</p>


<p class=Code><a class="wiki"  href="2" rel="">2</a> = "Steve Bacon"</p>


<p class=Code><a class="wiki"  href="3" rel="">3</a> = "George Bush"</p>


<p class=Code><a class="wiki"  href="4" rel="">4</a> = "Duane Casey"</p>


<p class=Code><a class="wiki"  href="5" rel="">5</a> = "Hill Clinton"</p>


<p class=Code><a class="wiki"  href="6" rel="">6</a> = "Pat Douglas"</p>


<p class=Code><a class="wiki"  href="7" rel="">7</a> = "Doc Foglia"</p>


<p>This is how the <span class=Code1>namelist</span> array would appear
 in the <span class=Screen>Interactive</span> window. From this listing
 you can see that:</p>


<p class=Code>nameslist<a class="wiki"  href="2" rel="">2</a> = "Steve Bacon"</p>


<p class=Code>nameslist<a class="wiki"  href="6" rel="">6</a> = "Pat Douglas"</td></tr>
</table>

<p class=BlankLine>&nbsp;</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft><span class=Bolded>Pointer arrays</span> can extend
 in two dimensions. A pointer array variable can be used to load all the
 field data of a table by record number.&nbsp;When a pointer array is loaded
 using the appropriate Xbasic command (e.g. <span class=Code1>initialize_from_table</span>
 ) each index entry of the array represents a row from the table.&nbsp;
 </p>


<p>Each array element points to a string for each table row of every field
 name from the table and&nbsp;the fields corresponding data.&nbsp;The field
 names and values from the database become properties of each array element.&nbsp;Data
 is then accessible from the variable array by index (element) value (which
 displays all the properties) or by specifying the array element property
 you are interested in.</p>


<p class=Code>? names<a class="wiki"  href="1" rel="">1</a></p>


<p class=Code>= TR_ADMINISTRATOR = .F.</p>


<p class=Code>TR_FAMILIAR = "Mike"</p>


<p class=Code>TR_FIRST_NAME = "Michael"</p>


<p class=Code>TR_ID = "003"</p>


<p class=Code>TR_LAST_NAME = "Ahn"</p>


<p class=Code>TR_MIDDLE_NAME = "K."</p>


<p class=Code>TR_PASSWORD = "password"</p>


<p class=Code>TR_SALUTATION = "Mr."</p>


<p class=Code>TR_SUFFIX = ""</p>


<p class=Code>? names<a class="wiki"  href="2" rel="">2</a></p>


<p class=Code>= TR_ADMINISTRATOR = .T.</p>


<p class=Code>TR_FAMILIAR = "Steve"</p>


<p class=Code>TR_FIRST_NAME = "Steven"</p>


<p class=Code>TR_ID = "013"</p>


<p class=Code>TR_LAST_NAME = "Bacon"</p>


<p class=Code>TR_MIDDLE_NAME = ""</p>


<p class=Code>TR_PASSWORD = "password"</p>


<p class=Code>TR_SALUTATION = ""</p>


<p class=Code>TR_SUFFIX = ""</p>


<p class=Code>.</p>


<p class=Code>.</p>


<p class=Code>.</p>


<p>Pointer array variable values are accessible via their index value&nbsp;as&nbsp;shown
 at left or by their property. (Each field from the source table becomes
 a property of each pointer array element). So you can access the following
 variable values:</p>


<p class=Code>? names<a class="wiki"  href="2" rel="">2</a>.TR_LAST_NAME</p>


<p class=Code>= "Bacon"</p>


<p class=Code>? names<a class="wiki"  href="8" rel="">8</a>.TR_FIRST_NAME</p>


<p class=Code>= "Carlos"</p>


<p class=Code>? names<a class="wiki"  href="1" rel="">1</a>.TR_FAMILIAR</p>


<p class=Code>= "Mike"</td></tr>
</table>

<p>This command fills the pointer array names with data from the <span
 class=Code1>message_tr</span> table.&nbsp;All records are loaded (the
 second parameter is a filter) and they are ordered by the <span class=Code1>tr_last_name</span>
 field (the third parameter).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>names.initialize_from_table("message_tr", ".T.",
 "tr_last_name")</td></tr>
</table>

<p>This loop cycles through the number of records in <span class=Code1>message_tr</span>
 and using the <span class=Code1>fullfamiliarname()</span> function loads
 each element of the <span class=Code1>nameslist</span> array with the
 character string of the persons familiar name.&nbsp;&nbsp;The parameters
 for the <span class=Code1>fullfamiliarname()</span> function are read
 from the appropriate property values of the names array (which was in
 turn populated with data from the table itself by the command above).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>for i = 1 to rc</p>


<p class=Code>&nbsp;&nbsp;&nbsp;nameslist<a class="wiki"  href="i" rel="">i</a> = fullfamiliarname(names<a class="wiki"  href="i" rel="">i</a>.tr_familiar,
 names<a class="wiki"  href="i" rel="">i</a>.tr_last_name)</p>


<p class=Code>next</td></tr>
</table>

<p>The variable selection is set to the first name stored in the <span
 class=Code1>nameslist</span> array.&nbsp;Selection is used in the following
 <span class=Code1>ui_dlg_box()</span> command to hold the value selected
 from the list box.&nbsp;By setting it before <span class=Code1>ui_dlg_box()</span>
 is called, you can control the initial value highlighted in the list box.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>selection = nameslist<a class="wiki"  href="1" rel="">1</a></p>


<p class=Code>ui_dlg_box("Choose Message Recipient",&lt;&lt;%a%</p>


<p class=Code>{Xsize=2}</p>


<p class=Code>{position=remember}</p>


<p class=Code>{font=tahoma,12,bold}</p>


<p class=Code>{text=35,2selection};</p>


<p class=Code>{font=tahoma,9}</p>


<p class=Code><a class="wiki"  href=".40,20selection^#nameslist!change" rel="">.40,20selection^#nameslist!change</a>||<&OK!ok_button></p>


<p class=Code>%a%,&lt;&lt;%b%</p>


<p class=Code>if a_dlg_button = "change" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;indx = nameslist.find(selection)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>


<p class=Code>else if a_dlg_button = "OK" then</p>


<p class=Code>end if</p>


<p class=Code>%b%)</td></tr>
</table>

<p>The <span class=Code1>ui_dlg_box()</span> command is what actually pops-up
 the Xdialog box on the screen and accepts the user input. To learn all
 about the details of the writing an Xdialog command please refer to <a href="/Index/Learning Xdialog Title.html" title="Learning Xdialog Title" class="wiki">Learning Xdialog</a>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>topparent:tr_id.value = names<a class="wiki"  href="indx" rel="">indx</a>.tr_id</p>


<p class=Code>topparent:reciever.refresh()&nbsp;</td></tr>
</table>

<p class=A5>Next</p>



<p><a href="/Desktop/Guide/Design/Platform/Xbasic Action Scripting/About Action Scripting.html" title="Using Action Scripting" class="wiki">Using Action Scripting</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Global+Scripts+-+Learning+Xbasic">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending","keywords":"tut,guide,xbasic"}--->
</body></html>