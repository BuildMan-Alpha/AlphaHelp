<page>
	<topic>SQL::TableSnapshot Example: Scripting the Load</topic>
	
	<description>You can create a snapshot yourself, programmatically; as in this example.</description>
	
<groups>
	
<group background="true">
<description>SQL database snapshot objects load and store data and definitions with the help of other objects available to the XBasic programmer. You can create a snapshot yourself, programmatically; as in this example. Here, the TableInfo for the table named Contacts is retrieved so that the TableSnapshot has a table definition (we could have scripted the creation of the TableInfo, but that is outside of the scope of this article). Two instances of RowSnapshot are created and populated with data and then added to the TableSnapshot.
</description>
</group>

<group>
	<example><![CDATA[dim cn as SQL::Connection
dim ti as SQL::TableInfo
 
dim ts as SQL::TableSnapshot
dim Row as SQL::RowSnapshot
dim Col as SQL::ColumnValue
 
cn.open("::Named::MyDatabase")		' Open the source database
cn.GetTableInfo(ti, "Contact")		' Load the schema from the source database
 
ts.TableInfo = ti
 
' Add two rows
 
' Row 1 - Fred Smith
Row = Row.NewInstance()			' Create a new row
 
Col = col.NewInstance()			' Create a new column 
Col.Name = "LName"
Col.Value = "Smith"
Row.AddData(Col)			' Add the column to the row
 
Col = Col.NewInstance()			' Create a new Column
Col.Name = "FName"
Col.Value = "Fred"
Row.AddData(Col)			' Add the column to the row
 
Ts.AddRow(Row)				' Add the column to the row
 
' Add the row to the table snapshot
Row = Row.NewInstance()			' Create a new row
 
Col = col.NewInstance()			' Create a new column 
Col.Name = "LName"
Col.Value = "LName"
Row.AddData(Col)			' Add the column to the row
 
Col = Col.NewInstance()			' Create a new Column
Col.Name = "FName"
Col.Value = "Jones"
Row.AddData(Col)			' Add the column to the row
 
Ts.AddRow(Row)				' Add the column to the row
 
' Row 2 - Bob Jones
file.from_string("FName", ts.XML) 	' Create a new row ]]></example>


</group>
</groups>



</page>