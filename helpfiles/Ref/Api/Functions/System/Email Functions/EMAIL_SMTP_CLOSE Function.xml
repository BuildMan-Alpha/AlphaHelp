<page>
   <topic>EMAIL_SMTP_CLOSE Function</topic>
    <description>The EMAIL_SMTP_CLOSE() function closes a connection with an SMTP email server.</description>
  
   <syntax>Result_Flag as L = email_smtp_close(P pSocket )</syntax>
   <arguments>
     <argument>
         <name>Result_Flag</name>
         <description>.T. = The connection was closed gracefully. 
 .F. = The connection was forced closed with SOCKETS.CLOSE().</description>
     </argument>
     <argument>
         <name>pSocket</name>
         <description>A pointer variable that was populated by EMAIL_SMTP_OPEN().</description>
     </argument>
   </arguments>
  
   <example><![CDATA[dim pm as P
if (email_smtp_open(ps, "mail.alphasoftware.com", "username", "password", 25)) then
    pm.to = "eavan@alphasoftware.com"
    pm.from = "aaron@alphasoftware.com"
    pm.subject = "my subject"
    pm.message = "this is the message"
    pm.attachments = 
        C:\test.zip
        c:\dev\test2.zip
        %str%
    pm.html_message = "This is the message in HTML"
end if
email_smtp_close(ps)]]></example>
   
   <see>
      <ref href="http://www.alphasoftware.com/documentation/pages/Ref/Api/Functions/System/Email%20Functions/index.xml">Email Functions and Methods</ref>
   </see>
  
<terms>email,function,pointer,variable</terms>
</page>