<page>
   <topic>EMAIL_RECEIVE Function</topic>
   <syntax>Count as N = email_receive([L display_inbox [,L strip_headers [,C profile [,C inbox [,C filter [,L lSilent ]]]]]])</syntax>
   <arguments>
     <argument>
         <name>display_inbox</name>
         <description>Logical. Optional. Defines whether to display the Inbox when email is received.
.T. = Display inbox, .F. = Do not display inbox. </description>
     </argument>
     <argument>
         <name>strip_headers</name>
         <description>Logical. Optional. Default = .T. Defines whether to strip headers from the message body and store in separate field (called Headers) in the A_EMAIL.DBF table.
 .T. = Strip headers
 .F. = Do not strip headers </description> 
     </argument>
     <argument>
         <name>profile</name>
         <description>Character. Optional. The name of your email profile as found on the View > Settings > Email > Profiles tab.
</description>
     </argument>
     <argument>
         <name>inbox</name>
         <description>Character. Optional. The name of a different in box. The function will create a table with this name.</description>
     </argument>
     <argument>
         <name>filter</name>
         <description>Character. Optional. Default = no filter. A character filter expression that evaluates to a logical value and selects email messages to download. The filter applies to header fields.
</description>
     </argument>
     <argument>
         <name>lSilent</name>
         <description>Logical. Optional. Default = .F.</description>
     </argument>
   </arguments>
   <description>Receive email messages using Alpha Five's built-in e-mail facility.</description>
   <discussion>
EMAIL_RECEIVE() receives an email message using Alpha Anywhere's built-in email features. The function does not require that you have a third party email client (such as  Eudora, or Outlook ) installed on the computer. Email is received into a table called A_EMAIL.DBF in the Alpha Anywhere program folder.
 Note : EMAIL_RECEIVE()  does not check to see if it is downloading duplicate messages.
You can control how many messages Alpha Anywhere will try to retrieve from the mail server, and whether Alpha Anywhere should leave the messages on the server after reading them by adjusting your email settings. To set email settings, select the View > Settings command from the menu, and navigate to the Email category.
Attachments will be stored in the "Attachments" folder off the Alpha Anywhere program folder.
 Note : The A_EMAIL.DBF table now has two new fields, receive_date and receive_time. If you have an existing A_EMAIL.DBF table (in the Alpha Anywhere program folder), you must delete this file. Then, the next time you use the EMAIL_RECEIVE() function, Alpha Anywhere will recreate this table with the necessary additional fields.
If you put a filter in, EMAIL_RECEIVE() will download all the headers, filter based on the criteria you have specified, and then download only the messages that match the criteria. Any valid RFC822 message header field can be sorted on ( from, to, date, subject, contenttype, etc). If the header field name contains any special characters or spaces, they will be removed. An example of that is "content-type" which would be contenttype. There is also a reserved word, size, that is the size in bytes of the entire message including headers.

   </discussion>
 
   <sections>
       <section>
       <title>Example</title>
            <description>Receives an email message using Alpha Anywhere's internal email facility.</description>
            <example><![CDATA[
email_receive(.T.)
]]></example>
       </section>
       
        <section>
      
            <description>Download only messages less than 1KB.</description>
            <example><![CDATA[
email_receive(.T., .T., "", "", "Size < 1024") 
]]></example>
       </section>
       
        <section>
      
            <description>Other sample filters.</description>
            <example><![CDATA[
email_receive(.T., .T., "", "", "\"viagra\"" $ subject")
email_receive(.T., .T., "", "", "\"ed@alphasoftware.com\" $ from")
email_receive(.T., .T., "", "", "Contenttype = "\"text/plain\"")
]]></example>
       </section>
   </sections>
   <see>
      <ref>Email Functions and Methods</ref>
      <ref><![CDATA[<EMAIL> Pointer Properties]]></ref>
      <ref>EMAIL_SEND()</ref>
      <ref href="/Server/Guide/Design/Platform/Xbasic/Writing Expressions.html">Writing Expressions</ref>
   </see>
   
<terms>email,contains,control,defaults,delete,display,expressions,field,filter,function,header,logical,time,writing</terms>
   
   
</page>