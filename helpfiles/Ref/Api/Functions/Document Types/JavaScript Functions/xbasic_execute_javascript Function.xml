<page api="xb" build="4817">
    <shortlink>api xbasic_execute_javascript function</shortlink>
    <topic>Xbasic_execute_Javascript Function</topic>
    <description>Execute Javascript code on the server side using the Javascript engine in Node.js.</description>
    <prototypes>
        <prototype>dim result as p = Xbasic_execute_Javascript(jscode as c)</prototype>
    </prototypes>
    <arguments>
        <argument>
            <name>jscode</name>
            <type>c</type>
            <description>The Javascript code to execute.</description>
        </argument>
    </arguments>
    <returns>
        <return>
            <name>result</name>
            <types>
                <type>p</type>
            </types>
            <description>Returns an object with the following properties:</description>
            <properties>
                <property readonly="true">
                    <name>error</name>
                    <types>
                        <type>L</type>
                    </types>
                    <description>True/false indicating if there was an error.</description>
                </property>
                <property readonly="true">
                    <name>errorText</name>
                    <types>
                        <type>C</type>
                    </types>
                    <description>Error text if there was an error.</description>
                </property>
                <property readonly="true">
                    <name>result</name>
                    <types>
                        <type>A</type>
                    </types>
                    <description>The value returned by the Javascript code if there was no error.</description>
                </property>
            </properties>
        </return>
    </returns>
    <discussion>
        <p>The *[xb:Xbasic_execute_Javascript()]* function can be used to execute Javascript from within an Xbasic script using the Node.js engine.</p>
        <p>If you want the Javascript code to return a value, the Javascript code must emit the value by specifying the name of the variable to emit as the last line in the Javascript code. For example:</p>
    </discussion>
    <example code="xb"><![CDATA[dim js as c
js = <<%str%
var arr = [];
for(var i = 0; i < 1000; i++) {
    arr.push('String: ' + i );
}
var txt = arr.join('\n');

//we want to return the value of the 'txt' variable, so we emit it by specifying
//the variable name as the list line in the Javascript code
txt;
%str%

pr = xbasic_execute_javascript(js)

if pr.error = .f. then
    showvar(pr.result)
else
    showvar(pr.errorText)
end if]]></example>
</page>