<page api="xb">
    <shortlink>api sql insert function</shortlink>
    <topic>sql_insert Function</topic>
    <syntax>p result = sql_insert(A connection,c tablename,c fieldValuePairs [, L execute])</syntax>
    <arguments>
        <argument>
            <name>connection</name>
            <types>
                <type>C</type>
                <type>SQL::Connection</type>
            </types>
            <description>An open SQL::connection object, a connection string, or a named connection string.</description>
        </argument>
        <argument>
            <name>tablename</name>
            <type>C</type>
            <description>Name of the table to update.</description>
        </argument>
        <argument>
            <name>fieldValuePairs</name>
            <type>C</type>
            <description>Fields to set with corresponding values. A cr-lf list of the form fieldname=value. Or a JSON string (see example). Date values must be specified using *[xb:yyyy/mm/dd]* format.</description>
        </argument>
        <argument optional="true">
            <name>execute</name>
            <type>L</type>
            <description>If false, the SQL is not executed. However, you can still examine the *[xb:result.sql]* and *[xb:result.arguments]* properties to see what SQL was generated.</description>
        </argument>
    </arguments>
    <returns>
        <return>
            <name>result</name>
            <type>P</type>
            <description>An object with the following properties:</description>
            <properties>
                <property>
                    <name>error</name>
                    <type>L</type>
                    <description>Indicates whether or not an error occurred.</description>
                </property>
                <property>
                    <name>errorText</name>
                    <type>C</type>
                    <description>A detailed description of the error - if any occurred.</description>
                </property>
                <property>
                    <name>sql</name>
                    <type>C</type>
                    <description>The SQL that was generated to execute the insert.</description>
                </property>
                <property>
                    <name>Arguments</name>
                    <type>C</type>
                    <description>The XML arguments generated for the insert.</description>
                </property>
                <property>
                    <name>lastInsertedIdentity</name>
                    <type>A</type>
                    <description>The value of the primary key field (if its value was auto-generated.)</description>
                </property>
            </properties>
        </return>
    </returns>
    <description>Inserts a record in a SQL table.</description>
    <discussion>This function is just a wrapper around the Xbasic AlphaDAO commands to execute a SQL insert statement, but it convenient to use for simple cases.</discussion>
    <sections>
        <section>
            <example code="xb"><![CDATA[ dim cn as sql::Connection

cn.open("::Name::myconnstring")
tablename = "mytable"
fieldsValuePairs = <<%str%
name=fred smith

date of birth=1952/12/18

salary=78000
%str%
 

'You can also specify field values using JSON
fieldsValuePairs = <<%str%
{
    "name" : "fred smith",
    "date of birth" : "1954/11/25",

    "salary" : "78000"
}
%str%


p = sql_insert(cn,tablename,fieldsValuePairs)

 

?p.lastInsertedIdentity

= 5]]></example>
        </section>
    </sections>
    <see>
        <ref link="api sql lookup function">sql_lookup Function</ref>
        <ref link="api sql update function">sql_update Function</ref>
    </see>
</page>