<page>
      <shortlink>api objects system filefind object filefind grep function</shortlink>
   <topic>FILEFIND.GREP Function</topic>
   <description>Returns a string containing all the files - you can specify what greps listed.</description> 
   
   <syntax>Line_List as C = Grep(C file_pattern,C regular_expression[,N file_attribute[,C grep_format[,C regex_options]]])</syntax>
   <arguments>
   <argument>
         <name>Line_List</name>
         <description>A list containing of one line per file that contains text that matches the Regular_Expression. Each line contains the filename, line number, and the line containing the matching text.
</description>
     </argument>
     <argument>
         <name>file_pattern</name>
         <description>A pattern to select file names using wildcard characters like '*' and '? '.
</description>
     </argument>
     <argument>
         <name>regular_expression</name>
         <description>Character</description>
     </argument>
     <argument>
         <name>file_attribute</name>
         <description>Optional. Default = 0 (normal files). The File_Attribute parameter is a numeric value specifying the type of file to find. You can find files that have one or more of the following attributes:</description>
<list>
<item>
<name>FILE_FIND_NORMAL</name>
</item>

<item>
<name>FILE_FIND_READONLY</name>
</item>

<item>
<name>FILE_FIND_HIDDEN</name>
</item>

<item>
<name>FILE_FIND_SYSTEM</name>
</item>

<item>
<name>FILE_FIND_LABEL</name>
</item>

<item>
<name>FILE_FIND_DIRECTORY</name>
</item>

<item>
<name>FILE_FIND_ARCHIVE</name>
</item>

<item>
<name>FILE_FIND_AND_FLAGS</name>
</item>

<item>
<name>FILE_FIND_NOT_READONLY</name>
</item>

<item>
<name>FILE_FIND_NOT_DIRECTORY</name>
</item>

<item>
<name>FILE_FIND_NOT_ARCHIVE</name>
</item>

<item>
<name>FILE_FIND_AND_NOT_FLAGS</name>
</item>
</list>
    
    
    
    
    
    
    
    
     </argument>
     <argument>
         <name>grep_format</name>
         <description>Character</description>
<list>
<item>
<name>"\0" = All text.</name>
</item>

<item>
<name>"\N" = Tagged text expression.</name>
</item>

<item>
<name>"N" = No copy of unmatched text.</name>
</item>

<item>
<name>"F" = Only process first match.</name>
</item>

<item>
<name>"$(OFFSET)" = Return the offset of the match.</name>
</item>

<item>
<name>"$(LENGTH)" = Return the length of the match.</name>
</item>

<item>
<name>"$(END)" = Return the ending offset of the match.</name>
</item>

<item>
<name>"$(LINE)" = Return the line the match started on.</name>
</item>

<item>
<name>"$(ENDLINE)" = Return the line the match ended on.</name>
</item>

<item>
<name>"$(LINES)" = Return the number of lines the match crosses.</name>
</item>

<item>
<name>"$(LINETEXT)" = Return the complete line(s) of text the match(es) occurred on.</name>
</item>

<item>
<name>"$(LINEOFFSET)" = Return the offset of the beggining of the match line.</name>
</item>

<item>
<name>"$(ENDLINEOFFSET)" = Return the offset of the end of the line the match ended on.</name>
</item>

<item>
<name>"$(COUNT)" = Return the number of matches encountered so far.</name>
</item>

<item>
<name>"$(NEXTLINE)" = Advance the search pointer to the next line.</name>
</item>

<item>
<name>"$(FILENAME)" = The name of file we are currently grepping</name>
</item>


<item>
<name>"$(FULLFILENAME)" = The fully qualified name of file we are currently grepping</name>
</item>
<item>
<name>"$(RELATIVEFILENAME)" = A partially qualified name of file we are currently grepping (only different than FILENAME if we using recursive function)</name>
</item>

<item>
<name>"$(STOP)" = Stops GREPing a file after one occurance is found. This lets you print a list of files that have a match instead of all the lines that in the file than matched.</name>
</item>


</list>         
         
         
         
         
         
         
     </argument>
     <argument>
         <name>regex_options</name>
         <description>Optional. Default = "S". Specify which compatibility with a common implementation. ThE flags for Emacs, Awk, Grep, Egrep and Sed conventions allow the pattern to follow the conventions of those utilities (which have slightly different variants regarding what is escaped and what is not escaped).</description>
<list>
<item>
<name>"I" = Ignore case</name>
</item>

<item>
<name>"E" = Follow Emacs conventions</name>
</item>

<item>
<name>"A" = Follow Awk conventions</name>
</item>

<item>
<name>"G" = Follow Grep conventions</name>
</item>

<item>
<name>"EG" = Follow Egrep conventions</name>
</item>

<item>
<name>"S" = Follow Sed conventions</name>
</item>

<item>
<name>"X" = Extended (similar to Awk but no need to escape '' inside of [])</name>
</item>
</list>
     
     
     </argument>
     
   </arguments>
  
   <discussion>
The FILEFIND.GREP() method executes a regular expression against the contents of the files in the current directory that match a specified file pattern and returns a list of filenames and text.
   </discussion>
   <example><![CDATA[
file.dir_put("c:\\")
? filefind.grep("*.txt", "(W|w)indows")
= osver.txt 2:Microsoft Windows 2000 Version 5.00.2195
vpn setup.txt 1:Windows 2000/ME
]]></example>
   
   <see>
      <ref>File Functions and  Methods</ref>
      <ref>FILEFIND Methods</ref>
      <ref link="Regular Expression Functions">Regular Expressions</ref>
      <ref href="/Api/Functions/Data Type/Character Functions/Regular Expressions Functions/Regular Expressions Functions and Methods.html">Regular  Expressions Functions and Methods</ref>
   </see>
   
   <terms>filefind,contains,directory,expressions,file,filename,function,list,number,pointer,search,string</terms>
   
   </page>