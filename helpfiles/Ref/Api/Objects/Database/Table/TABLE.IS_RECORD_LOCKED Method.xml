<page>
   <topic>table.IS_RECORD_LOCKED Function</topic>
   <syntax>Result_Flag as L = Is_Record_Locked()</syntax>
   <description>return TRUE if the record is locked.</description>
   <discussion><![CDATA[
The <TBL>.IS_RECORD_LOCKED() method returns .T. (TRUE) if the current record is locked (i.e. another user or session has the record in change mode).
This method is new to V5. Previously, if you tried to put a record into change mode and another user or session already had the record in change mode, an error condition would occur, which your script could trap with the ON ERROR command. However, this technique is slow because Alpha Anywhere makes several attempts to get a lock on the record before reporting the error. Using the <TBL>.IS_RECORD_LOCKED() method is easier and faster.
]]> </discussion>
   
   <sections>
       <section>
            <description>This script checks if the current record is locked before making a change.</description>
            <example><![CDATA[
dim tbl as P
tbl = table.current()
status = tbl.is_record_locked()
if (.not. status) then
    tbl.change_begin()
    tbl.field1 = var1
    tbl.change_end(.T.)
else
    ui_msg_box("Error", "Record locked by another user")
end if
]]></example>
       </section>
   </sections>
   <see>
      <ref href="/Api/Functions/Document Types/DBF/Table Functions/Table Functions and Methods.html">Table Functions and  Methods</ref>
   </see>
   <terms>table,function,record,script</terms>

</page>