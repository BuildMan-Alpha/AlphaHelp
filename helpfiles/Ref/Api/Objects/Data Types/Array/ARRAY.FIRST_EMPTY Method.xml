<page api="xb">
    <topic>ARRAY.FIRST_EMPTY Function</topic>
    <description>Return the last unused entry in the array.</description>
    <syntax>Index as N = &lt;ARRAY&gt;.first_empty([C property])</syntax>
    <arguments>
        <argument optional="true">
            <name>property</name>
            <type>C</type>
            <description>If specified, returns the index of the first property that that is undefined for an element in the array.</description>
        </argument>
    </arguments>
    <discussion>The &lt;ARRAY&gt;.FIRST_EMPTY() method returns the index of the first NULL element in an array.</discussion>
    <sections>
        <section>
            <title>Example</title>
            <description>Assume an array "A" contains the following elements:</description>
            <list>
                <item>
                    <name-title>Element</name-title>
                    <description-title>Value</description-title>
                </item>
                <item>
                    <name>A[1]</name>
                    <description>Orange</description>
                </item>
                <item>
                    <name>A[2]</name>
                    <description>Banana</description>
                </item>
                <item>
                    <name>A[3]</name>
                    <description>Apple</description>
                </item>
                <item>
                    <name>A[4]</name>
                    <description>Pineapple</description>
                </item>
                <item>
                    <name>A[5]</name>
                    <description>Mango</description>
                </item>
                <item>
                    <name>A[6]</name>
                </item>
                <item>
                    <name>A[7]</name>
                </item>
                <item>
                    <name>A[8]</name>
                </item>
            </list>
        </section>
        <section>
            <example><![CDATA[? A.first_empty() 
= 6 ' because element 6 is the first NULL (empty) element.]]></example>
        </section>
        <section>
            <description>The following example demonstrates using the optional *[xb:property]* parameter.</description>
            <example><![CDATA[dim items[10] as p
items[1].city = "Boston"
items[1].state = "MA"
items[2].city = "Attleboro"
items[2].state = "MA"
items[3].city = "Providence"
items[3].state = "RI"
items[4].city = "Newport"
items[4].state = ""
items[5].city = "Barrington"
items[5].state = ""

? items.first_empty("state")
 = 4]]></example>
        </section>
        <section>
            <note>If a *[xb:property]* is not defined for an element in the array, it will be skipped. In the example above, if state had not been added to items[4] and items[5], .FIRST_EMPTY() would return 6, not 4. Therefore, it is important that all elements in the array must have the same properties defined.</note>
        </section>
    </sections>
    <terms>array,function,index</terms>
</page>