<page>
	<topic>StringScanner</topic>
<description>The StringScanner object provides high performance string manipulation functions. The StringScanner functions operate at the location of the current offset in the text buffer. The initial position is 1. All functions (except those with optional negative numeric arguments) work from the current offset position towards the end of the buffer.
The .ScanXXX() functions position the offset immediately after any found text. The .SkipXXX() functions position the offset at the beginning of any found text.
</description>	

<sections>
<section>
	<title>Properties</title>
<list>
	<item>
		<name>Property</name>
		<description>Description</description>
	</item>
	<item>
		<name>Offset
</name>
		<description>The offset position from the start of the buffer. The first position in the buffer is 1.
</description>
	</item>
	<item>
		<name>Text
</name>
		<description>The contents of the buffer.
</description>
	</item>
	
	
</list>	
	
</section>	
<section>
	<title></title>
<description></description>	
<cases>
<case>
		<title>
		
	
StringScanner.Create()
 </title>
		<description>
Type P. 
 
Creates a new StringScanner object.
 </description></case><case><title>

.Delete()</title>
		<description> Type V. 
 
Deletes N bytes from the buffer starting at the offset.
 </description></case><case><title>

.GetLineNumber()</title>
		<description> Type N. 
 
Returns the line number of the offset.
 </description></case><case><title>

.GetLineText()</title>
		<description> Type C. 
 
Returns the text of the line that the offset is on.
 </description></case><case><title>

.GetRemainder()</title>
		<description> Type C. 
 
Return text from the current position to the end of the string.
 </description></case><case><title>

.GetToOffset()</title>
		<description> Type C. 
 
Returns text from the from the beginning of the string to the current offset.
 </description></case><case><title>

.GotoLineStart()</title>
		<description> Type N. 
 
Positions the offset to the beginning of the current line.
 </description></case><case><title>

.Replace()</title>
		<description> Type V. 
 
Inserts text and optionally replaces a specified number of bytes at the current position.
 </description></case><case><title>

.ReplaceSmatch()</title>
		<description> Type L. 
 
Replaces the next instance of Find_Text with Replace_Text. Uses wildcard characters.
 </description></case><case><title>

.ReplaceSmatchI()</title>
		<description> Type L. 
 
Replaces the next instance of Find_Text (case insensitive) with Replace_Text. Uses wildcard characters.
 </description></case><case><title>

.ReplaceString()</title>
		<description> Type L. 
 
Replaces the next instance of Find_Text with Replace_Text.
 </description></case><case><title>

.ReplaceStringI()</title>
		<description> Type L. 
 
Replaces the next instance of Find_Text (case insensitive) with Replace_Text.
 </description></case><case><title>

.Reset()</title>
		<description> Type V. 
 
Moves the offset to the beginning of the buffer (position = 1).
 </description></case><case><title>

.ScanOver()</title>
		<description> Type C. 
 
Moves the offset by a specified number (positive or negative) of characters and returns the text between the starting and ending positions.
 </description></case><case><title>

.ScanOverSmatch()</title>
		<description> Type C. 
 
Looks for Find_Text at the offset and returns the text between the starting and ending positions. Uses wildcard characters.
 </description></case><case><title>

.ScanOverSmatchI()</title>
		<description> Type C. 
 
Looks for Find_Text (case insensitive) at the offset and returns the text between the starting and ending positions. Uses wildcard characters.
 </description></case><case><title>

.ScanSmatch()</title>
		<description> Type L. 
 
Indicates whether the Find_Text can be between the offset and the end of the buffer.
 </description></case><case><title>

.ScanSmatchI()</title>
		<description> Type L. 
 
Indicates whether the Find_Text (case insensitive) can be between the offset and the end of the buffer.
 </description></case><case><title>

.ScanToAlpha()</title>
		<description> Type C. 
 
Positions the offset after the next alphabetic character and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToAlphaNum()</title>
		<description> Type C. 
 
Positions the offset after the next alphanumeric character and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToCharacter()</title>
		<description> Type C. 
 
Moves the offset forward until it finds a character not in Find_Chars and returns the textbetween the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToDigit()</title>
		<description> Type C. 
 
Positions the offset after the next number (0 to 9) that it finds and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToSmatch()</title>
		<description> Type C. 
 
Positions the offset after the next instance of the search argument. Uses wildcard characters.
 </description></case><case><title>

.ScanToSmatchI()</title>
		<description> Type C. 
 
Positions the offset after the next instance of the search argument (case insensitive). Uses wildcard characters.
 </description></case><case><title>

.ScanToString()</title>
		<description> Type C. 
 
Positions the offset after the next instance of the Find_Text and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToStringI()</title>
		<description> Type C. 
 
Positions the offset after the next instance of the Find_Text (case insensitive) and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanToToken()</title>
		<description> Type C. 
 
Moves the offset to the indicated kind of token.
 </description></case><case><title>

.ScanToWhitespace()</title>
		<description> Type C. 
 
Positions the offset after the next white space character and returns the text between the starting and ending positions of the offset.
 </description></case><case><title>

.ScanTypedToken()</title>
		<description> Type C. 
 
Returns the next Token_Found in the format Kind:Token.
 </description></case><case><title>

.SkipOver()</title>
		<description> Type L. 
 
Moves the offset Count characters. The argument can be positive (moving towards the end of the buffer) or negative (moving towards the start of the buffer).
 </description></case><case><title>

.SkipOverAlpha()</title>
		<description> Type N. 
 
Positions the offset after the next non-alpha character and returns the number of characters skipped.
 </description></case><case><title>

.SkipOverAlphaNum()</title>
		<description> Type N. 
 
Positions the offset after the next non-alphanumeric character and returns the number of characters skipped.
 </description></case><case><title>

.SkipOverCharacter()</title>
		<description> Type N. 
 
Positions the offset after the first character not in the group and returns the number of characters skipped over.
</description></case><case><title> 

.SkipOverDigit()</title>
		<description> Type N. 
 
Positions the offset after the first non-numeric character and returns the number of characters skipped over.
 </description></case><case><title>

.SkipOverSmatch()</title>
		<description> Type N. 
 
Positions the offset after the search text and returns the number of characters skipped over. Uses wildcard characters.
 </description></case><case><title>

.SkipOverSmatchI()</title>
		<description> Type N. 
 
Positions the offset after the search text (case insensitive) and returns the number of characters skipped over. Uses wildcard characters.
 </description></case><case><title>

.SkipOverString()</title>
		<description> Type N. 
 
Positions the offset at the beginning of the search text and returns the number of characters skipped over.
 </description></case><case><title>

.SkipOverStringI()</title>
		<description> Type N. 
 
Positions the offset at the beginning of the search text (case insensitive) and returns the number of characters skipped over.
 </description></case><case><title>

.SkipOverToken()</title>
		<description> Type N. 
 
Positions the offset after the next token of the specified type, and returns the characters moved.
 </description></case><case><title>

.SkipOverWhitespace()</title>
		<description> Type N. 
 
Positions the offset after the next non-white space character and returns the number of characters skipped.
 </description></case><case><title>

.SkipToAlpha()</title>
		<description> Type L. 
 
Positions the offset at the beginning of the next alphabetic character and returns true if successful.
 </description></case><case><title>

.SkipToAlphaNum()</title>
		<description> Type L.
 
Positions the offset at the beginning of the next alphanumeric character and returns true if successful.
 </description></case><case><title>

.SkipToCharacter()</title>
		<description> Type L.
 
Positions the offset at the next characters in the search list and returns true if successful.
 </description></case><case><title>

.SkipToDigit()</title>
		<description> Type L.
 
Positions the offset at the next digit (0-9) is encountered and returns true if successful.
 </description></case><case><title>

.SkipToString()</title>
		<description> Type L.
 
Positions the offset at the beginning of the search text and returns true if successful.
 </description></case><case><title>

.SkipToStringI()</title>
		<description> Type L.
 
Positions the offset at the beginning of the search text (case insensitive) is found and returns true if successful.
 </description></case><case><title>

.SkipToToken()</title>
		<description> Type L.
 
Positions the offset after the found token.
 </description></case><case><title>

.SkipToWhitespace()</title>
		<description> Type L.
 
Positions the offset at the next white space character and returns true if successful.
 </description></case>

	
	
	
</cases>	
	
	
</section>	
	<section>
	<title>Example</title>	
	<description>The following function removes a block of lines from the alphafivehelp.hhc text file that is over 20,000 lines in length. The block to be removed is defined by a " 
" and its matching " " tag. This block follows immediately after the line containing the text defined by lt. The variable dst defines the directory that contains the alphafivehelp.hhc file.</description>	
	<example><![CDATA[function remove_toc_entries as V ( dst as C, lt as C )
dim fbuffer as C
dim outbuffer as C
dim lbuffer as C
dim ulcount as N = 0
dim counting as L = .F.
dim at_i as N
dim buf as P
dim ln as N]]></example>	
		
	</section>
	<section>
	
	<description>Read the text into a buffer and create the StringScanner object.</description>	
	<example><![CDATA[outbuffer = ""
fbuffer = file.to_string(dst + "alphafivehelp.hhc")
buf = stringscanner.create(fbuffer)]]></example>	
		
	</section>
	<section>
	
	<description>Move the offset to the line that contains the search text.</description>	
	<example><![CDATA[if (buf.SkipToStringI("") = .T.) then
    ' if the text is found, get the line number
    ln = buf.GetLineNumber()
    ' move the offset to the start of the line
    buf.GotoLineStart(ln)
    ' copy everything up to the offset into the output buffer
    outbuffer = buf.GetToOffset()
end if]]></example>	
		
	</section>
	<section>
	
	<description>Look for the starting "
" tag.</description>	
	<example><![CDATA[if (buf.SkipToStringI("
") = .T.) then
    ' if found, move the offset past it
    buf.ScanOver(5)
    ulcount = 1
    ' find the corresponding "
" tag
    while (ulcount > 0)
        if (buf.SkipToStringI("ul>") = .T.) then
            lbuffer = buf.GetLineText()
            if ("
" $ lbuffer) then
                ulcount = ulcount + 1
            end if
            if ("
" $ lbuffer) then
                ulcount = ulcount - 1
            end if
            buf.ScanOver(5)
        end if
    end while
end if]]></example>	
		
	</section>
	<section>
	
	<description>Get the line number.</description>	
	<example><![CDATA[ln = buf.GetLineNumber()+ 1
' move the offset to the start of the next line
buf.GotoLineStart(ln)
' copy everything after the offset into the output buffer
outbuffer = outbuffer + buf.GetRemainder()]]></example>	
		
	</section>
	<section>
	
	<description>Save the output buffer into a new copy of alphafivehelp.hhc.</description>	
	<example><![CDATA[file.from_string(dst + "alphafivehelp.hhc", outbuffer)
end function]]></example>	
		
	</section>
	
</sections>	
	<see>
		<ref>Character Replacement Functions</ref>
		<ref>Character Search Functions</ref>
		<ref>How to implement comma_to_crlf honoring delimiters</ref>
		
	</see>
	
</page>