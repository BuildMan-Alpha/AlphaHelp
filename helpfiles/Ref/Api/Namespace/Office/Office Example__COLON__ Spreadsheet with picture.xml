<page>
	<topic>Office Example: Spreadsheet with picture</topic>
<description>This example creates a simple spreadsheet and adds a picture to the workbook, then sets the picture into a cell of the spreadsheet
</description>
	<sections><section>
	
	
	
	<example><![CDATA[
dim DocumentFile as C = "c:\temp\flower.xlsx"
 
dim Doc    as office::ExcelDocument
Dim Sheet  as Office::Spreadsheet
dim Picture as B
dim Id    as N
 
'Here we add a picture from a blob (first loading the file from disk)
'Note: This example shows how to set a blob containing a picture into a workbook.
'You could also call Doc.AddPicture(FileName), but then we couldn't show you 
'   how to load a picture from a blob.
Picture = File.To_Blob(a5.get_exe_path(( \
          + "\Samples\WebAppServerDemo\Hires\Daffodils.jpg"(
Id = Doc.AddPicture(Picture(
 
Sheet = Doc.AddSheet("Picture"(
Sheet.SetPicture(1,1,Id(
 
Path = File.FileName_Parse(DocumentFile, "P"(
on error resume next
File.Dir_Create(Path(
on error goto 0
if Doc.Save(DocumentFile(
'Release all references to the document so we can open it in Excel
  delete Doc
  Sys_Open(DocumentFile(
else  
  UI_Msg_Box("Error Saving Document", \
                   "Unable to save document to " \
                  + DocumentFile + ":" + crlf(2( + Doc.ErrorMessage(
end if	 ]]></example>
	</section></sections>
	<see>
<ref href="/Api/Namespace/Office/index.xml">Office</ref>
<ref href="Generate Excel Spreadsheets Programmatically.xml">Generate Excel Spreadsheets Programmatically </ref>
<ref href="Office__NAMESPACE__ExcelDocument.xml">Office::ExcelDocument</ref>
<ref href="Office__NAMESPACE__Excel2003Document.xml">Office::Excel2003Document</ref>
<ref href="Office__NAMESPACE__Spreadsheet.xml">Office::SpreadSheet</ref>
<ref href="Office__NAMESPACE__Format.xml">Office::Format</ref>
<ref href="Office__NAMESPACE__Font.xml">Office::Font</ref>
<ref href="Office Enumerations.xml">Office Enumerations</ref>
<ref href="/Server/Guide/Design/Data/SQL/Perform Common Spreadsheet Operations.xml">How to perform common spreadsheet operations</ref>
<ref href="Office Example__COLON__ Simple Weekly sales spreadsheet.xml">Office Example: Simple Weekly sales spreadsheet</ref>
<ref href="Office Example__COLON__ Multiple spreadsheets.xml">Office Example: Multiple spreadsheets</ref>
<ref href="/Server/Guide/Design/Data/SQL/Office Example__COLON__ Spreadsheet from SQL query.xml">Office Example: Spreadsheet from SQL query</ref>
<ref href="/Desktop/Guide/Design/Data/DBF/Office Example__COLON__ Spreadsheet from DBF tables.xml">Office Example: Spreadsheet from DBF tables</ref>
<ref href="Office Example__COLON__ Spreadsheet with picture.xml">Office Example: Spreadsheet with picture</ref>
<ref href="Office Example__COLON__ Update a spreadsheet.xml">Office Example: Update a spreadsheet"</ref>
	</see>
	<terms>Office,picture,set,spreadsheet</terms>
</page>