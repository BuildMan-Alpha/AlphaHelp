<page generated="false" api="xb">
	<shortlink>api inet sftp listdirectory method</shortlink>
	<topic parent="INET::SFTP" parentType="class" elementName="ListDirectory Method">INET::SFTP ListDirectory Method</topic>
	<description>List the contents of a server directory.</description>
	<prototype>.ListDirectory as L (BYREF Listing as C, SFTPPath  as C)</prototype>
	<arguments>
		<argument>
			<name>Listing</name>
			<type>C</type>
			<description>The contents of the directory listing returned.</description>
		</argument>
		<argument>
			<name>SFTPPath</name>
			<type>C</type>
			<description>The path to the directory on the server that you would like a directory of.</description>
		</argument>
	</arguments>
	<returns>
		<return>
			<name>result</name>
			<type>L</type>
			<description>Returns *[xb:.t.]* if the operation succeed. Otherwise, returns *[xb:.f.]*. If an error occurred, the *[xb:INET::SFTP CallResult]* property will contain more information.</description>
		</return>
	</returns>
	<example code="xb"><![CDATA[dim ftp as INET::SFTP
sftp.UserName   = "Fred"
sftp.Password   = "Secret"
sftp.ServerHost = "ftp.myserver.com"

dim Listing as C

if sftp.ListDirectory(Listing, "/downloads") <> .t.
    ' error
    msg = sftp.callResult.error
    ...
end if]]></example>
</page>
