<page>
	<topic>SQL::Query Object</topic>
<description>SQL::Query object methods and related enumerations and objects.</description>	
	<discussion>The SQL::Query object implements Portable SQL. The SQL::Query object parses Portable SQL statements and converts them to the native SQL dialect of the target database. The SQL::Query object is the root of all queries. As a result, it has the most properties. Its children are the various clauses that make up a complete SELECT statement.</discussion>
	<sections>
		<section>
			
	<example><![CDATA[dim conn as SQL::Connection
dim qry as SQL::Query
dim rs as SQL::ResultSet
dim connString as C
dim select_exp as C
connString = "{A5API='Access', FileName='c:\program files\a5v7\mdbfiles\alphasports.mdb'}"
select_exp = "select Lastname from customer where bill_state_region = 'ma'"
conn.open(connString)
qry.execute(conn)
rs = qry.resultset]]></example>
			
		</section>
		<section>
			<description>In the simplest case, you can declare a variable and parse a string. From there you can explore the resulting query as an Xbasic object, or dump the parse tree by looking at the .ParseTree property, or even convert the query to XML using the XML property.
For example:
</description>
	<example><![CDATA[dim Q as SQL::Query
Q.Parse("select customer, cost, ?Hello' as Message from orderheader o order by customer")
? Q.ParseTree
=
{ SELECT:510:193 NONE:182 SELECT_LIST:160 TABLE_LIST:164
{ LOGICAL_EXPRESSION:191NONE:120 LIST:158 }
{ GROUPBY_CLAUSE:187GROUPBY_LIST:188 WHERE_CLAUSE:183 .f.:4 }ORDERBY_CLAUSE:184 UNION_LIST:189 ORDERBY_CLAUSE:184 }
? Q.XML
= ]]></example>
			
		</section>
		<section>
			<description>In addition, the XML string can be assigned to a different query.</description>
	<example><![CDATA[dim Q2 as SQL::Query
Q2.XML = Q.XML
? Q2.ParseTree
=
{ SELECT:510:193 NONE:182 SELECT_LIST:160 TABLE_LIST:164
{ LOGICAL_EXPRESSION:191NONE:120 LIST:158 }
{ GROUPBY_CLAUSE:187GROUPBY_LIST:188 WHERE_CLAUSE:183 .f.:4 }ORDERBY_CLAUSE:184 UNION_LIST:189 ORDERBY_CLAUSE:184 }]]></example>
			
		</section>
		<section><title>Using Arguments</title>
			<description>This script show how to use an argument when you want to substitute a value at run time. This syntax does not directly use a SQL::Arguments object. Instead, it allows the SQL::Query object to create its own SQL::Arguments object.</description>
	<example><![CDATA[q.Parse("SELECT CompanyName, City FROM Customers WHERE City = :city")
? q.Arguments.Count
= 1
? q.Arguments.Set("City", "London")
= .T.
c.Open(cs)
q.Execute(c)
? q.ResultSet.ToString()
= B's Beverages London
Consolidated Holdings London
Eastern Connection London
North/South London
Seven Seas Imports London]]></example>
			
		</section>
		<section>
			<description>This syntax uses a SQL::Arguments object, adds a name/value pair with the SQL::Argument.Add()method, and passes the object as part of the SQL::Connection::Execute()query.</description>
	<example><![CDATA[dim args as SQL::Arguments
dim conn as SQL::Connection
sql = "SELECT TOP 2 CompanyName, City FROM Customers WHERE City = :city"
args.Add("city", "London")
? conn.Execute(sql, args)
= .T.
? conn.ResultSet.ToString()
= B's Beverages London
Consolidated Holdings London
Eastern Connection London
North/South London
Seven Seas Imports London]]></example>
			
		</section>
		<section>
			<title>Related Objects</title>
			<list>
				<item>
					<name>[SQL::Query::Assignment Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::ColumnOrder Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::ColumnReference Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::Join Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::LogicalExpression Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::ReplaceOption Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::SelectItem Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::SelectTableReference Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::TableReference Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::Union Object]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::ValueExpression Object]</name>
					<description>Internal Use Only</description>
				</item> 
			</list>
		</section>
		<section>
			<title>Related Enumerations</title>
			<list>
				<item>
					<name>[SQL::Query::ArithmeticOperator Enumerated Type]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::DuplicateOption Enumerated Type]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::LogicalOperator Enumerated Type]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::Order Enumerated Type]</name>
					<description>Internal Use Only</description>
				</item> 
				<item>
					<name>[SQL::Query::OuterJoinType Enumerated Type]</name>
					<description>Internal Use Only</description>
				</item> 
			</list>
		</section>
	</sections>
	
	<properties>
		<property>
			<name>Arguments</name>
			<type>SQL::Arguments</type>
			<description>Read Only. Arguments for the current query.</description>
		</property>
		
		<property>
			<name>CallResult</name>
			<type>SQL::CallResult</type>
			<description>Read Only. Call results.</description>
		</property>
		
		<property>
			<name>Column</name>
			<type>List of SQL::Query:: SelectItem</type>
			<description>Read Write. List of the items in the select column list.</description>
		</property>
		
		<property>
			<name>ColumnReferences</name>
			<type>ReferenceList of SQL::Query::ColumnReference</type>
			<description>Read Only. An array of all column references in the query (including nested occurrences). Behaves the same way as  .SelectTableReferences.
</description>
		</property>
		
		<property>
			<name>Connection</name>
			<type>SQL::Connection</type>
			<description>Read Write. Current open connection</description>
		</property>
		
		<property>
			<name>DuplicateOption</name>
			<type>SQL::Query::DuplicateOption</type>
			<description>Read Write. See Enumerated Type Values.</description>
		</property>
		
		<property>
			<name>ErrorColumn</name>
			<type>N</type>
			<description>Read Only. The column number of the last error reported by the parser.</description>
		</property>
		
		<property>
			<name>ErrorText</name>
			<type>C</type>
			<description>Read Only. The text of the last parser error reported.</description>
		</property>
		<property>
			<name>First</name>
			<type>N</type>
			<description>-</description>
		</property>
		<property>
			<name>FunctionReferences</name>
			<type>ReferenceList of SQL::Query::ValueExpression</type>
			<description>Read Only. An array of all function calls. Behaves the same way as  .SelectTableReferences.
</description>
		</property>
		
		<property>
			<name>GroupBy</name>
			<type>SQL::Query::GroupBy</type>
			<description>Read Write. The GROUP BY clause. This object always exists. If the list inside is empty, no GROUP BY was coded.</description>
		</property>
		
		<property>
			<name>NestedOrderBy</name>
			<type>List of SQL::Query::ColumnOrder</type>
			<description>Read Write. A list of column order objects. If the list is empty, no ORDER BY clause  was coded. .NestedOrderBy comes before .Union. This was in a test case, so I am supporting it (for now).
 </description>
		</property>
		
		<property>
			<name>ObjectDefinitions</name>
			<type>C</type>
			<description>Read Only. For internal debugging. Returns a string description of the mapping between the ANTLR grammar and the Xbasic objects.
</description>
		</property>
		
		<property>
			<name>OrderBy</name>
			<type>List of SQL::Query::ColumnOrder</type>
			<description>Read Write. A list of column order objects. If the list is empty, no ORDER BY clause was coded.
</description>
		</property>
		
		<property>
			<name>ParseTree</name>
			<type>C</type>
			<description>Read Only. For internal debugging. A string description of the underlying parse tree.</description>
		</property>
		
		<property>
			<name>ResolveColumnTables</name>
			<type>L</type>
			<description>Read Write. Set to .T. if Execute should populate descriptions of tables and columns. This can affect performance.
</description>
		</property>
		
		<property>
			<name>ResultSet</name>
			<type>SQL::ResultSet</type>
			<description>Read Only. Descriptions and/or data from the last Execute or Validate function call.
</description>
		</property>
		
		<property>
			<name>SelectTableReferences</name>
			<type>ReferenceList of SQL::Query::SelectTableReference</type>
			<description>Read Only. An array of all table references in the from clause and those joined to them. This array is created when the property is requested, but can become out of date. Use the Resynch()function on any variable holding this list when any changes are made.
</description>
		</property>
		
		<property>
			<name>SQLStatement</name>
			<type>C</type>
			<description>Read Write. A variable that can be assigned a syntax string without parsing it. If no value is passed to the .Parse()method, this value is used.
</description>
		</property>
		
		<property>
			<name>Table</name>
			<type>List of SQL::Query::SelectTableReference</type>
			<description>Read Write. The items in the FROM clause or in a JOIN clause.
</description>
		</property>
		
		<property>
			<name>TableReferences</name>
			<type>ReferenceList of SQL::Query::SelectTableReference</type>
			<description>Read Only. An array of all table references in the query (including those nested inside of sub-selects and joins). This array is created when the property is requested, but can become out of date. Use the Resynch()function on any variable holding this list when any changes are made.
 </description>
		</property>
		<property>
			<name>TokenTypeName</name>
			<type>C</type>
			<description>"Query"</description>
		</property>
		<property>
			<name>Union</name>
			<type>List of SQL::Query::Union</type>
			<description>Read Write. A list (could be empty) of UNION clauses with their respective queries.
</description>
		</property>
		<property>
			<name>Where</name>
			<type>SQL::Query::LogicalExpression</type>
			<description>Read Write. An expression for the WHERE clause.
</description>
		</property>
		<property>
			<name>XML</name>
			<type>C</type>
			<description>Read Write. Creates XML from the tree or recreates the tree from the XML.
</description>
		</property>
		
	</properties>
	
	<methods>
		<methodref>
			<name>Execute</name>
			<ref href="/documentation/index?search=SQL::Query::Execute Function">Execute</ref>
			<description>Executes the current statement using the current or passed connection.</description>
		</methodref>
		<methodref>
			<name>Format</name>
			<ref href="/documentation/index?search=SQL::Query::Format Function">Format</ref>
			<description>Formats a SQL statement, optionally placing each element on a separate line.</description>
		</methodref>
		<methodref>
			<name>GenerateNativeSyntax</name>
			<ref href="/documentation/index?search=SQL::Query::GenerateNativeSyntax Function">GenerateNativeSyntax</ref>
			<description>Generates a native SQL statement using the selected syntax associated with the current or passed connection.</description>
		</methodref>
		<methodref>
			<name>OpenConnection</name>
			<ref href="/documentation/index?search=SQL::Query::OpenConnection Function">OpenConnection</ref>
			<description>Generates a native SQL statement using the selected syntax associated with the current or passed connection. </description>
		</methodref>
		<methodref>
			<name>Parse</name>
			<ref href="/documentation/index?search=SQL::Query::Parse Function">Parse</ref>
			<description>Parses the SQL statement passed (or the value previously set into the .SQLStatement property).</description>
		</methodref>
		<methodref>
			<name>ReleaseConnection</name>
			<ref href="/documentation/index?search=SQL::Query::ReleaseConnection Function">ReleaseConnection</ref>
			<description>Clears out the connection property.</description>
		</methodref>
		<methodref>
			<name>Reset</name>
			<ref href="/documentation/index?search=SQL::Query::Reset Function">Reset</ref>
			<description>Resets the query as if it had just been created.</description>
		</methodref>
		<methodref>
			<name>Validate</name>
			<ref href="/documentation/index?search=SQL::Query::Validate Function">Validate</ref>
			<description>Executes the current statement using the current or passed connection.</description>
		</methodref>
	</methods>
	<see>
		<ref>SQL Objects</ref>
		<ref>SQL Enumerated Types</ref>
	</see>
	<links>
		<link href="Assignment/index.xml">SQL::Query::Assignment Object</link>
		<link href="ColumnOrder/index.xml">SQL::Query::ColumnOrder Object</link>
		<link href="ColumnReference/index.xml">SQL::Query::ColumnReference Object</link>
		<link href="GroupBy/index.xml">SQL::Query::GroupBy Object</link>
		<link href="Join/index.xml">SQL::Query::Join Object</link>
		<link href="LogicalExpression/index.xml">SQL::Query::LogicalExpression Object</link>
		<link href="ReplaceOption/index.xml">SQL::Query::ReplaceOption Object</link>
		<link href="SelectItem/index.xml">SQL::Query::SelectItem Object</link>
		<link href="SelectTableReference/index.xml">SQL::Query::SelectTableReference Object</link>
		<link href="TableReference/index.xml">SQL::Query::TableReference Object</link>
		<link href="Union/index.xml">SQL::Query::Union Object</link>
		<link href="ValueExpression/index.xml">SQL::Query::ValueExpression Object</link>
		<link href="SQL Query ArithmeticOperator Enumerated Type.xml">SQL::Query::ArithmeticOperator Enumerated Type</link>
		<link href="SQL Query DuplicateOption Enumerated Type.xml">SQL::Query::DuplicateOption Enumerated Type</link>
		<link href="SQL Query LogicalOperator Enumerated Type.xml">SQL::Query::LogicalOperator Enumerated Type</link>
		<link href="SQL Query Order Enumerated Type.xml">SQL::Query::Order Enumerated Type</link>
		<link href="SQL Query OuterJoinType Enumerated Type.xml">SQL::Query::OuterJoinType Enumerated Type</link>
	</links>
</page>