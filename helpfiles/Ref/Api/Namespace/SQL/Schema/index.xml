<page api="xb">
	<shortlink>api sql namespace schema object</shortlink>
	<topic>SQL::Schema Object</topic>
	<description>SQL::Schema Object properties and methods.</description>
	<properties>
		<property generated="true">
			<name>XML</name>
			<type>C</type>
			<description>Type: "C", The schema in XML format.</description>
		</property>
		<property generated="true" readonly="true">
			<name>Name</name>
			<type>C</type>
			<description>Type: "C", The unique name of the table. Note: The table must be unique for the owner, but may not be globally unique.</description>
		</property>
		<property generated="true" readonly="true">
			<name>NativeAPI</name>
			<type>C</type>
			<description>Type: "C", The name of the API active when this object was created. </description>
		</property>
		<property generated="true" readonly="true">
			<name>NativeSyntax</name>
			<type>C</type>
			<description>Type: "C", The name of the syntax at the time the object was created.</description>
		</property>
		<property generated="true" readonly="true">
			<name>Comment</name>
			<type>C</type>
			<description>Type: "C", The comment stored for the table (if the database supports it).</description>
		</property>
		<property generated="true" readonly="true">
			<name>Owner</name>
			<type>C</type>
			<description>Type: "C", The SQL database user or group that owns the table.</description>
		</property>
		<property generated="true">
			<name>Catalog</name>
			<type>C</type>
			<description>Type: "C", String Catalog property</description>
		</property>
		<property generated="true">
			<name>Schema</name>
			<type>C</type>
			<description>Type: "C", String Schema property</description>
		</property>
		<property generated="true" readonly="true">
			<name>Table</name>
			<type>P</type>
			<description>Type: "P", An array of table ( SQL::TableInfo ) definitions.</description>
		</property>
		<property generated="true" readonly="true">
			<name>TableInDependencyOrder</name>
			<type>P</type>
			<description>Type: "P", An array of table ( SQL::TableInfo ) definitions ordered from the top of the dependency hierarchy.</description>
		</property>
		<property generated="true">
			<name>CallResult</name>
			<type></type>
			<description>CallResult property</description>
		</property>
	</properties>
	<methods>
		<methodref>
			<name>AddTable</name>
			<ref link="sql::schema::addtable function">AddTable</ref>
			<description>Add a table to the database.</description>
		</methodref>
		<methodref generated="true">
			<name>Clear</name>
			<ref link="sql::schema::clear function">Clear</ref>
			<description>Clear out existing entries.</description>
		</methodref>
		<methodref>
			<name>Clone</name>
			<ref link="sql::schema::clone function">Clone</ref>
			<description>Make a copy of the SQL::Schema object and its properties.</description>
		</methodref>
		<methodref generated="true">
			<name>CreateTables</name>
			<ref link="SQL::Connection::GenerateCreateTableStatement Function">CreateTables</ref>
			<description>Creates all tables in the schema in the database identified by the connection optionally dropping existing tables.</description>
		</methodref>
		<methodref generated="true">
			<name>DeleteTable</name>
			<ref>DeleteTable</ref>
			<description>Delete a Table.</description>
		</methodref>
		<methodref generated="true">
			<name>DropTables</name>
			<ref>DropTables</ref>
			<description>Drops all tables in the schema from the database.</description>
		</methodref>
		<methodref generated="true">
			<name>GenerateCreateScript</name>
			<ref>GenerateCreateScript</ref>
			<description>Generate a script to create the tables in the schema.</description>
		</methodref>
		<methodref generated="true">
			<name>GenerateDropScript</name>
			<ref>GenerateDropScript</ref>
			<description>Generate a script to drop the tables in the schema.</description>
		</methodref>
		<methodref generated="true">
			<name>ListTables</name>
			<ref link="sql::schema::listtables function">ListTables</ref>
			<description>Return a list of tables in the current cache for the current database.</description>
		</methodref>
		<methodref generated="true">
			<name>ListTablesWithTypes</name>
			<ref link="sql::schema::listtableswithtypes function">ListTablesWithTypes</ref>
			<description>Return a list of tables for the current database suffixed with (<![CDATA[<type>]]>).</description>
		</methodref>
		<methodref generated="true">
			<name>LoadCurrentDBFDatabase</name>
			<ref>LoadCurrentDBFDatabase</ref>
			<description>Clear any current information and load the schema from the open DBF database.</description>
		</methodref>
		<methodref generated="true">
			<name>TableInDependencyOrderNumber</name>
			<ref>TableInDependencyOrderNumber</ref>
			<description>Get the index of a TableInDependencyOrder from the name.</description>
		</methodref>
		<methodref generated="true">
			<name>TableNumber</name>
			<ref link="SQL::Schema::TableNumber Function">TableNumber</ref>
			<description>Get the index of a Table from the name.</description>
		</methodref>
		<methodref generated="true">
			<name>TablesReferencedBy</name>
			<ref link="SQL::Schema::TablesReferencedBy Function">TablesReferencedBy</ref>
			<description>Generate a collection of tables referenced by this table.</description>
		</methodref>
		<methodref generated="true">
			<name>TablesReferencing</name>
			<ref link="SQL::Schema::TablesReferencing Function">TablesReferencing</ref>
			<description>Generate a collection of tables that reference this table.</description>
		</methodref>
		<methodref generated="true">
			<name>ToExcel</name>
			<ref>ToExcel</ref>
			<description>Create an Excel 2003 workbook with a sheet for each table in the schema.</description>
		</methodref>
		<methodref generated="true">
			<name>UpdateStatistics</name>
			<ref link="sql::schema::UpdateStatistics function">UpdateStatistics</ref>
			<description>Gather statistical information about the actual tables in the schema.</description>
		</methodref>
	</methods>
	
<description>A SQL::Schema object (a database description) is a container for one or more SQL::TableInfo objects (table descriptions).</description>
<discussion>This example creates an array containing five SQL::TableInfo objects.</discussion>
<sections><section>
<note>As of the writing of this help topic, it is impossible to DIM an array of objects based on a class. The following code sample shows a work-around.</note>
</section><section>
<example><![CDATA[
dim ti as SQL::TableInfo
dim arr[5] as P
arr[1] = ti
for i = 2 to 5
    arr[i] = ti.clone()
next i
]]></example>
	</section>
<section>
<note>The TableInDependencyOrder property lists all tables in the order they should be created and populated in copying them to a new database.
</note>

</section>
	
	
	
	</sections>
	
	
	<sections>
	<section><title>Example</title>
	<description>This example interactive window session shows how to use the sql::schema object and the tablesReferencing and tablesReferencedBy methods of the sql::schema object.
The connection string is pointing to a SQL Server version of Northwind. 
</description>
	<example><![CDATA[
dim cn as sql::connection 
 ?cn.open("::Name::nw")
 = .T.
 dim s as sql::Schema
 ?cn.GetSchema(s)
 = .T.

 ?s.TableNumber("customers")
 = 2
 dim tiCustomer as sql::TableInfo
 tiCustomers = s.table[2]
 r1 = s.TablesReferencedBy(tiCustomers)
 ?r1.table.count 
 = 0
 r2 = s.TablesReferencing(tiCustomers)
 ?r2.table.Count
 = 1
 ?r2.table1.name 
 = "Orders"
 dim tiOrders as sql::TableInfo 
 ?s.tableNumber("orders")
 = 5
 tiOrders = s.table[5]
 r3 = s.TablesReferencedBy(tiOrders)
 ?r3.Table.count 
 = 3
 ?r3.table[1].name 
 = "Customers"
 ?r3.table[2].name 
 = "Employees"
 ?r3.table[3].name 
 = "Shippers"
 r4 = s.TablesReferencing(tiOrders)
 ?r4.Table.count 
 = 1

 ?r4.table[1].name 
 = "Order Details"
	]]></example>
	
	
	</section>
	</sections>
	
	
	
	
	
	
   
	<see>
		<ref link="SQL Namepsace">SQL</ref>
	</see>
	
	
<terms>sql,array,collection,container,containers,database,dbf,excel,help,index,list,object,script,session,sql database,string,time,users,window,writing,xml</terms>
	
	
</page>