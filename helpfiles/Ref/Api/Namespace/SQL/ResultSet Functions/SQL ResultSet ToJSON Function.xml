<page>
   <topic>SQL::ResultSet::ToJSON Function</topic>
   <prototypes><prototype>Result_Flag as L = .ToJSON([ RowsToCopy = -1 as N [, StartRow = -1 as N [, ReferenceColumns as SQL::TableInfo [, UserContext as P]]]])</prototype>
<prototype><![CDATA[Result_Flag as L = .ToJSON( Query as C [,  as SQL::Arguments ] [, RowsToCopy as N [, StartRow as N [, ReferenceColumns as SQL::TableInfo [, UserContext as P ]]]] )]]></prototype>   
   
   </prototypes>
   
   
   
   
   <arguments>
   <argument>
         <name>Result_Flag</name>
         <description>TRUE (.T.) if the operation was successful; otherwise FALSE (.F.).
</description>
     </argument>
     <argument>
         <name>SQL::ResultSet</name>
         <description>A SQL::ResultSet object.
</description>
     </argument>
      <argument>
         <name>Query
</name>
         <description>A SQL SELECT statement.

</description>
     </argument>
      <argument>
         <name>SQL::Arguments</name>
         <description>Optional. A SQL::Arguments object. One or more arguments to be resolved when the SELECT statement is executed.

</description>
     </argument>
     
     
     
   
     <argument>
         <name> RowsToCopy</name>
         <description>Optional. Default = -1 (all). The number of rows to copy.
</description>
     </argument>
     <argument>
         <name> StartRow</name>
         <description>Optional. Default = -1 (current). The first row to copy.
</description>
     </argument>
     <argument>
         <name> ReferenceColumns</name>
         <description>Optional. A SQL::TableInfo object. When data is formatted for a column in the result set: (1) if ReferenceColumns has a column with a matching name, that object will be used to format the data; (2) otherwise the ColumnInfo property of the result set is used to format the data.
</description>
     </argument>
     <argument>
         <name> UserContext</name>
         <description>
Optional. The user context is passed into the evaluation of the expression when data is formatted.
 </description>
     </argument>
   </arguments>
   <description>Convert a ResultSet to a JSON formatted string.
</description>
   <discussion>
The ToJSON() method converts the data in one or more rows to an implementation of JavaScript Object Notation format specific to the Alpha Five AJAX implementation.
The function formats the data in column major order with indexes to map the rows using objects for each column with index, name, value and (optionally) HREF tags.
You can control column data formatting with . If the named expression HREF is defined for a column, the function will generate the HREF tag using the expression provided. If ExternalFileNameExpression is set, the data will be stored to a file as well.

  
   </discussion>
  <limitations>Desktop applications only prior to Version 9 Platinum.</limitations>
   <see>
      <ref>SQL::ResultSet Object</ref>
      <ref>SQL ResultSet::ToJSONObjectSyntax Function</ref>
     
   </see>
<terms>sql,ajax,arguments,column,control,data formatting,defaults,expressions,file,formatting,function,javascript,map,number,object,operation,query,users</terms>
</page>