<page>
   <topic>List Control Actions</topic>
   <description>Perform some action on a List control (e.g. refresh the List, etc.)</description>
   
   <sections>
     
           <section>
            <description>Used with the UX component.</description>
       </section>
       
        <section>
            <title>Export Data to Excel or Ascii</title>
            <description>You can export data in a List control to either Excel or to Ascii files.</description>
    <videos>
      <video>
        <description>Watch Video</description>
        <link>http://www.ajaxvideotutorials.com/V12Videos/ux_list_export_data_to_excel.swf</link>
      </video>
      
    </videos>
    
  </section>
  <section>
    <description>After the export file has been created you can either download the file to the client, or call an Xbasic function to further process the exported file. A typical use case where you might want to call an Xbasic function to process the exported file would be if you wanted to email the file to a list of recipients, or upload the file to cloud storage, such as Amazon S3 storage.
In the case where the List is based on a SQL query you have the option of:
</description>
    <cases>
      <case>
        <description>exporting the data in the List 
</description>
      </case>
        <case>
        <description>exporting the data in the List query
</description>
      </case>
      
    </cases>
  </section>
   <section>
    <description>Consider the case where you have defined a List and have turned on the pagination feature. You might have set the page size to 100 rows. The query that the List is based on might have 1,000 records, but the List will only show 100 rows of data at a time. If the export is based on the 'Data in the List' the export file will have 100 rows in it (because the List only has one page of data - 100 rows - in memory at any time). However, if the export is based on 'Data in the List Query' the export file will have 1,000 rows in it (subject to the Max Records setting which might limit the number of rows in the export file).
To export data in a List you can use Action Javascript to define the code.
</description>
    <steps>
      <step>
        <description>Select the 'List Control Actions' in Action Javascript
</description>
        <figure><link>images/listExportExcel_1.jpg</link></figure>
      </step>
         <step>
        <description>Select the 'Export List data to Excel/Ascii' action from the list of available actions.
</description>
        <figure><link>images/listExportExcel_2.jpg</link></figure>
      </step>
         <step>
        <description>Click the smart field to define the 'Export list data settings'.
</description>
      
      </step>
      
    </steps>
  </section>
  <section>
    <description>In the case where the List is based on a SQL query, the builder shows the 'Export what' property which can be set to 'Data in List query' or 'Data shown in List'.
If the 'Export what' property is set to 'Data in List query' the 'Maximum number of records to export' property is shown.
</description>
      <figure><link>images/listExportExcel_3.jpg</link></figure>

  </section>
    <section>
    <description>In the case where the 'Export what' property is set to 'Data shown in List' or if the List is not based on a SQL query (in which case the data that is exported is always the 'Data shown in List'), the 'Customize field sizes and column heading in export file' property is shown. 
</description>
     <note>The 'Customize field sizes and column heading in export file' property is only shown if the 'Export format' is Excel.</note>
  </section>
  <section>
    <description>This property allows you to customize the column headings in the Excel file and control the data types of the data in the excel file.
</description>
      <figure><link>images/list_export_customizefieldsproperty.jpg</link></figure>
    
  </section>
   <section>
    <description>To customize fields, click the smart field for the 'Customize field sizes and column heading in export file' property.
A build opens up where you can enter a CR-LF delimited list of definition - one for each field  you want to customize.
The syntax for the definition can be shown by clicking the 'Show syntax help' hyperlink.
The syntax allows you to specify the data type, size and column heading of each column in the Excel file.
</description>
      <figure><link>images/listExport_customizeColumns.jpg</link></figure>
    
  </section>
       
       
       
   </sections>
   
   
   
   
</page>