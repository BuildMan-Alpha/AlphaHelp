<page>
	<topic>Office Example: Spreadsheet with picture</topic>
	<sections><section>
	
	<description>This example creates a simple spreadsheet and adds a picture to the workbook, then sets the picture into a cell of the spreadsheet
</description>
	
	<example><![CDATA[
dim DocumentFile as C = "c:\temp\flower.xlsx"
 
dim Doc    as office::ExcelDocument
Dim Sheet  as Office::Spreadsheet
dim Picture as B
dim Id    as N
 
'Here we add a picture from a blob (first loading the file from disk)
'Note: This example shows how to set a blob containing a picture into a workbook.
'You could also call Doc.AddPicture(FileName), but then we couldn't show you 
'   how to load a picture from a blob.
Picture = File.To_Blob(a5.get_exe_path(( \
          + "\Samples\WebAppServerDemo\Hires\Daffodils.jpg"(
Id = Doc.AddPicture(Picture(
 
Sheet = Doc.AddSheet("Picture"(
Sheet.SetPicture(1,1,Id(
 
Path = File.FileName_Parse(DocumentFile, "P"(
on error resume next
File.Dir_Create(Path(
on error goto 0
if Doc.Save(DocumentFile(
'Release all references to the document so we can open it in Excel
  delete Doc
  Sys_Open(DocumentFile(
else  
  UI_Msg_Box("Error Saving Document", \
                   "Unable to save document to " \
                  + DocumentFile + ":" + crlf(2( + Doc.ErrorMessage(
end if	 ]]></example>
	</section></sections>
	<see>
		<ref>Office</ref>
	
	</see>
	
</page>