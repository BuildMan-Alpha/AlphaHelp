<page>
   <topic>SQL::Connection::LastInsertedIdentity Function</topic>
   <syntax>A LastInsertedIdentity([TableInfo as SQL::TableInfo])</syntax>
   <arguments>
   <argument>
         <name>SQL::Connection</name>
         <description>A SQL::Connection object.
</description>
     </argument>
     
     
     <argument>
         <name>TableInfo</name>
         <description>A SQL::TableInfo object.
</description>
     </argument>
   </arguments>
   <description>Get the identity value from the last insert for the current session.</description>
   <discussion>
The LastInsertedIdentity() method retrieves the last identity value generated for an insert on the currently open connection.
   </discussion>
  <sections>
       <section>
<list>
<item>
<name>1. This is current connection specific for most databases. For databases that use sequences to maintain identity (such as Oracle), the sequence may not be correct after the transaction has been completed.</name>
</item>

<item>
<name><![CDATA[2. For databases that use sequences to generate identities <TableInfo> is a required parameter. It must include an identity column in its definition. That column must specify the sequence name to be used.]]></name>
</item>


</list>



       </section>
   </sections>
   
   
   
   <sections>
       <section><title>Note</title>
            <description>Cn.CallResult.LastInsertedIdentity is always preferable to Cn.LastInsertedIdentity() after an INSERT is executed</description>

       </section>
   </sections>
   <see>
      <ref>SQL::Connection Object</ref>
   </see>
 <terms>sql,connection,database,function,insert,object,transactions</terms>
</page>