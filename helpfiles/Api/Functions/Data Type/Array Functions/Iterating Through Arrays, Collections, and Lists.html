	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline" >
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Iterating Through Arrays, Collections, and Lists</p>



<p>You will frequently find yourself working with groups of data elements 
 outside of a table. Xbasic provides tools for working with data in three 
 formats:</p>




<div align=center>
<table style="x-cell-content-align: top;
				float: aligncenter;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">&nbsp;</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Data&nbsp;Type</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Dimensions</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Comment</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Lists</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">Character</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">1</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">Data elements typically separated by CR and LF characters 
 or other distinct characters. Refer tofor more information.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Arrays</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">Any</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">Multiple</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">Alpha Anywhere organizes data elements. You find data by specifying 
 one or more index values.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Collections</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">Any</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">1</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">Alpha Anywhere organizes data elements. You find and retrieve 
 data by using a key value.</td></tr>
</table>
</div>
<p class=A5>Iterating Through Arrays</p>



<p>The simplest way to reference the data elements in an array is to specify 
 index (or subscript values). You can read or write data elements with 
 a simple assignment operation (=).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chessboard[8,8]&nbsp;as&nbsp;P</p>


<p class=Code>dim i&nbsp;as&nbsp;N</p>


<p class=Code>dim k&nbsp;as&nbsp;N</p>


<p class=Code>dim count&nbsp;as&nbsp;N = 0</p>


<p class=Code>for i = 1 to 8</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for k = 1 to 8</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = count 
 + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (mod(count,2) 
 = 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chessboard[i,k].color 
 = "Red"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chessboard[i,k].color 
 = "Black"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next k</p>


<p class=Code>next i</td></tr>
</table>

<p>If you do not know the size of an array, the size method will provide 
 it. This example returns the size of the second dimension of the <span 
 class=Code1>chessboard</span> variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chessboard[8,8]&nbsp;as&nbsp;P</p>


<p class=Code>? chessboard.size(2)</p>


<p class=Code>= 8</td></tr>
</table>

<p>The <a href="/Desktop_Api/Internal Use Only/__STAR__FOR_EACH Function.xml" title="*FOR_EACH Function" class="wiki">*FOR_EACH(</a>) function 
 is useful for looping through an array when you do not know its size.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim va[5]&nbsp;as&nbsp;P</p>


&nbsp;
<p class=Code>va[1].firstname = "Larry" <br>
va[1].lastname = "Jones" <br>
va[2].firstname = "Sue" <br>
va[2].lastname = "Brown" <br>
va[3].firstname = "Toby" <br>
va[3].lastname = "Smith" <br>
va[4].firstname = "Bob" <br>
va[4].lastname = "Saget" <br>
va[5].firstname = "Mary" <br>
va[5].lastname = "Johnson" <br>
<br>
<br>
vList = *for_each(x,"Dear "+x.firstname + " " + x.lastname,va) 
 <br>
? vlist <br>
= Dear Larry Jones <br>
Dear Sue Brown <br>
Dear Toby Smith <br>
Dear Bob Saget <br>
Dear Mary Johnson</td></tr>
</table>

<p class=A5>Iterating Through Collections</p>



<p>The following script shows how to read the data elements in a collection. 
 First, create a collection.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim mycollection&nbsp;as&nbsp;u</p>


<p class=Code>mycollection.SET("FJ","Fred Jones")</p>


<p class=Code>mycollection.SET("BB","Bryan Boyd")</p>


<p class=Code>mycollection.SET("KL","Kim Lee")</p>


<p class=Code>mycollection.SET("KB","Karen Boyd")</p>


<p class=Code>mycollection.SET("EL","Erica Loyd")</td></tr>
</table>

<p>Now, read and display each value. Working with a collection is similar 
 to working with an indexed table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim k&nbsp;as&nbsp;N</p>


<p class=Code>dim i&nbsp;as&nbsp;N = 1</p>


<p class=Code>dim keyval&nbsp;as&nbsp;C</p>


<p class=Code>dim currentval&nbsp;as&nbsp;C</p>


<p class=Code>k = mycollection.size()</p>


<p class=Code>keyval = mycollection.first()</p>


<p class=Code>currentval = mycollection.get(keyval)</p>


<p class=Code>ui_msg_box("", currentval)</p>


<p class=Code>while (i < k)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;keyval = mycollection.next(keyval)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentval = mycollection.get(keyval)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;i = i + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("", currentval)</p>


<p class=Code>end while</td></tr>
</table>

<p>Use the <a href="/Api/Functions/Data Type/Collection Functions/COLLECTION.SET Method.xml" title="COLLECTION.SET Method" class="wiki">&lt;COLLECTION&gt;.SET(</a>) 
 method to change a data element in a collection. If the specified key 
 value exists, the method changes the data element. If the key does not 
 exist, the method adds a new data element to the end of the collection.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim currentval&nbsp;as&nbsp;C</p>


<p class=Code>dim newval&nbsp;as&nbsp;C</p>


<p class=Code>i = 1</p>


<p class=Code>keyval = mycollection.first()</p>


<p class=Code>currentval = mycollection.get(keyval)</p>


<p class=Code>newval = currentval + " new"</p>


<p class=Code>mycollection.set(keyval, newval)</p>


<p class=Code>ui_msg_box("",mycollection.get(keyval))</p>


<p class=Code>while (i < k)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;keyval = mycollection.next(keyval)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentval = mycollection.get(keyval)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;newval = currentval + " new"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;mycollection.set(keyval, newval)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;i = i + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("", mycollection.get(keyval))</p>


<p class=Code>end while</td></tr>
</table>

<p class=A5>Iterating Through Lists</p>



<p>The following script shows how to use <a href="/Desktop_Api/Internal Use Only/__STAR__FOR_EACH Function.xml" title="*FOR_EACH Function" class="wiki">*FOR_EACH(</a>) 
 to step through the elements in a CR-LF delimiter list.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim lst1&nbsp;as&nbsp;C</p>


<p class=Code>dim lst2&nbsp;as&nbsp;C</p>


<p class=Code>lst1 = cstates("S"+ crlf())</p>


<p class=Code>lst2 = *for_each(x, left(x,3), lst)</p>


<p class=Code>? lst1</p>


<p class=Code>= Alabama</p>


<p class=Code>Alaska</p>


<p class=Code>Arizona</p>


<p class=Code>Arkansas</p>


<p class=Code>California</p>


<p class=Code>Colorado</p>


<p class=Code>...</p>


<p class=Code>? lst2</p>


<p class=Code>= Ala</p>


<p class=Code>Ala</p>


<p class=Code>Ari</p>


<p class=Code>Ark</p>


<p class=Code>Cal</p>


<p class=Code>Col</p>


<p class=Code>...</td></tr>
</table>

<p>The following script uses a <a href="../../../Platform/Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR   EACH ... NEXT</a> to step through elements of a list.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim lst1&nbsp;as&nbsp;C</p>


<p class=Code>dim lst2&nbsp;as&nbsp;C</p>


<p class=Code>lst1 = cstates("S"+ crlf())</p>


<p class=Code>for each x in lst1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lst2 = lst2 + left(x,3) + crlf()</p>


<p class=Code>next</p>


<p class=Code>? lst2</p>


<p class=Code>= Ala</p>


<p class=Code>Ala</p>


<p class=Code>Ari</p>


<p class=Code>Ark</p>


<p class=Code>Cal</p>


<p class=Code>Col</p>


<p class=Code>...</td></tr>
</table>

<p>The following script shows how to use <a href="/Api/Functions/Data Type/Character Functions/Counting Functions/LINE_COUNT Function.xml" title="LINE_COUNT Function" class="wiki">LINE_COUNT(</a>) 
 to determine the size of a list and extract its elements with <a href="/Api/Functions/Data Type/Character Functions/Search Functions/WORD Function.xml" title="WORD Function" class="wiki">WORD(</a>).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim lst1&nbsp;as&nbsp;C</p>


<p class=Code>dim lst2&nbsp;as&nbsp;C</p>


<p class=Code>dim line&nbsp;as&nbsp;C</p>


<p class=Code>dim k&nbsp;as&nbsp;N</p>


<p class=Code>lst1 = cstates("S"+ crlf())</p>


<p class=Code>k = line_count(lst1)</p>


<p class=Code>for i = 1 to k</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;line = word(lst1, i, crlf())</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lst2 = lst2 + left(line,3) + crlf()</p>


<p class=Code>next i</p>


<p class=Code>? lst2</p>


<p class=Code>= Ala</p>


<p class=Code>Ala</p>


<p class=Code>Ari</p>


<p class=Code>Ark</p>


<p class=Code>Cal</p>


<p class=Code>Col</p>


<p class=Code>...</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="/Server/Reference/Design/Platform/Xbasic/Reference/Arrays.html" title="Arrays" class="wiki">Arrays</a>, <a href="/Server/Reference/Design/Platform/Xbasic/Collections.html" title="Collections" class="wiki">Collections</a>, 
 <a href="/Api/Functions/Data Type/Character Functions/List Processing Functions/index.xml" title="List Processing Functions" class="wiki">List Processing Functions</a>, 
 <a href="../Collection/Collection Methods.html" title="Collection Methods" class="wiki">Collection Methods</a>, <a href="Array Functions and Methods.html" title="Array Functions and Methods" class="wiki">Array   Functions and Methods</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Iterating+Through+Arrays%2C+Collections%2C+and+Lists">-->


	<div class="wikitopline" >
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"accept"}--->
</body></html>