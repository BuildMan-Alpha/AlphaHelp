	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Field Rule Record Events</p>

<p>When defining field rules for a table, there are two types of field 
 rule events to which a script can be attached: <span class=Bolded><a href="Field Rule Field Events.html" title="Field Rule Field Events" class="wiki">Field   events</a></span> and <span class=Bolded>Record</span> events.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : To edit record 
 events in the <span class=Screen>Code Editor</span>, select the table 
 name in the "Container" combo box.&nbsp;Record events are triggered 
 when records are entered, changed, deleted, marked, or unmarked.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Record changes 
 made through a web component do <span class=Bolded>not</span> trigger 
 record events.</p>




<div align=center>
<table style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Event Name</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Occurs</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=RecordCanChangeRecord>CanChangeRecord</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before entering Change mode.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=Recordon<x>changeRecord>on<x>changeRecord</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After entering Change mode.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>CanDeleteRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before deleting a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>OnDeleteRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After deleting a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>CanEnterRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before moving to the new record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>OnEnterRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After moving to the new record</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>CanMarkRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before marking a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>OnMarkRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After marking a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=RecordCanSaveRecord>CanSaveRecord</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before saving a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=RecordOnSaveRecord>OnSaveRecord</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After saving a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>CanUnmarkRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before unmarking a record.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>OnUnmarkRecord</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After unmarking a record.</td></tr>
</table>
</div>
<p>To make a record read-only in certain conditions, add code to the <span 
 class=Code1>CanChangeRecord</span> event that executes the <a href="../../../Functions/CANCEL Function.html" title="CANCEL Function" class="wiki">CANCEL(</a>) 
 function if those conditions are true.</p>



<p class=A5>The A_DELETING_RECORD Variable - Useful in Change and Save 
 Events</p>



<p>To Alpha Five, changing the value in a field, and deleting a record, 
 are both changes to the current record, and both actions trigger the Change 
 and Save record events. This makes it impossible to distinguish between 
 an effort by the user to change a record, or delete the current record. 
 The reason for this is that a record is "deleted" by changing 
 the value in a special "hidden" field in the record.</p>



<p>The <span class=Code1>A_DELETING_RECORD</span> variable allows you to 
 distinguish between deleting and changing a value in a field. <span class=Code1>A_DELETING_RECORD</span> 
 is set to .T. during a record delete, and to .F. when the record is being 
 edited.</p>



<p>With this variable, you can write scripts that do something when the 
 user makes a change to a field value, but not when they delete the record.</p>



<p>For example, the following <span class=Code1>on<x>change</span> event script 
 shows how you would use the variable:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if .not. A_DELETING_RECORD then</p>


<p class=Code>'....perform actions normally associated with a record change</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>How to Tell if a Record is Being Deleted</p>



<p>If you would like a script to run if a record is being deleted, or if 
 you would like to prevent a record deletion, put this code in the <span 
 class=Code1>CanDeleteRecord</span> event of your form.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (A_DELETING_RECORD = .T.) then</p>


<p class=Code>' ... put your code here</p>


<p class=Code>' or if you want to cancel the delete, call CANCEL()</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../../../Functions/CANCEL Function.html" title="CANCEL Function" class="wiki">CANCEL(</a>), <a href="Field Rule Field Events.html" title="Field Rule Field Events" class="wiki">Field   Rule Field Events</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Field+Rule+Record+Events">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf"} --->
</body></html>