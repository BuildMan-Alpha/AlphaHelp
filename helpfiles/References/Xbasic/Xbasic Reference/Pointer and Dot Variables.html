	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Pointer and Dot Variables</p>

<p class=A5><a name=Defining_Dot_Variables>Defining Dot Variables</a></p>

<p>Alpha Five allows you to define <a href="../../../Unclassified/Variable Scope.html#Pointers___More_Information" title="Variable Scope" class="wiki">pointer</a> 
 variables with sub-elements, so called "dot" variables. Dot 
 variables can have multiple layers of sub-elements. The general syntax 
 for a pointer variable is&nbsp;as&nbsp;follows:</p>

<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim MyPointer&nbsp;as&nbsp;P</p>


<p class=Code>dim MyPointer.character_data&nbsp;as&nbsp;C</p>


<p class=Code>dim MyPointer.logical_data&nbsp;as&nbsp;L</p>


<p class=Code>dim MyPointer.numeric_data&nbsp;as&nbsp;N</p>


<p class=Code>dim MyPointer.date_data&nbsp;as&nbsp;D</p>


<p class=Code>...</p>


<p class=Code>dim MyPointer.MyArray&nbsp;as&nbsp;P</p>


<p class=Code>dim MyPointer.MyArray[1].character_data&nbsp;as&nbsp;C</p>


<p class=Code>...</td></tr>
</table>

<p>In the following case the variable <span class=Code1>Family</span> is 
 <span class=Bolded>implicitly defined</span>&nbsp;as&nbsp;type P (pointer) 
 and the variable <span class=Code1>lastname</span> is implicitly defined&nbsp;as&nbsp;type 
 C (character).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Family.lastname = "smith"</p>


<p class=Code>Family.father = "John"</p>


<p class=Code>Family.mother = "Irene"</p>


<p class=Code>Family.children.child1 = "Tim"</p>


<p class=Code>Family.children.child2 = "Lara"</td></tr>
</table>

<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : While Xbasic 
 allows you to implicitly define variable types, it is considered better 
 programming practice to <a href="../DIM.html" title="DIM" class="wiki">explicitly define</a> 
 variables.</p>



<p>In this case, the variable Family has these sub-elements: <span class=Code1>lastname</span>, 
 <span class=Code1>father</span>, <span class=Code1>mother</span> and <span 
 class=Code1>children</span>. The <span class=Code1>Family.children</span> 
 variable has these sub-elements: <span class=Code1>child1</span> and <span 
 class=Code1>child2</span>.</p>



<p>You can see the sub-elements of a variable by typing the variable name 
 with a question mark in the <span class=Screen>Interactive</span> window.</p>



<p>For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? Family</p>


<p class=Code>= children</p>


<p class=Code>father = "John"</p>


<p class=Code>lastname = "Smith"</p>


<p class=Code>mother = "Irene"</td></tr>
</table>

<p>Or:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? Family.children</p>


<p class=Code>= child1 = "Tim"</p>


<p class=Code>child2 = "Lara"</td></tr>
</table>

<p>The sub-elements of a variable can be of different types. For example, 
 you could delete the <span class=Code1>family.father</span> variable and 
 define the following:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Delete family.father</p>


<p class=Code>Family.father.NAME = "John"</p>


<p class=Code>Family.father.age = 46</td></tr>
</table>

<p>The sub-elements of a variable can also be arrays. For example, you 
 could define the following dot variable:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim family&nbsp;as&nbsp;P</p>


<p class=Code>Family.father = "John"</p>


<p class=Code>Family.mother = "Joan"</p>


<p class=Code>dim family.kids[10]&nbsp;as&nbsp;P</p>


<p class=Code>Family.kids[1].NAME = "Sammy"</p>


<p class=Code>Family.kids[1].age = 4</p>


<p class=Code>Family.kids[2].NAME = "Sonia"</p>


<p class=Code>Family.kids[2].age = 3</p>


<p class=Code>Family.kids[3].NAME = "Samantha"</p>


<p class=Code>Family.kids[3].age = 2</td></tr>
</table>

<p>There is no practical limit to the level of nesting of sub-arrays within 
 a dot variable.</p>



<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : An <a href="Arrays.html" title="Arrays" class="wiki">array   variable</a> is a pointer variable.</p>



<p class=A5><a name=Assigning_Dot_Variables>Assigning Dot Variables</a></p>



<p>When you assign a dot variable to another dot variable, all of the sub-elements 
 of the other dot variable point to the sub-elements of the original dot 
 variable. For example, assume you typed the following into the <span class=Screen>Interactive</span> 
 window (after defining the Family variable&nbsp;as&nbsp;shown above):</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>a = family</p>


<p class=Code>? a.lastname</p>


<p class=Code>= "Smith"</p>


<p class=Code>? a.children.child1</p>


<p class=Code>= "Tim"</p>


<p class=Code>family.lastname = "Jones"</p>


<p class=Code>? family.lastname</p>


<p class=Code>= "Jones"</p>


<p class=Code>? a.lastname</p>


<p class=Code>= "Jones"</td></tr>
</table>

<p>(because "A" simply points to the sub-elements of "family")</p>



<p>You can also use the <a href="../../Functions/PROPERTY_RECURSE_ASSIGN Function.html" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>) 
 function to assign one dot variable to another. When you use this function, 
 instead of pointing to the original dot variable's sub-elements, the new 
 dot variable contains its own copy of each sub-element. For example, assume 
 you typed the following into the <span class=Screen>Interactive</span> 
 window (after defining the Family variable&nbsp;as&nbsp;shown above):</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? family.lastname</p>


<p class=Code>= "Jones"</p>


<p class=Code>'assign at least one sub-element of a new variable B to define 
 it</p>


<p class=Code>b.lastname = ""</p>


<p class=Code>property_recurse_assign(b, family)</p>


<p class=Code>? b.lastname</p>


<p class=Code>= "Jones"</p>


<p class=Code>family.lastname = "Clemmens"</p>


<p class=Code>? family.lastname</p>


<p class=Code>= "Clemmens"</p>


<p class=Code>? b.lastname</p>


<p class=Code>= "Jones"</td></tr>
</table>

<p>(because "B" is its own dot variable. It does not simply point 
 to the sub-elements of "family")</p>



<p>Many of the Alpha Five system variables are "dot" variables. 
 For example, the variables used to define a query, (e.g. <span class=Code1>QUERY.FILTER</span>, 
 <span class=Code1>QUERY.ORDER</span>, <span class=Code1>QUERY.DESCRIPTION</span>, 
 etc.) are all dot variables, and are sub-elements of the <span class=Code1>QUERY</span> 
 variable. Similarly, the variables used to define a copy operation, (e.g. 
 <span class=Code1>COPY.DB</span>, <span class=Code1>COPY.RECORDS</span>, 
 <span class=Code1>COPY.FIELD1</span> etc.) are all sub-elements of the 
 <span class=Code1>COPY</span> variable.</p>



<p class=A5><a name=Using_Pointers_and_Dot_Variables_with_Functions>Using 
 Pointers and Dot Variables with Functions</a></p>



<p>You can pass multiple values to a function when those values are stored&nbsp;as&nbsp;the 
 dot variables of a single pointer.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim ptr&nbsp;as&nbsp;P</p>


<p class=Code>dim ptr.firstname&nbsp;as&nbsp;C</p>


<p class=Code>dim ptr.lastname&nbsp;as&nbsp;C</p>


<p class=Code>dim ptr.phone&nbsp;as&nbsp;C</p>


<p class=Code>display_name(ptr)</td></tr>
</table>

<p>The function below receives a single variable with multiple components.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function display_name&nbsp;as&nbsp;V (myptr&nbsp;as&nbsp;P)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Name and Phone", 
 alltrim(myptr.firstname) + " " + alltrim(myptr.lastname) + " 
 " + myptr.phone)</p>


<p class=Code>end function</td></tr>
</table>

<p class=A5><a name=Returning_Multiple_Values_from_a_Function>Returning 
 Multiple Values from a Function</a></p>

<p>Functions typically return a single value of a single type. However, 
 it possible to return multiple variables from a function. One scenario 
 is&nbsp;as&nbsp;follows:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>the calling function creates 
 a data structure that contains multiple variables (a <a href="Pointer and Dot Variables.html" title="Pointer and Dot Variables" class="wiki">dot   variable</a> or an <a href="Arrays.html" title="Arrays" class="wiki">array</a> )</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>the calling function sends 
 a pointer to the data structure to the receiving function</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>the receiving function 
 manipulates the variables in the data structure </p>

</li>
</ul>

<p class=Pix><img src="images/WPT_Returning_Multiple_Values.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 515px;
							height: 275px;
							border-style: none;
							border-style: none;"
					width=515
					height=275
					border=0></p>



<p>The following sample code in the calling script or function illustrates 
 how this might be done.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim mds&nbsp;as&nbsp;P</p>


<p class=Code>dim mds.firstname&nbsp;as&nbsp;C</p>


<p class=Code>dim mds.lastname&nbsp;as&nbsp;C</p>


<p class=Code>dim mds.age&nbsp;as&nbsp;N</p>


<p class=Code>mds.firstname = "George"</p>


<p class=Code>mds.lastname = "Washington"</p>


<p class=Code>mds.age = 35</p>


<p class=Code>FunctionName(mds)</td></tr>
</table>

<p>The receiving function would have code like this. Note that it can reference 
 the <span class=Code1>mds</span> data structure without actually knowing 
 its true name. Note also that <span class=Code1>FunctionName</span> does 
 not have to do anything to return the changes to the variables.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>FUNCTION FunctionName&nbsp;as&nbsp;V (abc&nbsp;as&nbsp;P)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.firstname = "Abraham"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.lastname = "Lincoln"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.age = 29</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Saving_and_Restoring_Dot_Variables>Saving and Restoring 
 Dot Variables</a></p>



<p>It is common in an application that you will need to save and restore 
 dot variables. For example, assume that you have a dot variable that defines 
 a series of user preferences. There are several techniques that Alpha 
 Five offers for this.</p>



<p>These include:</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Saving dot variables 
 to the system registry using the <a href="../../Methods/REGISTRY.SAVE_SETTINGS Method.html" title="REGISTRY.SAVE_SETTINGS Method" class="wiki">REGISTRY.SAVE_SETTINGS(</a>) 
 method</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Saving dot variables 
 to an Alpha Five library using the <a href="../../Functions/A5_SAVE_SETTINGS Function.html" title="A5_SAVE_SETTINGS Function" class="wiki">A5_SAVE_SETTINGS(</a>) 
 method</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If your dot variable 
 is "complex" (i.e. has nested arrays and sub-arrays) Converting 
 the dot variable to a text string, and then saving the string</p>

</li>
</ol>

<p>There are two Alpha Five functions that are particularly useful for 
 converting a dot variable to and from a text string: <a href="../../Functions/PROPERTY_TO_STRING Function.html" title="PROPERTY_TO_STRING Function" class="wiki">PROPERTY_TO_STRING(</a>) 
 and <a href="../../Functions/PROPERTY_FROM_STRING Function.html" title="PROPERTY_FROM_STRING Function" class="wiki">PROPERTY_FROM_STRING(</a>).</p>



<p class=A5><a name=Storing_and_Retrieving<strong>Dot</strong>Variables_in_Library_Files>Storing 
 and Retrieving "Dot" Variables in Library Files</a></p>



<p>Alpha Five allows you to store "dot" variables in Alpha Five 
 library files ( <span class=Code1>.ALB</span>, <span class=Code1>.DDD</span> 
 and <span class=Code1>.SET</span> files), or in text files.</p>



<p>Certain Alpha Five internal settings that are database specific (such&nbsp;as&nbsp;Backup 
 preferences for a database, or Network Optimize settings) are stored in 
 "dot" variables in the current database's library.</p>



<p>In addition to internal Alpha Five settings, you can also store user 
 defined "dot" variables in libraries.</p>



<p>The <a href="../../Functions/Variable Functions and Methods.html" title="Variable Functions and Methods" class="wiki">Variable Functions   and Methods</a> topic describes the commands to save "dot" variables 
 in libraries, and load "dot" variables from libraries.</p>



<p class=A5><a name=Storing_and_Retrieving<strong>Dot</strong>Variables_in_the_System_Registry>Storing 
 and Retrieving "Dot" Variables in the System Registry</a></p>



<p>Alpha Five allows you to store "dot" variables in the system 
 registry, and to read variables from the system registry into "dot" 
 variables.</p>



<p>"Dot" variables can also be stored in Alpha Five Library files, 
 or in text files. See the <a href="../../Functions/A5_LOAD_SETTINGS Function.html" title="A5_LOAD_SETTINGS Function" class="wiki">A5_LOAD_SETTINGS(</a>) 
 and <a href="../../Functions/A5_SAVE_SETTINGS Function.html" title="A5_SAVE_SETTINGS Function" class="wiki">A5_SAVE_SETTINGS(</a>) 
 methods for details</p>



<p>When you store a "dot" variable in the Registry, Alpha Five 
 automatically stores all of the sub-elements of the "dot" variable 
 in the registry under the key value that you specify, relative to the 
 <span class=Code1>root</span> key. The <span class=Code1>root</span> key 
 is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>HKEY_CURRENT_USER\Software\Alpha Software\Alpha Five 5.0</td></tr>
</table>

<p>If you specify that variables are to be stored under the key value <span 
 class=Code1>UserIdentity</span>, then the variables are stored in this 
 key:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>HKEY_CURRENT_USER\Software\Alpha Software\Alpha Five 5.0\UserIdentity</td></tr>
</table>

<p>For security reasons, Alpha Five does not allow you to store variables 
 outside the root key.</p>



<p>To save "dot" variables in the Registry, use the <a href="../../Methods/REGISTRY.SAVE_SETTINGS Method.html" title="REGISTRY.SAVE_SETTINGS Method" class="wiki">REGISTRY.SAVE_SETTINGS(</a>) 
 method. To load variables from the Registry, use the <a href="../../Methods/REGISTRY.LOAD_SETTINGS Method.html" title="REGISTRY.LOAD_SETTINGS Method" class="wiki">REGISTRY.LOAD_SETTINGS(</a>) 
 method. To delete a key from the Registry, use the <a href="../../Methods/REGISTRY.DROP_SETTINGS Method.html" title="REGISTRY.DROP_SETTINGS Method" class="wiki">REGISTRY.DROP_SETTINGS(</a>) 
 method.</p>



<p class=A5>See Also</p>



<p><a href="What is a Variable__QUESTION__.html" title="What is a Variable?" class="wiki">What is a Variable?</a>, <a href="../../Methods/Registry Methods.html" title="Registry Methods" class="wiki">Registry   Methods</a>, <a href="../../Functions/Variable Functions and Methods.html" title="Variable Functions and Methods" class="wiki">Variable   Functions and Methods</a>, <a href="Arrays.html" title="Arrays" class="wiki">Arrays</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Pointer+and+Dot+Variables">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>