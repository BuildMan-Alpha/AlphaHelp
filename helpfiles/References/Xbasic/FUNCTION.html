	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>FUNCTION</p>
<p class=A5>Syntax</p>
<p>FUNCTION [ BACKGROUND ] <span class=Argument>Function_Name</span> 
 [ as  <span class=Argument>Return_Type</span> ] ( [ [ BYREF ]  
 <span class=Argument>Parameter1</span> [ AS  <span class=Argument>Type1</span> 
 <span class=Optional>|</span> = <span class=Argument>Default_Value1</span> 
 ] [, [ BYREF ]  <span class=Argument>Parameter2</span> [ 
 AS  <span class=Argument>Type2</span> <span class=Optional>|</span> 
 = <span class=Argument>Default_Value2</span> ] [, ... [, [ BYREF ]  
 <span class=Argument>ParameterN</span> [ AS  <span class=Argument>TypeN</span> 
 <span class=Optional>|</span> = <span class=Argument>Default_ValueN</span> 
 ]...]]] ) <br>
    [ statements ] <br>
    [ <span class=Argument>Function_Name</span> = ex<x>pression ] 
 <br>
    [ EXIT FUNCTION ] <br>
END FUNCTION</p>
<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 6.388%;">
<col style="width: 75.271%;">
<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableHead>Description</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft>BACKGROUND</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Optional. Forces a function to run in the background.</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft><span class=Argument>Function_Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>The name of the function. Function names should begin 
 with a letter (A-Z, a-z) and may contain numbers and underscore (_) characters. 
 Although the use of the period (.) character is not prohibited, it may 
 not be supported in future releases of Alpha Anywhere.</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft><span class=Argument>Return_Type</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Required. The data type of the returned variable. See 
 <a href="../../Unclassified/Variable Data Types.html" title="Variable Data Types" class="wiki">Variable Data Types</a>.</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft>BYREF</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Optional. By default FUNCTION passes arguments by value 
 (BYVAL). Use the BYREF keyword to have a function pass an argument by 
 reference (e.g. pass its address).</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft><span class=Argument>Parameter1 ... ParameterN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Optional. A constant, variable, or expression that 
 passes a value to the function. Each <span class=Argument>Parameter</span> 
 must have an associated <span class=Argument>Type</span>.</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft><span class=Argument>Default_Value1 ... Default_ValueN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Optional. The value to use if the value is omitted in 
 the function call. This syntax makes the argument optional.</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 6.388%;" valign="top" width="6.388%">
<p class=TableLeft><span class=Argument>Type1 ... TypeN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 75.271%;" valign="top" width="75.271%">
<p class=TableLeft>Required for each <span class=Argument>Parameter</span>. 
 See <a href="../../Unclassified/Variable Data Types.html" title="Variable Data Types" class="wiki">Variable Data Types</a>.</td></tr>
</table>
<p class=A5>Description</p>
<p>FUNCTION is used to declare a user-defined function. A function declaration 
 specifies the name of the function <span class=Argument>Function_Name</span>, 
 the type of value returned by the function ( <span class=Argument>Return_Type</span> 
 ) and the name ( <span class=Argument>Parameter1 ... ParameterN</span> 
 ) and type ( <span class=Argument>Type</span> ), of values to be passed 
 to the function, if any. The <span class=Argument>Return_Type</span> is 
 defined after the function name, and defaults to numeric (N) if no return 
 type is specified.</p>
<p>The parameter type can be any Alpha Anywhere <a href="../../Unclassified/Variable Scope.html" title="Variable Scope" class="wiki">variable   type</a>. Use the A type when the parameter you pass to the function may 
 be one type in a certain instance and another type in another 'instance. 
 Although function parameters are not required, a function can have one 
 or more defined parameters. The functions parameter names and types are 
 declared inside parentheses, separated by commas. The parameters' types 
 determine what kind of values the function accepts. The declared parameters 
 behave like local variables, remaining defined until the function execution 
 is complete. The functions return value is established by assigning an 
 expression value to the function name. The data type of this value must 
 match the defined <span class=Argument>Return_Type</span>.</p>
<p>By default parameters are passed by value (BYVAL). With Alpha Anywhere version 
 6 it is possible to pass variables BYREF. This means that the receiving 
 function can directly manipulate the variables of the calling function.</p>
<p>Variables declared inside a function remain local to that function unless 
 they are declared with the dim SHARED or dim GLOBAL statement. When the 
 function terminates local variables are destroyed. If the SHARED or GLOBAL 
 variable does not already exist it is created in the function and remains 
 after the function 'terminates. Function execution is terminated when 
 any of the following commands are reached:  EXIT FUNCTION, RETURN, 
 END FUNCTION, or END.</p>
<p>A script can have up to 64 user-defined functions. Functions can call 
 other functions or the same function recursively up to 32 'times. A function 
 defined within a script is a local function. It is only visible to that 
 script. Alpha Anywhere also supports global functions which can be used anywhere 
 in Alpha Anywhere. For information on global functions, see <a href="../Functions/User Defined Functions.html" title="User Defined Functions" class="wiki">How   to Define a Global Function</a>.</p>
<p class=A5>Optional Function Arguments</p>
<p>Function can be defined with optional parameters. To define an optional parameter, you give the parameter a default value in the function prototype. For example:

<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">
<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>
function myfunc as c (var1 as c, var2 as n, var3 = "Name", var4 = 3, var5 = .t., var6 = null_value())</p>
</td></tr>
</table>

<p>In this example, var3, var4, var5 and var6 are all optional parameters.
The data type of optional parameters is automatically inferred from the default value. So, for example, the data type of var4 is Numeric.</p>

<p>Var6 represents an special case where the optional argument will be an object (see examples below).</p>

<p class=Note><span class=Note>
<img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : An optional 
 parameter cannot be followed by a required parameter in the parameter 
 list.</p>
<p>Note that in the example above the last argument, "var6", 
 is given a default value of <a href="../Functions/NULL_VALUE Function.html" title="NULL_VALUE Function" class="wiki">NULL_VALUE(</a>). 
 This indicates that the argument is optional, but its type is not known 
 in advance.</p>
<p class=A5>Examples</p>
<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">
<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>'A simple function that returns a value.
<br>'Notice that the function returns a value by setting the value of a variable that is the same name and data type of the function.
<br>
<br>function sayHello as c (name as c )
<br>&nbsp;&nbsp;&nbsp; sayHello = "Hello: " + name
<br>end function 
<br>
<br>'From the Interactive window:
<br>?sayHello("martin")
<br>= "Hello: martin"
<br>
<br>
<br>'A simple function with an optional argument.
<br>function sayHello as c (name = "")
<br>&nbsp;&nbsp;&nbsp; if name = "" then 
<br>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	sayHello = "Please don't be coy"
<br>&nbsp;&nbsp;&nbsp; else
<br>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	sayHello = "Hello: " + name
<br>&nbsp;&nbsp;&nbsp; end if 
<br>end function 
<br>
<br>'From the Interactive window:
<br>?sayHello("martin")
<br>= "Hello: martin"
<br>?sayHello()
<br> = "Please don't be coy"
<br> 
<br> 
<br> 'A simple function with multiple arguments:
<br> function multiply as n (val1 as n, val2 as n)
<br> &nbsp;&nbsp;&nbsp; dim result as n 
<br> &nbsp;&nbsp;&nbsp; result = val1 * val2
<br> &nbsp;&nbsp;&nbsp; multiply = result 
<br> end function 
<br> 
<br> ?multiply(2,3)
<br> = 6
<br> 
<br> 'A simple function with multiple arguments, and an optional argument.
<br> 'Notice that the return type of the function is now 'a' meaning that the function
<br> 'can return any type of data. It is not limited to character, numeric, logical, etc.
<br> 'Notice that 'format' is an optional parameter, but has been given a default value of .f.
<br> 'The data type (logical) of the default argument was infered automatically from its default value (.f.).
<br> 'Notice also that optional arguments have to follow required arguments. You can't have any required</p>
<p class=Code>' arguments AFTER optional arguments!
<br> 
<br> function multiply as A (val1 as n, val2 as n, format = .f.)
<br>  &nbsp;&nbsp;&nbsp;  dim result as n 
<br>  &nbsp;&nbsp;&nbsp;  result = val1 * val2
<br>  &nbsp;&nbsp;&nbsp;  if format = .f. then 
<br>  	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  	multiply = result 
<br>  &nbsp;&nbsp;&nbsp;  else
<br>  	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  	multiply = alltrimresult,10,2<a href="tiki-editpage.php?page=result%2C10%2C2" title="Create page: result,10,2" class="wiki wikinew str">?</a>
<br>  &nbsp;&nbsp;&nbsp;  end if 
<br>  end function 
<br> 
<br> 'return value is numeric
<br>  ?multiply(2,3)
<br>  = 6
<br> 
<br> 'return value is a character string
<br>  ?multiply(2,3,.t.)
<br>  = "6,00"
<br> 
<br> 
<br> 'When passing in a lot of arguments to a function, use an object (type 'p') as the function argument.
<br> function formatAddress as c (options as p)
<br> 
<br> &nbsp;&nbsp;&nbsp; dim txt as c = ""
<br> &nbsp;&nbsp;&nbsp; txt = txt + options.firstname + " " + options.lastname + crlf()
<br> &nbsp;&nbsp;&nbsp; txt = txt + options.address1 + crlf()
<br> &nbsp;&nbsp;&nbsp; if options.address2 <> "" then 
<br> 	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	txt = txt + options.address2 + crlf()
<br> &nbsp;&nbsp;&nbsp; end if 
<br> &nbsp;&nbsp;&nbsp; txt = options.city + ", " + options.state + " " + options.zip
<br> 
<br> &nbsp;&nbsp;&nbsp; formatAddress = txt
<br> end function 
<br> 
<br> 'from the interactive window
<br> dim o as p
<br> o.firstname = "Martin"
<br> o.lastname = "Smith"
<br> o.address1 = "1 Main St"
<br> o.address2 = ""
<br> o.city = "Burlington"
<br> o.state = "Ma"
<br> o.zip = "01803"
<br> 
<br>?formatAddress(o)
<br>= "Martin Smith
<br>1 Main St
<br>Burlington, MA 01803"
<br>
<br>
<br>'When you want a function to return more than one value, have the function return an object.
<br>
<br>function parseName as p (fullname as c )
<br>&nbsp;&nbsp;&nbsp; dim fn as c
<br>&nbsp;&nbsp;&nbsp; dim ln as c 
<br>&nbsp;&nbsp;&nbsp; fn = word(fullname,1)
<br>&nbsp;&nbsp;&nbsp; ln = word(fullname,2)
<br>
<br>&nbsp;&nbsp;&nbsp; dim p as p
<br>&nbsp;&nbsp;&nbsp; p.firstname = fn 
<br>&nbsp;&nbsp;&nbsp; p.lastname = ln
<br>
<br>&nbsp;&nbsp;&nbsp; parseName = p
<br>end function 
<br> 
<br>
<br>'From the interactive window:
<br>dim pn as p 
<br>pn = parseName("John Smith")
<br>?pn.firstname 
<br>= "John"
<br>?pn.lastname
<br>= "Smith"
<br>
<br>'Advanced Concept - To pass in an optional argument of type 'P' to a function, </p>
<p class=Code>' set the default value to null_value():
<br>
<br>function myfunction as c (obj = null_value()) 
<br>&nbsp;&nbsp;&nbsp; dim txt as c = "Object was NOT passed in"
<br>&nbsp;&nbsp;&nbsp; dim options as p
<br>&nbsp;&nbsp;&nbsp; if typeof(obj) = "P" then 
<br>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	options = obj
<br>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	txt = "Object WAS passed in"
<br>&nbsp;&nbsp;&nbsp; end if 
<br>
<br>&nbsp;&nbsp;&nbsp; myfunction = txt
<br>
<br>end function 
<br>
<br>'From the interactive window
<br>
<br>?myfunction()
<br>= "Object was NOT passed in"
<br>
<br>dim o as p
<br>?myfunction(o)
<br>= "Object WAS passed in
<br>
<br>
<br>
<br>'To pass in a value by reference. Notice that this function does not return a value
<br>'So the return type is 'v' (void)
<br>
<br>function multiply as v (BYREF result as n , v1 as n, v2 as n)
<br>&nbsp;&nbsp;&nbsp; result = v1 * v2
<br>end function 
<br>
<br>dim result as n 
<br>multiply(result,2,3)
<br>?result
<br>= 6</p>
</td></tr>
<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
&nbsp;</td></tr>
</table>
<p class=A5>See Also</p>
<p><a href="Xbasic Reference/Xbasic Language Reference.html" title="Xbasic Language Reference" class="wiki">Language Reference</a>, <a href="../../Unclassified/Reserved Words.html" title="Reserved Words" class="wiki">Reserved Words</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:FUNCTION">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","status":"accept"} --->
</body></html>