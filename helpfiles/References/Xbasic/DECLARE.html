	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Function>DECLARE</p>



<p class=A5>Syntax</p>



<p>DECLARE <span class=Argument>Library</span> <span class=Argument>Function_Name</span>
 <span class=Argument>Arguments</span>&nbsp;as&nbsp; <span class=Argument>ReturnType</span></p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Extra spaces
 are added for readability. Remove the space from the finished statement
 between <span class=Argument>ReturnType</span> and <span class=Argument>Arguments</span>.</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 12.009%;">
<col style="width: 87.992%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 12.009%;" valign="top" width="12.009%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 87.992%;" valign="top" width="87.992%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 12.009%;" valign="top" width="12.009%">
<p class=TableLeft><span class=Argument>Library</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.992%;" valign="top" width="87.992%">
<p class=TableLeft>Indicates the name of the DLL in which the function
 is found.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 12.009%;" valign="top" width="12.009%">
<p class=TableLeft><span class=Argument>Function_Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.992%;" valign="top" width="87.992%">
<p class=TableLeft>The name of the function.</p>


<p class=TableLeft>Using an '@' in the <span class=Argument>Function_Name</span>
 allows you to call a function by a user specified alias in Xbasic, rather
 than its real name in the .DLL.&nbsp;For example, to call a Windows API
 functions like <span class=Code1>SetWindowTextA</span> (which means ASCII
 8 bit character version of <span class=Code1>SetWindowText</span> )&nbsp;as&nbsp;
 <span class=Code1>Swt</span> declare the <span class=Argument>Function_Name</span>&nbsp;as&nbsp;follows:
 <span class=Code1>Swt@SetWindowsTextA</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 12.009%;" valign="top" width="12.009%">
<p class=TableLeft><span class=Argument>Arguments</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 87.992%;" valign="top" width="87.992%">
<p class=TableLeft>The argument types with no spaces or punctuation between
 them. The allowed types are the following:</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"L" =
 32 bit long</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"I" =
 32 bit integer</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"W" =
 16 bit short</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"B" =
 byte</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"N" =
 IEEE 8 byte Double</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"F" =
 IEEE 4 byte float</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"C" =
 character (address of characters)</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"(yourtype)"
 = User defined type.</p>

</li>
</ul>
<p class=TableLeft>You can include user defined types that have more than
 one character in their name by putting parentheses around the type name.&nbsp;See
 the example user defined type called 'rect' that is used in the <span
 class=Code1>GetWindowRect</span> function.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 12.009%;" valign="top" width="12.009%">
<p class=TableLeft><span class=Argument>ReturnType</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 87.992%;" valign="top" width="87.992%">
<p class=TableLeft>The return type. See the <span class=Argument>Arguments</span>
 section for allowed types.</td></tr>
</table>

<p class=A5>Description</p>



<p>DECLARE declares an externally defined function (for example a Windows
 API function). An external function can return a reference to data, but
 user defined data returned by reference by a function cannot be modified
 (it is treated&nbsp;as&nbsp;Constant data).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>declare user32 GetWindowText@GetWindowText LLL(text)</td></tr>
</table>

<p>is no different than</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>declare user32 GetWindowText LLL(text)</td></tr>
</table>

<p>The reason we provide aliasing is to provide a means to override behaviour
 of a function which can take optional arguments (have multiple declarations
 of the same function where an argument can be either a NULL pointer (L
 with a value of 0) or a structure ) or to provide a means to rename a
 function name that is mangled (i.e. windows functions sometimes add a
 W or A to the end to specify UNICODE versus ASCII versions of a function).</p>



<p class=A5>Examples</p>



<p>Declare some structures to use - a rectangle and a 1024 character buffer.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>declarestruct&nbsp;rect L1left,L1top,L1right,L1bottom</p>


<p class=Code>declarestruct text C1024txt</td></tr>
</table>

<p><span class=Code1>GetWindowRect</span> returns a long, and takes long
 'window'&nbsp;as&nbsp;the first argument, and a pointer to a <span class=Code1>rect</span>
 structure&nbsp;as&nbsp;the second argument.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>declare&nbsp;user32&nbsp;GetWindowRect&nbsp;LL(rect)</td></tr>
</table>

<p>We declare <span class=Code1>GetWindowText</span> to return a long,
 take a long 'window' handle&nbsp;as&nbsp;the first argument and a 1024
 character buffer&nbsp;as&nbsp;the second argument and a long length&nbsp;as&nbsp;the
 third argument.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>declare user32 gwt@GetWindowText LL(text)&nbsp;as&nbsp;L</td></tr>
</table>

<p>Given that <span class=Code1>wnd</span> contains a window handle, get
 the text of the window into a temporary variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>temp.text = ""</p>


<p class=Code>gwt(wnd,temp,1024)</td></tr>
</table>

<p>The following example shows how DECLARE was used to call a TWAIN driver.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim ftemp&nbsp;as&nbsp;P</p>


<p class=Code>declarestruct hwndapp L1hwndapp</p>


<p class=Code>declarestruct sFile C255sFile</p>


<p class=Code>DECLARE Eztwain3 TWAIN_AcquireToFilename L(hwndApp)(sFile)</p>


<p class=Code>ftemp.sFile="C:\\test\\pict1.jpg"</p>


<p class=Code>TWAIN_AcquireToFilename(0, ftemp)</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="Xbasic Reference/Xbasic Language Reference.html" title="Xbasic Language Reference" class="wiki">Xbasic Language Reference</a>, <a href="../../Unclassified/Reserved Words.html" title="Reserved Words" class="wiki">Reserved Words</a>, <a href="DECLARESTRUCT.html" title="DECLARESTRUCT" class="wiki">DECLARESTRUCT</a>, <a href="../../Unclassified/TYPE END TYPE.html" title="TYPE END TYPE" class="wiki">TYPE ... END TYPE</a></p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:DECLARE">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common"} --->

</body></html>