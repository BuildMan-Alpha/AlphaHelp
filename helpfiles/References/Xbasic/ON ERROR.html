	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>ON ERROR</p>



<p class=A5>Syntax</p>



<p>ON ERROR RESUME NEXT <br>
ON ERROR RESUME <span class=Argument>Label Name</span> <br>
ON ERROR RESUME <span class=Argument>0</span> <br>
ON ERROR GOTO NEXT <br>
ON ERROR GOTO <span class=Argument>Label Name</span> <br>
ON ERROR GOTO <span class=Argument>0</span></p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Label&nbsp;Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Specifies a label in the code.&nbsp;The command line 
 following the label is the first statement executed after an error occurs.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>0</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Disables error handling.</td></tr>
</table>

<p class=A5>Description</p>



<p>Note that the ON ERROR GOTO statement expects to have the error handled, 
 while ON ERROR RESUME expects to have the error ignored. When using ON 
 ERROR RESUME NEXT, there will <span class=Bolded>not</span> be error information 
 available after the branch. ON ERROR RESUME NEXT may produce an error 
 if there is no NEXT to resume to.</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 25%;">
<col style="width: 71.408%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableHead>Syntax</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON ERROR GOTO <span class=Argument>0</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Disables error handling.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON ERROR GOTO <span class=Argument>Label&nbsp;Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Branch to the address of <span class=Argument>Label&nbsp;Name</span> 
 (expecting it to be an error handler).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON ERROR GOTO NEXT</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Branch to the next line (expecting it to be an error 
 handler).</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON&nbsp;ERROR&nbsp;RESUME&nbsp; <span class=Argument>0</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Disables error handling.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON&nbsp;ERROR&nbsp;RESUME <span class=Argument>Label&nbsp;Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Ignore the error and branch to the address of <span 
 class=Argument>Label&nbsp;Name</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 25%;" valign="top" width="25%">
<p class=TableLeft>ON ERROR RESUME NEXT</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 71.408%;" valign="top" width="71.408%">
<p class=TableLeft>Ignore the error and go to the next instruction.</td></tr>
</table>

<p>For example, the following script shows a generic error handling routine:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>on error goto error_handler</p>


<p class=Code>'put Xbasic code here</p>


<p class=Code>end</p>


<p class=Code>error_handler:</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;err = error_code_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = error_text_get(err)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", msg)</p>


<p class=Code>end</td></tr>
</table>

<p>When an error is encountered, this routine displays the text message 
 from the error and then ends script execution. For more robust error handling, 
 use the <a href="../Functions/ERROR_CODE_GET Function.html" title="ERROR_CODE_GET Function" class="wiki">ERROR_CODE_GET(</a>) 
 function to determine exactly which error occurred. You can then take 
 steps to recover from this error so you can resume script execution.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Each function 
 should handle and clear its own errors. A calling function will see errors 
 created within called functions, but will not be able to properly handle 
 RESUME statements.</p>



<p class=A5>Example</p>



<p>This error handling routine is evaluated when x = 3. The <a href="../../Unclassified/STOP.html" title="STOP" class="wiki">STOP</a> 
 command is used to generate the run-time error.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>trace.writeln("Start")</p>


<p class=Code>on error goto error_handler</p>


<p class=Code>for x = 1 TO 10</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (x = 3) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln( str(x) )</p>


<p class=Code>next x</p>


<p class=Code>trace.writeln("End")</p>


<p class=Code>end</p>


<p class=Code>error_handler:</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;trace.writeln("Error processed.")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;resume next</td></tr>
</table>

<p>This script shows how an error handler is used to recover from a field 
 rule violation.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl&nbsp;= table.current()</p>


<p class=Code>if (tbl.mode_get()> 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Compute the Message Type code</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;code = UI_ATTENTION_SYMBOL</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Warning", "Already 
 in data entry mode.", code)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;commit_flag = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;on error goto error_handler</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.last_name = "Washington"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.first_name = "George"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(commit_flag)</p>


<p class=Code>end if</p>


<p class=Code>parent.resynch()</p>


<p class=Code>end</p>


<p class=Code>error_handler:</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;commit_flag = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;resume next</td></tr>
</table>

<p class=A5>See Also</p>

<p>
<a href="Xbasic Reference/Xbasic Language Reference.html" title="Xbasic Language Reference" class="wiki">Xbasic Language Reference</a>, 
<a href="../../Unclassified/Reserved Words.html" title="Reserved Words" class="wiki">Reserved Words</a>, 
<a href="../Functions/ERROR_GENERATE Function.html" title="ERROR_GENERATE Function" class="wiki">ERROR_GENERATE(</a>),
<a href="../Functions/ERROR_CODE_GET Function.html" title="ERROR_CODE_GET Function" class="wiki">ERROR_CODE_GET(</a>),
<a
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:ON+ERROR">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>