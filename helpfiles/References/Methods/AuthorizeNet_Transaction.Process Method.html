	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Method>AuthorizeNet_Transaction.Process()</p>



<p class=A5>Syntax</p>



<p><span class=Argument>Result</span>&nbsp;as&nbsp;P = Process( <span class=Argument>Transaction</span>&nbsp;as&nbsp;AuthorizeNet_Transaction
 )</p>



<p class=A5>Functions</p>



<p>The AuthorizeNet_Transaction object has this function:</p>




<table style="x-cell-content-align: Top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Function</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Type</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Result</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>L</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Indicates TRUE if the transaction server accepted the
 request and attempted to process the transaction. This return value does
 <span class=Bolded>not</span> indicate the success or failure of the actual
 credit card transaction.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Transaction</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>AuthorizeNet_Transaction</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Contains information required to submit a credit card
 transaction for approval. Refer to <a href="http://www.authorize.net/support/AIM_guide.pdf"><span
 class=Screen>Advanced Integration Method (AIM) Implementation Guide Version
 1.0</span></a>.</td></tr>
</table>

<p class=A5>Examples</p>



<p>The following example uses sample data.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim x&nbsp;as&nbsp;AuthorizeNet_transaction</p>


<p class=Code>' Required information</p>


<p class=Code>x.login = "blahblahblah"</p>


<p class=Code>x.tran_key = "aBcDeFgHiJkLmN"</p>


<p class=Code>x.amount = 29.95</p>


<p class=Code>x.card_num = 4111111111111111</p>


<p class=Code>x.exp_date = "12/07"</p>


<p class=Code>x.type = "AUTH_CAPTURE"</td></tr>
</table>

<p>Everything from here down are optional properties which do not need
 to be set in order to create a transaction.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' Include optional billing information</p>


<p class=Code>x.first_name = "Joe"</p>


<p class=Code>x.last_name = "Customer"</p>


<p class=Code>x.company = "Customer, Inc."</p>


<p class=Code>x.address = "123 Main Street"</p>


<p class=Code>x.city = "Boston"</p>


<p class=Code>x.state = "MA"</p>


<p class=Code>x.zip = "02120"</p>


<p class=Code>x.country = "US"</p>


<p class=Code>x.phone = "(555) 123-4567"</p>


<p class=Code>x.fax = "(555 123-4568"</p>


<p class=Code>'include optional additional customer data</p>


<p class=Code>x.cust_id = "a123aa1" 'can be any string up to
 20 characters</p>


<p class=Code>x.customer_ip = "127.0.0.1" 'IP address from which
 the customer initiated the transaction</p>


<p class=Code>'(typically <a href="../Objects/Request Object.html" title="Request Object" class="wiki">request.remote_addr</a>
 in an A5W page)</p>


<p class=Code>x.customer_tax_id = "987654321" 'customer's 9 digit Tax
 Id or SSN</p>


<p class=Code>'email settings</p>


<p class=Code>x.email = "joe@customer.com" 'customer email
 address for transaction confirmation</p>


<p class=Code>x.email_customer = .t. 'send email confirmation to customer</p>


<p class=Code>x.merchant_email = "store@store.com"
 'merchant email address for transaction confirmation</p>


<p class=Code>'invoice information</p>


<p class=Code>x.invoice_num = "web1234" 'any string up to 20
 characters</p>


<p class=Code>x.description = "widgets" 'any string up to 255
 characters</p>


<p class=Code>'include optional ship-to info</p>


<p class=Code>x.ship_to_first_name = "Joe"</p>


<p class=Code>x.ship_to_last_name = "Customer"</p>


<p class=Code>x.ship_to_company = "Customer, Inc."</p>


<p class=Code>x.ship_to_address = "123 Main Street"</p>


<p class=Code>x.ship_to_city = "Boston"</p>


<p class=Code>x.ship_to_state = "MA"</p>


<p class=Code>x.ship_to_zip = "02120"</p>


<p class=Code>x.ship_to_country = "US"</p>


<p class=Code>'**** end of setting optional properties</td></tr>
</table>

<p class=A5>Process the Transaction</p>



<p>The process() method returns true or false to indicate <span class=Bolded>success or failure
 of the transaction processing</span>.This however does <span class=Bolded>not</span>
 indicate success or failure of the actual credit card transaction itself.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if x.process() then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'x.process() will return true if the
 transaction server accepted the request and attempted to process the transaction</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim y&nbsp;as&nbsp;p</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim result_msg&nbsp;as&nbsp;c</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim result_title&nbsp;as&nbsp;c =
 ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;y = x.result</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;result_msg = y.Response_Reason_Text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (y.response_code = "1")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Authorize.Net
 defines response code 1&nbsp;as&nbsp;"Approved"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_title
 = "Approved"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*concat(result_msg,crlf()+
 "Approval Code: " + y.Approval_Code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;elseif (y.response_code = "2")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Authorize.Net
 defines response code 2&nbsp;as&nbsp;"Declined"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_title
 = "declined"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;elseif (y.response_code = "3")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Authorize.Net
 defines response code 3&nbsp;as&nbsp;"Error"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_title
 = "error"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;*concat(result_title," "
 + "Transaction " + y.Transaction_ID)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box(result_title,result_msg)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'if x.process() is false, the transaction
 server could not be contacted or did not respond in a timely manner</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("", "Transaction
 NOT processed", UI_ATTENTION_SYMBOL)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Objects/AuthorizeNet_Transaction.html" title="AuthorizeNet_Transaction" class="wiki">AuthorizeNet_Transaction</a></p>



	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:AuthorizeNet_Transaction.Process+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","status":"pending"} --->
</body></html>