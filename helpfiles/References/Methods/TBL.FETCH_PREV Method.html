	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Method>&ltTBL>.FETCH_PREV()</p>



<p class=A5>Syntax</p>



<p><span class=Argument>Found_Flag</span>&nbsp;as&nbsp;N = &ltTBL>.FETCH_PREV(
 [ <span class=Argument>Outline_Level_Number</span>&nbsp;as&nbsp;N&nbsp;]
 )</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Found_Flag</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>The return value is zero if a record was found. A non-zero
 value indicates that a record was not found.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Outline_Level_Number</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. Used when fetching through the records of
 a set. The outline level determines the depth of the fetch, so that tables
 at lower levels in the set can be excluded from the Fetch operation.</td></tr>
</table>

<p class=A5>Description</p>



<p>The &ltTBL>.FETCH_PREV() method retrieves the previous record in
 the table or set referenced by &ltTBL>. The previous record is determined
 by the active range, index, or query list. If there is no previous record
 to be fetched, the method returns a value other than zero. Use the <a href="TBL.FETCH_EOF Method.html" title="TBL.FETCH_EOF Method" class="wiki">&lt;TBL&gt;.FETCH_EOF(</a>) method after
 every &ltTBL>.FETCH_PREV()to determine if the function has tried to
 fetch beyond the active range and index. In most cases, the last current
 record is preserved when a &ltTBL>.FETCH_PREV()fails.</p>



<p>You use the optional <span class=Argument>Outline_Level_Number</span>
 parameter when fetching through the records of a set. The outline level
 determines the depth of the fetch, so that tables at lower levels in the
 set can be excluded from the Fetch operation. This is useful for operations
 that relate to only parent records in a set. For more information, see
 <a href="../../Orphans/Fetching at a Particular Level in a Set.html#Fetching_Only_Parent_Records_With_Fetch_Outlining" title="Fetching at a Particular Level in a Set" class="wiki">Fetching Only Parent Records With Fetch Outlining</a>.</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 5 and Above</p>



<p class=A5>Example</p>



<p>This script is attached to a button on a form. It fills the state_prov
 field in the current record with the value from the previous record in
 the current sorted order. If the current record is in change or enter
 mode when the button is pressed, it preserves the record entry state.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim prev_value&nbsp;as&nbsp;C</p>


<p class=Code>tbl&nbsp;= table.current()</p>


<p class=Code>'Check what mode the table is in</p>


<p class=Code>mode = tbl.mode_get()</p>


<p class=Code>if (mode = 0) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'table
 is in view mode</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_prev()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;prev_value = tbl.state_prov</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;state_prov.value = prev_value</td></tr>
</table>

<p>The object on the form that displays the <span class=Code1>state_prov</span>
 field is called <span class=Code1>state_prov</span>. Set its value.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;parent.commit()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Save
 the record</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Table is not in view mode, so we
 cannot move the record pointer.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'A new instance of the table must
 be opened.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl2 = table.open(a_db_current)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'get reference to current index</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;indx_tbl = tbl.index_primary_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'get the record number</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;recno = tbl.recno()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Get index tag name in the first
 instance of the table.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (indx_tbl.type_get()= -1) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'check
 if recno order</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indx_tbl_name = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indx_tbl_name
 = indx_tbl.name_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;indx_tbl2 = tbl2.index_primary_put(indx_tbl_name)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl2.fetch_goto(recno)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Move to the previous record in the
 tbl2</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl2.fetch_prev()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;prev_value = tbl2.state_prov</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;state_prov.value = prev_value</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="TBL.FETCH_EOF Method.html" title="TBL.FETCH_EOF Method" class="wiki">&lt;TBL&gt;.FETCH_EOF(</a>),
 <a href="TBL.FETCH_NEXT Method.html" title="TBL.FETCH_NEXT Method" class="wiki">&lt;TBL&gt;.FETCH_NEXT(</a>)</p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.FETCH_PREV+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf", "group" : "table" } --->
</body></html>