	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Method>FORM.VIEWQUERIED()</p>



<p class=A5>Syntax</p>



<p><span class=Argument><FORM></span>&nbsp;as&nbsp;P = FORM.VIEWQUERIED( 
 <span class=Argument>Form_Name</span>&nbsp;as&nbsp;C [,&nbsp;<span class=Argument>Filter_Expn</span>&nbsp;as&nbsp;C 
 [,&nbsp;<span class=Argument>Order_Expn</span>&nbsp;as&nbsp;C [,&nbsp;<span 
 class=Argument>Style</span>&nbsp;as&nbsp;C [,&nbsp;<span class=Argument>Horizontal_Position</span>&nbsp;as&nbsp;N 
 [,&nbsp;<span class=Argument>Vertical_Position</span>&nbsp;as&nbsp;N [, 
 <span class=Argument>IsBaseQuery</span>&nbsp;as&nbsp;L&nbsp;&nbsp;[, <span 
 class=Argument>Arguments as SQL::Arguments</span> ]]]]]]]&nbsp;)</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 7.453%;">
<col style="width: 2.03%;">
<col style="width: 87.714%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 7.453%;" valign="top" width="7.453%">
<p class=TableHead>Argument</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 2.03%;" valign="top" width="2.03%">
<p class=TableHead>&nbsp;</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 87.714%;" valign="top" width="87.714%">
<p class=TableHead>Description</td></tr>

<tr valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 7.453%;" valign="top" width="7.453%">
<p class=TableLeft><span class=Argument>Form_Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.03%;" valign="top" width="2.03%">V5</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.714%;" valign="top" width="87.714%">
<p class=TableLeft>The name of the form to open. In the case where there 
 are duplicate form names in the database, you can qualify the form name 
 with the table name using this syntax: <span class=Code1>Form_Name@Table_Name</span>. 
 For example, if a database has a form called <span class=Code1>Customers</span> 
 for the <span class=Code1>Current_Customers</span> and the <span class=Code1>Past_Customers</span> 
 tables, you can specify the form as: " <span class=Code1>Customers@Current_Customers</span>, 
 or <span class=Code1>Customers@Past_Customers</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 7.453%;" valign="top" width="7.453%">
<p class=TableLeft><span class=Argument>Filter_Expn</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.03%;" valign="top" width="2.03%">V5</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.714%;" valign="top" width="87.714%">
<p class=TableLeft>Optional. Default = ".T." (All records). A 
 <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that evaluates to a logical value and selects the 
 records to show in the dialog.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 7.453%;" valign="top" width="7.453%">
<p class=TableLeft><span class=Argument>Order_Expn</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.03%;" valign="top" width="2.03%">V5</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.714%;" valign="top" width="87.714%">
<p class=TableLeft>Optional.&nbsp;Default = record order. A <a href="../../Unclassified/Writing Expressions.html#Character_Order_Expressions" title="Writing Expressions" class="wiki">character   order expression</a> that sorts selected records.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 7.453%;" valign="top" width="7.453%">
<p class=TableLeft><span class=Argument>Style</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.03%;" valign="top" width="2.03%">V5</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.714%;" valign="top" width="87.714%">
<p class=TableLeft>Optional.&nbsp;Default = "". Determines 
 the mode of the form.</p>


<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"" (i.e. blank value) = 
	Open the form as a standard modeless MDI window (same as if you double click 
	on the form in the Control Panel)</p>

</li>
	<li class=kadov-p-CTableBullet>
	<p class=TableBullet>"dialog"</p>

</li>
	<li class=kadov-p-CTableBullet>
	<p class=TableBullet>"hidden"</p>

</li>
	<li class=kadov-p-CTableBullet>
	<p class=TableBullet>"hidden-dialog"</p>

</li>
	<li class=kadov-p-CTableBullet>
	<p class=TableBullet>"popup"</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="2" colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<p class=TableLeft><span class=Argument>Horizontal_Position</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">V5</td>
<td class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
<p class=TableLeft>Optional.&nbsp;Default = "" (i.e. use setting 
defined in the Form Properties dialog). The horizontal 
 position of the window. Possible values are:</p>


<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"left"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"right"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"center"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"fill"</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">V6</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
<p class=TableLeft>"pixel_coordinate"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="2" colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<p class=TableLeft><span class=Argument>Vertical_Position</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">V5</td>
<td class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
<p class=TableLeft>Optional.&nbsp;Default = "" (i.e. use setting 
defined in the Form Properties dialog). The vertical 
 position of the window. Possible values are:</p>


<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"top"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"bottom"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"center"</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"fill"</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">V6</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
<p class=TableLeft>"pixel_coordinate"</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<p><span class=Argument>IsBaseQuery</span></td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">
<p>V8</td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
<p>Optional. The default value for this property is .T. Specify if the query is a 
 'base query' or not. See 'Understanding Base Query' below.</td></tr>

<tr>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<span class="Argument">Arguments</span></td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.121%;" valign="top" width="2.121%">
V9</td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 82.366%;" valign="top" width="82.366%">
Optional. Allows you to pass in argument values for any arguments that might be 
referenced by tables in the form. See 'Active Link Tables' below.</td>
</tr>
</table>

<p class=A5>Description</p>



<p>The FORM.VIEWQUERIED() method opens Form Name and returns an object 
 pointer, <Form>, to the form window. In the case where there are 
 duplicate form names in the database, you can qualify the form name with 
 the table name using this syntax: Form Name@Table Name. For example, if 
 a database has a form called "Customers" for the "Current_Customers" 
 and the "Past_Customers" tables, you can specify the form as: 
 "Customers@Current_Customers", or "Customers@Past_Customers".</p>



<p>To open the form&nbsp;as&nbsp;a modal dialog box, specify "Dialog"&nbsp;as&nbsp;the 
 optional Style parameter. You can also specify a style of "Popup". 
 See <a href="FORM.VIEW Method.html" title="FORM.VIEW Method" class="wiki">FORM.VIEW(</a>) for details.</p>



<p>To load the form into memory, without displaying it, specify "Hidden"&nbsp;as&nbsp;the 
 Style or, use the <a href="FORM.LOAD Method.html" title="FORM.LOAD Method" class="wiki">FORM.LOAD(</a>) method.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : If you do not 
 close the form at the end of your script, you will leave the underlying 
 table(s) open.</p>



<p class=A5>Understanding 'Base Query'</p>



<p>When you design a form you can go to the Form, Properties dialog and 
 and specify a filter expression for the form. When the form is opened, 
 only records that satisfy the filter will be shown. This filter is referred 
 to as a 'base query' because it is always applied regardless of what additional 
 filter the user might add to the form after the form has been opened (by 
 using Query by Form, Query Genie, Query by expression, etc.). If the user 
 applies some filter to the form and then clicks the 'show all' button 
 to remove the filter that he added, the base query is still in place. 
 The user cannot remove the base query. (You will notice that when a base 
 query has been defined, the Select Index/Query command is disabled, and 
 the button to change the search key on the Find by Key dialog is also 
 disabled because enabling them would allow the user to remove the base 
 query.). </p>



<p>So, for example, if a form has a base query of 'State = "MA" 
 ' and the user defines a query to search for ' Lastname = "Smith" 
 ', the actual query is ' State = "MA" .and. Lastname = "Smith" 
 '. When the user clicks the 'Show All' button, the 'State = "MA"' 
 query is still in place.</p>



<p>When the FORM.VIEWQUERIED() method is used with <span class=Argument>IsBaseQuery 
 </span>set to its default vlaue of .t. the filter that is specified becomes 
 the form's new base query and it cannot be removed by the user. </p>



<p>If <span class=Argument>IsBaseQuery </span>is set to .f., then the form 
 is opened showing just the records that satisfy the filter condition, 
 but the filter is not a base query and the user can click the 'Show All' 
 button to remove the filter.</p>



<p>Note. After a form has been opened, the <form>.BaseQueryRun() 
 method can be used to specify a different base query for the form.</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 5 and Above</p>



<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>Examples</p>



<p>This script opens the Customer form and displays the record whose number 
 is stored in the variable, recno.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim shared recno&nbsp;as&nbsp;N</p>


<p class=Code>dim frm&nbsp;as&nbsp;P</p>


<p class=Code>dim filter as C</p>


<p class=Code>filter = "between(recno(), " + recno + "," 
 + recno + ")"</p>


<p class=Code>'e.g. if recno = 23, filter = "between(recno(), 23,23)"</p>


<p class=Code>frm = form.viewQueried("customer",filter)</p>


<p class=Code>... do things</p>


<p class=Code>frm.close()</td></tr>
</table>

<p>This script opens the Customer form for all MA customers. Data is sorted 
 by lastname and firstname</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim frm&nbsp;as&nbsp;P</p>


<p class=Code>dim filter as C</p>


<p class=Code>dim order as C</p>


<p class=Code>filter = "bill_state_region = 'MA'"</p>


<p class=Code>order = "lastname + firstname"</p>


<p class=Code>frm = form.viewQueried("customer",filter,order)</p>


<p class=Code>... do things</p>


<p class=Code>frm.close()</td></tr>
</table>

<p>This script does the same&nbsp;as&nbsp;the previous script, but it opens 
 the form&nbsp;as&nbsp;a modal dialog box. Note the <FORM>.CLOSE() 
 method which is needed to close the dialog after the user dismisses the 
 dialog.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim frm&nbsp;as&nbsp;P <br>
dim filter as C</p>


<p class=Code>dim order as C</p>


<p class=Code>filter = "bill_state_region = 'MA'"</p>


<p class=Code>order = "lastname + firstname"</p>


<p class=Code>frm = form.viewQueried("customer",filter,order,"dialog")</p>


<p class=Code>... do things</p>


<p class=Code>frm.close()</td></tr>
</table>

<p>This script opens the Customer form for all customers in the state specified 
 by the whatState variable.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim frm&nbsp;as&nbsp;P</p>


<p class=Code>dim filter as C</p>


<p class=Code>filter = between_char("state",whatState,whatState)</p>


<p class=Code>frm = form.viewQueried("customer",filter)</p>


<p class=Code>... do things</p>


<p class=Code>frm.close()</td></tr>
</table>

<p>This script opens the Customer form and shows the record in the range 
 of record numbers specified by <span class=Code1>startrec</span> and <span 
 class=Code1>endrec</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim frm&nbsp;as&nbsp;P</p>


<p class=Code>filter = between_record(startrec, endrec)</p>


<p class=Code>frm = form.viewQueried("customer",filter)</p>


<p class=Code>... do things</p>


<p class=Code>frm.close()</td></tr>
</table>

<p class=A5>Active Link Tables</p>


	<p>(Version 9 Only)</p>


	<p>A form can be based on an active-link table or a set that includes 
	active-link tables. An active-link table can use one or more arguments in 
	its SQL Select statement. For example:</p>


	<p class=Code>SELECT * from customers where city = :whatcity</p>


	<p>When an active-link table is opened, Alpha Five will prompt for the value 
	of any argument if a value for that argument has not been supplied.</p>


	<p>The .ViewQueried() method allows you to pass in argument values so that 
	when the active-link table(s) on which the form is based are opened, the 
	prompting is suppressed.</p>


	<p>The following example shows how a form that is based on an active-link 
	table can be opened to show just the customers in 'London'. It is assumed 
	that the form in this case ('Customer') is based on an active-link table 
	that has an argument in the SQL Select statement.</p>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table1">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim args as sql::arguments</p>


<p class=Code>args.add("whatcity","London")</p>


<p class=Code>dim f as p </p>


<p class=Code>f = form.viewQueried("Customer","","","","","",.t.,args)</p>

</td></tr>
</table>

	<p>In this example, the form will open quickly because the query is executed 
	on the server.</p>


	<p>You can also specify a "client-side" filter by specifying a value for the 
	option <span class="Argument">Filter_expn </span>parameter. The 
	"client-side" filter is applied in addition to any server-side filter that 
	is part of the active-link table's definition.</p>


	<p>Note: When you specify a value for the <span class="Argument">filter_expn
	</span>parameter, the Alpha Five Query Optimizer will analyze the filter 
	expression and determine if it can be expressed as a SQL filter. If so, it 
	will actually execute the query on the server. </p>


	<p class=A5>See Also</p>



<p><a href="FORM.VIEW Method.html" title="FORM.VIEW Method" class="wiki">FORM.VIEW(</a>), <a href="FORM.LOAD Method.html" title="FORM.LOAD Method" class="wiki">FORM.LOAD(</a>), 
 <a href="BROWSE.LOAD Method.html" title="BROWSE.LOAD Method" class="wiki">BROWSE.LOAD(</a>), <a href="Form Functions and Methods.html" title="Form Functions and Methods" class="wiki">Form   Functions and Methods</a>, <a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing   Expressions</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:FORM.VIEWQUERIED+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>