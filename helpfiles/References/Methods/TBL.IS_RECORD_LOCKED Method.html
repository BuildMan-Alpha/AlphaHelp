	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Method>&ltTBL>.IS_RECORD_LOCKED()</p>



<p class=A5>Syntax</p>



<p><span class=Argument>Result_Flag</span>&nbsp;as&nbsp;L = &ltTBL>.IS_RECORD_LOCKED()</p>



<p class=A5>Description</p>



<p>The &ltTBL>.IS_RECORD_LOCKED() method returns .T. (TRUE) if the current
 record is locked (i.e. another user or session has the record in change
 mode).</p>



<p>This method is new to V5. Previously, if you tried to put a record into
 change mode and another user or session already had the record in change
 mode, an error condition would occur, which your script could trap with
 the ON ERROR command. However, this technique is slow because Alpha Five
 makes several attempts to get a lock on the record before reporting the
 error. Using the &ltTBL>.IS_RECORD_LOCKED() method is easier and faster.</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 5 and Above</p>



<p class=A5>Example</p>



<p>This script checks if the current record is locked before making a change.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>tbl = table.current()</p>


<p class=Code>status = tbl.is_record_locked()</p>


<p class=Code>if (.not. status) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.field1 = var1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(.T.)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", "Record
 locked by another user")</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a></p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.IS_RECORD_LOCKED+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf", "group" : "../Objects/Table" } --->
</body></html>