	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Method>BROWSE.VIEWQUERIED()</p>



<p class=A5>Syntax</p>



<p><span class=Argument><BROWSE></span>&nbsp;as&nbsp;P = BROWSE.VIEWQUERIED( 
 <span class=Argument>Browse_Name</span>&nbsp;as&nbsp;C [,&nbsp;<span class=Argument>Filter_Expn</span>&nbsp;as&nbsp;C 
 [,&nbsp;<span class=Argument>Order_Expn</span>&nbsp;as&nbsp;C&nbsp;[,
<span class="Argument">IsBaseQuery</span>&nbsp;as&nbsp;L&nbsp;[,
<span class="Argument">Arguments</span>&nbsp;as&nbsp;SQL::arguments ]]]] 
 )</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Browse_Name</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>The name of the browse to open. In the case where there 
 are duplicate browse names in the database, you can qualify the browse 
 name with the table name using this syntax: Browse Name@Table Name. For 
 example, if a database has a browse called "Customers" for the 
 "Current_Customers" and the "Past_Customers" tables, 
 you can specify the browse as: "Customers@Current_Customers", 
 or "Customers@Past_Customers".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Filter_Expn</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. Default = all records,&nbsp;subject to any 
 filter defined in the browse layout itself. A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that evaluates to a logical value and selects records 
 from the table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Order_Expn</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional.&nbsp;Default = record order. A <a href="../../Unclassified/Writing Expressions.html#Character_Order_Expressions" title="Writing Expressions" class="wiki">character   order expression</a> that sorts selected records.</td></tr>
<tr>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<span class=Argument>IsBaseQuery</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 84%;" valign="top">(V8 only) The default value for this property is .T. Specify if 
the query is a 'base query' or not. See 'Understanding Base Query' below.</td>
</tr>
<tr>
<td colspan="1" class="TableCell" style="x-cell-content-align: top; width: 4.964%;" valign="top" width="4.964%">
<span class="Argument">Arguments</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 84%;" valign="top">(V9 only)&nbsp; Optional. Allows you to pass in argument values 
for any arguments that might be referenced by tables in the Browse. See 'Active 
Link Tables' below.</td>
</tr>
</table>

<p class=A5>Description</p>



<p>BROWSE.VIEWQUERIED()opens <span class=Argument>Browse_Name</span>, displaying 
 selected and ordered records, and returns the < <span class=Argument>BROWSE</span> 
 > object pointer to the browse window.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : You cannot open 
 a browse window&nbsp;as&nbsp;a modal dialog box. If you wish to have a 
 modal browse window, design a form with an embedded browse, and then open 
 the form&nbsp;as&nbsp;a modal dialog.</p>



<p class=A5>Understanding 'Base Query'</p>


<p>When you design a Browse layout you can go to the Browse, Properties dialog 
and and specify a filter expression for the browse. When the browse is opened, 
only records that satisfy the filter will be shown. This filter is referred to 
as a 'base query' because it is always applied regardless of what additional 
filter the user might add to the browse after the browse has been opened (by 
using Query Genie, Query by expression, etc.). If the user applies some filter 
to the browse and then clicks the 'show all' button to remove the filter that he 
added, the base query is still in place. The user cannot remove the base query. 
(You will notice that when a base query has been defined, the Select Index/Query 
command is disabled, and the button to change the search key on the Find by Key 
dialog is also disabled because enabling them would allow the user to remove the 
base query.). </p>


<p>So, for example, if a browse has a base query of 'State = "MA" ' and the user 
defines a query to search for ' Lastname = "Smith" ', the actual query is ' 
State = "MA" .and. Lastname = "Smith" '. When the user clicks the 'Show All' 
button, the 'State = "MA"' query is still in place.</p>


<p>When the BROWSE.VIEWQUERIED() method is used with <span class=Argument>
IsBaseQuery </span>set to its default vlaue of .t. the filter that is specified 
becomes the browse's new base query and it cannot be removed by the user. </p>


<p>If <span class=Argument>IsBaseQuery </span>is set to .f., then the browse is 
opened showing just the records that satisfy the filter condition, but the 
filter is not a base query and the user can click the 'Show All' button to 
remove the filter.</p>


<p>Note. After a browse has been opened, the <browse>.BaseQueryRun() method can 
be used to specify a different base query for the browse.</p>



<p class=A5>Active Link Tables</p>


<p>(Version 9 Only)</p>


<p>A browse can be based on an active-link table or a set that includes 
active-link tables. An active-link table can use one or more arguments in its 
SQL Select statement. For example:</p>


<p class=Code>SELECT * from customers where city = :whatcity</p>


<p>When an active-link table is opened, Alpha Five will prompt for the value of 
any argument if a value for that argument has not been supplied.</p>


<p>The .ViewQueried() method allows you to pass in argument values so that when 
the active-link table(s) on which the browse is based are opened, the prompting 
is suppressed.</p>


<p>The following example shows how a browse that is based on an active-link 
table can be opened to show just the customers in 'London'. It is assumed that 
the browse in this case ('Customer') is based on an active-link table that has 
an argument in the SQL Select statement.</p>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%" id="table1">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim args as sql::arguments</p>


<p class=Code>args.add("whatcity","London")</p>


<p class=Code>dim f as p </p>


<p class=Code>f = browse.viewQueried("Customer","","",.t.,args)</p>

</td></tr>
</table>

<p>In this example, the browse will open quickly because the query is executed 
on the server.</p>


<p>You can also specify a "client-side" filter by specifying a value for the 
option <span class="Argument">Filter_expn </span>parameter. The "client-side" 
filter is applied in addition to any server-side filter that is part of the 
active-link table's definition.</p>


<p>Note: When you specify a value for the <span class="Argument">filter_expn
</span>parameter, the Alpha Five Query Optimizer will analyze the filter 
expression and determine if it can be expressed as a SQL filter. If so, it will 
actually execute the query on the server. </p>





<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>See Also</p>



<p><a href="../Desktop/Browse Functions and Methods.html" title="Browse Functions and Methods" class="wiki">Browse Functions   and Methods</a>, <a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing Expressions</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:BROWSE.VIEWQUERIED+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>