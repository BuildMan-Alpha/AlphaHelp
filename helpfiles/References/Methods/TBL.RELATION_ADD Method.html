	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Method>&ltTBL>.RELATION_ADD()</p>



<p class=A5>Syntax</p>



<p>Specify the required values in the <span class=Argument>Relation</span> 
 dot variable, then use the following command:</p>



<p>&ltTBL>.RELATION_ADD( <span class=Argument>&ltChild_Table></span>&nbsp;as&nbsp;P 
 )</p>




<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>&ltChild_Table></span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>A pointer to the table that will become a child to parent 
 &ltTBL>.</td></tr>
</table>


<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 17.048%;">
<col style="width: 5.026%;">
<col style="width: 12.564%;">
<col style="width: 65.362%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 17.048%;" valign="top" width="17.048%">
<p class=TableHead>Variable</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableHeadCenter>Type</td>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 77.926%;" valign="top" width="77.926%">
<p class=TableHead>Description</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="6" class="TableCell" style="x-cell-content-align: top; width: 17.048%;" valign="top" width="17.048%">
<p class=TableLeft><span class=Argument>Relation.link_type</span></td>
<td colspan="1" rowspan="6" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>N</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 77.926%;" valign="top" width="77.926%">
<p class=TableLeft>Describes the relationship between the parent and child 
 tables.&nbsp;The Link Type parameter can be assigned one of four types 
 of links:</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="tableHeader" style="width: 12.564%; x-cell-content-align: top;" valign="top" width="12.564%">
<p class=TableHead>Link Type</td>
<td class="tableHeader" style="width: 65.362%; x-cell-content-align: top;" valign="top" width="65.362%">
<p class=TableHead>Type Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 12.564%; x-cell-content-align: top;" valign="top" width="12.564%">
<p class=TableLeft>LINK_MANY</td>
<td class="TableCell" style="width: 65.362%; x-cell-content-align: top;" valign="top" width="65.362%">
<p class=TableLeft>One record from the parent table is related to one or 
 more records in the child table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 12.564%; x-cell-content-align: top;" valign="top" width="12.564%">
<p class=TableLeft>LINK_FIRST</td>
<td class="TableCell" style="width: 65.362%; x-cell-content-align: top;" valign="top" width="65.362%">
<p class=TableLeft>One record from the parent table is related to the first 
 matching record in the child table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 12.564%; x-cell-content-align: top;" valign="top" width="12.564%">
<p class=TableLeft>LINK_LAST</td>
<td class="TableCell" style="width: 65.362%; x-cell-content-align: top;" valign="top" width="65.362%">
<p class=TableLeft>One record from the parent table is related to the last 
 matching record in the child table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 12.564%; x-cell-content-align: top;" valign="top" width="12.564%">
<p class=TableLeft>LINK_CLOSEST</td>
<td class="TableCell" style="width: 65.362%; x-cell-content-align: top;" valign="top" width="65.362%">
<p class=TableLeft>One record from the parent table is related to the closest 
 matching record in the child table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 17.048%;" valign="top" width="17.048%">
<p class=TableLeft><span class=Argument>Relation.index_child</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>P</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 77.926%;" valign="top" width="77.926%">
<p class=TableLeft>To link tables, the linking field(s) in the child table 
 must be indexed. To specify the linking index, assign the <span class=Argument>Relation.index_child</span> 
 a pointer to an existing index.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 17.048%;" valign="top" width="17.048%">
<p class=TableLeft><span class=Argument>Relation.order_parent</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 77.926%;" valign="top" width="77.926%">
<p class=TableLeft>Indicates which field or combination of fields in the 
 parent table are used to link to the indexed field(s) in the child table. 
 In most cases, the expression used in the linking index and the common 
 linking expression are similar (i.e., the parent and child table are linked 
 on a single field, with identical field names).</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 17.048%;" valign="top" width="17.048%">
<p class=TableLeft><span class=Argument>Relation.ref_integrity</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 5.026%;" valign="top" width="5.026%">
<p class=TableCenter>N</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 77.926%;" valign="top" width="77.926%">
<p class=TableLeft>A numeric value that indicates how referential integrity 
 is to be enforced on the link. The referential integrity parameter can 
 be set to:</p>


<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>0 = no integrity</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>1 = cascade changes</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>2 = prevent changes</p>

</li>
</ul>
<p class=TableLeft>For more information on referential integrity, see "Using 
 the Set Editor" in the User's Guide.</td>
<td_null></tr>
</table>

<p class=A5>Description</p>



<p>The &ltTBL>.RELATION_ADD() method establishes a relationship, or 
 link, between two open tables. The link definition determines the nature 
 of this relationship. It is established through the relation function 
 variable,&nbsp;as&nbsp;shown in the syntax diagram above. The &ltTBL>.RELATION_ADD() method 
 uses the contents of the relation function variable when constructing 
 the link. The parent table of the link is the table referenced by the 
 object pointer, &ltTBL>, and the child table of the link is the table 
 referenced by the object pointer, <span class=Argument>&ltChild_Table></span> 
 pointer. You can use &ltTBL>.RELATION_ADD()with two or more open tables 
 to form a set design. You can then save this set&nbsp;as&nbsp;a set definition 
 file using the <a href="TBL.SET_CREATE Method.html" title="TBL.SET_CREATE Method" class="wiki">&lt;TBL&gt;.SET_CREATE(</a>) 
 method.</p>



<p>When the collection of tables linked by &ltTBL>.RELATION_ADD()is 
 complete, you can store it in a set definition using the &ltTBL>.SET_CREATE() method. 
 A set is referenced by the table pointer of the set's primary table.</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 5 and Above</p>



<p class=A5>Example</p>



<p>This script uses the relation add method to find the number of invoices 
 for an individual customer.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim parent&nbsp;as&nbsp;P</p>


<p class=Code>dim parent_index&nbsp;as&nbsp;P</p>


<p class=Code>id = ui_get_text("Count Invoices","For which 
 customer ID? ","C001")</p>


<p class=Code>if id = "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>parent = table.open("c:\a5\a_sports\customer.dbf")</p>


<p class=Code>parent_index = parent.index_primary_put("CUST_ID")</p>


<p class=Code>result = parent.fetch_find(id)</p>


<p class=Code>if (result &lt 0) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", "Customer 
 not found.")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>child_tbl = table.open("c:\a5\a_sports\inv_head.dbf")</p>


<p class=Code>relation.link_type = LINK_MANY</p>


<p class=Code>child_index = child_tbl.index_get("CUST_ID")</p>


<p class=Code>relation.index_child = child_index</p>


<p class=Code>relation.order_parent = "CUST_ID"</p>


<p class=Code>relation.ref_integrity = 0</p>


<p class=Code>parent.relation_add(child)</p>


<p class=Code>' or parent.relation.change()if the relationship exists but 
 is being changed</p>


<p class=Code>count = 0</p>


<p class=Code>child_tbl.fetch_first()</p>


<p class=Code>while .NOT. child_tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;count = count + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;child_tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>trace.writeln("Number of invoices for customer: " 
 + ltrimcount<a href="tiki-editpage.php?page=count" title="Create page: count" class="wiki wikinew str">?</a>)</p>


<p class=Code>parent.relation_drop(child)</p>


<p class=Code>child_tbl.close()</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="../Functions/Set Functions and Methods.html" title="Set Functions and Methods" class="wiki">Set Functions   and Methods</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:TBL.RELATION_ADD+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>