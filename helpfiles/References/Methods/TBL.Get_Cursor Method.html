	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p><b>&lttbl>.get_cursor() Method</b>&nbsp;- Allows you to get a 'cursor' for an open table. A 'cursor' is just a pointer to an open table that can be navigated independently of the base table. When you move the pointer in a cursor, you do not change the record that the base table pointer is pointing to.</p>
<p>Syntax:</p>
<p><i>tCursor</i>&nbsp;= &lttbl>.get_cursor()</p>
<p>&nbsp;</p>
<p>Example:</p>
<p>&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">dim t as p</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">dim tc1 as p</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">dim tc2 as p</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">t = table.open("customer")</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tc1 = t.get_cursor()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tc2 = t.get_cursor()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'The cursors can each have their own order. Has no impact on the base table</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tc1.order("Firstname")</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tc2.order("Lastname")</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">?t.recno()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">=1</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">?tc1.recno()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">=23</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">?tc2.recno()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">=34</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tc1.fetch_next()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">?tc1.recno()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">= 56</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'Notice how we have moved the record pointer in the first cursor, but</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'it has had no effect on the base table (which still points to record 1)</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">?t.recno()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">= 1</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;</p>
<p>&nbsp;</p>
<p>The primary motivation for this method is to allow you to use Xbasic to get a pointer to the table that an Embedded Browse is based on, and then to safely loop over the records in that table and manipulate the data in that table. If your Xbasic loop used the table pointer itself, rather than a cursor, your script may not work reliably. This is because you have no control over events that cause the Browse to repaint, and when the Browse repaints, it might move the record pointer.</p>
<p>&nbsp;</p>
<p>Example. The 'Invoice' Form in AlphaSports is based on the Invoice.set. This Form has an embedded browse that is based on the 'invoice_items' table. You want to write a script that will loop through all of the records for the current invoice, increasing the quantity by one.</p>
<p>Here is code that could be inserted in a button on the Invoice form:</p>
<p>&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">dim tbl as p&nbsp;<br />
dim t as p</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'get a pointer to the SAME table instance that the embedded browse is based on.</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'Note: Could also have done: tbl = Browse1.table_get()<br />
tbl = table.get("invoice_items")</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'Get a cursor on the table instance<br />
t = tbl.get_cursor()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">t.fetch_first()<br />
while .not. t.fetch_eof()<br />
&nbsp;&nbsp;&nbsp; t.change_begin()<br />
&nbsp;&nbsp;&nbsp; t.quantity = t.quantity + 1&nbsp;<br />
&nbsp;&nbsp;&nbsp; t.change_end(.t.)<br />
&nbsp;&nbsp;&nbsp; t.fetch_next()<br />
end while<br />
&nbsp;</p>
<p>You might ask, "Why do I have to go to the trouble of getting a cursor? Why can't I just write code that uses the same table pointer that the Embedded Browse uses?". The reason is that the script shown below will not work reliably.</p>
<p>The reason is this: You have no control over when the Browse will repaint. When the Browse repaints it affects the record that the table pointer is positioned on. So, if your script is using the same table pointer that the Embedded Browse is using, then the code in your loop that positions the record pointer will be impacted every time the Browse repaints during the course of your loop. The Browse will be repainted every time the message box is dismissed.</p>
<p>&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">'This code is NOT safe (could result in Browse repaint errors)</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">dim tbl as p&nbsp;<br />
tbl = table.get("invoice_items")</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">tbl.fetch_first()<br />
dim count as n = 0&nbsp;<br />
while .not. tbl.fetch_eof()</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;&nbsp;&nbsp; count = count + 1</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;&nbsp;&nbsp; ui_msg_box("Notice","Editing item number: " + count)<br />
&nbsp;&nbsp;&nbsp; tbl.change_begin()<br />
&nbsp;&nbsp;&nbsp; tbl.quantity = t.quantity + 1&nbsp;<br />
&nbsp;&nbsp;&nbsp; tbl.change_end(.t.)<br />
&nbsp;&nbsp;&nbsp; tbl.fetch_next()<br />
end while</p>
<p>&nbsp;</p>
<p class="xbasic" style="font-family: 'Courier New'; font-size: 8pt; color: rgb(0, 0, 255); margin-left: 20pt; margin-top: 0px; margin-bottom: 0px; ">&nbsp;</p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.Get_Cursor+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf", "group" : "table" } --->
</body></html>