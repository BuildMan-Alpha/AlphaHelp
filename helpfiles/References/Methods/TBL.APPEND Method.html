	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Method>&ltTBL>.APPEND()</p>



<p class=A5>Syntax</p>



<p>Specify the required values in the <span class=Argument>Append</span>
 dot variable, then use the following command:</p>



<p>&ltTBL>.APPEND()</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variable</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Type</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_db</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Transaction table filename</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.type</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Append type.&nbsp;There are three types of Append operations.
 The <span class=Argument>append.type</span> parameter has the following
 possible values:</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"All"</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Unique Only"</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Unique, Replace
 Existing"</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<span class=Argument>Append.convert_types</span></td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
L</td>
<td colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<div>
	<div>
		Specifies if data should be converted to match the data type of the
		target field. For example, if you are appending a time value into a date
		field, and this flag is set to .T., then the data will be automatically
		converted. By default, this flag is set to .F., which means that if you
		try to append data into a field of the wrong data type, an error will
		occur. Only supported by V8 and above.</div>
</div>
</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_key</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Master Key Expression.&nbsp;Required when you use either
 <span class=Note>Unique Only</span> or <span class=Note>Unique, Replace
 Existing</span>. A key expression is a field or combination of fields
 that Alpha Five uses to determine which table records are considered unique.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_key</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Transaction Key Expression.&nbsp;Required when you use
 either Unique Only or Unique, Replace Existing. A key expression is a
 field or combination of fields that Alpha Five uses to determine which
 table records are considered unique.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_filter</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>CE</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that evaluates to a logical value. The Master Filter
 is used with either the <span class=Note>Unique Only</span> or the <span
 class=Note>Unique, Replace Existing</span> operation. Only the subset
 of Master records that pass through this filter are used when searching
 for existing records.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_filter</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>CE</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that evaluates to a logical value. The Transaction
 Filter indicates how many fields are to be appended. Determines which
 records from the Transaction table are appended.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_count</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Number of Master Mappings.&nbsp;&nbsp;Indicates how
 many fields are to be appended. <span class=Note>Required</span> when
 the Master and Transaction tables have different structures. You must
 map fields explicitly so that the correct values are copied from the Transaction
 table fields and entered in the Master table fields. Transaction table
 fields not mapped to the Master table are not transferred during the Append
 operation. Each field mapping is expressed through a group of three parameters:</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>Case (optional)</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>Master Field</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>Master Expression</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_case1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Required for each field when <span class=Argument>Append.type</span>
 is "Unique, Replace Existing". The Master Case parameter specifies
 three possible mapping types:</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Either"
 - The Transaction record is either appended or used to replace a Master
 record.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Appended"
 - The Transaction record is appended.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Replaced"
 - The Transaction record matches a Master table record and replaces that
 record.</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_field1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Master Field1 ... Master FieldN.&nbsp;The name of the
 Master Field in &ltTBL> to which data is to be appended.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_exp1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Master Expression1...Master ExpressionN.&nbsp;Contains
 the value, field, or expression that is to be assigned to the Master Field.
 Field names from the transaction table must have an "@" in front
 of the table or alias name.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="3" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>... an arbitrary number of fields</td>
<td_null>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_caseN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.m_case1</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_fieldN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.m_field1</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.m_expN</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.m_exp1</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_count</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Number of Transaction Mappings (M).&nbsp;Refers to how
 many fields in the Transaction table are to be updated.&nbsp;as&nbsp;in
 the Master mapping, each transaction mapping is expressed through a group
 of three parameters. Refer to Append_m_count.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_case1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. The Transaction Case specifies four possible
 situations that may occur when the append operation is attempted.&nbsp;When
 you specify a case, you enable an update of the Transaction table, which
 might be useful for recording the status of the append operation. The
 Transaction Case specifies four possible types of operations:</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Appended"</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Replaced"</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Either"
 (appended or replaced)</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>"Violated"
 (the append failed for this record).</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_field1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A field in the Transaction table.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_exp1</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>An expression that assigns a value to <span class=Code1>t_field1</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="3" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>... an arbitrary number of fields</td>
<td_null>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_caseM</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.t_case1</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_fieldM</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.t_field1</span>.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Append.t_expM</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Refer to <span class=Code1>append.t_exp1</span>.</td></tr>
</table>

<p class=A5>Description</p>



<p>The &ltTBL>.APPEND() method is a high-level utility function used
 to append the records of one table to another. Most parameters passed
 to &ltTBL>.APPEND()through the append function variable correspond
 directly with the prompts in the Append Records operation called by clicking
 <span class=Button>Operations</span> > <span class=Button>New</span>
 > <span class=Button>Append Records</span>.</p>



<p>You perform the Append operation by selecting a Transaction table (
 <span class=Code1>append.t_db</span> ) and a Master table (&ltTBL>).
 The <span class=Argument>Transaction</span> table is the source table
 that supplies the records; the <span class=Argument>Master</span> table
 is the target table.</p>



<p>The Number of Transaction Mappings refers to how many fields in the
 Transaction table are to be updated.&nbsp;as&nbsp;in the Master mapping,
 each transaction mapping is expressed through a group of three parameters.</p>






<p>This script zaps the records in the current table and then appends new
 records to the table from the specified Transaction table.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim filename&nbsp;as&nbsp;C</p>


<p class=Code>dim basename&nbsp;as&nbsp;C</p>


<p class=Code>filename = "c:\a5\data\cust_new.dbf" <br>
basename = "@cust_new" <br>
tbl = table.current() <br>
tbl.zap(.T.) <br>
append.t_db = filename <br>
append.m_key = "" <br>
append.t_key = "" <br>
append.m_filter = "" <br>
append.t_filter = "" <br>
append.type = "All" <br>
append.m_count = 9 <br>
append.m_field1 = "CUST_ID" <br>
append.m_exp1 = basename + "->CUST_ID" <br>
append.m_field2 = "SALUTATION" <br>
append.m_exp2 = basename + "->SALUTATION" <br>
append.m_field3 = "FIRST_NAME" <br>
append.m_exp3 = basename + "->FIRST_NAME" <br>
append.m_field4 = "LAST_NAME" <br>
append.m_exp4 = basename + "->LAST_NAME" <br>
append.m_field5 = "ADDRESS_1" <br>
append.m_exp5 = basename + "->ADDRESS_1" <br>
append.m_field6 = "ADDRESS_2" <br>
append.m_exp6 = basename + "->ADDRESS_2" <br>
append.m_field7 = "CITY" <br>
append.m_exp7 = basename + "->CITY" <br>
append.m_field8 = "STATE_PROV" <br>
append.m_exp8 = basename + "->STATE_PROV" <br>
append.m_field9 = "ZIP" <br>
append.m_exp9 = basename + "->ZIP" <br>
append.t_count = 0 <br>
tbl.append() <br>
ui_msg_box("Note", "Operation Completed")</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="../../Unclassified/Table Operation Methods.html" title="Table Operation Methods" class="wiki">Table Operation   Methods</a>, <a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing Expressions</a></p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.APPEND+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf", "group" : "../Objects/Table" } --->
</body></html>