	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">







	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>




<article id="top" class="wikitext clearfix nopagetitle">








			<p class=A3Method>&ltTBL>.RANGE_ADD()</p>



<p class=A5>Syntax</p>



<p>&nbsp;Specify the required values in the <span class=Argument>Range</span>
 dot variable, then use the following command:</p>



<p>&ltTBL>.RANGE_ADD( [ <span class=Argument>First_Key</span>&nbsp;as&nbsp;C
 [,&nbsp;<span class=Argument>Last_Key</span>&nbsp;as&nbsp;C&nbsp;]]&nbsp;)</p>




<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>First_Key</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Specify the first ordered record to be included in the
 range.&nbsp;Must match the index key type.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Last_Key</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional.&nbsp;Default = the last record. Specify the
 last ordered record to be included in the range. Must match the index
 key type.</td></tr>
</table>


<table style="x-cell-content-align: top;
				width: 100%;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 2.648%;">
<col style="width: 3.194%;">
<col style="width: 22.575%;">
<col style="width: 53.473%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 2.648%;" valign="top" width="2.648%">
<p class=TableHead>Variable</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 3.194%;" valign="top" width="3.194%">
<p class=TableHeadCenter>Type</td>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 76.048%;" valign="top" width="76.048%">
<p class=TableHead>Description</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="10" class="TableCell" style="x-cell-content-align: top; width: 2.648%;" valign="top" width="2.648%">
<p class=TableLeft><span class=Argument>Range.Flags</span></td>
<td colspan="1" rowspan="10" class="TableCell" style="x-cell-content-align: top; width: 3.194%;" valign="top" width="3.194%">
<p class=TableCenter>N</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 76.048%;" valign="top" width="76.048%">
<p class=TableLeft>Used together (using the .OR. operator) to determine
 which &ltTBL>.RANGE_ADD()parameters are valid, and how the range performs.
 The range flag variables are:</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="tableHeader" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableHead>Range Flag</td>
<td class="tableHeader" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableHead>Effect</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_FIRST</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Use first key.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_LAST</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Use last key.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_FILTER</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Use a Filter Expression.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_INDEX</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Use the specified Index Pointer.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_DESCENDING</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Reverse the order.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_MARKED</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Flag to indicate whether or not marked or unmarked records
 should be included in the range. See example below.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_MARKED_</p>


<p class=TableLeft>DELETED</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Flag to indicate whether or not marked or unmarked records
 should be included in the range. See example below.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td class="TableCell" style="width: 22.575%; x-cell-content-align: top;" valign="top" width="22.575%">
<p class=TableLeft>RANGE_UNIQUE</td>
<td class="TableCell" style="width: 53.473%; x-cell-content-align: top;" valign="top" width="53.473%">
<p class=TableLeft>Select only unique keys in index order.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.648%;" valign="top" width="2.648%">
<p class=TableLeft><span class=Argument>Range.Index_Pointer</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 3.194%;" valign="top" width="3.194%">
<p class=TableCenter>P</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 76.048%;" valign="top" width="76.048%">
<p class=TableLeft>A pointer to an index.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 2.648%;" valign="top" width="2.648%">
<p class=TableLeft><span class=Argument>Range.Filter</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 3.194%;" valign="top" width="3.194%">
<p class=TableCenter>C</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 76.048%;" valign="top" width="76.048%">
<p class=TableLeft>A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that selects records from the table.</td>
<td_null></tr>
</table>

<p class=A5>Description</p>



<p>The &ltTBL>.RANGE_ADD() method applies a range to a table. Old ranges
 are maintained in a stack, and you can retrieve them in the reverse order
 in which they were applied with the &ltTBL>.RANGE_DROP() method.</p>



<p>The range is applied to the table referenced by the object pointer,
 &ltTBL>. You must supply one or more <span class=Argument>Range.Flags</span>
 variables. The range flags determine which optional parameters are to
 be used: an Index Pointer, a Filter Expression, a First Key, and a Last
 Key. The first and last key expression values should match the index key
 type, and are used to specify the first and last ordered records to be
 included in the range.</p>



<p><span class=Argument>Range.Flags</span> are used together (using the
 .OR. operator) to determine which &ltTBL>.RANGE_ADD()parameters are
 valid, and how the range performs.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Once you add
 a range, it is not activated until the record pointer is moved from its
 current position. You can use the <a href="TBL.FETCH_FIRST Method.html" title="TBL.FETCH_FIRST Method" class="wiki">&lt;TBL&gt;.FETCH_FIRST(</a>)
 method to activate it. The record pointer should be considered undefined
 until this is done. To determine if there are any records in the scope
 of the defined range, use the <a href="TBL.FETCH_EOF Method.html" title="TBL.FETCH_EOF Method" class="wiki">&lt;TBL&gt;.FETCH_EOF(</a>)
 method. If it returns .T. after moving the record pointer once, there
 are no records in the defined range.</p>



<p>To include only records that are marked use both the RANGE_MARKED and
 RANGE_MARKED_DELETED flags together. For example, the following range
 selects marked records using the current index:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>idx = tbl.index_primary_get()</p>


<p class=Code>range.flags = RANGE_INDEX .or. RANGE_MARKED .or. RANGE_MARKED_DELETED</p>


<p class=Code>range.index_pointer = idx</p>


<p class=Code>range.filter = ""</p>


<p class=Code>tbl.range_add()</td></tr>
</table>

<p>To include only records that have not been marked, use the RANGE_MARKED
 flag without the RANGE_MARKED_DELETED flag:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>idx = tbl.index_primary_get()</p>


<p class=Code>range.flags = RANGE_INDEX .or. RANGE_MARKED</p>


<p class=Code>range.index_pointer = idx</p>


<p class=Code>range.filter = ""</p>


<p class=Code>tbl.range_add()</td></tr>
</table>

<p>To include both marked and unmarked records in the range, do not specify
 either the RANGE_MARKED or RANGE_MARKED_DELETED flags.</p>



<p class=A5>When to Use Ranges</p>



<p>Ranges are useful when you have a batch operation that processes selected
 records in a table. For example, assume that you want to process all of
 the records in the state of California. You could use the <a href="TBL.QUERY_CREATE Method.html" title="TBL.QUERY_CREATE Method" class="wiki">&lt;TBL&gt;.QUERY_CREATE(</a>)
 method to build a query list, but this could take some time. However,
 setting a range with State&nbsp;as&nbsp;the primary index and "CA"&nbsp;as&nbsp;the
 first and last key value will instantaneously select the subset of records
 that you want to process.</p>



<p>Ranges are most efficient when used with the RANGE_FIRST and RANGE_LAST
 flags. If you use the <span class=Code1>range_filter</span> flag on a
 large table whose scope has not been limited with the RANGE_FIRST and
 RANGE_LAST flags, and only a small percentage of the records satisfy the
 filter expression, you should consider using the &ltTBL>.QUERY_CREATE() method
 instead, since this method can use Lightning Query Optimization, while
 ranges cannot.</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 5 and Above</p>



<p class=A5>Example</p>



<p>This script sets the range on the current table to display customers
 from either New York or Massachusetts, with last names between C and N,
 using the last name index in descending order, and including only records
 with unique last names that are not marked.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>idx = tbl.index_get("LAST")</p>


<p class=Code>range.flags = RANGE_INDEX .or. RANGE_FIRST .or. RANGE_LAST
 .or. RANGE_FILTER .or. RANGE_DESCendING .or. RANGE_MARKED .or. RANGE_UNIQUE</p>


<p class=Code>range.index_pointer = idx</p>


<p class=Code>range.filter = "STATE_PROV = 'MA' .OR. STATE_PROV =
 'NY'"</p>


<p class=Code>tbl.range_add("C", "N")</td></tr>
</table>

<p>The following Xbasic code illustrates how to count the records in table
 returned by a range. The table name is <span class=Code1>volume</span>.
 It has an index named <span class=Code1>test</span>, which indexes the
 field whose value is passed in&nbsp;as&nbsp; <span class=Code1>id</span>.
 It filters the values in the field table named <span class=Code1>entrydate</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>FUNCTION aging&nbsp;as&nbsp;N (id&nbsp;as&nbsp;C )</p>


<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim dbegin&nbsp;as&nbsp;D</p>


<p class=Code>dim dend&nbsp;as&nbsp;D</p>


<p class=Code>dim indx&nbsp;as&nbsp;P</p>


<p class=Code>dim ntot&nbsp;as&nbsp;N</p>


<p class=Code>tbl = table.open("volume")</p>


<p class=Code>indx = tbl.index_primary_put("test")</p>


<p class=Code>dbegin = date()- 120</p>


<p class=Code>dend = date()</p>


<p class=Code>range.flags = RANGE_FIRST .or. RANGE_LAST .or. RANGE_INDEX
 .or. RANGE_FILTER</p>


<p class=Code>range.index_pointer = indx</p>


<p class=Code>range.filter = "between(entrydate, dbegin, dend)"</p>


<p class=Code>tbl.range_add(id, id)</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>ntot = 0</p>


<p class=Code>while .not. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ntot = ntot + 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</p>


<p class=Code>aging = ntot</p>


<p class=Code>tbl.close()</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and   Methods</a>, <a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing Expressions</a></p>


	<hr class="hrwikibottom" />


	</article>




	<!-- WIKIPATH:TBL.RANGE_ADD+Method">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>



	</div>
</div>

			</div>
		</div>




<!-- Put JS at the end -->

<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf", "group" : "../Objects/Table" } --->
</body></html>