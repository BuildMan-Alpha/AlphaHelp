	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Handling Errors with the SQL::CallResult Object</p>



<p>AlphaDAO contains a special object named <a href="SQL CallResult Object.html" title="SQL CallResult Object" class="wiki">SQL::CallResult</a> 
 to help you diagnose problems. Suppose you take the following script, 
 which works, and change the name of the database from "alphasports.mdb" 
 to "alpha.mdb".</p>



<p>Before:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>? conn.open("{A5API=Access,FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb',UserName='Admin'}")</p>


<p class=Code>= .T.</td></tr>
</table>

<p>After:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>? conn.open("{A5API=Access,FileName='C:\Program Files\a5v8\MDBFiles\Alpha.mdb',UserName='Admin'}")</p>


<p class=Code>= .F.</td></tr>
</table>

<p>Note that the <a href="../Functions/SQL Connection Open Function.html" title="SQL Connection Open Function" class="wiki">.Open(</a>) 
 method returned .F. (FALSE), meaning that an error occurred. If you want 
 to know what went wrong, take a look at the connection object's <a href="SQL Connection Object.html#CallResult" title="SQL Connection Object" class="wiki">.CallResult</a> 
 property.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? conn.CallResult</p>


<p class=Code>= API = ""</p>


<p class=Code>Canceled = .F.</p>


<p class=Code>Code = 195</p>


<p class=Code>Error = .T.</p>


<p class=Code>LastInsertedIdentity = <No data returned></p>


<p class=Code>NativeCode = -1</p>


<p class=Code>NativeText = [Microsoft][ODBC Microsoft Access Driver] Could 
 not find file '(unknown)'.</p>


<p class=Code>SQL State is: HY000</p>


<p class=Code>[Microsoft][ODBC Driver Manager] Driver's SQLSetConnectAttr 
 failed</p>


<p class=Code>SQL State is: IM006</p>


<p class=Code>RowsAffected = 0</p>


<p class=Code>Success = .F.</p>


<p class=Code>Syntax = ""</p>


<p class=Code>Text = Database API specific error</p>


<p class=Code>Your database has returned the following error code and description 
 to Alpha Anywhere.</p>


<p class=Code>Consult your database documentation for further information.</p>


<p class=Code>-1 - '[Microsoft][ODBC Microsoft Access Driver] Could not 
 find file '(unknown)'.</p>


<p class=Code>SQL State is: HY000</p>


<p class=Code>[Microsoft][ODBC Driver Manager] Driver's SQLSetConnectAttr 
 failed</p>


<p class=Code>SQL State is: IM006'</p>


<p class=Code>Warnings = .F.</td></tr>
</table>

<p>Or to narrow things down, look at the <a href="SQL CallResult Object.html#Text" title="SQL CallResult Object" class="wiki">CallResult.text</a> 
 property.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? conn.CallResult.Text</p>


<p class=Code>= Database API specific error</p>


<p class=Code>Your database has returned the following error code and description 
 to Alpha Anywhere.</p>


<p class=Code>Consult your database documentation for further information.</p>


<p class=Code>-1 - '[Microsoft][ODBC Microsoft Access Driver] Could not 
 find file '(unknown)'.</p>


<p class=Code>SQL State is: HY000</p>


<p class=Code>[Microsoft][ODBC Driver Manager] Driver's SQLSetConnectAttr 
 failed</p>


<p class=Code>SQL State is: IM006'</td></tr>
</table>

<p>AlphaDAO does its best to interpret the error messages returned by back-end 
 databases into meaningful statements that you can use.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.close()</td></tr>
</table>



<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>See Also</p>



<p><a href="../../Orphans/Working with SQL Databases Title.html" title="Working with SQL Databases Title" class="wiki">Working with SQL Databases</a>, 
 <a href="SQL CallResult Object.html" title="SQL CallResult Object" class="wiki">SQL::CallResult Object</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Handling+Errors+with+the+SQL+CallResult+Object">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>