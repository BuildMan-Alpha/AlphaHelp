	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Email Automation</p>

<p>Alpha Anywhere provides three utilities that combine to provide opportunities 
 for email automation.</p>

<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span   class=Screen><a href="../../Unclassified/Receiving an Email.html" title="Receiving an Email" class="wiki">Email Reader</a></span> - allows 
 Alpha Anywhere to receive emails</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span   class=Screen><a href="../../Unclassified/Receiving an Email.html#The_Email_Action_Editor" title="Receiving an Email" class="wiki">Email Action Editor</a></span> 
 - defines actions to take when emails are received</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span   class=Screen><a href="../../Unclassified/Receiving an Email.html#The_Email_Filter_Genie" title="Receiving an Email" class="wiki">Email Filter Genie</a></span> 
 - supports the <span class=Screen>Email Action Editor</span> by providing 
 filtering capabilities to identify emails of interest</p>

</li>
</ul>

<p>The types of automated email applications that you can create are illustrated 
 by these examples.</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Request a report from a 
 remote PC via email</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Add a record to a table 
 on a remote PC via email</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Play an Xbasic script on 
 a remote PC via email</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Filter incoming messages 
 based on content</p>

</li>
</ul>

<p class=A5><a name=Request_a_Report_Via_Email>Request a Report Via Email</a></p>



<p>Create an action with the <span class=Screen>Email Action Editor</span> 
 that responds to email messages requesting a report by emailing the report 
 back to the sender's address.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Email 
 Reader</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Action_Script_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to open the <span class=Screen>Email Action Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Add_Button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to display the <span class=Screen>Edit Email Action</span> 
 dialog box. This dialog captures three pieces of information: the expression 
 that the triggering event in an incoming email, the action to take, and 
 (in this case) the script to play. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Add_Email_Action_Dialog.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 341px;
							height: 170px;
							float: none;
							border-style: none;
							border-style: none;"
					width=341
					height=170
					border=0></p>



<ol start=4>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>You can directly 
 enter the expression or click <img src="ex<x>pression_Button_black.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 22px;
											height: 22px;
											float: none;
											border-style: none;
											border-style: none;"
									width=22
									height=22
									border=0> to display the <span class=Screen>Expression 
 Builder</span>, which can display a list of email fields and previously 
 used field values. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_Create_Action_Expression.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 521px;
							height: 376px;
							float: none;
							border-style: none;
							border-style: none;"
					width=521
					height=376
					border=0></p>



<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The Alpha Anywhere <span 
 class=Screen>Email Reader</span> looks for messages with "report 
 request" in the subject field. When it finds a message, it responds 
 by playing the "ReportRequest" script. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Report_Request_Action.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 454px;
							height: 238px;
							float: none;
							border-style: none;
							border-style: none;"
					width=454
					height=238
					border=0></p>



<ol start=6>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Email 
 Reader</span> receives an email that looks like this. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Send_Report_Request_Message.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 582px;
							height: 377px;
							float: none;
							border-style: none;
							border-style: none;"
					width=582
					height=377
					border=0></p>



<ol start=7>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>the <span class=Code1>ReportRequest</span> 
 script sends the requested report to the sender's email address.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ON ERROR GOTO ERROR</p>


<p class=Code>DIM tInbox&nbsp;as&nbsp;P</p>


<p class=Code>tInbox = table.open(cTable, FILE_RO_SHARED)</p>


<p class=Code>tInbox.fetch_goto(nRecno)</p>


<p class=Code>DIM body&nbsp;as&nbsp;C</p>


<p class=Code>DIM subject&nbsp;as&nbsp;C</p>


<p class=Code>DIM report_to_send&nbsp;as&nbsp;C</p>


<p class=Code>DIM from&nbsp;as&nbsp;C</p>


<p class=Code>DIM filter&nbsp;as&nbsp;C</p>


<p class=Code>DIM filter2&nbsp;as&nbsp;C</p>


<p class=Code>DIM order&nbsp;as&nbsp;C</p>


<p class=Code>DIM fn&nbsp;as&nbsp;C</p>


<p class=Code>subject = tInbox.subject</p>


<p class=Code>from = tInbox.from_email</p>


<p class=Code>body = tInbox.body</p>


<p class=Code>' find the report name</p>


<p class=Code>report_to_send = get_field_from_body("report name:*", 
 body)</p>


<p class=Code>IF report_to_send = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' no report specified...done</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END</p>


<p class=Code>END IF</p>


<p class=Code>' retrieve the filter if there is one specified in the body, 
 i.e.</p>


<p class=Code>' filter: state $ "CA"</p>


<p class=Code>filter = get_field_from_body("filter:*", body)</p>


<p class=Code>order = get_field_from_body("order:*", body)</p>


<p class=Code>IF body &lt> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;DIM cReportTable&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cReportTable = a5_op_name_short_to_long(report_to_send, 
 "REPORT")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cReportTable = word(cReportTable, 
 2, "@", 99999)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;filter2 = process_filter_Fields(body, 
 cReportTable )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;IF filter2 &lt> ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter = 
 a5_Combine_filters(filter, filter2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END IF</p>


<p class=Code>END IF</p>


<p class=Code>' report.send(report_to_send, "PDF", "", 
 "","a5", from, "Here is the report you requested", 
 "Attached is the report you requested")</p>


<p class=Code>fn = file.temp_path_get()+remspecial(word(report_to_Send, 
 1, "@") )+".PDF"</p>


<p class=Code>report.SaveAs(report_to_send,"PDF", filter, order, 
 fn)</p>


<p class=Code>wait_until(file.exists(fn), 1, 10)</p>


<p class=Code>email_send(from, "Here is the report you requested", 
 "Attached is the report you requested", fn)</p>


<p class=Code>file.remove(fn)</p>


<p class=Code>tInbox.close()</p>


<p class=Code>ON ERROR GOTO 0</p>


<p class=Code>GOTO DONE</p>


<p class=Code>ERROR:</p>


<p class=Code>trace.Writeln(error_text_get() )</p>


<p class=Code>DONE:</td></tr>
</table>


<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>FUNCTION process_filter_fields&nbsp;as&nbsp;C ( body&nbsp;as&nbsp;C, 
 report_table&nbsp;as&nbsp;C )</p>


<p class=Code>DIM cResult&nbsp;as&nbsp;C</p>


<p class=Code>DIM i&nbsp;as&nbsp;N</p>


<p class=Code>DIM word_i&nbsp;as&nbsp;C</p>


<p class=Code>DIM field_name&nbsp;as&nbsp;C</p>


<p class=Code>DIM value&nbsp;as&nbsp;C</p>


<p class=Code>DIM expr&nbsp;as&nbsp;C</p>


<p class=Code>DIM t&nbsp;as&nbsp;P</p>


<p class=Code>IF file.filename_parse(report_table, "E") = ".ddd"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;report_table = file.filename_parse(report_table, 
 "DPN")+".dbf"</p>


<p class=Code>END IF</p>


<p class=Code>IF file.exists(report_table)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;t = table.open(report_table, FILE_RO_SHARED)</p>


<p class=Code>ELSE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;EXIT FUNCTION</p>


<p class=Code>END IF</p>


<p class=Code>FOR i = 1 TO line_count(body)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'get field name</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;word_i = word(body, i, crlf() )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' get the field/value pairs</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;IF (word_i &lt> "") 
 .AND. (":" $ word_i) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field_name 
 = alltrim(word(word_i, 1, ":") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value = alltrim(word(word_i, 
 2, ":", 99999) )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF (field_name 
 &lt> "") .AND. (value &lt> "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIM 
 datatype&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF 
 eval_valid(field_name, report_table)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datatype 
 = eval("t." + field_name + ".type_get()")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF 
 datatype = "C"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr 
 = field_name + " = " + quote(value)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE 
 IF datatype = "D"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr 
 = field_name + " = {"+value+"}"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE 
 IF datatype = "L"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr 
 = field_name + " = " + iif(value = "True" .OR. value 
 = ".T.", ".T.", ".F.")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr 
 = field_name + " = " +value</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END 
 IF</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cResult 
 = a5_combine_filters(cResult, expr)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END 
 IF</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END IF</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END IF</p>


<p class=Code>NEXT i</p>


<p class=Code>t.close()</p>


<p class=Code>process_filter_fields = cResult</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Add_a_Record_via_Email>Add a Record via Email</a></p>



<p>Create an action with the <span class=Screen>Email Action Editor</span> 
 that responds to an email message by extracting data from the email and 
 adding a record to a table.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Email 
 Reader</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Action_Script_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to open the <span class=Screen>Email Action Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Add_Button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to display the <span class=Screen>Add Email Action</span> 
 dialog box. This dialog captures three pieces of information: the expression 
 that the triggering event in an incoming email, the action to take, and 
 (in this case) the script to play. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Edit_Email_Action_Add_Record.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 341px;
							height: 170px;
							float: none;
							border-style: none;
							border-style: none;"
					width=341
					height=170
					border=0></p>



<ol start=4>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The Alpha Anywhere Email 
 reader looks for messages with "report request" in the subject 
 field. When it finds a message, it responds by playing the "ReportRequest" 
 script. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Add_Record_Action.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 454px;
							height: 238px;
							float: none;
							border-style: none;
							border-style: none;"
					width=454
					height=238
					border=0></p>



<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Email 
 Reader</span> receives an email that looks like this. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Send_Add_Record_Message.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 582px;
							height: 470px;
							float: none;
							border-style: none;
							border-style: none;"
					width=582
					height=470
					border=0></p>



<ol start=5>
	
	<ol start=6>
		
		<li class=kadov-p-CListNumber><p class=ListNumber>the <span class=Code1>AddRecord</span> 
 script extracts the field data from the message body and appends a new 
 record to the Customer table.</p>

</li>
	</ol>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' email action to add a record to a table based on contents 
 of email</p>


<p class=Code>ON ERROR GOTO ERROR</p>


<p class=Code>DIM tInbox&nbsp;as&nbsp;P</p>


<p class=Code>' cTable & nRecno are defined automatically</p>


<p class=Code>tInbox = table.open(cTable, FILE_RO_SHARED)</p>


<p class=Code>tInbox.fetch_goto(nRecno)</p>


<p class=Code>DIM body&nbsp;as&nbsp;C</p>


<p class=Code>DIM subject&nbsp;as&nbsp;C</p>


<p class=Code>subject = tInbox.subject</p>


<p class=Code>body = tInbox.body</p>


<p class=Code>DIM t&nbsp;as&nbsp;P</p>


<p class=Code>DIM table_to_use&nbsp;as&nbsp;C</p>


<p class=Code>table_to_use = get_field_from_body("Table:*", body)</p>


<p class=Code>table_to_use = alltrim(table_to_use)</p>


<p class=Code>t = table.open(table_to_use, FILE_RW_SHARED)</p>


<p class=Code>t.enter_begin()</p>


<p class=Code>*for_each(x, add_record(t, x), body )</p>


<p class=Code>t.enter_end(.T.)</p>


<p class=Code>t.close()</p>


<p class=Code>tInbox.close()</p>


<p class=Code>GOTO DONE</p>


<p class=Code>ON ERROR GOTO 0</p>


<p class=Code>ERROR:</p>


<p class=Code>' log the error</p>


<p class=Code>trace.writeln(error_text_get() )</p>


<p class=Code>DONE:</td></tr>
</table>


<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>FUNCTION add_record&nbsp;as&nbsp;V ( t&nbsp;as&nbsp;P, x&nbsp;as&nbsp;C 
 )</p>


<p class=Code>' takes a string in the format fieldname: value and sets</p>


<p class=Code>' fieldname to the value specified.</p>


<p class=Code>' table must already be in change/enter mode</p>


<p class=Code>DIM cEvalField&nbsp;as&nbsp;C</p>


<p class=Code>DIM cField&nbsp;as&nbsp;C</p>


<p class=Code>DIM cValue&nbsp;as&nbsp;C</p>


<p class=Code>DIM field_type&nbsp;as&nbsp;C</p>


<p class=Code>cField = alltrim(word(x,1,":") )</p>


<p class=Code>cValue = alltrim(word(x,2,":", 99999) )</p>


<p class=Code>cEvalField = "t."+cField</p>


<p class=Code>IF eval_valid(cEvalField)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;field_type = eval(cEvalField+".type_get()")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;IF field_type = "C" .OR. 
 field_type = "M"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cEval = cEvalField 
 + " = " +quote(cValue)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ELSE IF field_type = "D"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cEval = cEvalField 
 + " = {" +cValue + "}"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ELSE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cEval = cEvalField 
 + " = " +cValue</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END IF</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(cEval)</p>


<p class=Code>END IF</p>


<p class=Code>END FUNCTION</td></tr>
</table>

<p class=A5><a name=Play_a_Remote_Xbasic_Script>Play a Remote Xbasic Script</a></p>



<p>In this case the Email Reader examines the subject lines of incoming 
 emails for the word "runme".</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The following image 
 shows how the <span class=Screen>Edit Email Action</span> dialog box configures 
 this action. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Edit_Email_Action_Play_Script.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 341px;
							height: 170px;
							float: none;
							border-style: none;
							border-style: none;"
					width=341
					height=170
					border=0></p>



<ol start=2>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the Email Reader 
 receives an email that looks like this. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Run_Script_Message.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 582px;
							height: 437px;
							float: none;
							border-style: none;
							border-style: none;"
					width=582
					height=437
					border=0></p>



<ol start=5>
	
	<ol start=6>
		
		<li class=kadov-p-CListNumber><p class=ListNumber>the <span class=Code1>runme</span> 
 script examines the message body for a password. If the password is acceptable, 
 it treats the remainder of the message body&nbsp;as&nbsp;Xbasic code and 
 executes it.</p>

</li>
	</ol>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ON ERROR GOTO ERROR</p>


<p class=Code>DIM tInbox&nbsp;as&nbsp;P</p>


<p class=Code>DIM body&nbsp;as&nbsp;C</p>


<p class=Code>DIM password&nbsp;as&nbsp;C</p>


<p class=Code>tInbox = table.open(cTable, FILE_RO_SHARED)</p>


<p class=Code>tInbox.fetch_goto(nRecno)</p>


<p class=Code>body = tInbox.body</p>


<p class=Code>tInbox.close()</p>


<p class=Code>' look for the password string. It should be a comment in 
 the body of</p>


<p class=Code>' the message which is interpreted&nbsp;as&nbsp;a script. 
 i.e.: 'password: mypwd</p>


<p class=Code>password = filter_string_smatch(body, "'password:*", 
 crlf() )</p>


<p class=Code>IF password = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' no password specified....</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END</p>


<p class=Code>END IF</p>


<p class=Code>' get the password</p>


<p class=Code>password = word(password, 2, ":", 9999)</p>


<p class=Code>password = alltrim(password)</p>


<p class=Code>IF (password &lt> "mypwd") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'incorrect password</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END</p>


<p class=Code>END IF</p>


<p class=Code>' if we get here, the password must be correct. Run the script</p>


<p class=Code>' the password does not need to be removed from the body, 
 since</p>


<p class=Code>' it is actually just a comment</p>


<p class=Code>evaluate_template(body)</p>


<p class=Code>GOTO DONE</p>


<p class=Code>ON ERROR GOTO 0</p>


<p class=Code>ERROR:</p>


<p class=Code>trace.writeln(error_text_get() )</p>


<p class=Code>DONE:</p>


<p class=Code>END</td></tr>
</table>

<p class=A5><a name=Filter_Messages_Based_on_Content>Filter Messages Based 
 on Content</a></p>



<p>In this case the <span class=Screen>Email Reader</span> examines the 
 subject lines of incoming emails for indications that the email is spam.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The following image 
 shows how the <span class=Screen>Edit Email Action</span> dialog box configures 
 this action. This is a trivial example, but it is possible to have this 
 expression search for multiple words in multiple fields, including the 
 message body. You can also have many different email actions working in 
 together. </p>

</li>
</ol>

<p class=Pix><img src="images/Email_App_Edit_Email_Action_Move_Message.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 341px;
							height: 170px;
							float: none;
							border-style: none;
							border-style: none;"
					width=341
					height=170
					border=0></p>



<ol start=2>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Email 
 Reader</span> receives an email that looks like this: </p>

</li>
</ol>

<p class=Pix><img src="images/Email_Spam_Message.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 582px;
							height: 347px;
							float: none;
							border-style: none;
							border-style: none;"
					width=582
					height=347
					border=0></p>



<ol start=3>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The action moves 
 the message to the Deleted folder. No additional configuration or programming 
 is required.</p>

</li>
</ol>

<p class=A5>See Also</p>



<p><a href="Integrated Email HTML Editor.html" title="Integrated Email HTML Editor" class="wiki">Integrated Email HTML   Editor</a></p>


	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Email+Automation">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,guide","group":"/Guide/Desktop/Email"} --->
</body></html>