	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Canceling Events</p>



<p>All of the events whose names are prefixed with "Can" can 
 be canceled, thus preventing the event from occurring. The CANCEL()command 
 is used to cancel an event.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The <a href="../Functions/CANCEL Function.html" title="CANCEL Function" class="wiki">CANCEL(</a>) 
 command actually sets the Alpha Anywhere system variable, A_CAN_DO to "NO".</p>



<p>The CANCEL()command can take an optional flag which can be .T. or .F. 
 If the flag is set to .t. then Alpha Anywhere error messages are suppressed. 
 When you cancel an event, if your Xbasic code provides the appropriate 
 feedback to the end-user&nbsp;as&nbsp;to why the event is being canceled 
 (for example, by including a <a href="../Functions/UI_MSG_BOX Function.html" title="UI_MSG_BOX Function" class="wiki">UI_MSG_BOX(</a>) 
 in the code), then you would not want additional error reporting from 
 Alpha Anywhere itself. In this case, you would use CANCEL(.t.) in your code 
 to cancel the event.</p>



<p>For example, assume that you have a control on a form and that you define 
 a script for that control's <span class=Code1>CanDepart</span> event. 
 Assume that the control has focus and that the user tries to give focus 
 to another control on the form. This will cause the control's <span class=Code1>CanDepart</span> 
 event to fire. If this script executes the CANCEL()command, the event 
 will be canceled and the user will not be able to move focus away from 
 this control.</p>



<p>The following example shows how a script could be attached to a table's 
 <span class=Code1>CanDeleteRecord</span> event. When the user deletes 
 a record, the script is executed. It displays a dialog box asking the 
 user for the password. If he enters the correct password, the record is 
 deleted. Otherwise, the Delete event is canceled and the record is retained.</p>



<p>This script prompts the user for a password before deleting a record.</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>password = "Alpha5"</p>


<p class=Code>user = UI_GET_text("Password", "Enter the 
 password", "******", "&&&&&&")</p>


<p class=Code>if (user = "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>if (.not.(user == password)) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Password", 
 "Password invalid.")</p>


<p class=Code>end if</td></tr>
</table>

<p>The following example could be attached to the <span class=Code1>CanWriteField</span> 
 event for the FAX field of the Vendor table. If the area code prefix of 
 the PHONE field does not match the FAX field's area code, the script prompts 
 you with a warning dialog box. If you choose to heed the warning (by clicking 
 'Retry'), the CANCEL()command is executed, and the cursor is prevented 
 from leaving the FAX field. If you choose to abort the fax number entry 
 (by clicking 'Abort'), the A_FIELD_VALUE is set back to the original value&nbsp;as&nbsp;stored 
 in the record buffer, and the cursor is allowed to leave the FAX field.</p>



<p>Obtain the area code from this field and the PHONE field. It is presumed 
 that phone numbers are stored like (xxx) xxx-xxxx</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>prefix1 = left(A_FIELD_VALUE,5)</p>


<p class=Code>prefix2 = left(Vendor->PHONE, 5)</p>


<p class=Code>if (prefix1 <> prefix2) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Compute the Message Type code</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;code = UI_ATTENTION_SYMBOL + UI_ABORT_RETRY_IGNORE</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;response = ui_msg_box("Warning","The 
 area codes of the Phone and Fax numbers should be the same.", code)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'RETRY selected</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (response = UI_RETRY_SELECTED) 
 then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'prevent 
 field exit</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ABORT selected</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;elseif response = UI_ABORT_SELECTED 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'undo field 
 change</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A_FIELD_VALUE 
 = Vendor->FAX</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</td></tr>
</table>

<p>The table below summarizes what happens when an event is canceled with 
 the CANCEL()command.</p>




<table style="width: 100%;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 102.8pt;">
<col style="width: 551.3pt;">

<tr>
<td class="tableHeader" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableHead>Event</td>
<td class="tableHeader" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableHead>What Happens When the Event is Canceled</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanEditField</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents this field from getting focus. Alpha Anywhere will 
 automatically advance to the next field.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanWriteField</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents focus from leaving the field.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanChangeRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the record from being changed. Contrast this 
 with the <span class=Code1>CanChange</span> form event.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanDeleteRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the record from being deleted.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanEnterRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents entry of a new record.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanMarkRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the record from being marked.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanUnMarkRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the record from being unmarked.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanSaveRecord</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Abandons the edited record, without saving it. Contrast 
 with the <span class=Code1>CanSave</span> event, which cancels the save, 
 but does not discard the record being edited.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanArrive</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents a control from getting focus.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanChange</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the user from changing a record. Contrast this 
 with the <span class=Code1>CanChangeRecord</span> event. Both events allow 
 you to prevent a user from changing a record. However, the <span class=Code1>CanChangeRecord</span> 
 event cannot prevent the user from typing a new value into a control on 
 the form even though it can prevent Alpha Anywhere from saving the value the 
 user typed. The <span class=Code1>CanChange</span> event is cleaner because 
 it can actually prevent the user from tying a value into a control on 
 a form.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanDepart</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents focus from leaving a control.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanExit</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents a form from being closed. If you want to prevent 
 a user from exiting from Alpha Anywhere until a certain condition has been 
 met, you can use this event on a hidden form.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanSave</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents a record from being saved. Contrast this with 
 the field rule level, <span class=Code1>CanSaveRecord</span> event which 
 also prevents a record from being saved, but discards the record being 
 edited.</td></tr>

<tr>
<td class="TableCell" style="width: 137px; x-cell-content-align: top;" valign="top" width="137px">
<p class=TableLeft><span class=Code1>CanTabChange</span></td>
<td class="TableCell" style="width: 735px; x-cell-content-align: top;" valign="top" width="735px">
<p class=TableLeft>Prevents the user from changing focus to a different 
 page on a tab object.</td></tr>
</table>

<p class=A5>What to Do if Your "Can" Event Scripts Don't Work</p>



<p>Including user interface code, such&nbsp;as&nbsp;UI_MSG_BOX()etc. in 
 the scripts executed by "Can" events can sometimes cause the 
 script to fail (i.e. even though the CANCEL()command is executed, the 
 event still takes place). This is because the user interface code takes 
 focus away from the current object in Alpha Anywhere when it executes.</p>



<p>If this happens, you can try to include the CANCEL()command in your 
 script before any user interface code.</p>



<p>Here is another way in which you could get unexpected results when you 
 try to cancel an event. Assume that you have a form with a Tab object 
 on the form. You would like to prevent the user from changing focus from 
 the current tab page to another tab page if a certain condition is true. 
 Also, you would like to give focus to a particular field on the tab page 
 if the condition to change pages has not yet been met. The following code 
 is attached to the Tab object's <span class=Code1>CanTabChange</span> 
 event:</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>condition = logical text that sets value of condition</p>


<p class=Code>If (.not. condition) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'user does not have permission to 
 change tab pages</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;company.activate()</p>


<p class=Code>End if</td></tr>
</table>

<p>This does not work! However, the following does work:</p>




<table class="codeTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-style: none;" valign="top" width="100%">
<p class=Code>condition = logical text that sets value of condition</p>


<p class=Code>If (.not. condition) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'user does not have permission to 
 change tab pages</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;company.activate()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>End if</td></tr>
</table>

<p>The reason that the first script fails is that when <span class=Code1>company.activate()</span> 
 executes, it resets the value of the system variable <span class=Code1>A_CAN_DO</span> 
 to "Yes" (because the command succeeded) - thus undoing the 
 effect of the CANCEL()command. When the script ends, the value of <span 
 class=Code1>A_CAN_DO</span> is "Yes", and so the event is not 
 cancelled.</p>



<p class=A5>See Also</p>



<p><a href="Attaching Scripts to Events.html" title="Attaching Scripts to Events" class="wiki">Attaching Scripts to Events</a>, 
 <a href="../Objects/Object Events.html" title="Object Events" class="wiki">Object Events</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Canceling+Events">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>