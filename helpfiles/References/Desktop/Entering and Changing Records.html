	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Entering and Changing Records</p>



<p>You can enter or change records in any open table (assuming the table 
 is not write-protected or being used exclusively by another user or session). 
 Several open tables or related tables from a set can be in <span class=Bolded>Enter</span> 
 or <span class=Bolded>Change</span> mode simultaneously.</p>



<p>To enter a new record into a table, you do the following:</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Start a new record 
 with the <a href="../Methods/TBL.ENTER_BEGIN Method.html" title="TBL.ENTER_BEGIN Method" class="wiki">&lt;TBL&gt;.ENTER_BEGIN(</a>) 
 method. This puts the table in Enter mode (however, the new record is 
 not yet physically created).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Assign the field 
 values. (The field values are held in the record buffer).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Complete the record 
 with the <a href="../Methods/TBL.ENTER_END Method.html" title="TBL.ENTER_END Method" class="wiki">&lt;TBL&gt;.ENTER_END(</a>) 
 method; this creates a new record in the table from the values in the 
 record buffer.</p>

</li>
</ol>

<p>For example, the following script creates a new table based on the <span 
 class=Code1>Products</span> table, creating one record in the new table 
 for every product record fetched:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim old&nbsp;as&nbsp;P</p>


<p class=Code>dim new&nbsp;as&nbsp;P</p>


<p class=Code>old = table.open("c:\a5\a_sports\product.dbf")</p>


<p class=Code>new = old.create_clone("c:\a5\a_sports\prod2.dbf")</p>


<p class=Code>old.fetch_first()</p>


<p class=Code>while .NOT. old.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new.enter_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new.name = old.name</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new.retail = old.retail</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;new.enter_end(.T.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;old.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>

<p>To change the contents of the current record, you change the field values 
 in the record buffer and then save the record buffer back to the table. 
 The procedure for changing a record is similar to entering a record:</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Put the table in 
 <span class=Bolded>Change</span> mode using the <a href="../Methods/TBL.CHANGE_BEGIN Method.html" title="TBL.CHANGE_BEGIN Method" class="wiki">&lt;TBL&gt;.CHANGE_BEGIN(</a>) 
 method.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Assign the field 
 values in the record buffer.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Complete the change 
 with the <a href="../Methods/TBL.CHANGE_END Method.html" title="TBL.CHANGE_END Method" class="wiki">&lt;TBL&gt;.CHANGE_END(</a>) 
 method; this will save the contents of the record buffer in the current 
 table record.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The following script 
 updates the records in the <span class=Code1>Product</span> table, changing 
 the value of each record's <span class=Code1>ON_SALE</span> field to FALSE 
 (.F.):</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.open("c:\a5\a_sports\product.dbf")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .NOT. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.on_sale = .F.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.change_end(.T.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>end while</td></tr>
</table>

<p>Once a table is in <span class=Bolded>Enter</span> or <span class=Bolded>Change</span> 
 mode, you cannot start another <span class=Bolded>Enter</span> or <span 
 class=Bolded>Change</span> operation on the same table in the same session, 
 until the preceding <span class=Bolded>Enter</span> or <span class=Bolded>Change</span> 
 is completed. This is an especially important issue when attaching your 
 scripts to buttons on forms. If your script will be entering or changing 
 records in the current table, you should first check to see if you are 
 already in <span class=Bolded>Enter</span> or <span class=Bolded>Change</span> 
 mode through the form. To check the data entry mode of the current session, 
 use the <a href="../Methods/TBL.MODE_GET Method.html" title="TBL.MODE_GET Method" class="wiki">&lt;TBL&gt;.MODE_GET(</a>) 
 method:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>if tbl.mode_get()> 0 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", "Already 
 in data entry mode.")</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.enter_begin()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'enter field values</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.enter_end(.T.)</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../../Unclassified/Rolling Back Enter and Change Operations.html" title="Rolling Back Enter and Change Operations" class="wiki">Rolling Back   Enter and Change Operations</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Entering+and+Changing+Records">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf","status":"pending"} --->
</body></html>