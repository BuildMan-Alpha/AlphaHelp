	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>OnKey Events on Forms</p>
<p class=A5>Handling Key Events</p>
<p>The general approach to intercepting and handling keystrokes in your 
 application is&nbsp;as&nbsp;follows: </p>

<ol>
<li>Test to see what key was pressed by examining the value in a_user.key.value. Keys such as 'Backspace', 'Up', 'Down' etc. will be represented using a curly bracket syntax (e.g. {Backspace}) </li>
<li>Tip: To get a list of key codes, right click in the Code Editor and select Genies, Insert Key code.. from the menu.</li>
<li>Write code that you want to execute if a particular key was pressed. Remember that your event handler will be called
multiple times for each key event ('down', 'repeat' and 'up'). The value of the key event is in a_user.key.event.</li>
<li>If you want to prevent Alpha Anywhere from passing the key on to the form, set a_user.key.handled to .t.. If this value is .f. then the key will be passed onto the form. Otherwise, the keystroke will not be passed onto the form.</li>
</ol>

<br>
<p>For example, this code intercepts the Shift+F10 key. The keystroke is NOT passed onto the form.</p>

<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">




<p class=Code>IF a_user.key.value = "{+F10}" THEN</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'set a_user.key.handled = .t. to prevent the key stroke being passed on to the Form</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_user.key.handled = .t.</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;IF a_user.key.event = "down" THEN</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("","User pressed shift+F10")</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;END IF</p>
<p class=Code>END IF</p>

</td>
</tr>


</table>

<p class=A5>Macro Recorder Example</p>



<p>Here is an example script that records and plays back keystroke macros 
 within a form. The script is defined in a form's <span class=Code1>OnKey</span> 
 event.</p>



<p class=Note><span class=Note>
<img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : This script 
 can be found in the Samples\Xbasic directory off the directory in which 
 you installed Alpha Anywhere.&nbsp;Open the Xbasic database and then open 
 the MacroExample form.</p>



<p class=A5>Application Help Example</p>



<p class=Note><span class=Note>
<img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The following 
 script is presented&nbsp;as&nbsp;an example of how to call the Windows 
 API.&nbsp;as&nbsp;a practical matter, in V5 the following script is obsolete 
 because V5 has a <a href="../Functions/WINHELP_SHOW Function.html" title="WINHELP_SHOW Function" class="wiki">WINHELP_SHOW(</a>) 
 function.</p>



<p>Here is a collection of examples scripts that intercepts the F1 key 
 and lets the application redefine HELP. The help topic is set by each 
 field's <span class=Code1>OnArrive</span> event, and cleared on the field's 
 <span class=Code1>OnDepart</span> event. In this example, it is assumed 
 that the Xbasic application <span class=Code1>programmer</span> has provided 
 a windows HELP file. :</p>



<p class=Note><span class=Note>
<img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : These scripts 
 can be found in the Samples\Xbasic directory off the directory in which 
 you installed Alpha Anywhere. Open the Xbasic database and then open the CustomHelp 
 form.</p>



<p><span class=Code1>OnKey</span> event for form:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' Declare the WinHelp function - Published windows</p>


<p class=Code>' function name is WinHelpA (A is for ASCII single byte)</p>


<p class=Code>' there is also a WinHelpW that is multibyte (i.e. Unicode)</p>


<p class=Code>' WinHelp is the name our Xbasic program uses</p>


<p class=Code>declare user32 WinHelp@WinHelpA LLCLL</p>


<p class=Code>' Define some useful constants</p>


<p class=Code>constant global HELP_COMMAND = 258</p>


<p class=Code>constant global HELP_KEY&nbsp;&nbsp;&nbsp;&nbsp;= 257</p>


<p class=Code>constant global HELP_PARTIAL_KEY = 261</p>


<p class=Code>constant global HELP_INDEX&nbsp;&nbsp;= 3</p>


<p class=Code>dim shared helptopic&nbsp;as&nbsp;C</p>


<p class=Code>HELP_FILENAME = :a5.get_path()+ "\invoice.hlp"</p>


<p class=Code>' If the user hit the {F1} key...</p>


<p class=Code>if (A_USER.KEY.value = "{F1}" ) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;' eat the key and invoke help with our 
 help file</p>


<p class=Code>&nbsp;&nbsp;&nbsp;A_USER.KEY.handled = .T.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;if (A_USER.KEY.event = "down") 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (helptopic 
 <> "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 if a topic is defined, use the topic in the help call</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinHelp(0, 
 HELP_FILENAME, HELP_PARTIAL_KEY,helptopic)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 If no help topic defined, then just show an index</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WinHelp(0, 
 HELP_FILENAME, HELP_INDEX,"")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</td></tr>
</table>

<p><span class=Code1>OnArrive</span> event for <span class=Code1>INV_NO</span> 
 field:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' Set the topic to be invoice numbers</p>


<p class=Code>dim shared helptopic&nbsp;as&nbsp;C</p>


<p class=Code>helptopic = "Invoice Numbers"</td></tr>
</table>

<p><span class=Code1>OnDepart</span> event for <span class=Code1>INV_NO</span> 
 field:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' No longer on the invoice number field, so un-define the 
 topic</p>


<p class=Code>dim shared helptopic&nbsp;as&nbsp;C</p>


<p class=Code>helptopic = ""</td></tr>
</table>

<p><span class=Code1>OnArrive</span> event for <span class=Code1>Vendor_ID</span> 
 field:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' Set the topic to be Vendor</p>


<p class=Code>dim shared helptopic&nbsp;as&nbsp;C</p>


<p class=Code>helptopic = "Vendor"</td></tr>
</table>

<p><span class=Code1>OnDepart</span> event for <span class=Code1>Vendor_ID</span> 
 field:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' No longer on the Vendor_ID field, so</p>


<p class=Code>' undefine the topic</p>


<p class=Code>dim shared helptopic&nbsp;as&nbsp;C</p>


<p class=Code>helptopic = ""</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/SYS_SEND_KEYS Function.html" title="SYS_SEND_KEYS Function" class="wiki">SYS_SEND_KEYS(</a>), <a href="../../What's New/What's New in Version 10/New in Xbasic V10/Ui_keycode_Normalize Function.html" title="Ui_keycode_Normalize Function" class="wiki">Ui_keycode_Normalize(</a>)</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:OnKey+Events+on+Forms">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>