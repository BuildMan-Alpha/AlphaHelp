	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Creating Charts with SimpleChart</p>



<p>The SimpleChart software allows you to:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>add bar, line, and pie 
 charts to forms</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>add bar, line, and pie 
 charts to web pages</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>update and re-display charts&nbsp;as&nbsp;data 
 changes</p>

</li>
</ul>

<p>The charting functionality is provided by the SimpleChart DLL ( <span 
 class=Code1>SimpleChart4Lite.dll</span> ). This library provides 4 top 
 level components:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>AxisChart ActiveX Control 
 - used to create form based Bar and/or Line charts.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>AxisChartGenerator COM 
 Object - used to create web based Bar and/or Line charts.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>PieChart ActiveX Control 
 - used to create form based Pie charts.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>PieChartGenerator COM Object 
 - used to create web based Pie charts.</p>

</li>
</ul>

<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Users of <span 
 class=Screen>Alpha Anywhere Runtime</span> will have to purchase a license 
 from <span class=Screen>Imagio Technology Limited</span> ( <a href="http://www.simplechart.net">http://www.simplechart.net</a>.)</p>



<p class=A5>AxisChart ActiveX Control</p>



<p>The AxisChart ActiveX Control allows you to easily create two dimensional 
 bar charts where the length of each bar represents the data values and 
 line charts where each data point is connected to the next using a straight 
 line. You can also use a combination of bar and line series on the same 
 chart (which is why it's called an AxisChart instead of BarChart or LineChart). 
  
 </p>



<p class=Pix><img src="images/UG_Simplechart_bar_chart.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 300px;
							height: 200px;
							float: none;
							border-style: none;
							border-style: none;"
					width=300
					height=200
					border=0></p>



<p class=Pix><img src="images/UG_Simplechart_Line_chart.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 300px;
							height: 200px;
							float: none;
							border-style: none;
							border-style: none;"
					width=300
					height=200
					border=0></p>



<p class=A5>PieChart ActiveX Control</p>



<p>The PieChart ActiveX Control allows you to easily create two dimensional 
 pie charts where each segment of the pie represents a data value.  
 </p>



<p class=Pix><img src="images/UG_Pie_chart_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 300px;
							height: 200px;
							float: none;
							border-style: none;
							border-style: none;"
					width=300
					height=200
					border=0></p>



<p class=Pix><img src="images/UG_Pie_chart_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 300px;
							height: 200px;
							float: none;
							border-style: none;
							border-style: none;"
					width=300
					height=200
					border=0></p>



<p class=A5>AxisChartDataItem</p>



<p>The AxisChartDataItem object represents a single data point on an axis 
 chart. With the AxisChartDataItem properties you can:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set the size of the bar 
 (or the line point if the data item is part of a line series) using the 
 Value property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set or retrieve the label 
 for the data item using the Name property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set whether the chart should 
 show or hide the data item using the Hidden property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Specify a URL to be called 
 when the chart is shown in a web browser and the user clicks on that data 
 item.</p>

</li>
</ul>

<p class=A5>AxisChartDataSeriesItem</p>



<p>The AxisChartDataSeriesItem object represents a single series of data 
 points on an axis chart. For example, if you wanted to chart the sales 
 of apples and oranges each year from 2001 to 2003 then you would uses 
 one AxisChartDataSeriesItem for apples and the other for oranges. Within 
 each series, AxisChartDataItem objects would represent the yearly sales 
 amounts. With the AxisChartDataSeriesItem properties you can:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Choose whether to draw 
 a series&nbsp;as&nbsp;bars or lines.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set the style, thickness 
 and color of the line if the data series is drawn&nbsp;as&nbsp;a line.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set the colors or image 
 used to draw each bar if the data series is drawn&nbsp;as&nbsp;bars.</p>

</li>
</ul>

<p class=A5>PieChartDataItem</p>



<p>Each PieChartDataItem object corresponds to one segment in a pie chart. 
 With the PieChartDataItem properties you can:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set the size of the pie 
 segment using the Value property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set or retrieve the label 
 for the data item using the Name property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Change the color of the 
 data item using the Color property.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Specify a URL to be called 
 when the chart is shown in a web browser and the user clicks on that data 
 item.</p>

</li>
</ul>

<p class=A5>ChartData Collection</p>



<p>The PieChart Control and the PieChartGenerator Object have a ChartData 
 collection made up of PieChartDataItem objects. Each PieChartDataItem 
 corresponds to one segment in the pie chart.</p>



<p>The collection has Add and Insert methods that allows new data values 
 and their labels to be added to the chart. Data items can be removed from 
 a chart using the Remove and Clear methods.</p>



<p class=A5>DataSeries Collection</p>



<p>The AxisChart control and the AxisChartGenerator object have a DataSeries 
 collection made up of AxisChartDataSeriesItem objects. Each AxisChartDataSeriesItem 
 corresponds to group of data points that make up the bars or a line in 
 the axis chart.</p>



<p>The collection has Add and Insert methods for adding new series to the 
 chart. Data series can be removed from a chart using the Remove and Clear 
 methods.</p>



<p>Since a series can be shown using either bars or a line, the Add method 
 is able to add a series item of either type but a large number of parameters 
 are required. Therefore, the collection has two other helper methods, 
 AddBarSeries and AddLineSeries which make adding either bar or line series 
 to the chart easier.</p>



<p class=A5>SeriesData Collection</p>



<p>An Axis chart can contain a number of data series which are accessed 
 through the DataSeries collection property of the Axis chart. Each of 
 these data series can themselves contain one or more data items, each 
 of which is represented by an AxisChartDataItem object. Data items within 
 a series are manipulated using the SeriesData collection property of the 
 series.</p>



<p>Each AxisChartDataItem object in the series represents either a bar 
 or a point on a line, depending on which type of series the data is part 
 of.</p>



<p>The SeriesData collection has Add and Insert methods that allows new 
 data items to be added to the chart. Data can be removed from a chart 
 using the Remove and Clear methods.</p>



<p class=A5><a name=Bar_Chart_Example>Bar Chart Example</a></p>



<p>The following example is based on the <span class=Code1>invoice_items</span> 
 table of the AlphaSports database. To create a bar chart:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Code1>Invoice</span> 
 form in the <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make the form wider, 
 so that there is room for the chart.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the ActiveX 
 <img src="images/ActiveX_tool_button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> tool from the <span class=Screen>Toolbox</span> and draw 
 the rectangle (approximately 3" wide and 4" high) that defines 
 the chart's boundaries.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Insert 
 ActiveX Control</span> dialog appears, click <span class=Button>Filter</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "simple" 
 and click <span class=Button>OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "SimpleChartLite 
 AxisChart4Control" and click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>It would be desirable 
 to refresh the chart each time you read a new record. To do this, right 
 click on the form and select <span class=Button>Events > OnFetch</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a pointer 
 variable and assign it to the new chart object. This example assumes that 
 the name of the new object is "activex1".</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>chart = activex1.activex.this</td></tr>
</table>

<ol start=9
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Next, you need to 
 add some data to the chart. Each data element is a pair of values: a number 
 and a label. Modify the script so it has the following code. The <span 
 class=Code1>inv</span> variable captures the value of the current <span 
 class=Code1>invoice_number</span> field, which is used in the filter expression 
 of the <a href="../Methods/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL   RECORD CONTENT GET(</a>) method. This method returns the value of the 
 <span class=Code1>description</span> field from the <span class=Code1>product</span> 
 table and the value of the <span class=Code1>extension</span> field from 
 the <span class=Code1>invoice_items</span> table. The two values are separated 
 by a pipe "|" character, to make them easy to separate.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</td></tr>
</table>

<ol start=10
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now add the data 
 to the table. Because you will add items to the chart with each <span 
 class=Code1>OnFetch</span> event, the first step is to clear the chart 
 of any items placed on it by the previous <span class=Code1>OnFetch</span> 
 event. The <span class=Code1>chart.DataSeries.clear()</span> statement 
 does this. The <span class=Code1>chart.DataSeries.AddBarSeries("Items", 
 0)</span> statement creates a set of data elements named "Items". 
 The <a href="../Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> 
 loop extracts each value pair from the list. The <span class=Code1>chart.DataSeries(1).SeriesData.Add(desc, 
 num)</span> statement adds the value pair to the set and the chart.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.DataSeries.clear()</p>


<p class=Code>' create one DataSeries for all data points</p>


<p class=Code>chart.DataSeries.AddBarSeries("Items", 0)</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val(word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' add all data points to DataSeries(1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries(1).SeriesData.Add(desc, 
 num)</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<p>At this point your chart should look something like the following. <a HREF="http://support.alphasoftware.com/imagesV8/XB_SimpleChart_Bar.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>



<p class=Pix><img src="images/XB_SimpleChart_Bar.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 356px;
							height: 458px;
							float: none;
							border-style: none;
							border-style: none;"
					width=356
					height=458
					border=0></p>



<p>A few changes can make the chart more appealing.</p>



<ol start=11
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the chart 
 while in design mode and select <span class=Button>ActiveX Properties...</span> 
 to display the <span class=Screen>SimpleChartLite AxisChart4 Control Properties</span> 
 dialog.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Appearance</span> tab and enter "Items in Order" 
 into the <span class=Control>Caption</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Axis Options</span> tab and enter "Dollars" into 
 the <span class=Control>Unit Axis Label</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Legend Properties</span> tab and select "3 - LegendBottom" 
 in the <span class=Control>Position</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click OK and save 
 the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The next step is 
 to change the way the data is added to the chart a new data series (or 
 "row") for each product. The script does this by modifying and 
 moving the <span class=Code1>chart.DataSeries.AddBarSeries(desc, 0)</span> 
 statement inside the loop. It changes the <span class=Code1>desc</span> 
 argument in the <span class=Code1>chart.DataSeries(k).SeriesData.Add(" 
 ", num)</span> statement to " " and the <span class=Code1>1</span> 
 to the counter <span class=Code1>k</span>.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>dim k&nbsp;as&nbsp;N = 1</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.DataSeries.clear()</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val(word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' create a new DataSeries for each 
 data point</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries.AddBarSeries(desc, 
 0)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' add each data point to a different 
 DataSeries</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries(k).SeriesData.Add(" 
 ", num)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;k = k + 1</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<p>The result should look something like this. </p>



<p class=Pix><img src="images/XB_SimpleChart_Bar_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 358px;
							height: 460px;
							float: none;
							border-style: none;
							border-style: none;"
					width=358
					height=460
					border=0></p>



<p class=A5><a name=Line_Chart_Example>Line Chart Example</a></p>



<p>The following example is based on the <span class=Code1>invoice_items</span> 
 table of the AlphaSports database. To create a bar chart:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Code1>Invoice</span> 
 form in the <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make the form wider, 
 so that there is room for the chart.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the ActiveX 
 <img src="images/ActiveX_tool_button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> tool from the <span class=Screen>Toolbox</span> and draw 
 the rectangle (approximately 3" wide and 4" high) that defines 
 the chart's boundaries.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Insert 
 ActiveX Control</span> dialog appears, click <span class=Button>Filter</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "simple" 
 and click <span class=Button>OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "SimpleChartLite 
 AxisChart4Control" and click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>It would be desirable 
 to refresh the chart each time you read a new record. To do this, right 
 click on the form and select <span class=Button>Events > OnFetch</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a pointer 
 variable and assign it to the new chart object. This example assumes that 
 the name of the new object is "activex1".</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>chart = activex1.activex.this</td></tr>
</table>

<ol start=9
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Next, you need to 
 add some data to the chart. Each data element is a pair of values: a number 
 and a label. Modify the script so it has the following code. The <span 
 class=Code1>inv</span> variable captures the value of the current <span 
 class=Code1>invoice_number</span> field, which is used in the filter expression 
 of the <a href="../Methods/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL   RECORD CONTENT GET(</a>) method. This method returns the value of the 
 <span class=Code1>description</span> field from the <span class=Code1>product</span> 
 table and the value of the <span class=Code1>extension</span> field from 
 the <span class=Code1>invoice_items</span> table. The two values are separated 
 by a pipe "|" character, to make them easy to separate.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</td></tr>
</table>

<ol start=10
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now add the data 
 to the table. Because you will add items to the chart with each <span 
 class=Code1>OnFetch</span> event, the first step is to clear the chart 
 of any items placed on it by the previous <span class=Code1>OnFetch</span> 
 event. The <span class=Code1>chart.DataSeries.clear()</span> statement 
 does this. The <span class=Code1>chart.DataSeries.AddLineSeries("Line", 
 0)</span> statement creates a set of data elements named "Line". 
 The <a href="../Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> 
 loop extracts each value pair from the list. The <span class=Code1>chart.DataSeries(1).SeriesData.Add(desc, 
 num)</span> statement adds the value pair to the set and the chart.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>dim c&nbsp;as&nbsp;colordefinition</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.DataSeries.clear()</p>


<p class=Code>c.name = "Black"</p>


<p class=Code>chart.DataSeries.AddLineSeries("Line", c.RGB_Value, 
 3, 0)</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val(word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries(1).SeriesData.Add(desc, 
 num)</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<ol start=11
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your event script 
 and return to the <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the ActiveX 
 control and select <span class=Button>ActiveX Properties...</span> .</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Appearance</span> 
 tab enter "Values of Items in Order" in the <span class=Control>Caption</span> 
 field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Legend 
 Properties</span> tab clear the <span class=Control>Show Legend</span> 
 check box and click <span class=Button>OK</span>.</p>

</li>
</ol>

<p>At this point your chart should look something like the following. <a HREF="http://support.alphasoftware.com/imagesV8/XB_SimpleChart_Line.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>



<p class=Pix><img src="images/XB_SimpleChart_Line.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 362px;
							height: 463px;
							float: none;
							border-style: none;
							border-style: none;"
					width=362
					height=463
					border=0></p>



<p>You can combine the line chart with a bar chart. Change the <span class=Button>OnFetch</span> 
 event script&nbsp;as&nbsp;follows. The <span class=Code1>chart.DataSeries.AddBarSeries("Bar", 
 0)</span> statement adds the bar data elements. The <span class=Code1>chart.DataSeries(2).SeriesData.Add(desc, 
 num)</span> statement sets the value of these data elements.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>dim c&nbsp;as&nbsp;colordefinition</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.DataSeries.clear()</p>


<p class=Code>c.name = "Black"</p>


<p class=Code>chart.DataSeries.AddLineSeries("Line", c.RGB_Value, 
 3, 0)</p>


<p class=Code>chart.DataSeries.AddBarSeries("Bar", 0)</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val(word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries(1).SeriesData.Add(desc, 
 num)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.DataSeries(2).SeriesData.Add(desc, 
 num)</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<p>The result should look something like this. </p>



<p class=Pix><img src="images/XB_SimpleChart_Line_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 359px;
							height: 462px;
							float: none;
							border-style: none;
							border-style: none;"
					width=359
					height=462
					border=0></p>



<p class=A5><a name=Pie_Chart_Example>Pie Chart Example</a></p>



<p>The following example is based on the <span class=Code1>invoice_items</span> 
 table of the AlphaSports database. To create a bar chart:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Code1>Invoice</span> 
 form in the <span class=Screen>Form Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Make the form wider, 
 so that there is room for the chart.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the ActiveX 
 <img src="images/ActiveX_tool_button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> tool from the <span class=Screen>Toolbox</span> and draw 
 the rectangle (approximately 3" wide and 4" high) that defines 
 the chart's boundaries.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Insert 
 ActiveX Control</span> dialog appears, click <span class=Button>Filter</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter "simple" 
 and click <span class=Button>OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "SimpleChartLite 
 PieChart4Control" and click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>It would be desirable 
 to refresh the chart each time you read a new record. To do this, right 
 click on the form and select <span class=Button>Events > OnFetch</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a pointer 
 variable and assign it to the new chart object. This example assumes that 
 the name of the new object is "activex1".</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>chart = activex1.activex.this</td></tr>
</table>

<ol start=9
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Next, you need to 
 add some data to the chart. Each data element is a pair of values: a number 
 and a label. Modify the script so it has the following code. The <span 
 class=Code1>inv</span> variable captures the value of the current <span 
 class=Code1>invoice_number</span> field, which is used in the filter expression 
 of the <a href="../Methods/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL   RECORD CONTENT GET(</a>) method. This method returns the value of the 
 <span class=Code1>description</span> field from the <span class=Code1>product</span> 
 table and the value of the <span class=Code1>extension</span> field from 
 the <span class=Code1>invoice_items</span> table. The two values are separated 
 by a pipe "|" character, to make them easy to separate.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</td></tr>
</table>

<ol start=10
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now add the data 
 to the table. Because you will add items to the chart with each <span 
 class=Code1>OnFetch</span> event, the first step is to clear the chart 
 of any items placed on it by the previous <span class=Code1>OnFetch</span> 
 event. The <span class=Code1>chart.DataSeries.clear()</span> statement 
 does this. The <span class=Code1>chart.DataSeries.AddBarSeries("Items", 
 0)</span> statement creates a set of data elements named "Items". 
 The <a href="../Xbasic/FOR EACH __ELLIPSES__ NEXT.html" title="FOR EACH ... NEXT" class="wiki">FOR EACH ... NEXT</a> 
 loop extracts each value pair from the list. The <span class=Code1>chart.DataSeries(1).SeriesData.Add(desc, 
 num)</span> statement adds the value pair to the set and the chart.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.ChartData.clear()</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.ChartData.add(desc, num, 0)</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<p>At this point your chart should look something like the following. <a HREF="http://support.alphasoftware.com/imagesV8/XB_SimpleChart_Bar.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>



<p class=Pix><img src="images/XB_SimpleChart_Pie.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 365px;
							height: 425px;
							float: none;
							border-style: none;
							border-style: none;"
					width=365
					height=425
					border=0></p>



<p>A few changes can make the chart more appealing.</p>



<ol start=11
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click the chart 
 while in design mode and select <span class=Button>ActiveX Properties...</span> 
 to display the <span class=Screen>SimpleChartLite PieChart4 Control Properties</span> 
 dialog.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Appearance</span> tab and enter "Items in Order" 
 into the <span class=Control>Caption</span> field.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Legend Properties</span> tab and select "3 - LegendBottom" 
 in the <span class=Control>Position</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 and save the form.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim chart&nbsp;as&nbsp;P</p>


<p class=Code>dim list&nbsp;as&nbsp;C</p>


<p class=Code>dim inv&nbsp;as&nbsp;C</p>


<p class=Code>dim desc&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;N</p>


<p class=Code>chart = activex1.activex.this</p>


<p class=Code>inv = Invoice_Header->INVOICE_NUMBER</p>


<p class=Code>list = set.external_record_content_get("items-product", 
 "product->description + '|' + invoice_items->extension", 
 "invoice_items->extension", "invoice_items->invoice_number 
 = " + quote(inv) )</p>


<p class=Code>chart.ChartData.clear()</p>


<p class=Code>for each x in list</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;desc = word(x, 1, "|")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = val( word(x, 2, "|") )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;chart.ChartData.add(desc, num, 0)</p>


<p class=Code>next</p>


<p class=Code>chart.refresh()</td></tr>
</table>

<p>The result should look something like this. </p>



<p class=Pix><img src="images/XB_SimpleChart_Pie_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 367px;
							height: 427px;
							float: none;
							border-style: none;
							border-style: none;"
					width=367
					height=427
					border=0></p>



<p class=A5>See Also</p>



<p><a href="http://downloads.alphasoftware.com/A5V7Download/simplechart4.chm">SimpleChart4.CHM</a>, 
 <a href="../Action Scripting Reference (Desktop)/SimpleChart Style Xdialog.html" title="SimpleChart Style Xdialog" class="wiki">SimpleChart   Style Xdialog</a>, <a href="../../Unclassified/Placing SimpleCharts on a Web Page.html" title="Placing SimpleCharts on a Web Page" class="wiki">Placing   SimpleCharts on a Web Page</a></p>



	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+Charts+with+SimpleChart">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending"} --->
</body></html>