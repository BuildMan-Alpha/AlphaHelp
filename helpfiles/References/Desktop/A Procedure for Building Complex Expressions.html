	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>A Procedure for Building Complex Expressions</p>



<p>Filter expressions are character strings. However, it is often very 
 difficult to compose a filter expression. Handling quotes and variable 
 names becomes confusing. The following procedure, written by Cal Locklin, 
 makes the process easier and more understandable.</p>



<p>The desired result of a filter expression - like when you want to pass 
 a filter to a report - is a character string. The result that is passed 
 to the report must be exactly the same&nbsp;as&nbsp;if you typed it into 
 the report filter itself. This is an important concept because many people 
 forget that the report has no idea what the variables were in the script 
 that called the report unless those variables were dimensioned&nbsp;as&nbsp;GLOBAL. 
 So a filter like this...</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>DIM first_date&nbsp;as&nbsp;D</p>


<p class=Code>first_date_c = ui_get_date()</p>


<p class=Code>first_date = ctod( first_date )</p>


<p class=Code>filter = "between( order_date, first_date, date())"</p>


<p class=Code>report.preview( "Order_list", filter )</td></tr>
</table>

<p>will not work because the report has no idea what <span class=Code1>first_date</span> 
 refers to. In fact, the report would look for a FIELD named "first_date".</p>



<p>For the purpose of this example, we will pass the date using the <span 
 class=Code1>CTOD("01/01/2002")</span> function to demonstrate 
 the use of quotes in the expression.</p>



<p>We would normally enclose the date value in quotes, BUT, since the whole 
 string is enclosed in quotes, how will Alpha Five know which quote is 
 to be used for what? The easiest solution is that any quotes which will 
 be a part of the final text string sent to the report (or wherever it 
 will ultimately be used) must be a single quote. This way Alpha Five can 
 determine which quotes are which and properly construct the final string 
 to be sent.</p>



<p>The way I like to start out - especially with complex filters - is to 
 construct the filter just&nbsp;as&nbsp;though I were typing it into the 
 report filter:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>between( order_date, ctod("01/01/2002"), date())</td></tr>
</table>

<p>Now change all the quotes to single quotes:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>between( order_date, ctod('01/01/2002'), date())</td></tr>
</table>

<p>Now take out the variable 'stuff' and put double quotes around what's 
 left:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>"between( order_date, ctod('" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"'), 
 date())"</td></tr>
</table>

<p>Now, fill the gap with the value you need - including the + signs to 
 concatenate it all:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>"between( order_date, ctod('" + first_date_c + 
 "'), date())"</td></tr>
</table>

<p>Now just add <span class=Code1>filter =</span> and you're done:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>filter = "between( order_date, ctod('" + first_date_c 
 + "'), date())"</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Functions/S_QUOTE Function.html" title="S_QUOTE Function" class="wiki">S_QUOTE(</a>)</p>



<p class=A5>Thanks To</p>



<p>Cal Locklin at </p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:A+Procedure+for+Building+Complex+Expressions">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>