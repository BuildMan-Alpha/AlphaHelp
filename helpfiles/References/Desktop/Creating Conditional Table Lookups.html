	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Creating Conditional Table Lookups</p>



<p>When one of several tables might supply the field's value, use a Conditional 
 table lookup. Instead of choosing one lookup table, you complete the Table 
 Conditions table, filling in the names of two or more tables along with 
 a Conditional expression for each that determines which table is used 
 for the lookup. The tables you use must have the same field names and 
 types since there is only one field mapping.</p>



<p>Defining a Conditional table lookup involves:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Completing the Conditional 
 Tables table</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Specifying a linking field</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Specifying the display 
 order of lookup table records (optional)</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Mapping the fields</p>

</li>
</ul>

<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you selected "Conditional 
 Table Lookup", select the first table that is providing the information 
 in the <span class=Control>Table</span> column. Click <img src="images/Folder_button.gif"
															x-maintain-ratio=TRUE
															style="border: none;
	width: 22px;
	height: 22px;
	float: none;
	border-style: none;
	border-style: none;"
															width=22
															height=22
															border=0> to 
 navigate to and select the table. Typically, the lookup table has a field 
 in common with the fill (destination) table.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Condition</span> 
 column, enter a condition that defines when to use this particular table 
 for the value lookup. Click <img src="ex<x>pression_Button_black.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 22px;
											height: 22px;
											float: none;
											border-style: none;
											border-style: none;"
									width=22
									height=22
									border=0> to use the <span   class=Screen><a href="../../Tutorials/Alpha Five User Guide (Desktop)/Alpha Five Basics/Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a></span> to help construct an expression. 
 When you specify the expression that determines in which table Alpha Five 
 will perform the lookup, you might find the Alpha Five system variable, 
 <span class=Code1>a_field_value</span> to be useful. This variable contains 
 the value in the current field. For example, the following shows how a 
 conditional table lookup could be defined. If the part number that was 
 entered into the lookup field is found in the <span class=Code1>wholesale_price.dbf</span> 
 table, then that table is used&nbsp;as&nbsp;the lookup table. Otherwise, 
 the <span class=Code1>retail_price.dbf</span> table is used.</p>

</li>
</ol>


<table style="x-cell-content-align: Top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 121.6pt;">
<col style="width: 471.7pt;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 162px;" valign="top" width="162px">
<p class=TableHead>Lookup Table</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 628px;" valign="top" width="628px">
<p class=TableHead>Conditional Expression</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 162px;" valign="top" width="162px"><span class=Code1>Wholesale_price.dbf</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 628px;" valign="top" width="628px"><span class=Code1>Exist(var->a_field_value,"wholesale_price.dbf", 
 "partno")</span></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 162px;" valign="top" width="162px"><span class=Code1>Retail_price.dbf</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 628px;" valign="top" width="628px"><span class=Code1>.t.</span></td></tr>
</table>

<ol start=3>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Repeat steps 1 and 
 2 for each additional table that you want to use conditionally.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Control>Linking 
 Field</span> for a Conditional table lookup has the same purpose&nbsp;as&nbsp;the 
 linking field for a table lookup. When defining a Conditional table lookup, 
 you select the linking field from the first lookup table you listed in 
 the Conditional Tables table. This linking field <span class=Bolded>must 
 exist in all lookup tables</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, enter 
 a field name or <a href="../../Unclassified/Writing Expressions.html#Character_Order_Expressions" title="Writing Expressions" class="wiki">character   order expression</a> in the <span class=Control>Display Order</span> field 
 that will order the list that you retrieve from the lookup table. Click 
 <img src="ex<x>pression_Button_black.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> to use the <span   class=Screen><a href="../../Tutorials/Alpha Five User Guide (Desktop)/Alpha Five Basics/Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a></span> to help construct an expression.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, in the 
 <span class=Control>Filter</span> field enter a <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> that will select records for the list that you retrieve 
 from the lookup table. Click <img src="ex<x>pression_Button_black.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 22px;
											height: 22px;
											float: none;
											border-style: none;
											border-style: none;"
									width=22
									height=22
									border=0> to use the <span   class=Screen><a href="../../Tutorials/Alpha Five User Guide (Desktop)/Alpha Five Basics/Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a></span> to help construct an expression.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Source</span> 
 column of the next embedded browse, click <img src="images/List_Button_Blue_Down.gif"
												x-maintain-ratio=TRUE
												style="border: none;
														width: 22px;
														height: 22px;
														float: none;
														border-style: none;
														border-style: none;"
												width=22
												height=22
												border=0> to select the 
 fields from the lookup (source) table that you want to use. Place each 
 field in a separate row. Since the structure of all the Conditional lookup 
 tables must have fields in common, you complete the Field Mapping table 
 just once, selecting the source fields from the first lookup table you 
 listed. All the other conditional tables will be mapped in the same way.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Fill</span> 
 column, to the right of each Source entry, click <img src="images/List_Button_Blue_Down.gif"
														x-maintain-ratio=TRUE
														style="border: none;
	width: 22px;
	height: 22px;
	float: none;
	border-style: none;
	border-style: none;"
														width=22
														height=22
														border=0> to select 
 the fields from the current (fill) table that you want to fill.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Display</span> 
 column, to the right of each Fill entry, select "Yes" or "No" 
 to indicate whether this field will be visible in the user's selection 
 list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, in the 
 <span class=Control>Width</span> column specify the width (in characters) 
 that each displayed field will have in the user's selection list. If you 
 do not enter a setting, the entire field is displayed.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, use the 
 <span class=Control>Condition</span> column in the embedded browse to 
 specify that a record may not be included in the selection list. It will 
 only appear if the <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character   filter expression</a> you write evaluates to TRUE (.T.). Refer to <a href="../../Orphans/Displaying Selected LookupTable Records _Filtered   Lookups_.html" title="Displaying Selected LookupTable Records _Filtered   Lookups_" class="wiki">Displaying   Selected Lookup Table Records (Filtered Lookups</a>).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, check 
 <span class=Button>User can add records</span> if you would like the user 
 to be able to add more entries to the lookup table.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, check 
 <span class=Button>User can edit records</span> if you would like the 
 user to be able to modify entries to the lookup table.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, check 
 <span class=Button>Unique records only</span> if you want to avoid duplicate 
 entries in the lookup list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you checked <span 
 class=Button>User can add records</span>, make a selection from <span 
 class=Control>Form layout to edit records</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, change 
 the selection in <span class=Control>Allow Exceptions</span>. The options 
 are:</p>

</li>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Allow any value"</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Force closest 
 match"</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Popup on mismatch"</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Allow any/fill 
 only on popup"</p>

</li>
	</ul>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, make 
 a selection from <span class=Control>Auto popup</span>. Specify whether 
 the Lookup window displays on demand or automatically. The options are:</p>

</li>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Do not automatically 
 popup" - The Lookup window displays on demand. You must click the 
 Pop-up smart button attached to the Lookup field. This is the default.</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Popup on entrance" 
 - The Lookup window displays every time the cursor enters the field.</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Popup conditionally 
 on entrance" - Build a conditional expression that determines whether 
 the window displays automatically. For example, the Pop-up condition: 
 <span class=Code1>ISBLANK("CUST_ID")</span> causes the Customer 
 Lookup window to appear only if the <span class=Code1>Cust_ID</span> field 
 is empty.</p>

</li>
	</ul>
	
	<ol>
		
		<li><p>If you selected 
 "Popup conditionally on entrance" in step 9b, enter an expression 
 that defines the <span class=Control>Popup condition</span>. The expression 
 must resolve to either TRUE (.T.) or FALSE (.F.). Click to display the 
 <span class=Screen><a href="../../Tutorials/Alpha Five User Guide (Desktop)/Alpha Five Basics/Expression Builder.html" title="Expression Builder" class="wiki">Expression   Builder</a></span> to help you define the expression.</p>

</li>
		
		<li><p>Optionally, select 
 a value from the <span class=Control>Position</span> list to indicate 
 where the Lookup window should appear. The listed positions are relative 
 to the Alpha Five Main Application window. The options are:</p>

</li>
		
		<ul style="list-style: disc;"
			type=disc>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Cascading" 
 - displays the window just below the form window title, so that both title 
 bars are visible.</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Top left"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Top center"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Top right"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Middle left"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Middle center"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Middle right"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Bottom left"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Bottom center"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Bottom right"</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Custom" 
 - lets you specify the position of the Lookup window in inches or centimeters. 
 Indicate the distance from the upper-left corner of the layout window 
 both horizontally (X) and vertically (Y).</p>

</li>
			
			<li class=kadov-p-CBullet1><p class=Bullet1>"Sticky" 
 - the popup remembers and reappears at its last position</p>

</li>
		</ul>
		
		<li><p>If you selected 
 "Custom" in step 9d, enter position values in the <span class=Button>Custom 
 X</span> and <span class=Button>Custom Y</span> fields. Enter dimension 
 values in the <span class=Button>Custom Width</span> and <span class=Button>Custom 
 Height</span> fields.</p>

</li>
		
		<li><p>Clear <span class=Button>Allow 
 maximized display</span> if you want to prevent the popup dialog from 
 being maximized.</p>

</li>
	</ol>
</ol>

<p class=A5>See Also</p>



<p><a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing Expressions</a></p>



	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Creating+Conditional+Table+Lookups">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>