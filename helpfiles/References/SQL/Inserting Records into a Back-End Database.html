	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Inserting Records into a Back-End Database</p>



<p>To insert records into a back-end database, you use the <a href="../../Unclassified/Supported Portable SQL Syntax.html#Insert_Syntax" title="Supported Portable SQL Syntax" class="wiki">SQL   INSERT</a> command. The general syntax of the INSERT command is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>INSERT INTO tablename (field1, field2, field3....) VALUES 
 (value1, value2, value3....)</td></tr>
</table>

<p>Let us insert a new record into the <span class=Code1>customer</span> 
 table. First, we will get a count of the number of records in the table. 
 In the <span class=Screen>Interactive</span> window execute a query to 
 get the number of records in the customer table.</p>



<p>The <a href="../Functions/Portability Functions.html" title="Portability Functions" class="wiki">count(*</a>) function 
 is one of the AlphaDAO <a href="../Functions/Portability Functions.html" title="Portability Functions" class="wiki">Portability   Functions</a>. It returns the table's record count. The result set contains 
 one row with one field, which contains the answer. The first field is 
 <span class=Code1>data(1)</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>dim rs&nbsp;as&nbsp;SQL::ResultSet</p>


<p class=Code>dim qry&nbsp;as&nbsp;C</p>


<p class=Code>? conn.open("{A5API=Access,FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb',UserName='Admin'}")</p>


<p class=Code>= .T.</p>


<p class=Code>qry = "select count(*) from customer"</p>


<p class=Code>conn.Execute(qry)</p>


<p class=Code>? conn.ResultSet.data(1)</p>


<p class=Code>= 62</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>The following script inserts a new record and then displays the result 
 set. First, dim variables.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>dim sql_insert&nbsp;as&nbsp;C</p>


<p class=Code>dim qry&nbsp;as&nbsp;C</p>


<p class=Code>dim rs&nbsp;as&nbsp;SQL::ResultSet</td></tr>
</table>

<p>Next, open the connection and define the SQL INSERT command. Note the 
 syntax of the command. The fields that will receive data and the corresponding 
 values are in two comma delimited sets.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.open("{A5API=Access,FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb',UserName='Admin'}")</p>


<p class=Code>sql_insert = "insert into customer (firstname, lastname, 
 bill_city, bill_postal_code, bill_state_region) values ('George', 'Jones', 
 'Arlington', '02000', 'VA')"</td></tr>
</table>

<p>Insert the new record into the table with the <a href="../Functions/SQL Connection Execute Function.html" title="SQL Connection Execute Function" class="wiki">.Execute(</a>) 
 method.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? conn.execute(sql_insert)</p>


<p class=Code>= .T.</td></tr>
</table>

<p>To view the results, execute a new query and preview the <span class=Code1>ResultSet</span>. 
 </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>qry = "select * from customer WHERE firstname = 'George'"</p>


<p class=Code>? conn.execute(qry)</p>


<p class=Code>= .T.</p>


<p class=Code>rs = conn.resultset</p>


<p class=Code>SQL_ResultSet_Preview(rs)</td></tr>
</table>

<p class=Pix><img src="images/CST_After_Insert.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 661px;
							height: 109px;
							float: none;
							border-style: none;
							border-style: none;"
					width=661
					height=109
					border=0></p>



<p>Close the connection.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.close()</td></tr>
</table>

<p>Things of note about this code are:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Note that we did not insert 
 a value into the <span class=Code1>customer_id</span> field. The reason 
 is that this field was defined&nbsp;as&nbsp;an auto-increment field, which 
 means you cannot assign it a value. Its value is automatically assigned 
 by the back-end database engine.</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>We did not assign values 
 to all of the fields in the table. In this case, this worked because the 
 fields were not defined&nbsp;as&nbsp;required fields. Had any of the omitted 
 fields been required, the insert would have failed.</p>

</li>
</ul>


<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>See Also</p>



<p><a href="../../Orphans/Working with SQL Databases Title.html" title="Working with SQL Databases Title" class="wiki">Working with SQL Databases</a>, 
 <a href="../Functions/SQL Connection Execute Function.html" title="SQL Connection Execute Function" class="wiki">SQL::Connection::Execute(</a>)</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Inserting+Records+into+a+Back-End+Database">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","status":"accept","keywords":"server,design,ref,sql","group":"/Reference/Server/Design/Data/SQL/"} --->
</body></html>