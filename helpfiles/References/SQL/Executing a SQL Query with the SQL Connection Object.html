	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Executing a SQL Query with the SQL::Connection Object</p>



<p>Return to the <span class=Screen>Interactive</span> window and open 
 a new connection to AlphaSports.MDB.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>conn.open("{A5API=Access, FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb', 
 UserName='Admin'}")</td></tr>
</table>

<p>If you had defined and saved a named connection string with the contents 
 <span class=Code1>{A5API=Access, FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb', 
 UserName='Admin'}</span> and the name <span class=Code1>AlphaSports</span>, 
 you could also execute this statement and achieve the same result.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>conn.open("::name::alphasports")</td></tr>
</table>

<p>Next, send a SQL SELECT query to the database. Add these 3 lines:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim qry&nbsp;as&nbsp;C</p>


<p class=Code>qry = "select * from customer"</p>


<p class=Code>? conn.Execute(qry)</p>


<p class=Code>= .T.</td></tr>
</table>

<p>At this point you have selected (not retrieved) all the records in the 
 <span class=Code1>customer</span> table. The asterisk (*) is a wildcard 
 character that says to retrieve all the fields (or columns) of each record.</p>



<p>Note how the <span class=Code1>Execute()</span> method returned <span 
 class=Code1>.T.</span> . Almost all AlphaDAO object methods return TRUE 
 or FALSE, to indicate whether the operation succeeded or failed.</p>



<p class=A5>Look at the Data</p>



<p>The SQL::Connection object returns pointers to the selected data in 
 its <span class=Code1>ResultSet</span> property. This property is, in 
 fact, another AlphaDAO object of type <a href="../Objects/SQL ResultSet Object.html" title="SQL ResultSet Object" class="wiki">SQL::ResultSet</a>. 
 To view the data, type this line. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>SQL_ResultSet_Preview(conn.ResultSet)</td></tr>
</table>

<p class=Pix><img src="images/CST_Preview_ResultSet.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 705px;
							height: 295px;
							border-style: none;
							border-style: none;"
					width=705
					height=295
					border=0></p>



<p class=A5>Retrieve the Data</p>



<p>If you tried to repeat the previous command, you would discover that 
 it did not return any data. An important fact to remember about a SQL 
 <span class=Code1>ResultSet</span> is that usually you can read it only 
 once, starting from any point, but moving only towards the end.</p>



<p>If you repeat the <span class=Code1>Execute()</span> method, you will 
 refresh the <span class=Code1>ResultSet</span>. This time you can retrieve 
 it into a CR-LF delimited list.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>dim qry&nbsp;as&nbsp;C</p>


<p class=Code>conn.open("{A5API=Access,FileName='C:\Program Files\a5v8\MDBFiles\Alphasports.mdb',UserName='Admin'}")</p>


<p class=Code>qry = "select * from customer"</p>


<p class=Code>? conn.Execute(qry)</p>


<p class=Code>= .T.</td></tr>
</table>

<p>The SQL::ResultSet object has a method named <a href="../Functions/SQL ResultSet ToString Function.html" title="SQL ResultSet ToString Function" class="wiki">.ToString(</a>) 
 that will retrieve its contents into a character list.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim data&nbsp;as&nbsp;C</p>


<p class=Code>data = conn.resultset.ToString()</td></tr>
</table>

<p>Looking at the <span class=Code1>data</span> variable, you will see 
 something like this. Tabs separate the columns. You have now retrieved 
 data that you can process with a standard Xbasic script.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>? data</p>


<p class=Code>= 1 Michael Graham &nbsp;&nbsp;&nbsp;&nbsp;(617) 
 555-1445 &nbsp;&nbsp;(617) 
 223-1919 83 Cambridge St Apt 4. New York NY 01000 14 Winman St. Apt 4. 
 Natick MA 01760 F</p>


<p class=Code>2 &nbsp;&nbsp;Sally 
 &nbsp;&nbsp;Peabody 
 &nbsp;&nbsp;&nbsp;(617) 
 555-0089 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1876 
 Princeton St. London MA 02401-1966 1876 Princeton St. Brockton MA 02401-1966 
 F</p>


<p class=Code>3 &nbsp;&nbsp;Janet 
 &nbsp;&nbsp;Rebo 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(603) 
 555-7100 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37 
 Washington Post Road Apt. 18 Keene NH 03431 T</p>


<p class=Code>...</p>


<p class=Code>conn.close()</td></tr>
</table>

<p>Close the connection.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>conn.close()</td></tr>
</table>


<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>See Also</p>



<p><a href="../../Orphans/Working with SQL Databases Title.html" title="Working with SQL Databases Title" class="wiki">Working with SQL Databases</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Executing+a+SQL+Query+with+the+SQL+Connection+Object">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>