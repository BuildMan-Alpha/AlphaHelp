	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1><b>AlphaDAO - SQL Server - Identity Fields - Triggers</b>&nbsp;</h1>
There is a bug in SQL Server when you get the value of the last inserted identity column value under the following situation. Say you have a table (called say, 'MasterTable'). 'MasterTable' has an identity column. 'MasterTable' also has an Insert Trigger which inserts a new record into a table (called say, 'ChildTable'). 'ChildTable' also has an identity column. When you insert a record into 'MasterTable', the following AlphaDAO command can be used to get the value of the last inserted identity column:
<p style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: 0.5in; margin-top: 0px; margin-bottom: 5px; "><SQL::Connection>.CallResult.LastInsertedIdentity</p>
<p style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: 0.5in; margin-top: 0px; margin-bottom: 5px; ">The SQL Server bug is that this command will return the value of the identity value inserted into 'ChildTable' and not 'MasterTable', as you would expect.</p>
<p style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: 0.5in; margin-top: 0px; margin-bottom: 5px; ">Microsoft does not have a fix for this. The problem affects Grid components because retrieving the value of the last inserted identity field is crucial to many aspects of the Grid performance.</p>
<p style="font-family: Tahoma; width: 7in; font-size: 9pt; margin-left: 0.5in; margin-top: 0px; margin-bottom: 5px; ">The suggested work around is to not use identity columns in tables that are manipulated by triggers. Instead you could use GUIDs for the primary keys of these tables.
<br><br>This bug has been fixed in Version 11.
</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:AlphaDAO+SQL+Server+Identity+Fields+Triggers+Bug">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","status":"accept","keywords":"server,design,ref,sql","group":"/Reference/Server/Design/Data/SQL/"} --->
</body></html>