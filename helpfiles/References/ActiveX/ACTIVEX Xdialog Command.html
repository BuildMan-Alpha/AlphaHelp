	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Function>{ACTIVEX}</p>



<p class=A5>Syntax</p>



<p>{ActiveX= <span class=Argument>Width</span>, <span class=Argument>Height</span> 
 <span class=Argument>ObjectName</span> }</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Argument</td>
<td colspan="1" class="TableHeader" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHeadCenter>Type</td>
<td colspan="2" class="TableHeader" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Width</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>An integer value for the maximum number of characters 
 to display on one line. The actual number displayed may be less because 
 of word wrap.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Height</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = 1. The number of rows to display. 
 This may be a fractional number, such&nbsp;as&nbsp;1.25.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" rowspan="5" colspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>ObjectName</span></td>
<td colspan="1" class="TableCell" rowspan="5" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>P</td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A pointer variable with the following properties.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" class="TableHeader" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Property</td>
<td class="TableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Object</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A pointer to the ActiveX object, which provides various 
 properties and methods, depending on the control.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Class</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A character value that contains the name of the class 
 of the ActiveX object.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Events</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">The Events property is a script that contains a set of functions, 
 one for each event you wish to respond to. Each function is what the consumer 
 of the control would like to have happen whenever the event is published 
 by the control. The specific ActiveX determines which functions are available 
 to implement.</td></tr>
</table>

<p class=A5>Description</p>



<p>The {ActiveX} command displays an ActiveX control on an Xdialog.</p>



<p class=A5><a name=Using_ActiveX_Control_Events>Using ActiveX Control 
 Events</a></p>



<p>The ActiveX control should provide documentation on its events and the 
 appropriate arguments. If this information is lacking, you can place the 
 ActiveX control on an Alpha Anywhere desktop form, which will generate the 
 list of event functions. After placing the ActiveX control on the page, 
 right click on the control and select <span class=Button>Events > ActiveXEvent</span>. 
 If the control has any events, you will see a script similar to the following.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function contextmenuaction&nbsp;as&nbsp;v (itemIndex&nbsp;as&nbsp;N)</p>


<p class=Code>end function</p>


<p class=Code>function displaychanged&nbsp;as&nbsp;v ()</p>


<p class=Code>end function</p>


<p class=Code>function documentcomplete&nbsp;as&nbsp;v ()</p>


<p class=Code>end function</p>


<p class=Code>function onblur&nbsp;as&nbsp;v ()</p>


<p class=Code>end function</p>


<p class=Code>...</td></tr>
</table>

<p>Note: Hopefully, your ActiveX control's documentation will make it clear 
 when events fire, and suggest how and why to use them. Write code for 
 only those events you want to use.</p>



<p>If you want to write code to respond to any of the ActiveX control's 
 events, here is an example using the <span class=Screen>Mabry Grid</span> 
 (note the code setting <span class=Code1>Grid.Events</span> ). In this 
 case the <span class=Screen>Mabry Grid</span> publishes an event called 
 <span class=Code1>UnboundReadData</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim vl&nbsp;as&nbsp;P</p>


<p class=Code>vl = local_variables()</p>


<p class=Code>dim shared t&nbsp;as&nbsp;P</p>


<p class=Code>' The Grid control</p>


<p class=Code>dim grid&nbsp;as&nbsp;P</p>


<p class=Code>dim grid.object&nbsp;as&nbsp;P</p>


<p class=Code>dim grid.class as C</p>


<p class=Code>grid.class = "mabry.gridx"</p>


<p class=Code>dlg_title = "Budget Data"</p>


<p class=Code>' Grid Control Event Handlers</p>


<p class=Code>grid.events = <<%code%</p>


<p class=Code>Function UnboundReadData&nbsp;as&nbsp;v (nRowIndex&nbsp;as&nbsp;N, 
 pRowData&nbsp;as&nbsp;p)</p>


<p class=Code>if t.fetch_goto(nRowIndex + 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for 
 Index = 1 to field_count</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fld 
 = t.field_get(Index)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pRowData<a class="wiki"  href="Index-1" rel="">Index-1</a> 
 = eval("t."+ fld.name_get())</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>end if</p>


<p class=Code>End function</p>


<p class=Code>%code%</p>


<p class=Code>dlg_source = <<%dlg%</p>


<p class=Code>{can_exit=close}</p>


<p class=Code>{startup=init}</p>


<p class=Code>{lf};</p>


<p class=Code>{region001}</p>


<p class=Code>{stretch=height,width}</p>


<p class=Code>{sp}{activex=75,15grid};</p>


<p class=Code>{stretch=}</p>


<p class=Code>{stickto=right,top}</p>


<p class=Code>{endregion001}</p>


<p class=Code>{region002};</p>


<p class=Code>{sp}<%i=$a5_window_close;O={J=C} {I=1} Close; %18,1.5&Close!close>{sp};</p>


<p class=Code>{endregion002}</p>


<p class=Code>%dlg%</p>


<p class=Code>' Dialog Event Handlers</p>


<p class=Code>dlg_event = <<%code%</p>


<p class=Code>if a_dlg_button = "close" .or. a_dlg_button = "" 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(dlg_title)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 t.isopen("budget") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.close()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</p>


<p class=Code>if a_dlg_button = "init" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.DataMode 
 = 1329745493 ' 0x4f424e44 ' mgxUnboundedMode</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;' 
 populate the headings of the grid</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;t 
 = table.open("budget")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;t.persist()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;field_count 
 = t.fields_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for 
 i = 1 to field_count</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fld 
 = t.field_get(i)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template("col 
 = grid.object.Columns.Add(\"" + fld.name_get()+ "\")")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.EditType 
 = 1 ' text box edit style</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.allowsorting 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 (i <> 1) then ' In this particular case, only the first column is 
 character</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col.sorttype 
 = 1 ' ask for a numeric sort</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.Views(0).GridLineStyle 
 = 1' mgxSmallDots</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.Views(0).ColumnAutoResize 
 = .t.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.Views(0).Mode 
 = 5 ' mgxGroupingRowView</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Tell 
 GridX1 how many rows you have in your dataset</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.RowsCount 
 = t.records_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;grid.object.Refresh()</p>


<p class=Code>end if</p>


<p class=Code>if a_dlg_button = "AddData" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button 
 = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if 
 GridData.Size()< MasterData.Size()then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 nRowCount&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'first 
 we add the row to the dataset</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nRowCount 
 = GridData.size()+ 1</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GridData.resize(nRowCount)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'set 
 values in the last row in the array</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 
 each Element in GridDataProps</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dim 
 Expr&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expr 
 = "GridData<a class="wiki"  href="nRowCount" rel="">nRowCount</a>." + Element + " = MasterData<a class="wiki"  href="nRowCount" rel="">nRowCount</a>." 
 + Element</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(Expr)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Now 
 adjust the RowsCount</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grid.object.RowsCount 
 = nRowCount</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' 
 If one of the columns is sorted we have to call Refresh method</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grid.object.Refresh()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if 
 nRowCount >= MasterData.size()then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlg_addEnabled 
 = .f.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 if</p>


<p class=Code>end if</p>


<p class=Code>%code%</td></tr>
</table>



<p class=A5>Limitations</p>



<p>Desktop applications only</p>



<p class=A5>Examples</p>



<p>See <a href="../../Tutorials/Learning Xdialog (Desktop)/ActiveX Examples/XY Graph.html" title="XY Graph" class="wiki">XY Graph</a>, <a href="../../Tutorials/Learning Xdialog (Desktop)/ActiveX Examples/Responding to JavaScript Events on an HTML Page.html" title="Responding to JavaScript Events on an HTML Page" class="wiki">Responding   to JavaScript Events on an HTML Page</a>, <a href="../../Tutorials/Learning Xdialog (Desktop)/ActiveX Examples/Creating a User Defined Control.html" title="Creating a User Defined Control" class="wiki">Creating   a User Defined Control</a></p>



<p class=A5>See Also</p>



<p><a href="../Xdialog/Xdialog Reference/Xdialog Language Directives and Operators.html" title="Xdialog Language Directives and Operators" class="wiki">Xdialog   Language Directives and Operators</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:ACTIVEX+Xdialog+Command">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop"} --->
</body></html>