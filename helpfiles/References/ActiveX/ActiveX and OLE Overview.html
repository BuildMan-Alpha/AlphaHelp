	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>ActiveX and OLE Overview</p>



<p>Object Linking and Embedding (OLE) is about using documents generated 
 by one application inside another application. ActiveX is a Microsoft 
 rebranding of OLE with more focus on smart Windows controls. Automation 
 is a simple but powerful way to link software together without having 
 to share source code. It lets a client program "drive" a server 
 program. Automation is also used for dynamically loadable "in-process" 
 libraries.</p>



<p>Objects are registered at install time in the Windows registry. Entries 
 describe:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Properties, event, and 
 methods (functions) </p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Enumerated types (constants) 
 </p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>How to create, load, and 
 use the object </p>

</li>
</ul>

<p class=A5><a name=Placing_an_ActiveX_Control_on_a_Form>Placing an ActiveX 
 Control on a Form</a></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <img src="images/ActiveX_tool_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> and sketch the control on your form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the ActiveX 
 control you want to use and click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 control and select <span class=Button>Event > ActiveXEvent</span> to 
 see where to place code to respond to the control's events.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>To directly manipulate 
 properties of the control, your code should be structured&nbsp;as&nbsp;follows.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim object&nbsp;as&nbsp;P</p>


<p class=Code>object = my_control_name.activex.this</p>


<p class=Code>if object.title = "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;object.title = "Hello World"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;object.refresh()</p>


<p class=Code>end if</td></tr>
</table>

<p>This example uses the Calendar Control 8.0 ActiveX control. This example 
 has a form based on a table called "customer". This table has 
 a field called <span class=Code1>date_of_birth</span>. If you wanted the 
 ActiveX control to show this field value, then you would put the following 
 code in the form's <span class=Code1>OnFetch()</span> event:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim t&nbsp;as&nbsp;P</p>


<p class=Code>dim dt&nbsp;as&nbsp;D</p>


<p class=Code>dim p&nbsp;as&nbsp;P</p>


<p class=Code>t = table.current()</p>


<p class=Code>dt = t.date_of_birth</p>


<p class=Code>'get a pointer to the ActiveX control</p>


<p class=Code>p = activex1.activex.this</p>


<p class=Code>'set the ActiveX control's .value property to the date</p>


<p class=Code>p.value = ctodt("" + dt)</td></tr>
</table>

<p class=A5><a name=Using_Xdialog_with_ActiveX>Using Xdialog with ActiveX</a></p>



<p>In the Xdialog environment, you must declare a variables to identify 
 the control. In the script below <span class=Code1>imaging.editctrl.1</span> 
 is the "friendly" name of the control. The last dot and digit 
 defines the optional version number.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim img&nbsp;as&nbsp;P</p>


<p class=Code>dim img.object&nbsp;as&nbsp;P</p>


<p class=Code>dim img.class&nbsp;as&nbsp;C</p>


<p class=Code>img.class="imaging.editctrl.1"</p>


<p class=Code>ui_dlg_box("Demo",<<%dlg%</p>


<p class=Code>{activex=80,25img}</p>


<p class=Code>%dlg%,<<%code%</p>


<p class=Code>dim obj&nbsp;as&nbsp;P</p>


<p class=Code>obj = img.object</p>


<p class=Code>if obj.title = "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;obj.title = "Hello World"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;obj.refresh()</p>


<p class=Code>end if</p>


<p class=Code>%code%)</td></tr>
</table>

<p>The developer must take the responsibility to see that the ActiveX control 
 is on his client's computer.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Use <span class=Code1>regsvr32 
 controlname</span> to register an ActiveX control on a computer.</p>



<p class=A5><a name=Three_Ways_to_Create_an_Object>Three Ways to Create 
 an Object</a></p>



<p>There are three ways to create an object.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim MyObject&nbsp;as&nbsp;ole::adodb.connection</p>


<p class=Code>dim MyObject&nbsp;as&nbsp;P</p>


<p class=Code>MyObject = ole.create("adodb.connection")</p>


<p class=Code>dim MyObject&nbsp;as&nbsp;P</p>


<p class=Code>MyObject = ole.getobject("c:\summary.xls")</td></tr>
</table>

<p>In the last case the object is the document itself. After using OLE.CREATE()to 
 create a new object, access the object using dot (".") syntax. 
 For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim someobject&nbsp;as&nbsp;P</p>


<p class=Code>someobject = ole.create("owc.spreadsheet")</p>


<p class=Code>someobject.range("A1").select()</p>


<p class=Code>someobject.activecell = "Name"</td></tr>
</table>

<p class=A5><a name=Practical_Examples>Practical Examples</a></p>



<p>The following script is a practical example of OLE.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>objNetwork = ole.create("Wscript.Network")</p>


<p class=Code>strComputer = objnetwork.ComputerName</p>


<p class=Code>ui_msg_box("Computer Name", strComputer)</td></tr>
</table>

<p>This script reports on the users in a domain.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim colAccounts&nbsp;as&nbsp;P</p>


<p class=Code>dim msg&nbsp;as&nbsp;C</p>


<p class=Code>dim userarray<a class="wiki"  href="1" rel="">1</a>&nbsp;as&nbsp;C</p>


<p class=Code>colAccounts = ole.getobject("WinNT://Alphasoftware,domain")</p>


<p class=Code>userarray<a class="wiki"  href="1" rel="">1</a> = "user"</p>


<p class=Code>colAccounts.filter = userarray</p>


<p class=Code>for each objUser in colAccounts</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = msg + objUser.Name + crlf()</p>


<p class=Code>next</p>


<p class=Code>ui_msg_box("Users", msg)</td></tr>
</table>

<p>This script spell checks text using <span class=Screen>Microsoft Word</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim wb&nbsp;as&nbsp;P</p>


<p class=Code>dim oldtext&nbsp;as&nbsp;C</p>


<p class=Code>dim newtext&nbsp;as&nbsp;C</p>


<p class=Code>wb = ole.create("Word.Basic")</p>


<p class=Code>wb.filenew()</p>


<p class=Code>wb.insert("Ths iz pur splling fur sore!")</p>


<p class=Code>wb.toolsspelling()</p>


<p class=Code>wb.editselectall()</p>


<p class=Code>oldtext = web.selection()</p>


<p class=Code>wb.fileexit(2)</p>


<p class=Code>ui_msg_box("Corrected text", oldtext)</td></tr>
</table>

<p>This script retrieves data from an <span class=Screen>Access</span> 
 database.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim Output&nbsp;as&nbsp;C</p>


<p class=Code>objConn = ole.create("ADODB.Connection")</p>


<p class=Code>objRs = ole.create("ADODB.Recordset")</p>


<p class=Code>objComm = ole.create("ADODB.Command")</p>


<p class=Code>connectionstring = "Provider=Microsoft.Jet.OLEDB.4.0;Data 
 Source=c:/northwind.mdb;Persist Security Info=False;"</p>


<p class=Code>CommandText = "SLECT CompanyName FROM Customers ORDER 
 BY CompanyName"</p>


<p class=Code>objConn.Open(ConnectionSTring)</p>


<p class=Code>objRs.open(CommandText, objConn)</p>


<p class=Code>while .not. objRs.eof</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;output = output + objRs.fields.item("CompanyName").value 
 + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;objRs.MoveNext()</p>


<p class=Code>end while</p>


<p class=Code>objRs.close()</p>


<p class=Code>objConn.close()</p>


<p class=Code>&nbsp;</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Desktop/OLE Automation Object Browser.html" title="OLE Automation Object Browser" class="wiki">OLE Automation Object Browser</a>, 
 <a href="ACTIVEX Xdialog Command.html" title="ACTIVEX Xdialog Command" class="wiki">{ACTIVEX}</a></p>


	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:ActiveX+and+OLE+Overview">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"desktop","status":"pending","keywords":"desktop,design,guide","group":"/Guide/Desktop/ActiveX"} --->
</body></html>