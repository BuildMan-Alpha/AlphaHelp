	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>CANCEL()</p>

<p class=A5>Syntax</p>

<p>CANCEL( [ <span class=Argument>No_Error</span>&nbsp;as&nbsp;L&nbsp;] )</p>

 <table style="x-cell-content-align: top; width: 100%; border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 18.916%;"> <col style="width: 81.084%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 18.916%;" valign="top" width="18.916%"><p class=TableHead>Argument</td> <td class="tableHeader" style="x-cell-content-align: top; width: 81.084%;" valign="top" width="81.084%"><p class=TableHead>Description</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 18.916%;" valign="top" width="18.916%"><p class=TableLeft> <span class=Argument>No_Error</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 81.084%;" valign="top" width="81.084%"><p class=TableLeft>Optional.&nbsp;Default = .T. Whether to suppress error messages.</p>

<ul> <li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Suppress Alpha Five error messages.</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Display error messages.</p>

</li> </ul></td> </tr> </table><p class=A5>Description</p>

<p>The CANCEL() command sets the Alpha Five system variable <span class=Code1>A_CAN_DO</span> to "NO".</p>

<p>All of the events whose names are prefixed with "Can" can be canceled, thus preventing the event from occurring. The CANCEL() command is used to cancel an event.</p>

<p>The CANCEL() command can take an optional flag which can be .T. or .F. If the flag is set to .T. then Alpha Five error messages are suppressed. When you cancel an event, if your Xbasic code provides the appropriate feedback to the end-user&nbsp;as&nbsp;to why the event is being canceled (for example, by including a <a href="UI_MSG_BOX Function.html" title="UI_MSG_BOX Function" class="wiki">UI_MSG_BOX(</a>)in the code), then you would not want additional error reporting from Alpha Five itself. In this case, you would use CANCEL(.T.) in your code to cancel the event.</p>

<p class=A5>Supported By</p>

<p>Alpha Five Version 5 and Above</p>

<p class=A5>Limitations</p>

<p>Desktop applications only.</p>

<p class=A5>Example</p>

<p>For example, assume that you have a control on a form and that you define a script for that control's <span class=Code1>CanDepart</span> event. Assume that the control has focus and that the user tries to give focus to another control on the form. This will cause the control's <span class=Code1>CanDepart</span> event to fire. If this script executes the CANCEL() command, the event will be canceled and the user will not be able to move focus away from this control.</p>

<p>The following example shows how a script could be attached to a table's <span class=Code1>CanDeleteRecord</span> event. When the user deletes a record, the script is executed. It displays a dialog box asking the user for the password. If he enters the correct password, the record is deleted. Otherwise, the Delete event is canceled and the record is retained.</p>

<p>This script prompts the user for a password before deleting a record.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>password = "Alpha5"</p>

<p class=Code>user = UI_GET_text("Password", "Enter the password", "******", "&&&&&&")</p>

<p class=Code>if (user = "") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>end if</p>

<p class=Code>if (.not.(user == password)) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Password", "Password invalid.")</p>

<p class=Code>end if</td> </tr> </table><p class=A5>A Solution for Required Fields</p>

<p>This script is attached to a form's <span class=Code1>CanSave</span> event and checks the values of three required fields: <span class=Code1>field1</span>, <span class=Code1>field2</span>, and <span class=Code1>field3</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if isNULL(field1) .or isNULL(field2) .or. isNULL(field3) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>

<p class=Code>end if</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="../Desktop/Canceling Events.html" title="Canceling Events" class="wiki">Canceling Events</a>, <a href="UI_MSG_BOX Function.html" title="UI_MSG_BOX Function" class="wiki">UI_MSG_BOX(</a>)</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:CANCEL+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>