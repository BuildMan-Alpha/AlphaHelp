	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description">Validates and saves dialog values to fields in the Web Security User table</span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>A5WS_Save_WebUser_Values()</p>



<p class=A5>Syntax</p>



<p class=Normal><span class=Argument>Result </span>as&nbsp;P = A5WS_Save_WebUser_Values(<span class=Argument>CurrentForm</span>&nbsp;as&nbsp;P [, <span class="Argument">UserValue</span> as p [,<span class=Argument> Request</span>&nbsp;as&nbsp;P ]]&nbsp;)</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.458%;">
<col style="width: 90.542%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>Result </span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>The result value is not meaningful if the function is being used in a web component. 
<ul>
  <li class=kadov-p-CTableBullet>
    <p class=TableBullet>result.errors  = Will return TRUE if any errors are found during processing. </p>


  </li>
  <li class=kadov-p-CTableBullet>
    <p class=TableBullet>result.error_text = Error messages returned. </p>


  </li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9%">
<p class=TableLeft><span class=Argument>CurrentForm</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90%">
<p class=TableLeft>The <span class=Code1>CurrentForm</span> variable, a system variable that refers to the contents of the 
 dialog component.</td></tr>
 <tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%">
<p class=TableLeft><span class=Argument>UserValue</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%">
<p class=TableLeft>Optional. A pointer variable used to pass user defined value to the function. These will override the same values passed by the  <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable. Users are identified by a value in the <span class="Argument">guid</span> property of <span class="Argument">UserValue</span>. If  <span class="Argument">UserValue.guid </span> is not specified, the function will use the value passed by the  <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable.
<ul>
<li class=kadov-p-CTableBullet><p class=TableBullet>UserValue.guid = The user GUID value for the desired user record </p>

</li>
</ul>
</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9%">
<p class=TableLeft><span class=Argument>Request</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90%">
<p class=TableLeft>Optional. The <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable. The request variable should be considered READ ONLY. It is added automatically by the server when run from a web page. Users may be found by
<ul>
<li class=kadov-p-CTableBullet>
  <p class=TableBullet>request.variable.guid = The user GUID value for the desired user record </p>


</li>
</ul>
</td></tr>


</table>

<p class=A5>Description</p>



<p>The A5WS_<span class="Normal">Save_WebUser_Values</span>() function validates values from 
  controls in a dialog component and then saves the values to fields in the Web Security User table. If you only want to validate the values without saving, use the function <a href="A5WS_Validate_WebUser_Values Function.html" title="Validates values from controls in a dialog component for fields in the Web Security User table" class="wiki">A5WS_Validate_WebUser_Values.</a>  Only values <span class="TableLeft"> passed in the <a href="../Objects/Request Object.html" title="Request Object" class="wiki">request.variable</a> property of the request variable, or values passed by the pointer </span><span class="Code1">UserValue,</span><span class="TableLeft"> are saved. </span> The value in <span class="Code1">request.variable.guid</span> will be used to find an existing record. An optional value can be supplied in <span class="Code1">UserValue.guid</span> to override the value in <span class="Code1">request.variable.guid</span>. If both values are blank, the record will be considered a new record. </p>


<p>The name of 
  each control in the dialog must <span class=Bolded>exactly</span> match 
  the name of the field in the user table. A list of valid field names can be found by using the <span class="A3Function"><a href="A5WS_User_File_Field_List Function.html" title="Retrieve a list of the active fields for the web user table in the current project" class="wiki">A5WS_User_File_Field_List(</a>)</span> function. It is used in the Server 
  Validate event of a dialog component. <a href="../../Tutorials/Web Application Security Framework/Adding Users with a Web Component.html" title="Adding Users with a Web Component" class="wiki">Adding Users with a Web Component</a> shows how the function is used in  dialog component event. </p>


<p>If  validation errors are detected, the form will be redisplayed with the error message shown at the top of the   form and the variable <span class="Control">CurrentForm.Has_Error</span> will be <span class="Code1">TRUE</span>. The user can then make corrections and resubmit the form. If the variable <span class="Control">CurrentForm.Has_Error = .T. </span>prior to calling the function, the function will test the security control values for validation and return any errors, but will not save the values. The security values will only be saved if <span class="Control">CurrentForm.Has_Error =.F. </span></p>


<ol>
  <li class=kadov-p-CListNumber>
    <p class=ListNumber>Display the <span 
 class=Screen>Form > Properties</span> menu page of the <span class=Screen>Dialog 
      Builder</span>.</p>


  </li>
  <li class=kadov-p-CListNumber>
    <p class=ListNumber>Click <img src="images/Web_Properties_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 17px;
			height: 18px;
			float: none;
			border-style: none;
			border-style: none;"
	width=17
	height=18
	border=0> in the <span class=Button>Server Events > Validate</span> property.</p>


  </li>
</ol>

<p class=A5>Limitations</p>



<p>May only be used in a web component or web page.</p>



<p class=A5>Example</p>


<p>Note that <span class=Code1>CurrentForm</span> and <span class=Code1>Request</span> are the names of variables created by the <span class=Screen>Application 
Server</span>.</p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr valign="top" style="x-cell-content-align: top;">
  <td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top"><p class=Code><span class="Normal">A5WS_Save_WebUser_Values</span>(CurrentForm)</td>
</tr>
</table>
<p class=A5>Using the Function Outside of a Dialog Component </p>


<p>The function is designed to be used within Server Events of a dialog component. However, it can be used on any xbasic code section on a web page or component to save various values for a specific user. It is helpful to get a list of valid field names currently being used in the user security table by using the <span class="A3Function"><a href="A5WS_User_File_Field_List Function.html" title="Retrieve a list of the active fields for the web user table in the current project" class="wiki">A5WS_User_File_Field_List(</a>)</span> function. One additional field named <span class="Code1">groups</span> can be saved. <span class="Code1">Groups</span> should contain a comma delimited or CR-LF delimited list of the security groups assigned to the user. The group values can be the <span class="Code1">group_guid</span> value for each group or the <span class="Code1">group_name</span> of each group. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>?a5ws_User_File_Field_List()</p>


<p class=Code>= Email</p>


<p class=Code>Guid</p>


<p class=Code>Password</p>


<p class=Code>Ulink</p>


<p class=Code>Userid</p>


</td></tr>
</table>

<p>The function will only save values for fields  passed to the function in t<span class="TableLeft">he <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable</span> as <span class="Code1">request.variable.<fieldname></span> and will only save values for fields currently being used by the security system. </p>


<p><strong>NOTE: </strong><a href="../../Tutorials/AlphaSportsWeb Explained (Non-Ajax Web)/Configure Web Security/Defining Security Settings.html" title="Defining Security Settings" class="wiki">Security Settings</a> may be defined to require values in certain <span class="TableLeft"><a href="../../Tutorials/Web Application Security Framework/Set Security Properties.html#user_verification_field_values_required" title="Set Security Properties" class="wiki">User Verification Fields</a> during data entry on the web. If these fields are included in the <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> or </span><span class="Code1">UserValue</span><span class="TableLeft"> variables, they can not be blank, or the record will not be saved and an error message will be returned. </span></p>


<p>A value <strong>MUST</strong> be passed to the function to find the current user. This <strong>MUST</strong> be provided by either the system supplied <span class="Code1">request.variable.guid</span> or a user supplied value in <span class="Code1">UserValue.guid</span>. No other input value can be used to find an existing record. </p>


<p><span class="Control">WARNING:</span> If the <span class="Code1">guid</span> value is not passed to the function, the <span class="Code1">guid</span> value is blank, or the <span class="Code1">guid</span> value doesn't match an existing record, a new record will be created. A <span class="Code1">userid </span>value must be an input value for a new record, or the save is cancelled and returns an error message. <span class="Code1">Userid</span> does not have to be entered for an existing record unless the value for <span class="Code1">userid </span>is being changed. </p>


<p>Only values sent to the function will be saved. If the record already exists, any values not sent to the function are unchanged. If the record is a new record, the security settings may have defined required fields. If required fields as not supplied for a <strong>new</strong> record, validation may fail, and nothing wil be saved. </p>


<p>This code below will set the parameters to <strong>send</strong> to the function to find the user with a <span class="Code1">guid="20860aa66cfa4feb83ba25887d303f59"</span> and change the email address to "joe@email.com".  </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim uservalue as p</p>


<p class=Code>dim uservalue.guid as c</p>


<p class=Code>dim uservalue.email as c</p>


<p class=Code>uservalue.guid = "20860aa66cfa4feb83ba25887d303f59"</p>


<p class=Code>uservalue.email = "joe@email.com"</p>


</td></tr>
</table>

<p>This code could be used in place of the code above to set the parameters to <strong>send</strong> to the function to enter a new user record with a <span class="Code1">userid = "Joe@email.com"</span> and an email address with the same value. The new user record will have a password added with the value of "password". Since no  <span class="Code1">guid</span> is input, a new record is created. The function will automatically create a new <span class="Code1">guid</span> value for the record when the record is saved. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim uservalue.userid as c</p>


<p class=Code>dim uservalue.email as c</p>


<p class=Code>dim uservalue.password as c</p>


<p class=Code>uservalue.userid = "joe@email.com"</p>


<p class=Code>uservalue.email = "joe@email.com"</p>


<p class=Code>uservalue.password = "password"</p>


</td></tr>
</table>

<p>This code will set the parameters to  set the user's group assignments to "Administrators" and "Marketing" if the user groups are being added or edited. The function will only save <span class="Code1">groups</span> that are valid values in security groups definitions. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim uservalue.groups as c</p>


<p class=Code>uservalue.groups = "Administrators,Marketing"</p>



</td></tr>
</table>

<p>An output pointer must be defined <strong>before</strong> the function is run. The function will always return the guid value for a saved record as <span class="Code1"><pointer>.Controls.guid.value</span>.  If a new record was created, the function will NOT update the value in <span class="Code1">request.variable.guid</span>  if request variables were passed to the function. <span class="Code1">Request.variable.guid</span> may be blank for a new record. The function will also return values for any fields passed to the function in the <span class="TableLeft"> <a href="../Objects/Request Object.html" title="Request Object" class="wiki">Request</a> system variable</span>. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim output as p</p>


<p class=Code>dim output.controls as p</p>


<p class=Code>dim output.controls.guid.value as c	</p>


</td></tr>
</table>


<p>The parameters to <strong>send</strong> to the  function, and the output pointers must be set before the function is run. When the function is run, it will  return the values saved as <span class="Code1"><pointer>.controls.<fieldname>.value</span>.  The <span class="Code1">result.errors</span> value can be tested to determine if any errors occured during processing. Any error messages will  be should be returned in the <span class="Code1">result.error_text</span> value. </p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim result as p</p>


<p class=Code>dim error_message as c</p>


<p class=Code>result = a5ws_Save_WebUser_Values(output,uservalue)</p>


<p class=Code>if result.errors = .T. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;error_message = result.error_text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if </p>


<p class=Code>user_guid = output.controls.guid.value</p>


</td></tr>
</table>

<p>You can reload the values saved by the function back into  the pointer variable <span class="Code1">output</span> with the function <a href="A5WS_Get_WebUser_Values Function.html" title="Populates control values in a dialog component from fields in the User table" class="wiki">A5WS_Get_WebUser_Values</a> after the save function was run. </p>



<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim uservalue as p</p>


<p class=Code>dim uservalue.guid as c</p>


<p class=Code>uservalue.guid = output.controls.guid.value ' this was populated when the record was saved above. </p>


<p class=Code>dim result as p</p>


<p class=Code>dim error_message as c</p>


<p class=Code>result = a5ws_Get_WebUser_Values(output,uservalue)</p>


<p class=Code>if result.errors = .T. then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;error_message = result.error_text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if </p>


<p class=Code>user_id = output.controls.user.value</p>


</td></tr>
</table>


<p class=A5>See Also</p>



<p><a href="Web Application Functions.html" title="Web Application Functions" class="wiki">Web Application Functions</a>,&nbsp;<a href="../../Tutorials/Web Application Security Framework/Adding Users with a Web Component.html" title="Adding Users with a Web Component" class="wiki">Adding Users with a Web Component</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:A5WS_Save_WebUser_Values+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description">Validates and saves dialog values to fields in the Web Security User table</span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web","group":"Web Application Functions"} --->
</body></html>