	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>UI_PRINTER_DRAW()</p>

<p class=A5>Syntax</p>

<p> <span class=Argument>Status</span>&nbsp;as&nbsp;C = UI_PRINTER_DRAW( <span class=Argument>Printer</span>&nbsp;as&nbsp;C, <span class=Argument>Document</span>&nbsp;as&nbsp;C, <span class=Argument>Output_Filename</span>&nbsp;as&nbsp;C, <span class=Argument>Drawing_Code</span>&nbsp;as&nbsp;C,&nbsp;<span class=Argument>Show_Dialog</span>&nbsp;as&nbsp;L [,&nbsp;<span class=Argument>Settings</span>&nbsp;as&nbsp;P&nbsp;]&nbsp;)</p>

 <table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 16.203%;"> <col style="width: 83.797%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableHead>Argument</td> <td class="tableHeader" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableHead>Description</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Status</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>"Cancelled" = User cancelled</p>

<p class=TableLeft>"Completed" = Finished printing</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Printer</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>The printer name.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Document</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>A message to display while the page is being generated.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Output_Filename</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>The name of the print file to create.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Drawing_Code</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>Code that generates bitmap data.&nbsp;See <a href="Displaying and Printing Bitmaps.html" title="Displaying and Printing Bitmaps" class="wiki">Displaying and Printing Bitmaps</a>.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Show_Dialog</span></td> <td class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>
	Whether to hide the print dialog. </p>

<ul> <li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Hide Print dialog box.</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Show Print dialog box.</p>

</li> </ul></td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top; width: 16.203%;" valign="top" width="16.203%"><p class=TableLeft> <span class=Argument>Settings</span></td> <td class="TableCell" style="x-cell-content-align: top; width: 83.797%;" valign="top" width="83.797%"><p class=TableLeft>Optional. A dot variable that contains configuration settings for the printer.&nbsp;See below.</td> </tr> </table><p class=A5>Description</p>

<p>The UI_PRINTER_DRAW() function generates and sends text and graphics to a printer.&nbsp;Its purpose is to support printing through Xbasic in situations where the report writer does not give you sufficient control or flexibility.</p>


<p class=A5>Limitations</p>

<p>Desktop applications only.</p>

<p class=A5>Settings</p>

<p>The settings of a printer can be viewed through <a href="UI_PRINTER_SETTINGS_GET Function.html" title="UI_PRINTER_SETTINGS_GET Function" class="wiki">UI_PRINTER_SETTINGS_GET(</a>). First get the printer name.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? ui_printers_get()</p>

<p class=Code>= PDF Driver on LPT1:</p>

<p class=Code>HTML Driver on HTM:</p>

<p class=Code>Generic PostScript Printer on LPT1:</p>

<p class=Code>Acrobat Distiller on Ne02:</p>

<p class=Code>\\THUNDER\Compaq Laser Printer LNM40 (PCL) on Ne03:</td> </tr> </table><p>Next, specify the FULLNAME of the printer and call UI_PRINTER_SETTINGS_GET()  to get the printers current settings.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>settings.dummy = .t.</p>

<p class=Code>ui_printer_settings_get("Acrobat Distiller on Ne02:",settings)</p>

<p class=Code>? settings</p>

<p class=Code>= collate = .T.</p>

<p class=Code>color = "Color"</p>

<p class=Code>copies = 1.000000</p>

<p class=Code>defaultsource = "Automatically Select"</p>

<p class=Code>dummy = .T.</p>

<p class=Code>orientation = "portrait"</p>

<p class=Code>papersize = "Letter"</p>

<p class=Code>scale = 100.000000</p>

<p class=Code>truetype = "Substitute"</td> </tr> </table><p>To get ALL the values that properties can have, call <a href="UI_PRINTER_OPTIONS_GET Function.html" title="UI_PRINTER_OPTIONS_GET Function" class="wiki">UI_PRINTER_OPTIONS_GET(</a>)with the printer in question.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>options.dummy&nbsp;= .t.</p>

<p class=Code>ui_printer_options_get("Acrobat Distiller on Ne02:",options)</p>

<p class=Code>? options</p>

<p class=Code>= collate = "<logical>"</p>

<p class=Code>color = Color</p>

<p class=Code>Monochrome</p>

<p class=Code>copies = "<number>"</p>

<p class=Code>defaultsource = Automatically Select</p>

<p class=Code>OnlyOne</p>

<p class=Code>dummy = .T.</p>

<p class=Code>duplex = Simplex</p>

<p class=Code>Horizontal</p>

<p class=Code>Vertical</p>

<p class=Code>orientation = portrait</p>

<p class=Code>landscape</p>

<p class=Code>paperlength = "<number>"</p>

<p class=Code>papersize = Letter</p>

<p class=Code>Tabloid</p>

<p class=Code>Ledger</p>

<p class=Code>Legal</p>

<p class=Code>Executive</p>

<p class=Code>A3</p>

<p class=Code>A4</p>

<p class=Code>11 x 17</p>

<p class=Code>Screen</p>

<p class=Code>PostScript Custom Page Size</p>

<p class=Code>paperwidth = "<number>"</p>

<p class=Code>quality = High</p>

<p class=Code>Medium</p>

<p class=Code>Low</p>

<p class=Code>Draft</p>

<p class=Code>scale = "<number>"</p>

<p class=Code>truetype = Bitmap</p>

<p class=Code>Download</p>

<p class=Code>Substitute</td> </tr> </table><p class=A5>Examples</p>

<p>The following example was provided by <span class=Bolded>Jerry Brightbill</span> of <span class=Bolded>Brightbill Consulting</span>. It is an excellent example of how to use UI_PRINTER_DRAW() , <a href="UI_PRINTER_DEFAULT_GET Function.html" title="UI_PRINTER_DEFAULT_GET Function" class="wiki">UI_PRINTER_DEFAULT_GET(</a>), <a href="UI_BITMAP_CREATE Function.html" title="UI_BITMAP_CREATE Function" class="wiki">UI_BITMAP_CREATE(</a>), <a href="UI_BITMAP_DRAW Function.html" title="UI_BITMAP_DRAW Function" class="wiki">UI_BITMAP_DRAW(</a>), <a href="UI_SCREEN_DRAW Function.html" title="UI_SCREEN_DRAW Function" class="wiki">UI_SCREEN_DRAW(</a>),, and <a href="UI_BITMAP_DROP Function.html" title="UI_BITMAP_DROP Function" class="wiki">UI_BITMAP_DROP(</a>).</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim printer&nbsp;as&nbsp;C</p>

<p class=Code>dim page_code&nbsp;as&nbsp;C</p>

<p class=Code>dim curr_date&nbsp;as&nbsp;D</p>

<p class=Code>dim day_start&nbsp;as&nbsp;N</p>

<p class=Code>dim day_first&nbsp;as&nbsp;D</p>

<p class=Code>dim day_last&nbsp;as&nbsp;D</p>

<p class=Code>dim day_num[42]&nbsp;as&nbsp;C</p>

<p class=Code>dim days_month&nbsp;as&nbsp;N</p>

<p class=Code>dim cal_title&nbsp;as&nbsp;C</p>

<p class=Code>dim chk&nbsp;as&nbsp;N</p>

<p class=Code>dim date_num&nbsp;as&nbsp;D</p>

<p class=Code>dim rows&nbsp;as&nbsp;N</p>

<p class=Code>dim title&nbsp;as&nbsp;C</p>

<p class=Code>dim x1&nbsp;as&nbsp;N</p>

<p class=Code>dim y1&nbsp;as&nbsp;N</p>

<p class=Code>curr_date = {10/10/2003}</p>

<p class=Code>day_first = month_start(curr_date)</p>

<p class=Code>day_start = dow(day_first)</p>

<p class=Code>day_last = month_end(curr_date)</p>

<p class=Code>days_month = day_last - day_first +1</p>

<p class=Code>rows = 5</p>

<p class=Code>for i = 1 TO day_start-1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;day_num[i] = ""</p>

<p class=Code>next</p>

<p class=Code>k = 0</p>

<p class=Code>for i = day_start TO day_start + days_month - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;k = k + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;date_num = day_first + k - 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;day_num[i] = padl(alltrim(str(day(date_num))), 2, " ")</p>

<p class=Code>next</p>

<p class=Code>if (i > 35) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rows = 6</p>

<p class=Code>end if</p>

<p class=Code>for i = day_start + days_month TO 42</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;day_num[i] = ""</p>

<p class=Code>next</p>

<p class=Code>title = "Print a Calendar!"</p>

<p class=Code>cal_title = date_format(curr_date,"Month yyyy")</p>

<p class=Code>watermark = "DRAFT"</p>

<p class=Code>page_code = <<%code%</p>

<p class=Code>set_brush("white")</p>

<p class=Code>inner_rect(0,0,7.5,5)</p>

<p class=Code>set_origin(2,-1)</p>

<p class=Code>set_rotate(45)</p>

<p class=Code>set_font("Arial,42,b", "Blue White", "white")</p>

<p class=Code>text(watermark,2,2,"rotate")</p>

<p class=Code>set_rotate(0)</p>

<p class=Code>set_origin(0,0)</p>

<p class=Code>set_font("Arial,16,bi","black")</p>

<p class=Code>text(title,1,1)</p>

<p class=Code>set_font("Arial,14,b")</p>

<p class=Code>text(cal_title, 2.75 - text_width(cal_title)/2,1.4)</p>

<p class=Code>set_font("Arial,12,bi")</p>

<p class=Code>for j = 0 TO 6</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(word("S M T W T F S",j +1),j *.5 + 1.1,1.75)</p>

<p class=Code>next</p>

<p class=Code>line(1.05,1.3,7,1.3)</p>

<p class=Code>line(1.05,2,4.25,2)</p>

<p class=Code>line(4.5,1.35,4.5,4.5)</p>

<p class=Code>k = 0</p>

<p class=Code>set_font("Arial,16,b","black")</p>

<p class=Code>for i = 0 TO rows-1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for j = 0 TO 6</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1 = j *.5 + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1 = (i * .5) + 1.25</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k = k + 1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if val(day_num[k]) = day(curr_date) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rect(x1 , y1 + 1, .35, .3)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(day_num[k], x1 + .05, y1 + 1.02, "top")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next j</p>

<p class=Code>next i</p>

<p class=Code>%code%</p>

<p class=Code>ui_bitmap_create("test", 7.5, 5)</p>

<p class=Code>ui_bitmap_draw("test", page_code)</p>

<p class=Code>ui_dlg_box("","{image=test}")</p>

<p class=Code>ui_bitmap_drop("test")</p>

<p class=Code>chk = ui_msg_box("Print","Print Now? ",292)</p>

<p class=Code>if (chk <> 6) then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>

<p class=Code>end if</p>

<p class=Code>printer = ui_printer_default_get()</p>

<p class=Code>on error goto no_print</p>

<p class=Code>ui_printer_draw(printer, "Calendar" ,"",page_code,.F.)</p>

<p class=Code>end</p>

<p class=Code>no_print:</p>

<p class=Code>ui_msg_box("Error","Print Canceled</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p class=Code>",16)</p>

<p class=Code>1=1</p>

<p class=Code>end</td> </tr> </table><p>The result is the following calendar. </p>

<p class=Pix> <img src="images/UI_PRINTER_DRAW.gif" x-maintain-ratio=TRUE style="border: none; width: 620px; height: 368px; float: none; border-style: none; border-style: none;" width=620 height=368 border=0></p>

<p>Xbasic can also generate and print Postscript data.&nbsp;The following script provides an example of placing boxes and text on a page.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim data[10]&nbsp;as&nbsp;P</p>

<p class=Code>dim printer&nbsp;as&nbsp;C</p>

<p class=Code>t = table.open("customer")</p>

<p class=Code>for i = 1 to 10</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;data[i].firstname = t.Firstname</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;data[i].lastname = t.Lastname</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;data[i].company = t.Company</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;t.fetch_next()</p>

<p class=Code>next i</p>

<p class=Code>t.close()</p>

<p class=Code>printer = "Acrobat Distiller"</p>

<p class=Code>rows = 10</p>

<p class=Code>columns = 3</p>

<p class=Code>width = 2</p>

<p class=Code>height = .5</p>

<p class=Code>lmargin = 1.25</p>

<p class=Code>tmargin = 1.0</p>

<p class=Code>page_description = <<%code%</p>

<p class=Code>for i = 0 to rows-1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for j = 0 to columns-1</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1 = j * width + lmargin</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y1 = i * height + tmargin</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rect(x1, y1, width, height)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if j = 0 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(data[i+1].firstname, x1 + width/2, y1 + height/2, "center")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if j = 1 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(data[i+1].lastname, x1 + width/2, y1 + height/2, "center")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if j = 2 then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(left(data[i+1].company,20), x1 + width/2, y1 + height/2, "center")</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next j</p>

<p class=Code>next i</p>

<p class=Code>new_page()</p>

<p class=Code>%code%</p>

<p class=Code>ui_printer_draw(printer, "please wait", "c:\distiller.ps", page_description)</p>

<p class=Code>program_name = "C:\Program Files\Adobe\Acrobat 5.0\Distillr\AcroDist.exe"</p>

<p class=Code>if file.exists("c:\distiller.pdf") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;file.remove("c:\distiller.pdf")</p>

<p class=Code>end if</p>

<p class=Code>cmd = program_name + " c:\distiller.ps"</p>

<p class=Code>sys_shell(cmd)</p>

<p class=Code>wait_until(file.exists("c:\distiller.pdf"), 1, 10)</p>

<p class=Code>sys_open("c:\distiller.pdf")</td> </tr> </table><p>The result looks like this: </p>

<p class=Pix> <img src="images/UI_PRINTER_DRAW_2.gif" x-maintain-ratio=TRUE style="border: none; width: 518px; height: 419px; float: none; border-style: none; border-style: none;" width=518 height=419 border=0></p>

<p>The following example shows how to place graphics, text, and rotated type. DIM and assign values to control variables.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim printer&nbsp;as&nbsp;C</p>

<p class=Code>dim program_name&nbsp;as&nbsp;C</p>

<p class=Code>printer = "Acrobat Distiller"</p>

<p class=Code>program_name = "C:\Program Files\Adobe\Acrobat 5.0\Distillr\AcroDist.exe"</p>

<p class=Code>rows = 10</p>

<p class=Code>columns = 3</p>

<p class=Code>width = 2</p>

<p class=Code>height = .5</p>

<p class=Code>lmargin = .5</p>

<p class=Code>tmargin = 1</td> </tr> </table><p>Load a bitmap from a file so that it may be printed.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>bitmapfile = "C:\documents\Xbasic Reference\Images\logo.bmp"</p>

<p class=Code>bddata = file.to_blob(bitmapfile)</p>

<p class=Code>ui_bitmap_load("tempbitmap", bddata)</td> </tr> </table><p>Now word wrap a paragraph of several lines.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>word_wrap_text = <<%a%</p>

<p class=Code>This is an example of how we can do word wrap text on the page. Alpha Anywhere gives you fantastic control over every aspect of how you output text to the printer.</p>

<p class=Code>%a%</td> </tr> </table><p>Start the page description and get page dimensions.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>page_description = <<%code%</p>

<p class=Code>'this tells me how big the page is in inches</p>

<p class=Code>page_width = extent_width()</p>

<p class=Code>page_height = extent_height()</td> </tr> </table><p>Place "Alpha Software Inc." on the page with a red bar under it. The text is left aligned. Other options for alignment are: right, center, left-top, right-top, bottom-left, left-center etc. and rotate (used with ((SET_ROTATE Function|SET_ROTATE())).</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>set_font("Arial,24,B")</p>

<p class=Code>text = "Alpha Software Inc."</p>

<p class=Code>text(text, 2, 3, "Left")</p>

<p class=Code>'measure the width and height of the last text we wrote</p>

<p class=Code>w = text_width(text)</p>

<p class=Code>h = text_height(text)</p>

<p class=Code>set_brush("red")</p>

<p class=Code>inner_rect(2,3 + h, w, .1)</td> </tr> </table><p>Place a the bitmap we loaded earlier on the page.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>bitmap("tempbitmap",6, 1 ,1.88889, 1.34722)</td> </tr> </table><p>Put some slanted text on the page.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>text = "This is too cool for words!"</p>

<p class=Code>set_origin(5,10)</p>

<p class=Code>set_rotate(-75)</p>

<p class=Code>set_font("broadway bt,36", "lavendar", "white")</p>

<p class=Code>text(text,0,0,"rotate")</p>

<p class=Code>set_font("arial,10", "black", "white")</p>

<p class=Code>set_rotate(0)</td> </tr> </table><p>Use the ((NEW_PAGE Function|NEW_PAGE()))function if you want to print more than one page. Now place something in the center of the page.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>set_origin(page_width/2, page_height/2)</p>

<p class=Code>text("IN THE CENTER",0,0,"CENTER")</p>

<p class=Code>set_origin(0,0)</p>

<p class=Code>'offset</p>

<p class=Code>h = wrap_text_height(word_wrap_text, 2)</p>

<p class=Code>offset = draw_wrap_text(word_wrap_text, 2, 6, 3, h)</p>

<p class=Code>%code%</td> </tr> </table><p>Print it through the <span class=Screen>Acrobat Distiller</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_printer_draw(printer,"please wait", "c:\distiller.ps", page_description)</p>

<p class=Code>program_name = "C:\Program Files\Adobe\Acrobat 5.0\Distillr\AcroDist.exe"</p>

<p class=Code>if file.exists("c:\distiller.pdf") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;file.remove("c:\distiller.pdf")</p>

<p class=Code>end if</p>

<p class=Code>cmd = program_name + " c:\distiller.ps"</p>

<p class=Code>sys_shell(cmd)</p>

<p class=Code>wait_until(file.exists("c:\distiller.pdf"), 1, 10)</p>

<p class=Code>sys_open("c:\distiller.pdf")</td> </tr> </table><p>The results look like this. </p>

<p class=Pix> <img src="images/UI_PRINTER_DRAW_3.gif" x-maintain-ratio=TRUE style="border: none; width: 518px; height: 669px; float: none; border-style: none; border-style: none;" width=518 height=669 border=0></p>

<p>The following example shows how to print multiple pages of text.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>printer = "Acrobat Distiller"</p>

<p class=Code>program_name = "C:\Program Files\Adobe\Acrobat 5.0\Distillr\AcroDist.exe"</p>

<p class=Code>long_text = <<%a%</p>

<p class=Code>License AGREEMENT</p>

<p class=Code>Important: The enclosed program is licensed by ALPHA Software, Inc (ALPHA) to customers for their use only on the terms set forth below. Either physically or electronically, opening this package or use of the program indicates your acceptance of the terms of this AGREEMENT.</p>

<p class=Code>1. License: ALPHA hereby agrees to grant you a non-exclusive license to use the enclosed ALPHA program (the "Program") subject to the terms and restrictions set forth in this License AGREEMENT. If you do not agree with the terms of this AGREEMENT, do not install and/or use the software.</p>

<p class=Code>2. Copyright: The Program and its documentation are protected by US copyright law and international treaty provisions. You may not copy or otherwise reproduce any part of the Program or its documentation, except that you may load the Program into a computer&nbsp;as&nbsp;an essential step in executing the Program on a single computer.</p>

<p class=Code>3. Restrictions on Use and Transfer: You may install and use one copy of the Software Product on a single primary computer, device, workstation, terminal, or other digital electronic or analog device ("Device"). You may make a second copy of the Software Product and install it on a portable Device, (that is not connected to any network to which the primary computer is connected) for the exclusive use of the person who is the user of the first copy of the Software Product.&nbsp;A license for the Software Product may not be shared. Alternative License Grant for Storage/Network Use.&nbsp;as&nbsp;an alternative to the rights granted in the previous section, You may install a copy of the Software Product on one storage Device, such&nbsp;as&nbsp;a network server, and allow individuals within Your business or enterprise to access and use the Software Product from other Devices over a private network, provided that You acquire and dedicate a license for the storage Device upon which the Software Product is installed and each separate Device from which the Software Product is accessed and used. A license for the Software Product may not be used concurrently on different Devices. You may not distribute copies of the Program or its documentation to others. Neither the Program nor its documentation may be modified or translated without written permission from ALPHA. You may not use, copy, modify, or transfer the Program, or any copy, modification or merged portion, in whole or in part, except&nbsp;as&nbsp;expressly provided for in the license.</p>

<p class=Code>4. INTELLECTUAL PROPERTY RIGHTS. All title and intellectual property rights in and to the Software Product (including but not limited to any images, photographs, animations, video, audio, music, text, and "applets" incorporated into the Software Product), the accompanying printed materials, and any copies of the Software Product are owned by ALPHA or its suppliers. All title and intellectual property rights in and to the content that is not contained in the Software Product, but may be accessed through use of the Software Product, is the property of the respective content owners and may be protected by applicable copyright or other intellectual property laws and treaties. This AGREEMENT grants you no rights to use such content. If this Software Product contains documentation that is provided only in electronic form, you may print one copy of such electronic documentation. You may not copy the printed materials accompanying the Software Product.</p>

<p class=Code>5. BACKUP COPY. After installation of one copy of the Software Product pursuant to this AGREEMENT, you may keep the original media on which the Software Product was provided by Alpha solely for backup or archival purposes. Except&nbsp;as&nbsp;expressly provided in this AGREEMENT, you may not otherwise make copies of the Software Product or the printed materials accompanying the Software Product.</p>

<p class=Code>6 Exclusion of Warranty; Limitation of Liability; Limited Diskette Warranty:</p>

<p class=Code>(a) The program and its documentation are provided "as is" without warranty of any kind, either expressed or implied, including, but not limited to, the IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. The entire risk&nbsp;as&nbsp;to the results and performance of the program is assumed by you. Should the Program or its documentation prove defective, you (and not Alpha or its dealers) assume the entire cost of all necessary servicing, repair, or correction.</p>

<p class=Code>(b) In no event shall Alpha nor its suppliers no anyone else who has been involved in the creation, production, or delivery of this Program and its documentation be liable for any direct, indirect, consequential, special or incidental damages whatsoever (including, without limitation, damages from the loss of profits, business interruptions, loss of business or confidential or other information, or business interruption, or personal injury, or loss or privacy, or failure to meet any duty including of good faith or reasonable care or negligence or any other pecuniary loss or other loss whatsoever) arising out of or in any way related to the use of or inability to use such products, or the provision of or the failure by ALPHA or any of its suppliers to provide support services or otherwise under or in connection with any provision of this AGREEMENT, even in the event of the fault, tort (including negligence) strict liability, breach of contract or breach of warranty of Alpha or any supplier and even if Alpha or any supplier has been advised of the possibility of such damages or claim.</p>

<p class=Code>(c) Alpha warrants the enclosed CD (but not the Program contained thereon) to be free of defects in materials and workmanship under normal use for 30 days after purchase. During the 30-day period, you may return a defective CD to an Authorized Alpha Dealer, and it will be replaced without charge unless the diskette or CD is damaged by accident or misuse. Replacement of a diskette or CD is your sole remedy in the event of a defect. This warranty gives you specific legal rights, and you may also have other rights which vary from state to state.</p>

<p class=Code>7. Product Improvements: Alpha reserves the right to make corrections or improvements to the Program and its documentation and to the related CD at any time without notice and with no responsibility to provide these changes to purchasers of earlier versions of such products.</p>

<p class=Code>8. Term: This license is effective until terminated. You may terminate it by destroying the Program and its documentation and all copies thereof. This license will also terminate if you fail to comply with any term or AGREEMENT. You agree upon such termination to destroy all copies of the Program and its documentation.</p>

<p class=Code>9. ENTIRE AGREEMENT. This AGREEMENT is the entire AGREEMENT between you and ALPHA relating to the Software Product and the support services (if any) and they supersede all prior or contemporaneous oral or written communications, proposals and representations with respect to the Software Product or any other subject matter covered by this AGREEMENT. To the extent the terms of any ALPHA policies or programs for support services conflict with the terms of this AGREEMENT, the terms of this AGREEMENT shall control.</p>

<p class=Code>10. This AGREEMENT is governed by the laws of the Commonwealth of Massachusetts. USA</p>

<p class=Code>%a%&nbsp;&nbsp;&nbsp;</td> </tr> </table><p>Now paginate the text.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>page_description = <<%code%</p>

<p class=Code>'this tell me how big the page is in inches</p>

<p class=Code>page_width = extent_width()</p>

<p class=Code>page_height = extent_height()</p>

<p class=Code>offset = 1</p>

<p class=Code>len = len(long_text)</p>

<p class=Code>'this shows how to split long text across the page onto multiple pages.</p>

<p class=Code>'offset returns how much of the text was printed.</p>

<p class=Code>while (offset < len)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;offset = draw_wrap_text(long_text, 1, 1, page_width - 2, page_height - 2, offset)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if offset < len then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_page()</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>

<p class=Code>end while</p>

<p class=Code>%code%</td> </tr> </table><p>Now print the pages.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ui_printer_draw(printer,"please wait", "c:\distiller.ps", page_description)</p>

<p class=Code>program_name = "C:\Program Files\Adobe\Acrobat 5.0\Distillr\AcroDist.exe"</p>

<p class=Code>if file.exists("c:\distiller.pdf") then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;file.remove("c:\distiller.pdf")</p>

<p class=Code>end if</p>

<p class=Code>cmd = program_name + " c:\distiller.ps"</p>

<p class=Code>sys_shell(cmd)</p>

<p class=Code>wait_until(file.exists("c:\distiller.pdf"), 1, 10)</p>

<p class=Code>sys_open("c:\distiller.pdf")</td> </tr> </table><p>The first page of the result looks like this. </p>

<p class=Pix> <img src="images/UI_PRINTER_DRAW_4.gif" x-maintain-ratio=TRUE style="border: none; width: 518px; height: 669px; float: none; border-style: none; border-style: none;" width=518 height=669 border=0></p>

<p class=A5>See Also</p>

<p> <a href="Displaying and Printing Bitmaps.html" title="Displaying and Printing Bitmaps" class="wiki">Displaying and Printing Bitmaps</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:UI_PRINTER_DRAW+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>