	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Function>EMAIL_SEND2()</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : EMAIL_SEND2()
 requires that you have configured an <a href="../Email/Email Profiles.html" title="Email Profiles" class="wiki">Alpha  Five email profile</a>. If you are working in an environment where this
 is not possible, use <a href="EMAIL_SMTP_OPEN Function.html" title="EMAIL_SMTP_OPEN Function" class="wiki">EMAIL_SMTP_OPEN(</a>),
 <a href="EMAIL_SMTP_SEND Function.html" title="EMAIL_SMTP_SEND Function" class="wiki">EMAIL_SMTP_SEND(</a>), and <a href="EMAIL_SMTP_CLOSE Function.html" title="EMAIL_SMTP_CLOSE Function" class="wiki">EMAIL_SMTP_CLOSE(</a>).</p>



<p class=A5>Syntax</p>



<p><span class=Argument>Result_Flag</span>&nbsp;as&nbsp;L = EMAIL_SEND2(
 <span class=Argument>Message</span>&nbsp;as&nbsp;P [,&nbsp;<span class=Argument>Profile</span>&nbsp;as&nbsp;C
 [,&nbsp;<span class=Argument>Silent</span>&nbsp;as&nbsp;L [,&nbsp;<span
 class=Argument>Store_in_Mailbox</span>&nbsp;as&nbsp;L [,&nbsp;<span
 class=Argument>autowrap</span>&nbsp;as&nbsp;L ]]]]&nbsp;)</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Argument</td>
<td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Result_Flag</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Indicates success or failure after sending an email.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td rowspan="18" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Message</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A pointer variable containing the message.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Header Component</td>
<td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.From</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The sender's email address.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.From_Alias</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. The sender's name.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.To</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A semi-colon (;), comma (,), or CR-LF delimited list
 of recipients. <span class=Screen>Microsoft Outlook</span> allows you
 to format the address&nbsp;as&nbsp;"recipient_name<recipient@address>".
 This hides the "<recipient@address>" portion of the field
 from the recipient.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.CC</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. The CC list. Multiple entries are separated
 by commas.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.BCC</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. The BCC list. Multiple entries are separated
 by commas.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Subject</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The subject line of the email. Optional, depending on
 mail server requirements.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Message</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The body of a text message. Optional, depending on mail
 server requirements.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Html_Message</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. The body of a HTML message.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Attachments</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. A semi-colon (;), comma, or CR-LF delimited
 list of filenames. Any file type can be attached.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Xmailer</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = NULL. The sending email program.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Lrelated</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = .F.</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Attachments
 are embedded image in the HTML message.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Attachments
 are separate files.</p>

</li>
</ul></td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Date</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = "". The date of the email.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Failure</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = "". A list of failed addresses.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Headers</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = "". If the user wants
 to supply additional Email headers per RFC822, they can set them in the
 <span class=Argument>Headers</span> property.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td_null>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.Success</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = "". A list of successful
 addresses.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>.ReturnReceipt</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
Optional. Default = .F. If .t. then an
e-mail will be sent to the sender acknowledging that the recipient has read the
e-mail. Note that not all e-mail clients support this feature and the recipient
might decline to send the receipt.</td>
</tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Profile</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Uses the last active profile. The name of
 an email profile&nbsp;as&nbsp;found on the <span class=Button>View >
 Settings > Email > Profiles</span> tab.</td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Silent</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = .F. Allows you to trap errors using
 the Xbasic ON ERROR GOTO command.</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Error trapping
 on.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Error trapping
 off.</p>

</li>
</ul></td>
<td_null></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>Store_in_Mailbox</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Whether to store the message in your mailbox.</p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Alpha Anywhere
 stores a copy of the message in the Alpha Anywhere outbox.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Copy not
 saved.</p>

</li>
</ul></td>
<td_null></tr>






<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Argument>autowrap</span></td>
<td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Optional. Default = .T. Whether to force text emails to wrap 
at 72 characters per line. </p>


<ul>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Automatically wrap all lines of text at 72 characters or less.</p>

</li>

	<li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Leave text email body unchanged.</p>

</li>
</ul></td>
<td_null></tr>




</table>

<p class=A5>Description</p>



<p>EMAIL_SEND2() sends an email message using Alpha Anywhere's built-in email
 features. The function does not require that you have a third party email
 client (such&nbsp;as <span class=Screen>Eudora</span> or <span class=Screen>Outlook</span>
 ) installed on the computer.</p>



<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : EMAIL_SEND()
 is not sensitive to the type of image files attached and embedded in HTML
 formatted messages.</p>





<p class=A5>Example</p>



<p>Sends an email message using A5's internal email facility. A copy of
 the message is stored in the user's Alpha Anywhere outbox.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim message&nbsp;as&nbsp;P</p>


<p class=Code>body = <<%a%</p>


<p class=Code>Just wanted to let you know that we really enjoy using Alpha
 Five.</p>


<p class=Code>%a%</p>


<p class=Code>message.message = body</p>


<p class=Code>message.to = "sales@alphasoftware.com"</p>


<p class=Code>message.subject = "Thanks"</p>


<p class=Code>email_send2(message, "", .F., .T.)</td></tr>
</table>

<p>The <span class=Argument>Silent</span> option is useful for Xbasic programmers
 who are using the EMAIL_SEND2() function in a loop where they want to
 prevent the standard Alpha Anywhere error messages from popping up when an
 error (such&nbsp;as&nbsp;a bad email address) in encountered. Instead,
 they want to write their own error handler for this condition. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>Dim ITbl&nbsp;as&nbsp;P</p>


<p class=Code>Tbl = table.open("customers")</p>


<p class=Code>Query.filter = "balance > 1000000"</p>


<p class=Code>Query.order = "recno() "</p>


<p class=Code>ITbl = tbl.query_create()</p>


<p class=Code>Tbl.fetch_first()</p>


<p class=Code>While .not. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ON ERROR GOTO BAD_EMAIL&nbsp;&nbsp;&nbsp;</td></tr>
</table>

<p>Fill in all of the arguments for EMAIL_SEND2() and set the <span class=Argument>Silent</span>
 parameter to .T. .</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Email_sends(??????, .t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ON ERROR GOTO 0 'turn error handler
 off</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;Tbl.fetch_next()</p>


<p class=Code>End While</p>


<p class=Code>Tbl.close()</p>


<p class=Code>' end the main script here so that it does not continue into
 the error handler</p>


<p class=Code>End</p>


<p class=Code>BAD_EMAIL:</p>


<p class=Code>' put you own error handling code here</p>


<p class=Code>RESUME NEXT</p>


<p class=Code>' causes Alpha Anywhere to resume on the line after email_sends()</p>


<p class=Code>end</td></tr>
</table>

<p>This example shows how to include an image in an email.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim pm&nbsp;as&nbsp;P</p>


<p class=Code>pm.attachments = " C:\login.jpg "</p>


<p class=Code>pm.lrelated = .T.</p>


<p class=Code>pm.from = "aaron@alphasoftware.com"</p>


<p class=Code>pm.from_alias = "Aaron Brown"</p>


<p class=Code>pm.to = "aaron@alphasoftware.com"</p>


<p class=Code>pm.subject = "Inline Attachments"</p>


<p class=Code>pm.html_message = <<%html%</p>


<p class=Code><html></p>


<p class=Code><head> </head></p>


<p class=Code><body>This is a message with an <img src="
 login.jpg " /><br> inline image.</p>


<p class=Code
<!---HELPMETADATA: {"tags":"desktop","group":"Email Functions ","status":"pending"} --->
</body></html>