	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Writing Your Own Function</p>

<p>The following user defined function is a simple example to demonstrate a point. You can create a function that accepts parameters, processes these inputs according to your specifications, and returns a value that you can use in your page.</p>

<p>It is good programming practice to separate user defined functions from the HTML contents of the page. In this case we place the function before the opening <span class=HTML1>&ltHTML></span> tag.</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new A5W page and name it "Writing Your Own Function".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Source</span> tab.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following text into the page.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>function fullname&nbsp;as&nbsp;C (cFirstname&nbsp;as&nbsp;C, cLastname&nbsp;as&nbsp;C)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fullname = alltrim(cLastname) + ", " + alltrim(cFirstname)</p>

<p class=Code>end function</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>&lthtml></span></p>

<p class=Code><span class=HTML1>&lthead></span></p>

<p class=Code><span class=HTML1>&ltmeta name="generator" content="Alpha Five HTML Editor"></span></p>

<p class=Code><span class=HTML1>&lttitle>Writing Your Own Function&lt/title></span></p>

<p class=Code><span class=HTML1>&lt/head></span></p>

<p class=Code><span class=HTML1>&ltbody></span></p>

<p class=Code>&lt%a5</p>

<p class=Code>dim cFirstname&nbsp;as&nbsp;C = "Abraham"</p>

<p class=Code>dim cLastname&nbsp;as&nbsp;C = "Lincoln"</p>

<p class=Code>%></p>

<p class=Code><span class=HTML1>If your first name is</span> &lt%a5 ? cFirstname%> <span class=HTML1>and your</span></p>

<p class=Code><span class=HTML1>lastname is</span> &lt%a5 ? cLastname%> <span class=HTML1>, then your full name</span></p>

<p class=Code><span class=HTML1>is</span> &lt%a5 ? fullname(cFirstname, cLastname) %> <span class=HTML1>.</span></p>

<p class=Code><span class=HTML1>&lt/body></span></p>

<p class=Code><span class=HTML1>&lt/html></span></td> </tr> </table><p>When you run the page it should look like this. </p>

<p class=Pix><img src="images/WPT_Writing_Your_Own_Function.gif" x-maintain-ratio=TRUE style="border: none; width: 428px; height: 256px; float: none; border-style: none; border-style: none;" width=428 height=256 border=0></p>

<p class=A5><a name=Declaring_the_Types_of_Function_Arguments>Declaring the Types of Function Arguments</a></p>

<p>There is an assumption that a function has no prior knowledge of the data types of the arguments that are passed to it.&nbsp;as&nbsp;a result, it is necessary to include a parameter list in a function declaration. A function can have no arguments, one argument, or many arguments. The following examples pass their arguments <span class=Bolded>by value</span>, which means that the receiving function has no knowledge of the variables in the calling function.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION FunctionName1()</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName2(argument1&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName3(argument1&nbsp;as&nbsp;TypeSymbol, argument2&nbsp;as&nbsp;TypeSymbol, ... argumentN&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</td></tr> </table><p>Alpha Anywhere allows you to pass parameters <span class=Bolded>by reference</span>, using the keyword BYREF. This means that the receiving function can directly manipulate the variables passed by the calling function.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION FunctionName1()</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName2(BYREF argument1&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName3(BYREF argument1&nbsp;as&nbsp;TypeSymbol, BYREF argument2&nbsp;as&nbsp;TypeSymbol, ... BYREF argumentN&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</td></tr> </table><p>The <span class=Code1>TypeSymbol</span> will be a single character from this list.</p>

 <div align=center> <table style="border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <col> <tr> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHeadCenter>Type</p>

<p class=TableHeadCenter>Symbol</td><td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>Type&nbsp;Name</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>A</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Any</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>B</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Blob Functions and Methods.html" title="Blob Functions and Methods" class="wiki">Blob</a></td></tr> <tr> <td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>C</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Character Functions.html" title="Character Functions" class="wiki">Character</a></td></tr> <tr> <td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>D</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td rowspan="1" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Date and Time Functions.html" title="Date and Time Functions" class="wiki">Date</a></td></tr> <tr> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>E</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V6</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Exponent Numeric</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>F</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="../Xbasic/FUNCTION.html" title="FUNCTION" class="wiki">Function</a></td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>L</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Logical</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>N</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Numeric</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>P</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Object Functions and Methods.html" title="Object Functions and Methods" class="wiki">Object&nbsp;reference</a> ( <a href="Object Functions and Methods.html" title="Object Functions and Methods" class="wiki">Pointer</a> )</td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>T</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Date and Time Functions.html" title="Date and Time Functions" class="wiki">Time</a></td></tr> <tr> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>U</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V5</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="../Methods/Collection Methods.html" title="Collection Methods" class="wiki">Collection</a></td></tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>Y</td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableCenter>V6</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft><a href="Date and Time Functions.html" title="Date and Time Functions" class="wiki">Short Time</a></td></tr> </table> </div><p class=A5><a name=Declaring_the_Type_of_the_Return_Value>Declaring the Type of the Return Value</a></p>

<p>If a function returns a value, it can return only a single variable. Note how the value is returned by assigning it to the name of the receiving function. </p>

<p class=Pix><img src="images/WPT_Returning_Single_Value.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 583px; height: 275px; border-style: none; border-style: none;" width=583 height=275 border=0></p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION FunctionName1&nbsp;as&nbsp;N ()</p>

<p class=Code>... do stuff</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;FunctionName1 = 24</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName2&nbsp;as&nbsp;C (argument1&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;FunctionName2 = "George"</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName3&nbsp;as&nbsp;L (argument1&nbsp;as&nbsp;TypeSymbol, argument2&nbsp;as&nbsp;TypeSymbol, ... argumentN&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;FunctionName3 = .T.</p>

<p class=Code>END FUNCTION</td></tr> </table><p>A function does not have to return a value. If a function does <span class=Bolded>not</span> return a value, the following syntax applies. The "V" type symbol means "void" or "nothing".</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION FunctionName1&nbsp;as&nbsp;V ()</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName2&nbsp;as&nbsp;V (argument1&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</p>

<p class=Code>FUNCTION FunctionName3&nbsp;as&nbsp;V (argument1&nbsp;as&nbsp;TypeSymbol, argument2&nbsp;as&nbsp;TypeSymbol, ... argumentN&nbsp;as&nbsp;TypeSymbol)</p>

<p class=Code>... do stuff</p>

<p class=Code>END FUNCTION</td></tr> </table><p class=A5><a name=Returning_Multiple_Values_from_a_Function>Returning Multiple Values from a Function</a></p>

<p>The "normal" situation,&nbsp;as&nbsp;illustrated above, returns a single value of a single type. However, it possible to return multiple variables from a function. One scenario is&nbsp;as&nbsp;follows:</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>the calling function creates a data structure that contains multiple variables (a <a href="../Xbasic/Xbasic Reference/Pointer and Dot Variables.html" title="Pointer and Dot Variables" class="wiki">dot variable</a> or an <a href="../Xbasic/Xbasic Reference/Arrays.html" title="Arrays" class="wiki">array</a> )</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>the calling function sends a pointer to the data structure to the receiving function</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>the receiving function manipulates the variables in the data structure </p>

</li> </ul><p class=Pix><img src="images/WPT_Returning_Multiple_Values.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 515px; height: 275px; border-style: none; border-style: none;" width=515 height=275 border=0></p>

<p>The following sample code in the calling script or function illustrates how this might be done.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim mds&nbsp;as&nbsp;P</p>

<p class=Code>dim mds.firstname&nbsp;as&nbsp;C</p>

<p class=Code>dim mds.lastname&nbsp;as&nbsp;C</p>

<p class=Code>dim mds.age&nbsp;as&nbsp;N</p>

<p class=Code>mds.firstname = "George"</p>

<p class=Code>mds.lastname = "Washington"</p>

<p class=Code>mds.age = 35</p>

<p class=Code>FunctionName(mds)</td></tr> </table><p>The receiving function would have code like this. Note that it can reference the <span class=Code1>mds</span> data structure without actually knowing its true name. Note also that <span class=Code1>FunctionName</span> does not have to do anything to return the changes to the variables.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>FUNCTION FunctionName&nbsp;as&nbsp;V (abc&nbsp;as&nbsp;P)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.firstname = "Abraham"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.lastname = "Lincoln"</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;abc.age = 29</p>

<p class=Code>END FUNCTION</td></tr> </table><p class=A5>See Also</p>

<p><a href="../../Orphans/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Writing+Your+Own+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>