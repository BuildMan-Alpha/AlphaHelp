	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			


<p class=A3Method>SQL::Connection::AffectedRows()</p>



<p class=A5>Syntax</p>



<p><span class=Argument>RowCount</span>&nbsp;as&nbsp;N = <span class=Argument><SQL::Connection></span>.AffectedRows()</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 9.671%;">
<col style="width: 90.329%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 9.671%;" valign="top" width="9.671%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 90.329%;" valign="top" width="90.329%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.671%;" valign="top" width="9.671%">
<p class=TableLeft><span class=Argument>RowCount</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.329%;" valign="top" width="90.329%">
<p class=TableLeft>The number of affected rows.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.671%;" valign="top" width="9.671%">
<p class=TableLeft><span class=Argument><SQL::Connection></span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.329%;" valign="top" width="90.329%">
<p class=TableLeft>A <a href="../Objects/SQL Connection Object.html" title="SQL Connection Object" class="wiki">SQL::Connection</a> 
 <a href="../../Tutorials/SQL/Working with SQL Databases/Using AlphaDAO with Xbasic.html#Creating_an_Object" title="Using AlphaDAO with Xbasic" class="wiki">object</a>.</td></tr>
</table>

<p class=A5>Description</p>



<p>The AffectedRows() method returns the number of rows affected by the 
 last SQL INSERT, DELETE, or UPDATE statement.</p>
<p>IMPORTANT: In Version 10.5 and above, if there are no records that match the 
WHERE clause in the UPDATE or DELETE statement, the call result is set to .F.. 
across all database types.&nbsp; Previously, the call result was set 
inconsistently (.t. for MySQL and .f. for other database types).</p>



<p class=A5>Supported By</p>



<p>Alpha Five Version 8 Enterprise Edition</p>



<p class=A5>Limitations</p>







<p class=A5>Example</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim conn&nbsp;as&nbsp;SQL::Connection</p>


<p class=Code>dim del&nbsp;as&nbsp;SQL::DeleteStatement</p>


<p class=Code>dim sql_delete&nbsp;as&nbsp;C</p>


<p class=Code>sql_delete = "DELETE FROM CustomerX WHERE substring(lastname,1,1) 
 = 'J'"</p>


<p class=Code>if .not. conn.open("{A5API=Access, FileName='C:\Program 
 Files\A5V8\MDBFiles\Alphasports.mdb', UserName='Admin'}") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", 
 conn.callresult.text)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>conn.PortableSQLEnabled = .t.</p>
<p class=Code>dim flag as l </p>


<p class=Code>flag = conn.execute(sql_delete) then</p>
<p class=Code>if flag = .f. then </p>
<p class=Code>&nbsp;&nbsp;&nbsp; if "Database API" $ conn.callResult then </p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'a critical database 
error</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ui_msg_box("Critical 
Database Error",conn.callresult.text)</p>
<p class=Code>&nbsp;&nbsp;&nbsp; else</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'No matching record was 
found</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ui_msg_box("Error","No 
record satisfied the WHERE clause")</p>
<p class=Code>&nbsp;&nbsp;&nbsp; end if </p>
<p class=Code>else</p>
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Affected Rows", 
 str(conn.AffectedRows()))</p>


<p class=Code>end if</p>


<p class=Code>conn.close()</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
&nbsp;</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Objects/SQL Connection Object.html" title="SQL Connection Object" class="wiki">SQL::Connection Object</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL+Connection+AffectedRows+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>