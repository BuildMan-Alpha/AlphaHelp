	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>LAST()</p>

<p class=A5>Syntax</p>

<p> <span class=Argument>Last_Value</span>&nbsp;as&nbsp;A = LAST( <span class=Argument>Expression</span>&nbsp;as&nbsp;A, [ <span class=Argument>GRP <symbol name="En Dash"> �  >Group</span>&nbsp;as&nbsp;G [,&nbsp;<span class=Argument>GRP <symbol name="En Dash"> �  >Sub_Group</span>&nbsp;as&nbsp;G&nbsp;]]&nbsp;)</p>

 <table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <col> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>Argument</td> <td colspan="2" rowspan="1" class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>Description</td> <td_null> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft> <span class=Argument>Expression</span></td> <td colspan="2" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Any valid expression that includes a field or a combination of fields from the current table or set that specifies what you want to examine.</td> <td_null> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft> <span class=Argument>GRP <symbol name="En Dash"> �  >Group</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Optional. When to use the function (instead of on every record).</td> <td rowspan="2" colspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>The Group and Sub_Group are optional parameters that define the range of records to summarize, and may or may not be required, depending upon the context of the summary calculation.&nbsp;Possible values for <span class=Argument>GRP <symbol name="En Dash"> �  >Group</span> and <span class=Argument>GRP <symbol name="En Dash"> �  >Sub_Group</span> include:</p>

<ul style="list-style: disc;" type=disc> <li class=kadov-p-CTableBullet><p class=TableBullet>GRAND (all records)</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>The name of the current table.</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>The name of a table in the current set.</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>The name of a grouping level that is defined in a report layout</p>

</li> <li class=kadov-p-CTableBullet><p class=TableBullet>DETAIL (over the records in the detail section)</p>

</li> </ul></td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft> <span class=Argument>GRP <symbol name="En Dash"> �  >Sub_Group</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>Optional. When to reset the value produced by the function to 0 (instead at the end of all records).</td> <td_null> </tr> </table><p class=A5>Description</p>

<p>LAST() returns the last value of the <span class=Argument>Expression</span> evaluated for a group of records.&nbsp;&nbsp;The expression is evaluated for the last record in the sub-group that is related to the group's current record, and then the value is returned.</p>

<p>For example, to summarize the line-items in an invoice set, the Group parameter might be <span class=Code1>GRP <symbol name="En Dash"> �  >INVOICE</span> and the Sub_Group parameter <span class=Code1>GRP <symbol name="En Dash"> �  >INV_ITEM</span>.&nbsp;&nbsp;This means the Summary operation includes only those child records in <span class=Code1>INV_ITEM</span> related to the current parent record in the <span class=Code1>INVOICE</span> table.&nbsp;&nbsp;To summarize all the records in a table or set, use the name <span class=Code1>GRAND</span>&nbsp;as&nbsp;the Group name.&nbsp;The Group <span class=Code1>GRP <symbol name="En Dash"> �  >GRAND</span> and Sub_Group <span class=Code1>GRP <symbol name="En Dash"> �  >INV_ITEM</span> produce a summary result based on all invoices.</p>

<p>If you use this summary function in a report layout, the group name can be the name assigned to any of the report's grouping levels.</p>


<p class=A5>Examples</p>

<p>Assume that an invoicing set consists of two tables. One holds the invoices ( <span class=Code1>INVOICE</span> ), and the other holds each invoice's line-items ( <span class=Code1>INV_ITEM</span> ):</p>

  <div align=center>  <table style="border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <col> <tr> <td colspan="3" class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHeadCenter>INVOICE</td> <td_null> <td_null> </tr> <tr> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>INV_NO</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>CUST_ID</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>INV_TOTAL</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I100</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C001</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>10.00</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I101</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>25.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I102</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C001</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>100.75</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I103</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C004</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>32.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I104</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C002</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>110.25</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I105</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>C005</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>98.35</td> </tr> </table>  </div>    <div align=center>  <table cellspadding="3" style="border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <tr> <td colspan="2" class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHeadCenter>INV_ITEM</td> <td_null> </tr> <tr> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>INV_NO</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>AMOUNT</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I100</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>4.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I100</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>5.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I101</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>25.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I102</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>3.25</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I102</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>35.25</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I102</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>62.25</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I103</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>32.50</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I104</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>110.25</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>I105</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>98.35</td> </tr> </table>  </div> <p> <span class=Code1>INVOICE</span> is related to <span class=Code1>INV_ITEM</span> through a one-to-many link on the <span class=Code1>INV_NO</span> field.&nbsp;To find a particular invoice's last line-item record, use the following expression:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>'if the current INV_NO is "I102"</p>

<p class=Code>? last(INV_ITEM->AMOUNT, GRP <symbol name="En Dash"> �  >INVOICE, GRP <symbol name="En Dash"> �  >INV_ITEM)</p>

<p class=Code>= 62.25</td> </tr> </table><p>To determine the last record from the total number of <span class=Code1>INVOICE</span> records, the expression is:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? last(INVOICE->INV_NO, GRP <symbol name="En Dash"> �  >GRAND)</p>

<p class=Code>= I105</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="Report Functions and Methods.html" title="Report Functions and Methods" class="wiki">Report Functions and Methods</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:LAST+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"Record Functions"} --->
</body></html>