	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="CompileStringTemplate_">CompileStringTemplate()</h1>
<h3 class="showhide_heading" id="Syntax">Syntax</h3>
P <span style="color:#060; background:"><em>Result</em></span> =  CompileStringTemplate(C <span style="color:#060; background:"><em>string</em></span> )<br />
<br />
<table class="normal" id="fancytable_1">
	
		<tr>
			<td class="odd"><strong>Argument</strong> </td>
			<td class="odd"> <strong>Description</strong></td>
		</tr>
		<tr>
			<td class="even">P<span style="color:#060; background:"><em> Result</em></span> </td>
			<td class="even"> Compiled string template</td>
		</tr>
		<tr>
			<td class="odd">C<span style="color:#060; background:"><em> string</em></span> </td>
			<td class="odd"> String template that has expressions enclosed in { }</td>
		</tr>
</table><br />
<h3 class="showhide_heading" id="Description">Description</h3>
Compile a string template that has expression enclosed in <span style="color:blue; background:">{ }</span>. The compiled template created is an object, which is returned from the function. This compiled object has an <span style="color:blue; background:">.Output()</span> method that you can call to evaluate the string.<br />
<br />
The following sequence is the equivalent of <span style="color:blue; background:">new_string = evaluate_string(template)</span>:<br />
<br />
<span style="color:blue; background:">obj = CompileStringTemplate(template)<br />
new_string = obj.Output()</span><br />
<br />
While this may look more complicated than an <span style="color:blue; background:">evaluate_string()</span> call,  <span style="color:blue; background:">CompileStringTemplate()</span> is much more efficient than <span style="color:blue; background:">evaluate_string()</span> when used inside a loop.<br />
<br />
What can go inside the <span style="color:blue; background:">{...}</span> curly brackets can be arbitrarily complex Xbasic expressions. In the examples below we have restricted ourselves to database fields with simple character manipulation functions for simplicity.<br />
<br />
<h3 class="showhide_heading" id="Limitations">Limitations</h3>
None<br />
<h3 class="showhide_heading" id="Examples">Examples</h3>
In this example, the first row in the <strong>customer</strong> table has a firstname of Tom and a city of Boston. This example is written for a DBF table.<br />
<br />
<span style="color:blue; background:"><div class="plugincode" parse="xbasic"><pre class="codelisting" data-syntax="xbasic" dir="ltr" style="overflow:auto;" id="codebox" >txt <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&quot;hello {t.data(\&quot;</span>firstname\<span style="color: #ff0000;">&quot;)}: Welcome to {upper(t.data(\&quot;</span>city\<span style="color: #ff0000;">&quot;))}&quot;</span>
<span style="color: #000066;font-weight: bold">dim</span> t as p
t <span style="color: #66cc66;">=</span> table.<span style="color: #000066;font-weight: bold">open</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;customer&quot;</span><span style="color: #66cc66;">&#41;</span>
?evaluate_string<span style="color: #66cc66;">&#40;</span>txt<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&quot;Hello Tom: Welcome to BOSTON.</span></pre></div></span><br />
<br />
Here is the same example using a compiled string template:<br />
<br />
<span style="color:blue; background:"><div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox1" >txt = "hello {t.data(\"firstname\")}: Welcome to {upper(t.data(\"city\"))}"
dim p as p 
p = compilestringtemplate(txt)
dim t as p
t = table.open("customer")
?p.output()
= "Hello Tom: Welcome to BOSTON.

'Note that &lt;tbl&gt;.data("fieldname") allows you to read data from a field in a table. 
'tbl.data("firstname"), is similar to the tbl.firstname, i.e. both return the value in the firstname
'field. But tbl.data("firstname") removes trailing blanks.</pre></div></span><br />
An extremely common pattern in Web Applications is to do a database query and then generate some HTML content to send to the browser. The HTML content is often generated by merging data from the database into an HTML template. The evaluate_string() is ideal for merging data into a template. In the case where the HTML content is constructed by looping over the records in the query and merging data into the template for each row in the query, the compilestringtemplate() function can be used to improve performance.<br />
<br />
This example is written for AlphaDAO.<br />
<br />
<span style="color:blue; background:"><div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox2" >dim tableBegin as c 
tableBegin = "&lt;table&gt;"
dim thead as c 
thead = &lt;&lt;%html%
&lt;thead&gt;
&lt;tr&gt;
&lt;th class="customerId"&gt;CustomerId&lt;/th&gt;
&lt;th class="CompanyName"&gt;Company Name&lt;/th&gt;
&lt;th class="ContactName"&gt;Contact Name&lt;/th&gt;
&lt;th class="Address"&gt;Address&lt;/th&gt;
&lt;th class="City"&gt;City&lt;/th&gt;
&lt;th class="Country"&gt;Country&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
%html%

dim tbodyBegin as c 
tbodyBegin = "&lt;tbody&gt;"

dim tRow as c 
trow = &lt;&lt;%html%
&lt;tr&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("customerId"))}&lt;/td&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("companyName"))}&lt;/td&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("contactName"))}&lt;/td&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("address"))}&lt;/td&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("city"))}&lt;/td&gt;
&lt;td class="gridCell"&gt;{a5_html_label(rs.data("country"))}&lt;/td&gt;
&lt;/tr&gt;
%html%

dim tbodyEnd as c 
tbodyEnd = "&lt;/tbody&gt;"

dim tableEnd as c 
tableEnd = "&lt;/table&gt;"

dim cn as sql::connection
cn.open("::name::northwind")
dim sql as c 
sql = "select customerId, CompanyName, ContactName, Address, City, Country from customers order by companyname"

cn.Execute(sql)
dim rs as sql::resultset
rs = cn.ResultSet

dim htmlRows as c = ""
dim p as p
'compiling the string template is faster than using the evaluate_string() function in a loop.
p = compilestringtemplate(trow)

while rs.nextRow()
	'the *concat() function is much faster than doing: htmlRows = htmlRows + p.output()
	*concat(htmlRows,p.output())
end while

dim allHTML as c 
allHTML = tableBegin +crlf()+\
thead + crlf()+\
tbodyBegin + crlf()+\
htmlRows + crlf()+\
tbodyEnd+crlf()+\
tableEnd

'if you want to see how the html will render
a5_show_html(allhtml)
'if you want to see the raw html
'showvar(allHTML)

cn.close()</pre></div></span><br />
<h3 class="showhide_heading" id="See_Also">See Also</h3>
<a href="Character Replacement Functions.html" title="Character Replacement Functions" class="wiki">Character Replacement Functions</a>, <a href="EVALUATE_STRING Function.html" title="EVALUATE_STRING Function" class="wiki">EVALUATE_STRING Function</a><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:CompileStringTemplate+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common"} --->
</body></html>