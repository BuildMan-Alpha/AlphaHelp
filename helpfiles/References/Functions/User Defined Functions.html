	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>User Defined Functions</p>



<p>While Xbasic offers many powerful functions, it is also possible to 
 define and use functions of your own. Alpha Five lets you create two different 
 kinds of user-defined functions. A local user defined function can be 
 called from anywhere within the script in which it is declared. A global 
 (or public) user defined function can be used anywhere in Alpha Five, 
 including in expressions for calculated fields on forms, and indexes.</p>



<p>For more information on local user-defined functions, see the <a href="../Xbasic/FUNCTION.html" title="FUNCTION" class="wiki">FUNCTION</a> 
 statement description.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Function names 
 should begin with a letter (A-Z, a-z) and may contain numbers and underscore 
 (_) characters. Although the use of the period (.) character is not prohibited, 
 it may not be supported in future releases of Alpha Five.</p>



<p class=A5><a name=Global_User_Defined_Functions>Global User Defined Functions</a></p>



<p>Alpha Five allows you to create global functions&nbsp;(also called User 
 Defined Functions (UDFs) in some languages). Alpha Five comes with many 
 built in functions, such&nbsp;as&nbsp;TRIM(), SUBSTR()etc. These functions 
 can be used in any Alpha Five expression. For example, a calculated field 
 might be defined with this expression. <span class=Code1>Trim(firstname) 
 + " " + lastname</span>.</p>



<p>Global Functions allow you to define your own functions, which can be 
 used in Alpha Five expressions just like the built in Alpha Five functions. 
 Global Functions are written in Xbasic. Here is an example of a simple 
 Global Function:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function fullname&nbsp;as&nbsp;C (first&nbsp;as&nbsp;C, last&nbsp;as&nbsp;C)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fullname 
 = trim(first) + " " + last</p>


<p class=Code>end function</td></tr>
</table>

<p>To use this Global Function in an expression (assuming that the first 
 name field was called <span class=Code1>FN</span> and that the last name 
 field was called <span class=Code1>LN</span> ), you would type:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>fullname(fn, ln)</td></tr>
</table>

<p class=A5><a name=How_to_Define_a_Global_Function>How to Define a Global 
 Function</a></p>



<p>To define a global function, select the <span class=Button>Code</span> 
 tab on the <span class=Screen>Control Panel</span> and click the <span 
 class=Button>New</span> button. Check <span class=Button>Function</span> 
 on the <span class=Screen>New Object</span> dialog box. In the next dialog 
 box, specify the function name, the data type that the function returns, 
 and the operands that the function accepts. You can also define functions 
 with optional operands. For each operand, you must specify the type. When 
 you press the <span class=Button>OK</span> button, Alpha Five displays 
 the script editor with a code skeleton filled in describing the function.</p>



<p>For example, assume you defined a function called <span class=Code1>shipping_charge</span>&nbsp;as&nbsp;a 
 numeric function, with the following operands:</p>




<div align=center>
<table style="x-cell-content-align: top;
				border-left-style: None;
				border-top-style: None;
				border-right-style: None;
				border-bottom-style: None;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variable</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Type</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>state</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>character</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>weight</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>numeric</td></tr>
</table>
</div>
<p>Alpha Five will create the following Xbasic skeleton for you in the 
 <span class=Screen>Scripts</span> tab of the <span class=Screen>Code Editor</span> 
 :</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function shipping_charge&nbsp;as&nbsp;N (state&nbsp;as&nbsp;C, 
 weight&nbsp;as&nbsp;N)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'type your code here</p>


<p class=Code>end function</td></tr>
</table>

<p>You will then need to enter the Xbasic code that defines this Global 
 Function where the comment "type your code here" appears. To 
 have the function return a value, assign the value to the function name 
 in the Xbasic code. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>order_total = order_amount + shipping_charge("NY", 
 3.5)</p>


<p class=Code>function shipping_charge&nbsp;as&nbsp;N (state&nbsp;as&nbsp;C, 
 weight&nbsp;as&nbsp;N)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'type your code here</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (state = "MA") Then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shipping_charge 
 = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shipping_charge 
 = weight * 2.5</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end function</td></tr>
</table>

<p>See the description of the <a href="../Xbasic/FUNCTION.html" title="FUNCTION" class="wiki">FUNCTION</a> 
 command statement for more information on creating Global Functions, including 
 information on how to define functions with optional operands.</p>



<p class=A5><a name=Optional_Parameters>Optional Parameters</a></p>



<p>If you want to make a parameter optional, provide a default value in 
 the function definition. For example the following function sets the default 
 value of <span class=Code1>state</span> to "MA":</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function shipping_charge&nbsp;as&nbsp;N ( <span class=Code1>order_total</span>&nbsp;as&nbsp;N, 
 state = "MA", weight&nbsp;as&nbsp;N)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'type your code here</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (state = "MA") Then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shipping_charge 
 = 0</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shipping_charge 
 = weight * 2.5</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end function</td></tr>
</table>

<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : If you want 
 to assign a NULL value to an optional parameter, you may use the <a href="NULL_VALUE Function.html" title="NULL_VALUE Function" class="wiki">NULL_VALUE(</a>) 
 function. For example: <span class=Code1>FUNCTION ImALittleFunction&nbsp;as&nbsp;L 
 ( EquipmentNum&nbsp;as&nbsp;C, tablePointer = NULL_VALUE())</span>.</p>



<p>If a function receives an optional pointer parameter, you can test whether 
 you have received a value by using the <a href="TYPEOF Function.html" title="TYPEOF Function" class="wiki">TYPEOF(</a>) 
 function. It will return "Z" for a NULL value.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function myfunc&nbsp;as&nbsp;l (optional_pointer = null_value()&nbsp;as&nbsp;p)</p>


<p class=Code>if typeof(optional_pointer) = "Z" then <br>
&nbsp;&nbsp;&nbsp;&nbsp;'no optional_pointer was passed into this function 
 call <br>
end if <br>
<br>
end function</td></tr>
</table>

<p class=A5><a name=How_to_Share_Global_Functions>How to Share Global Functions</a></p>



<p>You can use the global functions that you define in one database in 
 another database. For example, while using a database called Invoice, 
 you might have created the following global functions: FULLNAME(), INVOICE_TOTAL(), 
 and SHIPPING_CHARGE(). Assume that you are now working in another database, 
 called Inventory, for example, and you want to have access to the Global 
 Functions&nbsp;that were defined for the Invoice database. To access these 
 global functions, you can attach the library from the Invoice database 
 to the Inventory database.</p>



<p>To attach an external library:</p>



<ol start=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Give focus to the 
 <span class=Screen>Control Panel</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>File 
 > Database properties</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <span 
 class=Button>Libraries</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Add the new library.</p>

</li>
</ol>

<p class=A5><a name=Restriction_on_the_Use_of_Global_Functions>Restriction 
 on the Use of Global Functions</a></p>



<p>Global functions can be used anywhere in Alpha Five where expressions 
 are allowed. However, there are restrictions on the Xbasic code that the 
 global function executes. For example, you might have defined a global 
 function named <span class=Code1>OpenForm()</span> that opens a form. 
 You could use this global function in a push event for a button on a form, 
 but you could <span class=Note>not</span> use this global functions in 
 an index expression.</p>



<p class=A5><a name=Multiple_Functions_in_a_Single_Script>Multiple Functions 
 in a Single Script</a></p>



<p>You may have multiple functions in a single script. However, only the 
 function that shares the script name will be externally available. Consider 
 the following script named <span class=Code1>global_function</span>. Scripts 
 through-out the application may call <span class=Code1>global_function</span>, 
 but only <span class=Code1>global_function</span> may <span class=Code1>call 
 local_function1()</span> and <span class=Code1>local_function2()</span>. 
 </p>



<p class=Pix><img src="images/XB_Script_architecture.gif"
					x-maintain-ratio=TRUE
					style="border-left-style: Solid;
							border-left-width: 1px;
							border-right-style: Solid;
							border-right-width: 1px;
							border-top-style: Solid;
							border-top-width: 1px;
							border-bottom-style: Solid;
							border-bottom-width: 1px;
							float: none;
							width: 451px;
							height: 232px;"
					width=451
					height=232
					border=1></p>



<p class=A5>See Also</p>



<p><a href="../../Unclassified/Parameters that Can be Passed to Global Functions.html" title="Parameters that Can be Passed to Global Functions" class="wiki">Parameters   that Can be Passed to Global Functions</a>, <a href="../Desktop/Global Scripts.html" title="Global Scripts" class="wiki">Global   Scripts</a>, <a href="../../Unclassified/Passing Variables by Reference.html" title="Passing Variables by Reference" class="wiki">Passing Variables   by Reference</a>, <a href="../Xbasic/Defining a Function with Optional Pointer Variables.html" title="Defining a Function with Optional Pointer Variables" class="wiki">Defining   a Function with Optional Pointer Variables</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:User+Defined+Functions">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>