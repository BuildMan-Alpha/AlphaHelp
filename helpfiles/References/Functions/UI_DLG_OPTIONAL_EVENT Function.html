	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Function>UI_DLG_OPTIONAL_EVENT()</p>



<p class=A5>Syntax</p>



<p>UI_DLG_OPTIONAL_EVENT( <span class=Argument>Title</span>&nbsp;as&nbsp;C, 
 <span class=Argument>Event</span>&nbsp;as&nbsp;C [,&nbsp;<span class=Argument>Immediate</span>&nbsp;as&nbsp;L&nbsp;] 
 )</p>




<table style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 12.6%;">
<col style="width: 87.4%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top; width: 12.6%;" valign="top" width="12.6%">
<p class=TableHead>Argument</td>
<td class="tableHeader" style="x-cell-content-align: top; width: 87.4%;" valign="top" width="87.4%">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 12.6%;" valign="top" width="12.6%">
<p class=TableLeft><span class=Argument>Title</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.4%;" valign="top" width="87.4%">
<p class=TableLeft>The name of the dialog.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 12.6%;" valign="top" width="12.6%">
<p class=TableLeft><span class=Argument>Event</span></td>
<td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 87.4%;" valign="top" width="87.4%">
<p class=TableLeft>The name of the event to pass.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top; width: 12.6%;" valign="top" width="12.6%">
<p class=TableLeft><span class=Argument>Immediate</span></td>
<td class="TableCell" style="x-cell-content-align: top; width: 87.4%;" valign="top" width="87.4%">
<p class=TableLeft>Optional. Default = .F. Whether to wait until the event 
 is processed.</p>


<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>.T. = Wait until 
 event is processed.</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>.F. = Do not wait.</p>

</li>
</ul></td></tr>
</table>

<p class=A5>Description</p>



<p>The UI_DLG_OPTIONAL_EVENT() function invokes an action event in the specified 
 dialog, but only if the specified dialog exists. This allows you to leave out 
code in your script that tests to see if the dialog actually exists (using the 
ui_modeless_dlg_exist() function).</p>






<p class=A5>Limitations</p>



<p>Desktop applications only.</p>



<p class=A5>Example</p>



<p>This example receives and displays status from multiple user defined 
 functions.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function status_list&nbsp;as&nbsp;v ()</p>


<p class=Code>dim completed&nbsp;as&nbsp;C</p>


<p class=Code>dim message2&nbsp;as&nbsp;C</p>


<p class=Code>completed = ""</p>


<p class=Code>ui_modeless_dlg_box("StatusList",<<%dlg%</p>


<p class=Code>Completed:;</p>


<p class=Code>[.100,5^#completed];</p>


<p class=Code>Current task:;</p>


<p class=Code>[.100message2?.t.];</p>


<p class=Code><Close>;</p>


<p class=Code>%dlg%,<<%code%</p>


<p class=Code>if (a_dlg_button = "close") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close("statuslist")</p>


<p class=Code>end if</p>


<p class=Code>if (atc("Completed:",a_dlg_button) = 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;completed_i = substr(a_dlg_button,11)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;completed = completed + crlf()+ completed_i</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;completed = remove_blank_lines(completed)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_refresh("statuslist")</p>


<p class=Code>end if</p>


<p class=Code>if (atc("Working:",a_dlg_button) = 1) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;message2 = substr(a_dlg_button,9)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_refresh("statuslist")</p>


<p class=Code>end if</p>


<p class=Code>%code%)</p>


<p class=Code>end function</td></tr>
</table>

<p>The calling user defined function calls the <span class=Code1>StatusList</span> 
 dialog with variations of the following syntax:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ui_dlg_optional_event("StatusList", "working:Listing 
 files in " + directory, .t.)</p>


<p class=Code>ui_dlg_optional_event("StatusList", "completed:Adding 
 " + directory + " files to database", .t.)</td></tr>
</table>

<p>The following example sends an event from the parent modeless dialog 
 to the embedded child modeless dialog.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ui_modeless_dlg_box("ParentDialog",<<%dlg%</p>


<p class=Code>{startup=init}</p>


<p class=Code>{frame=1,1}</p>


<p class=Code>{embedded=40,20:ChildDialog};</p>


<p class=Code>{lf};</p>


<p class=Code><Close>{sp}<Hello>;</p>


<p class=Code>%dlg%,<<%code%</p>


<p class=Code>if a_dlg_button = "Hello" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_dlg_optional_event("ChildDialog","Hello",.t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("","Another 
 message from the parent dialog")</p>


<p class=Code>end if</p>


<p class=Code>if a_dlg_button = "init" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button = ""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;show_embedded(local_variables())</p>


<p class=Code>end if</p>


<p class=Code>if a_dlg_button = "close" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close("ParentDialog")</p>


<p class=Code>end if</p>


<p class=Code>%code%)</p>


<p class=Code>function show_embedded&nbsp;as&nbsp;v (vars&nbsp;as&nbsp;P)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;with vars</p>


<p class=Code>ui_modeless_dlg_box("ChildDialog",<<%dlg%</p>


<p class=Code>{wrap=40}</p>


<p class=Code>This is an embedded dialog box that responds to the Hello 
 event sent to it from its parent.;</p>


<p class=Code>{lf};</p>


<p class=Code>Name: [.20name];</p>


<p class=Code>{lf};</p>


<p class=Code>Enter a name into the Name field and click this button. After 
 2 seconds, the "Hello" dialog box will appear.;</p>


<p class=Code>{lf};</p>


<p class=Code><Hello>;</p>


<p class=Code>%dlg%,<<%code%</p>


<p class=Code>if a_dlg_button = "Hello" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;sleep(2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("","Hello: 
 " + name)</p>


<p class=Code>end if</p>


<p class=Code>%code%)</p>


<p class=Code>&nbsp;&nbsp;</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end 
 with</p>


<p class=Code>end function</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../Xdialog/Xdialog Reference/Xdialog Function Reference.html" title="Xdialog Function Reference" class="wiki">Xdialog Function Reference</a>, 
 <a href="UI_MODELESS_DLG_EXIST Function.html" title="UI_MODELESS_DLG_EXIST Function" class="wiki">UI_MODELESS_DLG_EXIST(</a>), <a href="UI_DLG_EVENT Function.html" title="UI_DLG_EVENT Function" class="wiki">UI_DLG_EVENT(</a>)</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:UI_DLG_OPTIONAL_EVENT+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>