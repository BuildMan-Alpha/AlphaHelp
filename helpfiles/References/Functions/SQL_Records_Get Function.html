	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<b>SQL_Records_Get() Function <br />
</b>Returns a CRLF delimited string with data  from a table or query in a remote database using AlphaDAO.
<p><strong>Syntax:</strong> <br />
C Result = SQL_Records_Get (C <i>connection</i>,C&nbsp;  <i>table_or_sql_statement</i>,C&nbsp; <i>filter</i>,C&nbsp; <i>result_Expression</i>  [,SQL::Arguments&nbsp; <i>args</i>] )<br />
&nbsp;</p>
<p>Where:</p>
<div>
<table style="BORDER-COLLAPSE: collapse" id="table44" border="1" cellspacing="1" cellpadding="3">
    <tbody>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>result  </i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">A CRLF delimited string of data from the remote table or query. CRLFs  in the data are encoded as '\cr\lf'.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>connection  </i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">An explicit AlphaDAO connection string, or a named connection string.  (e.g. ::name::myconnectionstring), or a pointer to an open connection.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>table_or_sql_statement</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">The name of the table in the remote database from which to return  data. Can either be a table name, or a SQL SELECT statement that retrieves data  from one or more tables. If a SQL SELECT statement is specified the  <i>result_Expression</i> parameter is meaningless and must be set to a null  string.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>filter</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">A filter expression to determine which records in the remote table to  find. The filter expression must use SQL syntax and must use portable AlphaDAO  functions. For example, strings must be single quoted, the AND,&nbsp; OR and NOT  operators are not surrounded by periods. The filter expression can use  arguments. For example, customerid = :whatcustomerid. If  <i>table_or_sql_statement</i> is a SQL SELECT then <i>filter</i> is meaningless  and must be set to a null string.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>result_Expression</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">A expression to determine what values gets returned. The expression  can be as simple as a single column name in the remote table, or it can be a  complex expression. The expression must be written using portable AlphaDAO  syntax. If <i>table_or_sql_statement</i> is a SQL SELECT then  <i>result_Expression </i>&nbsp;is meaningless and must be set to a null  string.</td>
        </tr>
        <tr>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top"><i>arguments</i></td>
            <td style="FONT-FAMILY: Tahoma; FONT-SIZE: 8pt; VERTICAL-ALIGN: top" width="1062">If the <i>filter</i> expression or the SELECT statement in the  <i>table_or_sql_statement</i> argument&nbsp; includes arguments, you must supply  argument values using a SQL::arguments object.</td>
        </tr>
    </tbody>
</table>
</div>
<p>&nbsp;</p>
<p>Examples:</p>
<p>&nbsp;</p>
<p class="xbasic">connection =  "{A5API=Access,FileName='C:\northwind2\northwind2003.mdb',UserName='Admin'}"<br />
table  = "customers"<br />
result_expression = "concatenate(city,' -  ',contactname)"<br />
filter = "city = 'london'"<br />
?  sql_records_get(connection,table,filter,result_expression)<br />
= London - Thomas  Hardy<br />
London - Victoria Ashworth<br />
London - Elizabeth Brown<br />
London - Ann  Devon<br />
London - Simon Crowther<br />
London - Hari Kumar<br />
&nbsp;</p>
<p class="xbasic">'In this example the filter includes an argument<br />
connection =  "{A5API=Access,FileName='C:\northwind2\northwind2003.mdb',UserName='Admin'}"<br />
table  = "customers"<br />
result_expression = "concatenate(city,' -  ',contactname)"<br />
filter = "city = :whatcity"<br />
dim args as  sql::arguments<br />
args.set("whatcity","london")<br />
?  sql_records_get(connection,table,filter,result_expression,args)<br />
= London -  Thomas Hardy<br />
London - Victoria Ashworth<br />
London - Elizabeth Brown<br />
London  - Ann Devon<br />
London - Simon Crowther<br />
London - Hari Kumar<br />
<br />
<br />
&nbsp;</p>
<p class="xbasic">'In this example, a complete SQL SELECT statement is used for  the 'table' argument.</p>
<p class="xbasic">'Note that CRLFs in the data are returned as \cr\lf.</p>
<p class="xbasic">'Columns in the data are pipe (e.g.'|') delimited.</p>
<p class="xbasic">'Also, a pointer to an open connection, rather than a connection  string, is passed in.</p>
<p class="xbasic">'Since we are passing in an open connection, the function is  much faster</p>
<p class="xbasic">&nbsp;</p>
<p class="xbasic">dim cn as sql::connection<br />
connection =  "{A5API=Access,FileName='C:\northwind2\northwind2003.mdb',UserName='Admin'}"</p>
<p class="xbasic">cn.open(connection)<br />
table = "select customerid, contactname,  address from customers where city = 'london'"<br />
result_expression =  ""<br />
filter = ""<br />
? sql_records_get(cn,table,filter,result_expression)<br />
=  AROUT|Thomas Hardy|120 Hanover Sq.<br />
BSBEV|Victoria Ashworth|Fauntleroy  Circus<br />
CONSH|Elizabeth Brown|Berkeley Gardens\cr\lf12 Brewery <br />
EASTC|Ann  Devon|35 King George<br />
NORTS|Simon Crowther|South House\cr\lf300  Queensbridge<br />
SEVES|Hari Kumar|90 Wadhurst Rd</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:SQL_Records_Get+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"SQL Helper Functions","status":"pending"} --->
</body></html>