	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>TABLEAVG()</p>

<p class=A5>Syntax</p>

<p> <span class=Argument>Average_Of_Values</span>&nbsp;as&nbsp;N = TABLEAVG( <span class=Argument>Lookup_Table</span>&nbsp;as&nbsp;C, <span class=Argument>Filter</span>&nbsp;as&nbsp;C, <span class=Argument>Lookup_Expression</span>&nbsp;as&nbsp;C&nbsp;)</p>

 <table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 13.178%;"> <col style="width: 86.822%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 13.178%;" valign="top" width="13.178%"><p class=TableHead>Argument</td> <td colspan="1" rowspan="1" class="tableHeader" style="x-cell-content-align: top; width: 86.822%;" valign="top" width="86.822%"><p class=TableHead>Description</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 13.178%;" valign="top" width="13.178%"><p class=TableLeft> <span class=Argument>Lookup_Table</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 86.822%;" valign="top" width="86.822%"><p class=TableLeft>The full drive, path, name, and extension of the table.&nbsp;If you omit the drive, path, and extension, Alpha Five searches the directory of the current table.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 13.178%;" valign="top" width="13.178%"><p class=TableLeft> <span class=Argument>Filter</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 86.822%;" valign="top" width="86.822%"><p class=TableLeft>A <a href="../../Unclassified/Writing Expressions.html#Character_Filter_Expressions" title="Writing Expressions" class="wiki">character filter expression</a> that evaluates to a logical value. Selects records to average.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top; width: 13.178%;" valign="top" width="13.178%"><p class=TableLeft> <span class=Argument>Lookup_Expression</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 86.822%;" valign="top" width="86.822%"><p class=TableLeft>An expression based on numeric or exponent numeric field(s) in the <span class=Argument>Lookup_Table</span>.&nbsp;&nbsp;</td> </tr> </table><p class=A5>Description</p>

<p>Searches the specified <span class=Argument>Lookup_Table</span> for one or more records that satisfy the specified Filter, and returns the average of the values contained in the <span class=Argument>Lookup_Expression</span>.&nbsp;&nbsp;The <span class=Argument>Filter</span> must return a logical value, either True (.T.) or False (.F.).&nbsp;For example, to choose all of the records in a table, use the logical constant ".T."&nbsp;as&nbsp;a filter.&nbsp;To choose only the records where the STATE field is equal to TN, use the filter "STATE = 'TN'".&nbsp;Note that the entire filter is always in quotations, and the character value, TN, is in single quotes.</p>

<p class=Note> <span class=Note> <img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0>NOTE:&nbsp;</span> If no records satisfy the filter, Alpha Five returns a zero value.</p>

<p class=A5>Examples</p>

<p>Assume that a department purchasing table (PURCHASE) contains the following records:</p>

<p class=PixCaption>PURCHASE TABLE</p>

  <div align=center>  <table style="x-cell-content-align: top; border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <col> <col> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>MANAGER</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>COST</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>BILL_DATE</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>PAID_UP</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>ANDRY</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>18500.00</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>01/01/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>T</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>BROWN</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>49.95</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>02/01/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>T</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>BROWN</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>12.99</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>04/01/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>F</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>FARLEY</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>7995.00</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>03/01/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>F</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>FARLEY</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>142.16</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>04/10/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>T</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>FARLEY</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>423.00</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>05/10/2003</td> <td class="TableCell" style="x-cell-content-align: top;" valign="top"><p class=TableLeft>F</td> </tr> </table>  </div> <p class=Note> <span class=Note> <img src="images/icon_warning.gif" x-maintain-ratio=TRUE style="border: none; width: 37px; height: 33px; float: none; border-style: none; border-style: none;" width=37 height=33 border=0>Note</span> : for detailed explanations of the filter expressions used in these examples, see TABLECOUNT().</p>

<p class=A5>All Records</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", ".T.", "COST")</p>

<p class=Code>= 4520.516667</td> </tr> </table><p class=A5>Filter Using a Specific Character String</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where "Brown" is the manager:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", "MANAGER = 'BROWN'", "COST")</p>

<p class=Code>= 31.47</td> </tr> </table><p class=A5>Filter Using a Character Variable</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where the manager matches the character string previously assigned to the variable <span class=Code1>vManager</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF","Manager = '" + vManager + "' ", "COST")</p>

<p class=Code>= 2853.386667 'if vManager is "FARLEY"</td> </tr> </table><p class=A5>Filter Using a Specific Number</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where the <span class=Code1>Cost</span> is greater than 1000.00.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", "Cost > 1000.00", "COST")</p>

<p class=Code>= 13247.50</td> </tr> </table><p class=A5>Filter Using Numeric Variable</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where the <span class=Code1>Cost</span> is greater than whatever amount has been previously assigned to the numeric variable <span class=Code1>vCost</span>.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", "Cost > " + vCost, "COST")</p>

<p class=Code>= 13247.50 ' if vCost = 1000.00</td> </tr> </table><p class=A5>Filter Using a Specific Date Value</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where the <span class=Code1>Bill_Date</span> is equal to or later than January 1, 2003.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", "BILL_DATE >= {01/01/2003}", "COST")</p>

<p class=Code>= 4520.516667</td> </tr> </table><p class=A5>Filter Using Date Variables</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where the <span class=Code1>Bill_Date</span> is equal to or later than the date previously assigned to <span class=Code1>vBeginDate</span> AND equal to or later than the date previously assigned to <span class=Code1>vEndDate.</span></p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF","BETWEEN(BILL_DATE,{"+DTOC(vBeginDate)+"},{"+DTOC(vEndDate)+"})","COST")</p>

<p class=Code>= 77.575000 ' if vBeginDate is 04/01/2003 and vEndDate is 04/30/2003</td> </tr> </table><p class=A5>Filter Using Logical Variables</p>

<p>The following expression returns the average of the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where <span class=Code1>Paid_Up</span> is true:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", "PAID_UP", "COST")</p>

<p class=Code>= 6230.703333</td> </tr> </table><p>While this expression averages the values in the <span class=Code1>Cost</span> field for all records in the <span class=Code1>Purchase</span> table where <span class=Code1>Paid_Up</span> is not true:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>? TABLEAVG("PURCHASE.DBF", ".NOT. PAID_UP", "COST")</p>

<p class=Code>= 2810.330000</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table Functions and Methods</a>, <a href="Record Functions.html" title="Record Functions" class="wiki">Record Functions</a>, <a href="TABLE and DB Functions Contrasted.html" title="TABLE and DB Functions Contrasted" class="wiki">TABLE and DB Functions Contrasted</a>, <a href="../../Unclassified/Writing Expressions.html" title="Writing Expressions" class="wiki">Writing Expressions</a></p>

<p class=A5>Thanks to</p>

<p>Tom Cone</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:TABLEAVG+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>