	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Function>EXIST()</p>

<p class=A5>Syntax</p>

<p> <span class=Argument>Key_Exist_Flag</span>&nbsp;as&nbsp;L = EXIST( <span class=Argument>Key_Value</span>&nbsp;as&nbsp;C, <span class=Argument>Table_Name</span>&nbsp;as&nbsp;C, <span class=Argument>Index_Name</span>&nbsp;as&nbsp;C )</p>

 <table style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 9.458%;"> <col style="width: 90.542%;"> <tr style="x-cell-content-align: top;" valign="top"> <td class="tableHeader" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableHead>Argument</td> <td class="tableHeader" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableHead>Description</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableLeft> <span class=Argument>Key_Value</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableLeft>A string constant, character variable, or an expression that returns a character value.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableLeft> <span class=Argument>Table_Name</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableLeft>The filename of the table you want to search.&nbsp;The <span class=Argument>Table_Name</span> parameter can include a full drive and path specification.&nbsp;If you omit the drive and path, Alpha Anywhere searches the current directory.</td> </tr> <tr style="x-cell-content-align: top;" valign="top"> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 9.458%;" valign="top" width="9.458%"><p class=TableLeft> <span class=Argument>Index_Name</span></td> <td colspan="1" rowspan="1" class="TableCell" style="x-cell-content-align: top; width: 90.542%;" valign="top" width="90.542%"><p class=TableLeft>The name of an index that may contain the <span class=Argument>Key_Value</span>.&nbsp;The <span class=Argument>Index_Name</span> parameter can include a full drive and path specification. If you omit the drive and path, Alpha Anywhere searches the current directory.</td> </tr> </table><p class=A5>Description</p>

<p>EXIST() returns .T. (TRUE)&nbsp;if the <span class=Argument>Key_Value</span> exists in the <span class=Argument>Index_Name</span> index; otherwise, it returns .F. (FALSE).</p>

<p>The EXIST() function is useful for checking if a record with a certain <span class=Argument>Key_Value</span> exists in a table. You can use this function to prevent duplicate records from being entered into a table, or to ensure that a similar record exists in another table before you can enter the record into the current table.</p>

<p>If you want to check for numeric or date values within a table, we recommend that you specify an index that converts the values to the character type. The following is an example Index expression for a numeric field containing dollar values:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>ltrim( str(RETAIL, 10, 2) )</td> </tr> </table><p> <a href="LTRIM Function.html" title="LTRIM Function" class="wiki">LTRIM(</a>)trims the leading blank spaces so that you can specify a number like "50.15"&nbsp;as&nbsp;a key value and the <a href="STR Function.html" title="STR Function" class="wiki">STR(</a>)function converts values in the RETAIL numeric field to character.</p>

<p>The following is an example Index expression for a date field:</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dtoc(INV_DATE)</td> </tr> </table><p>You can then specify a date&nbsp;as&nbsp;the key value in the MM/DD/YYYY format. Or use the CDATE() function in place of DTOC().</p>


<p class=A5>Examples</p>

<p>Assume that the following table contains the records shown, and that the index PROD_ORD is defined&nbsp;as&nbsp;TRIM(PROD_NAME):</p>

  <div align=center>  <table style="border-left-style: none; border-right-style: none; border-top-style: none; border-bottom-style: none; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <tr> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>PROD_ID</td> <td class="tableHeader" style="x-cell-content-align: top;" valign="top"><p class=TableHead>PROD_NAME</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">P005</td> <td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">Silver Fox Golf Woods</td> </tr> <tr> <td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">P006</td> <td class="TableCell" style="x-cell-content-align: top; border-spacing: 0px;" valign="top">Silver Fox Irons</td> </tr> </table>  </div>   <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>EXIST("silver fox irons", "PRODUCT.DBF", "PROD_ORD") ? TRUE&nbsp;for the second record.</td> </tr> </table><p>Assume that you are entering names and addresses into a contact table ( <span class=Code1>CONTACTS</span> ), and want to prevent the entry of duplicate records. A duplicate record has the same values in the <span class=Code1>FIRSTNAME</span>, <span class=Code1>LASTNAME</span>, and <span class=Code1>COMPANY</span> fields.</p>

<p>During data entry, the prompt order forces you to enter data into the <span class=Code1>FIRSTNAME</span> field first, then the <span class=Code1>LASTNAME</span> and <span class=Code1>COMPANY</span> fields. After you enter a value in the <span class=Code1>COMPANY</span> field, check to see if the record is a duplicate.</p>

<p>In addition, you only want the validation rule to fire during data entry, not when you edit an existing record. You therefore need to incorporate a some Xbasic methods into the expression that tell you the table's mode (0 = "View", 1 = "Change" and "2" = "Enter").</p>

<p>To do this:</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create an index in the <span class=Code1>CONTACTS</span> table named <span class=Code1>CONTACT_ID</span> using the following index expression:</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>trim(FIRSTNAME) + trim(LASTNAME) + COMPANY</td> </tr> </table> <ol start=2> <li class=kadov-p-CListNumber><p class=ListNumber>Define the following expression&nbsp;as&nbsp;the validation rule for the <span class=Code1>COMPANY</span> field:</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>iif(table.current().mode_get() = 2, exist(trim(FIRSTNAME) + trim(LASTNAME) + COMPANY, "CONTACTS",&nbsp;"CONTACT_ID"), .T.)</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="Index Functions and Methods.html" title="Index Functions and Methods" class="wiki">Index Functions and Methods</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:EXIST+Function">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"dbf","group":"Record Functions"} --->
</body></html>