	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Using Grid Events</p>



<p>A grid component supports up to 8 different events. Each event will 
 run Xbasic code, which can examine page variables, grid values, and take 
 actions, including canceling the event. To write code to respond to grid 
 events open the <span class=Screen>Grid > Events</span> page of the 
 menus. </p>



<p class=Pix><img src="images/WP_Grid_Events_Page.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 561px;
							height: 351px;
							border-style: none;
							border-style: none;"
					width=561
					height=351
					border=0></p>



<p>Grid events can reference many variables. These variables include:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Args_Variables|Args)) 
 variables - contains the values of all controls in all rows</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#Args_Variables|Args.Info)) 
 variables - provides summary information about the grid</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#DataSubmitted_Variables|DataSubmitted   Variables)) - contains the values of all controls in the current row</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>((|#PageVariables_Variables|PageVariables)) 
 - allows you to read the variables passed to the page</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="Using Grid Events.html#Result_Variable" title="Using Grid Events" class="wiki">Result   Variable</a> - provides a mechanism to examine errors and terminate an 
 event</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a name=SearchDataSubmitted_Variables>SearchDataSubmitted 
 Variables</a> - contains the values from the controls in the search part 
 of the grid</p>

</li>
</ul>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Record changes 
 made through a web component do <span class=Bolded>not</span> trigger 
 Field Rule record events.</p>



<p class=A5><a name=Grid_Events>Grid Events</a></p>




<table style="x-cell-content-align: top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Event</td>
<td class="tableHeader" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variables Available</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>BeforeSearch</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>PageVariables</p>


<p class=TableLeft>SearchDataSubmitted</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>after</span> the 
 user clicks the <span class=Button>Search</span> button on the <span class=Screen>Search 
 Part</span> of the grid. It allows you to modify the data submitted by 
 the <span class=Screen>Search Part</span> before the search is actually 
 performed. You can examine the values in the search fields by referencing 
 the <span class=Code1>SearchDataSubmitted</span> variable. For example, 
 if <span class=Code1>Lastname</span> is one of the search fields, then 
 you can see what value the user entered into this field by examining <span 
 class=Code1>SearchDataSubmitted.Lastname</span>. If you make a change 
 to this variable, you can, in effect, change the value that the grid will 
 search for.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>AfterSearch</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.Info</p>


<p class=TableLeft>PageVariables</p>


<p class=TableLeft>SearchDataSubmitted</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>after</span> the 
 grid has performed a search. It allows you to examine how many records 
 (if any) were found by the search and take an action. The number of records 
 found by the search is contained in the <span class=Code1>Args.Info.TotalRecords</span> 
 variable.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>BeforeValidateExistingRecords</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.IsNewRecord</p>


<p class=TableLeft>Args.RowNumber</p>


<p class=TableLeft>DataSubmitted</p>


<p class=TableLeft>PageVariables</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>after</span> the 
 user has pressed the <span class=Button>Submit</span> button to update 
 or delete existing records, but before the grid validates the data in 
 existing records. The event is fired for each row of existing data. It 
 fires regardless of whether or not the data in the grid rows was modified 
 by the user.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><a name=BeforeValidateNewRecords>BeforeValidateNewRecords</a></td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.IsNewRecord</p>


<p class=TableLeft>Args.RowNumber</p>


<p class=TableLeft>DataSubmitted</p>


<p class=TableLeft>PageVariables</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>after</span> the 
 user has pressed the <span class=Button>Submit</span> button to insert 
 new records but before the grid validates data in new records.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CanUpdateRecord</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.IsNewRecord</p>


<p class=TableLeft>Args.RowNumber</p>


<p class=TableLeft>DataSubmitted</p>


<p class=TableLeft>PageVariables</p>


<p class=TableLeft>Result</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>before</span> the 
 grid updates an existing record. It allows you to abort the update if 
 certain conditions have not been met. Note that the event only fires if 
 the row is dirty. i.e. the user has made at least one change to a field 
 in the row.</p>


<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Use this event 
 to add or change a field value in a dirty record after the user presses 
 the <span class=Button>Submit</span> button, before it is written.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CanDeleteRecord</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.IsNewRecord</p>


<p class=TableLeft>Args.RowNumber</p>


<p class=TableLeft>DataSubmitted</p>


<p class=TableLeft>PageVariables</p>


<p class=TableLeft>Result</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>before</span> the 
 grid deletes an existing record. It allows you to abort the delete if 
 certain conditions have not been met.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>CanInsertRecord</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>Args.IsNewRecord</p>


<p class=TableLeft>Args.RowNumber</p>


<p class=TableLeft>DataSubmitted</p>


<p class=TableLeft>PageVariables</p>


<p class=TableLeft>Result</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>before</span> the 
 grid inserts a new record. It allows you to abort the insert if certain 
 conditions have not been met.</p>


<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Use this event 
 to add or change a field value in a dirty record after the user presses 
 the <span class=Button>Submit</span> button, before it is written.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>AfterUpdateRecords</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</p>


<p class=TableLeft>Args.GridDefinition</p>


<p class=TableLeft>PageVariables</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This event fires <span class=Bolded>after</span> the 
 user presses the <span class=Button>Submit</span> button to update the 
 database. The event only fires if there were no errors updating the database.</td></tr>
</table>

<p class=A5><a name=Writing_Code_to_Respond_to_an_Event>Writing Code to 
 Respond to an Event</a></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Grid 
 > Events</span> in the <span class=Screen>Grid Builder</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the event 
 you want to modify in the <span class=Control>Events</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, to erase 
 any previous edits, click <span class=Button>Undo edits > Yes</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, to restore 
 the event template, click <span class=Button>Default Function Prototype</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Place your Xbasic 
 code between the <span class=Code1>with PageVariables</span> and <span 
 class=Code1>end with</span> statements.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function BeforeValidateExistingRecords&nbsp;as&nbsp;v (DataSubmitted&nbsp;as&nbsp;P, 
 Args&nbsp;as&nbsp;p, PageVariables&nbsp;as&nbsp;p)</p>


<p class=Code>with PageVariables</p>


<p class=Code>... your code here</p>


<p class=Code>end with</p>


<p class=Code>end function</td></tr>
</table>

<ol start=6
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>To reference the 
 value of any field (in the search part or in the grid), <span class=Code1>Args</span> 
 value, alias value, or grid property ( <span class=Code1>Args.GridDefinition.PropertyName</span> 
 ), click <span class=Button>Insert</span> and select the variable you 
 want to use.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Unless a control 
 has a value, the corresponding variable will not exist. This is particularly 
 important when dealing with check boxes. Use <a href="../../Functions/EVAL_VALID Function.html" title="EVAL_VALID Function" class="wiki">EVAL_VALID(</a>) 
 to check if the variable <span class=Bolded>exists</span>, before referring 
 to it in an expression.</p>



<p class=A5><a name=Args_Variables>Args Variables</a></p>



<p>The <span class=Code1>Args</span> variables provide summary information 
 about the grid.</p>




<table style="x-cell-content-align: top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variable</td>
<td class="tableHeader" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Type</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.IsNewRecord</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>L</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Indicates whether the current record is a new record.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.RowNumber</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The current row number.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.GridDefinition</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>P</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The parent pointer for grid properties.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><a name=Args_Info>Args.Info</a>.TotalPages</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The number of pages in the grid.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.CurrentPage</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The current page of the grid that is being displayed.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.TotalRecords</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The number of records in the grid.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.RecordsPerPage</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The number of records to show per grid page.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.Database_Type</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<ul>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>".dbf" 
 = Alpha Five</p>

</li>
	
	<li class=kadov-p-CTableBullet><p class=TableBullet>"AlphaDAO" 
 = ODBC compatible databases</p>

</li>
</ul>
<p class=TableLeft>In the case of an ADO compatible database, this is the 
 name of the database type&nbsp;as&nbsp;reported by the ADO driver. So, 
 for <span class=Screen>Microsoft Access</span>, it is "MS Jet".</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.HasEmptyRows</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>L</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Whether the current grid page has any empty rows.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.Info.FirstEmptyRow</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>N</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The number of the first row in the current grid page 
 that is empty.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Args.DataSubmitted</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>P</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The <span class=Code1>Args.DataSubmitted</span> dot 
 variable contains the values of all controls in all rows.</p>


<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Not available 
 to the <span class=Code1>AfterSearch</span> event.</td></tr>
</table>

<p>The <span class=Code1>Args.DataSubmitted</span> variables allow 
 you to read the value of any <span class=Bolded>editable</span> control 
 in the grid. This means that the grid control must meet 2 requirements.</span></p>



<ul>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>It can 
 be any type <span class=Bolded>except a label</span> or <span class=Bolded>custom 
 control</span>.</span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>Its <span 
 class=Button>Column Properties > Hide Column</span> property must be 
 <span class=Bolded>set to FALSE</span>. </span></p>

</li>
</ul>

<p class=Pix><span class=Code1><img src="images/WP_Args_Variable.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											float: none;
											width: 525px;
											height: 292px;
											border-style: none;
											border-style: none;"
									width=525
									height=292
									border=0></span></p>



<p class=Note><span class=Code1><span class=Note><img src="images/icon_information.gif"
														x-maintain-ratio=TRUE
														style="border: none;
	width: 36px;
	height: 32px;
	float: none;
	border-style: none;
	border-style: none;"
														width=36
														height=32
														border=0>Note</span> 
 : Summary variables are only available for custom controls.</span></p>



<p class=A5><span class=Code1><a name=DataSubmitted_Variables>DataSubmitted 
 Variables</a></span></p>



<p><span class=Code1>The <span class=Code1>DataSubmitted</span> dot variable 
 contains the values of all controls in the current row. </span></p>



<p class=Pix><span class=Code1><img src="images/WP_DataSubmitted_Variable.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 393px;
											height: 74px;
											float: none;
											border-style: none;
											border-style: none;"
									width=393
									height=74
									border=0></span></p>



<p class=Note><span class=Code1><span class=Note><img src="images/icon_information.gif"
														x-maintain-ratio=TRUE
														style="border: none;
	width: 36px;
	height: 32px;
	float: none;
	border-style: none;
	border-style: none;"
														width=36
														height=32
														border=0>Note</span> 
 : Dialog components use the <a href="../../../Unclassified/Writing Dialog Event Scripts.html" title="Writing Dialog Event Scripts" class="wiki">CurrentForm</a> 
 alias to refer to variables.</span></p>



<p class=A5><span class=Code1><a name=PageVariables_Variables>PageVariables 
 Variables</a></span></p>



<p><span class=Code1>Any variable that is passed to the page, after the 
 "?" in the URL is available in the <span class=Code1>PageVariables</span> 
 collection. Any variable that you DIM in a segment of Xbasic code that 
 runs before the grid component is loaded, is also available in the <span 
 class=Code1>PageVariables</span> collection. You can references these 
 variables with the syntax <span class=Code1>PageVariables.VariableName</span>. 
 When inside the <span class=Code1>with PageVariables ... end with</span> 
 block, you can directly reference <span class=Code1>VariableName</span>.</span></p>



<p class=A5><span class=Code1><a name=Result_Variable>Result Variable</a></span></p>



<p><span class=Code1>The <span class=Code1>Result</span> dot variable provides 
 a mechanism to trap and terminate an event if an error occurs.</span></p>




<table style="x-cell-content-align: top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variable</td>
<td class="tableHeader" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Type</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Description</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Result.Cancel</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>L</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>This value is FALSE by default. Changing it to TRUE 
 causes the event to terminate.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Result.ErrorHTML</td>
<td class="TableCell" colspan="1" rowspan="1" style="x-cell-content-align: top;" valign="top">
<p class=TableCenter>C</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Contains the text of any HTML error.</td></tr>
</table>

<p class=A5><span class=Code1>Examples</span></p>



<p><span class=Code1>This event handler sets the <span class=Code1>Company</span> 
 field to "Default Company" if it has been left blank:</span></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function BeforeValidateExistingRecords&nbsp;as&nbsp;v (DataSubmitted&nbsp;as&nbsp;P, 
 Args&nbsp;as&nbsp;p, PageVariables&nbsp;as&nbsp;p)</p>


<p class=Code>with PageVariables <br>
&nbsp;&nbsp;&nbsp;&nbsp;if (DataSubmitted.company = "") then 
 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataSubmitted.company = 
 "Default Company" <br>
&nbsp;&nbsp;&nbsp;&nbsp;end if <br>
end with</p>


&nbsp;
<p class=Code>end function</td></tr>
</table>

<p><span class=Code1>This event handler counts the number of times a page 
 has been submitted:</span></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function AfterUpdateRecords&nbsp;as&nbsp;v (Args&nbsp;as&nbsp;P, 
 PageVariables&nbsp;as&nbsp;P)</p>


<p class=Code>with PageVariables <br>
&nbsp;&nbsp;&nbsp;&nbsp;dim session.count&nbsp;as&nbsp;n = default 0 <br>
&nbsp;&nbsp;&nbsp;&nbsp;session.count = session.count + 1 <br>
end with</p>


&nbsp;
<p class=Code>end function</td></tr>
</table>

<p><span class=Code1>The following example assumes that you have a grid 
 based on the <span class=Code1>Invoice_items</span> table of the AlphaSports 
 database. Before you let a user add a new record you want to check that:</span></p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>The user 
 entered a non-blank <span class=Code1>product_id</span>.</span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>The user 
 entered a valid <span class=Code1>product_id.</span></span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>The user 
 entered a quantity that does not exceed the <span class=Code1>qty_in_sto</span> 
 field in the <span class=Code1>product</span> table.</span></p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><span class=Code1>If all 
 of the above conditions were met then you want to deplete the <span class=Code1>qty_in_sto</span> 
 field in the <span class=Code1>product</span> table.</span></p>

</li>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function CanInsertRecord&nbsp;as&nbsp;v (DataSubmitted&nbsp;as&nbsp;P, 
 Args&nbsp;as&nbsp; p, PageVariables&nbsp;as&nbsp;p, Result&nbsp;as&nbsp;p)</p>


&nbsp;
<p class=Code>with PageVariables</p>


<p class=code>if (DataSubmitted.PRODUCT_ID = "") then <br>
&nbsp;&nbsp;&nbsp;&nbsp;Result.Cancel = .t.</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;Result.ErrorHTML = "You have 
 not specified a product id."</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;exit function</p>


<p class=code>end if</p>


<p class=code>dim t&nbsp;as&nbsp;P</p>


<p class=Code>dim rec&nbsp;as&nbsp;N</p>


<p class=Code>dim qty_on_hand&nbsp;as&nbsp;N</p>


<p class=Code>dim newQty&nbsp;as&nbsp;N</p>


<p class=Code>t = table.open("<a class="wiki"  href="PathAlias.ADB_Name" rel="">PathAlias.ADB_Name</a>\Product.dbf")</p>


<p class=code>t.order("Product_id")</p>


<p class=code>rec = t.fetch_find(datasubmitted.product_id)</p>


<p class=code>if (rec < 0) then</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;Result.Cancel = .t.</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;Result.ErrorHTML = "Invalid 
 product id: " + DataSubmitted.PRODUCT_ID</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;t.close()</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;exit function</p>


<p class=code>end if</p>


<p class=code>qty_on_hand = t.Qty_in_sto</p>


<p class=code>if (val(DataSubmitted.QUANTITY) > qty_on_hand) then</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;Result.Cancel = .t.</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;Result.ErrorHTML = "You have 
 specied a qty of " + DataSubmitted.QUANTITY + " but we only 
 have " + qty_on_hand + " in stock."</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;t.close()</p>


<p class=code>&nbsp;&nbsp;&nbsp;&nbsp;exit function</p>


<p class=code>end if</p>


<p class=code>'deplete the quantity in stock field</p>


<p class=code>t.change_begin()</p>


<p class=code>newQty = (t.Qty_in_sto - val(DataSubmitted.QUANTITY))</p>


<p class=code>t.Qty_in_sto = newQty</p>


<p class=code>t.change_end(.t.)</p>


<p class=code>t.close()</p>


<p class=code>Result.Cancel = .f.</p>


<p class=code>Result.ErrorHTML = ""</p>


<p class=Code>end with</p>


<p class=Code>end function</td></tr>
</table>

<p class=A5><span class=Code1>See Also</span></p>



<p><span class=Code1><a href="Creating a Grid Component.html" title="Creating a Grid Component" class="wiki">Creating a   Grid Component</a>, <a href="../../../Orphans/Locking Individual Records.html" title="Locking Individual Records" class="wiki">Locking   Individual Records</a></span></p>



<p class=A5><span class=Code1>Supported By</span></p>



<p><span class=Code1>Alpha Five Version 7 and Above</span></p>



<p class=A5><span class=Code1>Limitations</span></p>



<p><span class=Code1>Web publishing applications only.</span></p>



<p class=A5><span class=Code1></span></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Using+Grid+Events">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"web"} --->
</body></html>