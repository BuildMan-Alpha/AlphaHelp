<html>
<head>
<style>
html {
	font-family: Tahoma, sans-serif;
	font-size: 9pt;
}

.code {
	font-family: monospace;
}
.code-name {
	font-style: italic;
}

.code-example {
	color: #0000FF;
	font-family: monospace;
	font-size: 10pt;
	margin: 0px;
	margin-left: 3em;
	padding: 0.5em;
	white-space: pre;
}

.type {
	font-family: monospace;
}

.argument {
	font-family: monospace;
}

.method-signature {
	font-family: monospace;
}

.scroll-ul {
	border-style: solid;
	border-width: 0.1em;
	border-color: gray;
	list-style-type: none;
	max-height: 15em;
	overflow: auto;
	padding-left: 0.5em;
	padding-right: 0.5em;
	white-space: nowrap;
}

.badge {
	background-color: lightgray;
	border-radius: 5px;
	display: inline-block;
	font-size: smaller;
	font-weight: normal;
	font-variant: small-caps;
	padding-bottom: 0.2em;
	padding-left: 0.3em;
	padding-right: 0.3em;
	position: relative;
	text-rendering: optimizeLegibility;
	top: -0.1em;
	vertical-align: middle;
}

.badge-rw {
	background-color: lightgreen;
}

.note {
	background-color: #fff2cc;
	margin: 0px;
	padding: 10px;
}

body {
	margin: 0px;
	overflow: hidden;
}

.helpserver_toc {
	display: inline-block;
	border-right-color: gray;
	border-right-style: solid;
	border-right-width: 0.1em;
	height: 100%;
	overflow: auto;
	position: absolute;
	white-space: nowrap;
	width: 22em;
	display: none
}

.toc ul {
	list-style-type: none;
	padding-left: 1.3em;
}

.toc ul ul {
	padding-left: 1.3em;
}

.content {
	display: inline-block;
	height: 100%;
	overflow-y: auto;
	position: absolute;
	padding-left: 1em;
	padding-right: 1em;
	margin-left: 1em;
}

p > .first-word {
	font-weight: bold;
}

p + p.code-example {
	margin-top: 1em;
}

h4 {
	margin-bottom: 0;
}

h4 + p {
	margin-top: 0.2em;
}

table {
  border-style: solid;
  border-width: 0.1em;
  border-spacing: 0px;
  font-family: inherit;
  font-size: inherit;
}

table tr td {
  padding-left: 0.5em;
  padding-right: 0.5em;
}

.code-example table {
	border-style: none;
}

.code-example table thead {
	background-color: lightgray;
}

.code-example table tr td {
	width: 25em;
	padding: 0.35em;
	text-align: left;
}

.twisty {
	width: 0;
	height: 0;
	border-bottom: 0.67em solid rgb(94, 94, 94);
	border-left: 0.67em solid transparent;
	position: absolute;
	transition: 200ms;
	transform: translate(-1.0em, 0.2em) rotate(-45deg);
}

li input[type="checkbox"] {
	display: none;
}

li input + label + a + ul {
	display: none;
}

li input:checked + label + a + ul {
	display: block;
}

li input:checked + label {
	transform: translate(-1.0em, 0.2em) rotate(0deg);
}

.copyright {
	border-top-color: #b7b7b7;
	border-top-style: solid;
	border-top-width: 0.1em;
	color: #b7b7b7;
	margin-top: 2em;
	text-align: center;
}

.last-updated {
	display: inline-block;
	position: absolute;
	margin-top: 1em;
	right: 1em;
}

@media print {
	.helpserver_toc {
        display: none !important;
    }

	h1 {
		page-break-before: always;
	}

	h4 {
		page-break-after: avoid;
	}

	body {
		overflow: initial;
	}

	.content {
		display: block;
		height: initial;
		overflow-y: initial;
		position: relative;
		margin: 0
	}

	.scroll-ul {
		border-style: initial;
		max-height: initial;
		max-width: initial;
		white-space: initial;
	}
}

</style>
</head>
<body>
<div>
	<div class="helpserver_toc" >
		<ul>
			<li>
				<a href="#Preface">Preface</a>
			</li>
			<li>
				<!-- input type="checkbox" id="context-twisty"></input -->
				<!-- label for="context-twisty" class="twisty"></label -->
				<a href="#Context">Context</a>
				<ul>
					<li>
						<!-- input type="checkbox" id="context-properties-twisty"></input -->
						<!-- label for="context-properties-twisty" class="twisty"></label -->
						<a href="#Context-Properties">Properties</a>
						<ul>
							<li><a href="#Context-GridCache">GridCache</a></li>
							<li><a href="#Context-HostContext">HostContext</a></li>
							<li><a href="#Context-HostContextName">HostContextName</a></li>
							<li><a href="#Context-Request">Request</a></li>
							<li><a href="#Context-Response">Response</a></li>
							<li><a href="#Context-WebSecurityContext">Security</a></li>
							<li><a href="#Context-WebSessionContext">Session</a></li>
						</ul>
					</li>
					<li>
						<a href="#Context-Methods">Methods</a>
					</li>
				</ul>
			</li>

			<li>
				<!-- input type="checkbox" id="request-twisty"></input -->
				<!-- label for="request-twisty" class="twisty"></label -->
				<a href="#Request">Request</a>
				<ul>
					<li>
						<!-- input type="checkbox" id="request-properties-twisty"></input -->
						<!-- label for="request-properties-twisty" class="twisty"></label -->
						<a href="#Request-Properties">Properties</a>
						<ul>
							<li><a href="#Request-ApplicationRoot">ApplicationRoot</a></li>
							<li><a href="#Request-ApplicationRootUrl">ApplicationRootUrl</a></li>
							<li><a href="#Request-A5wIncludePath">A5wIncludePath</a></li>
							<li><a href="#Request-ContentLength">ContentLength</a></li>
							<li><a href="#Request-ContentType">ContentType</a></li>
							<li><a href="#Request-Cookies">Cookies</a></li>
							<li><a href="#Request-Form">Form</a></li>
							<li><a href="#Request-Headers">Headers</a></li>
							<li><a href="#Request-Host">Host</a></li>
							<li><a href="#Request-HttpMethod">HttpMethod</a></li>
							<li><a href="#Request-IsLocal">IsLocal</a></li>
							<li><a href="#Request-IsWorkingPreview">IsWorkingPreview</a></li>
							<li><a href="#Request-Params">Params</a></li>
							<li><a href="#Request-QueryString">QueryString</a></li>
							<li><a href="#Request-RawUrl">RawUrl</a></li>
							<li><a href="#Request-Referer">Referer</a></li>
							<li><a href="#Request-Remote_Addr">Remote_Addr</a></li>
							<li><a href="#Request-Request_Uri">Request_Uri</a></li>
							<li><a href="#Request-ScriptName">ScriptName</a></li>
							<li><a href="#Request-Script_Name">Script_Name</a></li>
							<li><a href="#Request-ServerVariables">ServerVariables</a></li>
							<li><a href="#Request-TemporaryDirectory">TemporaryDirectory</a></li>
							<li><a href="#Request-UserAgent">UserAgent</a></li>
							<li><a href="#Request-UserHostAddress">UserHostAddress</a></li>
							<li><a href="#Request-Variables">Variables</a></li>
						</ul>
					</li>
					<li>
						<!-- input type="checkbox" id="request-methods-twisty"></input -->
						<!-- label for="request-methods-twisty" class="twisty"></label -->
						<a href="#Request-Methods">Methods</a>
						<ul>
							<li><a href="#Request-GetRequestTempFileName">GetRequestTempFileName</a></li>
						</ul>
					</li>
				</ul>
			</li>

			<li>
				<!-- input type="checkbox" id="response-twisty"></input -->
				<!-- label for="response-twisty" class="twisty"></label -->
				<a href="#Response">Response</a>
				<ul>
					<li>
						<!-- input type="checkbox" id="response-properties-twisty"></input -->
						<!-- label for="response-properties-twisty" class="twisty"></label -->
						<a href="#Response-Properties">Properties</a>
						<ul>
							<li><a href="#Response-Cache">Cache</a></li>
							<li><a href="#Response-ContentEncoding">ContentEncoding</a></li>
							<li><a href="#Response-ContentType">ContentType</a></li>
							<li><a href="#Response-Cookies">Cookies</a></li>
							<li><a href="#Response-Headers">Headers</a></li>
							<li><a href="#Response-OutputStream">OutputStream</a></li>
							<li><a href="#Response-RedirectLocation">RedirectLocation</a></li>
							<li><a href="#Response-StatusCode">StatusCode</a></li>
							<li><a href="#Response-StatusDescription">StatusDescription</a></li>
						</ul>
					</li>
					<li>
						<!-- input type="checkbox" id="response-methods-twisty"></input -->
						<!-- label for="response-methods-twisty" class="twisty"></label -->
						<a href="#Response-Methods">Methods</a>
						<ul>
							<li><a href="#Response-AppendCookie">AppendCookie</a></li>
							<li><a href="#Response-AppendHeader">AppendHeader</a></li>
							<li><a href="#Response-BinaryWrite">BinaryWrite</a></li>
							<li><a href="#Response-Clear">Clear</a></li>
							<li><a href="#Response-ClearContent">ClearContent</a></li>
							<li><a href="#Response-ClearHeaders">ClearHeaders</a></li>
							<li><a href="#Response-End">End</a></li>
							<li><a href="#Response-NoCache">NoCache</a></li>
							<li><a href="#Response-Redirect">Redirect</a></li>
							<li><a href="#Response-RedirectPermanent">RedirectPermanent</a></li>
							<li><a href="#Response-SendFile">SendFile</a></li>
							<li><a href="#Response-Write">Write</a></li>
						</ul>
					</li>
				</ul>
			</li>

			<li>
				<!-- input type="checkbox" id="security-twisty"></input -->
				<!-- label for="security-twisty" class="twisty"></label -->
				<a href="#Security">Security</a>
				<ul>
					<li>
						<!-- input type="checkbox" id="security-properties-twisty"></input -->
						<!-- label for="security-properties-twisty" class="twisty"></label -->
						<a href="#Security-Properties">Properties</a>
						<ul>
							<li><a href="#Security-CallResult">CallResult</a></li>
							<li><a href="#Security-CurrentUser">CurrentUser</a></li>
							<li><a href="#Security-IsActive">IsActive</a></li>
							<li><a href="#Security-PasswordResetAllowed">PasswordResetAllowed</a></li>
							<li><a href="#Security-PasswordRetrievalAllowed">PasswordRetrievalAllowed</a></li>
							<li><a href="#Security-RequiresQuestionAndAnswer">RequiresQuestionAndAnswer</a></li>
							<li><a href="#Security-RolesAreEnabled">RolesAreEnabled</a></li>
							<li><a href="#Security-SecurityQuestionList">SecurityQuestionList</a></li>
						</ul>
					</li>
					<li>
						<!-- input type="checkbox" id="security-methods-twisty"></input -->
						<!-- label for="security-methods-twisty" class="twisty"></label -->
						<a href="#Security-Methods">Methods</a>
						<ul>
							<li><a href="#Security-AddUserToRole">AddUserToRole</a></li>
							<li><a href="#Security-AddUserToRoles">AddUserToRoles</a></li>
							<li><a href="#Security-ChangePassword">ChangePassword</a></li>
							<li><a href="#Security-ChangePasswordQA">ChangePasswordQuestionAndAnswer</a></li>
							<li><a href="#Security-CreateRole">CreateRole</a></li>
							<li><a href="#Security-CreateUser">CreateUser</a></li>
							<li><a href="#Security-DeleteUser">DeleteUser</a></li>
							<li><a href="#Security-DeleteRole">DeleteRole</a></li>
							<li><a href="#Security-GetEmail">GetEmail</a></li>
							<li><a href="#Security-GetPasswordQuestion">GetPasswordQuestion</a></li>
							<li><a href="#Security-GetRoles">GetRoles</a></li>
							<li><a href="#Security-GetRoleUsers">GetRoleUsers</a></li>
							<li><a href="#Security-GetUserRoles">GetUserRoles</a></li>
							<li><a href="#Security-GetUser">GetUser</a></li>
							<li><a href="#Security-GetUserProviderKey">GetUserProviderKey</a></li>
							<li><a href="#Security-GetUsers">GetUsers</a></li>
							<li><a href="#Security-IsCurrentUserInRole">IsCurrentUserInRole</a></li>
							<li><a href="#Security-IsCurrentUserInRoles">IsCurrentUserInRoles</a></li>
							<li><a href="#Security-IsUserInRole">IsUserInRole</a></li>
							<li><a href="#Security-IsUserInRoles">IsUserInRoles</a></li>
							<li><a href="#Security-LockOutUser">LockOutUser</a></li>
							<li><a href="#Security-Login">Login</a></li>
							<li><a href="#Security-Logout">Logout</a></li>
							<li><a href="#Security-PasswordHasExpired">PasswordHasExpired</a></li>
							<li><a href="#Security-RemoveUserFromRole">RemoveUserFromRole</a></li>
							<li><a href="#Security-ResetPassword">ResetPassword</a></li>
							<li><a href="#Security-RoleExists">RoleExists</a></li>
							<li><a href="#Security-TestPassword">TestPassword</a></li>
							<li><a href="#Security-UnlockUser">UnlockUser</a></li>
							<li><a href="#Security-UserExists">UserExists</a></li>
							<li><a href="#Security-UserIsLockedOut">UserIsLockedOut</a></li>
							<li><a href="#Security-ValidateUser">ValidateUser</a></li>
						</ul>
					</li>
				</ul>
			</li>

			<li>
				<!-- input type="checkbox" id="session-twisty"></input -->
				<!-- label for="session-twisty" class="twisty"></label -->
				<a href="#Session">Session</a>
				<ul>
					<li>
						<!-- input type="checkbox" id="session-properties-twisty"></input -->
						<!-- label for="session-properties-twisty" class="twisty"></label -->
						<a href="#Session-Properties">Properties</a>
						<ul>
							<li><a href="#Session-CallResult">CallResult</a></li>
							<li><a href="#Session-Count">Count</a></li>
							<li><a href="#Session-IsCookieless">IsCookieless</a></li>
							<li><a href="#Session-IsNewSession">IsNewSession</a></li>
							<li><a href="#Session-IsReadOnly">IsReadOnly</a></li>
							<li><a href="#Session-IsSynchronized">IsSynchronized</a></li>
							<li><a href="#Session-Keys">Keys</a></li>
							<li><a href="#Session-Mode">Mode</a></li>
							<li><a href="#Session-SessionId">SessionId</a></li>
							<li><a href="#Session-Timeout">Timeout</a></li>
							<li><a href="#Session-Timestamp">Timestamp</a></li>
							<li><a href="#Session-UniqueDataKey">UniqueDataKey</a></li>
							<li><a href="#Session-Variables">Variables</a></li>
						</ul>
					</li>
					<li>
						<!-- input type="checkbox" id="session-methods-twisty"></input -->
						<!-- label for="session-methods-twisty" class="twisty"></label -->
						<a href="#Session-Methods">Methods</a>
						<ul>
							<li><a href="#Session-Abandon">Abandon</a></li>
							<li><a href="#Session-Add">Add</a></li>
							<li><a href="#Session-Clear">Clear</a></li>
							<li><a href="#Session-DeleteSessionFile">DeleteSessionFile</a></li>
							<li><a href="#Session-FormatFileDataURL">FormatFileDataURL</a></li>
							<li><a href="#Session-GetData">GetData</a></li>
							<li><a href="#Session-GetDataFromFile">GetDataFromFile</a></li>
							<li><a href="#Session-GetSQLCredentials">GetSQLCredentials</a></li>
							<li><a href="#Session-Remove">Remove</a></li>
							<li><a href="#Session-RemoveAll">RemoveAll</a></li>
							<li><a href="#Session-RemoveAt">RemoveAt</a></li>
							<li><a href="#Session-SaveData">SaveData</a></li>
							<li><a href="#Session-SaveDataAsFile">SaveDataAsFile</a></li>
							<li><a href="#Session-SaveFileToSessionFile">SaveFileToSessionFile</a></li>
							<li><a href="#Session-SaveSessionFileToFile">SaveSessionFileToFile</a></li>
							<li><a href="#Session-SetSQLCredentials">SetSQLCredentials</a></li>
						</ul>
					</li>
				</ul>
			</li>

		</ul>

	</div>

<div class="content">
<div class="last-updated">Last updated: <script>var lastMod = new Date(document.lastModified); document.write(lastMod.toDateString() + " " + lastMod.toLocaleTimeString());</script></div>
<a name="Preface">
<h1>Preface</h1>
</a>
<p>
The <span class="code">Context</span> object is the interface to the web application server context. It contains the built in Request,
 Response, Security, and Session objects that are available when handling a web request. This object supersedes other ways to access
 web application server context
 (see <a href="http://wiki.alphasoftware.com/Server+Programming+Changes+V11">Server Programming Changes for Version 11</a>)
 and was made to so that the same object methods and properties will work on the stand-alone server and IIS. Web applications that
 were built before the <span class="code">Context</span> object was available or using now deprecated functions or objects should be
 updated to use the <span class="code">Context</span> object so that the web application will transition to running under IIS or
 any other web server technology available in the future.
</p>
<p>
Here are a few examples of using the <span class="code">Context</span> object compare with the functions you would use before
the <span class="code">Context</span> object was available.
</p>
<p class="code-example">
<table>
<thead>
<th>Pre-Context object</th><th>Context object</th>
</thead>
<tr>
<td>a5ws_GetCurrentUser()</td><td>Context.Security.CurrentUser</td>
</tr>
<tr>
<td>Application.Path()</td><td>Context.Request.ApplicationRoot</td>
</tr>
<tr>
<td>a5ws_securityactive()</td><td>Context.Security.IsActive</td>
</tr>
</table>
</p>
<hr>

<a name="Context">
<h1>Context</h1>
</a>
<p>Type: <span class="type">A5AS::A5INETServerIntegration::IA5ServerContext</span></p>
<p>The <span class="code">Context</span> object is automatically available to <span class="code-name">Xbasic</span> code that runs on the
stand-alone application server and the IIS application server. It has all properties needed to handle an HTTP request and response.
Using the <span class="code">Context</span> object is the preferred way to get information about a request, response, or other
context of the server since <a href="http://wiki.alphasoftware.com/Server+Programming+Changes+V11">other objects have been
deprecated since version 11</a>. Many of the deprecated objects will not work under IIS.</p>

<a name="Context-Properties">
<h2>Properties</h2>
</a>

<a name="Context-GridCache">
<h3>GridCache <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">Alpha5DotNet.DataCache<Byte[]></span></p>
<p></p>

<a name="Context-HostContext">
<h3>HostContext <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">P</span></p>
<p>The type of <span class="code">HostContext</span> depends on the platform that the code is running under. Under IIS
<span class="code">HostContext</span> is of type <span class="code"><a href="https://msdn.microsoft.com/en-us/library/system.web.httpcontext(v=vs.100).aspx">System.Web.HttpContext</a></span> and
all properties and methods available on that .NET object are available in <span class="code-type">Xbasic</span>. Under the
stand-alone application server <span class="code">HostContext</span> is of type <span class="code">A5AS::A5INETServerIntegration::A5WServerContext</span>.

<a name="Context-HostContextName">
<h3>HostContextName <span class="badge" title="read-only">r/o</span></h3>

<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.HostContextName</span> contains the name of the platform on which the code is running.
This will be <span class="code">"IIS"</span> when running on IIS and will be <span class="code">"Alpha Five Web Server"</span>
when running on the stand-alone server.</p>

<a name="Context-Request">
<h3>Request <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="#Request">A5AS::A5INETServerIntegration::IA5Request</a></span></p>
<p><span class="code">Context.Request</span> contains methods and properties for the current HTTP request.</p>

<a name="Context-Response">
<h3>Response <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="#Response">A5AS::A5INETServerIntegration::IA5Response</a></span></p>
<p><span class="code">Context.Response</span> contains methods and properties for the current HTTP response.</p>

<a name="Context-WebSecurityContext">
<h3>Security <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="#Security">A5AS::A5INETServerIntegration::IA5WebSecurityContext</a></span></p>
<p><span class="code">Context.Security</span> contains the methods and properties available for working with security.</p>

<a name="Context-WebSessionContext">
<h3>Session <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="#Session">A5AS::A5INETServerIntegration::IA5WebSessionContext</a></span></p>
<p><span class="code">Context.Session</span> contains the methods and properties available for working with the current session.</p>

<a name="Context-Methods">
<h2>Methods</h2>
</a>
<p><span class="code">Context</span> has no methods.</p>

<!-- ------------------------------------------------------- -->
<a name="Request">
<h1>Request</h1>
</a>
<p>The <span class="code">Request</span> object contains properties and methods available for working with the current HTTP request.</p>

<a name="Request-Properties">
<h2>Properties</h2>
</a>
<a name="Request-ApplicationRoot">
<h3>ApplicationRoot <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.ApplicationRoot</span> is the absolute physical path to the application on the server.</p>

<a name="Request-ApplicationRootUrl">
<h3>ApplicationRootUrl <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.ApplicationRootUrl</span> is the root url to the application. This is guaranteed to end
with a forward slash ("/").</p>

<a name="Request-A5wIncludePath">
<h3>A5wIncludePath <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.A5wIncludePath</span> is the absolute physical path to the location of the application's
a5w files.</p>

<a name="Request-ContentLength">
<h3>ContentLength <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">N</span></p>
<p><span class="code">Context.Request.ContentLength</span> is the length of the current request's content.</p>

<a name="Request-ContentType">
<h3>ContentType <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.ContentType</span> is the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">MIME type</a> of the current request's content such as text/html or application/json.</p>

<a name="Request-Cookies">
<h3>Cookies <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.Web.HttpCookieCollection(v=vs.100).aspx">System::Web::HttpCookieCollection</a></span></p>
<p><span class="code">Context.Request.Cookies</span> is the collection of the current request's cookies.</p>

<a name="Request-Form">
<h3>Form <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Request.Form</span> is the collection of the current request's form variables.
The collection will have 0 entries if the page making the request does not have any forms on it.</p>

<a name="Request-Headers">
<h3>Headers <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Request.Headers</span> is the collection of the current request's HTTP headers.</p>

<a name="Request-Host">
<h3>Host <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.Host</span> is the value of the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23">HTTP Host header.</a></p>

<a name="Request-HttpMethod">
<h3>HttpMethod <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.HttpMethod</span> is the current request's <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">HTTP method</a> such as GET, POST, or HEAD.</p>

<a name="Request-IsLocal">
<h3>IsLocal <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Request.IsLocal</span> indicates whether the current request was made on the same machine as the server.
For instance, the request made by a browser was "http://localhost/index.a5w". This can be useful to add what may be sensitive
diagnostic/debug information to a response knowing that it will only be added when the request was made on the same machine as
the server.</p>

<a name="Request-IsWorkingPreview">
<h3>IsWorkingPreview <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Request.IsWorkingPreview</span> will be <span class="code">.T.</span> if the request is being processed in working preview.
Otherwise, it is <span class="code">.F.</span></p>

<a name="Request-Params">
<h3>Params <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Request.Params</span> is a single collection that includes all the items in the following collections in this order: <a href="#Request-QueryString">QueryString</a>,
<a href="#Request-Form">Form</a>, <a href="#Request-Cookies">Cookies</a>, and <a href="#Request-ServerVariables">ServerVariables</a>.
</p>

<a name="Request-QueryString">
<h3>QueryString <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Request.QueryString</span> is a collection of the current request's query string's parsed name/value pairs.
To get an unparsed query string use the <span class="code">ToString()</span> method: <span class="code">Context.Request.QueryString.ToString()</span>.
</p>
<p>To get the "firstName" query string value from this request, "http://www.acme.com/search/?firstName=John&lastName=Doe" use the following
<span class="code-name">Xbasic</span>:<br/>
<br/>
<span class="code">Context.Request.QueryString.Get("firstName")</span>
</p>

<a name="Request-RawUrl">
<h3>RawUrl <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.RawUrl</span> is the current request's URL with the protocol and domain prefix removed. The RawUrl for
a request made with this URL "http://www.acme.com/search/?firstName=John&lastName=Doe" would be "/search/?firstName=John&lastName=Doe"</p>

<a name="Request-Referer">
<h3>Referer <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.Referer</span> is the value of the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.36">HTTP Referer header.</a></p>

<a name="Request-Remote_Addr">
<h3>Remote_Addr <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.Remote_Addr</span> is an alias of <a href="#Request-UserHostAddress">UserHostAddress</a> and is provided for
compatibility with Alpha Anywhere web applications that were written to run on the stand-alone server.</p>

<a name="Request-Request_Uri">
<h3>Request_Uri <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.Request_Uri</span> is an alias of <a href="#Request-RawUrl">RawUrl</a> and is provided for
compatibility with Alpha Anywhere web applications that were written to run on the stand-alone server.</p>

<a name="Request-ScriptName">
<h3>ScriptName <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.ScriptName</span> is an alias for the current request's <span class="code">PATH_INFO</span> server variable.</p>

<a name="Request-Script_Name">
<h3>Script_Name <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.Script_Name</span> is an alias for <a href="#Request-ScriptName"><span class="code">ScriptName</span>.</p>

</a>
<a name="Request-ServerVariables">
<h3>ServerVariables <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Request.ServerVariables</span> is a collection of the web server variables. The follow is a list of
variables that are supported on both IIS and the stand-alone application server. When running under IIS there may be other server
variables available. See the <a href="https://msdn.microsoft.com/en-us/library/ms524602.aspx">Microsoft documentation</a> for more
details.</p>
<ul class="scroll-ul">
	<li>ALL_HTTP</li>
	<li>ALL_RAW</li>
	<li>APPL_MD_PATH</li>
	<li>APPL_PHYSICAL_PATH</li>
	<li>AUTH_PASSWORD</li>
	<li>AUTH_TYPE</li>
	<li>AUTH_USER</li>
	<li>CERT_COOKIE</li>
	<li>CERT_FLAGS</li>
	<li>CERT_ISSUER</li>
	<li>CERT_KEYSIZE</li>
	<li>CERT_SECRETKEYSIZE</li>
	<li>CERT_SERIALNUMBER</li>
	<li>CERT_SERVER_ISSUER</li>
	<li>CERT_SERVER_SUBJECT</li>
	<li>CONTENT_LENGTH</li>
	<li>CONTENT_TYPE</li>
	<li>GATEWAY_INTERFACE</li>
	<li>HEADER_<HeaderName> - HeaderName interpreted as-is. For example, if you specify HEADER_MY-HEADER, the server searches for a request header named MY-HEADER.</li>
	<li>HTTP_<HeaderName> - HeaderName with underscores interpreted as dashes. For example, if you specify HTTP_MY_HEADER, the server searches for a request header named MY-HEADER.</li>
	<li>HTTP_ACCEPT</li>
	<li>HTTP_ACCEPT_ENCODING</li>
	<li>HTTP_ACCEPT_LANGUAGE</li>
	<li>HTTP_CONNECTION</li>
	<li>HTTP_COOKIE</li>
	<li>HTTP_HOST</li>
	<li>HTTP_METHOD</li>
	<li>HTTP_REFERER</li>
	<li>HTTP_URL</li>
	<li>HTTP_USER_AGENT</li>
	<li>HTTP_VERSION</li>
	<li>HTTPS</li>
	<li>HTTPS_KEYSIZE</li>
	<li>HTTPS_SECRETKEYSIZE</li>
	<li>HTTPS_SERVER_ISSUER</li>
	<li>HTTPS_SERVER_SUBJECT</li>
	<li>LOGON_USER</li>
	<li>PATH_INFO</li>
	<li>QUERY_STRING</li>
	<li>REMOTE_ADDR</li>
	<li>REMOTE_HOST</li>
	<li>REMOTE_USER</li>
	<li>REQUEST_METHOD</li>
	<li>SCRIPT_NAME</li>
	<li>SCRIPT_TRANSLATED</li>
	<li>SERVER_NAME</li>
	<li>SERVER_PORT</li>
	<li>SERVER_PORT_SECURE</li>
	<li>SERVER_PROTOCOL</li>
	<li>SERVER_SOFTWARE</li>
	<li>UNENCODED_URL</li>
	<li>URL</li>
</ul>
<p>The following code is an example of how to retrieve a server variable:</p>
<p class="code-example">Context.Request.ServerVariables.Get("HTTP_REFERER")
</p>

<a name="Request-TemporaryDirectory">
<h3>TemporaryDirectory <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.TemporaryDirectory</span> is the path to a temporary directory that is a unique for the request and is valid
for the duration of a request. When the request is finished the directory is deleted. The directory path will always end with a back-slash ("\").</p>

<a name="Request-UserAgent">
<h3>UserAgent <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.UserAgent</span> is the UserAgent string that is sent by the browser.</p>

<a name="Request-UserHostAddress">
<h3>UserHostAddress <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Request.UserHostAddress</span> is the IP host address of the remote client.</p>

<a name="Request-Variables">
<h3>Variables <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">P</span></p>
<p><span class="code">Context.Request.Variables</span></p>

<a name="Request-Methods">
<h2>Methods</h2>
</a>

<a name="Request-GetRequestTempFileName">
<h3>GetRequestTempFileName</h3>
</a>
<p><span class="method-signature">GetRequestTempFileName as C (FileExtension as C = ".tmp")</span></p>
<p>Return type: <span class="type">C</span><br/>
The name of a temporary file.</p>
<h4>Arguments</h4>
<p><span class="argument">FileExtension as C</span> This is optional and defaults ".tmp".</p>
<p><span class="argument">Context.Request.GetRequestTempFileName()</span> creates temporary file with the specified extension. The file is valid for the
duration of the request. When the request is finished the file is deleted.</p>

<!-- --------------------------------------------------------------- -->
<a name="Response">
<h1>Response</h1>
</a>

<a name="Response-Properties">
<h2>Properties</h2>
</a>

<a name="Response-Cache">
<h3>Cache <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.Web.HttpCachePolicy(v=vs.100).aspx">System::Web::HttpCachePolicy</a></span></p>
<p><span class="code">Context.Response.Cache</span> is used to control the cache HTTP headers. See the Microsoft documentation for
HttpCachePolicy for more details.</p>

<a name="Response-ContentEncoding">
<h3>ContentEncoding <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.Text.Encoding(v=vs.100).aspx">System::Text::Encoding</a></span></p>
<p><span class="code">Context.Response.ContentEncoding</span> is used to get or set the content encoding of the response.</p>

<a name="Response-ContentType">
<h3>ContentType <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Response.ContentType</span> is used to get or set the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">MIME type</a>
 of the response content. It defaults to "text/html".</p>

<a name="Response-Cookies">
<h3>Cookies <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.Web.HttpCookieCollection(v=vs.100).aspx">System::Web::HttpCookieCollection</a></span></p>
<p><span class="code">Context.Response.Cookies</span> is the collection of the current response's cookies.</p>

<a name="Response-Headers">
<h3>Headers <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.100).aspx">System::Collections::Specialized::NameValueCollection</a></span></p>
<p><span class="code">Context.Response.Headers</span> is the collection of the current response's HTTP headers.</p>

<a name="Response-OutputStream">
<h3>OutputStream <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.IO.Stream(v=vs.100).aspx">System::IO::Stream</a></span></p>
<p><span class="code">Context.Response.OutputStream</span> is the raw contents of the HTTP response content.</p>

<a name="Response-RedirectLocation">
<h3>RedirectLocation <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Response.RedirectLocation</span> is used to get or set the absolute URI that will be sent in the
Location header of the response.</p>

<a name="Response-StatusCode">
<h3>StatusCode <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">N</span></p>
<p><span class="code">Context.Response.StatusCode</span> is used to get or set <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">HTTP status code</a> of the response.</p>

<a name="Response-StatusDescription">
<h3>StatusDescription <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Response.StatusDescription</span> is used to get or set the description for the <a href="#Response-StatusCode">StatusCode</a> of the response.</p>

<a name="Response-Methods">
<h2>Methods</h2>
</a>

<a name="Response-AppendCookie">
<h3>AppendCookie</h3>
</a>
<p><span class="method-signature">AppendCookie as V (Cookie as System::Web::HttpCookie)</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p><span class="argument">Cookie as System::Web::HttpCookie</span> The cookie to add.</p>
<p><span class="argument">Context.Response.AppendCookie(Cookie)</span> adds a cookie to the response's cookie collection.</p>
<p class="note"><span class="first-word">Note</span>: This API supports the .NET Framework infrastructure and
is not intended to be used directly from your code.</p>

<a name="Response-AppendHeader">
<h3>AppendHeader</h3>
</a>
<p><span class="method-signature">AppendHeader as V (Name as C, Value as C)</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p><span class="argument">Name as C</span> The name of the HTTP header item.<br/>
<span class="argument">Value as C</span> The value of the HTTP header item.</p>
<p><span class="argument">Context.Response.AppendHeader(Name, Value)</span> adds an HTTP header to the current response.</p>

<a name="Response-BinaryWrite">
<h3>BinaryWrite</h3>
</a>
<p><span class="method-signature">BinaryWrite as V (BodyBlob as B)</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">BodyBlob as B</span>.
</p>
<p><span class="code">Context.Response.BinaryWrite()</span> Write bytes to the response's output stream.</p>

<a name="Response-Clear">
<h3>Clear</h3>
</a>
<p><span class="method-signature">Clear as V ()</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Response.Clear()</span> removes all content from the OutputStream of the current response. Response header output is not affected.</p>

<a name="Response-ClearContent">
<h3>ClearContent</h3>
</a>
<p><span class="method-signature">ClearContent as V ()</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Response.ClearContent()</span> is an alias for <a href="#Response-Clear">Clear</a>.</p>

<a name="Response-ClearHeaders">
<h3>ClearHeaders</h3>
</a>
<p><span class="method-signature">ClearHeaders as V ()</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Response.ClearHeaders()</span> removes all HTTP headers from the current response.</p>

<a name="Response-End">
<h3>End</h3>
</a>
<p><span class="method-signature">End as V ()</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Response.End()</span> causes the current response to immediately complete with no further processing.</p>

<a name="Response-NoCache">
<h3>NoCache</h3>
</a>
<p><span class="method-signature">NoCache as V ()</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Response.NoCache()</span> configures the current response so that the browser receiving the response will not cache it.
It does this by setting the following three HTTP headers:<br/><br/>
<table>
	<tr style="background-color: #F0F0F0; text-align: center;">
		<td>Header Name</td><td>Header Value</td>
	</tr>
	<tr>
		<td>Cache-Control</td><td>"no-store, no-cache, max-age=0, must-revalidate" (for HTTP/1.1)</td>
	</tr>
	<tr>
		<td>Expires</td><td>"Mon, 09 Jun 2003 09:25:00 GMT" (for HTTP/1.0)</td>
	</tr>
	<tr>
		<td>Pragma</td><td>"no-cache"</td>
	</tr>
</table>
</p>

<a name="Response-Redirect">
<h3>Redirect</h3>
</a>
<p><span class="method-signature">Redirect as V (Url as C, EndResponse as L = .T.)</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p><span class="argument">Url as C</span> The URL to which the client should be redirected.<br/>
<span class="argument">EndResponse as L</span> Optional. Flag for whether page execution should terminate immediately or not. This defaults to .T.</p>
<p><span class="argument">Context.Response.Redirect()</span> Redirect the client by returning a 302 Redirect HTTP status code and optionally
terminate processing the current page.</p>

<a name="Response-RedirectPermanent">
<h3>RedirectPermanent</h3>
</a>
<p><span class="method-signature">RedirectPermanent as V (Url as C, EndResponse as L = .T.)</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p><span class="argument">Url as C</span> The URL to which the client should be redirected.<br/>
<span class="argument">EndResponse as L</span> Optional. Flag for whether page execution should terminate immediately or not. This defaults to .T.</p>
<p><span class="argument">Context.Response.RedirectPermanent()</span> Redirect the client by returning a 301 Redirect permanent HTTP status code and optionally
terminate processing the current page.</p>

<a name="Response-SendFile">
<h3>SendFile</h3>
</a>
<p><span class="method-signature">SendFile as V (Filename as C, PromptToSave as L = .F., OutputFilename as C = "__not__specified__")</span></p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Filename as C</span> The name of the file to written to the response's output.<br/>
<span class="argument">PromptToSave as L</span> Optional. Add the <span class="code">Content-Disposition</span> header to the client will prompt for save. This defaults
to .F. when an OutputFilename is not specified. It defaults to .T. when an OutputFilename is specified.<br/>
<span class="argument">OutputFilename as C</span> Optional. The name the client should use when saving the file.</p>
<p><span class="code">Context.Response.SaveFile()</span> Write the content of a file directly to the response's output stream.</p>

<a name="Response-Write">
<h3>Write</h3>
</a>
<p>
<span class="method-signature">Write as V (BodyData as C)</span><br/>
<span class="method-signature">Write as V (BodyData as B)</span><br/>
<span class="method-signature">Write as V (BodyData as N)</span><br/>
<span class="method-signature">Write as V (BodyData as L)</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">BodyData as C</span><br/>
<span class="argument">BodyData as B</span><br/>
<span class="argument">BodyData as N</span><br/>
<span class="argument">BodyData as L</span><br/>
</p>
<p><span class="code">Context.Response.Write()</span> Write a character, binary, number or logical to the response's output stream.
Character and Binary types are written directly to the response's output stream. Number and logical type values are converted
to character before being written to the output stream.</p>


<!-- ------------------------------------------------------- -->
<a name="Security">
<h1>Security</h1>
</a>
<p>The <span class="code">Security</span> object contains properties and methods available for working with the users and roles
if a web application uses security. The term "Role" and "Group" are synonymous in this API. The UI in Alpha Anywhere Developer
Edition generally uses the term "Group" while the security property and methods use the term "Roles".</p>
<p class="note">
<span class="first-word">Note</span>: The <span class="code">Security</span> object has a
<span class="code"><a href="http://wiki.alphasoftware.com/CallResult">CallResult</a></span> property.
Use this property to see if a method call or property get succeeds before using a method's returned value or property's value.
See the following examples:
</p>
<p class="code-example">dim errorMsg as C = ""
dim created as L = .F.
created = Context.Security.CreateUser("John-Doe@acme.com", "secret")
if Context.Security.CallResult.Success then
	if .not. created then
		error_generate("User was not created.")
	end if
else
	error_generate(Context.Security.CallResult.Text)
end if
</p>

<p class="code-example">dim userName as C = Context.Security.CurrentUser
if .not. Context.Security.CallResult.Success then
	error_generate(Context.Security.CallResult.Text)
end if

if alltrim(userName) = "" then
	'Display "no user is logged in."
else
	'Display user name
end if
</p>

<a name="Security-Properties">
<h2>Properties</h2>
</a>

<a name="Security-CallResult">
<h3>CallResult <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="http://wiki.alphasoftware.com/CallResult">CallResult</a></span></p>
<p><span class="code">Context.Security.CallResult</span> is used to check the success or failure of a method call or property get
in the Security object. See the <a href="#Security">note</a> in the Security class description above for more details
and examples.</p>

<a name="Security-CurrentUser">
<h3>CurrentUser <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Security.CurrentUser</span> returns the name of the current user if one is logged in. Otherwise a zero length
character value is returned. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success,</a></span>
before using the value that is returned.</p>

<a name="Security-IsActive">
<h3>IsActive <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Security.IsActive</span> returns .T. if the web application is running with security and returns
.F. if the web application is not running with security. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the value that is returned.</p>

<a name="Security-PasswordResetAllowed">
<h3>PasswordResetAllowed <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Security.PasswordResetAllowed</span> returns .T. if users are allowed to reset their password. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the value that is returned.</p>

<a name="Security-PasswordRetrievalAllowed">
<h3>PasswordRetrievalAllowed <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Security.PasswordRetrievalAllowed</span> returns .T. if users are allowed to retrieve their password. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the value that is returned.</p>

<a name="Security-RequiresQuestionAndAnswer">
<h3>RequiresQuestionAndAnswer <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Security.RequiresQuestionAndAnswer</span> returns .T. if users are required to supply an answer to a security
question in order to reset or retrieve their password. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the value that is returned.</p>

<a name="Security-RolesAreEnabled">
<h3>RolesAreEnabled <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Security.RolesAreEnabled</span> returns a <span class="code">.T.</span> if roles are enabled
for the security settings of the application. <span class="code">.F.</span> is returned otherwise. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success,</a></span>
before using the value that is returned.</p>

<a name="Security-SecurityQuestionList">
<h3>SecurityQuestionList <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Security.SecurityQuestionList</span> returns a <span class="code">crlf</span> delimited string of
security questions defined by the security system. Use this list when a user is created or updated and a security question
needs to be selected. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success,</a></span>
before using the value that is returned.</p>

<a name="Security-Methods">
<h2>Methods</h2>
</a>

<a name="Security-AddUserToRole">
<h3>AddUserToRole</h3>
</a>
<p>
<span class="method-signature">AddUserToRole as L (UserName as C, RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the role was added; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.<br/>
<span class="argument">RoleName as C</span> The name of the role to which the user will be added.
</p>
<p><span class="code">Context.Security.AddUserToRole()</span> adds a user to the supplied role. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-AddUserToRoles">
<h3>AddUserToRoles</h3>
</a>

<p>
<span class="method-signature">AddUserToRoles as L (UserName as C, RoleNames as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if roles were added; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.<br/>
<span class="argument">RoleNames as C</span> The names of the roles to which the user will be added. Role names
are separated by comma or space ("," or " ").
</p>
<p><span class="code">Context.Security.AddUserToRoles()</span> adds a user to the supplied roles. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-ChangePassword">
<h3>ChangePassword</h3>
</a>
<p><span class="method-signature">ChangePassword as L (UserName as C, OldPassword as C, NewPassword as C)</span></p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user's password was changed; otherwise <span class="code">.F.</span></p></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user as is used during login.<br/>
<span class="argument">OldPassword as C</span> The user's current password.<br/>
<span class="argument">NewPassword as C</span> The user's new password.<br/>
</p>
<p><span class="code">Context.Security.ChangePassword()</span> changes the password for
the user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-ChangePasswordQA">
<h3>ChangePasswordQuestionAndAnswer</h3>
</a>
<p><span class="method-signature">ChangePasswordQuestionAndAnswer as L (UserName as C, OldPassword as C, NewPassword as C, Question as C, Answer as C)</span></p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user's password, question, and answer were changed; otherwise <span class="code">.F.</span></p></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user as is used during login.<br/>
<span class="argument">OldPassword as C</span> The user's current password.<br/>
<span class="argument">NewPassword as C</span> The user's new password.<br/>
<span class="argument">Question as C</span> The user's new security question.<br/>
<span class="argument">Answer as C</span> The user's new security answer.<br/>
</p>
<p><span class="code">Context.Security.ChangePasswordQuestionAndAnswer()</span> changes the password, security question, and security answer for
the user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-CreateUser">
<h3>CreateUser</h3>
</a>
<p>
<span class="method-signature">CreateUser as L (UserName as C, Password as C, IsApproved as L = .T.)</span><br/>
<span class="method-signature">CreateUser as L (UserName as C, Password as C, Email as C, IsApproved as L = .T.)</span><br/>
<span class="method-signature">CreateUser as L (UserName as C, Password as C, Email as C, PasswordQuestion as C, PasswordAnswer as C, IsApproved as L = .T.)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is created; otherwise <span class="code">.F.</span></p></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the new user.<br/>
<span class="argument">Password as C</span> The password for the new user.<br/>
<span class="argument">Email as C</span> The email address of the new user.<br/>
<span class="argument">PasswordQuestion as C</span> The question to be used for password reset.<br/>
<span class="argument">PasswordAnswer as C</span> The answer to the PasswordQuestion to be used for password reset.<br/>
<span class="argument">IsApproved as L</span> Set the user to being approved for login or not approved for login. If this value
is set to .F. the user will not be able to login even if the credentials are valid. Optional. Defaults to .T.<br/>
</p>
<p><span class="code">Context.Security.CreateUser()</span> adds a new user with a password. There are method overloads for
creating a user with an email address and a password question and answer. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using the return value.
</p>

<a name="Security-CreateRole">
<h3>CreateRole</h3>
</a>
<p>
<span class="method-signature">CreateRole as L (RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if role is created; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleName as C</span> The name of the role to be created.
</p>
<p><span class="code">Context.Security.CreateRole()</span> adds a role. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-DeleteUser">
<h3>DeleteUser</h3>
</a>
<p><span class="method-signature">DeleteUser as L (UserId as C)</span></p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is deleted; otherwise <span class="code">.F.</span></p></p>
<h4>Arguments</h4>
<p><span class="argument">UserId as C</span> The name of the user to be deleted.</p>
<p><span class="argument">Context.Security.DeleteUser()</span> delete the specified user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-DeleteRole">
<h3>DeleteRole</h3>
</a>
<p>
<span class="method-signature">DeleteRole as L (RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if role is deleted; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleName as C</span> The name of the role to be deleted.
</p>
<p><span class="code">Context.Security.DeleteRole()</span> removes a role. A role must not have any users associated with it
in order for it to be deleted. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-GetEmail">
<h3>GetEmail</h3>
</a>
<p>
<span class="method-signature">GetEmail as C ()</span><br/>
<span class="method-signature">GetEmail as C (UserName as C)</span>
</p>
<p>Return type: <span class="type">C</span><br/>
The email address for a user, if any.
</p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> Optional. The user name for which the email address is to be retrieved. If no user name
is used then the email address for the current user will be retrieved.
</p>
<p><span class="code">Context.Security.GetEmail()</span> gets the email address of the specified user, or when no user is specified,
gets the email address of the current user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-GetPasswordQuestion">
<h3>GetPasswordQuestion</h3>
</a>
<p>
<span class="method-signature">GetPasswordQuestion as C ()</span><br/>
<span class="method-signature">GetPasswordQuestion as C (UserName as C)</span>
</p>
<p>Return type: <span class="type">C</span><br/>
The password question, if any.
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> Optional. The user name for which the password question is to be retrieved. If no user name
is used then the password question for the current user will be retrieved.
</p>
<p><span class="code">Context.Security.GetPasswordQuestion()</span> gets the password question of the specified user, or when no user is specified,
gets the password question of the current user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-GetRoles">
<h3>GetRoles</h3>
</a>
<p>
<span class="method-signature">GetRoles as C ()</span>
</p>
<p>Return type: <span class="type">C</span><br/>
a <span class="code">crlf</span> delimited list of roles.</p>
<h4>Arguments</h4>
<p>
None.
</p>
<p><span class="code">Context.Security.GetRoles()</span> gets a list of all the roles defined in the application's
security settings. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Security-GetRoleUsers">
<h3>GetRoleUsers</h3>
</a>
<p>
<span class="method-signature">GetRoleUsers as C (RoleName as C)</span>
</p>
<p>Return type: <span class="type">C</span><br/>
a <span class="code">crlf</span> delimited list of users.</p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleName as C</span> The name of the role.
</p>
<p><span class="code">Context.Security.GetRoleUsers()</span> gets a list of the users which are members of a role. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Security-GetUserRoles">
<h3>GetUserRoles</h3>
</a>
<p>
<span class="method-signature">GetUserRoles as C (UserName as C = null_value())</span>
</p>
<p>Return type: <span class="type">C</span><br/>
a <span class="code">crlf</span> delimited list of roles.</p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.
</p>
<p><span class="code">Context.Security.GetRoles()</span> gets a list of the roles to which the user belongs. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Security-GetUser">
<h3>GetUser</h3>
</a>
<p><span class="method-signature">GetUser as C (ProviderKey as A)</span></p>
<p>Return type: <span class="type">C</span><br/>
The user name or empty string if no user name is found for the given ProviderKey</p>
<h4>Arguments</h4>
<p><span class="argument">ProviderKey as A</span> The ProviderKey must be a value and type as returned from a
call to <span class="code"><a href="#Security-GetUserProviderKey">Context.Security.GetUserProviderKey()<a></span>.
</p>
<p><span class="code">Context.Security.GetUser()</span> gets the user name for a given ProviderKey.
Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-GetUserProviderKey">
<h3>GetUserProviderKey</h3>
</a>
<p>
<span class="method-signature">GetUserProviderKey as A ()</span><br/>
<span class="method-signature">GetUserProviderKey as A (UserName as C)</span>
</p>
<p>Return type: <span class="type">A</span><br/>
</p>
<p>
<span class="argument">UserName as C</span> Optional. Retrieve the provider key for a user. If no user name
is specified then the current user will be used.
</p>
<p><span class="code">Context.Security.GetuserProviderKey()</span> gets the provider defined key for a user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value. The provider key for a user is defined by the underlying security store. It can be
used with <span class="code"><a href="#Security-GetUser">Context.Security.GetUser</a></span> to get the user's name.
When used with <span class="code"><a href="#Security-GetUser">Context.Security.GetUser</a></span> the value must be
of the same type as returned from this method.
</p>

<a name="Security-GetUsers">
<h3>GetUsers</h3>
</a>
<p><span class="method-signature">GetUsers as C ()</span></p>
<p>Return type: <span class="type">C</span><br/>
A <span class="code">crlf</span> delimited string of all the users in the system.</p>
<h4>Arguments</h4>
<p>None</p>
<p><span class="code">Context.Security.GetUsers()</span> gets a list of all the users.
Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-IsCurrentUserInRole">
<h3>IsCurrentUserInRole</h3>
</a>
<p>
<span class="method-signature">IsCurrentUserInRole as L (RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the current user is in the role; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleName as C</span> The name of the role.
</p>
<p><span class="code">Context.Security.IsCurrentUserInRole()</span> checks to see if the current user is in a role. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-IsCurrentUserInRoles">
<h3>IsCurrentUserInRoles</h3>
</a>
<p>
<span class="method-signature">IsCurrentUserInRoles as L (RoleNames as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the current user is in at least one of the specified roles; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleNames as C</span> The name of the roles. The role names are separated by a comma or a space ("," or " ").
</p>
<p><span class="code">Context.Security.IsCurrentUserInRole()</span> checks to see if the current user is in at least one of supplied roles. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-IsUserInRole">
<h3>IsUserInRole</h3>
</a>
<p>
<span class="method-signature">IsUserInRole as L (UserName as C, RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if user is in the role; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name the user.<br/>
<span class="argument">RoleName as C</span> The name of the role.
</p>
<p><span class="code">Context.Security.IsUserInRole()</span> checks to see if the user is in a role. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-IsUserInRoles">
<h3>IsUserInRoles</h3>
</a>
<p>
<span class="method-signature">IsUserInRoles as L (UserName as C, RoleNames as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is in at least one of the specified roles; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name the user.<br/>
<span class="argument">RoleNames as C</span> The name of the roles. The role names are separated by a comma or a space ("," or " ").
</p>
<p><span class="code">Context.Security.IsUserInRole()</span> checks to see if the user is in at least one of supplied roles. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-LockOutUser">
<h3>LockOutUser</h3>
</a>
<p>
<span class="method-signature">LockOutUser as L ()</span><br/>
<span class="method-signature">LockOutUser as L (UserName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user was locked out; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> Optional. The user name of the user to be locked out. If no user name
is used then the current user is locked out.
</p>
<p><span class="code">Context.Security.LockOutUser()</span> locks out the specified user, or when no user is specified,
the current user is locked out. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-Login">
<h3>Login</h3>
</a>
<p><span class="method-signature">Login as L (UserName as C, Password as C, RedirectPage as C = null_value(),
ClientCookie as L = .F., DaysUntilExpiration as N = 10)</span></p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is logged in; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.<br/>
<span class="argument">Password as C</span> The password for the user.<br/>
<span class="argument">RedirectPage as C</span> The page the user will be redirected to on successful login. If not specified the
application defined redirect page will be used.<br/>
<span class="argument">ClientCookie as L</span> Set to .T. to create a persistent cookie. This type of cookie will remain across
browser sessions. That is, if you close your browser and restart the cookie will be available. When set to .F. the cookie will
not be available across browser sessions. The cookie is deleted when close your browser. This is the default and is a more
secure setting. <br/>
<span class="argument">DaysUntilExpiration as N</span> The number of days the authentication cookie is valid. This is calculated from
the time of the last request made with the cookie.<br/>
</p>
<p><span class="code">Context.Security.Login()</span> logs in a user and optionally letting you redirect the successful login to
a specific page and set the authentication cookie's lifetime. When login is successful the
<span class="code">Context.Security.CallResult.ReturnDataValue</span> will contain the redirect page URL. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using the return value.
</p>

<a name="Security-Logout">
<h3>Logout</h3>
</a>
<p>
<span class="method-signature">Logout as L ()</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is logged out; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>None.</p>
<p><span class="code">Context.Security.Logout()</span> logs out the current user. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-PasswordHasExpired">
<h3>PasswordHasExpired</h3>
</a>
<p>
<span class="method-signature">PasswordHasExpired as L ()</span><br/>
<span class="method-signature">PasswordHasExpired as L (UserName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user was removed from the role; otherwise <span class="code">.F.</span></p>
<p>
<span class="argument">UserName as C</span> Optional. The user name to check for password expiration. If no user name
is used then the password expiration check is done for the current user.
</p>
<p><span class="code">Context.Security.PasswordHasExpired()</span> gets whether or not the password of the specified user
has expired. The maximum lifetime of a password is defined in the security settings. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-RemoveUserFromRole">
<h3>RemoveUserFromRole</h3>
</a>
<p>
<span class="method-signature">RemoveUserFromRole as L (UserName as C, RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user was removed from the role; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user to be removed from the role.<br/>
<span class="argument">RoleName as C</span> The name of the role from which the user should be removed.
</p>
<p><span class="code">Context.Security.RemoveUserFromRole()</span> removes a user from a role. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-ResetPassword">
<h3>ResetPassword</h3>
</a>
<p>
<span class="method-signature">ResetPassword as C (UserName as C, PasswordAnswer as C = null_value())</span>
</p>
<p>Return type: <span class="type">C</span><br/>
The newly generated password.</p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.<br/>
<span class="argument">PasswordAnswer as C</span> The value must match the password answer set for the user when the selected
membership provider requires a password answer for password reset. The match is case-insensitive for SqlServerMembership
provider. This is the provider used when the publish profile uses "SqlServer" for the Membership provider.<br/>
</p>
<p><span class="code">Context.Security.ResetPassword()</span> reset the user's password to a generated password. If a password answer
is required PasswordAnswer must be supplied. The return value is the newly generated password. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-RoleExists">
<h3>RoleExists</h3>
</a>
<p>
<span class="method-signature">RoleExists as L (RoleName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the role exists; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">RoleName as C</span> The name of the role.
</p>
<p><span class="code">Context.Security.RoleExists()</span> checks if a role exists. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-TestPassword">
<h3>TestPassword</h3>
</a>
<p>
<span class="method-signature">TestPassword as L (Password as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the password is valid based on validation settings; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Password as C</span> A password.
</p>
<p><span class="code">Context.Security.TestPassword()</span> Checks the validity of a password against the validation
configuration in the security settings. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-UnlockUser">
<h3>UnlockUser</h3>
</a>
<p>
<span class="method-signature">UnlockUser as L (UserName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is unlocked; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.
</p>
<p><span class="code">Context.Security.UnlockUser()</span> will allow a user to login to the application. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-UserExists">
<h3>UserExists</h3>
</a>
<p>
<span class="method-signature">UserExists as L (UserName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user exists; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.
</p>
<p><span class="code">Context.Security.UserExists()</span> checks if the user exists. Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-UserIsLockedOut">
<h3>UserIsLockedOut</h3>
</a>
<p>
<span class="method-signature">UserIsLockedOut as L (UserName as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the user is locked out; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.
</p>
<p><span class="code">Context.Security.UserIsLockedOut()</span> checks if the user is locked out from logging into the application.
 Check <span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Security-ValidateUser">
<h3>ValidateUser</h3>
</a>
<p>
<span class="method-signature">ValidateUser as L (UserName as C, Password as C)</span>
</p>
<p>Return type: <span class="type">L</span><br/>
<span class="code">.T.</span> if the credentials are valid; otherwise <span class="code">.F.</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">UserName as C</span> The name of the user.<br/>
<span class="argument">Password as C</span> The user's password.
</p>
<p><span class="code">Context.Security.ValidateUser()</span> validates the supplied credentials. Check
<span class="code"><a href="#Security-CallResult">Context.Security.CallResult.Success</a></span> before using
the return value.
</p>

<a name="Session">
<h1>Session</h1>
</a>
<p>The <span class="code">Session</span> object contains properties and methods available for working with a server session. On the
stand-alone application server session data is stored in memory in the same process as the application server. On IIS session data
can be stored in one of many different ways. Session data can be stored in process like the stand-alone application server, in a
state server which is another process on the same machine as the web server, or in a database (SQL or NoSql) depending on the
session state provider that is selected for the application. Methods on the session object may have different performance
characteristics depending on the session storage that is used.</p>
<p class="note">
<span class="first-word">Note</span>: The <span class="code">Session</span> object has a
<span class="code"><a href="http://wiki.alphasoftware.com/CallResult">CallResult</a></span> property.
Use this property to see if a method call or property get succeeds before using a method's returned value or property's value.
See the following examples:
</p>
<p class="code-example">dim errorMsg as C = ""
Context.Session.Add("lastVisitedPage", "secret")
if .not. Context.Session.CallResult.Success then
	'Note: This error is most likely caught and handled and does not cause a page error.
	error_generate(Context.Session.CallResult.Text)
end if
</p>

<a name="Session-Properties">
<h2>Properties</h2>
</a>

<a name="Session-CallResult">
<h3>CallResult <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="http://wiki.alphasoftware.com/CallResult">CallResult</a></span></p>
<p><span class="code">Context.Session.CallResult</span> is used to check the success or failure of a method call or property get or set
in the Session object. See the <a href="#Session">note</a> in the Session class description above for more details
and example.</p>

<a name="Session-CookieMode">
<h3>CookieMode <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.web.httpcookiemode(v=vs.100).aspx">System::Web::HttpCookieMode</a></span></p>
<p><span class="code">Context.Session.CookieMode</span> indicates whether the application is configured for cookieless sessions.</p>

<a name="Session-Count">
<h3>Count <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">N</span></p>
<p><span class="code">Context.Session.Count</span> is the number of items in the session-state collection.</p>

<a name="Session-IsCookieless">
<h3>IsCookieless <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Session.IsCookieless</span> indicates where the session id is returned to the client.
If <span class="code">.T.</span> the session id is added to the URL. Otherwise, the session id is stored in a cookie.</p>

<a name="Session-IsNewSession">
<h3>IsNewSession <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Session.IsNewSession</span> if <span class="code">.T.</span> indicates the session was create during the current request.
Otherwise, the session was created by some prior request.</p>

<a name="Session-IsReadOnly">
<h3>IsReadOnly <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Session.IsReadOnly</span> if <span class="code">.T.</span> indicates the session is read-only.
Otherwise, the session is read-write.</p>

<a name="Session-IsSynchronized">
<h3>IsSynchronized <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">L</span></p>
<p><span class="code">Context.Session.IsSynchronized</span> if <span class="code">.T.</span> indicates that access to
the session-state variables is thread safe. Otherwise, manual synchronization of session-state variable access needs to be done.</p>

<a name="Session-Keys">
<h3>Keys <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/System.Collections.Specialized.NameObjectCollectionBase.KeysCollection(v=vs.100).aspx">System::Collections::Specialized::NameObjectCollectionBase::KeysCollection</a></span></p>
<p><span class="code">Context.Session.Keys</span> is a collection of all the keys in the session-state.</p>

<a name="Session-Mode">
<h3>Mode <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type"><a href="https://msdn.microsoft.com/en-us/library/system.web.sessionstate.sessionstatemode(v=vs.100).aspx">System::Web::SessionState::SessionStateMode</a></span></p>
<p><span class="code">Context.Session.Mode</span> specifies how the session-state is stored.</p>

<a name="Session-SessionId">
<h3>SessionId <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Session.SessionId</span> is the unique identifier for the session.</p>

<a name="Session-Timeout">
<h3>Timeout <span class="badge badge-rw" title="read-write">r/w</span></h3>
</a>
<p>Type: <span class="type">N</span></p>
<p><span class="code">Context.Session.Timeout</span> gets or sets the time, in minutes, for a session to be terminated due to
inactivity.</p>

<a name="Session-Timestamp">
<h3>Timestamp <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">T</span></p>
<p><span class="code">Context.Session.Timestamp</span> is the timestamp for when the session was created. The value is
local time on the server.</p>

<a name="Session-UniqueDataKey">
<h3>UniqueDataKey <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">C</span></p>
<p><span class="code">Context.Session.UniqueDataKey</span> generated a unique value each time it is accessed. The value
is the 32 digits of a Guid prepended with "DTA" resulting in a value that looks like this: <span class="code">DTA114ea94b16924e30ace6bef15c75d8f4</span>.</p>

<a name="Session-Variables">
<h3>Variables <span class="badge" title="read-only">r/o</span></h3>
</a>
<p>Type: <span class="type">P</span></p>
<p><span class="code">Context.Session.Variables</span> is the way to access session-state collection values directly. Using
<span class="code">Context.Session.Variables.MySessionVar = "MySessionVarValue"</span> is equivalent to using
<span class="code">Context.Session.Add("MySessionVar", "MySessionVarValue")</span>. Note that
<span class="code">Context.Session.MySessionVar</span> is also equivalent to
<span class="code">Context.Session.Variables.MySessionVar</span>, but that
<span class="code">Context.Session.Variables.MySessionVar</span> is preferred. See an example .a5w page below.
</p>
<p class="note">
<span class="first-word">Note</span>: The <a href="http://wiki.alphasoftware.com/Server+Programming+Changes+V11">Server Programming Changes for Version 11</a>
states that session variables can only be strings and that other variables types are not supported and may not work as expected.
This also means that dots (".") are not allowed in the session variable name.
That is, <span class="code">Context.Session.Variables.MySessionVar.FirstName</span> is not allowed.
</p>
<p>Example .a5w page using session variables.</p>
<p class="code-example">&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;
&lt;%a5
Context.Session.Variables.ASessionVar = "Value for ASessionVar."
Context.Session.Add("AnotherSessionVar", "Value for AnotherSessionVar.")
?*html_escape(property_to_string(Context.Session.Variables)) + crlf()

Context.Session.SaveData("ASessionVar", "Changed value for ASessionVar.")
?*html_escape(property_to_string(Context.Session.Variables)) + crlf()
%&gt;
&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
</p>

<a name="Session-Methods">
<h2>Methods</h2>
</a>

<a name="Session-Abandon">
<h3>Abandon</h3>
</a>
<p>
<span class="method-signature">Abandon as V ()</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
None.
</p>
<p><span class="code">Context.Session.Abandon()</span> terminates the current session. Check <span class="code"><a href="#SessionCallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-Add">
<h3>Add</h3>
</a>
<p>
<span class="method-signature">Add as V (Name as C, Value as A)</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Name as C</span> The name of the session-state variable.<br/>
<span class="argument">Value as A</span> The value of the session-state variable. Although type <span class="code">A</span>,
any type, is allowed it is deprecated for the value. The value should be of type <span class="code">C</span> in order to
support the most types of session-state providers under IIS.
</p>
<p><span class="code">Context.Session.Add()</span> adds a named value to the session-state collection. Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-Clear">
<h3>Clear</h3>
</a>
<p>
<span class="method-signature">Clear as V ()</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
None.
</p>
<p><span class="code">Context.Session.Clear()</span> empties the entire session-state collection. Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-DeleteSessionFile">
<h3>DeleteSessionFile</h3>
</a>
<p>
<span class="method-signature">DeleteSessionFile as L (Key as C)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the data in the session-state collection. The value of key is a
file name without any path components.
</p>
<p><span class="code">Context.Session.DeleteSessionFile()</span> deletes the value session-state key from the session-state
collection under IIS. Under the stand-alone application server, the session file in the stand-alone
application server's session folder is deleted.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-FormatFileDataURL">
<h3>FormatFileDataURL</h3>
</a>
<p>
<span class="method-signature">FormatFileDataURL as C (Key as C)</span>
</p>
<p>Return type: <span class="type">C</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the file in the session-state collection. The value of key is a
file name without any path components.
</p>
<p><span class="code">Context.Session.FormatFileDataURL()</span> returns a URL suitable for a browser to retrieve a
session file. No assumptions should be made about the construction of this URL.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-GetData">
<h3>GetData</h3>
</a>
<p>
<span class="method-signature">GetData as L (Key as C, ByRef Value as A)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the session-state variable to be retrieved.<br/>
<span class="argument">ByRef Value as A</span> A reference to a variable to receive the session-state variable value.
</p>
<p><span class="code">Context.Session.GetData()</span> gets the value of a specific key from the session-state collection.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-GetDataFromFile">
<h3>GetDataFromFile</h3>
</a>
<p>
<span class="method-signature">GetDataFromFile as L (Key as C, ByRef Value as B, Remove as L = .F.)</span><br/>
<span class="method-signature">GetDataFromFile as L (ByRef Value as B, Key as C, Remove as L = .F.)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the session-state variable to be retrieved.<br/>
<span class="argument">ByRef Value as B</span> A reference to a variable to receive the session-state variable value.<br/>
<span class="argument">Remove as L</span> A setting of <span class="code">.T.</span> or <span class="code">.F.</span> to remove the
item from the session-state collection after it has been retrieved. This is optional and defaults to <span class="code">.F.</span>.
</p>
<p><span class="code">Context.Session.GetDataFromFile()</span> gets the value of a key from the session-state collection.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-GetSQLCredentials">
<h3>GetSQLCredentials</h3>
</a>
<p>
<span class="method-signature">GetSQLCredentials as L (ByRef Username as C, ByRef Password as C)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">ByRef Username as C</span> The variable to receive the value of the SQL username.<br/>
<span class="argument">ByRef Password as C</span> The variable to receive the value of the SQL password.
</p>
<p><span class="code">Context.Session.GetSQLCredentials()</span> if successful returns the SQL username and password
used for SQL connections. See
<a href="http://wiki.alphasoftware.com/Session.GetSQLCredentials+Method+V10.5">Session.GetSQLCredentails</a> for more details.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-Remove">
<h3>Remove</h3>
</a>
<p>
<span class="method-signature">Remove as V (Name as C)</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Name as C</span> The name of the session-state variable.
</p>
<p><span class="code">Context.Session.Add()</span> removes a named value to the session-state collection. Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-RemoveAll">
<h3>RemoveAll</h3>
</a>
<p>
<span class="method-signature">RemoveAll as V ()</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
None.
</p>
<p><span class="argument">Context.Session.RemoveAll()</span> is an alias of <a href="#Session-Clear">Context.Session.Clear()</a>. Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-RemoveAt">
<h3>RemoveAt</h3>
</a>
<p>
<span class="method-signature">RemoveAt as V (Index as N)</span>
</p>
<p>Return type: <span class="type">V</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Index as N</span> The index of the session-state variable to be removed. This index is zero based.
</p>
<p><span class="code">Context.Session.RemoveAt()</span> removes the item at the specified 0-based index from the
session-state collection. Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-SaveData">
<h3>SaveData</h3>
</a>
<p>
<span class="method-signature">SaveData as L (Key as C, Value as A)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the session-state variable to be retrieved.<br/>
<span class="argument">Value as A</span> The value of the session-state variable. Although type <span class="code">A</span>,
any type, is allowed it is deprecated for the value. The value should be of type <span class="code">C</span> in order to
support the most types of session-state providers under IIS.
</p>
<p><span class="code">Context.Session.SaveData()</span> sets the value of a key in the session-state collection.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-SaveDataAsFile">
<h3>SaveDataAsFile</h3>
</a>
<p>
<span class="method-signature">SaveDataAsFile as L (FileName as C, Value as C, RemoveAfterFirstRetrieval as L = .T.)</span><br/>
<span class="method-signature">SaveDataAsFile as L (FileName as C, Value as B, RemoveAfterFirstRetrieval as L = .T.)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">FileName as C</span> The name of the file to be saved. This name should not have any path components.<br/>
<span class="argument">Value as B</span> The bytes to be saved.<br/>
<span class="argument">Value as C</span> The characters to be saved. The characters are converted to a UTF-8 stream of bytes
that are saved.<br/>
<span class="argument">RemoveAfterFirstRetrieval as T</span> This is reserved for future use.
</p>
<p><span class="code">Context.Session.SaveDataAsFile()</span> saves the value to the session-state collection under IIS. Under
the stand-alone application server, the value is written to disk in the stand-alone application server's session folder.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-SaveFileToSessionFile">
<h3>SaveFileToSessionFile</h3>
</a>
<p>
<span class="method-signature">SaveFileToSessionFile as L (SourceFile as C, Key as C, RemoveAfterFirstRetrieval as L = .T.)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">SoureName as C</span> The full path of the file whose contents are to be saved into the
session-state collection.<br/>
<span class="argument">Key as C</span> The key for the data in the session-state collection. The value of key is
a file name without any path components.<br/>
<span class="argument">RemoveAfterFirstRetrieval as T</span> This is reserved for future use.
</p>
<p><span class="code">Context.Session.SaveFileToSessionFile()</span> saves the contents of the source file to the session-state
collection under IIS. Under the stand-alone application server, the source file is copied to disk in the stand-alone
application server's session folder.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-SaveSessionFileToFile">
<h3>SaveSessionFileToFile</h3>
</a>
<p>
<span class="method-signature">SaveSessionFileToFile as L (Key as C, DestinationFile as C)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Key as C</span> The key of the data in the session-state collection. The value of key is a file
name without any path components.<br/>
<span class="argument">DestinationFile as C</span> The full path of the file into which the session-state data is to be saved.
</p>
<p><span class="code">Context.Session.SaveSessionFileToFile()</span> saves the contents of the session-state key
to the destination file under IIS. Under the stand-alone application server, the session file in the stand-alone
application server's session folder is copied to the destination file.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>

<a name="Session-SetSQLCredentials">
<h3>SetSQLCredentials</h3>
</a>
<p>
<span class="method-signature">SetSQLCredentials as L (Username as C, Password as C)</span>
</p>
<p>Return type: <span class="type">L</span></p>
<h4>Arguments</h4>
<p>
<span class="argument">Username as C</span> The value of the SQL username.<br/>
<span class="argument">Password as C</span> The value of the SQL password.
</p>
<p><span class="code">Context.Session.SetSQLCredentials()</span> sets the SQL username and password used for SQL connections.
See <a href="http://wiki.alphasoftware.com/Session.SetSQLCredentials+Method+V10.5">Session.SetSQLCredentails</a> for more details.
Check <span class="code"><a href="#Session-CallResult">Context.Session.CallResult.Success</a></span>
before using the return value.
</p>
<div class="copyright">
	<p>&copy; Copyright Alpha Software Corporation 2000-2015</p>
</div>
</div>
</div>

<!---HELPMETADATA: {"tags":"web","status":"pending"} --->
</body>
</html>
