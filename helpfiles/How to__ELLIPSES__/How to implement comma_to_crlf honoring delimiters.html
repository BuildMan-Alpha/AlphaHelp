	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_implement_comma_to_crlf_honoring_delimiters">How to implement comma_to_crlf honoring delimiters</h1>
The <a href="../References/Functions/COMMA_TO_CRLF Function.html" title="COMMA_TO_CRLF Function" class="wiki">comma_to_crlf function</a> does not take into account quoted delimiters. For example if your input string is:<br />
<span style="color:#00F; background:">alpha,beta,"gamma has, a comma",delta</span><br />
<br />
then it will blindly break the string on all of the commas, regardless of whether the string is inside a quoted delimiter.<br />
<br />
Here is how to implement comma_to_crlf while honoring delimiters.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox" >txt = &lt;&lt;%str%
,,abc,123,"this string,has a comma",,,98767,
%str%

txt2 = comma_to_crlf_honor_delimiters(txt)
showvar(txt2)

function comma_to_crlf_honor_delimiters as c (txt as c )
dim s as stringscanner
dim tokens[0] as c
s = s.Create(txt)
s.SkipOverWhitespace()
WHILE .t.
	dim token as c
	dim num as n = s.SkipOverCharacter(",")
	IF num &gt; 0 THEN
		token = " "
		tokens[] = token
		FOR x = 2 TO num
			token = " "
			tokens[] = token
		next
	ELSE
		token = s.ScanOverToken("*")
		tokens[] = token
		s.SkipOverWhitespace()
		num = s.SkipOverCharacter(",")
		IF num &lt; 1 THEN
			exit while
		ELSE
			FOR x = 2 TO num
				token = " "
				tokens[] = token
			next
		END IF
	END IF
	s.SkipOverWhitespace()
END WHILE
dim txt2 as c 
txt2 = tokens.dump()
comma_to_crlf_honor_delimiters = txt2
end function</pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+implement+comma_to_crlf+honoring+delimiters">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>