	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_Dynamically_Construct_SQL_Statements">How to Dynamically Construct SQL Statements</h1>
This interactive session demonstrates how you can programmatically modify SQL statements from Xbasic.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="white-space:pre-wrap; white-space:-moz-pre-wrap !important; white-space:-pre-wrap; white-space:-o-pre-wrap; word-wrap:break-word;" id="codebox" >sql <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;select firstname, lastname, city from customers where lastame = 'smith' order by lastname&quot;</span>
&nbsp;
<span style="color: #0600FF;">dim</span> q <span style="color: #FF8000;">as</span> sql::Query
?q.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span>sql<span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
&nbsp;
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname, lastname, city FROM customers  WHERE lastame = 'smith'  ORDER BY lastname&quot;</span>
&nbsp;
<span style="color: #0600FF;">dim</span> si <span style="color: #FF8000;">as</span> sql::query::SelectItem
?si.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span> <span style="color: #808080;">&quot;concatenate(firstname,', ',lastname) as fullname&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0000FF;">q</span>.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Add</span><span style="color: #000000;">&#40;</span>si<span style="color: #000000;">&#41;</span>
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname, lastname, city,  concatenate(firstname, ', ', lastname)  AS fullname FROM customers  WHERE lastame = 'smith'  ORDER BY lastname&quot;</span>
&nbsp;
&nbsp;
<span style="color: #0600FF;">dim</span> le <span style="color: #FF8000;">as</span> sql::query::LogicalExpression
<span style="color: #008080; font-style: italic;">'remove the where clause by setting to a blank logical expression</span>
q.<span style="color: #0000FF;">Where</span> <span style="color: #008000;">=</span> le
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname, lastname, city,  concatenate(firstname, ', ', lastname)  AS fullname FROM customers   ORDER BY lastname&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'add a new where clause</span>
?le.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;lastname = 'smith' and firstname = 'john'&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
<span style="color: #0000FF;">q</span>.<span style="color: #0000FF;">Where</span> <span style="color: #008000;">=</span> le 
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname, lastname, city,  concatenate(firstname, ', ', lastname)  AS fullname FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'  ORDER BY lastname&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'remove all columns from the sql</span>
?q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Count</span>
<span style="color: #008000;">=</span> <span style="color: #FF0000;">4</span>
<span style="color: #008080; font-style: italic;">'execute the remove 4 times</span>
q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Remove</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>
q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Remove</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>
q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Remove</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>
q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Remove</span><span style="color: #000000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#41;</span>
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT  FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'  ORDER BY lastname&quot;</span>
&nbsp;
si.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;firstname&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008080; font-style: italic;">'now add back 1 column</span>
q.<span style="color: #0000FF;">Column</span>.<span style="color: #0000FF;">Add</span><span style="color: #000000;">&#40;</span>si<span style="color: #000000;">&#41;</span>
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'  ORDER BY lastname&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'count the number of levels in the order by</span>
?q.<span style="color: #0000FF;">NestedOrderBy</span>.<span style="color: #0000FF;">Count</span>
<span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'remove the order by clause</span>
q.<span style="color: #0000FF;">NestedOrderBy</span>.<span style="color: #0600FF;">Reset</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'add in a new order by clause</span>
<span style="color: #0600FF;">Dim</span> co <span style="color: #FF8000;">as</span> SQL::Query::ColumnOrder
?co.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;city DESC&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #008000;">=</span> .<span style="color: #0000FF;">T</span>.
&nbsp;
<span style="color: #0000FF;">q</span>.<span style="color: #0000FF;">NestedOrderBy</span>.<span style="color: #0000FF;">Add</span><span style="color: #000000;">&#40;</span>co<span style="color: #000000;">&#41;</span>
&nbsp;
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'  ORDER BY city DESC&quot;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">'now add in another order by clause</span>
co.<span style="color: #0000FF;">parse</span><span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;lastname&quot;</span><span style="color: #000000;">&#41;</span>
q.<span style="color: #0000FF;">NestedOrderBy</span>.<span style="color: #0000FF;">add</span><span style="color: #000000;">&#40;</span>co<span style="color: #000000;">&#41;</span>
?q.<span style="color: #0000FF;">SQLStatement</span>
<span style="color: #008000;">=</span> <span style="color: #808080;">&quot;SELECT firstname FROM customers  WHERE lastname = 'smith'  AND  firstname = 'john'  ORDER BY city DESC, lastname&quot;</span></pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+Dynamically+Construct+SQL+Statements">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"tags":"common","group":"/Guides/Server/How to"} --->
</body></html>