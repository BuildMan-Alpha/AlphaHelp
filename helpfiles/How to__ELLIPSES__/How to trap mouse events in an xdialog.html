	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_trap_mouse_events_in_an_xdialog">How to trap mouse events in an xdialog</h1>
This example demonstrates how to trap mouse events in an xdialog using a user defined xdialog control.<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >define <span style="color: #0600FF;">class</span> system <span style="color: #000000;">&#91;</span>control<span style="color: #000000;">&#93;</span> HelloWorld
<span style="color: #0600FF;">dim</span> ctl <span style="color: #FF8000;">as</span> p
<span style="color: #0600FF;">dim</span> dlg_title <span style="color: #FF8000;">as</span> c
<span style="color: #0600FF;">dim</span> varName <span style="color: #FF8000;">as</span> c
<span style="color: #0600FF;">dim</span> message <span style="color: #FF8000;">as</span> c
<span style="color: #0600FF;">FUNCTION</span> HelloWorld <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
  message <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello World&quot;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
implementation EmbeddedIface <span style="color: #FF8000;">as</span> Type::MetaControlImpl
<span style="color: #0600FF;">FUNCTION</span> updateDrawing <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">ctl</span>.<span style="color: #0000FF;">drawCode</span> <span style="color: #008000;">=</span> ui_generate_quick_draw<span style="color: #000000;">&#40;</span><span style="color: #008000;">&amp;</span>lt;<span style="color: #008000;">&amp;</span>lt;%code%
set_brush<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;yellow&quot;</span><span style="color: #000000;">&#41;</span>
fill_rect<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">4</span>,<span style="color: #FF0000;">2</span><span style="color: #000000;">&#41;</span>
set_font<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;Tahoma,15&quot;</span>,<span style="color: #808080;">&quot;Red&quot;</span><span style="color: #000000;">&#41;</span>
text<span style="color: #000000;">&#40;</span>self.<span style="color: #0000FF;">message</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #000000;">&#41;</span>
%code%<span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> OnlButtonDown <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ma <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world - Mouse Down&quot;</span>
  <span style="color: #008080; font-style: italic;">'self.varname = the 'variable' that is bound to the Meta control</span>
  <span style="color: #008080; font-style: italic;">'e.g. {HelloWorld=100,10test1};  - in this case, it is 'test1'.</span>
  ui_dlg_eval<span style="color: #000000;">&#40;</span>self.<span style="color: #0000FF;">dlg_title</span>,self.<span style="color: #0000FF;">varname</span> <span style="color: #008000;">+</span> <span style="color: #808080;">&quot;:=&quot;</span> <span style="color: #008000;">+</span> quote<span style="color: #000000;">&#40;</span>ma.<span style="color: #0000FF;">x</span> <span style="color: #008000;">+</span><span style="color: #808080;">&quot;:&quot;</span> <span style="color: #008000;">+</span> ma.<span style="color: #0000FF;">y</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
  ui_dlg_refresh<span style="color: #000000;">&#40;</span>self.<span style="color: #0000FF;">dlg_title</span><span style="color: #000000;">&#41;</span>
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> OnlButtonUp <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ma <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world - Mouse Up&quot;</span>
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> OnMouseMove <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ma <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world - Move &quot;</span><span style="color: #008000;">+</span>ma.<span style="color: #0000FF;">X</span><span style="color: #008000;">+</span><span style="color: #808080;">&quot;,&quot;</span><span style="color: #008000;">+</span>ma.<span style="color: #0000FF;">Y</span>
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> OnMouseLeave <span style="color: #FF8000;">as</span> v <span style="color: #000000;">&#40;</span>ma <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world&quot;</span>
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> OnKeyDown <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ka <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world - KeyDown &quot;</span><span style="color: #008000;">+</span>ka.<span style="color: #0000FF;">KeyName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
&nbsp;
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> OnKeyUp <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ka <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
  self.<span style="color: #0000FF;">message</span> <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;Hello world - KeyUp &quot;</span><span style="color: #008000;">+</span>ka.<span style="color: #0000FF;">KeyName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
  updateDrawing<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">END</span> implementation
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> <span style="color: #0600FF;">initialize</span> <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>dlg_title <span style="color: #FF8000;">as</span> c, parguments <span style="color: #FF8000;">as</span> c, pcontents <span style="color: #FF8000;">as</span> c, pvarFrame <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
self.<span style="color: #0000FF;">dlg_title</span> <span style="color: #008000;">=</span> dlg_title
self.<span style="color: #0000FF;">varName</span> <span style="color: #008000;">=</span> parguments
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> GetControlInterface <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
GetControlInterface <span style="color: #008000;">=</span> EmbeddedIface
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> GetVariables <span style="color: #FF8000;">as</span> c <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
GetVariables <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;&quot;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> refresh <span style="color: #FF8000;">as</span> c<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
&nbsp;
<span style="color: #0600FF;">FUNCTION</span> BindControl <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span>ptr <span style="color: #FF8000;">as</span> p<span style="color: #000000;">&#41;</span>
self.<span style="color: #0000FF;">ctl</span> <span style="color: #008000;">=</span> ptr
EmbeddedIface.<span style="color: #0000FF;">updateDrawing</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> <span style="color: #0600FF;">close</span> <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> setfocus <span style="color: #FF8000;">as</span> v<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">FUNCTION</span> GetBorderStyle <span style="color: #FF8000;">as</span> c<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
GetBorderStyle <span style="color: #008000;">=</span> <span style="color: #808080;">&quot;default&quot;</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">FUNCTION</span>
<span style="color: #0600FF;">END</span> <span style="color: #0600FF;">class</span>
&nbsp;
&nbsp;
ui_dlg_box<span style="color: #000000;">&#40;</span><span style="color: #808080;">&quot;hello&quot;</span>,<span style="color: #008000;">&amp;</span>lt;<span style="color: #008000;">&amp;</span>lt;%dlg%
<span style="color: #000000;">&#123;</span>HelloWorld<span style="color: #008000;">=</span><span style="color: #FF0000;">100</span>,10test1<span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#91;</span>.20test1<span style="color: #000000;">&#93;</span>;
<span style="color: #000000;">&#123;</span>HelloWorld<span style="color: #008000;">=</span><span style="color: #FF0000;">100</span>,10test2<span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#91;</span>.20test2<span style="color: #000000;">&#93;</span>;
<span style="color: #000000;">&#123;</span>justify<span style="color: #008000;">=</span><span style="color: #0600FF;">right</span><span style="color: #000000;">&#125;</span><span style="color: #008000;">&amp;</span>lt;<span style="color: #008000;">*</span>10OK!ok<span style="color: #008000;">&amp;</span>gt;;
%dlg%<span style="color: #000000;">&#41;</span></pre></div><br />
<br />
	<img src="images/trap_mouse_events_in_xdialog.png" alt="Image" /><br />
<br />
<br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+trap+mouse+events+in+an+xdialog">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA: {"group":"/Guide/Desktop/Design/View/Xdialog/","status":"pending","tags":"desktop, review","notes":"Code with little description","keywords":"desktop,guide,xdialog"} --->
</body></html>