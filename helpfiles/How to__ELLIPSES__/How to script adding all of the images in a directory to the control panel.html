	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h2 class="showhide_heading" id="How_to_script_adding_all_of_the_images_in_a_directory_to_the_control_panel">How to script adding all of the images in a directory to the control panel</h2>
This example show how you can write a simple script to add all of the images (.jpg, .jpeg, .bmp and .png) that are in a specified folder to the Control Panel in Alpha Five.<br />
<br />
This script automates the tedious process of adding images to the Control Panel (Code tab, click New button, etc) one at a time.<br />
<br />
<div class="plugincode" ><pre class="codelisting" data-syntax="" dir="ltr" style="overflow:auto;" id="codebox" >dim dict as c 
dict = file.filename_parse(a5.Get_Name(),"dpn") + ".alb"
dim dp as p
dp = dictionary.open(dict,FILE_RW_EXCLUSIVE)


dim files as c 
dim sourcefolder as c 
sourcefolder = "c:\a5v10"
files = ""
files = files + filefind.get(sourcefolder + chr(92) +"*.png",0,"pn") + crlf()
files = files + filefind.get(sourcefolder + chr(92) +"*.bmp",0,"pn") + crlf()
files = files + filefind.get(sourcefolder + chr(92) +"*.jpg",0,"pn") + crlf()
files = files + filefind.get(sourcefolder + chr(92) +"*.jpeg",0,"pn") + crlf()
files = remove_blank_lines(files)


dim file_i as c 
dim type_i as c 
dim b_i as b 
dim name_i as c 
dim ext_i as c 
dim count as n 
count = 0
for each fn in files 
  count = count + 1 
  file_i = fn.value
  name_i = left(file.filename_parse(file_i,"N"),32)  'object names have a max length
  b_i = file.to_blob(file_i)
  ext_i = file.filename_parse(file_i,"e")
  if inlist2(ext_i,".jpg,.bmp,.jpeg") then 
    type_i = "GBMP"
  else if ext_i = ".PNG" then 
    type_i = "GPNG"
  end if 
  
  if ext_i = ".jpg" .or. ext_i = ".jpeg" then 
    b_i = jpeg_to_bitmap(b_i)
  end if 
  dp.enter_begin()  
  dp.name = name_i
  dp.contents_m = b_i 
  dp.type = type_i
  
next 
dp.close()
controlpanel.Refresh()
ui_msg_box("","done")</pre></div><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+script+adding+all+of+the+images+in+a+directory+to+the+control+panel">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>