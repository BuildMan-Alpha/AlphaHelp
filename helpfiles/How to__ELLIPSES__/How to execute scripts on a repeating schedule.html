	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="How_to_execute_scripts_on_a_repeating_schedule">How to execute scripts on a repeating schedule</h1>
Once you have this working then save it as the 'autoexec' script. It is currently set to fire every 5 seconds. To change to 10 minutes, change the {interval} value to 600 (seconds). The event log is written to a textbox on the xdialog and to a file. See the script 'script1' below.<br />
<br />
<span style="color:blue; background:">dim log as c = ""<br />
dim dlg_title as c<br />
dim dlg_body as c<br />
dim dlg_event as c<br />
dlg_title = "Schedule"<br />
dlg_body = &lt;&lt;%dlg%<br />
{timer=playScript}<br />
{interval=5}<br />
This dialog will run another script called 'script1' every x seconds.;<br />
The interval can be changed by editing the {{interval} command.;<br />
{lf};<br />
<br />
Event Log:;<br />
[%M%.100,20log];<br />
&lt;Close&gt;;<br />
%dlg%<br />
dlg_event = &lt;&lt;%code%<br />
if a_dlg_button = "playScript" then<br />
            script_play("script1")<br />
            log = "Last execution: " + now() + crlf() + log<br />
end if<br />
<br />
if a_dlg_button = "Close" then<br />
            ui_modeless_dlg_close(dlg_title)<br />
end if<br />
%code%<br />
ui_modeless_dlg_box(dlg_title,dlg_body,dlg_event)</span><br />
<br />
Here is 'script1':<br />
<br />
<span style="color:blue; background:">'this is script 1<br />
'put your code here that you want to run every x minutes.<br />
dir_create_recurse("c:\eventLog")<br />
save_to_file("Script executed at: " + now() + crlf(),"c:\eventLog\events.txt",.t.)</span><br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:How+to+execute+scripts+on+a+repeating+schedule">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 --></body></html>