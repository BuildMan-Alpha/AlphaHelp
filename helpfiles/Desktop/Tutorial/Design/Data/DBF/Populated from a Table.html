	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Populated from a Table</p>

<p>This topic describes the process of creating a property sheet that is bound to a table, and can support data entry and editing. This property sheet was created with the <span class=Screen>Property Sheet Builder</span> in Action Scripting. See <a href="../../../../Guide/Design/View/Xdialog/Property-Sheet Style Dialog.html" title="Property-Sheet Style Dialog" class="wiki">Property-Sheet Style Xdialog</a>. </p>

<p class=Pix> <img src="images/XD_Property_Sheet_Table_Bound.gif" x-maintain-ratio=TRUE style="border: none; width: 497px; height: 505px; float: none; border-style: none; border-style: none;" width=497 height=505 border=0></p>

<p class=A5><a name=Creating_the_Variables>Creating the Variables</a></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>After selecting the "Display an Xdialog Box" action script, the designer created 6 variables.</p>

</li> <ul style="list-style: disc;" type=disc> <li class=kadov-p-CBullet1><p class=Bullet1>ps2 - captures the output of the ((|#Designing_the_Property_Sheet_Dialog|Property Sheet dialog))</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>btnSave - saves the content of the controls on the property sheet</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>btnFirst - navigates to the first record in the table</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>btnPrev - navigates to the previous record in the table</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>btnNext - navigates to the next record in the table</p>

</li> <li class=kadov-p-CBullet1><p class=Bullet1>btnLast - navigates to the last record in the table</p>

</li> </ul> </ol><p class=A5><a name=Designing_the_Property_Sheet_Dialog>Designing the Property Sheet Dialog</a></p>

<p>To create the property sheet:</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>ps2</span> variable.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Control>Width</span> to 80 characters and <span class=Control>Height</span> to 25 lines.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Clicked <span class=Button>Define Property-Sheet Dialog</span> in the <span class=Control>Style</span> list to display the <span class=Screen>Initial Code</span> tab of the <span class=Screen>Property Sheet Builder</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Defined the following variables and Xbasic code. Note that the fields of the <span class=Code1>clients</span> table are child elements of the <span class=Code1>ptr</span> pointer variable. The Xbasic code reads the first record of the table and uses the <a href="/Server/Reference/Design/Api/Objects/Table/TBL.RECORD_TO_VARS Method.html" title="TBL.RECORD_TO_VARS Method" class="wiki">&lt;TBL&gt;.RECORD_TO_VARS(</a>)method to set the individual control values. The result is that the first record will appear when the dialog displays.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>dim ptr&nbsp;as&nbsp;P</p>

<p class=Code>dim ptr.customer_id&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.zip&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.state&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.city&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.address2&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.address1&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.lastname&nbsp;as&nbsp;c</p>

<p class=Code>dim ptr.firstname&nbsp;as&nbsp;c</p>

<p class=Code>dim tbl&nbsp;as&nbsp;P</p>

<p class=Code>tbl = table.open("clients")</p>

<p class=Code>tbl.order("lastname")</p>

<p class=Code>tbl.fetch_first()</p>

<p class=Code>tbl.record_to_vars(ptr)</td> </tr> </table> <ol start=5 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer then placed the appropriate <span class=Code1>clients</span> table fields into Edit controls on the <span class=Screen>Items</span> tab. For example, the field labelled "Address 1" was bound to the variable <span class=Code1>p.address1</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Clicked <span class=Button>OK</span> to conclude the property sheet design.</p>

</li> </ol><p>To create the <a name=Save_Record>Save Record</a> function:</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>btnSave</span> variable, selected "Button" in the <span class=Control>Style</span> list, and clicked <span class=Button>Define Button</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Selected "Picture only" in the <span class=Control>Button Style</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Image Name</span> control clicked <img src="images/Choose_Image_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and selected <img src="images/Save_Record_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and clicked <span class=Button>Insert</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Button Action</span> list selected "Run Xbasic".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Xbasic</span> edit control entered the following code. The <a href="/Api/Functions/Xbasic/Variable Functions/PROPERTY_RECURSE_ASSIGN Function.xml" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>)function copies the values of the <span class=Code1>ptr</span> dot variable to the <span class=Code1>tbl</span> dot variable.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.change_begin()</p>

<p class=Code>property_recurse_assign(tbl, ptr)</p>

<p class=Code>tbl.change_end(.t.)</td> </tr> </table> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>After Action</span> list selected "Keep Dialog Box Open".</p>

</li> </ol><p>To create the <a name=First_Record>First Record</a> function:</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>btnFirst</span> variable, selected "Button" in the <span class=Control>Style</span> list, and clicked <span class=Button>Define Button</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Selected "Picture only" in the <span class=Control>Button Style</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Image Name</span> control clicked <img src="images/Choose_Image_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and selected <img src="images/Move_First_Button_2.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and clicked <span class=Button>Insert</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Button Action</span> list selected "Run Xbasic".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Xbasic</span> edit control entered the following code. The <a href="/Api/Functions/Xbasic/Variable Functions/PROPERTY_RECURSE_ASSIGN Function.xml" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>)function copies the values of the <span class=Code1>ptr</span> dot variable to the <span class=Code1>tbl</span> dot variable.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.fetch_first()</p>

<p class=Code>tbl.record_to_vars()</td> </tr> </table> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>After Action</span> list selected "Keep Dialog Box Open".</p>

</li> </ol><p>To create the <a name=Previous_Record>Previous Record</a> function:</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>btnPrev</span> variable, selected "Button" in the <span class=Control>Style</span> list, and clicked <span class=Button>Define Button</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Selected "Picture only" in the Button Style list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Image Name</span> control clicked <img src="images/Choose_Image_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and selected <img src="images/Move_Previous_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and clicked <span class=Button>Insert</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Button Action</span> list selected "Run Xbasic".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Xbasic</span> edit control entered the following code. The <a href="/Api/Functions/Xbasic/Variable Functions/PROPERTY_RECURSE_ASSIGN Function.xml" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>)function copies the values of the <span class=Code1>ptr</span> dot variable to the <span class=Code1>tbl</span> dot variable.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.fetch_prev()</p>

<p class=Code>tbl.record_to_vars()</td> </tr> </table> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>After Action</span> list selected "Keep Dialog Box Open".</p>

</li> </ol><p>To create the <a name=Next_Record>Next Record</a> function:</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>btnNext</span> variable, selected "Button" in the <span class=Control>Style</span> list, and clicked <span class=Button>Define Button</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Selected "Picture only" in the <span class=Control>Button Style</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Image Name</span> control clicked <img src="images/Choose_Image_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and selected <img src="images/Move_Next_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and clicked <span class=Button>Insert</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Button Action</span> list selected "Run Xbasic".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Xbasic</span> edit control entered the following code. The <a href="/Api/Functions/Xbasic/Variable Functions/PROPERTY_RECURSE_ASSIGN Function.xml" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>)function copies the values of the <span class=Code1>ptr</span> dot variable to the <span class=Code1>tbl</span> dot variable.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.fetch_next()</p>

<p class=Code>tbl.record_to_vars()</td> </tr> </table> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>After Action</span> list selected "Keep Dialog Box Open".</p>

</li> </ol><p>To create the <a name=Last_Record>Last Record</a> function:</p>

<ol start=1 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected the <span class=Code1>btnLast</span> variable, selected "Button" in the <span class=Control>Style</span> list, and clicked <span class=Button>Define Button</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Selected "Picture only" in the Button Style list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Image Name</span> control clicked <img src="images/Choose_Image_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and selected <img src="images/Move_Last_Button_3.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> and clicked <span class=Button>Insert</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Button Action</span> list selected "Run Xbasic".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>Xbasic</span> edit control entered the following code. The <a href="/Api/Functions/Xbasic/Variable Functions/PROPERTY_RECURSE_ASSIGN Function.xml" title="PROPERTY_RECURSE_ASSIGN Function" class="wiki">PROPERTY_RECURSE_ASSIGN(</a>)function copies the values of the <span class=Code1>ptr</span> dot variable to the <span class=Code1>tbl</span> dot variable.</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.fetch_last()</p>

<p class=Code>tbl.record_to_vars()</td> </tr> </table> <ol start=6 style="list-style: decimal;" type=1> <li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Control>After Action</span> list selected "Keep Dialog Box Open".</p>

</li> </ol><p class=A5><a name=Finishing_the_Xdialog>Finishing the Xdialog</a></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>After completing the button definitions, the designer clicked <span class=Button>Next&nbsp;></span> to display the second screen of the <span class=Screen>Script Genie</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>The designer selected <span class=Button>Customize Xdialog</span> layout and modified the code from:</p>

</li> </ol>   <div align=center>  <table style="x-cell-content-align: top; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px; border-right-style: none; border-left-style: none; border-top-style: none; border-bottom-style: none;" valign="top">  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px;" valign="top"><p class=Code>{Region}</p>

<p class=Code>~Xdialog_heading~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{Region}</p>

<p class=Code>~ps2_label~:| ~ps2~;</p>

<p class=Code>| ~btnSave~;</p>

<p class=Code>| ~btnFirst~;</p>

<p class=Code>| ~btnPrev~;</p>

<p class=Code>| ~btnNext~;</p>

<p class=Code>| ~btnLast~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{Region}</p>

<p class=Code>~Xdialog_Footer~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{line=1,0};</p>

<p class=Code>~OK_Button~ ~Cancel_Button~;</td> </tr> </table><p>&nbsp;</td> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px; border-top-style: none; border-bottom-style: none; border-right-style: none;" valign="top"><p> <img src="images/XD_Bound_Prop_Sheet_1.gif" x-maintain-ratio=TRUE style="border: none; width: 171px; height: 201px; float: none; border-style: none; border-style: none;" width=171 height=201 border=0></td> </tr> </table>  </div> <p>to the following. The result was to reposition the buttons below the property sheet.</p>

  <div align=center>  <table style="x-cell-content-align: top; float: aligncenter; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <col> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px; border-right-style: none; border-left-style: none; border-top-style: none; border-bottom-style: none;" valign="top">  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; border-spacing: 0px; border-spacing: 0px;" cellspacing="0"> <col> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px;" valign="top"><p class=Code>{Region}</p>

<p class=Code>~Xdialog_heading~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{Region}</p>

<p class=Code>~ps2_label~:;</p>

<p class=Code>~ps2~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{region}</p>

<p class=Code>~btnSave~</p>

<p class=Code>|</p>

<p class=Code>~btnFirst~</p>

<p class=Code>~btnPrev~</p>

<p class=Code>~btnNext~</p>

<p class=Code>~btnLast~</p>

<p class=Code>{endregion};;</p>

<p class=Code>{Region}</p>

<p class=Code>~Xdialog_Footer~;</p>

<p class=Code>{Endregion};</p>

<p class=Code>{line=1,0};</p>

<p class=Code>~OK_Button~ ~Cancel_Button~;</td> </tr> </table><p>&nbsp;</td> <td style="x-cell-content-align: top; padding-right: 10px; padding-left: 10px; border-top-style: none; border-bottom-style: none; border-right-style: none;" valign="top"><p> <img src="images/XD_Bound_Prop_Sheet_2.gif" x-maintain-ratio=TRUE style="border: none; width: 171px; height: 203px; float: none; border-style: none; border-style: none;" width=171 height=203 border=0></td> </tr> </table>  </div> <p class=A5><a name=Finishing_the_Action_Script>Finishing the Action Script</a></p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>The designer added a <span class=Control>Title</span> for the dialog, then clicked <span class=Button>Next&nbsp;></span>, <span class=Button>Next&nbsp;></span>, and <span class=Button>Finish</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Finally, the designer clicked <span class=Button>Add New Action</span> and selected "Xbasic" from the <span class=Control>Category</span> list and "In-Line Xbasic" from the <span class=Control>Action</span> list.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>The window contains the code necessary to close the table when the action script ends. This is:</p>

</li> </ol>  <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>tbl.close()</td> </tr> </table><p class=A5>See Also</p>

<p> <a href="/Index/Property Sheets.html" title="Property Sheets" class="wiki">Property Sheets</a></p>


<p class=A5>Limitations</p>

<p>Desktop applications only</p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Populated+from+a+Table">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop, dbf","status":"pending","keywords":"desktop,tut,dbf"}--->
</body></html>