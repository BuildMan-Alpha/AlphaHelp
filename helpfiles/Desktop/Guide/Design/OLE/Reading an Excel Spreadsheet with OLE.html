	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Reading an Excel Spreadsheet with OLE</p>



<p>The following script shows how to read data from an <span class=Screen>Excel</span> 
 spreadsheet into a character array.</p>



<p>Create an array to receive the data. The array is 4 columns by 10 rows.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim ptr2[4,10]&nbsp;as&nbsp;C</p>


<p class=Code>get_excel_data("c:\spread\books.xls", ptr2)</td></tr>
</table>

<p>Open the spreadsheet and step through the cells.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>' Reads spreadsheet data into Data_Array</p>


<p class=Code>function get_excel_data&nbsp;as&nbsp;V (Filename&nbsp;as&nbsp;C, 
 First_Row&nbsp;as&nbsp;N, First_Col&nbsp;as&nbsp;N, Data_Array&nbsp;as&nbsp;P)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim MyObject&nbsp;as&nbsp;P</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim row&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim col&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim rows&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim cols&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim cell&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim temp&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cols = Data_Array.size(1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rows = Data_Array.size(2)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;on error goto quitting</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;MyObject = ole.getobject(Filename)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;for row = First_Row to First_Row 
 + rows</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for col = 
 First_Col to First_Col + cols</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell 
 = get_col(col) + row</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data_Array[row,col] 
 = MyObject.activesheet.Cells.Range(cell)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next col</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;next row</p>


<p class=Code>quitting:</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;MyObject.close()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;delete MyObject</p>


<p class=Code>end function</p>


<p class=Code>' Computes the column letter</p>


<p class=Code>function get_col&nbsp;as&nbsp;C (num&nbsp;as&nbsp;N)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim k&nbsp;as&nbsp;N</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim c1&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dim c2&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;k = int( mod(num/26,26) )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;c1 = if(k > 0, chr(k + 64), "")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;c2 = chr(num - (k * 26) + 64)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;get_col = ltrim(c1+c2)</p>


<p class=Code>end function</td></tr>
</table>

<p>If you do not know the data types of a returned value, you can check 
 it with this statement.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>typeof(Data_Array[row,col].value)</td></tr>
</table>

<p>The value returned will be "C" (character), "N" 
 (numeric), or "T" (date/time). If you want to preserve the format 
 of a date/time value, examine the value of : <span class=Code1>Data_Array[row,col].NumberFormat</span>.</p>



<p class=A5>See Also</p>



<p><a href="/Server/Reference/Design/Api/Objects/OLE/OLE and ActiveX Methods.html" title="OLE and ActiveX Methods" class="wiki">OLE and ActiveX Methods</a></p>


	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Reading+an+Excel+Spreadsheet+with+OLE">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","tags":"desktop","keywords":"desktop,guide,spreadsheet"}--->
</body></html>