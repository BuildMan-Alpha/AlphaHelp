	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Variable Scope</p>



<p>A variable does not exist until it is declared. When the script, form, 
 or session, in which it is declared, goes away, the variable leaves with 
 it (unless the variable was defined with a Global or Addin scope). The 
 duration of a variable definition, and the extent to which it is accessible 
 from other places, is called the variable's scope. The scope of a variable 
 can be local, layout, session, or global. A special kind of scope called 
 Addin is also available. Addin variables are primarily used by Alpha Five 
 itself.</p>




<table style="x-cell-content-align: Top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Scoping Level</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>dim keyword</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Variable exists while ?</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Global</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>GLOBAL</p>


<p class=TableLeft>(e.g. <span class=Code1>dim GLOBAL NAME&nbsp;as&nbsp;C</span> 
 )</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Alpha&nbsp;Five is running, until you close the current 
 database.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Session</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>SHARED</p>


<p class=TableLeft>(e.g.&nbsp; <span class=Code1>dim&nbsp;SHARED&nbsp;NAME&nbsp;as&nbsp;C</span> 
 )</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A window is open. Even if you change the layout that 
 is loaded in the window (by using the <span class=Button>File > Open?</span> 
 command from within the <span class=Screen>Form</span> or <span class=Screen>Browse</span> 
 window), the variable continues to exist.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Layout</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Cannot&nbsp;be&nbsp;declared using&nbsp;Xbasic</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The layout is open. If a different layout is loaded 
 in the window (by using the <span class=Button>File > Open?</span> 
 command from within the <span class=Screen>Form</span> or <span class=Screen>Browse</span> 
 window), the variable will disappear.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Local</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>(none)</p>


<p class=TableLeft>(e.g. <span class=Code1>dim NAME&nbsp;as&nbsp;C</span> 
 )</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>A script is executing.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Addin</td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Cannot be declared using Xbasic. Instead, must execute 
 these Xbasic commands:</p>


<p class=TableLeft><span class=Code1>dim AA&nbsp;as&nbsp;P</span></p>


<p class=TableLeft><span class=Code1>Aa&nbsp;=&nbsp;addin.variables()</span></p>


<p class=TableLeft><span class=Code1>aa.varname = value</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Alpha Five is running, even after you close a database 
 and switch to another database. In effect, an Addin variable is like a 
 "super-global" variable. Unlike a global variable, you must 
 reference an Addin variable by including an explicit pointer to the Addin 
 variable frame. E.g. aa.varname (were aa is a pointer to the Addin variable 
 frame)</td></tr>
</table>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									style="width: 37px;
											height: 33px;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Layout variables 
 cannot be declared in Xbasic. They are defined in the layout editor.</p>



<p class=Note><span class=Note><img src="images/icon_warning.gif"
									style="width: 37px;
											height: 33px;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : Character variables 
 behave a little differently than other variables.&nbsp;as&nbsp;a time 
 saving aide for you, if you assign a numeric, date, or logical variable 
 to a character variable, Alpha Five will automatically convert the value 
 to a character type.</p>



<p>A Session variable is visible to a form and all sub-forms and sub-browses 
 in that form. A Layout variable is only visible on the form for which 
 it is defined. For example, a layout variable defined on a form that is 
 used&nbsp;as&nbsp;a sub-form is not visible to the parent form. A Session 
 variable used on the sub-form is visible to the parent form.</p>



<p>A form can refer to another form's Layout or Shared variables by first 
 getting a pointer to the variables.&nbsp;See <a href="../../../../Reference/Design/View/Form/Getting a Pointer to Variables in a Different name-space.html" title="Getting a Pointer to Variables in a Different name-space" class="wiki">Getting   a Pointer to Variables in a Different name-space</a> for details.</p>



<p class=A5><a name=Declaring_Local_Variables>Declaring Local Variables</a></p>



<p>A variable that is implicitly declared in a script is valid only while 
 the script is running. When the script is done, the variable disappears 
 and is not available to other scripts or other parts of an application 
 (unless the script that creates the variables is executed using the <a href="/Server/Reference/Design/Api/Functions/Script Functions/SCRIPT_PLAY_LOCAL Function.html" title="SCRIPT_PLAY_LOCAL Function" class="wiki">SCRIPT_PLAY_LOCAL(</a>) function). 
 Variables of this sort are called local variables because they are restricted 
 to the context in which they are defined. Variables implicitly declared 
 within a user-defined function, or declared&nbsp;as&nbsp;function parameters, 
 are also local variables. These variables are available to only the function, 
 and are destroyed when the function is completed.</p>



<p class=A5><a name=Declaring_Session_and_Global_Variables>Declaring Session 
 and Global Variables</a></p>



<p>To extend the existence of a variable beyond the bounds of a script 
 or a user-defined function, you must explicitly declare it&nbsp;as&nbsp;a 
 global or session variable.</p>



<p>A session variable is available to any script within the current session. 
 A session is created when a layout window (e.g. a form, browse, report 
 etc.) window is first opened, or when an Operation is defined or run.</p>



<p>A global variable is available throughout Alpha Five. Any layout or 
 script can reference it. </p>



<p class=Pix><img src="images/Variable_Scope.gif"
					style="width: 605px;
							height: 273px;
							border-style: none;
							border-style: none;"
					width=605
					height=273
					border=0></p>



<p>To declare a session, or global variable in a script, use the dim SHARED 
 or dim GLOBAL statement at the start of the script or at any point before 
 the variable is actually used.</p>



<p>Global and session variables are also defined through a table or set 
 definition, or in the layout editors. You can also define global variables 
 using the View, Global Variables command in the <span class=Screen>Code 
 Editor</span>.</p>



<p class=A5><a name=Addin_Variables>Addin Variables</a></p>



<p>Addin variables are available between databases, within the same Alpha 
 Five session. See <a href="/Server/Reference/Design/Api/Objects/Addin/ADDIN.VARIABLES Method.html" title="ADDIN.VARIABLES Method" class="wiki">ADDIN.VARIABLES(</a>) 
 and <a href="../../View/Database/Using Addin Variables to Create a Multi-Database Application.html" title="Using Addin Variables to Create a Multi-Database Application" class="wiki">Using   Addin Variables to Create a Multi-Database Application</a>.</p>



<p class=A5><a name=Calculated_Fields>Calculated Fields</a></p>



<p>A calculated field is a value that is calculated when a record is entered 
 or changed. You may define a calculated field for a:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>table</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>set</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>layout</p>

</li>
</ul>

<p>Tables support two types of calculated fields:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Field based - which produce 
 and store a value in an existing field</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Virtual - which produce 
 values which may be placed on a layout or used for computations</p>

</li>
</ul>

<p>If you define a calculated field for a table or set, you can use it 
 in any layout or operation defined for that table or set. If you define 
 a calculated field for a layout, you can use it only on the layout for 
 which it is defined. The following illustration shows you the scope of 
 these fields. </p>



<p class=Pix><img src="images/UG_Calculated_Fields.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 225px;
							height: 159px;
							border-style: none;
							border-style: none;"
					width=225
					height=159
					border=0></p>



<p>You can create a <span class=Bolded>Virtual Calculated Field</span> 
 by clicking <img src="images/Calc_Fields_button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 22px;
							height: 22px;
							float: none;
							border-style: none;
							border-style: none;"
					width=22
					height=22
					border=0> when designing a table, set, or layout. You 
 can only create a <span class=Bolded>Field Based Calculated Field</span> 
 in <a href="../References/Desktop/Field Rules__COLON__ Field Types.html#Calculated_Fields" title="Field Rules: Field Types" class="wiki">Field   Rules</a>. In all cases you can place one of these calculated fields on 
 a layout.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : Only field based 
 calculated fields are stored in a table.</p>



<p>Calculated fields can be used on layouts to display the results of a 
 calculation. For example, you might place a calculation at the bottom 
 of a sales report to display total sales. Calculated fields are also used 
 to conserve disk-space by eliminating the storage of easily-derived information. 
 For example, if you have a table of products in which you have a <span 
 class=Code1>Cost</span> field and a <span class=Code1>Quantity</span> 
 field, you can create a calculated field for the table that multiplies 
 <span class=Code1>Cost</span> and <span class=Code1>Quantity</span> with 
 the expression <span class=Code1>Cost * Quantity</span>. When you create 
 a layout or operation for the table, you can use the calculated field 
 just&nbsp;as&nbsp;you would any other field.</p>



<p class=A5><a name=Pointers___More_Information>Pointers - More Information</a></p>



<p>A pointer variable is a way of uniquely identifying any object or window 
 in Alpha Five.</p>



<p>By assigning a pointer to the window that is created when the form or 
 browse is opened, you can then execute other commands later in your script 
 that do different things to this window, or to objects contained within 
 this window.</p>



<p>For example, assume you select the <a href="../../View/Browse/Open Form or Browse Layout.html" title="Open Form or Browse Layout" class="wiki">Open   a Form or Browse Layout</a> action. In defining this action, you assign 
 a pointer called <span class=Code1>varP_window1</span> to the window that 
 will be opened by this command. Later in your script, you may want to 
 do things like:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Set the value in a field 
 in this window</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Change the appearance of 
 some text in this window</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Hide an object in this 
 window</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Enter a new record in this 
 window</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Close this window</p>

</li>
</ul>

<p>In all cases, you will need to be able to specify which of several possible 
 different open windows you are referring to. By specifying the pointer 
 variable <span class=Code1>varP_window1</span>, you will be able to uniquely 
 identify this window.</p>



<p class=A5>Examples</p>




<table class="codeTable" style="x-cell-content-align: Top;
				border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-style: Solid;
			border-top-width: 1px;
			border-top-style: Solid;
			border-bottom-width: 1px;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-right-style: Solid;" valign="top" width="100%">
<p class=Code>'Code in Button1 on a form</p>


<p class=Code>dim vName&nbsp;as&nbsp;C</p>


<p class=Code>vName = "Fred"</p>


<p class=Code>'Code in Button2 on a form</p>


<p class=Code>ui_msg_box("Name is", vName)</td></tr>
</table>

<p>When you press Button2 (after pressing Button1), you get an error message 
 because <span class=Code1>vName</span> is a local variable. Even though 
 its value was set in Button1, it is undefined&nbsp;as&nbsp;far&nbsp;as&nbsp;the 
 script attached to Button2 is concerned.</p>




<table class="codeTable" style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				x-cell-content-align: Center;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col style="width: 100%;">

<tr style="x-cell-content-align: center;" valign="middle">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-style: Solid;
			border-top-width: 1px;
			border-top-style: Solid;
			border-bottom-width: 1px;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-right-style: Solid;" valign="top" width="100%">
<p class=Code>'Code in Button1 on a form</p>


<p class=Code>dim SHARED vName&nbsp;as&nbsp;C</p>


<p class=Code>vName = "Fred"</p>


<p class=Code>'Code in Button2 on a form</p>


<p class=Code>dim SHARED vName&nbsp;as&nbsp;C</p>


<p class=Code>ui_msg_box("Name is", vName)</td></tr>
</table>

<p>In this case, when you press Button2 (after pressing Button1), the script 
 works and the message box is displayed. This is because Button1 defined 
 <span class=Code1>vName</span>&nbsp;as&nbsp;a shared variable, available 
 to all of the scripts in the session.</p>



<p>Declaring an addin variable in a two-step process.</p>




<table class="codeTable" style="border-left-style: none;
				border-right-style: none;
				border-top-style: none;
				border-bottom-style: none;
				x-cell-content-align: Center;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col style="width: 100%;">

<tr style="x-cell-content-align: center;" valign="middle">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;
			border-left-width: 1px;
			border-left-style: Solid;
			border-top-width: 1px;
			border-top-style: Solid;
			border-bottom-width: 1px;
			border-bottom-style: Solid;
			border-right-width: 1px;
			border-right-style: Solid;" valign="top" width="100%">
<p class=Code>dim a&nbsp;as&nbsp;P</p>


<p class=Code>dim a.myvar&nbsp;as&nbsp;C</p>


<p class=Code>a = addin.variables()</p>


<p class=Code>a.myvar = "do not stop Alpha Five or you will lose this!"</td></tr>
</table>

<p class=A5>Warnings on Scope of Variables Conflicts</p>



<p>If an Xbasic script overrides the scope of a variable, Alpha Five issues 
 a warning in the <span class=Screen>Trace</span> window. For example, 
 you may have defined a variable on a form and set its scope to Layout. 
 Then, you may have defined an event script on the form that defined a 
 variable of the same name, but at a different scope.</p>



<p class=A5><a name=Variable_Persistence>Variable Persistence</a></p>



<p>The following illustration courtesy of Marcel Kollenaar and Peter Greulich. 
 </p>



<p class=Pix><img src="images/Variable_Persistence.gif"
					style="width: 669px;
							height: 475px;
							border-style: none;
							border-style: none;"
					width=669
					height=475
					border=0></p>



<p class=A5>See Also</p>



<p><a href="/Server/Reference/Design/Platform/Xbasic/Reference/What is a Variable__QUESTION__.html" title="What is a Variable?" class="wiki">What is a Variable?</a>, <a href="/Server/Reference/Design/Platform/Xbasic/Variable Data Types.html" title="Variable Data Types" class="wiki">Variable   Data Types</a>, <a href="/Server/Reference/Design/Api/Functions/Variable Functions/LOCAL_VARIABLES Function.html" title="LOCAL_VARIABLES Function" class="wiki">LOCAL_VARIABLES(</a>), 
 <a href="/Server/Reference/Design/Api/Functions/Variable Functions/GLOBAL_VARIABLES Function.html" title="GLOBAL_VARIABLES Function" class="wiki">GLOBAL_VARIABLES(</a>), 
 <a href="/Server/Reference/Design/Api/Functions/Variable Functions/SESSION_VARIABLES Function.html" title="SESSION_VARIABLES Function" class="wiki">SESSION_VARIABLES(</a>), 
 <a href="../../Data/FieldRules/Using the Fields Panel.html" title="Using the Fields Panel" class="wiki">Drag-and-Drop   List</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Variable+Scope">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","tags":"desktop, review","keywords":"desktop,guide,xbasic","notes":"Alpha 5"}--->
</body></html>