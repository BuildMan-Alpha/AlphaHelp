	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Ending the AlphaSports Application</p>
<p class=A5>Overview</p>
<p>The <span class=Code1>CanExit</span> event provides the developer with 
 a way to intercept a close form (and, in this case, exit application) 
 command, and then:</p>
<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>accept the close 
 command</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>reject the close 
 command</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>run other routines 
 before accepting or rejecting the close command</p>

</li>
</ol>

<p>There are five different ways that the user can exit from the application:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Button>Close</span> 
 button on the <span class=Code1>MainMenu</span> toolbar.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Button>Exit 
 AlphaSports</span> button on the <span class=Code1>MainMenu</span> toolbar.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Button>Close 
 (X)</span> function in the Control - Menu Box in the upper left corner 
 of the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <img src="images/Close_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> button in the upper right corner of the form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The <span class=Code1>OnPush</span> 
 event of the exit door icon on the form, which runs the <span class=Code1>exit_application</span> 
 script. </p>

</li>
</ol>

<p class=Pix><img src="images/AL_exiting_alpha_sports_2.gif"
					style="width: 451px;
							height: 593px;
							border-style: none;
							border-style: none;"
					width=451
					height=593
					border=0></p>



<p class=A5>MainMenu Menu</p>



<p>The <span class=Button>Close</span> button on the <span class=Code1>MainMenu</span> 
 menu executes the line of code shown below. The context of the command 
 is the currently active form, which is the Main Menu.&nbsp;as&nbsp;a result, 
 the word "THIS" refers to the Main Menu.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>THIS.CLOSE()</td></tr>
</table>

<p class=A5>Xbasic Code Run by the Exit AlphaSports Button <a NAME=MainMenu_Toolbar></a></p>



<p>The <span class=Button>Exit AlphaSports</span> button on the <span class=Code1>MainMenu</span> 
 toolbar runs the following Xbasic code.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>close_all_windows(.f.)</p>


<p class=Code>ControlPanel.show()</p>


<p class=Code>controlpanel.activate()</p>


<p class=Code>this.close()</td></tr>
</table>

<p class=A5>An Explanation of the Xbasic Code</p>



<p>The first line uses the close_all_windows(<a href="tiki-editpage.php?page=+Ending+the+AlphaSports+Application" title="Create page:  Ending the AlphaSports Application" class="wiki wikinew">?</a>) 
 function to close any open forms, including the Main Menu.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>close_all_windows(.f.)</td></tr>
</table>

<p>The next line shows the <span class=Screen>Control Panel</span>. We 
 want you to see it, but your application might want to hide the <span 
 class=Screen>Control Panel</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ControlPanel.show()</td></tr>
</table>

<p>Next, give the <span class=Screen>Control Panel</span> focus so it responds 
 to user input.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>controlpanel.activate()</td></tr>
</table>

<p>Finally, close the <span class=Code1>MainMenu</span> toolbar.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>this.close()</td></tr>
</table>

<p class=A5>Main Menu CanExit Event <a NAME=Main_Menu_CanExit_Event></a></p>



<p>The CanExit event intercepts the form's <span class=Button>Close </span>button 
 function and provides an opportunity to cancel the close. This single 
 line of code calls the <span class=Code1>close_all_windows()</span> function, 
 which asks the user if he wants to continue with or cancel the close action. 
 Refer to the <a href="Ending the AlphaSports Application.html#close_all_windows___Function" title="Ending the AlphaSports Application" class="wiki">close_all_windows function</a>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>close_all_windows()</td></tr>
</table>

<p class=A5>Xbasic Code Run by the Main Menu OnExit Event <a NAME=Main_Menu_OnExit_Event></a></p>



<p>The <span class=Code1>OnExit</span> event closes the Navigation toolbar, 
 if it is still open, and then displays the <span class=Screen>Control 
 Panel</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (eval_valid("vcToolbarName")) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (ui_modeless_dlg_exist(vcToolbarName)) 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(vcToolbarName)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</p>


<p class=Code>controlpanel.show()</td></tr>
</table>

<p class=A5>An Explanation of the Xbasic Code</p>



<p>The first line of code uses the <span class=Code1>eval_valid()</span> 
 function to test if the <span class=Code1>vcToolbarName</span> variable 
 exists. The <span class=Code1>eval_valid()</span> function will return 
 <span class=Code1>false</span> if the <span class=Code1>vcToolbarName</span> 
 shared variable was not created or went out of scope.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if (eval_valid("vcToolbarName")) then</td></tr>
</table>

<p>Double check by directly asking if the toolbar is open with the <span 
 class=Code1>ui_modeless_dlg_exist()</span> function.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (ui_modeless_dlg_exist(vcToolbarName)) 
 then</td></tr>
</table>

<p>If the answer is <span class=Code1>true</span>, close the toolbar with 
 the <span class=Code1>ui_modeless_dlg_close()</span> function.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close(vcToolbarName)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end if</td></tr>
</table>

<p>Now display the <span class=Screen>Control Panel</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>controlpanel.show()</td></tr>
</table>

<p class=A5>Bar1 OnPush Event <a NAME=Bar1_OnPush_Event></a></p>



<p>The <span class=Code1>OnPush</span> event of the Bar1 graphic runs the 
 <span class=Code1>exit_application</span> script, which has five steps.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Step one contains 
 inline Xbasic. The form contains two versions of the bitmaps displayed 
 at the lower right corner of the form. The version on the top (Bar1) contains 
 the image of the open door. The version on the bottom (Bar2) contains 
 the image of the closed door.</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code><span class=Code1>' Hide the open door</span></p>


	<p class=Code>Bar1.hide()</p>


	<p class=Code><span class=Code1>' Display the closed door</span></p>


	<p class=Code>Bar2.show()</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Steps two is an Action 
 Script that displays a message box to confirm that the user wants to exit 
 the application. It sets the variable <span class=Code1>exit_YES_Button</span> 
 to .T. or sets the variable <span class=Code1>exit_NO_Button</span> to 
 <span class=Code1>.T.</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Step 3 contains inline 
 Xbasic that runs if the <span class=Code1>exit_NO_Button</span> value 
 is <span class=Code1>.T.</span>.</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code><span class=Code1>' Show the open door</span></p>


	<p class=Code>Bar1.show()</p>


	<p class=Code><span class=Code1>' Hide the closed door</span></p>


	<p class=Code>Bar2.hide()</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Step 4 contains inline 
 Xbasic that runs if the <span class=Code1>exit_YES_Button</span> value 
 is <span class=Code1>.T.</span>.</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>close_all_windows(.f.)</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Step 5 is an Action 
 Script that closes the current form.</p>

</li>
</ol>

<p class=A5>close_all_windows() function <a NAME=close_all_windows___Function></a></p>



<p>The <span class=Code1>close_all_windows()</span> ' function asks the 
 user if wants to continue with or cancel the close.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function close_all_windows&nbsp;as&nbsp;C (prompt = .t.)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = "Close all open windows 
 before ending the application?"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (prompt = .t.) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_close = 
 ui_msg_box("AlphaSports", msg, UI_YES_NO_CANCEL + ui_question_symbol)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_close = 
 ui_yes_selected</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (q_close = ui_yes_selected) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_windows 
 = a5_list_open_windows()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_window 
 = topparent.name()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_windows 
 = word_subtract(open_windows, \</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_window, 
 crlf())</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd = *for_each(x, 
 x + ".close()", open_windows)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(cmd)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else if (q_close = ui_cancel_selected) 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end function</td></tr>
</table>

<p class=A5>An Explanation of the close_all_windows() function</p>



<p>The function optionally receives a variable named <span class=Code1>prompt</span>&nbsp;as&nbsp;an 
 argument. If the argument is not received, it has a default value of <span 
 class=Code1>true</span> ( <span class=Code1>.t.</span> ).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function close_all_windows&nbsp;as&nbsp;C (prompt = .t.)</td></tr>
</table>

<p>Define a message that we might use later.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;msg = "Close all open windows 
 before ending the application?"</td></tr>
</table>

<p>If the value of <span class=Code1>prompt</span> is <span class=Code1>true</span>, 
 then display this message with three options: yes, no, or cancel.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (prompt = .t.) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_close = 
 ui_msg_box("AlphaSports", msg, UI_YES_NO_CANCEL + ui_question_symbol)</td></tr>
</table>

<p>If the value of <span class=Code1>prompt</span> passed to the function 
 is <span class=Code1>false</span> ( <span class=Code1>.f.</span> ), then 
 ignore the user's action and force the answer to be YES.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_close = 
 ui_yes_selected</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</td></tr>
</table>

<p>If the answer was yes, then user the <span class=Code1>a5_list_open_windows()</span> 
 function returns a list of all open windows.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;if (q_close = ui_yes_selected) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_windows 
 = a5_list_open_windows()</td></tr>
</table>

<p>Get the name of the Main Menu form.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_window 
 = topparent.name()</td></tr>
</table>

<p>Remove the Main Menu from the list.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open_windows 
 = word_subtract(open_windows, current_window, crlf())</td></tr>
</table>

<p>Generate the Xbasic command that will close all of the open windows.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd = *for_each(x, 
 x + ".close()", open_windows)</td></tr>
</table>

<p>Now execute the Xbasic command constructed above.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evaluate_template(cmd)</td></tr>
</table>

<p>If the answer was cancel, use the cancel()command to abort the close.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;else if (q_close = ui_cancel_selected) 
 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end function</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="../../View/Xdialog/Controls/Creating the Navigation Toolbar.html" title="Creating the Navigation Toolbar" class="wiki">Creating the Navigation   Toolbar</a>, <a href="../../View/Form/Displaying the Main Menu.html" title="Displaying the Main Menu" class="wiki">Displaying the Main   Menu</a>, <a href="../../View/Xdialog/Controls/Displaying the Navigation Toolbar.html" title="Displaying the Navigation Toolbar" class="wiki">Displaying the   Navigation Toolbar</a>, <a href="../../View/Control Panel/Starting the AlphaSports Application.html" title="Starting the AlphaSports Application" class="wiki">Starting   the AlphaSports Application</a>, <a href="../../View/Form/The Main Menu Form.html" title="The Main Menu Form" class="wiki">The   Main Menu Form</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Ending+the+AlphaSports+Application">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop,review","status":"pending","notes":"Alpha Sports","keywords":"desktop,guide,xbasic"}--->
</body></html>