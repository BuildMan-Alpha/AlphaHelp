	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Global (User Defined) Functions</p>



<p>Like the properties and methods and events of objects, the functions 
 you saw in the previous section are all built-in to Alpha Four. Like object 
 methods, you can call a function to accomplish a pre-designated task.&nbsp;Object 
 events, however, you can define yourself.&nbsp;You control what happens 
 when you write Xbasic code for an object event.</p>



<p>Similarly, you can define your own functions by writing Xbasic code. 
 But unlike object events, which are already named, you can name your own 
 functions.&nbsp;Once created you can call on that function to accomplish 
 something that you need to repeat.&nbsp;It does not make sense to create 
 a function that is only used once for a very specific task.&nbsp;When 
 you have to manipulate data in a custom way that is not provided by a 
 pre-built Xbasic function and you have to do it over and over, that is 
 the time to create your own function.</p>



<p>Once a function is created and named, it becomes part of your own Alpha 
Anywhere set of functions.&nbsp;You have previously seen that one of the selections 
 for function categories is User Defined.&nbsp;These functions are also 
 called global functions.&nbsp;Once created, they are available to be used 
 in any of your Alpha Anywhere applications.</p>



<p>A global function is like an Xbasic command of your own creation. It 
 has a name, it can accept parameters and it can (optionally) return a 
 value.&nbsp;Global functions have to meet certain criteria in order to 
 function correctly.&nbsp;Alpha Anywhere makes it easy to build-your-own functions.</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>A new function must be created with a function name, 
 a return type, and optional arguments&nbsp;as&nbsp;shown in a section 
 of the <span class=Screen>Create New Function</span> window shown below: 
  
 </p>


<p class=Pix><img src="images/LB_Figure_66.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 288px;
							height: 280px;
							float: none;
							border-style: none;
							border-style: none;"
					width=288
					height=280
					border=0></p>


<p class=PixCaption>Figure 66</p>


<p>Any parameters specified must be provided when the function is invoked. 
 These parameters become local variables available to the Xbasic code that 
 makes up the function.</td></tr>
</table>

<p>Let's take a quick look at a global function written for the <span class=Screen>Its 
 For You</span> application.</p>



<p>The Its For You application stores the names of message takers and receivers 
 in the <span class=Code1>message_tr</span> table.&nbsp;This table shows 
 the fields from <span class=Code1>message_tr</span> that store a persons 
 name data along with a sample record from the table.</p>




<div align=center>
<table style="x-cell-content-align: top;
				width: 41.829%;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="41.829%">
<col style="width: 36.817%;">
<col style="width: 27.527%;">
<col style="width: 13.046%;">
<col style="width: 22.61%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;
			border-top-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_Salutation</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-bottom-style: None;
			border-right-style: None;
			border-top-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-bottom-style: None;
			border-right-style: None;
			border-top-style: None;" valign="top" width="13.046%">
<p class=TableLeft>15</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-top-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>Dr.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_First_Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="13.046%">
<p class=TableLeft>15</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>Suzanne</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_Middle_Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="13.046%">
<p class=TableLeft>15</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>M.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_Last_Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="13.046%">
<p class=TableLeft>20</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>Lainson</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_Suffix</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="13.046%">
<p class=TableLeft>10</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>M.D.</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 36.817%;
			border-right-style: None;
			border-left-style: None;
			border-bottom-style: None;" valign="top" width="36.817%">
<p class=TableLeft>Tr_Familiar</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 27.527%;
			border-right-style: None;
			border-bottom-style: None;" valign="top" width="27.527%">
<p class=TableLeft>Character</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 13.046%;
			border-right-style: None;
			border-bottom-style: None;" valign="top" width="13.046%">
<p class=TableLeft>15</td>
<td class="TableCell" style="x-cell-content-align: top;
			width: 22.61%;
			border-bottom-style: None;
			border-right-style: None;" valign="top" width="22.61%">
<p class=TableLeft>Sue</td></tr>
</table>
</div>
<p>In the <span class=Screen>Its For You</span> application, a persons 
 name is used in selection lists, reports and input forms.&nbsp;There are 
 multiple ways to format a persons name from the available data fields. 
 For example, for the data above, you might want to use the name in the 
 following formats:</p>




<div align=center>
<table style="x-cell-content-align: top;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>
<col>

<tr style="x-cell-content-align: top;" valign="top">
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Format</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Result</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Fields Used to Express Result</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top">
<p class=TableLeft>Familiar Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Sue Lainson</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Tr_Familiar, Tr_Lastname</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top">
<p class=TableLeft>Formal Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Dr. Suzanne M. Lainson</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Tr_Salutation, Tr_First_Name, Tr_Middle_Name, Tr_Last_Name, 
 Tr_Suffix</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;
			border-left-style: None;" valign="top">
<p class=TableLeft>Trimmed Name</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Suzanne Lainson</td>
<td class="TableCell" style="x-cell-content-align: top;
			border-bottom-style: None;
			border-right-style: None;" valign="top">
<p class=TableLeft>Tr_FirstName, Tr_LastName</td></tr>
</table>
</div>
<p>The <span class=Screen>Its For You</span> application includes three 
 functions that return formatted strings&nbsp;as&nbsp;Per the above table. 
 The first lines of the Xbasic code that defines these functions are shown 
 below:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>FUNCTION fullfamiliarname&nbsp;as&nbsp;C (familiar&nbsp;as&nbsp;C, 
 lastname&nbsp;as&nbsp;C )</p>


<p class=Code>FUNCTION fullformalname&nbsp;as&nbsp;C (salutation&nbsp;as&nbsp;C, 
 firstname&nbsp;as&nbsp;C, middlename&nbsp;as&nbsp;C, lastname&nbsp;as&nbsp;C, 
 suffix&nbsp;as&nbsp;C)</p>


<p class=Code>FUNCTION trimmedName&nbsp;as&nbsp;C (firstName&nbsp;as&nbsp;C, 
 lastName&nbsp;as&nbsp;C )&nbsp;</td></tr>
</table>

<p>The full function code for <span class=Code1>fullfamiliarname()</span> 
 is shown below: </p>



<p class=Pix><img src="images/LB_Figure_67.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 531px;
							height: 71px;
							float: none;
							border-style: none;
							border-style: none;"
					width=531
					height=71
					border=0></p>



<p class=PixCaption>Figure 67</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>In order to properly return a value to the script or 
 expression that invokes a function, the function name itself must be set 
 to the value you wish returned. In this function the variable <span class=Code1>fullfamiliarname</span> 
 (which is the same&nbsp;as&nbsp;the function name) is assigned the formatted 
 name string.</td></tr>
</table>

<p>This function take two character string parameters&nbsp;as&nbsp;inputs 
 (they are local variables named <span class=Code1>familiar</span> and 
 <span class=Code1>lastname</span> ). It applies the <span class=Code1>alltrim()</span> 
 built-in function to each string to trim off leading and trailing blanks 
 and then combines these values with one blank space to return a formatted 
 name.&nbsp;This name string is assigned to the variable <span class=Code1>fullfamiliarname</span>. 
 It is returned to the expression that invoked the function.</p>



<p>The function <span class=Code1>fullfamiliarname()</span> can be called 
 from any expression in Alpha Anywhere.&nbsp;Here is an example of it being 
 called from the <span class=Screen>Interactive</span> window: </p>



<p class=Pix><img src="images/LB_Figure_68.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 425px;
							height: 67px;
							border-style: none;
							border-style: none;"
					width=425
					height=67
					border=0></p>



<p>Two character strings,&nbsp;"Penelope " and "&nbsp;&nbsp;&nbsp;&nbsp;Snodgrass" 
 , are input to the function and the formatted name string is output to 
 the screen.</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>Three calculated fields are defined that are displayed 
 on the <span class=Screen>Adiministration</span> form. These calculated 
 fields, in turn, each call one of the functions: <span class=Code1>fullfamiliarname()</span>, 
 <span class=Code1>fullformalname()</span>, and <span class=Code1>trimmedName()</span>.</td></tr>
</table>

<p>In the <span class=Screen>Administration</span> form of the <span class=Screen>Its 
 For You</span> application, three fields on the screen display formatted 
 versions of the users name. Below, you see the <span class=Screen>Calculated 
 Fields</span> dialog box superimposed over the <span class=Screen>Administration</span> 
 form. </p>



<p class=Pix><img src="images/LB_Figure_69.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 657px;
							height: 303px;
							float: none;
							border-style: none;
							border-style: none;"
					width=657
					height=303
					border=0></p>



<p class=PixCaption>Figure 69</p>




<table class="calloutTable" style="x-cell-content-align: top;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td class="TableCell" style="x-cell-content-align: top;
			width: 100%;
			border-top-style: Solid;
			border-top-width: 1px;
			border-right-width: 1px;
			border-right-style: Solid;
			border-bottom-style: Solid;
			border-bottom-width: 1px;
			border-left-style: none;" valign="top" width="100%">
<p class=TableLeft>In this exercise you will create function to take a 
 <span class=Code1>firstname</span> and <span class=Code1>lastname</span> 
 character strings and a logical value if that person is an <span class=Code1>admin</span>. 
 If the person is an <span class=Code1>admin</span> then a string will 
 be returned showing the full name followed by the string "(Admin)". 
 If the person is not an <span class=Code1>admin</span> only the full name 
 will appear.</td></tr>
</table>

<p class=A5><a name=Exercise_14___Defining_a_new_Global_Function>Exercise 
 14 - Defining a new Global Function</a></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on the <span 
 class=Button>Code</span> tab of the <span class=Screen>Control Panel</span> 
 window.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click on the <span 
 class=Button>New</span> button and then choose <span class=Button>Function</span> 
 shown in figure 70. </p>

</li>
</ol>

<p class=Pix><img src="images/LB_Figure_70.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 226px;
							height: 222px;
							float: none;
							border-style: none;
							border-style: none;"
					width=226
					height=222
					border=0></p>



<p class=PixCaption>Figure 70</p>



<ol start=3>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>For the Function 
 Name enter:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>fnadmin</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Leave the <span class=Control>Return 
 Type</span>&nbsp;as&nbsp;"Character".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 three arguments (parameters) for the function: </p>

</li>
	
	
	<div align=center>
	<table style="x-cell-content-align: top;
					float: aligncenter;
					width: 15.943%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="15.943%">
	<col style="width: 40.682%;">
	<col style="width: 59.318%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 40.682%;
				border-bottom-style: None;
				border-right-style: None;
				border-left-style: None;
				border-top-style: None;" valign="top" width="40.682%">
	<p class=TableLeft><span class=Code1>fname</span></td>
	<td class="TableCell" style="x-cell-content-align: top;
				width: 59.318%;
				border-bottom-style: None;
				border-right-style: None;
				border-top-style: None;" valign="top" width="59.318%">
	<p class=TableLeft>Character</td></tr>
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 40.682%;
				border-bottom-style: None;
				border-right-style: None;
				border-left-style: None;" valign="top" width="40.682%">
	<p class=TableLeft><span class=Code1>lname</span></td>
	<td class="TableCell" style="x-cell-content-align: top;
				width: 59.318%;
				border-bottom-style: None;
				border-right-style: None;" valign="top" width="59.318%">
	<p class=TableLeft>Character</td></tr>
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 40.682%;
				border-bottom-style: None;
				border-right-style: None;
				border-left-style: None;" valign="top" width="40.682%">
	<p class=TableLeft><span class=Code1>admin</span></td>
	<td class="TableCell" style="x-cell-content-align: top;
				width: 59.318%;
				border-bottom-style: None;
				border-right-style: None;" valign="top" width="59.318%">
	<p class=TableLeft>Logical</td></tr>
	</table>
	</div>
	<p class=Pix><img src="images/LB_Figure_71.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 295px;
								height: 318px;
								float: none;
								border-style: none;
								border-style: none;"
						width=295
						height=318
						border=0></p>


	
	<p class=PixCaption>Figure 71</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>OK</span> 
 to&nbsp;save the function definition. Alpha Anywhere opens the <span class=Screen>Code 
 Editor</span> and displays a prototype of the function.&nbsp;A prototype 
 is the shell of a function without any Xbasic commands to process it. 
 The prototype tells you what type of value the functions returns and what 
 parameters (and parameter types) the function expects&nbsp;as&nbsp;input. 
 </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_72.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 505px;
								height: 56px;
								float: none;
								border-style: none;
								border-style: none;"
						width=505
						height=56
						border=0></p>


	
	<p class=PixCaption>Figure 72</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 100%;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>Alpha Anywhere adds an open and close parenthesis to 
 the function name to differentiate a function from a script.</td></tr>
	</table>
	
	<p class=BlankLine>&nbsp;</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 100%;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>The <span class=Code1>FUNCTION</span> command opens 
 with the word <span class=Code1>FUNCTION</span> followed by the name, 
 the word <span class=Code1>AS</span>, and the type of the return value. 
 Next is a parentheses, any parameters (expressed&nbsp;as&nbsp;Parameter 
 name, the word AS, and the type of the parameter), a comma to separate 
 multiple parameters, and a closing parentheses. (If there are no input 
 parameters, you still need the open and close parentheses.) </p>


	<p>Next comes your code. Remember, in order for the function to return 
 a value to the calling expression, you must assign that value to a variable 
 with the same name&nbsp;as&nbsp;the function. Finally, the function definition 
 ends with the <span class=Code1>END</span> <span class=Code1>FUNCTION</span> 
 command.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 four lines between the <span class=Code1>FUNCTION ...</span> and <span 
 class=Code1>END FUNCTION</span> lines.</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>fnadmin = alltrim(fname) + " " + alltrim(lname)</p>


	<p class=Code>if admin then</p>


	<p class=Code>&nbsp;&nbsp;&nbsp;fnadmin = fnadmin + "(Admin)"</p>


	<p class=Code>end if</td></tr>
	</table>
	
	<p class=BlankLine>&nbsp;</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 100%;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>When you press <span class=Button>Enter</span> after 
 typing the line <span class=Code1>if admin then</span>, Alpha Anywhere will 
 automatically create the line <span class=Code1>end if</span> for you.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Code 
 > Check Syntax</span>. You should see this: </p>

</li>
	
	<li class=kadov-p-CPix>
	<p class=Pix><img src="images/LB_Figure_72a.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 195px;
								height: 133px;
								float: none;
								border-style: none;
								border-style: none;"
						width=195
						height=133
						border=0></p>


	
	<p>Alpha Anywhere can check that the syntax of your script is correct. 
 This is not the same&nbsp;as&nbsp;a logic check.&nbsp;A syntax check means 
 that you typed in the Xbasic commands the correct way and that all the 
 expressions make sense.&nbsp;Whether they give you the result you really 
 want is up to you to judge.</p>


	</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Delete the word "FUNCTION" 
 from the last line of the script and select <span class=Button>Code > 
 Check Syntax</span>. </p>

</li>
	
	<p class=Pix><img src="images/LB_Figure_72b.gif"
						x-maintain-ratio=TRUE
						style="border: none;
								width: 236px;
								height: 126px;
								float: none;
								border-style: none;
								border-style: none;"
						width=236
						height=126
						border=0></p>


	
	<p>Alpha Anywhere responds with an error pop-up message indicating the 
 Xbasic command <span class=Code1>FUNCTION...END FUNCTION</span> is incomplete.</p>


	
	<li class=kadov-p-CListNumber><p class=ListNumber>Put the word "FUNCTION" 
 back in.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press <span class=Button>Save</span> 
 to save the function.</p>

</li>
	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 100%;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>After you save the function in Step 11, the * (asterisk) 
 next to the function name in the <span class=Screen>Code Editor</span> 
 tab will be gone. Whenever an * appears next to a script name in the editor, 
 it indicates you have made changes to that script that you have not yet 
 saved.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Press the <span class=Button>Interactive</span> 
 tab to see the <span class=Screen>Interactive</span> window.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following 
 commands:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>dim name1&nbsp;as&nbsp;C</p>


	<p class=Code>dim name2&nbsp;as&nbsp;C</p>


	<p class=Code>dim is_an_admin&nbsp;as&nbsp;L</p>


	<p class=Code>name1 = " George"</p>


	<p class=Code>name2 = "Michael "</p>


	<p class=Code>is_an_admin = .T.</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Now enter the following:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>? fnadmin(name1, name2, is_an_admin)&nbsp;</td></tr>
	</table>
	
	<p>Alpha Anywhere replies with:</p>


	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>= George Michael (Admin)&nbsp;</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter the following:</p>

</li>
	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>is_an_admin = .F.</p>


	<p class=Code>? fnadmin(name2, name1, is_an_admin)&nbsp;</td></tr>
	</table>
	
	<p class=BlankLine>&nbsp;</p>


	
	
	<table class="calloutTable" style="x-cell-content-align: top;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td class="TableCell" style="x-cell-content-align: top;
				width: 100%;
				border-top-style: Solid;
				border-top-width: 1px;
				border-right-width: 1px;
				border-right-style: Solid;
				border-bottom-style: Solid;
				border-bottom-width: 1px;
				border-left-style: none;" valign="top" width="100%">
	<p class=TableLeft>In this invocation of the <span class=Code1>fnadmin()</span> 
 function, <span class=Code1>name2</span> is given&nbsp;as&nbsp;the first 
 parameter and <span class=Code1>name1</span>&nbsp;as&nbsp;the second. 
 The function does not care what variables or values you enter&nbsp;as&nbsp;long&nbsp;as&nbsp;the 
 type of the variable matches the parameter definition in the function 
 code. Here, the character string, <span class=Code1>name2</span>, will 
 be assigned to the parameter, <span class=Code1>fname</span>, in the function 
 code itself. So <span class=Code1>name2</span> will come out first.</td></tr>
	</table>
	
	<p>Alpha Anywhere replies with:</p>


	
	
	<table class="codeTable" style="x-cell-content-align: top;
					border-left-style: None;
					border-right-style: None;
					border-top-style: None;
					border-bottom-style: None;
					width: 100%;
					border-spacing: 0px;
					border-spacing: 0px;" cellspacing="0" width="100%">
	<col style="width: 100%;">
	
	<tr style="x-cell-content-align: top;" valign="top">
	<td style="x-cell-content-align: top;
				width: 100%;
				padding-right: 10px;
				padding-left: 10px;" valign="top" width="100%">
	<p class=Code>= Michael George&nbsp;</td></tr>
	</table>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Code 
 Editor</span>.</p>

</li>
</ol>

<li class=kadov-p>
<p>To recap, most functions you create are called Global functions because 
 they are available to be used in part of your Alpha Anywhere application. 
 However, you can create a local function.&nbsp;A local function is a function 
 defined in a script or another function.</p>



<p>So a function script <span class=Code1>FUNCTION1</span> could contain 
 a second function definition named <span class=Code1>FUNCTION2</span>. 
 Here is the code for <span class=Code1>FUNCTION1</span> :</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>function FUNCTION1&nbsp;as&nbsp;C (name1&nbsp;as&nbsp;C, 
 birthdate&nbsp;as&nbsp;D)</p>


<p class=Code>&nbsp;&nbsp;function1 = alltrim(name1)+ +function2(birthdate)</p>


<p class=Code>end function</p>


<p class=Code>function&nbsp;FUNCTION2&nbsp;as&nbsp;C (bday&nbsp;as&nbsp;D)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;if age(bday) > 40 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function2 = "has 
 already reached the big 4-0"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function2 
 = "is still at most 39 years old"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;end if</p>


<p class=Code>end FUNCTION&nbsp;</td></tr>
</table>

<p><span class=Code1>FUNCTION1</span> calls <span class=Code1>FUNCTION2</span>. 
 And like a local variable, a local function is only visible or available 
 to the function it is defined within.</p>



<p>Whereas you would be able to call <span class=Code1>FUNCTION1</span> 
 from anywhere in Alpha Anywhere, you could not call <span class=Code1>FUNCTION2</span> 
 from another script.</p>



<p class=A5>Next</p>



<p><a href="/Server/Tutorial/Design/Platform/Xbasic/Xbasic Explorer - Learning Xbasic.html" title="Xbasic Explorer - Learning Xbasic" class="wiki">Xbasic Explorer</a></p>





</li>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Global+User+Defined+Functions">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"common","status":"pending","keywords":"desktop,design,guide,xbasic"}--->
</body></html>