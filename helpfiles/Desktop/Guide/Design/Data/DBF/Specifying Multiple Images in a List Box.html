	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Specifying Multiple Images in a List Box</p>



<p>The owner-draw list boxes that we have shown so far have all used a 
 single image in the list box. In a practical application, you will want 
 to use multiple images in a list box, with the bitmap associated with 
 each row of the list box determined dynamically, based on the text in 
 the row.</p>



<p>For example, in the following list box we display the names of several 
 tables and sets. We use a different icon next to an entry if it is a table 
 (has a .dbf extension), or a set (has a .set extension).</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim filelist[100]&nbsp;as&nbsp;C</p>


<p class=Code>&nbsp;</p>


<p class=Code>data = &lt;&lt;%dlg%</p>


<p class=Code>customer.dbf</p>


<p class=Code>invoice_header.dbf</p>


<p class=Code>invoice_items.dbf</p>


<p class=Code>products.dbf</p>


<p class=Code>invoices.set</p>


<p class=Code>%dlg%</p>


<p class=Code>&nbsp;</p>


<p class=Code>data = stritran(data,".dbf",".1")</p>


<p class=Code>data = stritran(data,".set",".2")</p>


<p class=Code>filelist.initialize(data)</p>


<p class=Code>filelist.sort()</p>


<p class=Code>&nbsp;</p>


<p class=Code>result = ui_dlg_box("Select Table/Set",&lt;&lt;%dlg%</p>


<p class=Code>{region}</p>


<p class=Code>[%I=$a5_table,$a5_set;O={I=@$(.)+1} {@1,$(.)-1}%.25,10filename^#filelist]|</p>


<p class=Code>{endregion};</p>


<p class=Code><10OK> <10Cancel></p>


<p class=Code>%dlg%)</td></tr>
</table>

<p>This script produces the following dialog:&nbsp; </p>



<p class=Pix><img src="images/XD_Multiple images in a listbox.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 147px;
							height: 205px;
							float: none;
							border-style: none;
							border-style: none;"
					width=147
					height=205
					border=0></p>



<p class=PixCaption>Lesson 14: Multiple Images in a List Box</p>



<p>Let's analyze how this script works.</p>



<p>The commands:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>data = stritran(data,".dbf",".1")</p>


<p class=Code>data = stritran(data,".set",".2")</td></tr>
</table>

<p>converts the input values to:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>customer.1</p>


<p class=Code>invoice_header.1</p>


<p class=Code>invoice_items.1</p>


<p class=Code>products.1</p>


<p class=Code>invoices.2</td></tr>
</table>

<p>With the data in this form, the bitmap to associate with each row in 
 the list box can be more easily derived from the data. For example, the 
 first row 'customer.1', should display the first bitmap in the image list, 
 whereas the last row, 'invoices.2', should display the second bitmap in 
 the image list.</p>



<p>The format string for the list box starts with:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>I=$a5_table,$a5_set</td></tr>
</table>

<p>This defines the image list for the owner-draw list box. There are two 
 images, <span class=Code1>$a5_table</span> and <span class=Code1>$a5_set</span>. 
 These are internal Alpha Anywhere images. Image number 1 refers to <span class=Code1>$a5_table</span>, 
 and image number 2 refers to <span class=Code1>$a5_set</span>.</p>



<p>The owner-draw string is:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>O={I=@$(.)+1} {@1,$(.)-1}</td></tr>
</table>

<p>First let's analyze the <span class=Code1>{I= }</span> component. This 
 component specifies the bitmap image to draw on each line. The sub-command, 
 <span class=Code1>@$(.)+1</span> returns the text starting with the first 
 position after the period. In the case of the first row ('customer.1'), 
 the value returned is '1'. So the command is <span class=Code1>{I=1}</span>, 
 which displays the table bitmap next to this entry in the list box. In 
 the case of the last entry ('invoices.2'), this sub-command returns a 
 value of '2', and so the command is <span class=Code1>{I=2}</span>, which 
 displays the set bitmap next to this entry in the list box.</p>



<p>Next, the owner-draw string displays a space.</p>



<p>Then, the owner-draw string displays the result of this component:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>{@1,$(.)-1}</td></tr>
</table>

<p>This outputs text from the input value, starting in position 1, and 
 continuing to the character before the first period.</p>



<p class=A5>Next</p>



<p><a href="../../View/Xdialog/Controls/List Box/Another Approach to Specifying Multiple Images in a List Box.html" title="Another Approach to Specifying Multiple Images in a List Box" class="wiki">Another   Approach to Specifying Multiple Images in a List Box</a> </p>




<p class=A5>Limitations</p>



<p>Desktop applications only</p>



<p class=A5> </p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Specifying+Multiple+Images+in+a+List+Box">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop","status":"pending","keywords":"desktop,guide,dbf"}--->
</body></html>