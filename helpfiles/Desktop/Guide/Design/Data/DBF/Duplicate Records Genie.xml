<page>
	<topic>Duplicate Records Genie </topic>
	<description>Alpha Anywhere adds another powerful productivity tool in the Delete Duplicate Records Genie. The Delete Duplicate Records Genie helps you find, review, and optionally mark or delete duplicate records.
Alpha Anywhere has always had a facility to mark and delete duplicate records. Typically, users would use the Mark Duplicate Records operation to mark all duplicate records. Then they would manually preview the marked records to decide which marked records were indeed duplicates. Finally, they would delete the marked duplicates. This new genie makes it much easier to go through these steps because it allows you to easily compare the original record (the master record) with each of the duplicates of that record. as you compare the master record with its duplicates you can decide if you want to retain any record marked for deletion.</description>
<sections>
<section>
	<description>
The Delete Duplicate Records Genie allows you to:
</description>
	<cases>
		<case>
			<description>select any combination of fields to examine.
</description>
		</case>
		<case>
			<description>select fields by value or by expression
</description>
		</case>
		<case>
			<description>examine partial or full field values
</description>
		</case>
		<case>
			<description>view the entire record or just the fields with differences
</description>
		</case>
		<case>
			<description>interactively compare potential duplicates with the first, or master, instance
</description>
		</case>
		<case>
			<description>scroll through duplicates
</description>
		</case>
		<case>
			<description>count duplicates
</description>
		</case>
		
	</cases>
	
</section>	
<section>
	<title>Finding Duplicate Records</title>
	<steps>
		
		<step>
			<description>From a loaded table select Table > Utilities > Delete Duplicate Records or right click on a table and select Utilities > Delete Duplicate Records to display the following dialog box. </description>
		<figure><link>images/View_Duplicate_Records_Specify_Fields.png</link></figure>
		</step>
		
		<step>
			<description>Make a selection from the Method list. The options are:
</description>
<cases>
	<case>
		<description>"Specify a List of Fields to Compare"
</description>
	</case>
	<case>
		<description>"Specify an Expression (Advanced Method)"
</description>
	</case>
</cases>
		</step>
		
		<step>
			<title>Advanced Options</title>
			<description>If you selected "Specify a List of Fields to Compare" in step 2:
</description>
<cases>
	<case>
		<description>1. Select a field in the Field 1 list.
</description>
	</case>
	<case>
		<description>2. Optionally, click Options ... button to refine the field based search. 
</description>
<figure><link>images/View_Duplicate_Records_Advanced_Option.png</link></figure>
	</case>
	<case>
		<description>3. Optionally, restrict the comparison to the first N characters of the field.
</description>
	</case>
	<case>
		<description>4. Optionally, restrict the comparison to the first N words of the field.
</description>
	</case>
	<case>
		<description>5. Click OK to continue or Cancel to discard your inputs.
</description>
	</case>
	<case>
		<description>6. Optionally, repeat steps 3a to 3e for additional fields.
</description>
	</case>
</cases>
		</step>
		
		<step>
			<description>If you selected "Specify an Expression (Advanced Method)" in step 2:
</description>
<cases>
	<case>
		<description>1. Enter an expression in the Expression field.
</description>
	</case>
	<case>
		<description>2. Optionally, click the 'x-y' icon to display the Expression Builder to help you define the expression.
</description>
	</case>
	<case>
		<description>3. Click OK to continue or Cancel to discard your inputs.
</description>
	</case>
</cases>
		</step>
		
		<step>
			<description>Click Search for Duplicates button to display the following dialog: 
</description>
<figure><link>images/View_Duplicate_Records_Number_Found.png</link></figure>
		</step>
		
		<step>
			<description>Optionally, select Do not delete any records and click OK. This leaves the duplicates marked and available for future deletion.
</description>
		</step>
		
		<step>
			<description>Optionally, select Delete all of the marked records now and click OK to remove the duplicates.
</description>
		</step>
		
		<step>
			<description>Optionally, select Preview the marked records and click OK to display the View Duplicate Records Genie.
</description>
<cases>
	<case>
		<title>View Duplicate Records Genie
</title>
		
		<description>This sample screen shot of the View Duplicate Records Genie shows: 
</description>
		<figure><link>images/View_Duplicate_Records.png</link></figure>
		<cases>
			<case>
				<description>There are 9 records that have duplicates.
</description>
			</case>
			<case>
				<description>The current "master record" has 4 duplicate records. Alpha Anywhere is showing the data in the "master record" and the 1st of the 4 duplicate records for "AZ".
</description>
			</case>
			
		</cases>
	</case>
	
	
</cases>


		</step>
		
		<step>
			<description>Initially, the master record is not marked (checked) for deletion. The duplicate records are marked for deletion. Optionally, toggle the check boxes if you decide that you want to keep all records or delete the master record and keep the duplicate records.
</description>
		</step>
		
		<step>
			<description>Optionally, check Show fields with differences. Alpha Anywhere automatically calculates the fields that have different values, places checkmarks to the left of their names, and displays their values in the main window.
</description>
		</step>
		
		<step>
			<description>Optionally, if Show fields with differences is not checked, place checkmarks to the left of the fields you want to compare.
</description>
		</step>
		
		<step>
			<description>Optionally, use the navigation buttons under the master record and the duplicate record to scan the duplicate records and see their field values.
</description>
		</step>
		
		<step>
			<description>Optionally, click Delete Marked Records to remove duplicate records
</description>
		</step>
		
		<step>
			<description>Optionally, click Count Records Marked for Deletion to display a message with a count of records marked for deletion.
</description>
		</step>
		
		<step>
			<description>Click Close to finish.
</description>
		</step>
		
		
	</steps>
	
	
	
</section>
<section>
	<title>Using the Mark Duplicate Records Operation
</title>
<description>There is another way to get to the Delete Duplicate Records Genie.
</description>	
<steps>
	<step>
		<description>Display the Operations tab of the Control Panel.
</description>
	</step>
	<step>
		<description>Click New.
</description>
	</step>
	<step>
		<description>Check the More check box.
</description>
	</step>
	<step>
		<description>Select the Mark Duplicate Records operation, select the table or set you want to process, and click Create.
</description>
	</step>
	<step>
		<description>Click Duplicate Selected Records.
</description>
	</step>
	<step>
		<description>Enter an expression in the Expression field. Optionally, click the 'x-y' icon to display the Expression Builder to help you define the expression.
</description>
	</step>
	<step>
		<description>Click Run on the toolbar.
</description>
	</step>
	<step>
		<description>Click View records in the 'View Duplicates Genie'.
</description>
	</step>
	
	
</steps>	
	
</section>
	<section>
<title>Using Xbasic to Remove Duplicates</title>		
<description>Finally, you can also display the Delete Duplicate Records Genie using an Xbasic method:
</description>		
<example><![CDATA[a5_viewduprecs(tablename as C, duplicate_key_expression as C, run_query_to_find_dups as L )
]]></example>		
		
	</section>
<section>

<description>For example:
</description>		
<example><![CDATA[dim tbl as T
tbl = table.open("customer")
tbl.mark_range("state",".t.") 'mark all duplicate states
tbl.close()
'open the genie - no need to run the query to mark duplicate states because it has already been run.
A5_viewduprecs("customer", "state", .f.)]]></example>		
		
	</section>	
	<section>

<description>Alternatively, open the genie and run a query to mark duplicate states before displaying any data in the genie:
</description>		
<example><![CDATA[A5_viewduprecs("customer","state",.t.)]]></example>		
		
	</section>	
</sections>	
<see>
	<ref>A5_VIEWDUPRECS()</ref>
	<ref>Table Operation Methods</ref>
</see>	
	
</page>