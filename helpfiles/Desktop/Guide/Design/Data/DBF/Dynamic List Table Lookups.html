	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Dynamic List Table Lookups</p>
<p>Many applications call for the contents of list boxes to dynamically 
 change&nbsp;as&nbsp;variables (external to the list box) change.</p>
<p class=A5><a name=Xbasic_Example>Xbasic Example</a></p>
<p>Alpha Anywhere adds a new approach to populating and refreshing 
 dynamic list boxes and other field bound controls that have a <span class=Screen>Choices</span> 
 tab in their <span class=Screen>Properties</span> dialog boxes. The new 
 option is: "Populated using Xbasic". </p>

<p class=Pix><img src="images/Populate_List_Using_Xbasic.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 411px;
							height: 365px;
							float: none;
							border-style: none;
							border-style: none;"
					width=411
					height=365
					border=0></p>



<p>A button illustrates how to use this option.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Click 
 Here for Example Code</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a list of choices, 
 one per line. Use the <img src="images/Sort_Ascending_button.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 22px;
									height: 22px;
									float: none;
									border-style: none;
									border-style: none;"
							width=22
							height=22
							border=0> and <img src="images/Sort_Descending_button.gif"
												x-maintain-ratio=TRUE
												style="border: none;
														width: 22px;
														height: 22px;
														float: none;
														border-style: none;
														border-style: none;"
												width=22
												height=22
												border=0> buttons to sort 
 them. </p>

</li>
</ol>

<p class=Pix><img src="images/Populate_List_Using_Xbasic_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 357px;
							height: 289px;
							float: none;
							border-style: none;
							border-style: none;"
					width=357
					height=289
					border=0></p>



<ol start=3>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 to display the <span class=Screen>Xbasic Code</span> dialog box. </p>

</li>
</ol>

<p class=Pix><img src="images/Populate_List_Using_Xbasic_3.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 518px;
							height: 459px;
							float: none;
							border-style: none;
							border-style: none;"
					width=518
					height=459
					border=0></p>



<ol start=4>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, click 
 <span class=Button>Copy to Clipboard</span>, then paste the code into 
 the <span class=Code1>OnInit</span> event of your form. </p>

</li>
</ol>

<p class=Pix><img src="images/Populate_List_Using_Xbasic_4.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 339px;
							height: 296px;
							float: none;
							border-style: none;
							border-style: none;"
					width=339
					height=296
					border=0></p>



<ol start=5>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The code can be run 
 from other locations. For example, you could put a button on your form 
 and reload the contents of the list box by redefining <span class=Code1>&lt;&lt;%str% 
 ... %str%</span> and then setting the new value of <span class=Code1>pObj.settings.dynamic_list</span>.</p>

</li>
</ol>

<p class=A5><a name=Cascading_Dynamic_List_Using_Xbasic>Cascading Dynamic 
 List Using Xbasic</a></p>



<p>A common application requirement is to dynamically populate a list box 
 based on a selection in another list box. This example is based on the 
 AlphaSports sample database. </a></p>



<p class=Pix><img src="images/UM_Dynamic_list.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 494px;
							height: 416px;
							float: none;
							border-style: none;
							border-style: none;"
					width=494
					height=416
					border=0></p>



<p>The <span class=Code1>OnInit</span> event of the form contains the following 
 script. This script populates the two list boxes with all unique values 
 available for the selected fields. The pointers are global because we 
 will use them later. Note that each <a href="/Server/Reference/Design/Api/Objects/Table/TABLE.EXTERNAL_RECORD_CONTENT_GET Method.html" title="TABLE.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">TABLE.EXTERNAL_RECORD_CONTENT_GET(</a>) 
 command uses <a href="/Server/Reference/Design/Api/Functions/Query Functions/UNIQUE_KEY_VALUE Function.html" title="UNIQUE_KEY_VALUE Function" class="wiki">UNIQUE_KEY_VALUE(</a>) 
 to retrieve unique values. There is no attempt yet to filter the lists.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim global pVendor&nbsp;as&nbsp;P</p>


<p class=Code>dim global pDescription&nbsp;as&nbsp;P</p>


<p class=Code>pVendor = topparent:VendorList.this</p>


<p class=Code>pVendor.settings.dynamic_list = table.external_record_content_get("vendor", 
 "Name", "Name", "unique_key_value()")</p>


<p class=Code>pDescription = topparent:DescriptionList.this</p>


<p class=Code>pDescription.settings.dynamic_list = table.external_record_content_get("product", 
 "Description", "Description", "unique_key_value()")</td></tr>
</table>

<p>The <span class=Code1>Vendor->Vendor_ID</span> field links to the 
 <span class=Code1>Product->Vendor</span> field. Since the Vendor list 
 box provides the <span class=Code1>Vendor->Name</span> field, we need 
 an intermediate query to retrieve current record's <span class=Code1>Vendor->Vendor_ID</span> 
 field. The following script is in the <span class=Code1>on<x>change</span> 
 event of the Vendor list box.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim ven&nbsp;as&nbsp;C</p>


<p class=Code>dim vent&nbsp;as&nbsp;C</p>


<p class=Code>vent = alltrim(VendorList.text)</p>


<p class=Code>ven = table.external_record_content_get("Vendor", 
 "Vendor_ID", "", "alltrim(Name) = " + s_quote(vent))</td></tr>
</table>

<p>Once we have the current record's <span class=Code1>Vendor->Vendor_ID</span> 
 field, we use it to retrieve a list of matching <span class=Code1>Product->Description</span> 
 values.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>pDescription.settings.dynamic_list = table.external_record_content_get("product", 
 "Description", "Description", "alltrim(Vendor) 
 = " + s_quote(ven))</p>


<p class=Code>topparent.resynch()</td></tr>
</table>

<p>Finally, we refresh the form to display the new values in the Product 
 list box.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>topparent.resynch()</td></tr>
</table>

<p class=A5><a name=Xdialog_Example>Xdialog Example</a></p>



<p>Here is a sample Xdialog list box that responds to two shared variables 
 and repopulates when you click a button. The following are two before 
 and after pictures that show the list in action.  
 </p>



<p class=Pix><img src="images/XD_Dynamic_list_box_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 422px;
							height: 263px;
							float: none;
							border-style: none;
							border-style: none;"
					width=422
					height=263
					border=0></p>



<p class=Pix><img src="images/XD_Dynamic_list_box_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 422px;
							height: 263px;
							float: none;
							border-style: none;
							border-style: none;"
					width=422
					height=263
					border=0></p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim shared cid_start&nbsp;as&nbsp;C</p>


<p class=Code>dim shared cid_end&nbsp;as&nbsp;C</p>


<p class=Code>dim SHARED cust&nbsp;as&nbsp;C</p>


<p class=Code>ok_button_label = "&OK"</p>


<p class=Code>cid_start="A"</p>


<p class=Code>cid_end = "L"</p>


<p class=Code>cmd = "kl=customer,{keylist_build(\"H=.025,1:25,2:25,3:10\",Customer_id,Lastname,Firstname,Customer_id)}{between(Lastname,"+quote(cid_start)+","+quote(cid_end)+")}"</p>


<p class=Code>ui_modeless_dlg_box("Dynamic List Box",&lt;&lt;%dlg%</p>


<p class=Code>{can_exit=ok}</p>


<p class=Code>{region}</p>


<p class=Code>Select customer between:| [.10cid_start!changed] [.10cid_end!changed]</p>


<p class=Code>{endregion};</p>


<p class=Code>{region}</p>


<p class=Code>Select customer:;</p>


<p class=Code>[%@cmd%.80,10cust];</p>


<p class=Code>{endregion};</p>


<p class=Code>{line=1,0};</p>


<p class=Code>{region}</p>


<p class=Code><*15=ok_button_label!OK></p>


<p class=Code>{endregion};</p>


<p class=Code>%dlg%,&lt;&lt;%code%</p>


<p class=Code>if a_dlg_button="changed" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;a_dlg_button=""</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cmd = "kl=customer,{keylist_build(\"H=.025,1:25,2:25,3:10\",Customer_id,Lastname,Firstname,Customer_id)}{between(Lastname,"+quote(cid_start)+","+quote(cid_end)+")}"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_refresh("Dynamic 
 List Box")</p>


<p class=Code>end if</p>


<p class=Code>if a_dlg_button="OK" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_modeless_dlg_close("Dynamic 
 List Box")</p>


<p class=Code>end if</p>


<p class=Code>%code%)</td></tr>
</table>

<p class=A5><a name=Action_Script_Example>Action Script Example</a></p>



<p>This example is based on the AlphaSports sample database.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a new action 
 script and select "Dialog Boxes" and "Display an Xdialog 
 Box".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter <span class=Control>Variable 
 Name</span> "vendor_id", <span class=Control>Prompt</span> "Vendor 
 Records", <span class=Control>Width</span> "70", and <span 
 class=Control>Height</span> "10".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>For the <span class=Control>Style</span> 
 select "Record List-List Box" and click <span class=Button>Define 
 Record List</span>.&nbsp; </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 481px;
							height: 345px;
							border-style: none;
							border-style: none;"
					width=481
					height=345
					border=0></p>



<ol start=4>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>From the Table list 
 select "vendor".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Add 
 Column</span> to add "Vendor_id" and "Name" to the 
 <span class=Control>Columns in Record List</span> field. Their widths 
 are 58 characters and 58 characters.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Vendor_id" 
 for the <span class=Control>Return Value</span> field. This is the linking 
 field between the <span class=Code1>Vendor</span> and <span class=Code1>Product</span> 
 tables.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span>. 
 </p>

</li>
</ol>

<p class=pix><img src="images/Dynamic_List_Box_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 372px;
							height: 465px;
							float: none;
							border-style: none;
							border-style: none;"
					width=372
					height=465
					border=0></p>



<ol start=8>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Add 
 New Variable</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter <span class=Control>Variable 
 Name</span> "prod_id", <span class=Control>Prompt</span> "Product 
 Records", <span class=Control>Width</span> "70", and <span 
 class=Control>Height</span> "10".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>For the <span class=Control>Style</span> 
 select "Record List-List Box" and click <span class=Button>Define 
 Record List</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_4.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 481px;
							height: 343px;
							border-style: none;
							border-style: none;"
					width=481
					height=343
					border=0></p>



<ol start=11>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>From the <span class=Control>Table</span> 
 list select "product".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Filter</span> 
 icon to display the <span class=Screen>Filter Builder</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Vendor" 
 in the left-most list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "is equal 
 to" in the middle list. </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_5.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 567px;
							height: 378px;
							float: none;
							border-style: none;
							border-style: none;"
					width=567
					height=378
					border=0></p>



<ol start=15>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Value</span> 
 icon to display the <span class=Screen>Value</span> dialog box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <span class=Button>Select 
 Variable</span> button to select the "vendor_id" field. </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_6.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 348px;
							height: 406px;
							float: none;
							border-style: none;
							border-style: none;"
					width=348
					height=406
					border=0></p>



<ol start=17>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Action 
 Script" and "vendor_id".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Insert</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 to return to the <span class=Screen>Filter Builder</span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_9.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 433px;
							height: 236px;
							float: none;
							border-style: none;
							border-style: none;"
					width=433
					height=236
					border=0></p>



<ol start=20>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Add 
 Column</span> to add "Product_id", "Vendor", and "Description" 
 to the <span class=Control>Columns in Record List</span> field. Their 
 widths are 12 characters, 12 characters, and 46 characters.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you were going 
 to do something with the product selection, you would presumably select 
 "Product_id" in the <span class=Control>Return Value</span> 
 field</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> 
 and <span class=Button>Next&nbsp;></span>. </p>

</li>
</ol>

<p class=Pix><img src="images/Dynamic_List_Box_3.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 372px;
							height: 465px;
							float: none;
							border-style: none;
							border-style: none;"
					width=372
					height=465
					border=0></p>



<ol start=23
	style="list-style: decimal;"
	type=1>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, enter 
 values for the <span class=Control>Dialog Title</span>, <span class=Control>Header 
 Text</span>, and <span class=Control>Footer Text</span>. </p>

</li>
</ol>

<p class=pix><img src="images/Dynamic_List_Box_7.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 481px;
							height: 310px;
							float: none;
							border-style: none;
							border-style: none;"
					width=481
					height=310
					border=0></p>



<ol start=24>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Optionally, modify 
 the comment that describes the action script.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Finish</span>. 
 The resulting dialog box appears below. </p>

</li>
</ol>

<p class=pix><img src="images/Dynamic_List_Box_8.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 468px;
							height: 402px;
							float: none;
							border-style: none;
							border-style: none;"
					width=468
					height=402
					border=0></p>



<p class=A5>See Also</p>



<p><a href="../../View/Xdialog/Controls/Working with List Boxes, Combo Boxes, Radio Buttons Etc..html" title="Working with List Boxes, Combo Boxes, Radio Buttons Etc." class="wiki">Working   with List Boxes, Combo Boxes, Radio Buttons Etc.</a>, <a href="../../View/Xdialog/Display an Xdialog Box.html" title="Display an Xdialog Box" class="wiki">Display   an Xdialog Box</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Dynamic+List+Table+Lookups">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop, dbf","status":"pending","keywords":"desktop,guide,dbf"}--->
</body></html>