	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Validation Rules</p>



<p>Validation Rules help assure that data entry is reasonable and accurate. 
 </p>



<p class=Pix><img src="images/UG_Field_Rules_Validations_tab.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 576px;
							height: 543px;
							border-style: none;
							border-style: none;"
					width=576
					height=543
					border=0></p>



<p class=A5><a name=Double_Entry_Mode>Double Entry Mode</a></p>



<p>For fields in which data entry accuracy is important, use the Double-Entry 
 Field Rule. The user must enter the value twice, exactly the same way, 
 for it to be accepted. For example, if you keep confidential records that 
 are referenced only by client number for security, using the Double-Entry 
 rule helps ensure that a keyboard operator does not accidentally press 
 a wrong key.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Edit Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Validations</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select an entry from 
 the <span class=Control>Case convert</span> list. The options are:</p>

</li>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Not required" 
 - the default</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Always required"</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Conditionally 
 required"</p>

</li>
	</ul>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you selected "Conditionally 
 required" in step 3, enter an expression in the <span class=Control>Double 
 entry condition</span> field. The expression must evaluate to TRUE (.T.) 
 or FALSE (.F.). Click <img src="Expression_Button_black.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 22px;
									height: 22px;
									float: none;
									border-style: none;
									border-style: none;"
							width=22
							height=22
							border=0> to use the <a href="Expression Builder.html" title="Expression Builder" class="wiki">&lt;span   class=Screen&gt;Expression Builder&lt;/span&gt;</a> to help you define the expression.</p>

</li>
</ol>

<p class=A5><a name=Uniqueness_Test_for_a_Field>Uniqueness Test for a Field</a></p>



<p class=ListNumber>If you want to prevent duplicate values from being 
 entered into a <span class=Bolded>field</span>, use one of the two Uniqueness 
 test rules: Value of field must be unique, or Value of expression must 
 be unique.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Edit Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Validations</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select an entry from 
 the <span class=Control>Uniqueness test</span> list. The options are:</p>

</li>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"None" - 
 the default</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Value of field 
 must be unique" - Select this setting to specify that any value you 
 enter must not already exist in the same field in another record. If you 
 try to save a record that has a duplicate value in a unique field, an 
 error message appears listing the duplicate value.</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Value of expression 
 must be unique" - Use this setting when you want to build an expression 
 to determine if a value is unique. The field for which this rule is defined 
 is usually included in the Unique expression. The value that results from 
 this expression must be unique for each record in the table; if not, the 
 record cannot be saved.</p>

</li>
	</ul>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you selected "Value 
 of expression must be unique" in step 3, enter an expression in the 
 <span class=Control>Unique expression</span> field. The expression must 
 evaluate to a unique value of the same type&nbsp;as&nbsp;the table field. 
 Click 
	<img border="0" src="../DBF/images/Button_black.png" width="26" height="26"> to use the 
	<a href="Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a> to help you define the expression.</p>

</li>
</ol>

<p class=A5><a name=Uniqueness_Test_for_Multiple_Fields_in_a_Record>Uniqueness 
 Test for Multiple Fields in a Record</a></p>



<p>There are two techniques to prevent duplicate values from being entered 
 into multiple fields in a record. This technique also applies to calculated 
 fields.</p>



<p>Testing each field:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Edit Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Validations</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>For <span class=Bolded>each</span> 
 of the multiple fields:</p>

</li>
	
	<ol>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Select "Value 
 of expression must be unique" in the <span class=Control>Uniqueness 
 test</span> list.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>In the <span class=Control>Unique 
 expression</span> field enter an expression that evaluates to a character 
 value and that includes all of the multiple fields that you want to test.</p>

</li>
	</ol>
</ol>

<ul style="list-style: disc;"
	type=disc>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p><p>For example, if you wanted to make sure that 
 the <span class=Code1>firstname</span> and <span class=Code1>lastname</span> 
 combination in any record was unique, the <span class=Control>Unique expression</span> 
 would be <span class=Code1>firstname + lastname</span>.</p>

</li>
		
		<li class=kadov-p><p>Suppose you defined a calculated field named 
 <span class=Code1>fullname</span> that was defined&nbsp;as&nbsp; <span 
 class=Code1>alltrim(firstname) + " " + alltrim(lastname)</span>, 
 then this would be the <span class=Control>Unique expression</span> that 
 you define for the <span class=Code1>firstname</span> and <span class=Code1>lastname</span> 
 fields.</p>

</li>
	</ul>
</ul>

<p>Testing the combined value:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Define Indexes</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Create a new index 
 that uses the expression you want to test. For example, the index might 
 be named <span class=Code1>fullname</span> and use the expression <span 
 class=Code1>alltrim(firstname) + " " + alltrim(lastname).</span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Build 
 Indexes</span> and <span class=Button>Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Events</span> tab of the <span class=Screen>Field Rule Editor</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the <span 
 class=Button>Record Events</span> radio button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the "CanSaveRecord" 
 event from the list box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a script that 
 tests whether the index value exists. Note 
 that the <a href="/Server/Reference/Design/Api/Functions/Index Functions/KEY_EXIST Function.html" title="KEY_EXIST Function" class="wiki">KEY_EXIST(</a>) 
 function:</p>

</li>
</ol>

<ul style="list-style: disc;"
	type=disc>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p><p>references the name of the index created in 
 step 2 in its first argument</p>

</li>
		
		<li class=kadov-p><p>uses the same expression&nbsp;as&nbsp;the 
 index&nbsp;as&nbsp;its second argument, with the exception that each field 
 name is prefaced by " <span class=Code1>tbl.</span> ".</p>

</li>
	</ul>
</ul>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.current()</p>


<p class=Code>if key_exist("fullname", <span class=Code1>alltrim(tbl.firstname) 
 + " " + alltrim(tbl.lastname)</span> ) then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cancel()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;ui_msg_box("Error", 
 "The combined values of First Name and Last Name must be unique")</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5><a name=Cross_File_Validation>Cross File Validation</a></p>



<p>You can validate new values based on ones that exist in another table 
 using Cross-File Validation. There are two cross-file validation settings: 
 Simple and Advanced.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Edit Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Validations</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select an entry from 
 the <span class=Control>Cross file validation</span> list. The options 
 are:</p>

</li>
	
	<ul style="list-style: disc;"
		type=disc>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"None" - 
 the default</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Simple" 
 - Use this setting when you only want to validate one field in one table.</p>

</li>
		
		<li class=kadov-p-CBullet1><p class=Bullet1>"Advanced" 
 - Use this setting when you only want to validate several fields across 
 one or more tables or want to validate fields conditionally.</p>

</li>
	</ul>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you selected "Simple" 
 in step 3:</p>

</li>
	
	<ol>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Depending on the 
 type of validation you want, select "Must not exist in" or "Must 
 exist in" in <span class=Control>Test</span>.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Enter the name 
 of the table you want to reference in the <span class=Control>Table</span> 
 field. Click <img src="images/Folder_button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 22px;
							height: 22px;
							float: none;
							border-style: none;
							border-style: none;"
					width=22
					height=22
					border=0> to select from a list of tables.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Enter the name 
 of the field you want to reference in <span class=Control>Field</span>. 
 You can also use an expression to select the field name. The field in 
 the local and the validation tables must be of the same type. Click 
		<img border="0" src="../DBF/images/Button_black.png" width="26" height="26"> to use the 
		<a href="Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a> to help you define the expression.</p>

</li>
	</ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>If you selected "Advanced" 
 in step 3, an embedded browse appears for entering validation criteria. 
 It contains columns labeled <span class=Control>Field</span>, <span class=Control>Test</span>, 
 <span class=Control>Table</span>, <span class=Control>Lookup</span>, and 
 <span class=Control>Condition</span>.</p>

</li>
	
	<ol>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>In the first row 
 in the <span class=Control>Field</span> column, use the drop-down list 
 to select a field name from the current table. Otherwise, create an expression 
 that evaluates to a field name.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>In the first row 
 in the <span class=Control>Test</span> column, select either "Must 
 not exist in" or "Must exist in".</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>In the first row 
 in the <span class=Control>Table</span> column, click <img src="images/Folder_button.gif"
															x-maintain-ratio=TRUE
															style="border: none;
	width: 22px;
	height: 22px;
	float: none;
	border-style: none;
	border-style: none;"
															width=22
															height=22
															border=0> to 
 select from a list of tables.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>In the first row 
 in the <span class=Control>Lookup</span> column, select either a field from the 
		validation table or an expression that evaluates to a field name. Click
		<img border="0" src="../DBF/images/Button_black.png" width="26" height="26"> to use the
		<a href="Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a> to help you define the expression..</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Optionally, in 
 the first row in the <span class=Control>Condition</span> column, enter 
 an create an expression that evaluates to a logical value. If the expression 
 evaluates to FALSE (.F.), the rule will not be applied.</p>

</li>
		
		<li class=kadov-p-CListAlpha><p class=ListAlpha>Repeat steps 5a 
 through 5e for each additional field that you want to validate.</p>

</li>
	</ol>
</ol>

<p class=A5><a name=Custom_Validations>Custom Validations</a></p>



<p>You can check the validity of values you enter into a field using one 
 or more custom validation expressions. A validation expression must be 
 a logical expression, and is typically based on the field for which the 
 rule is defined, although it can include previously entered fields.</p>



<p>If all validation expressions evaluate to TRUE for the record, the entered 
 value is allowed in the field. Otherwise, the entry is rejected, and a 
 validation error message for the first expression to fail appears.</p>



<p>Alpha Five evaluates the validation expressions for a field when the 
 user exits the field, and when the record is saved.</p>



<p class=Pix><img src="images/Custom_Validations_1.gif"
					style="width: 327px;
							height: 68px;
							border-style: none;
							border-style: none;"
					width=327
					height=68
					border=0></p>



<p class=PixCaption>Custom Validation and Error Message</p>



<p class=Pix><img src="images/Custom_Validations_2.gif"
					style="width: 170px;
							height: 126px;
							border-style: none;
							border-style: none;"
					width=170
					height=126
					border=0></p>



<p class=PixCaption>Custom Error Message During Data Entry</p>



<p>To create a Custom Validation:</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the <span class=Screen>Control 
 Panel</span> select the table and click <span class=Button>Table > 
 Edit Field Rules</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Validations</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter an expression 
 in the first row of the <span class=Control>Validation</span> column. 
 The expression must evaluate to TRUE (.T.) or FALSE (.F.). Click 
	<img border="0" src="../DBF/images/Button_black.png" width="26" height="26"> to use the 
	<a href="Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a> to help you define the expression.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a corresponding 
 <span class=Control>Message</span> that will appear when the validation 
 expression evaluates to FALSE (.F.), during data entry.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Repeat steps 3 and 
 4 to enter custom validation expressions on subsequent rows of the embedded 
 browse.</p>

</li>
</ol>

<p class=A5><a name=Range_Checking>Range Checking</a></p>



<p>To check that a value is with in specified range of numbers, enter a 
 validation expression similar to the following, where <span class=Code1>fieldname</span> 
 is the name of the field that is being validated.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim lowervalue&nbsp;as&nbsp;N</p>


<p class=Code>dim uppervalue&nbsp;as&nbsp;N</p>


<p class=Code>lowervalue = 1</p>


<p class=Code>uppervalue = 21</p>


<p class=Code>between(fieldname, lowervalue, uppervalue)</td></tr>
</table>

<p class=A5><a name=Validating_Input_to_Form_Variables>Validating Input 
 to Form Variables</a></p>



<p>Field rules do not validate inputs to variables. Instead, you must create 
 your own validation routines. The following script uses CanDepart event 
 of the form field to check the length of the user's input to <span class=Code1>var->variablename</span>.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if alltrim(var->variablename<a href="tiki-editpage.php?page=alltrim%28var-%3Evariablename" title="Create page: alltrim(var-&gt;variablename" class="wiki wikinew len">?</a> > 30) then <br>
ui_msg_box("Sorry","Entries over 30 characters are not permitted") 
 <br>
cancel() <br>
end <br>
end if</td></tr>
</table>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Validation+Rules">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","keywords":"desktop,security,guide,rules,dbf","tags":"desktop"}--->
</body></html>