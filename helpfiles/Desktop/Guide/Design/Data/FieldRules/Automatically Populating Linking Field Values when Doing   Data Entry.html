	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Automatically Populating Linking Field Values when Doing Data Entry</p>
	<p class=A3Topic>&nbsp;</p>



<p>The following scenario describes a situation in which you want to automatically 
 populate "linking" fields in a grid component menus.</p>



<p>Assume that you have an application with the following characteristics:</p>



<ul style="list-style: disc;"
  type=disc>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>You have a grid component 
 called <span class=Code1>Orders</span> that displays data from your <span 
 class=Code1>Orders</span> table.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>You have a grid component 
 called <span class=Code1>Items</span> that displays data from your <span 
 class=Code1>Items</span> table.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>You have a page called 
 <span class=Code1>OrdersPage.A5W</span> that displays the <span class=Code1>Orders</span> 
 grid. The alias (component name) for the component on this page is <span 
 class=Code1>OrdersGrid</span>.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>You have a page called 
 <span class=Code1>ItemsPage.A5W</span> that displays the <span class=Code1>Items</span> 
 grid. The alias for the component on this page is <span class=Code1>ItemsGrid</span>.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>Orders</span> 
 grid has a column that displays links. When the user clicks on the link 
 in a particular row, the <span class=Code1>ItemsPage.A5W</span> page is 
 opened, showing the items for the selected order.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>The <span class=Code1>Orders</span> 
 grid and the <span class=Code1>Items</span> grid are "linked" 
 by the <span class=Code1>Invoice_Number</span> field which they have in 
 common. ( <span class=Note>Note</span> : It is possible for grid components 
 to be linked on multiple fields: e.g. <span class=Code1>Firstname</span> 
 and <span class=Code1>Lastname</span>.)</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>When the user enters new 
 records into the <span class=Code1>Items</span> grid, the <span class=Code1>Invoice_Number</span> 
 field (i.e., the "linking" field) is automatically filled in 
 with the correct order number (the order number of the row in the <span 
 class=Code1>Orders</span> grid that the user clicked in to open the <span 
 class=Code1>ItemsPage.A5W</span> page).</p>

</li>
</ul>

<p class=Note><span class=Note><img src="images/icon_information.gif"
                  x-maintain-ratio=TRUE
                  style="border: none;
                      width: 36px;
                      height: 32px;
                      float: none;
                      border-style: none;
                      border-style: none;"
                  width=36
                  height=32
                  border=0>Note</span>: It should really 
 not be necessary to include the <span class=Code1>Invoice_Number</span> 
 field in the <span class=Code1>Items</span> grid because the <span class=Code1>Items</span> 
 grid typically is used to display the items for a single order.</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
                  x-maintain-ratio=TRUE
                  style="border: none;
                      width: 36px;
                      height: 32px;
                      float: none;
                      border-style: none;
                      border-style: none;"
                  width=36
                  height=32
                  border=0>Note</span>: Another approach 
 to automatically populating linking fields in a grid component is to use 
 GridLinker or TabbedGridLinker components to link the grids together. 
 The approach described here differs from a GridLinker or TabbedGridLinker 
 in that only one grid at a time is displayed. In a GridLinker both the 
 parent grid and all of its child grids are displayed on the same page. 
 In the approach described above, each page that is displayed contains 
 only a single grid, and therefore, the pages display more quickly.</p>



<p>Alpha Five makes it easy to create this type of application by defining 
 a special query string for the links in the <span class=Code1>Orders</span> 
 grid that open the <span class=Code1>ItemsPage.A5W</span> page.</p>



<p class=A5>Creating the Grids</p>



<ol>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Create the <span 
 class=Code1>Orders</span> grid based on the <span class=Code1>Invoice_Header</span> 
 table of the AlphaSports database.</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Component 
 Type</span> menu make the grid "updateable".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Grid 
 > Fields</span> menu select a number of fields. Make sure to include 
 the <span class=Code1>Invoice_Number</span> field.</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Create the <span 
 class=Code1>Items</span> grid based on the <span class=Code1>Invoice_Items</span> 
 table of the AlphaSports database.</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Component 
 Type</span> menu make the grid "updateable".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>On the <span class=Screen>Grid 
 > Fields</span> menu select a number of fields. Make sure to include 
 the <span class=Code1>Invoice_Number</span> field. <a HREF="http://support.alphasoftware.com/imagesV8/WPT_Link_Parameter_2.gif"><a class="wiki"  href="Picture" rel="">Picture</a></a></p>

</li>
</ol>

<p class=Pix><img src="images/WPT_Link_Parameter_1.gif"
          x-maintain-ratio=TRUE
          style="border: none;
              width: 580px;
              height: 254px;
              float: none;
              border-style: none;
              border-style: none;"
          width=580
          height=254
          border=0></p>



<p class=PixCaption>Orders Grid</p>



<p class=Pix><img src="images/WPT_Link_Parameter_2.gif"
          x-maintain-ratio=TRUE
          style="border: none;
              width: 572px;
              height: 253px;
              float: none;
              border-style: none;
              border-style: none;"
          width=572
          height=253
          border=0></p>



<p class=PixCaption>Items Grid</p>



<p>Here is how you would define the links for the link control in the <span 
 class=Code1>Orders</span> grid:</p>



<ol>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Select the "Invoice_Number" 
 field in the <span class=Control>Selected Fields</span> list.</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Set its <span class=Button>Display 
 Settings > Control type</span>&nbsp;as&nbsp;"Link".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Set its <span class=Button>Link 
 Properties > Link address type</span>&nbsp;as&nbsp;"Computed from 
 fields in the Grid".</p>

</li>
  
  <li class=kadov-p-CListNumber><p class=ListNumber>Set its <span class=Button>Link 
 Properties > Link address</span> to the following expression:</p>

</li>
</ol>


<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>ItemsPage.A5W?ItemsGrid_link_1C=Invoice_Number={Invoice_Number}</span></td></tr>
</table>

<p>The general form of the template for the link is:</p>



<p><span class=Argument>&lt TargetPage ></span> ? <span class=Argument>&lt 
 ComponentAlias ></span> _link_ <span class=Argument>&lt LinkingFieldNumber 
 >&lt LinkingFieldType ></span> = <span class=Argument>&lt LinkingFieldName 
 ></span> = <span class=Argument>&lt LinkingFieldValue ></span></p>



<p>If the parent and child grid are linked on more than a single field, 
 then the query string is repeated for each linking field, incrementing 
 the <span class=Argument>&lt LinkingFieldNumber ></span> for each 
 linking field. For example, say you have two grids that are linked on 
 <span class=Code1>AccountNumber</span> (a numeric field) and <span class=Code1>Location</span> 
 (a character field). The template for this link would be:</p>




<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>MyTargetPage.A5w?myGrid_link_1C=AccountNumber={AccountNumber}&myGrid_link_2N=Location={Location}</span></td></tr>
</table>

<p>Note that the <span class=Argument>&lt LinkingFieldType ></span> 
 is specified by a <span class=Bolded>single</span> character ("C" 
 for the first linking field and "N" for the second linking field). 
 Also note that the <span class=Argument>&lt LinkingFieldValue ></span> 
 is not quoted even if it is a character value.</p>



<p>Continuing with our example, assuming that the order number in row 1 
 of the <span class=Code1>Orders</span> grid is "001" and in 
 row 2 is "002", the link address for the link control in the 
 first two rows of the grid would be:</p>




<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>MyTargetPage.A5w?myGrid_link_1C=AccountNumber={AccountNumber}&myGrid_link_2N=Location={Location}</span></td></tr>
</table>

<p>The values generated for these URLs would be:</p>




<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>ItemsPage.A5W?ItemsGrid_link_1C=Invoice_Number=001</span></p>


<p class=Code><span class=HTML1>ItemsPage.A5W?ItemsGrid_link_1C=Invoice_Number=002</span></td></tr>
</table>

<p>When the user click the link in the first row, the browser will:</p>



<ul style="list-style: disc;"
  type=disc>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>Open the <span class=Code1>ItemsPage.A5W</span> 
 page.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>Filter the <span class=Code1>Items</span> 
 on the page with the filter expression: <span class=Code1>Invoice_Number="001"</span>.</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>Ensure that all new records 
 added automatically set the <span class=Code1>Invoice_Number</span> field 
 to "001".</p>

</li>
</ul>

<p class=A5>Contrasting the '_Link' and '_Filter' Query String Parameters</p>



<p>In the above example, we used the "_Link" parameter in the 
 query string to serve two purposes:</p>



<ul style="list-style: disc;"
  type=disc>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>to specify the filter to 
 use for the grid component</p>

</li>
  
  <li class=kadov-p-CBullet1><p class=Bullet1>to specify the value for 
 the linking fields in the component.</p>

</li>
</ul>

<p>The "_Filter" parameter can also be used in a query string 
 to specify the filter for a grid component. For example, the following 
 URL will open the <span class=Code1>ItemsPage.A5W</span> page, showing 
 only the order for order number "001":</p>




<table class="htmlTable" style="x-cell-content-align: top;
        border-left-style: None;
        border-right-style: None;
        border-top-style: None;
        border-bottom-style: None;
        width: 100%;
        border-spacing: 0px;
        border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
      width: 100%;
      padding-right: 10px;
      padding-left: 10px;" valign="top" width="100%">
<p class=Code><span class=HTML1>ItemsPage.A5W?ItemsGrid_Filter=Invoice_Number="001"</span></td></tr>
</table>

<p>However, if this URL opened the <span class=Code1>ItemsPage.A5W</span> 
 page, then if the user entered new records and did not explicitly set 
 the <span class=Code1>Invoice_Number</span> field to "001", 
 the new order items would not be linked to the correct parent record.</p>



<p class=A5>See Also</p>



<p><a href="/Index/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a>, <a href="../References/Web/A5W Page Link, Filter, and Order Syntax.html" title="A5W Page Link, Filter, and Order Syntax" class="wiki">A5W   Page Filter and Order Syntax</a></p>


	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Automatically+Populating+Linking+Field+Values+when+Doing+++Data+Entry">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"desktop,rules,grid,component"}--->
</body></html>