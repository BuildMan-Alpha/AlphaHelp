	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			

<p class=A3Topic>Calculated Values</p>



<p>Alpha Anywhere calculates a calculated value when it is based on one or 
 more fields in a table and you change or enter a record. You may define 
 a calculated field for a:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>table</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>set</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>layout</p>

</li>
</ul>

<p>Alpha Anywhere supports two similar capabilities:</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1><a href="Calculated Fields.html" title="Calculated Fields" class="wiki">Calculated   Fields</a> - where Alpha Anywhere calculates the value of a table field</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Calculated Values - which 
 you may place on a layout or use in computations</p>

</li>
</ul>

<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : Alpha Anywhere 
 documentation and software has traditionally referred to the values that 
 you calculate and place on a layout&nbsp;as&nbsp;"calculated fields". 
 However, these values are not fields, because they are not stored in a 
 table record. They are temporary variables that are created and calculated 
 on demand.</p>



<p>If you define a calculated value for a table or set, you can use it 
 in any layout or operation defined for that table or set. If you define 
 a calculated value for a layout, you can use it only on the layout for 
 which it is defined. The following illustration shows you the scope of 
 these fields. </p>



<p class=Pix><img src="images/UG_Calculated_Fields.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 416px;
							height: 294px;
							border-style: none;
							border-style: none;"
					width=416
					height=294
					border=0></p>



<p>You can create a <span class=Bolded>calculated value</span> by clicking 
 <img src="images/Calc_Fields_button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> when designing a table, set, or layout. You can only 
 create a <span class=Bolded>Calculated Field</span> in <a href="../../../References/Desktop/Field Rules__COLON__ Field Types.html#Calculated_Fields" title="Field Rules: Field Types" class="wiki">Field   Rules</a>. In all cases you can place one of these calculated fields on 
 a layout.</p>



<p>You may place calculated values on layouts to display the results of 
 a calculation. For example, you might place a calculation at the bottom 
 of a sales report to display total sales. Calculated values are also used 
 to conserve disk-space by eliminating the storage of easily-derived information. 
 For example, if you have a table of products in which you have a <span 
 class=Code1>Cost</span> field and a <span class=Code1>Quantity</span> 
 field, you can create a calculated value for the table that multiplies 
 <span class=Code1>Cost</span> and <span class=Code1>Quantity</span> with 
 the expression <span class=Code1>Cost * Quantity</span>. When you create 
 a layout or operation for the table, you can use the calculated value 
 just&nbsp;as&nbsp;you would any other field.</p>



<p class=A5><a name=Defining_Calculated_Variables_for_a_Set_or_Table>Defining 
 Calculated Values&nbsp;for a Set or Table</a></p>



<p>Calculated values defined for a table or set are created in the <span 
 class=Screen>Define Calculated Fields</span> dialog box. To open this 
 dialog box, choose <span class=Button>Calculated Fields</span> from any 
 Layout menu or click <img src="images/Calc_Fields_button.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 22px;
									height: 22px;
									float: none;
									border-style: none;
									border-style: none;"
							width=22
							height=22
							border=0> when designing a layout. For example, 
 when designing a form, select <span class=Button>Form > Calculated 
 Fields...</span> . </p>



<p class=Pix><img src="images/AL_calculated_fields.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 661px;
							height: 429px;
							border-style: none;
							border-style: none;"
					width=661
					height=429
					border=0></p>



<p>To create a calculated value, enter the field's name in the <span class=Control>
<span style="font-weight: 400"><font color="#000000">Name</font></span></span> 
 column. The name can contain the characters A-Z, 0-9 and underscores ("_"). 
 It must start with a letter, contain no spaces, and have a length of 24 
 characters or fewer. To define the calculated value's expression, type 
 the expression into the <span class=Control><font color="#000000">
<span style="font-weight: 400">Expression</span></font></span> column. 
 You can click on the 
<img src="images/Button_black.png"
							x-maintain-ratio=TRUE
							style="border: medium none;
									float: none;
									border-top-style:none; border-right-style:none; border-bottom-style:none; border-left-style:none"
							width=28
							height=29
							border=0> button to use the 
<a href="Expression Builder.html" title="Expression Builder" class="wiki">Expression Builder</a>.</p>



<p class=Note><img src="images/icon_information.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 36px;
							height: 32px;
							float: none;
							border-style: none;
							border-style: none;"
					width=36
					height=32
					border=0> <span class=Note>Note</span> : The <span 
 class=Screen>Calculated Values</span> dialog will show <a href="../../../References/Desktop/Creating a New Table.html#Global_Calculated_Fields" title="Creating a New Table" class="wiki">global   calculated values</a> defined at the table level. If you open this dialog 
 from a layout, you will be to see these calculated values, but will <span 
 class=Bolded>not</span> be able to modify them.</p>



<p class=A5><a name=Placing_Calculated_Variables_on_a_Layout>Placing calculated 
 values on a Layout</a></p>



<p>There are two ways to create a calculated value on a layout. The first 
 is to define the variable in the <span class=Screen>Calculated Fields</span> 
 dialog box, then drag its entry from the 
<a href="Using the Fields Panel.html" title="Using the Fields Panel" class="wiki">Drag-and-Drop List</a> to the layout.</p>



<p>The second, and easier, way to define a calculated value is by using 
 the <span class=Screen>Drag-and-Drop List</span>. In the <span class=Screen>Drag-and-Drop 
 List</span>, choose "Fields" or "Fields with Titles" 
 from the drop-down list. Then, click and drag the "<New Calc/Summary 
 Field>" entry onto the layout. When you release the mouse button 
 the <span class=Screen>New Calculated Field</span> dialog box appears.</p>



<p>In the <span class=Control><font color="#000000">
<span style="font-weight: 400">Name</span></font></span> text box, enter the name of the 
 new calculated value. In the <span class=Control><font color="#000000">
<span style="font-weight: 400">Expression</span></font></span> box, 
 enter the expression for the calculated value. (Or click the 
<img border="0" src="../DBF/images/Button_black.png" width="26" height="26"> button to use the <span class=Screen>
<span style="font-weight: 400"><font color="#000000">Expression Builder</font></span></span>.) 
 If you want to use the field to perform a summary calculation, choose 
 the type of operation in the Function box. For more information on summary 
 calculations, see the next section for details.</p>



<p class=A5><a name=Deleting_Calculated_Variables>Deleting Calculated Values</a></p>



<p>You can only delete a calculated value at the level of its creation. 
 For example, if you created a calculated value on a report layout, you 
 must delete it from the same report layout.</p>



<p>To delete a calculated value associated with a table or set.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Display the <span 
 class=Screen>Tables/Sets</span> tab of the <span class=Screen>Control 
 Panel</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the table 
 or set that contains the calculated field and click <span class=Button>Design 
 > Table structure</span> or <span class=Button>Design > Set structure.</span></p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Calc_Fields_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to display the <span class=Screen>Calculated Values</span> 
 dialog box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select and delete 
 the line that contains the calculated value definition.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save the changes 
 to the table or set.</p>

</li>
</ol>

<p>To delete a calculated value associated with a layout.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the layout (form, 
 browse, report, letter, or label) in its editor.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <img src="images/Calc_Fields_button.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> to display the <span class=Screen>Calculated Values</span> 
 dialog box.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select and delete 
 the line that contains the calculated value definition.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save the changes 
 to the layout.</p>

</li>
</ol>

<p class=A5><a name=Sorting_on_Calculated_Values>Sorting on Calculated 
 Values</a></p>



<p>A sort key can be a maximum of 100 characters. If you want to place 
 a character calculated value into a layout and then sort on it using the 
 <img src="images/Sort_Ascending_button.gif"
		x-maintain-ratio=TRUE
		style="border: none;
				width: 22px;
				height: 22px;
				float: none;
				border-style: none;
				border-style: none;"
		width=22
		height=22
		border=0> or <img src="images/Sort_Descending_button.gif"
							x-maintain-ratio=TRUE
							style="border: none;
									width: 22px;
									height: 22px;
									float: none;
									border-style: none;
									border-style: none;"
							width=22
							height=22
							border=0> buttons, the value expression must 
 not return more than 100 characters of data.</p>



<p class=A5><a name=Defining_Summary_Calculations>Defining Summary Calculations</a> 
 &nbsp;(Total, Average, Etc.)</p>



<p>If you are creating a calculated value to place on a form or Report, 
 Alpha Anywhere lets you use summary functions to perform calculations using 
 multiple records from a table or set. For example, on an invoice Form, 
 you can create a calculated value that summarizes the <span class=Code1>price</span> 
 and <span class=Code1>quantity</span> of each invoice item and displays 
 a <span class=Code1>total</span>. On a report, you can use a calculated 
 value to display total sales for each group of records, and for the entire 
 Report.</p>



<p>In the <span class=Control><span style="font-weight: 400">
<font color="#000000">Function</font></span></span> drop-down list box select 
 the type of operation you want to perform. The operations that are available 
 depend on the data-type of the value you are summarizing. For example, 
 you can perform a summary total on a numeric field, but not on a character 
 field.</p>



<p>If the calculated value is being placed on a report or on a form designed 
 for a set, you can determine the records to include in the operation by 
 setting the <span class=Control><font color="#000000">
<span style="font-weight: 400">Group</span></font></span> and <span class=Control>
<font color="#000000"><span style="font-weight: 400">Subgroup</span></font></span> 
 parameters. To access these parameters, click the <span class=Button>Advanced>></span> 
 button. Refer to the following subsections for details on setting the 
 Group and Subgroup parameters. </p>



<p class=Pix><img src="images/New_Calculated_Field.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 489px;
							height: 323px;
							float: none;
							border-style: none;
							border-style: none;"
					width=489
					height=323
					border=0></p>



<p class=A5><a name=Setting_the_Group_and_Subgroup_for_a_Form_Defined_for_a_Set>Setting 
 the Group&nbsp;and Subgroup&nbsp;for a Form Defined for a Set</a></p>



<p>If you are designing a form for a set, and the set contains one or more 
 one-to-many links, you can specify that the operation should only use 
 child records that are linked to the current parent record.</p>



<p>For example, you have a set which tracks invoices, and you want to display 
 the total of invoice line-items for the current invoice. You can set the 
 <span class=Control><font color="#000000"><span style="font-weight: 400">Group</span></font></span> and <span class=Control>
<font color="#000000"><span style="font-weight: 400">Subgroup</span></font></span> 
 parameter so that only invoice items from the current record are used 
 in the calculation. To do this you set the <span class=Control>
<font color="#000000"><span style="font-weight: 400">Group</span></font></span> 
 parameter to the name of the primary table and the <span class=Control>
<font color="#000000"><span style="font-weight: 400">Subgroup</span></font></span> 
 parameter to the name of the child table in which the line-items are stored.</p>



<p>Suppose instead you wanted to display the grand total of invoice items 
 for all invoices. To do this, you set the <span class=Control>
<font color="#000000"><span style="font-weight: 400">Group</span></font></span> 
 parameter to <span class=Code1><font color="#000000">
<span style="font-weight: 400">Grand</span></font></span> and the <span class=Control>
<font color="#000000"><span style="font-weight: 400">Subgroup</span></font></span> 
 parameter to the name of the child table in which the invoice items are 
 stored. Grand indicates that you want to use every record from the primary 
 table, not just the current record.</p>



<p class=A5><a name=Setting_the_Group_and_Subgroup_Parameters_for_a_Report>Setting 
 the Group and Subgroup Parameters for a Report</a></p>



<p>In a Report, you set the <span class=Control><span style="font-weight: 400">
<font color="#000000">Group</font></span></span> and <span 
 class=Control><span style="font-weight: 400"><font color="#000000">Subgroup</font></span></span> parameters to the names of sections on the 
 Report.</p>



<p>For example, you have a sales report in which you have created a grouping 
 level called <span class=Code1><span style="font-weight: 400">
<font color="#000000">Month</font></span></span>. The <span class=Code1>
<span style="font-weight: 400"><font color="#000000">Month</font></span></span> 
 group groups records so that sales from a given month are kept together. 
 Suppose also that you want to place a calculated field in the group footer 
 to display each month's total. To do this, you set the <span class=Control>
<span style="font-weight: 400"><font color="#000000">Group</font></span></span> 
 parameter to the name of the grouping section ( <span class=Code1>
<span style="font-weight: 400"><font color="#000000">Month</font></span></span> 
 ) and the <span class=Control><span style="font-weight: 400">
<font color="#000000">Subgroup</font></span></span> parameter to <span class=Code1>
<span style="font-weight: 400"><font color="#000000">Detail</font></span></span>, 
 since you want to use the records in the detail section for the current 
 month.</p>



<p>Suppose you wanted to display the total for the entire report next to 
 the total for the month. To do this you would create another calculated 
 field with the same definition, except you would set the <span class=Control>
<span style="font-weight: 400"><font color="#000000">Group</font></span></span> 
 parameter to <span class=Code1><span style="font-weight: 400">
<font color="#000000">Grand</font></span></span>, since you want to see the 
 grand total for the entire report, not just the total for the current 
 group.</p>



<p>In most cases, you will not have to adjust these parameters, since Alpha 
Anywhere sets them for you based on the section in which you place the calculated 
 field. For example, if you place a summary calculations in a group footer, 
 Alpha Anywhere assumes you only want to include records from the current group. 
 If you place the summary-calculated field in the Report Footer section, 
 Alpha Anywhere assumes you want to include every record in the Report.</p>



<p class=A5><a name=Setting_the_Subgroup_Parameter_for_a_Sub_Report>Setting 
 the Subgroup&nbsp;Parameter for a Sub-Report</a></p>



<p>If you place a sub-report inside a report (the "main" Report), 
 then the sub-report will have a detail section, and the main report will 
 also have a detail section. When you create summary calculations, you 
 may have to qualify which detail section you are referring to.</p>



<p>For example, assume that the sub-report is called <span class=Code1>Subreport 
 1</span>. To refer to the detail section in this sub-report, you would 
 need to specify <span class=Code1>Subreport 1:detail</span>. Suppose that 
 this sub-report is grouped on <span class=Code1>Invoice_number</span> 
 and you wanted to total a field called <span class=Code1>Amount_due</span> 
 in the Group Footer of the sub-report. To do so, you would specify this 
 expression:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>Total(invoice_items->amount_due, grp->invoice_number, 
 grp->Subreport 1:detail)</td></tr>
</table>

<p>If you just <span class=Code1>specify grp->detail</span>, Alpha Anywhere 
 assumes you are referring to records in the main report's detail section. 
 Note that the <span class=Code1>Invoice_number</span> group does not need 
 to be prefixed with <span class=Code1>Subreport 1</span>. This is because 
 when you insert a group in a report, or a sub-report, you can specify 
 the name of the group, and are therefore able to specify unique group 
 names for all of the groups in a Report and its sub-reports.</p>



<p class=A5>See Also</p>



<p><a href="Placing a Calculated Value on a Form.html" title="Placing a Calculated Value on a Form" class="wiki">Placing a Calculated   Value</a>, <a href="Calculated Fields.html" title="Calculated Fields" class="wiki">Calculated Fields</a></p>



	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Calculated+Values">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop","status":"pending","keywords":"desktop,guide,rules"}--->
</body></html>