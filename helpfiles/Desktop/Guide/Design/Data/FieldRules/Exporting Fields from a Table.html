	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			
<p class=A3Topic>Exporting Fields from a Table</p>



<p class=A5><a name=Exporting_Plain_Text_with_a_Xbasic_Script>Exporting 
 Plain Text with a Xbasic Script</a></p>



<p>It is quite easy to export character, numeric, date, Memo, and RTF Memo 
 fields with an Xbasic script. The following form shows the fields of the 
 table and some sample data. </p>



<p class=Pix><img src="images/XB_Export_Script_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							float: none;
							width: 480px;
							height: 437px;
							border-style: none;
							border-style: none;"
					width=480
					height=437
					border=0></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open your form and 
 switch to design mode by clicking <img src="images/Design_Mode_button.gif"
										x-maintain-ratio=TRUE
										style="border: none;
												width: 22px;
												height: 22px;
												float: none;
												border-style: none;
												border-style: none;"
										width=22
										height=22
										border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Toolbox</span> 
 (if it is not already open) by clicking <img src="images/Toolbox_button.gif"
												x-maintain-ratio=TRUE
												style="border: none;
														width: 22px;
														height: 22px;
														float: none;
														border-style: none;
														border-style: none;"
												width=22
												height=22
												border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the button 
 tool <img src="images/Button_tool_button.gif"
			x-maintain-ratio=TRUE
			style="border: none;
					width: 22px;
					height: 22px;
					float: none;
					border-style: none;
					border-style: none;"
			width=22
			height=22
			border=0> and sketch a button onto the form ("Export Plain 
 Text with a Xbasic Script" in the picture above).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The following screen 
 will appear. Enter the appropriate <span class=Control>Label</span> text, 
 select <span class=Control>Use Xbasic Editor</span>, and click <span class=Control>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a script that 
 follows this format. Note where you want to substitute the name of your 
 table (for <span class=Code1>export_demo</span> ) and your actual field 
 names (for <span class=Code1>firstname</span>, <span class=Code1>lastname</span>, 
 <span class=Code1>nnumber</span>, <span class=Code1>ddate</span>, <span 
 class=Code1>mmemo</span>, and <span class=Code1>rtfmemo</span> ).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>The number conversion 
 specifies the number of characters (8) and the number of decimal digits 
 (2). You should substitute numbers that correspond to your field's specifications.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your script 
 and your modified form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to view mode 
 by clicking <img src="images/Form_View_Button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 22px;
							height: 22px;
							float: none;
							border-style: none;
							border-style: none;"
					width=22
					height=22
					border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click your new <span 
 class=Button>Export Plain Text with Script</span> button.</p>

</li>
</ol>

<p class=Note><span class=Note><img src="images/icon_warning.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 37px;
											height: 33px;
											float: none;
											border-style: none;
											border-style: none;"
									width=37
									height=33
									border=0>Note</span> : The RTF Memo 
 conversion removes all formatting and leaves you with plain text.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim tbl&nbsp;as&nbsp;P</p>


<p class=Code>dim fname&nbsp;as&nbsp;C</p>


<p class=Code>dim lname&nbsp;as&nbsp;C</p>


<p class=Code>dim num&nbsp;as&nbsp;C</p>


<p class=Code>dim dat&nbsp;as&nbsp;C</p>


<p class=Code>dim memo_buffer&nbsp;as&nbsp;C</p>


<p class=Code>dim rtf_memo_buffer&nbsp;as&nbsp;C</p>


<p class=Code>dim fbuffer&nbsp;as&nbsp;C</p>


<p class=Code>dim fptr&nbsp;as&nbsp;P</p>


<p class=Code>dim fname&nbsp;as&nbsp;C</p>


<p class=Code>fname = ui_get_file("Export File Name", "(*.txt)")</p>


<p class=Code>if (alltrim(fname) <> "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fptr = file.create(fname, FILE_RW_EXCLUSIVE)</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>fbuffer = ""</p>


<p class=Code>tbl = table.open("export_demo")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fname = alltrim(tbl.Firstname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;lname = alltrim(tbl.Lastname)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;dat = dtoc(tbl.Ddate)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;num = alltrim( str(tbl.Nnumber,8,2) )</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;memo_buffer = tbl.Mmemo</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rtf_memo_buffer = rtf_field_to_text("Rtfmemo")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fbuffer = fname + "," + 
 lname + "," + dat + "," + num + "," + memo_buffer 
 + "," + rtf_memo_buffer + crlf()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fptr.write(fbuffer)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>wend</p>


<p class=Code>tbl.close()</p>


<p class=Code>fptr.close()</td></tr>
</table>

<p>The exported file ( <span class=Code1>c:\export.txt</span> ) looked 
 like this in <span class=Screen>Notepad</span>. </p>



<p class=Pix><img src="images/XB_Export_Script_4.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 758px;
							height: 192px;
							float: none;
							border-style: none;
							border-style: none;"
					width=758
					height=192
					border=0></p>



<p>After importing the data in Excel (as a comma delimited file), the data 
 looked like this. </p>



<p class=Pix><img src="images/XB_Export_Script_3.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 678px;
							height: 243px;
							float: none;
							border-style: none;
							border-style: none;"
					width=678
					height=243
					border=0></p>



<p class=A5><a name=Exporting_Plain_Text_with_an_Action_Script>Exporting 
 Plain Text with an Action Script</a></p>



<p>The export of data using Action Scripting is faster and easier, but 
 it does not handle RTF memo fields. Memo fields are truncated to 255 characters.</p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open your form and 
 switch to design mode by clicking <img src="images/Design_Mode_button.gif"
										x-maintain-ratio=TRUE
										style="border: none;
												width: 22px;
												height: 22px;
												float: none;
												border-style: none;
												border-style: none;"
										width=22
										height=22
										border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Toolbox</span> 
 (if it is not already open) by clicking <img src="images/Toolbox_button.gif"
												x-maintain-ratio=TRUE
												style="border: none;
														width: 22px;
														height: 22px;
														float: none;
														border-style: none;
														border-style: none;"
												width=22
												height=22
												border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the button 
 tool <img src="images/Button_tool_button.gif"
			x-maintain-ratio=TRUE
			style="border: none;
					width: 22px;
					height: 22px;
					float: none;
					border-style: none;
					border-style: none;"
			width=22
			height=22
			border=0> and sketch a button onto the form ("Export Plain 
 Text with Action Script" in the picture above).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Define 
 Button</span> screen appears, enter the appropriate <span class=Control>Label</span> 
 text, select <span class=Control>Use Action Scripting</span>, and click 
 <span class=Control>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click 
	<img src="images/Add_Button.gif"
	x-maintain-ratio=TRUE
	style="border: medium none;
			width: 31px;
			height: 26px;
			float: none;
			border-top-style:none; border-right-style:none; border-bottom-style:none; border-left-style:none"
	border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select "Form/Browse" 
 from the <span class=Control>Category</span> list and "Quick Export 
 to Excel" from the <span class=Control>Action</span> list.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>Finish 
 > Finish</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your script 
 and your modified form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to view mode 
 by clicking <img src="images/Form_View_Button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 22px;
							height: 22px;
							float: none;
							border-style: none;
							border-style: none;"
					width=22
					height=22
					border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click your new <span 
 class=Button>Export Plain Text with Action Script</span> button.</p>

</li>
</ol>

<p>The exported file looked like this in <span class=Screen>Excel</span>. 
 </p>



<p class=Pix><img src="images/XB_Export_Script_7.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 614px;
							height: 227px;
							float: none;
							border-style: none;
							border-style: none;"
					width=614
					height=227
					border=0></p>



<p class=A5><a name=Exporting_Rich_Text_with_a_Xbasic_Script>Exporting 
 Rich Text with a Xbasic Script</a></p>



<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open your form and 
 switch to design mode by clicking <img src="images/Design_Mode_button.gif"
										x-maintain-ratio=TRUE
										style="border: none;
												width: 22px;
												height: 22px;
												float: none;
												border-style: none;
												border-style: none;"
										width=22
										height=22
										border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the <span class=Screen>Toolbox</span> 
 (if it is not already open) by clicking <img src="images/Toolbox_button.gif"
												x-maintain-ratio=TRUE
												style="border: none;
														width: 22px;
														height: 22px;
														float: none;
														border-style: none;
														border-style: none;"
												width=22
												height=22
												border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Select the button 
 tool <img src="images/Button_tool_button.gif"
			x-maintain-ratio=TRUE
			style="border: none;
					width: 22px;
					height: 22px;
					float: none;
					border-style: none;
					border-style: none;"
			width=22
			height=22
			border=0> and sketch a button onto the form ("Export RTF 
 Text with a Xbasic Script" in the picture above).</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>When the <span class=Screen>Define 
 Button</span> screen appears, enter the appropriate <span class=Control>Label</span> 
 text, select <span class=Control>Use Xbasic Editor</span>, and click <span 
 class=Control>Next&nbsp;></span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Enter a script that 
 follows this format. Note where you want to substitute the name of your 
 table (for <span class=Code1>export_demo</span> ) and your actual field 
 name for <span class=Code1>rtfmemo</span>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Save your script 
 and your modified form.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Switch to view mode 
 by clicking <img src="images/Form_View_Button.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 22px;
							height: 22px;
							float: none;
							border-style: none;
							border-style: none;"
					width=22
					height=22
					border=0>.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click your new <span 
 class=Button>Export RTF Text with Script</span> button.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Open the resulting 
 file with <span class=Screen>Microsoft Word</span>.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim num&nbsp;as&nbsp;C</p>


<p class=Code>dim dat&nbsp;as&nbsp;C</p>


<p class=Code>dim memo_buffer&nbsp;as&nbsp;C</p>


<p class=Code>dim rtf_memo_buffer&nbsp;as&nbsp;B</p>


<p class=Code>dim rtf_memo&nbsp;as&nbsp;C</p>


<p class=Code>dim fbuffer&nbsp;as&nbsp;C</p>


<p class=Code>dim fptr&nbsp;as&nbsp;P</p>


<p class=Code>dim fname&nbsp;as&nbsp;C</p>


<p class=Code>dim fldptr&nbsp;as&nbsp;P</p>


<p class=Code>dim bptr&nbsp;as&nbsp;P</p>


<p class=Code>fbuffer = ""</p>


<p class=Code>fname = ui_get_file("Export RTF File Name", "(*.rtf)")</p>


<p class=Code>if (alltrim(fname) <> "") then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fptr = file.create(fname, FILE_RW_EXCLUSIVE)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fptr.write("{")</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;end</p>


<p class=Code>end if</p>


<p class=Code>tbl = table.open("export_demo")</p>


<p class=Code>tbl.fetch_first()</p>


<p class=Code>while .not. tbl.fetch_eof()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fldptr = tbl.field_get("rtfmemo")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;bptr = rtf.create("")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;bptr.Binary_Text = fldptr.value_get()</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rtf_memo = bptr.Rtf_Text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rtf_memo = left(rtf_memo, len(rtf_memo) 
 - 1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;rtf_memo = right(rtf_memo, len(rtf_memo) 
 - 1)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fbuffer = rtf_memo + "{\par 
 }{\par }"</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;fptr.write(fbuffer)</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;tbl.fetch_next()</p>


<p class=Code>wend</p>


<p class=Code>fptr.write("}")</p>


<p class=Code>tbl.close()</p>


<p class=Code>fptr.close()</td></tr>
</table>

<p>This is how the exported data appears in <span class=Screen>Microsoft 
 Word</span>. </p>



<p class=Pix><img src="images/XB_Export_Script_9.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 590px;
							height: 393px;
							float: none;
							border-style: none;
							border-style: none;"
					width=590
					height=393
					border=0></p>



<p class=A5>See Also</p>



<p><a href="/Server/Reference/Design/Api/Functions/RTF Functions/RTF_FIELD_TO_TEXT Function.html" title="RTF_FIELD_TO_TEXT Function" class="wiki">RTF_FIELD_TO_TEXT(</a>), 
 <a href="/Server/Reference/Design/Api/Functions/Character Functions/STR Function.html" title="STR Function" class="wiki">STR(</a>), <a href="/Server/Reference/Design/Api/Functions/Date and Time Functions/DTOC Function.html" title="DTOC Function" class="wiki">DTOC(</a>), 
 <a href="/Server/Reference/Design/Api/Functions/Core Functions for Writing Expressions/ALLTRIM Function.html" title="ALLTRIM Function" class="wiki">ALLTRIM(</a>), <a href="/Server/Reference/Design/Api/Functions/File Functions/File Functions and Methods.html" title="File Functions and Methods" class="wiki">FILE   Methods</a>, <a href="../../Platform/Xbasic Action Scripting/Quick Export to Excel.html" title="Quick Export to Excel - Action Scripting" class="wiki">Quick   Export to Excel</a>, <a href="/Server/Reference/Design/Api/Functions/Field Functions/Field Functions and Methods.html" title="Field Functions and Methods" class="wiki">Field   Functions and Methods</a>, <a href="/Server/Reference/Design/Api/Functions/RTF Functions/RTF Functions and Methods.html" title="RTF Functions and Methods" class="wiki">RTF   Functions and Methods</a>, <a href="/Server/Reference/Design/Api/Functions/Table Functions/Table Functions and Methods.html" title="Table Functions and Methods" class="wiki">Table   Functions and Methods</a></p>

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Exporting+Fields+from+a+Table">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop","status":"pending","keywords":"desktop,guide,rules"}--->
</body></html>