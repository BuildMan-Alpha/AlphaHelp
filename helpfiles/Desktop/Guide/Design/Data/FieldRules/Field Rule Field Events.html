	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Field Rule Field Events</p>

<p>When defining field rules for a table, there are two types of field 
 rule events to which a script can be attached: <span class=Bolded>Field</span> 
 events and <span class=Bolded><a href="Field Rule Record Events.html" title="Field Rule Record Events" class="wiki">Record   events</a></span>.</p>

<p class=A5>Field Events</p>

<p>Field events occur while in Change or Enter mode, on a field-by-field 
 basis. By attaching a script to these events, you can create a specialized 
 field rule of your own.</p>


<div align=center>
<table style="border-left-style: none;
				border-top-style: none;
				border-right-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Event Name</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Occurs</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=FieldCanEditField>CanEditField</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before the cursor enters the field.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=FieldOnEditField>OnEditField</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After the cursor enters the field.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=FieldCanWriteField>CanWriteField</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>Before the cursor exits the field. Use to detect what 
 the user has entered into the field before it has been saved.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1><a name=FieldOnWroteField>OnWroteField</a></span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>After the cursor exits the field.</td></tr>
</table>
</div>
<p class=A5>The A_FIELD_VALUE System Variable</p>



<p>An Alpha Anywhere system variable, <span class=Code1>A_FIELD_VALUE</span>, 
 is useful in the <span class=Code1>CanWriteField</span> event. Because 
 the <span class=Code1>CanWriteField</span> event occurs before the field 
 value you type is actually written to the record buffer, you can use the 
 <span class=Code1>A_FIELD_VALUE</span> system variable in your script 
 to refer to the value that you typed into the control. If you reference 
 the field by name, you will access the initial value in the field before 
 you typed in a new value.</p>



<p class=PixCaption>Examining the Value of a Field in the CanWriteField 
 Event</p>




<div align=center>
<table style="border-left-style: none;
				border-top-style: none;
				border-right-style: none;
				border-bottom-style: none;
				float: aligncenter;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0">
<col>
<col>

<tr>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Value</td>
<td class="tableHeader" style="x-cell-content-align: top;" valign="top">
<p class=TableHead>Comment</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>TableName <symbol name="En Dash">R11; 
 >FieldName</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The initial value of the field.</td></tr>

<tr>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft><span class=Code1>A_FIELD_VALUE.Value</span></td>
<td class="TableCell" style="x-cell-content-align: top;" valign="top">
<p class=TableLeft>The value just typed into the control, but not yet saved.</td></tr>
</table>
</div>
<p>Once the field value is obtained you can use it in your script to determine 
 if it is valid. Your script can compare the field value with other values, 
 check it against the values in other fields or records, and then, if desired, 
 change the field value by changing the contents of the <span class=Code1>.Value </span> 
 property of the<span class=Code1> A_FIELD_VALUE</span> 
 variable (e.g. A_FIELD_VALUE.Value = "New Value").</p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span> : <span class=Code1>A_FIELD_VALUE.Value</span> 
 is a <span class=Bolded>character</span> variable, so you must use type 
conversion functions before comparing it to a value that is not a character 
value. For example:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>if ( convert_type(A_FIELD_VALUE.Value,"D") <> (MyTable->MyDateField)) 
 then</p>


<p class=Code>...</p>


<p class=Code>if ( convert_type(A_FIELD_VALUE.Value,"N") <> (MyTable->MyNumericField)) 
 then</p>


<p class=Code>...</p>


<p class=Code>&nbsp;</td></tr>
</table>

<p>For example, assume you have a form with a field called <span class=Code1>Last_name</span>. 
 The form is based on a table called Customers. In the <span class=Code1>CanWriteField</span> 
 event, you have the following code:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>ui_msg_box("Original value in field: ", customers->last_name)</p>


<p class=Code>ui_msg_box("New value just entered: ", a_FIELD_VALUE.Value)</td></tr>
</table>

<p>If the <span class=Code1>Last_name</span> initially field contains "Smith" 
 and you type "Jones" in the field, when you tab out of the field, 
 the first message box will display "Smith" and the second message 
 box will display "Jones".</p>



<p>The following example shows how the <span class=Code1>CanWriteField</span> 
 event can be used to transform a value that is entered into a field:</p>



<p>Assume that you are doing data entry into the <span class=Code1>Customer_Name</span> 
 field in a table. If you enter the customer id into this field, you want 
 Alpha Anywhere to automatically look up the this value in a lookup table and 
 replace the value you typed with the customer name when you tab out of 
 the field. For example, if you typed "C011" into the field, 
 you want Alpha Anywhere to automatically replace this entry with "Smith 
 and Boodles, Inc.".&nbsp;&nbsp;If you typed in a customer name, then 
 you do not want Alpha Anywhere to transform the entry. Assume that the lookup 
 table is called Customer and it has these fields: <span class=Code1>Customer_Id</span> 
 and <span class=Code1>Customer_Name</span>. Here is the script you would 
 attach to the <span class=Code1>Customer_Name</span> field's <span class=Code1>CanWriteField</span> 
 event:</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>tbl = table.open("customers")</p>


<p class=Code>indx = tbl.index_primary_put("customer id")</p>


<p class=Code>'assuming that customer_id is a character value (if numeric, for 
example, then tbl.fetch_find(convert_type(A_FIELD_VALUE.Value,"N")) )</p>


<p class=Code>result = tbl.fetch_find(A_FIELD_VALUE.Value)</p>


<p class=Code>if result < 1 then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Customer id was not found in table.</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;'Leave field entry&nbsp;as&nbsp;is.</p>


<p class=Code>else</p>


<p class=Code>&nbsp;&nbsp;&nbsp; 'Since tbl.customer_name is a character value, 
we do not need to do any type conversion.</p>


<p class=Code>&nbsp;&nbsp;&nbsp; 'If we wanted to assign a non-character value 
to A_FIELD_VALUE we would have to first convert the value to a character value.</p>


<p class=Code>&nbsp;&nbsp;&nbsp; 'e.g. A_FIELD_VALUE.value = convert_type(date(),"C")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;A_FIELD_VALUE.Value = tbl.customer_name</p>


<p class=Code>end if</p>


<p class=Code>tbl.close()</td></tr>

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
&nbsp;</td></tr>
</table>

<p class=A5>Script Context for Field Events</p>



<p>When a script attached to a field event is executing the "this" 
 alias refers to the control on a form, or column in the case of a browse, 
 to which the field is bound. For example, assume you have defined a field 
 event for the <span class=Code1>Customer_Id</span> field. Assume that 
 you are using a form with a control called <span class=Code1>Cust_Id</span> 
 that is bound to the <span class=Code1>Customer_Id</span> field. Assume 
 that you try to edit the value in the <span class=Code1>Cust_Id</span> 
 control. This will cause the <span class=Code1>CanEditField</span> event 
 to fire. If the script that is executed uses the "this" alias, 
 then the alias will refer to the <span class=Code1>Cust_Id</span> control.</p>



<p class=A5>See Also</p>



<p><a href="/Desktop_Api/Object/Object Events.html" title="Object Events" class="wiki">Object Events</a>, <a href="Field Rule Record Events.html" title="Field Rule Record Events" class="wiki">Field   Rule Record Events</a>, <a href="../../Platform/Xbasic Action Scripting/Attaching Scripts to Events.html" title="Attaching Scripts to Events" class="wiki">Attaching   Scripts to Events</a></p>
	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Field+Rule+Field+Events">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"dbf, desktop","status":"pending","keywords":"desktop,design,guide,rules"}--->
</body></html>