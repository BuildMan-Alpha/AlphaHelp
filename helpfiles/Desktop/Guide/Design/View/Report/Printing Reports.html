	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Printing Reports</p>

<p class=Note><img src="images/icon_information.gif" x-maintain-ratio=TRUE style="border: none; width: 36px; height: 32px; float: none; border-style: none; border-style: none;" width=36 height=32 border=0> <span class=Note>Note</span> : The <span class=Bolded>Printing Reports</span> topic describes a technique available to <span class=Screen>Alpha Five</span> database users.</p>

<p>This example shows how to print a report and deliver it to your Internet user. Since, a paper report is out the question, Alpha Five will compose the <span class=Code1>Invoice</span> report from the <span class=Code1>invoice.set</span>, save it in PDF format&nbsp;as&nbsp; <span class=Code1>foo.pdf</span>, and then start <span class=Screen>Adobe Acrobat</span> to display it in the client's browser.</p>

<p>The expression <span class=Code1>?" + time("hms03")</span> added to the PDF filename insures that you do not open a cached version of the file.</p>

 <table class="codeTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>&lt%a5</p>

<p class=Code>Report.saveas("Invoice@c:\program files\a5v5\samples\alphasports\invoice.set", "pdf", "", "", session.session_folder + "\foo.pdf", .f.)</p>

<p class=Code>response.redirect(session.session_url + "foo.pdf?" + time("hms03"))</p>

<p class=Code>%></td></tr> </table><p class=A5>Creating the Dialog</p>

<ol> <li class=kadov-p-CListNumber><p class=ListNumber>Create a new dialog web component.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Controls</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Under the <span class=Control>Control Types</span> list select "Dropdownbox" and click <img src="images/Move_Right_Button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter "invoiceNumber" in the <span class=Control>Name</span> field, click <span class=Button>Make label same&nbsp;as&nbsp;name</span>, and click <span class=Button>OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>DropDownBox Properties > Choices</span> field to display the <span class=Screen>Define Choices</span> dialog.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "Dynamic" in the <span class=Button>Define Choices > List Type</span> list.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "DBF-Table" in the <span class=Button>Data Source > Data source type</span> list.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "invoice_header" in the <span class=Button>Data Source > Table name</span> list.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Data Source > Display value field/ex<x>pression</span> field to display the <span class=Screen>Expression Builder</span>.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Press <span class=Button>F2</span>, select "Invoice_Number", and click <span class=Button>Insert</span>. Click <span class=Button>OK</span>.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Set the <span class=Button>DropDownBox Properties > Height</span> field to 6.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select "Multiple" in the <span class=Button>DropDownBox Properties > Multi-select allowed</span> field.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>DropDownBox Properties > In-line style</span> field.</p>

</li> <ol> <li class=kadov-p-CListAlpha><p class=ListAlpha>Display the <span class=Screen>Position</span> tab.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <img src="images/Ruler_button.gif" x-maintain-ratio=TRUE style="border: none; width: 22px; height: 22px; float: none; border-style: none; border-style: none;" width=22 height=22 border=0> next to the <span class=Control>Width</span> field.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Enter 2 into the <span class=Control>Size</span> field.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Select "in" from the drop down list box.</p>

</li> <li class=kadov-p-CListAlpha><p class=ListAlpha>Click <span class=Button>OK > OK</span>.</p>

</li> </ol> <li class=kadov-p-CListNumber><p class=ListNumber>Change the <span class=Button>Row Properties > Row label</span> field to "Invoice Number".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Check the <span class=Button>Row Properties > Freeform layout</span> check box.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Row Properties > Freeform template</span> field to display the <span class=Screen>Freeform Column Layout</span> dialog.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following text and click <span class=Button>OK</span>. Note how this displays the <span class=Code1>invoiceNumber</span> field with HTML text above and below it.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code><span class=HTML1>&ltb>Invoice Numbers&lt/b>&ltbr></span></p>

<p class=Code>{invoiceNumber} <span class=HTML1>&ltbr></span></p>

<p class=Code><span class=HTML1>Select one or more invoices.</span></td> </tr> </table> <ol start=13> <li class=kadov-p-CListNumber><p class=ListNumber>Display the <span class=Screen>Form > Properties</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Clear the <span class=Button>Layout Options > Show row labels</span> check box.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Change the <span class=Button>Submit/Reset Buttons > Submit button label</span> field to "Print Invoices".</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Web_Properties_button.gif" x-maintain-ratio=TRUE style="border: none; float: none; width: 17px; height: 18px; border-style: none; border-style: none;" width=17 height=18 border=0> in the <span class=Button>Server Events > AfterValidate</span> field to display the <span class=Screen>Form > Events</span> page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Enter the following code into the <span class=Screen>Form Events</span> dialog and click <span class=Button>OK</span>.</p>

</li> </ol>  <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>IF eval_valid("invoiceNumber") = .f. Then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;goto skipreport</p>

<p class=Code>end if</p>

<p class=Code>dim filter&nbsp;as&nbsp;C</p>

<p class=Code>dim order&nbsp;as&nbsp;C</p>

<p class=Code>dim invnum&nbsp;as&nbsp;C</p>

<p class=Code>dim filename&nbsp;as&nbsp;C</p>

<p class=Code>'since InvoiceNumber is a multi-select DropDownBox, it is actually an array that contains the selected values.</p>

<p class=Code>invnum = invoiceNumber.dump()</p>

<p class=Code>invnum = remove_blank_lines(invnum)</p>

<p class=Code>invnum = *for_each(x,"invoice_number = " + quote(x),invnum)</p>

<p class=Code>filter = stritran(alltrim(invnum), crlf()," .or. ")</p>

<p class=Code>Order = ""</p>

<p class=Code>filename = session.session_folder + chr(92) + "tempreport.pdf"</p>

<p class=Code>filename = report.saveas("Invoice@&ltadb_path>\invoice.set", "pdf", filter, order, filename,.f.)</p>

<p class=Code>if file.exists(filename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentform.RedirectTarget = session.session_url + "tempreport.pdf?" + rand_string(5)</p>

<p class=Code>end if</p>

<p class=Code>skipreport:</td></tr> </table><p class=A5><a name=Understanding_the_AfterValidate_Script>Understanding the <span class=Code1>AfterValidate</span> Script</a></p>

<p>The <span class=Code1>AfterValidate</span> event occurs when you click the submit button (in this case renamed to "Print Invoices"). The first part of the script tests to see if any invoice numbers have been selected. When you select one or more invoice numbers, the <span class=Code1>invoiceNumber</span> variable exists, and <span class=Code1>eval_valid("invoiceNumber")</span> equals .T. . When no selection has been made, the result is .F., which causes the code to go to <span class=Code1>skipreport:</span> and exit.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>IF eval_valid("invoiceNumber") = .f. Then</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;goto skipreport</p>

<p class=Code>end if</td></tr> </table><p>A multi-select drop down box saves the user's input into an array. The <span class=Code1>invoiceNumber.dump()</span> method extracts these values and puts them into a CR-LF delimited list named <span class=Code1>invnum</span>. The <span class=Code1>remove_blank_lines(invnum)</span> function collapses the list when you skip selections in the list box (i.e. 1,3,4). The <span class=Code1>*for_each(x,"invoice_number = " + quote(x),invnum)</span> statement converts the list into a series of table filter expressions. The <span class=Code1>stritran(alltrim(invnum), crlf()," .or. ")</span> function replaces each CR with an " .or. ", resulting in a single filter expression that is assigned to the <span class=Code1>filter</span> variable.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>invnum = invoiceNumber.dump()</p>

<p class=Code>invnum = remove_blank_lines(invnum)</p>

<p class=Code>invnum = *for_each(x,"invoice_number = " + quote(x),invnum)</p>

<p class=Code>filter = stritran(alltrim(invnum), crlf()," .or. ")</p>

<p class=Code>Order = ""</td></tr> </table><p>The following statement sets the path and filename of the new report and assigns it to the <span class=Code1>filename</span> variable. The purpose of the <span class=Code1>session.session_folder</span> is to hold these temporary files.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>filename = session.session_folder + chr(92) + "tempreport.pdf"</td></tr> </table><p>The <a href="/Server/Reference/Design/Api/Objects/Object/OBJECT.SAVEAS Method.html" title="OBJECT.SAVEAS Method" class="wiki">REPORT.SAVEAS(</a>) function actually prints the report. It calls the <span class=Code1>Invoice_Report</span> report of the <span class=Code1>invoice</span> set. The method references uses &ltadb_path> <a href="../References/Web/Web Publishing/Path and Connection String Aliases.html" title="Path and Connection String Aliases" class="wiki">alias</a>, which makes the application portable to other servers. The REPORT.SAVEAS() function returns the filename of the report it creates.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>filename = report.saveas("Invoice_Report@&ltadb_path>\invoice.set", "pdf", filter, order, filename, .f.)</td></tr> </table><p>If the <span class=Code1>file.exists(filename)</span> method determines that Alpha Five created the PDF file, the script sets the <span class=Code1>currentform.RedirectTarget</span> property of the page to <span class=Code1>session.session_url + "tempreport.pdf?" + rand_string(5)</span>. When the <span class=Code1>currentform.RedirectTarget</span> property has a value, Alpha Five interprets it&nbsp;as&nbsp;the next page to display. The report's filename is <span class=Code1>session.session_url + "tempreport.pdf?" + rand_string(5)</span>. One interesting aspect of the report's filename is the <span class=Code1>rand_string(5)</span> appended to the end. This forces <span class=Screen>Acrobat</span> to load and display the report.</p>

 <table class="htmlTable" style="x-cell-content-align: top; border-left-style: None; border-right-style: None; border-top-style: None; border-bottom-style: None; width: 100%; border-spacing: 0px; border-spacing: 0px;" cellspacing="0" width="100%"> <col style="width: 100%;"> <tr style="x-cell-content-align: top;" valign="top"> <td style="x-cell-content-align: top; width: 100%; padding-right: 10px; padding-left: 10px;" valign="top" width="100%"><p class=Code>if file.exists(filename)</p>

<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;currentform.RedirectTarget = session.session_url + "tempreport.pdf?" + rand_string(5)</p>

<p class=Code>end if</td></tr> </table> <ol start=18> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>OK</span> to close the <span class=Screen>Form Events</span> dialog.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter "Print_Report" in the <span class=Control>File name</span> field, and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Close the <span class=Screen>Dialog Builder</span>.</p>

</li> </ol><p class=A5>Creating the Print_Report Page</p>

<ol start=1> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>New > OK</span> to create a new A5W page.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Click <span class=Button>File > Save As</span>, enter "Print_Report" in the <span class=Control>File name</span> field, and click <span class=Button>Save</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select <span class=Button>Insert Component > Select</span>, pick "Print_Report", and click <span class=Button>OK > OK</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Save the page and close the <span class=Screen>HTML Editor</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Right click the "Print_Report" page, select <span class=Button>Publish (Local Webroot) and open</span>.</p>

</li> <li class=kadov-p-CListNumber><p class=ListNumber>Select a couple of invoice numbers and click <span class=Button>Print Invoices</span>. The report will open in your browser.</p>

</li> </ol><p class=A5>See Also</p>

<p><a href="/Index/Contents - Web Publishing Tutorial.html" title="Contents - Web Publishing Tutorial" class="wiki">Contents</a></p>

	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Printing+Reports">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"status":"pending","keywords":"desktop,guide,report,component","tags":"web"}--->
</body></html>