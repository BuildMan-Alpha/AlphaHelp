	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	 




<article id="top" class="wikitext nopagetitle">
			
		
		
		
		
			 

	
			<p class=A3Topic>Displaying Values from a Set in a Tree Control</p>

<p>This sample demonstrates several different programming techniques.</p>

<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>How to extracting data 
 from a set and format it for a tree control</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>How to identify the user's 
 selection in the tree control</p>

</li>
</ul>

<p>This example is based on the Vendors set of the AlphaSports sample database. 
 </p>


<p class=Pix><img src="images/tree_control_2.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 338px;
							height: 254px;
							float: none;
							border-style: none;
							border-style: none;"
					width=338
					height=254
					border=0></p>

<ol>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>First, define two 
 session variables to associate with the text box (named PID) that displays 
 the <span class=Code1>Product_ID</span> of the selected item and the tree 
 control. </p>

</li>
</ol>

<p class=Pix><img src="images/tree_control_1.gif"
					x-maintain-ratio=TRUE
					style="border: none;
							width: 463px;
							height: 86px;
							float: none;
							border-style: none;
							border-style: none;"
					width=463
					height=86
					border=0></p>



<p>The first variable ( <span class=Code1>var->tree_selection</span> 
 ) is the source of data for the PID text box.</p>



<p>The Tree control shows three fields.</p>



<ul style="list-style: disc;"
	type=disc>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Vendor->Name</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Product->Description</p>

</li>
	
	<li class=kadov-p-CBullet1><p class=Bullet1>Product->Product_ID</p>

</li>
</ul>

<ol start=2>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Right click on the 
 tree control, select <span class=Button>Properties...</span>, then display 
 the <span class=Screen>Choices</span> tab.</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the top list box 
 select "Computed Automatically".</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>In the second list 
 box select "ex<x>pression (that returns a CR-LF delimited list)</p>

</li>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Click the <img src="images/Espression_Button_black.gif"
	x-maintain-ratio=TRUE
	style="border: none;
			width: 22px;
			height: 22px;
			float: none;
			border-style: none;
			border-style: none;"
	width=22
	height=22
	border=0> button in the <span class=Control>Expression</span> field 
 and enter the following expression.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>set.external_record_content_get("vendors", "alltrim(stritran(Vendor->Name,\".\",\"\") ) 
 + \".\" + alltrim(Product->Description) + \" (\" 
 + alltrim(Product->Product_ID) + \")\"")</td></tr>
</table>

<p>Since many people might find this expression difficult to understand, 
 here is how it evolved.</p>



<p><span class=Bolded>Step 1</span></p>



<p>This expression represents the base syntax of the <a href="/Server/Reference/Design/Api/Objects/Set/SET.EXTERNAL_RECORD_CONTENT_GET Method.html" title="SET.EXTERNAL_RECORD_CONTENT_GET Method" class="wiki">SET.EXTERNAL_RECORD_CONTENT_GET(</a>) 
 method, which will return a list of fields from the <span class=Code1>Vendor</span> 
 set. Note the list of fields is inside quotation marks. We are going to 
 substitute the quoted version of the following expression: <span class=Code1>alltrim(stritran(Vendor->Name, 
 ".", "") ) + "." + alltrim(Product->Description) 
 + " (" + alltrim(Product->Product_ID) + ")".</span></p>



<p class=Note><span class=Note><img src="images/icon_information.gif"
									x-maintain-ratio=TRUE
									style="border: none;
											width: 36px;
											height: 32px;
											float: none;
											border-style: none;"
									width=36
									height=32
									border=0>Note</span><span class=Code1>:</span> 
 <b>SET.EXTERNAL_RECORD_CONTENT_GET()</b> can only sort on fields in the primary 
 table and child tables linked one-to-one.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>set.external_record_content_get("vendors", "list 
 of fields")</td></tr>
</table>

<p class=A5><span class=Bolded><span class=Bolded>S</span> tep 2</span></p>



<p>The second argument of the expression is expanded to identify the fields 
 we want.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>set.external_record_content_get("vendors", "Vendor->Name 
 + Product->Description + Product->Product_ID")")</td></tr>
</table>

<p class=A5><span class=Bolded>Step 3</span></p>



<p>Because the <span class=Code1>Vendor->Name</span> field contains 
 period "." characters, which serve&nbsp;as&nbsp;the tree control 
 delimiter, we need to remove them with <a href="/Server/Reference/Design/Api/Functions/Character Functions/Replacement Functions/STRITRAN Function.html" title="STRITRAN Function" class="wiki">STRITRAN(</a>). 
 Note that is it necessary to add a backslash character before each quotation 
 mark to distinguish it from the pair that delimit this overall expression.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>set.external_record_content_get("vendors", "stritran(Vendor->Name,\".\",\"\") 
 + Product->Description + Product->Product_ID")")</td></tr>
</table>

<p class=A5><span class=Bolded>Step 4</span></p>



<p>Next, we need to add a period character between the <span class=Code1>Vendor->Name</span> 
 and <span class=Code1>Product->Description</span> fields. We need to 
 put the <span class=Code1>Product->Product_ID</span> field on the line. 
 The solution is to put it between parentheses. Again, note that is it 
 necessary to add a backslash character before each quotation mark to distinguish 
 it from the pair that delimit this overall expression.</p>




<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>set.external_record_content_get("vendors", "alltrim(stritran(Vendor->Name,\".\",\"\") ) 
 + \".\" + alltrim(Product->Description) + \" (\" 
 + alltrim(Product->Product_ID) + \")\"")</td></tr>
</table>

<ol start=6>
	
	<li class=kadov-p-CListNumber><p class=ListNumber>Add the following 
 script to the <span class=Code1>on<x>change</span> event of the tree control. 
 Note that we are examining <span class=Code1>Tree1.text</span>. If it 
 is empty (which means the user expanded or contracted the list), we do 
 nothing. If it contains a value, we extract the <span class=Code1>Product_ID</span> 
 value (which was surrounded by quotation marks) and stuff it into the 
 PID text box. The <span class=Code1>Product_ID</span> field is 12 characters 
 long, so it is padded out with space characters.</p>

</li>
</ol>


<table class="codeTable" style="x-cell-content-align: top;
				border-left-style: None;
				border-right-style: None;
				border-top-style: None;
				border-bottom-style: None;
				width: 100%;
				border-spacing: 0px;
				border-spacing: 0px;" cellspacing="0" width="100%">
<col style="width: 100%;">

<tr style="x-cell-content-align: top;" valign="top">
<td style="x-cell-content-align: top;
			width: 100%;
			padding-right: 10px;
			padding-left: 10px;" valign="top" width="100%">
<p class=Code>dim cc&nbsp;as&nbsp;C</p>


<p class=Code>if alltrim(Tree1.text) <> "" then</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cc = Tree1.text</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cc = word(cc, 2, "(")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;cc = word(cc, 1, ")")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;PID.value = padr(cc, 12, " ")</p>


<p class=Code>&nbsp;&nbsp;&nbsp;&nbsp;parentform:PID.refresh()</p>


<p class=Code>end if</td></tr>
</table>

<p class=A5>See Also</p>



<p><a href="/Server/Reference/Design/Api/Functions/Tree Control Functions/Tree Control Functions and Methods.html" title="Tree Control Functions and Methods" class="wiki">Tree Control   Methods</a></p>



	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Displaying+Values+from+a+Set+in+a+Tree+Control">-->


	 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"desktop, dbf","status":"pending","keywords":"desktop,guide,xdcontrol"}--->
</body></html>