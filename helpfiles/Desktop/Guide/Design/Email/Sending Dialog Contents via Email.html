	<!DOCTYPE html>
	<html>
	<head>
	<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\" />
	<link rel="stylesheet" type="text/css" href="theme.css" />
	</head>
	<body>
	<div id="tiki-clean">
			<div id="tiki-mid">
	
 



 

	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 




<article id="top" class="wikitext clearfix nopagetitle">
			
		
		
		
		
			 

	
			<h1 class="showhide_heading" id="Sending_Dialog_Contents_via_Email">Sending Dialog Contents via Email</h1>
There are times when the output of a dialog should not go directly to a database. You may want to email the entry, for example. Here is how you would do that, assuming that once again you are starting with our Simple Dialog example.<br />
<br />
In the Xbasic functions section of your dialog, insert this function:<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox" >FUNCTION sendEmail AS L (address AS C, subject as C, body AS C )
  debug(1)
  dim pm as P
  dim ps as P
  sendEmail= .F.
  IF (email_smtp_open(ps, &#34;smtp.myserver.com&#34;, 25, &#34;username@myserver.com&#34;,&#34;password&#34;))
		pm.to = address
		pm.from = &#34;myserver.com&#34;
		pm.from_alias = &#34;My Email Alias&#34;
		pm.subject = subject
		pm.message = body
		sendEmail = email_smtp_send(pm, ps)
  END IF
  email_smtp_close(ps)
END FUNCTION</pre></div><br />
<br />
You will need to edit the function for your server, which is why we have inserted the debug statement for you.<br />
<br />
In the <strong>afterDialogValidate</strong> event, insert the following code:<br />
<br />
<br />
<div class="plugincode" parse="vbnet"><pre class="codelisting" data-syntax="vbnet" dir="ltr" style="overflow:auto;" id="codebox1" >function afterDialogValidate as v (e as p)
&#39;... comments omitted here ...
&#39;debug(1)
&nbsp;
dim address as C = &#34;destinationUsername@destinationCompany.com&#34;
dim subject as C = &#34;Captured Combatant&#34;
dim body as C
body = &#34;NAME: &#34; + e.dataSubmitted.NAME + crlf()
body = body + &#34;RANK: &#34; + e.dataSubmitted.RANK + crlf()
body = body + &#34;SERIALNR &#34; + e.dataSubmitted.SERIALNR + crlf()
if sendEmail(address,subject,body)
	e.javascript=&#34;alert(&#39;Submitted: &#34;+e.dataSubmitted.NAME + &#34;, &#34; + e.dataSubmitted.RANK
	e.javascript=e.javascript + &#34;, &#34; + e.dataSubmitted.SERIALNR + &#34;, &#34;
else
	e.javascript=&#34;&#39;);&#34;
end if
end function</pre></div><br />
<br />
You will obviously have to edit the address to be the intended, valid email.<br />
<br />

	
	
	<hr class="hrwikibottom" /> 

	
	</article> 




	<!-- WIKIPATH:Sending+Dialog+Contents+via+Email+V11">-->


	<div class="wikitopline clearfix" style="clear: both;">
	<div class="content">
				<div class="wikiinfo" style="float: left">



<span id="description"></span>

		</div>

	 
 
	</div> 
</div> 

			</div>
		</div>


	
	
<!-- Put JS at the end -->
	
<!-- jsfile external -->


<!-- jsfile dynamic -->
<!-- jsfile 0 -->
<!---HELPMETADATA:{"tags":"web","status":"pending","keywords":"design,guide"}--->
</body></html>